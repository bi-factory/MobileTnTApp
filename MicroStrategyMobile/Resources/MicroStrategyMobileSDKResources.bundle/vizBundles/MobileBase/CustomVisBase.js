var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={helpPath:function(){return(mstrApp.helpUrl||"../help/")+"MSTRWeb/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},helpPathMobileAdmin:function(){return(mstrApp.helpUrl||"../help/")+"MobileAdmin/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/";},upgradeHelpPath:function(){return(mstrApp.upgradeHelpUrl||"../help/")+"WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/";},descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.IPA={};mstrmojo.IPA.Monitors={};mstrmojo.IPA.Alerts={};mstrmojo.IPA.Environment={};mstrmojo.IPA.Groups={};mstrmojo.IPA.Heartbeat={};mstrmojo.IPA.Managers={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.customviz={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.AS={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{},s4hana:{},cc:{},};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.mobile={vi:{ui:{rw:{xtab:{}}}},kpicard:{},mapbox:{},customviz:{},netviz:{},gm:{},ngm:{},gmaps:{layer:{mapbox:{}}},ag:{ui:{}}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{}},enums:{},ui:{menus:{},editors:{fe:{},cm:{},nlp:{}},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{},tutorial:{}},viz:{},util:{}};mstrmojo.ag={models:{editors:{},template:{}},ui:{},chart:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{tutorial:{}}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.nativeandroid={};mstrmojo.gm={touch:{}};mstrmojo.ngm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.kpicard={layout:{},editors:{}};mstrmojo.surveys={};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={basemap:{},graphic:{},geometry:{},layer:{svg:{},canvas:{},mapbox:{}}};mstrmojo.esrimap={};mstrmojo.mapbox={ui:{selectors:{}}};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.workstation={pages:{}};mstrmojo.err=function D(I,H){var G=I.name+': "'+I.message+'"';if(mstrmojo.debug){if(I.fileName){G+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){G+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var F=I.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+I.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:I.message,code:I.code},H,{title:I.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},getPluginRoot=function(){return getApp().pluginRoot||"../plugins/";},getPluginMojoRoot=function(){return getApp().pluginMojoRoot||getJsMojoRoot();},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!verifyJsLoaded(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleNames){var bundles=(bundleNames||"").split(",");return bundles.every(function(bundleName){bundleName=getJsBundlesRoot()+bundleName.trim();var loaded=reqCache[bundleName];if(!loaded&&_jsGet(bundleName)){reqCache[bundleName]=true;loaded=true;}return loaded;});};mstrmojo.requiresDepLib=function requiresDepLib(file,AMD){if(reqCache[file]){return true;}function isAMD(){return"function"===typeof define&&define.amd;}var AMDCache=window.define;if(!AMD&&isAMD()){delete window.define;}var value=_jsGet(file);reqCache[file]=true;window.define=AMDCache;return value;};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",mstrmojo.util.version.getResourcePathWithVersion(file),false);$XHR.setRequestHeader("X-Requested-With","XMLHttpRequest");$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.insertCSSLinks=function insertCSSLinks(files){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var isLoaded=!!verifyJsLoaded(fqcn);if(isLoaded){this.loaded[fqcn]=true;}return isLoaded;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17)),pluginFile=pluginName+"/javascript/"+getPluginMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrConfig.dossierServerPluginNames&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){fqcn=mstrApp.dossierServerBaseUrl+"plugins/"+pluginFile;}else{fqcn=getPluginRoot()+pluginFile;}}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;populateDescriptors(mstrConfig.customDescs&&mstrConfig.customDescs.descriptors);mstrConfig.customDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=JSON.parse(response.replace(/\\'/g,"'"));populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;this.invalidateJsLoaded(fqcn);};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};mstrmojo.getJsRoot=getJsRoot;function verifyJsLoaded(name){name=name.trim();var path=name.split(".");var o=window;for(var i=0;i<path.length;i++){o=o[path[i]];if(!o){break;}}return o;}mstrmojo.invalidateJsLoaded=function invalidateJsLoaded(name){var path=name&&name.trim().split("."),len=(path&&path.length)||0,tmp=window,i;for(i=0;i<len-1;i++){if(!tmp){return ;}tmp=tmp[path[i]];}if(tmp&&path[i]){tmp[path[i]]=undefined;}};mstrmojo.util.version=mstrmojo.provide("mstrmojo.util.version",{getResourcePathWithVersion:function(filePath){var versionStr="";if(window.mstrConfig){if(mstrConfig.webVersion){versionStr="?v="+mstrConfig.webVersion+(filePath.indexOf("plugins/")>=0&&mstrConfig.appVersion?"&apv="+mstrConfig.appVersion:"");}}return filePath+versionStr;}});}());
/* -- 
    Mojo JavaScript Library
    Copyright (C) 1996-2011 MicroStrategy Incorporated, All rights reserved. Confidential. 
-- */
(function(){function AX(BB,BC){return BC||(BB||window).event;}function z(BB){var BC=parseInt(BB,10);return BC===null||isNaN(BC)?0:BC;}mstrmojo.PositionType=null;var A6=!!document.all,AV=document.documentMode,AF=navigator.userAgent,y=false,u=false,s=false,q=false,Y=false,W=!A6&&"ActiveXObject" in window,AH=false;A6=A6||W;if(A6){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){y=!!AF.match(/MSIE 6/);u=((!!AF.match(/MSIE 7/)&&!AV)||AV===7);s=(AV===8);q=(AV===9);Y=(AV===10);AH=(!AV||AV<=9);}else{y=!!AF.match(/MSIE 6/);u=!!AF.match(/MSIE 7/);s=!!AF.match(/MSIE 8/);q=!!AF.match(/MSIE 9/);Y=!!AF.match(/MSIE 10/);AH=!Y;}}var p=!A6&&!!AF.match(/Firefox/),AA=0,AG=!!AF.match(/Android/),A5=!!AF.match(/DossierMobile/),Av=!!AF.match(/iPad/),Ac=!!AF.match(/iPhone/),l=!!AF.match(/Macintosh/)&&"ontouchend" in document,Ak=!!document.createTouch||AG,AE=!!AF.match(/PlayBook/),S=!!AF.match(/Windows Phone/),A7=!A6&&!!AF.match(/Trident.*rv/),o=p?"-moz-":(A6||A7)?"":"-webkit-",AW=p?"Moz":(Y||A7)?"":A6?"ms":"webkit",Ah=((Y||A7)?"t":"T"),Ab=AW+Ah+"ransition",m="mstrevent",f=null;function A0(){return AW+Ah+"ransform";}function AS(){return Ab+"Property";}function Z(){return Ab+"Duration";}function R(){return(Y||p)?"transitionend":"webkitTransitionEnd";}function t(){return AW+"BoxShadow";}var A3=A0(),Aq=AS(),AN=Z(),A=R(),AC=t();function Ag(){if(!AA&&p){var BB=AF.match(/.*Firefox\/([\d|\.]*).*/);if(BB){AA=parseFloat(BB[1]);}}return AA;}function Am(){var BC=0,BG=0,BD=window,BE=document,BB=BE.body,BF=BE.documentElement;if(typeof BD.pageYOffset==="number"){BG=BD.pageYOffset;BC=BD.pageXOffset;}else{if(BB&&(BB.scrollLeft||BB.scrollTop)){BG=BB.scrollTop;BC=BB.scrollLeft;}else{if(BF&&(BF.scrollLeft||BF.scrollTop)){BG=BF.scrollTop;BC=BF.scrollLeft;}}}return{x:BC,y:BG};}function AU(BB){BB=BB||0;BB=String(BB);return((BB.indexOf("%",0))!==-1)?BB:(BB+"px");}function Ae(BD,BH,BG,BF,BE){if(!mstrmojo.dom.isWinPhone){BF=(BF||false||this.isHWAccelerated);}else{BF=false;}var BC=BE+(BF?"3d":"")+"(",BB=BF?(","+BG+")"):")";return BC+BD+","+BH+BB;}var As=2,e=3;function AI(BJ,BH,BL,BC,BM){var BK=BJ.style,BF=BK.display,BG=this.windowDim(),BE=Am();BK.display="block";var BI=BG.w-(BC||BJ.clientWidth),BN=Math.max(BG.h-(BM||BJ.clientHeight),0),BB={4:0,5:BI,3:BI/2},BD={1:0,3:BN/2,2:BN};BK.left=BB[BH]+BE.x+"px";BK.top=BD[BL]+BE.y+"px";BK.display=BF;}function AB(BE,BD,BF,BB){if(BE.addEventListener){return BE.addEventListener(BD,BF,!!BB);}BF._id=BF._id||AB.guid++;BE.events=BE.events||{};var BC=BE.events[BD];if(!BC){BC=BE.events[BD]={};if(BE["on"+BD]){BC[0]=BE["on"+BD];}}BC[BF._id]=BF;function BG(BJ){BJ=BJ||window.event;var BI=this.events[BJ.type],BH;for(BH in BI){BI[BH].call(this,BJ);}}BE["on"+BD]=BG;}AB.guid=1;function w(BD,BC,BE,BB){if(!BD){return ;}if(BD.removeEventListener){BD.removeEventListener(BC,BE,!!BB);}else{if(BD.events&&BD.events[BC]){delete BD.events[BC][BE._id];}}}function AT(BB){return(BB.indexOf("mstrApp")===0||BB.indexOf("mstrmojo")===0||BB.indexOf("return ")===0||BB.indexOf("document")===0||BB.indexOf("var w = mstrmojo.all")===0||BB.indexOf("this.style.height =")===0||BB.indexOf("microstrategy.")===0);}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:AF,isIE:A6,isIE6:y,isIE7:u,isIE8:s,isIE9:q,isIE10:Y,isIE11:W,isIEW3C:A7,isNSIE:AH,isDXIE:AH,isFF:p,isWK:!!AF.match(/AppleWebKit/),isSafari:!!AF.match(/Safari/)&&!AF.match(/Chrome/),isChrome:!!AF.match(/AppleWebKit/)&&AF.match(/Chrome/),isEdge:!!AF.match(/Edge/),isHWAccelerated:!AG,isAndroid:AG,isAndroidLibrary:A5,isIPad:Av,isIPhone:Ac,isPlayBook:AE,isWinPhone:S,isMobile:Av||Ac||S||AG,isIOSTouch:(Av||Ac||l)&&!window.MSStream,supportsTouches:Ak,TOUCHSTART:Ak?"touchstart":"mousedown",TOUCHMOVE:Ak?"touchmove":"mousemove",TOUCHEND:Ak?"touchend":"mouseup",TOUCHCANCEL:Ak?"touchcancel":"",RESIZE:Ak?"orientationchange":"resize",CSS3_PREFIX:o,CSS3_BOXSHADOW:AC,CSS3_TRANSFORM:A3,CSS3_TRANSITION:Ab,CSS3_TRANSITION_PROPERTY:Aq,CSS3_TRANSITION_DURATION:AN,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh",INNER_TEXT:"innerText"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},isTouchOptimizationEnabled:function AL(){return A5;},supports:function B(BB){var BC=this.isFF&&Ag();switch(BB){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||BC>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||BC>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);case this.cssFeatures.INNER_TEXT:return !this.isFF||BC>44;}return false;},getOSInfo:function Ad(){var BB="Unknown",BC=navigator.appVersion,BJ=navigator.userAgent,BD=BB;var BI=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var BF;for(BF=0;BF<BI.length;BF++){var BH=BI[BF];if(BH.r.test(BJ)){BD=BH.s;break;}}var BE=BB,BG;if(/Windows/.test(BD)){BG=/Windows (.*)/.exec(BD);BE=BG&&BG[1];BD="Windows";}else{switch(BD){case"Mac OS":BG=/Macintosh.* (\d+[\.\_\d]+)/.exec(BJ);BE=BG&&BG[1];break;case"Android":BG=/Android ([\.\_\d]+)/.exec(BJ);BE=BG&&BG[1];break;case"iOS":BG=/OS (\d+)_(\d+)_?(\d+)?/.exec(BC);BE=BG&&(BG[1]+"."+BG[2]+"."+(BG[3]|0));break;}}return{name:BD,version:BE||BB};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},closest:function At(BC,BB){if(!BC){return null;}if(BC.closest){return BC.closest(BB);}if(!BC.matches){BC.matches=BC.msMatchesSelector||BC.webkitMatchesSelector;}do{if(BC.matches(BB)){return BC;}BC=BC.parentElement||BC.parentNode;}while(BC!==null&&BC.nodeType===1);return null;},animationEndEvtNames:{WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"animationend",animation:"animationend"},replace:function AD(BD,BB){if(BD&&BB){var BC=BD.parentNode;if(BC){BC.replaceChild(BB,BD);}}return BB;},attachEvent:function h(BD,BC,BE,BB){if(BD.addEventListener){return BD.addEventListener(BC,BE,!!BB);}return BD.attachEvent("on"+BC,BE);},detachEvent:function Ao(BD,BC,BE,BB){if(!BD){return ;}if(BD.removeEventListener){BD.removeEventListener(BC,BE,!!BB);}else{BD.detachEvent("on"+BC,BE);}},attachMarkupEvent:function AK(BE,BD,BB){var BC=function(BF){mstrmojo.all[BE].captureDomEvent(BB,window,BF);};this.attachEvent(BD,BB,BC);return BC;},attachOneTimeEvent:function g(BE,BC,BF,BB){var BD=function(BG){BF(BG);if(BB){w(this,BC,BD);}else{mstrmojo.dom.detachEvent(this,BC,BD);}};if(BB){AB(BE,BC,BD);}else{this.attachEvent(BE,BC,BD);}BE=null;return BD;},attachMouseMoveEvents:function D(BE,BB){var BD=this,BC=function(BF){if(BB){BB(BF);}BD.detachEvent(document,"mousemove",BE);BD.detachEvent(document,"mouseup",BC);};BD.attachEvent(document,"mousemove",BE);BD.attachEvent(document,"mouseup",BC);},captureDomEvent:function Aa(BG,BE,BC,BF,BD){var BB=mstrmojo.all[BG];if(BB){BB.captureDomEvent(BE,BC,BF,BD);}},captureEventInfo:function AZ(BE){var BC=mstrmojo.hash.copy(BE,{}),BD=BC.hWin=BC.hWin||window,BB=BC.e=BC.e||BD.event;BC.node=this.eventTarget(BD,BB);BC.pos=this.getMousePosition(BB,BD);return BC;},translate:function P(BD,BC,BG,BF,BB,BE){BB=(BB&&" "+BB)||"";BD.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(BC,BG,BF,BE)+BB;},createTranslateString:function U(BB,BE,BD,BC){BB=AU(BB);BE=AU(BE);BD=AU(BD);return Ae(BB,BE,BD,BC,"translate");},createScaleString:function AJ(BB,BE,BD,BC){BB=BB||0;BE=BE||0;BD=BD||0;return Ae(BB,BE,BD,BC,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(BD,BB,BE,BG){var BC=BD.id+"-"+BB,BF=this._bufferConnects[BC];if(!BF){BF=this._bufferConnects[BC]={elId:BD.id,eventName:BB,timer:null,bufferSize:BG,listeners:[],callback:function(BH){mstrmojo.dom._callback(BH,mstrmojo.global,BC);return true;}};this.attachEvent(BD,BB,BF.callback);}BF.listeners.push(BE);},_callback:function Az(BF,BB,BD){var BE=this._bufferConnects[BD],BG=BE&&BE.timer;if(BE&&!BG){var BC=(BE.bufferSize===null)?this._bufferSize:BE.bufferSize;if(BE.bufferSize){BE.timer=BB.setTimeout(function(){mstrmojo.dom.updateBuffers(BD);},BC);}else{mstrmojo.dom.updateBuffers(BD);}}},updateBuffers:function K(BE){var BF=this._bufferConnects[BE],BC=BF&&BF.listeners,BB=(BC&&BC.length)||0,BD;for(BD=0;BD<BB;BD++){BC[BD]();}if(BF&&BF.timer){delete BF.timer;}},detachBufferedEvent:function AQ(BC,BG,BH){if(!BC){return ;}var BJ=BC.id+"-"+BG,BD=this._bufferConnects[BJ],BF=BD&&BD.listeners,BI=(BF&&BF.length)||0,BE;if(BI){for(BE=BI-1;BE>-1;BE--){if(BF[BE]===BH){BF.splice(BE,1);}}if(!BF.length){this.detachEvent(BC,BG,BD.callback);delete this._bufferConnects[BJ];if(BD.timer){var BB=mstrmojo.global;BB.clearTimeout(BD.timer);}}}},eventTarget:function AO(BB,BC){BC=AX(BB,BC);return BC&&(BC.target||BC.srcElement);},isMac:function AM(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function N(BB,BE){var BD=this.isMac(),BC=AX(BB,BE)||{};return(BC.ctrlKey&&!BD)||(BC.metaKey&&BD);},ctrlKey:function A2(BB,BC){return(AX(BB,BC)||{}).ctrlKey;},shiftKey:function AP(BB,BC){return(AX(BB,BC)||{}).shiftKey;},metaKey:function k(BB,BC){return(AX(BB,BC)||{}).metaKey;},getButton:function Ai(BB,BC){return((Number(AX(BB,BC).button))===2)?2:1;},isPrimaryMouseBtn:function Aw(BC,BB){return this.getButton(BB||window,BC)===1;},isRMC:function Ar(BC,BB){return BC&&(BC.button===2||BC.type==="contextmenu"||this.isMac()&&this.ctrlKey(BB,BC)&&BC.button===0);},getMousePosition:function x(BE,BD){BD=BD||window;var BC,BH;if(mstrmojo.dom.isIE){BE=BE||BD.event;var BF=document,BB=BF.body,BG=BF.documentElement;BC=BE.clientX+BB.scrollLeft+(BG.scrollLeft||0);BH=BE.clientY+BB.scrollTop+(BG.scrollTop||0);}else{BC=BE.pageX;BH=BE.pageY;}return{x:BC,y:BH};},position:function Aj(BC,BD){var BG={x:0,y:0,w:0,h:0};if(BC&&BC.getBoundingClientRect){try{BG=BC.getBoundingClientRect();}catch(BF){BG={left:0,top:0,right:0,bottom:0,height:0,width:0};}BG={x:BG.left,y:BG.top,w:BG.right-BG.left,h:BG.bottom-BG.top};if(this.isIE6||this.isIE7){var BB=BC.ownerDocument;if(BB){var BI=BB.documentElement,BH=BI.getBoundingClientRect();BG.x-=BH.left;BG.y-=BH.top;}}}if(BD){var BE=Am();BG.x+=BE.x;BG.y+=BE.y;}return BG;},delta:function H(BD,BB){BB=BB||document.body;var BC=this.position(BD),BE=this.position(BB);return{x:Math.round(BC.x-BE.x),y:Math.round(BC.y-BE.y)};},windowDim:function X(){var BB=0,BD=0,BE=window,BF=document,BG=BF.documentElement,BC=BF.body;if(typeof (BE.innerWidth)=="number"&&typeof (BE.innerHeight)=="number"){BB=BE.innerWidth;BD=BE.innerHeight;}else{if(BG&&(BG.clientWidth||BG.clientHeight)){BB=BG.clientWidth;BD=BG.clientHeight;}else{if(BC&&(BC.clientWidth||BC.clientHeight)){BB=BC.clientWidth;BD=BC.clientHeight;}}}return{w:BB,h:BD};},center:function AY(BD,BC,BB){AI.call(this,BD,e,e,BC,BB);},bottomCenter:function E(BB){AI.call(this,BB,e,As);},clearBrowserHighlights:function O(BB){BB=BB||self;if(!BB.getSelection){var BH=BB.document,BG=BH&&BH.selection,BE=BG&&BG.empty;if(BE){try{BG.empty();}catch(BD){}}}else{var BC=BB.getSelection,BF=BC&&BB.getSelection();if(BF&&!BF.isCollapsed){if(BF.empty){BF.empty();}else{if(BF.removeAllRanges){BF.removeAllRanges();}}}}},findAncestorByAttr:function Af(BF,BD,BC,BB){var BG=BC?BF:BF&&BF.parentNode;while(BG&&(BG!==BB)){var BE=BG.getAttribute&&BG.getAttribute(BD);if(BE!=null){return{node:BG,value:BE};}BG=BG.parentNode;}return null;},findAncestorByName:function A1(BD,BG,BC,BB){BG=BG&&BG.toLowerCase();var BE=BC?BD:BD&&BD.parentNode;while(BE&&(BE!==BB)){var BF=BE.nodeName;if(BF&&(BF.toLowerCase()===BG)){return BE;}BE=BE.parentNode;}return null;},findAncestorByClassName:function G(BE,BD,BC,BB){if(!BD||!BD.length){return BE;}var BF=BC?BE:BE&&BE.parentNode;while(BF&&(BF!==BB)){var BG=BF.className&&BF.className.indexOf(BD)!==-1;if(BG){return BF;}BF=BF.parentNode;}},contains:function M(BE,BF,BC,BB){var BD=BF;if(!BC){BD=BD.parentNode;}while(BD){if(BD===BE){return true;}if(BD===BB){break;}BD=BD.parentNode;}return false;},toggleSelection:function A8(BC,BB){BC.setAttribute("unselectable",BB?"off":"on");mstrmojo.css.toggleClass(BC,"unselectable",!BB);BC.onselectstart=function(){return BB;};if(!BB){this.clearBrowserHighlights();}},preventDefault:function b(BB,BC){BC=BC||BB.event;if(BC.preventDefault){BC.preventDefault();}else{BC.returnValue=false;}},stopPropogation:function Q(BB,BC){BC=BC||BB.event;if(BC.stopPropagation){BC.stopPropagation();}else{BC.cancelBubble=true;}},firstTouch:function Al(BB,BC){return BC&&BC.touches&&BC.touches.length?BC.touches[0]:(BC||BB.event);},firstChangedTouch:function Au(BB,BC){return BC&&BC.changedTouches&&BC.changedTouches.length?BC.changedTouches[0]:(BC||BB.event);},isLandscape:function a(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function An(BB){while(BB){var BC=BB.mstrmojoId;if(BC!==null&&BC!==undefined){return mstrmojo.all[BC];}BB=BB.parentNode;}return null;},setCaret:function I(BB,BD){if(BB.setSelectionRange){BB.focus();BB.setSelectionRange(BD,BD);}else{if(BB.createTextRange){var BC=BB.createTextRange();BC.move("character",BD);BC.select();}}},setInputSelection:function i(BB){if(BB.select){BB.focus();BB.select();}else{if(BB.createTextRange){BB.createTextRange().select();}}},setElementSelection:function n(BD){if(window.getSelection){var BB=document.createRange(),BC=window.getSelection();BB.selectNodeContents(BD);BC.removeAllRanges();BC.addRange(BB);}else{if(document.body.createTextRange){var BE=document.body.createTextRange();BE.moveToElementText(BD);BE.select();}}},getHorizontalScroll:function A4(){return Am().x;},getVerticalScroll:function AR(){return Am().y;},getMaxScrollHeight:function J(){return mstrmojo.dom.windowDim().h-22;},getComputedScrollbarWidth:function Ax(BC){if(BC){var BB=mstrmojo.css.getComputedStyle(BC);if(BB){return(BC.offsetWidth-z(BB.borderLeftWidth)-z(BB.borderRightWidth)-BC.clientWidth);}}return null;},removeNode:function Ay(BD){var BC=document.getElementById(BD),BB=BC&&BC.parentNode;if(BB){return BB.removeChild(BC);}},redirectUrlToFormWrapper:function Ap(BE){var BD=function BD(BG){BG.preventDefault();var BI=BG.target,BH=BI&&BI.href;if(BH&&window&&window.FormWrapper){window.FormWrapper.openPage(BH.replace(/ /g,"%20"));}};var BF=BE&&BE.getElementsByTagName("a"),BC=BF.length;for(var BB=0;BB<BC;BB++){if(!BF[BB].openWithFormWrapper){BF[BB].addEventListener("click",BD,true);BF[BB].openWithFormWrapper=true;}}},checkTagName:function BA(BC,BB){return BC&&BC.tagName&&BC.tagName.toLowerCase()===BB;},getComputedMargin:function F(BC){var BB=mstrmojo.css.getComputedStyle(BC);return[parseInt(BB.marginTop,10)||0,parseInt(BB.marginRight,10)||0,parseInt(BB.marginBottom,10)||0,parseInt(BB.marginLeft,10)||0];},emptyNode:function c(BB){while(BB&&BB.firstChild){BB.removeChild(BB.firstChild);}},inIframe:function d(){try{return window.self!==window.top;}catch(BB){return true;}},isCSPEnabled:function A9(){if(f===null){try{f=!!mstrmojo.hash.walk("features.contentSecurityPolicy",dossierConfig||null);}catch(BB){f=false;}}return f;},recursiveReplaceInlineEventListeners:function L(BE){if(!this.isCSPEnabled()){return ;}var BB=BE.getAttribute&&BE.getAttribute(m),BC;if(BB){var BF=BB.split(" ");for(BC=0;BC<BF.length;BC++){var BG=BF[BC];this.singleReplaceInlineEventListeners(BE,BG);}BE.removeAttribute(m);}if(BE.hasChildNodes()){var BD=BE.childNodes;for(BC=0;BC<BD.length;BC++){this.recursiveReplaceInlineEventListeners(BD[BC]);}}},singleReplaceInlineEventListeners:function j(BC,BE){var BD="on"+BE;if(BC.hasAttribute(BD)){var BB=BC.getAttribute(BD);if(AT(BB)){this.attachEvent(BC,BE,function(BF){new Function(BB).bind(BC)();});BC.removeAttribute(BD);}}}});}());mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b",KPI_V_SCROLLBAR:"kpi-vertical-scrollbar",KPI_H_SCROLLBAR:"kpi-horizontal-scrollbar"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000,AREA_MAP:1000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumSingleLegendMode:{RESTORE:1,COLLAPSE:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"},TOOLTIP_STATE:{STATE_DEFAULT:0,STATE_SUMMARY:1,STATE_COMBINED:2,STATE_VERTICAL:3,STATE_EMPTY_CONTENT:4},OBJECT_HIGHLIGHT_STATE:{HIGHLIGHT_CONTEXTMENU:0,HIGHLIGHT_SELECTION:1,HIGHLIGHT_COMBINED:2},EnumFeatureFlags:{ftFgGrpA:{HideLegendByDefault:1}}};(function(){mstrmojo._SupportPagination=mstrmojo.provide("mstrmojo._SupportPagination",{_mixinName:"mstrmojo._SupportPagination",supportPagination:true,getPaginationContainer:function D(){return this.domNode;},preExport:function C(){var J=this.getPaginationContainer();if(!J){return ;}var Q=Math.ceil(J.scrollHeight/J.clientHeight)*J.clientHeight,M=Math.ceil(J.scrollWidth/J.clientWidth)*J.clientWidth,N=1,K=1,L=this.canScrollRight()&&Math.abs(M-J.scrollWidth)>N,O=this.canScrollDown()&&Math.abs(Q-J.scrollHeight)>N,P=Math.abs(J.scrollWidth-J.clientWidth)>N,H=Math.abs(J.scrollHeight-J.clientHeight)>N;if(!O||!H){Q=K;}if(!L||!P){M=K;}if(L||O){var I=document.createElement("div");I.innerHTML='<div style="display: inline-block; width: '+M+"px; height: "+Q+'px; visibility: hidden; position: absolute; left: 0; top: 0"></div>';J.appendChild(I.firstElementChild);}},postExport:mstrmojo.emptyFn,canScrollDown:function E(){var H=this.getPaginationContainer();return H&&Math.ceil(H.scrollTop+H.clientHeight)<Math.floor(H.scrollHeight);},canScrollRight:function G(){var H=this.getPaginationContainer();return H&&Math.ceil(H.scrollLeft+H.clientWidth)<Math.floor(H.scrollWidth);},prePrint:mstrmojo.emptyFn,postPrint:mstrmojo.emptyFn,scrollToNextVerticalPage:function B(){if(!this.canScrollDown()){return Promise.reject(new Error("Scrolled to the end vertically."));}var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}var I=H.scrollTop;H.scrollTop+=H.clientHeight;if(Math.abs(H.scrollTop-I)<1){return Promise.reject(new Error("Try to scroll down but failed."));}else{return new Promise(function(K,J){setTimeout(K,0);});}},scrollToNextHorizontalPage:function F(){if(!this.canScrollRight()){return Promise.reject(new Error("Scrolled to the end horizontally."));}var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}var I=H.scrollLeft;H.scrollLeft+=H.clientWidth;if(Math.abs(H.scrollLeft-I)<1){return Promise.reject(new Error("Try to scroll right but failed."));}else{return new Promise(function(K,J){setTimeout(K,0);});}},scrollToFirstHorizontalPage:function A(){var H=this.getPaginationContainer();if(!H){return Promise.reject(new Error("Failed to get container node."));}return new Promise(function(J,I){H.scrollLeft=0;setTimeout(function(){if(H.scrollLeft===0){J();}else{I(new Error("Try to scroll to leftmost side but failed."));}},0);});},});}());(function(){var E=2147762227,A=2147762262,D=2147762890,B=2147762269;mstrmojo.RaErrorHandler=mstrmojo.provide("mstrmojo.RaErrorHandler",{embeddedErrStr:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible"><div class="text ra-limit-err-title" style="padding-top: 0">'+mstrmojo.desc(16605,"QueryEngine encountered error:")+'</div><div class="text">'+mstrmojo.desc(16606,"Maximum number of result rows retrieved per MDX Query was exceeded. Please filter your data.")+"</div></div></div>",handleRAPopUpError:function C(G){var F=parseInt(G.code,10)+4294967296;if(F!==E&&F!==A&&F!==B){if(F===D){var H={shortDesc:'<div style ="font-weight:bold">'+mstrmojo.desc(16605,"QueryEngine encountered error:")+"</div>",longDesc:mstrmojo.desc(16606,"Maximum number of result rows retrieved per MDX Query was exceeded. Please filter your data.")};mstrmojo.error(H);}else{mstrmojo.alert(G.message);}}}});}());mstrmojo.mstr.EnumDSSConsolidationType={DssNormal:0,DssDerivedElement:1,DssRecursiveDerivedElement:2};(function(){function E(H,G,F){return H>=G&&H<=F;}function A(G,F){return{start:G,end:F};}function C(I,G){var L=this.renderedRowsArr,K=B.call(this,I,1),J=K.index,H=L[J],F;if(!K.between){if(H&&I>H.end+1){J++;L.splice(J,0,A(I,G));}else{L.splice(J,0,A(I,G));}H=L[J];}else{H.end=Math.max(H.end,G);}while(J<L.length-1){J++;F=L[J];if(H.end+1>=F.start){H.end=Math.max(H.end,F.end);L.splice(J,1);J--;}else{break;}}}function B(G,L){var K=this.renderedRowsArr,H=0,I=K.length-1,F,J;while(H<=I){F=(H+I)/2|0;J=K[F];if(E(G,J.start,J.end+L||0)){return{between:true,index:F};}else{if(G<J.start){I=F-1;}else{H=F+1;}}}return{between:false,index:F};}mstrmojo._RowRendTracker=mstrmojo.provide("mstrmojo._RowRendTracker",{_mixinName:"mstrmojo._RowRendTracker",renderedRowsArr:undefined,init:function D(F){this._super(F);this.renderedRowsArr=[];},markPages:function(G,F){C.call(this,G,F);},searchRow:function(H){var G=B.call(this,H,0),F;if(G.between){F=this.renderedRowsArr[G.index];return{rendered:true,min:F.start,max:F.end};}return null;},unMarkAllPages:function(){this.renderedRowsArr.length=[];}});}());mstrmojo.vi.models.EnumPanelTypes={GENERIC:0,FILTERS:1,VIS_CONTENT:2,PAGEBY:3,VISUALIZATION:4};mstrmojo.EnumSelectionType={ALL:0,ELEMENT:1,BRANCH:2,LEVEL:3,BRANCH_LEVEL:4};mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}this.destroy();}});}());mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18,Metric:19,Trend:20,Geometry:21};(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function E(F){if(!F||!F.length){return mstrmojo.emptyFn;}return function(){var G=F.length,H;for(H=0;H<G;H++){F[H].apply(this,arguments);}};},wrapMethods:function D(K,I){function J(M,L){L=L||{};mstrmojo.hash.forEach(M,function(N,O){L[O]=(L.hasOwnProperty(O)&&typeof N==="function")?mstrmojo.func.composite([N,L[O]]):N;});return L;}if(arguments.length<3){return J(K,I);}var G=arguments.length,H=[].slice.call(arguments,0,G-1).reverse(),F=arguments[G-1];mstrmojo.array.forEach(H,function(L){F=J(L,F);});return F;},wrapMethodHandlers:function B(K,I){function J(O,L){L=L||{};var N=O.handlerName,M=L.handlerName;if(!L.hasOwnProperty("removeHandler")){L.removeHandler=function(Q,U){var P=L[U+"Array"],S=mstrmojo.array.find(P,"handlerName",this.curHandlerName),R;if(S>-1){for(R=S+1;R<P.length;R++){if(P[R].handlerName===Q){P.splice(R,1);break;}}}};}mstrmojo.hash.forEach(O,function(P,R){if(typeof P==="function"&&R!=="removeHandler"){var Q=R+"Array";O[Q]=O[Q]||[{handlerName:N,fn:P}];if(!L[R]){L[R]=function(){var U=L[Q],S;for(S=0;S<U.length;S++){this.curHandlerName=U[S].handlerName;U[S].fn.apply(this,arguments);}};}}});mstrmojo.hash.forEach(L,function(Q,S){if(typeof Q==="function"&&S!=="removeHandler"){var R=S+"Array",P=L[R]=(O[R]||[]).concat(L[R]||[{handlerName:M,fn:Q}]);L[S]=function(){var W=P,U;for(U=0;U<W.length;U++){this.curHandlerName=W[U].handlerName;W[U].fn.apply(this,arguments);}};}});return L;}if(arguments.length<3){return J(K,I);}var G=arguments.length,H=[].slice.call(arguments,0,G-1).reverse(),F=arguments[G-1];mstrmojo.array.forEach(H,function(L){F=J(L,F);});return F;},override:function A(H,F){var G=function(K,J){return function I(){var M=this._super,L;this._super=J||mstrmojo.emptyFn;try{L=K.apply(this,arguments||[]);}finally{this._super=M;}return L;};};F=F||{};mstrmojo.hash.forEach(H,function(I,J){F[J]=G(I,F[J]);});return F;},throttle:function(H,J,F){var G,L,O,M=null,K=0,N=F||{};var I=function(){K=N.leading===false?0:mstrmojo.date.now();M=null;O=H.apply(G,L);G=L=null;};return function(){var P=mstrmojo.date.now();if(!K&&N.leading===false){K=P;}var Q=J-(P-K);G=this;L=arguments;if(Q<=0){clearTimeout(M);M=null;K=P;O=H.apply(G,L);G=L=null;}else{if(!M&&N.trailing!==false){M=setTimeout(I,Q);}}return O;};},debounce:function(I,K,H){var N,M,G,L,O,F=mstrmojo.date.now;var J=function(){var P=F()-L;if(P<K){N=setTimeout(J,K-P);}else{N=null;if(!H){O=I.apply(G,M);G=M=null;}}};return function(){G=this;M=arguments;L=F();var P=H&&!N;if(!N){N=setTimeout(J,K);}if(P){O=I.apply(G,M);G=M=null;}return O;};},addMethods:function C(G,F){F=F||{};mstrmojo.hash.forEach(G,function(H,I){if(!F.hasOwnProperty(I)&&typeof H==="function"){F[I]=H;}});return F;}});}());(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle",NEW_GRAPH_MATRIX:"NewGraphMatrixVisualizationStyle",MAPBOX:"MapboxVisualizationStyle",KPICARD:"KPICardVisualizationStyle"};(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());(function(){function Q(W,R,S){if(W.nodeType===3&&R){return W;}else{var U=(R&&W.nodeType===1&&W.lastChild)?W.lastChild:F(W,S);return U?D(U,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(W,R,S){if(W.nodeType===3&&R){return W;}else{var U=(R&&W.nodeType===1&&W.firstChild)?W.firstChild:B(W,S);return U?E(U,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(U,W){var R=0,S;if(U.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(U);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(U);R=S.text.length;}}else{R=I(U).length;}return W===R?this.EDGE.EDGE_END:(W===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(W,S){if(!W.offsetParent){return ;}var U=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(W);R.collapse(S);U.removeAllRanges();U.addRange(R);}else{R.moveToElementText(W);R.collapse(S);R.select();}},collapseOnTextNode:function L(W,X){var U=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(W,true);S.setStart(R,X);S.collapse(true);U.removeAllRanges();U.addRange(S);}else{S.moveToElementText(W);S.collapse(true);S.move("character",X);S.select();}},collapseOnTextNodeIE:function C(S,U){var W=M(S,true),R;while(W!==null){R=I(W).length;if(R>=U){this.collapseOnTextNode(W,U);break;}else{U-=R;W=M(W,false);}}},getRangeInfo:function J(Z,g){var b=null,l,e=this.getRange(),d;if(Z&&Z===e.startContainer){var i=e.startContainer.firstChild,W=i&&i.firstChild,f=W&&W.firstChild;if(f){e.setStart(f,e.startOffset);e.setEnd(f,e.endOffset);}}if(window.getSelection){var Y=function(n,p,o){var m=n.cloneRange();m.collapse(o);m.setStartBefore(p);return m.toString().length;},S=e.startContainer,h=e.startOffset;if(S.nodeType===1){h=Y(e,S,true);}b={collapsed:e.collapsed,startContainer:S,startOffset:g?g.startOffset:h};if(!e.collapsed){var X=e.endContainer,R=e.endOffset;if(X.nodeType===1){R=Y(e,X,false);}b.endContainer=X;b.endOffset=R;}b.range=e;}else{var k,c,a=function(p,q){var o=p.duplicate(),m=document.body.createTextRange(),n;o.collapse(q);n=o.parentElement();m.moveToElementText(n);m.setEndPoint("EndToStart",o);return{container:n,offset:m.text.length};},j=a(e,true),U;b={collapsed:(e.compareEndPoints("StartToEnd",e)===0),startContainer:j.container,startOffset:j.offset};if(!b.collapsed){U=a(e,false);b.endContainer=U.container;b.endOffset=U.offset;}}return b;},collapse:function O(S){if(window.getSelection){var U=this.getSelection();if(S){U.collapseToStart();}else{U.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(U);R.select();}},selectMultipleNodes:function N(Y,S,Z,W){var X=this.getSelection(),U=this.getRange();if(window.getSelection){U.setStart(Y,S);U.setEnd(Z,W);X.removeAllRanges();X.addRange(U);}else{Y=(Y.nodeType===3)?Y.parentNode:Y;U.moveToElementText(Y);U.move("character",S);Z=(Z.nodeType===3)?Z.parentNode:Z;var R=document.body.createTextRange();R.moveToElementText(Z);R.move("character",W);U.setEndPoint("EndToStart",R);U.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,UNITCONTAINER:11,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,SHAPE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SURVEYCONTAINER:108,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};mstrmojo.vi.enums.EnumPromptType={RESERVED:0,CONSTANT:1,ATTRIBUTE_LELMENT_LSIT:2,EXPRESSION:3,OBJECTS:4,DIMENSIONALITY:5};(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}if(D.visible){return this._super(D);}var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});}());mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7,MAPBOX:8,KPICARD:9};(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());mstrmojo.vi.enums.EnumCanvasSizeType={AUTOMATIC:1,FIXED_VALUE_RESOLUTION:2,RANGE_RESOLUTION:3,FIXED_ASPECT_RATIO:4};mstrmojo.chart.model.enums.EnumDSSDynamicShortcut={DssDynamicShortcutReserved:0,DssDynamicShortcutAuto:1,DssDynamicShortcutAcrossThenDown:2,DssDynamicShortcutDownThenAcross:3,DssDynamicShortcutColumns:4,DssDynamicShortcutRows:5,DssDynamicShortcutCell:6,DssDynamicShortcutShape:7,DssDynamicShortcutLastOne:8,DssDynamicShortcutRangeEnd:255};mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(H,F,B){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D,I=F.complete||D;this._retrieveItems(H,{success:function(J){E.blockBegin=H;E.blockCount=J.bc||30;E.set("items",(E.concat?(E.items||[]).concat(J.items||[]):(J.items||[])));if(J.totalSize){E.totalSize=J.totalSize;}C(J);},failure:function(J){G(J);},complete:function(J){I(J);}},B);},_retrieveItems:function(D,C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())?this.totalSize:(this.totalSize+1)));},hasPrevious:function(){return this.blockBegin>1;}});}());mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};(function(){mstrmojo.vi._MonitorsLayoutMode=mstrmojo.provide("mstrmojo.vi._MonitorsLayoutMode",{onLayoutModeChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("layoutModeChange",this.id,"onLayoutModeChange");}}});}());mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};mstrmojo.vi.enums.EnumVisFilterType={KEEP_ONLY:0,ADV_QUALIFICATION:1,LINKING:2,DRILLING:3,DOSSIER_LINKING:4};(function(){if(!mstrmojo.PerformanceLogOutput){var G={},D=true;mstrmojo.PerformanceLogOutput=mstrmojo.provide("mstrmojo.PerformanceLogOutput",{mTimers:[],mUseTimer:true,timerId:0,startTimer:function C(L,K){if(this.mUseTimer){if(K&&this.getTimerIdByName(K)>=0){return ;}var J=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:J,desc:L.functionName+": "+L.purpose});if(K){G[K]=J;}return J;}},getTimerIdByName:function F(J){var K=G[J];return isNaN(K)?-1:K;},endTimer:function A(M){var K;if(typeof M==="string"){K=this.getTimerIdByName(M);}else{K=M;}if(this.mUseTimer){var J,P=this.mTimers;if(K===undefined){J=P.pop();}else{var L,R;for(L=0;L<P.length;L++){R=P[L];if(R.timerId===K){J=R;P.splice(L,1);break;}}}if(J){var O=J.desc;var N=new Date()-J.timeStamp;var Q=[O,N];this.visPrint("%c"+J.desc+": "+N+"ms","color: blue");H(Q);delete G[M];}}},visPrint:function I(){if(D&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},recordJSHeapMemory:function E(L){var N=window.performance,M=N&&N.memory;if(this.mUseTimer&&M){L=L?(L+": "):"";var K=["usedJSHeapSize","totalJSHeapSize","jsHeapSizeLimit"],J=this;K.forEach(function(P){var Q=L+P,O=M[P]/1000;J.visPrint("%c"+Q+": "+O+"KB","color: blue");H([Q,O]);});}},exportToCsv:function B(){var K=mstrApp.rootCtrl.docCtrl.model.n+".csv",P=window.perfResults;var Q=function(X,U){var W="";var S=X[U]===null?"":X[U].toString();if(X[U] instanceof Date){S=X[U].toLocaleString();}var R=S.replace(/"/g,'""');if(R.search(/("|,|\n)/g)>=0){R='"'+R+'"';}W+=R;return W+",";};var O="";for(var M=0;M<P.length;M++){O+=Q(P[M],0);}O+="\n";for(var M=0;M<P.length;M++){O+=Q(P[M],1);}O+="\n";var J=new Blob([O],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(J,K);}else{var N=document.createElement("a");if(N.download!==undefined){var L=URL.createObjectURL(J);N.setAttribute("href",L);N.setAttribute("download",K);N.style.visibility="hidden";document.body.appendChild(N);N.click();document.body.removeChild(N);}}window.perfResults=[];}});function H(K){var J=window.perfResults;if(!J){J=window.perfResults=[];}J.push(K);}}})();mstrmojo.chart.model.enums.EnumDSSAxisName={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5,DssAxisDropZoneIndexRoot:8,DssAxisDropZoneIndexEnd:8+255,DssAxisDynamicShortcutRoot:300,DssAxisDynamicShortcutEnd:300+255};(function(){mstrmojo.vi.ui.theme=mstrmojo.provide("mstrmojo.vi.ui.theme",{getThemeClass:function A(){var D=this.parent||this.opener,C="",B;while(D){var E=D.themeClassName;if(E){C=E;break;}B=D.parent||D.opener;if(B===D){break;}D=B;}return C;}});}());mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap={DssXmlAxisNone:0,DssXmlAxisRowsBit:1,DssXmlAxisColumnsBit:2,DssXmlAxisPagesBit:4,DssXmlAxisChaptersBit:8};mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,MSI_GRAPH_NO_DATA:-2147468857,POOL_OBJECT_NOT_FOUND_BY_ID:-2147467398,DOCDATA_PREPARE_TASK_REPORT_INCOMP:-2147466604,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,E_INVALID_EXPRESSION:-2147214839,MSI_ADDUSERJOB_ERROR:-2147209185,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,MSI_SERVER_NOT_FOUND:-2147206923,DFC_QRYENG_RES_TRUNC:-2147205488,MSI_CUBE_NOT_PUBLISHED:-2147072488,MDSVR_E_NO_ID:-2147216373,E_TARGET_PAGE_NOT_FOUND:-2147156940,E_UNUSED:4294967295,MSI_JOB_CANCELED_ERROR:-2147209196,UICMD_DEFAULT_ERROR:10,MDX_LIMIT_ERROR:-2147204406,XJOIN_ERROR:-2147179489};mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());mstrmojo.mstr.EnumDSSXMLObjectSubTypes={Unknown:-1,Reserved:0,Filter:256,CustomGroup:257,Template:512,ReportGrid:768,ReportGraph:769,ReportEngine:770,ReportText:771,ReportDatamart:772,ReportBase:773,ReportGridAndGraph:774,ReportNonInteractive:775,ReportCube:776,ReportIncrementalRefresh:777,ReportTransaction:778,ReportEmmaCube:779,ReportEmmaIncrementalRefresh:780,Metric:1024,SubtotalDefinition:1025,SystemSubtotal:1026,MetricDMX:1027,DssSubTypeMetricTraining:1028,Style:1536,AggMetric:1792,Folder:2048,Device:2304,Prompt:2560,PromptBoolean:2561,PromptLong:2562,PromptString:2563,PromptDouble:2564,PromptDate:2565,PromptObjects:2566,PromptElements:2567,PromptExpression:2568,PromptExpressionDraft:2569,PromptDimty:2570,PromptBigDecimal:2571,Function:2816,Attribute:3072,AttributeRole:3073,AttributeTransformation:3074,AttributeAbstract:3075,AttributeRecursive:3076,Fact:3328,DimensionSystem:3584,DimensionUser:3585,DimensionOrdered:3586,DimensionUserHierarchy:3587,Table:3840,TablePartitionMD:3841,TablePartitionWH:3842,DatamartReport:4096,FactGroup:4352,Resolution:4864,AttributeForm:5376,FormSystem:5377,FormNormal:5378,Schema:5632,Format:5888,Catalog:6144,CatalogDefn:6400,Column:6656,PropertyGroup:6912,PropertySet:7168,DBRole:7424,DBRoleDataImport:7425,DBRoleOAuth:7427,DBRoleGenericDataConnector:7430,DBLogin:7680,DBConnection:7936,Project:8192,ServerDef:8448,User:8704,UserGroup:8705,Transmitter:8705,Configuration:9216,Request:9472,Search:9984,SearchFolder:10240,Datamart:10496,FunctionPackageDefinition:10752,Role:11008,RoleTransformation:11009,SecurityRole:11264,InBox:11520,InBoxMsg:11776,Consolidation:12032,ConsolidationManaged:12033,ConsolidationElement:12288,ScheduleEvent:12544,ScheduleObject:12800,ScheduleTrigger:13056,Link:13312,DBTable:13568,DBTablePMT:13569,TableSource:13824,DocumentDefinition:14080,ReportWritingDocument:14081,DocumentTheme:14082,DrillMap:14336,DBMS:14592,MDSecurityFilter:14848,MonitorPerformance:15104,MonitorJobs:15105,MonitorUserConnections:15106,MonitorDBConnections:15107,PromptAnswer:15232,PromptAnswers:15360,PromptAnswerBoolean:15233,PromptAnswerLong:15234,PromptAnswerString:15235,PromptAnswerDouble:15236,PromptAnswerDate:15237,PromptAnswerObjects:15238,PromptAnswerElements:15239,PromptAnswerExpression:15240,PromptAnswerExpressionDraft:15241,PromptAnswerDimty:15242,PromptAnswerBigDecimal:15243,PromptAnswerInt64:15244,GraphStyle:15616,ChangeJournalSearch:15872,BlobUnknown:16128,BlobOther:16129,BlobImage:16130,BlobProjectPackage:16131,BlobExcel:16132,BlobHTMLTemplate:16133,DashboardTemplate:16384,Flag:16640,ChangeJournal:16896,ExternalShortcutUnknown:17152,ExternalShortcutURL:17153,ExternalShortcutSnapshot:17154,ExternalShortcutTarget:17408,Reconciliation:17664,DerivedAttribute:3077,PaletteSystem:17920,PaletteCustom:17921,Thresholds:18432,SubscriptionAddress:65281,SubscriptionContact:65282,SubscriptionInstance:65283};mstrmojo.vi.controllers.EnumEvents={UPDATE_TOC:"updateTOC",MANIPULATE_LAYOUT:"layoutManipulation",MANIPULATE_PANEL:"panelManipulation",LAST_MODIFIED_CHANGE:"lastModifiedChange",CHANGE_COVER_IMAGE:"changeCoverImage",WSITEM_DRAG_OVER:"WSItemDragOver",WSITEM_DRAG_ENTER:"WSItemDragEnter",WSITEM_DRAG_EXIT:"WSItemDragExit",WSITEM_DROP:"WSItemDrop",CONTENTS_PANEL_VISIBILITY_CHANGE:"contentPanelVisibilityChange",DO_LAYOUT:"doLayout",SELECT_PAGE:"viPageSelected",SELECT_UNIT:"viUnitSelected"};(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var B=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var F=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function C(){return B.slice();},getCustomColors:function E(){return F.slice();},addCustomColor:function D(I,H){var G=function(J){return J.id===I;};if(!B.filter(G)[0]&&!F.filter(G)[0]){F.push({n:I,id:I});if(!H){if(F.length>8){F.shift();}}}},removeCustomColor:function A(G){F=F.filter(function(H){return !mstrmojo.hash.equals(H.id,G);});}};}());(function(){mstrmojo.requiresDescs(2121,2122,2125,2127,2123,2124,2126,2128,2129,2130);var A=mstrmojo.desc;mstrmojo.EnumSubtotals={};mstrmojo.EnumSubtotals.TYPES=[{n:A(2121,"Total"),v:-10},{n:A(2122,"Average"),v:-12},{n:A(2125,"Maximum"),v:-14},{n:A(2127,"Minimum"),v:-13},{n:A(2123,"Count"),v:-11},{n:A(2124,"Geometric Mean"),v:-20},{n:A(2126,"Median"),v:-16},{n:A(2128,"Mode"),v:-17},{n:A(2129,"Product"),v:-15},{n:A(2130,"Standard Deviation"),v:-18},{n:A(2132,"Variance"),v:-19}];})();mstrmojo.EnumDSSDisplayMode={RESERVED:0,GRID:1,GRAPH:2,ENGINE:3,TEXT:4,DATAMART:5,BASE:6,GRIDGRAPH:7,NONINTERACTIVE:8};(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){if(!mstrmojo.LoadedExternalJSURLs){mstrmojo.LoadedExternalJSURLs={};}var LOADING_STATUS={LOADING:0,LOADED:1};function getUrl4AllPlatform(url){if(url.substr(0,7)==="file://"){url=url.substr(7);}else{if(mstrApp.isSingleTier&&url.substr(0,4)!=="http"){url="http:"+url;}}return url;}window.LoadScriptsExternalJSCallback=function(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]={status:LOADING_STATUS.LOADED};mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;};if(!mstrmojo._LoadsScript){mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(n){if(!n){return false;}if(typeof this[n]==="function"){return true;}var fqcn=this[n]||(this.methods&&(this.methods[n]||this.methods["*"]));if(typeof fqcn==="string"){this.requiresCls(fqcn);return typeof this[n]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(propName,bForceStartup){var fqcn=this[propName];if(fqcn){var c,firstTime=false;if(typeof fqcn==="string"){c=mstrmojo.registry.ref(fqcn);this[propName]=c;firstTime=true;}else{c=fqcn;}if(c&&(firstTime||bForceStartup)){c.parent=this;if(c.startup){c.startup();}}return c;}return null;},requiresExternalScripts:function requiresExternalScripts(esScripts,callback,context){if(esScripts&&esScripts instanceof Array){if(esScripts.length===0){if(callback){callback.call(context);}return false;}var nextScriptConfig=esScripts[0],originalUrl=nextScriptConfig&&nextScriptConfig.url,scriptLoadedInfo=mstrmojo.LoadedExternalJSURLs[originalUrl],onScriptLoaded=function(){esScripts.splice(0,1);return this.requiresExternalScripts(esScripts,callback,context);}.bind(this);if(nextScriptConfig&&nextScriptConfig.forceReload===false&&scriptLoadedInfo){if(scriptLoadedInfo.status===LOADING_STATUS.LOADED){return onScriptLoaded();}else{return scriptLoadedInfo.onLoadedCallbacks.push(onScriptLoaded);}}var script=document.createElement("script"),isIE=!!document.all,onError=nextScriptConfig.onError;script.type="text/javascript";script.src=getUrl4AllPlatform(originalUrl);if(onError){script.onerror=function(){if(onError&&onError.callback&&context){onError.callback.call(context,onError.params);}};}var callbackParamName=nextScriptConfig.callbackParamName;if(!callbackParamName){var onScriptFirstLoaded=function(){var loadedInfo=mstrmojo.LoadedExternalJSURLs[nextScriptConfig.url],onLoadedCallbacks=loadedInfo&&loadedInfo.onLoadedCallbacks;loadedInfo.status=LOADING_STATUS.LOADED;onScriptLoaded();if(loadedInfo&&onLoadedCallbacks.length>0){var i=0;for(;i<onLoadedCallbacks.length;i++){onLoadedCallbacks[i]();}loadedInfo.onLoadedCallbacks=[];}};if(isIE){script.onreadystatechange=function(){if(script.readyState==="loaded"||script.readyState==="complete"){script.onreadystatechange=null;script.onerror=null;onScriptFirstLoaded();}};}else{script.onload=function(){script.error=null;script.onload=null;onScriptFirstLoaded();};}}else{if(callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var that=this;window.setTimeout(function(){that.requiresExternalScripts(esScripts,callback,context);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;script.src+="&"+callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=esScripts;mstrmojo._LoadsScript.callback=callback;mstrmojo._LoadsScript.esScritsContext=context;}}mstrmojo.LoadedExternalJSURLs[originalUrl]={status:LOADING_STATUS.LOADING,onLoadedCallbacks:[]};document.getElementsByTagName("head")[0].appendChild(script);}}});}}());mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};(function(){mstrmojo.requiresDescs(9380,9381,9382,9383,9384,9385,9379,15106,15107,10639,10159,9705,9704);mstrmojo.DI.DIConstants=mstrmojo.provide("mstrmojo.DI.DIConstants",{invalidObjectNameChars:'\\"[]',invalidObjectNameCharsRegex:/[\\"\[\]]/,acceptFileTypes:".xls,.xlsx,.csv,.txt,.tsv,.prn,.json,.sas7bdat,.geojson,.kml",acceptFileTypesMatcher:/(\.xls|\.xlsx|\.csv|\.txt|\.tsv|\.prn|\.json|\.sas7bdat|\.geojson|\.kml)$/i,sourceItemLinkType:{dbList:0,oauthPara:1},setDefaultOAuthParamCMD:"MSTR_DEFAULT_OAUTH_PARAMS",actions:{none:0,importSource:1,editImport:2,transform:3,changeSheet:4,publish:5,changeMappings:6,refine:7,quickPreview:8,savePublish:9,getFlatPreview:10,refreshData:11,mergeCube:12},ccActions:{data:1,logout:2},localStorageKey:{HGOSFileTypeTooltipPop:"HGOSFileTypeTooltipPop"},requestFlag:{mapping:1,preview:2,sourceInfo:4,refineSourceInfo:8,sheets:16,crb:32,transformations:64,transformedPreview:128,relationship:256,stateInfo:512,anyState:268435456,fullData:1024,refineInnerData:2048},formMappingFlag:{formMappingFlagReserved:0,formMappingFlagRemoveGeoRole:1,formMappingFlagRemoveTimeRole:2,formMappingFlagRemoveDeriveFlags:4},browseFlag:{reportBindingTable:1,dataPreview:4,publish:16,cubeConfig:68,reportLevelProperty:256},importBehaviorFlag:{reserved:0,newColumnsSilent:1,dataTypeSilent:2},saveAsFlags:{saveAsOverWrite:32,saveAsManaged:524288,saveAsDDA:33554432,saveAsInMemory:67108864,saveAsWithPrompts:4096,saveAsWithAnswers:4},connectLiveSupport:{connectLiveSupportUnknown:0,connectLiveSupportDDAOrInMemory:1,connectLiveSupportInMemoryOnly:2,connectLiveSupportDDAOnly:3},xdaType:{excel:272,text:288,refine:384,salesforce:337,querybuilder:352,ffsql:304,mdx:2,customFreeFormSQL:3,googleAnalytics:390,googleBigQuery:341,googleBigQueryFFSQL:342,googleBigQuerySingleTable:345,qbSingleTable:368,twitter:343,facebook:344,dataImport:256,projectsImport:400,sparkDataset:416,cloudConnector:600,dataImportFileExcel:16|256,dataImportFileText:32|256,dataImportCustomSQL:48|256,dataImportTable:64|256,dataImportOAuth:80|256,dataImportBISource:144|256,dataImportOAuthSalesforce:1|336,dataImportOAuthGDocs:2|336,dataImportOAuthGDrive:2|336,dataImportOAuthDropbox:3|336,dataImportOAuthGAnalytics:4|336,dataImportOAuthGBigQuery:5|336,dataImportOAuthGBigQueryFFSQL:6|336,dataImportOAuthGBigQuerySingleTable:9|336,spark:160|256},fileTypes:[{n:"CSV/TXT",v:"CSV"},{n:"PARQUET",v:"PARQUET"},{n:"AVRO",v:"AVRO"},{n:"ORC",v:"ORC"},{n:"JSON",v:"JSON"},{n:"PARQ",v:"PARQUET",visible:false}],sourceInfoDesc:{json:"DB_FILE_TYPE_JSON"},sourceType:{file:1,salesforce:2,dropbox:3,googleDrive:4,googleAnalytics:5,googleBigQuery:6,querybuilder:7,mstrFile:8,mdx:9,hadoop:10,twitter:11,facebook:12,bisource:13,remoteProject:14,importfromcube:15,dataFromPushApi:16,newConnector:17,cloudElement:18,dbRoleOAuth:19,ccOAuth:20},sourceSubtype:{localFile:1,url:2,salesforce:3,dropbox:4,googleDrive:5,googleAnalytics:6,googleBigQuery:7,querybuilder:8,samplefile:9,clipboard:10,googleBigQueryFFSQL:11,searchOnSource:12,mdx:13,hadoop:14,twitter:15,facebook:16,bisource:17,remoteProject:18,googleBigQuerySingleTable:19,hanaSingleTable:20,publicData:21,importfromcube:22,dataFromPushApi:23,cloudElement:24,mstrConnector:25,dbRoleOAuth:26,s4hana:27,amazonS3:28,azureDataLake:29,ccOAuth:30,googleCloudStorage:31,bw4hana:32,sapBW:33,sapECC:34,salesforceSandbox:35},backendSourceSubtype:{localFile:65537,url:65539,samplefile:65540,clipboard:65538,newConnector:65544,cloudElement:65552,hadoopFileBrowser:65541,customSQL:131073,customSQLWizard:131074,singleTable:131075,bISources:131076,searchAsASource:131078,salesforce:196609,dropbox:196610,facebook:196611,twitter:196612,googleDrive:196613,googleAnalytics:196614,googleBigQuery:196615,googleBigQueryFFSQLModel:196616,googleBigQuerySingleTable:196617,OLAPSources:327681,publicData:65542,dataFromPushApi:65543,dataFromPushApiV2:65545,s4hana:393217,bw4hana:393218,sapBW:393219,sapECC:393220},sourceItemType:{file:0,url:1,database:2,hadoop:3,olap:4,publicData:5,salesforce:6,googleAnalytics:7,googleBigQuery:8,googleDrive:9,dropbox:10,searchAsASource:11,clipboard:12,bISources:13,facebook:14,twitter:15,samplefile:16,importFromCube:17,addNewConnector:18,newConnector:19,cloudElement:20,mstrConnector:21,s4hana:22,amazonS3:23,azureDataLake:24,googleCloudStorage:25,bw4hana:26,sapBW:27,sapECC:28,financialforce:29,veevacrm:30,servicemax:31,nativeSDKConnector:32,unknow:-1},columnState:{reserved:0,unchanged:1,newColumn:2,missing:4,changed:8},operationMode:{create:0,edit:1,refresh:2,subscribe:3,enterCredentials:4,oauth:5,pickTable:6,hadoopPickTable:7,ffsql:8,hadoopFFsql:9},statusCode:{obtainSource:-2147071874,xformsError:-2147071872,mappingError:-2147071871,edit:1,republish:2,schedule:3,enterCredentials:4,pickTable:5,hadoopPickTable:6,ffsql:7,hadoopFFsql:8},pageType:{intro:0,file:1,database:2,emmaPreview:3,redirect:4,analytics:5,dataSelection:6,suggestNewSource:7,sourceIntro:8,sourceObjects:10,sampleFiles:11,dataset:12,externalPage:13,preview:14,clipboard:15,refine:16,parse:17,mstrFile:18,allProjectSource:19,hadoop:20,twitter:21,facebook:22,sourceObjectsDnD:23,schedule:24,publicData:25,republish:26,sourceAdmin:27,importFromCube:28,addNewConnector:29,newConnector:30,addConnectorList:31,cloudElement:32,s4hana:33,cloudConnector:34},backendError:{overwriteObject:-2147212339,noPermission:-2147214579,invalidObjectName:-2147213715,unexpectedDataType:-2147212539,noExternalSession:-2147071844,noPrivilege:-2147212082,salesforceUnsavedReport:-2147212081,salesforceObsoleteReport:-2147212080,maxSizeExceeded:-2147212076,maxSizeExceededURL:-2147212121,salesforceUnresolvedFilter:-2147212074,incrementalRefresh:-2147212287,invalidUrl:-2147212062,fileVersionError:-2147212064,emptySheet:-2147212144,refreshTokenUnavailable:-2147202875,cubeQuotaExceeded:-2147071825,notEnoughSpace:-2147071811,importedURLInvalid:-2147212122,unsupportedFileFormat:-2147212063,objectNameTooLong:-2147217407,noExternalSourceInfo:-2147215346,memoryConsumptionExceeded:-2147215346,cubeQuotaReached:-2147071870,switchingFileType:-2147212140,memoryGovernSizeExceeded:-2147181051,stringTooLong:-2147213718,missingColumn:-2147071871,dataDiscoveryError:-2147211998,refineApplyError:-2147202299,serverOutOfMemory:-2147212055,columnCountMatchError:-2147467259,incompatibleDataTypeError:-2147211983,reportTimeout:-2147212335,requestTimeout:-2147206497,databaseCredentialsNotAvailable:-2147212037,ddasupportIncompatible:-2147215326,mergeInvalidXdatype:-2147215325,notFullyControl:-2147214579,shouldBeIgnored:-2147212123,CECredentialNotAvailable:-2147215317,AuthenticationError:-2147215346,queryEngineGeneralError:-2147212544,objectNotFound:-2147216373,clientSecretNotFound:-2147180962,retrieveRefreshTokenFailed:-2147202857,cancelPublishFailed:-2147463843,invalidArgumentError:-2147024809},transformation:{xtab:1,delimiter:2},application:{platform:"Platform",cloudPersonal:"Personal",cloudProfessional:"Professional"},refreshOptions:{replace:1,append:2,update:4},cubeRefreshType:{dummy:-1,reserved:0,add:1,remove:2,update:3,upsert:4,addNewTable:5,deleteTable:6,replaceTable:7,preserve:8},tableStatsExecutionAction:{reserved:0,forceExecution:1,ignore:4,requireFreshData:268435456},sourcesInfoFlags:{none:0,getReports:1,getUserName:2,getTokensInfo:4,revokeSession:8,getGAnalyticsAccount:64},queryBuilderType:{individualTable:1,multipleTables:2,queryScript:3},relationshipEditType:{create:1,changeERType:2,remove:3,flip:8001},ERType:{reserved:0,ERType11:1,ERType1M:2,ERTypeM1:3,ERTypeMM:4,ERTypeParallel:5,ERTypePerpendicular:6},RSType:{reserved:0,auto:1,geo:2,defined:3},tableStates:{newly:1,old:2},behaviorChangeFlag:{multiSheet:4,remapping:8,refreshData:16},menuItems:{SEPARATOR:-1,NONE:0,TABLE_RENAME:1,DO_NOT_IMPORT:2,FLIP_ORDER:3,DELETE:4,RELATIONSHIP_TYPE:5,ONE_TO_ONE:6,ONE_TO_MANY:7,MANY_TO_ONE:8,MANY_TO_MANY:9,REMOVE:10,REFRESH_DATA:11,REFINE:12,CANCEL_REFINE:13,UNLINK:14,CHANGE_DATA_TYPE:15,MARK_GEO_ROLES:16,CREATE_TIME_ATTRIBUTES:17,TO_METRIC:18,TO_ATTRIBUTE:19,MAP_TO_PROJECT_ATTRIBUTE:20,UNMAP:21,MODIFY_ATTRIBUTE_GROUP:22,CREATE_ATTRIBUTE_GROUP:23,HIDE_ALL_ATTRIBUTE_FORMS:24,DEFINE_RELATIONSHIPS:25,LINK:26,ITEM_RENAME:27,CREATE_MULTIFORM_ATTRIBUTE:28,EDIT_MULTIFORM_ATTRIBUTE:29,ADDTO_MULTIFORM_ATTRIBUTE:30,SHOW_ALL_ATTRIBUTE_FORMS:31,SHOW_ALL_COLUMNS:32,PARTITION:33,REFINE_RENAME:34,REFINE_DELETE:35,REFINE_DELETE_ALL:36,REFINE_RESET:37,REFINE_RESET_ALL:38,PARSE:39,IMPORT:40,UNLINK_ALL:41,CREATE_HIERARCHY_ATTRIBUTE:42,EDIT_HIERARCHY_ATTRIBUTE:43,RESET_HIERARCHY_ATTRIBUTE:44,DESCRIPTION:45,EDIT_PROJECT_ATTRIBUTE:46},dataTypeMenuItems:{DATE_TIME:"1",NUMBER:"2",TEXT:"3",URL:"5",EMAIL:"6",HTML_TAG:"7",DATE:"8",TIME:"9",SYMBOL:"10",BIG_DECIMAL:"11",PHONE_NUMBER:"12"},columnDataTypes:{reserved:0,integer:1,unsigned:2,numeric:3,decimal:4,real:5,dtdouble:6,dtfloat:7,dtchar:8,varChar:9,longVarChar:10,binary:11,varBin:12,longVarBin:13,date:14,dttime:15,timeStamp:16,nChar:17,nVarChar:18,nlong:22,bigDecimal:30,cellFormatData:31,utf8Char:33,int64:34},formsOptions:{CREATE_MULTIFORM_ATTRIBUTE:1,EDIT_MULTIFORM_ATTRIBUTE:2,ADDTO_MULTIFORM_ATTRIBUTE:3},hierarchyOptions:{CREATE_HIERARCHY_ATTRIBUTE:1,EDIT_HIERARCHY_ATTRIBUTE:2,RESET_HIERARCHY_ATTRIBUTE:3},rdcsFlag:{ID:1,JOIN_ID:2,FILTER_ID:3,DISTANCE:4},timeRoles:{NONE:0,DATE:1,DATE_TIME:2,TIME:3,SECOND:4,MINUTE:5,HOUR:6,DAY:7,WEEK:8,MONTH:9,QUARTER:10,YEAR:11},contextMenuType:{ITEM_MENU:0,TABLE_MENU:1,PREVIEW_ITEM_MENU:2,LINK_MENU:3},dialogType:{fixRefreshErrorDialog:1,allObjectsViewDialog:2,missingColumnsDialog:3,diPageDialog:4,refreshHistoryDialog:5,alternateSourceValidateDialog:6,ddaConfirmDialog:7,publishStatusDialog:8,saveAsDialog:9,cubesList:10,refinePage:11,multiFormEditor:12,sheetsSelectionDialog:13,partitionGroupDialog:14,parseDataDialog:15,errorDialog:16,warningDialog:17,relationDefineDialog:18,qbImportOptionDialog:19,previewRenameDialog:20,mapProjectsAttributeDialog:21,setOAuthParaDialog:22,objectPicker:23,refineClusteringPage:24,refineExtractDialog:25,refineImportDialog:26,twitterAdvOptDialog:27,credentialsDialog:28,mapProjectsAttributeDialog2:29,setWhiteListDialog:30,binaryUploadDialog:31,authenticationDialog:32,sharingDialog:33,hadoopGatewayManagerDialog:34,hadoopGatewayDialog:35,addConnectorDialog:36,hierarchyAttributeDialog:37,hierarchyAttributeResetDialog:38,objectDescDialog:39,mstrConnectorConfigDialog:40,nativeSDKConnectorOAuthConfigDialog:41,sharepointFilesConfigDialog:42,salesforceEnvironmentDialog:43},dataEvents:{DATA_PREVIEW_EVENT:"dataReturned",NO_DATA_RETURNED_EVENT:"noDataReturned"},cubeSchedStatus:{unexecuted:1,successful:2,unscheduled:3,failed:4},privilegeType:{accessDatabase:1,accessFile:2,accessCloud:3},displayOption:{relational:1,mdx:2,SearchEngine:4,webServices:8,bigData:16,hadoop:32},dbType:{MS_ACCESS:100,ORACLE:200,SQL_SERVER:300,INFORMIX:400,SYBASE:500,REDBRICK:600,DB2:700,TANDEM:800,TERADATA:900,UNKNOWN:1000,GENERIC:1100,SAP:1200,NETEZZA:1300,EXCEL:1400,MSFT_AS:1500,ESSBASE:1600,MYSQL:1700,POSTGRESQL:1800,HPNEOVIEW:1900,METAMATRIX:2000,DATALLEGRO:2100,COMPOSITE:2200,ASTER:2300,VERTICA:2400,OPENACCESS:2500,SYBASE_SQL_ANY:2600,SYBASE_IQ:2700,PARACCEL:2800,TM1:2900,XQUERY:3000,HIVE:3100,SAND:3200,SALESFORCE:3300,HIVETHRIFT:3400,VECTORWISE:3500,ENTERPRISEDB:3600,KOGNITIOWX2:3700,EXASOLUTION:3800,INFORMATICA:3900,SAPHANA:4000,IMPALA:4100,AMAZON_REDSHIFT:4200,DENODO:4300,GOOGLE_DRIVE:4400,DROPBOX:4500,GOOGLE_ANALYTICS:4600,GOOGLE_BIGQUERY:4700,CONNECTION_CLOUD:4800,GOOGLE_BIG_QUERY_FFSQL_MODEL:4900,PARSTREAM:5100,MONGODB:5200,MARKLOGIC:5300,BIG_DATA_ENGINE:5400,SEARCH_ENGINE_SOLR:5500,SPLUNK:5600,TWITTER:5700,FACEBOOK:5800,PIG:6400,MEMSQL:6700,URL:7700,newConnector:7900,LOCALFILE:8200,SAPHANAMDX:18300,SNOWFLAKE:7600,SAPS4HANA:11300,SAPBW4HANA:11500,SAPBW:13700,SAPECC:13800,MicrosoftDynamics365:13900,CLOUD_GATEWAY_S3:18500,CLOUD_GATEWAY_ADLS2:18600,CLOUD_GATEWAY_GCS:18700,KYVOSMDX:18800,KYLIGENCEMDX:18900},getCubeQuotaAndInfosOptions:{GetCubeQuotaAndInfosReserved:0,GetCubeQuotaAndInfosDefault:1,GetCubeQuotaAndInfosQuotaOnly:2,GetCubeQuotaAndInfosAll:3,GetCubeQuotaAndInfosVI:4},homepageViewMode:{GRID_VIEW:0,LIST_VIEW:1},datasetServeMode:{inMemory:1,dda:2,unknow:3},cubePollStatus:{msgID:0,result:1,prompt:2,error:3,xmlResult:21},ibmDb2Versions:[17,18,21,22,23,24,25,37,45,46,47,48,63,66,74,89,92,101,103,105,123,134,157,172,202,232,268],hadoopDbTypes:[3100,1100,700,4100,7300,6800,6400,8100],formCategory:{longitude:"2345134F4F5E261C3BB902A874467080",latitude:"B191051C48221A6AE44CA2B65B1B65E3"},formCategoryName:{ID:"ID",DESC:"DESC",GEOMETRY:"Geometry"},urlAuthDBRoles:{anonymous:"CB1CB472A07E41D5AE038232839F2064",windows:"95A5ACC02FE94CBABCB65E4F2D2415B2",kerberos:"317D6F016D784836A724AD4D739E1E9C",integrated:"E966E1A0A4C949108287B2E5086B68EB"},urlAuthDBMSId:"497F2406FA154B86810C71EA3D401D6D",newConnectorDBMSId:"565D5DC3A1124726B85FE53EF992472A",s4AuthDBMSId:"E4A10C0974334E5F985F941A78E43987",bw4AuthDBMSId:"CAEDBBE4FF43473A932592DD58034DF7",sapBWAuthDBMSId:"F51360595B6A4A49A3576479BC358E58",sapECCAuthDBMSId:"4E9D233B34134347A5C61AC5D1CBBE91",dbms:{cloudGatewayS3:"CD24C7F473194C5984A0B2F8AEF688F7",cloudGatewayGCS:"0ED3A7C42FF3452ABB22F0E18297E98C",cloudGatewayADLS2:"D649DA37F4514289AA44D93B128F3BD5",SQLDataBaseforWindowsAzure:"68CD44338CF911D5801122C04F780609",Azure_DW:"19AF6FB465F04552A872D7FB5CC79952"},hadoopGateWay:{HGoS_CONFIG_HAS_EXIT:1510,CONNOT_AUTHENTICATE:1511,SPACE_OVER:1512,FAIL_COPY_TO_HOST:1513,INSUFFICIENT:1514,DIRECTORY_NO_EXIST:1515,HGOS_DEPLOYED:1518,HGOS_DEPLOYING:1519,CONNOT_AUTHENTICATE2:1520,HGOS_RUNNING:1521,HGOS_STOPPED:1522,HGOS_NOT_DEPLOYING:1523,HGOST_TAR_NOT_EXIST:1524,HGOS_CONF_NOT_EXIST:1530},workstation:{filerBreakLine:new RegExp("[\r\n]","g"),utils:{shouldShowTitleBar:function(){var A=mstrApp.getRootController().rootView.inPageDialog;return !!mstrApp.isWorkstation&&(!!mstrApp.isPopup||!!A);},shouldHideTitleBar:function(){var A=mstrApp.getRootController().rootView.inPageDialog;return !!mstrApp.isWorkstation&&!mstrApp.isPopup&&!A;},setNativeWindow:function(C,F){var B=1010,E=552,D=parseInt(C,10),A=parseInt(F,10);if(C.match(/%$/)&&F.match(/%$/)){window.FormWrapper.setWindowContentSize(1200,680);}else{D=D<B?B:D;A=A<E?E:A;window.FormWrapper.setWindowContentSize(D,A);}},lockResize:function(){if(!window.FormWrapper||!window.FormWrapper.lockResize){return ;}window.FormWrapper.lockResize();},unlockResize:function(){if(!window.FormWrapper||!window.FormWrapper.unlockResize){return ;}window.FormWrapper.unlockResize();}}},authMode:{ANONYMOUS:0,UNAME:1,OAUTH:2,CC:3},authModePrefix:{ANONYMOUS:"AuthMode=Anonymous;URL=",UNAME:"AuthMode=Basic;URL=",OAUTH:"AuthMode=OAuth;URL=",CC:"AuthMode=CC;URL="},sdkUrl:{MARKPLACE_URL:"https://community.microstrategy.com/s/gallery?tabset-89baf=202df",QUICK_START_URL:"https://lw.microstrategy.com/msdz/MSDL/GARelease_Current/docs/projects/DataConnectorSDK/Content/topics/Quick_Start_Guide.htm"},originalConnector:{elastic:"DE4A8E15405A36D80BF1E1A2BA6F9B66",tapClicks:"1E8ADD3975DA4609B8D00E6211ACAB6A"},googleAnalyticsUrl:{queryExplorer:"https://ga-dev-tools.appspot.com/query-explorer/"},weekDay:[{n:mstrmojo.desc(9380,"Monday"),v:0},{n:mstrmojo.desc(9381,"Tuesday"),v:1},{n:mstrmojo.desc(9382,"Wednesday"),v:2},{n:mstrmojo.desc(9383,"Thursday"),v:3},{n:mstrmojo.desc(9384,"Friday"),v:4},{n:mstrmojo.desc(9385,"Saturday"),v:5},{n:mstrmojo.desc(9379,"Sunday"),v:6}],dateMon:[{n:mstrmojo.desc(15106,"1st day"),v:"1"},{n:mstrmojo.desc(15107,"15th day"),v:"15"}],timeOfDay:[{n:"12:00AM",v:"12:00AM"},{n:"1:00AM",v:"1:00AM"},{n:"2:00AM",v:"2:00AM"},{n:"3:00AM",v:"3:00AM"},{n:"4:00AM",v:"4:00AM"},{n:"5:00AM",v:"5:00AM"},{n:"6:00AM",v:"6:00AM"},{n:"7:00AM",v:"7:00AM"},{n:"8:00AM",v:"8:00AM"},{n:"9:00AM",v:"9:00AM"},{n:"10:00AM",v:"10:00AM"},{n:"11:00AM",v:"11:00AM"},{n:"12:00PM",v:"12:00PM"},{n:"1:00PM",v:"1:00PM"},{n:"2:00PM",v:"2:00PM"},{n:"3:00PM",v:"3:00PM"},{n:"4:00PM",v:"4:00PM"},{n:"5:00PM",v:"5:00PM"},{n:"6:00PM",v:"6:00PM"},{n:"7:00PM",v:"7:00PM"},{n:"8:00PM",v:"8:00PM"},{n:"9:00PM",v:"9:00PM"},{n:"10:00PM",v:"10:00PM"},{n:"11:00PM",v:"11:00PM"}],schedule:{DAILY:"Daily",WEEKDAY:"Weekday",WEEKLY:"Weekly",MONTHLY:"Monthly"},mainPage:{GRID_MODE:0,LIST_MODE:1},sourceIconClsName:{0:"ds-Generic",1:"ds-DB2",2:"ds-DB2",3:"ds-DB2",4:"ds-InformixWire",5:"ds-InformixXPS",6:"ds-PostgreSQL",7:"ds-SAP",8:"ds-SAP",9:"ds-Oracle",10:"ds-MicroSoft",11:"ds-Teradata",12:"ds-MySQL",13:"ds-GreenPlum",14:"ds-Netezza",15:"ds-WebServices",17:"ds-Infobright",18:"ds-Salesforce",19:"ds-MicroSoft",20:"ds-Actian-n",21:"ds-Amazon-Redshift",22:"ds-Impala",23:"ds-Aster",25:"ds-Actian-n",26:"ds-EnterpriseDB",27:"ds-Vertica",28:"ds-Denodo",29:"ds-CiscoDataVirtualization",31:"ds-MicroSoft",32:"ds-GoogleBigQuery",33:"ds-SAP",35:"ds-IBMBigInsights",39:"ds-TM1",41:"ds-WebServices",43:"ds-Amazon-EMR",44:"ds-Apache-Hive",45:"ds-ClouderaHive",46:"ds-HortonworksHive",47:"ds-MapRHive",48:"ds-apache",49:"ds-SharkSpark",50:"ds-MongoDB",52:"ds-MariaDB",51:"ds-MarkLogic",54:"ds-Splunk",55:"ds-DataDirectCloud",56:"ds-ParStream",58:"ds-Phoenix",59:"ds-MicroSoft",60:"ds-DB2",61:"ds-Oracle",62:"ds-Teradata",63:"ds-SAP",65:"ds-PostgreSQL",66:"ds-MySQL",67:"ds-MariaDB",68:"ds-Amazon-EMR",69:"ds-Apache-Hive",70:"ds-ClouderaHive",71:"ds-HortonworksHive",72:"ds-MapRHive",73:"ds-SharkSpark",75:"ds-Amazon-Redshift",76:"ds-PIVOTALHAWQ",77:"ds-MemSQL",78:"ds-Arcadia-Platform",79:"ds-Altibase",80:"ds-MongoDB",81:"ds-Presto",82:"ds-DB2",83:"ds-DB2",84:"ds-InformixWire",85:"ds-SAP",86:"ds-MicroSoft",87:"ds-MicroSoft",88:"ds-MemSQL",90:"ds-GreenPlum",91:"ds-PIVOTALHAWQ",92:"ds-Netezza",93:"ds-Infobright",94:"ds-Actian-n",95:"ds-Impala",96:"ds-IBMBigInsights",97:"ds-Aster",99:"ds-Actian-n",100:"ds-EnterpriseDB",101:"ds-Vertica",102:"ds-Denodo",103:"ds-CiscoDataVirtualization",105:"ds-DataDirectCloud",106:"ds-ParStream",107:"ds-Arcadia-Platform",109:"ds-Presto",110:"ds-Phoenix",111:"ds-Kognitio",112:"ds-Kognitio",113:"ds-Informatica",114:"ds-Informatica",115:"ds-Apache-Cassandra-JDBC",116:"ds-SAP",117:"ds-Actian",118:"ds-Actian",119:"ds-InformixXPS",120:"ds-Apache-Cassandra-JDBC",121:"ds-MapRDrill",122:"ds-Cirro",123:"ds-EXASolution",124:"ds-EXASolution",125:"ds-Oracle",126:"ds-Oracle",127:"ds-Snowflake",128:"ds-Snowflake",129:"ds-Amazon-Aurora",130:"ds-Amazon-Aurora",131:"ds-Amazon-Athena",132:"ds-Amazon-Athena",133:"ds-MapRDrill",134:"ds-Druid",135:"ds-Druid",139:"ds-MongoBI",157:"ds-GoogleBigQuery",158:"ds-CDataOData",161:"ds-MapD",168:"ds-HortonworksSpark",169:"ds-HortonworksSpark",170:"ds-Yellowbrick",},dbId:{WebServices:15,GBQ_JDBC:157,SalesforceSOQL:179,DATABRICKS:196,CDataOData:158,IBMNPS:171,IBMNPS_JDBC:172,SQLServer:10,SQLServer_JDBC:59,PostgreSQL:6,PostgreSQL_JDBC:65,MEMSQL:77,MEMSQL_JDBC:88,},TREE_SPLIT_CHARACTER:".",dispTag:{1:"Database",2:"OLAP",4:"BigData",8:"Database",16:"BigData",32:"BigData"},searchTags:{100:["Database","ODBC"],200:["Database","ODBC"],300:["Database","ODBC"],400:["Database","ODBC"],500:["Database","ODBC"],600:["Database","ODBC"],700:["Database","ODBC"],900:["Database","ODBC"],1100:["Database","ODBC"],1200:["OLAP","Cube"],1300:["Database","ODBC"],1400:["Database"],1500:["OLAP","Cube"],1600:["OLAP","Cube"],1700:["Database","ODBC"],1800:["Database","ODBC"],2200:["Database","ODBC"],2300:["Database","ODBC"],2400:["Database","ODBC"],2800:["Database","ODBC"],2900:["OLAP","Cube"],3000:["Database"],3100:["Database","BigData","Hadoop"],3300:["Cloud"],3500:["Database","ODBC"],3600:["Database","ODBC","BigData"],3800:["Database"],3900:["Database"],4000:["Database","ODBC"],4100:["Database","BigData","Hadoop"],4200:["Database","ODBC"],4300:["Database","ODBC"],4700:["Database","Cloud","BigData"],4800:["Cloud"],5200:["Database","NoSQL"],5300:["Database","NoSQL"],5400:["Hadoop"],6400:["Database","BigData","Hadoop"],6600:["Database"],6700:["Database"],6800:["BigData"],6900:["BigData"],7100:["NoSQL"],7200:["Database","BigData","Hadoop"],7300:["BigData","Hadoop"],7500:["Database"],7600:["Database"],8000:["Database"],8100:["BigData"],},srcItemTypes:{ALL_SOURCES:"ALL_SOURCES",STATIC_SOURCE:"STATIC_SOURCE",DBTYPE_SOURCE:"DBTYPE_SOURCE",CUSTOM_CONNECTOR:"CUSTOM_CONNECTOR",CLOUDELEMENT_CONNECTOR:"CLOUDELEMENT_CONNECTOR"},combination:{BigData:["BigData","NoSQL","Search","Hadoop"],Apps:["Apps","oAuth","Cloud","Social","BI","PublicData","CE"]},GenericDBStr:"Generic",dataSourceType:{MONGODB:"mongodb",FILE_URL:"fileUrl",FILE_LOCAL:"fileLocal",SAMPLE_FILE:"sampleFile",ES:"elasticsearch",DROPBOX:"dropbox",GOOGLE_DRIVE:"googleDrive",GOOGLE_ANALYTICS:"googleAnalytics",GOOGLE_BIGQUERY:"googleBigQuery",SALESFORCE:"salesforce",FILE:"file",GENERIC_JDBC:"genericJdbc"},salesforceEnvironmentIDP:{3:4,35:5,},salesforceDBRoleID:{0:"AC41E217C55342DC871C511E77EBE4D0",3:"136A993630BE4A72B6E24C8029DC7FEE",35:"B1FC634FBB214FF8884C0ADEBED36AA0"},ERDF:{ENUM_LOAD_REPORT_BROWSE_TYPE_BINDINGTABLE:1,ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW:4,ENUM_LOAD_REPORT_BINDING_FLAG_ALL:15,ENUM_LOAD_REPORT_PREVIEW_FLAG_MappingInfo:1,ENUM_LOAD_REPORT_PREVIEW_FLAG_DataInfo:2,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo:4,ENUM_LOAD_REPORT_PREVIEW_FLAG_InnerDataInfo:2048,},DSSSubType:{DSSSUBTYPEATTRIBUTE:3072,DSSSUBTYPEATTRIBUTEROLE:3073,DSSSUBTYPEATTRIBUTETRANSFORMATION:3074,DSSSUBTYPEATTRIBUTEABSTRACT:3075,DSSSUBTYPEATTRIBUTERECURSIVE:3076},DSSExType:{DSSEXDISPARK:416},URLMode:{NormalUrl:0,NewConnector:1,NewConnectorEdit:2,CloudElement:3},disableFeatures:{DISABLE_CUSTOM_CONNECTOR:"disableCustomerConnector",DISABLE_DDA:"disableDDA",DISABLE_QUOTA:"disableQuota",DISABLE_HADOOP:"disableHadoop",DISABLE_BI_TOOLS:"disableBITools",DISABLE_CLIP_BOARD:"disableClipboard",DISABLE_FACE_BOOK:"disableFacebook",DISABLE_TWITTER:"disableTwitter",DISABLE_SAMPLE_FILES:"disableSampleFiles",DISABLE_PUBLIC_DATA:"disablePublicData",DISABLE_MERGE_CUBE:"disableMergeCube",DISABLE_CE_SOURCE:"disableCESource",DISABLE_FLATTERN_DB_SOURCE:"disabledSources"},DssXmlPrivileges:{DssXmlPrivilegesUseDatabaseInstanceManager:57},Enum_SourceCategoryType:{File:1,BigData:2,Database:3,OLAP:4,Customized:5,Apps:6,},fileTypesDesc:{DB_FILE_TYPE_EXCEL:"DB_FILE_TYPE_EXCEL",DB_FILE_TYPE_CSV:"DB_FILE_TYPE_CSV",DB_FILE_TYPE_HTML:"DB_FILE_TYPE_HTML",DB_FILE_TYPE_JSON:"DB_FILE_TYPE_JSON",DB_FILE_TYPE_SAS:"DB_FILE_TYPE_SAS"},mimeType:{JSON:"application/json",},FormThatDisableGeo:{Latitude:"Latitude",Longitude:"Longitude",Geometry:"Geometry"},DSSViewMedia:{dssViewMediaAvailablePushDataAPI:1048576},multiSheetFileTypes:["PARQUET","AVRO","ORC","JSON",],storageType:{CSV:"CSV",MULTI_SHEET:"MULTI_SHEET",UNKNOWN:"UNKNOWN"},dbmsObjectsFetchedEvt:"serverDBMSObjectsFetched",nativeAppOAuth2Solution:{NOT_SUPPORTED:0,LOOPBACK_INTERFACE_REDIRECTION:1,MANUAL_COPY_PASTE:2},nativeSDKConnectorEvt:{MSTR_CONN_1ST_SAVE:"dbRole1stTimeSlientSave",NATIVESDK_DBROLE_FETCHED:"NativeSDKConnectorDBRolesFetched"},nativeSDKConnectors:{mstr:"F72DF5DBDBB44F85B8FC4218523CA398",surveyMonkey:"7EAF57EA11EB493A8E4EFF2050274D05",surveyGizmo:"EB6F5F098F2B4928AB34D8A9734237B8",box:"BD033C929B064691AB0B3040EEEAA49C",onedrive:"3BEC897ADE7C48E1A30DC3CAF4C8E58C",sharepointFiles:"2AB8423295094B6D998DB5E53371884A"},nativeAndManagedUrlDBRoleEvt:"nativeAndManagedDBRFetched",noGatewayAgentDBs:[15,41,32,157,127,128,86,87,151,180,39,183,210,37,38,36,170,195,196],mciDisabledDBs:[0,5,8,13,14,15,17,19,20,23,25,27,29,31,51,52,54,55,58,77,78,81,111,113,122,123,129,131,139,140,143,144,145,146,147,148,149,150,158,161,166,171,194],mciDisabledURLPatterns:[/.*?:\/\/127\.0\.0\.1/i,/.*?:\/\/localhost/i,/.*?:\/\/0\.0\.0\.0/i,/.*?:\/\/\[::\]/i,/.*?:\/\/0000::1/i,/.*?:\/\/2130706433/i],QBImportOptions:{HADOOP_FILES:"0",SELECT_TABLES:"1",BUILD_A_QUERY:"2",TYPE_A_QUERY:"3"},cancelStatus:{NOT_START:0,ON_LOADING:1,},hadoopGatewayFeature:"mstrApp.diParams.hadoopGatewayFeature",deploymentType:{OnPrem:0,MCI:1,MCP:2,MCE:3},cubeType:{dda:0,inmemory:1,optimizeDDA:2},VLDB_REPORT:"VLDB Report",LIVE_CONNECT_TABLE_CACHE_USAGE_NAME:"Live Connect Table Cache Usage",sensitiveFields:["REFRESHTOKEN","CLIENTSECRET","OAUTHREFRESHTOKEN","OAUTHCLIENTSECRET"],clearExtrSensitiveFields:"mstr_clear_extr"});}());(function(){var B={NetworkVisualizationStyle:{b:"vi-network.js",s:"VisualizationServerJsonDataStyle",c:"netviz.VisNetwork",oivmb:"oivm-network.js",vib:"vi-network.js"},ReportTimelineAjaxVisualizationStyle:{s:"TimelineMojoVisualizationDataStyle",c:"VisTimeline"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"},SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},KPICardVisualizationStyle:{b:"vi-kpi.js",s:"VisualizationServerJsonDataStyle",c:"kpicard.VisKPICard",lib:'[["libraries/echarts.common.min.js"],["libraries/slick/slick.min.js"]]'},VIHeatMapVisualizationStyle:{b:"vi-heatmap.js",s:"VisualizationServerJsonDataStyle",c:"heatmap.vi.VisHeatMap",oivmb:"oivm-heatmap.js",vib:"vi-heatmap.js"},GraphMatrixVisualizationStyle:{b:"vi-gm.js",s:"VisualizationServerJsonDataStyle",c:"gm.VisGraphMatrix",oivmb:"oivm-gm.js",vib:"vi-gm.js"},ESRIMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"},MapboxVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"mapbox.VisMapbox",lib:'[["libraries/mapbox/mapbox-gl.js"],["libraries/mapbox/supercluster.min.js"],["libraries/mapbox/turf.min.4.7.3.js"]]'},NewGraphMatrixVisualizationStyle:{b:"vi-gm.js,vi-ngm.js",s:"VisualizationServerJsonDataStyle",c:"ngm.VisNewGraphMatrix",lib:'[["../VisFramework/ngm/dist/bundle/ngm.js"]]',oivmb:"oivm-gm.js,oivm-ngm.js",vib:"vi-gm.js,vi-ngm.js"},GoogleMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"VisMapBase"}};var E={"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer":"ESRIMapVisualizationStyle","com.microstrategy.web.vf.viewer.HeatMapApplicationViewer":"VIHeatMapVisualizationStyle","com.microstrategy.flex.viewer.GraphMatrixViewer":"GraphMatrixVisualizationStyle","com.microstrategy.flex.viewer.NewGraphMatrixViewer":"NewGraphMatrixVisualizationStyle","com.microstrategy.web.vf.viewer.DatePickerApplicationViewer":"visAjaxDatePicker","com.microstrategy.flex.viewer.NetViz":"NetworkVisualizationStyle"};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function D(F){return B[F]||(mstrConfig&&mstrConfig.pluginsVisList&&mstrConfig.pluginsVisList[F])||null;},findVisName:function(F){return E[F]||(mstrConfig&&mstrConfig.pluginsWidgetVisMap[F])||null;},findWidgetName:function C(H){var G;for(var F in E){if(E.hasOwnProperty(F)&&E[F]===H){G=F;break;}}if(!G&&mstrConfig&&mstrConfig.pluginsWidgetVisMap){for(var F in mstrConfig.pluginsWidgetVisMap){if(mstrConfig.pluginsWidgetVisMap.hasOwnProperty(F)&&mstrConfig.pluginsWidgetVisMap[F]===H){G=F;break;}}}return G;},getVisClass:function A(F,G){if(G.txi&&G.t===115){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return F;}});}());(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=(I.className==="mstrd-Page")?0:I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};mstrmojo.gmaps.MapEnums={};mstrmojo.gmaps.EnumBaseMapType={Reserved:"-1",Esri:"1",Google:"2",Image:"3",Mapbox:"4"};mstrmojo.gmaps.EnumDefaultMapStyle={Esri:"Light Gray Map",Google:"0",Image:"",Mapbox:"mapbox://styles/microstrategy/cj4fnd0xu1ax82rnuq287rwvu"};mstrmojo.gmaps.EnumLanguagePattern={"{name}":["coalesce",["get","name"],["get","name_en"]],"{name_en}":["coalesce",["get","name_en"],["get","name"]],"{name_en}\n{name}":["concat",["coalesce",["get","name_en"],["get","name"]],"\n",["coalesce",["get","name"],["get","name_en"]]]};mstrmojo.gmaps.EnumLanguageType={Local:"{name}",English:"{name_en}",Both:"{name_en}\n{name}"};mstrmojo.gmaps.LANGUAGE_TYPE_REG={Both:/\{name_en\}[\s\S]*\{name\}/};mstrmojo.gmaps.EnumGraphicType={Marker:"1",Bubble:"2",Area:"3",Density:"4",Path:"5"};mstrmojo.gmaps.EnumMarkerType={Pin:"1",Square:"2",Diamond:"3",Image:"4",Circle:"5"};mstrmojo.gmaps.EnumPolygonSource={Cloud:"1",Custom:"2",MapBoxPolygon:"3",MapboxCustomShape:"4"};mstrmojo.gmaps.EnumShapeType={polygon:"polygon",multiPolygon:"multipolygon"};mstrmojo.gmaps.EnumGeometryType={Point:"Point",Extent:"2",Polygon:"Polygon"};mstrmojo.gmaps.EnumExtraCfgTaskId={Esri:"getESRIExtraConfig",Google:"getGoogleExtraConfig"};mstrmojo.gmaps.EnumGlobalCfgName={Esri:"esriConfig",Google:"googleConfig"};mstrmojo.gmaps.EnumThresholdType={Default:-1,Number:2,Text:3,Image:4,Url:5,QuickSymbol:10};mstrmojo.gmaps.EnumPropertyType={applyThreshold:"at",clusterMode:"mc",clusterRadius:"cr",clusterMaxZoom:"cmz",shapeFile:"lid",mapStyle:"dv",languageType:"lang",themeType:"dms",markerType:"mtp",zoomSetting:"rosa",legendSwitch:"ls",tooltipSwitch:"ts",legendWidthScale:"lwr",imageUrl:"mstyl",needMapToolbar:"mt",attributeId:"atf",useAttributeForm:"af",showZoomBtns:"zb",showAffinityLines:"da",showArcsLines:"dal",maxLineThickness:"lwm",maxBubbleSize:"mbs",useAbsolute:"mss",customInfoWinTpl:"iwd",pathColor:"pcp",affinityLineGrid:"ag",collapseLegend:"clgd",legendSize:"lgds",satf:"satf",dm:"dm",mvo:"mvo",baseMapType:"bmt",editingLayerIdx:"elx",mapGeoExtent:"mext",graphicType:"gtp",layerName:"ln",layerIdx:"lx",isRemoved:"ird",isHidden:"ih",enableZoomThroughLayer:"eztl",minLayerZoomLvl:"minlzl",maxLayerZoomLvl:"maxlzl",freezePanAndZoom:"fpz",MAX_SIZE_TYPE:"maxst",MAX_SIZE_VALUE:"maxsv",MIN_SIZE_TYPE:"minst",MIN_SIZE_VALUE:"minsv",showMapLable:"mlb",mapLabelOnTop:"mlbt",distUnit:"mdu",geoAttribute:"ga",latitude:"lat",longitute:"lng",slice:"slc",angle:"amt",colorby:"cmt",sizeby:"smt",tooltip:"tooltip",geometry:"gmt",keepZoomAndPos:"kzp",zoomLevel:"mz",mapCenter:"mp",mapBearing:"mbr",mapPitch:"mpt",dirtyVp:"dirtyVp",plotMapBasedOn:"pmbo",tooltipForms:"ttpmf",colorByOpacity:"cbo"};mstrmojo.gmaps.EnumGeographicRole={EnumGeographicRoleNone:"0",EnumGeographicRoleCity:"1",EnumGeographicRoleState:"2",EnumGeographicRoleCountry:"3",EnumGeographicRoleLocation:"4",EnumGeographicRoleLatitiude:"5",EnumGeographicRoleLongitude:"6",EnumGeographicRoleOther:"7",EnumGeographicRoleZipCode:"8",EnumGeographicRoleCounty:"9",EnumGeographicRoleLastOne:"10",EnumGeographicRoleGeometry:"11"};mstrmojo.gmaps.EnumClusterMode={MOBILE_OFF:"0",MOBILE_ON:"1",ON:"2",OFF:"3",PIE:"4"};mstrmojo.gmaps.EnumZoomBehavior={Keep:"0",Automatic:"1"};mstrmojo.gmaps.EnumDistUnitType={KM:"0",Miles:"1"};mstrmojo.gmaps.EnumDataLabel={DATA_LABEL_SHOW:"dlShw",DATA_LABEL_SHOW_ALL:"dlShwAll",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",DATA_LABEL_FONT_HALO_COLOR:"dlFntHaloClr",DATA_LABEL_FONT_HALO_WIDTH:"dlFntHaloWidth"};mstrmojo.gmaps.EnumShapeFormatting={SHAPE_FORMAT_FILL_COLOR:"shapeClr",SHAPE_FORMAT_FILL_OPACITY:"shapeFillTrans",SHAPE_FORMAT_BORDER_COLOR:"shapeLineClr",SHAPE_FORMAT_BORDER_STYLE:"shapeLineStyle"};mstrmojo.gmaps.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gmaps.EnumDefaultShapeFormatStyle={FILL_COLOR:"#436CD3",FILL_OPACITY:"85",FILL_OPACITY_VALUE:"0.85",FILL_OPACITY_FACTOR_HOVER:0.75,FILL_OPACITY_FACTOR_UNSEL:0.5,BORDER_STYLE:mstrmojo.gmaps.EnumCombinedLineStyle.THIN,BORDER_STYLE_CIRCLE:mstrmojo.gmaps.EnumCombinedLineStyle.NONE,BORDER_COLOR:"#FFFFFF",BORDER_WIDTH:"1"};mstrmojo.gmaps.DEFAULT_DATA_LABEL_PROPS={dlShw:[0],dlShwAll:[false],dlFntFml:["Arial"],dlFntSz:["8pt"],dlFntStyle:[0],dlFntClr:[0]};mstrmojo.gmaps.EnumDataLabelShowOption={NONE:0,SHOW_TEXT:1,SHOW_VALUE:2,SHOW_BOTH:3};mstrmojo.gmaps.MarkerAlignOption={CENTER:0,TOP:1,LEFT:2,RIGHT:3,BOTTOM:4,TOP_LEFT:5,TOP_RIGHT:6,BOTTOM_LEFT:7,BOTTOM_RIGHT:8};mstrmojo.gmaps.EnumToolbarButtonType={DRILL:1,SINGLE_SELECT:2,RECTANGLE_SELECT:4,EDIT_INFO_WINDOW:8,CLEAR_ALL:16,AFFINITY:32,FREE_SELECT:64,CIRCLE_SELECT:128,ZOOM:256,LAYERS_SELECT:512,KEEP_ONLY:1024,EXCLUDE:2048,SHOW_DATA:4096,SEARCH_BAR:8192,MAP_STYLE:16384};mstrmojo.gmaps.EnumToolbarState={NORMAL:0,SINGLE_SELECT:1,RECTANGLE_SELECT:2,ZOOM:3,AFFINITY:4,FREE_SELECT:5,CIRCLE_SELECT:6,CLEAR_ALL:7,LAYERS_SELECT:8,MARKERTYPE:9,CLUSTER:10,MAP_TYPE:11};mstrmojo.gmaps.EnumActions={rename:"renameUnit",remove:"removeDropZoneUnit",add:"addDropZoneUnit",addForm:"addForm",removeForm:"removeForm"};mstrmojo.gmaps.TARGET_MAPOPTIONS=1;mstrmojo.gmaps.TARGET_FORMATTING_LAYERS=2;mstrmojo.gmaps.SelectionHashType={PRIMARY:0,TEMPLATE_SELECTION:1,EDITING_LAYER:2,RMC_LAYER:3};mstrmojo.gmaps.EnumTransformState={ReadyToUse:-1,UseExistingLine:0,CrossFromExistingToNewLine:1,UseNewLine:2,CrossFromNewToExistingLine:3};mstrmojo.gmaps.EnumDrillLinkAnswerType={SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9};mstrmojo.gmaps.EnumMinSizeType={PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3};mstrmojo.gmaps.EnumMaxSizeType={AUTOMATIC:1,MANUAL:2};mstrmojo.gmaps.EnumDynamicZoomStatus={INIT:0,NO_GEO_ATTR:1,FIRST_ADD_GEO_ARR:2,FIRST_GEO_ADD_FINISHED:3};mstrmojo.gmaps.ZoomAnimationDelta=0.15;mstrmojo.gmaps.LAYER_INDEX_MAX=100;mstrmojo.gmaps.LASSOLAYER_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+1;mstrmojo.gmaps.ZOOMBTN_ZINDEX=mstrmojo.gmaps.LAYER_INDEX_MAX+50;mstrmojo.gmaps.ENABLE_MAX_MIN_SIZE_CONTROL=true;mstrmojo.gmaps.EnumRenderMethod={svg:"svg",canvas:"canvas",mapbox:"mapbox"};mstrmojo.gmaps.EnumLayerZoneSource={DROP_ZONE:"dzpn",PROPERTY_PANEL:"pppn"};mstrmojo.gmaps.CustomShapeId="3000";mstrmojo.gmaps.MapStyleToolips={Basic:mstrmojo.desc(18348,"Make different land types pop with topography-based colors."),White:mstrmojo.desc(18339,"Stand out against a darker background."),Light:mstrmojo.desc(18342,"Display data on a gray color palette."),Dark:mstrmojo.desc(18346,"Match the map to a dark background."),Street:mstrmojo.desc(18344,"Highlight all street data for a classic navigational look."),Topographic:mstrmojo.desc(18349,"Show terrain and landscape details."),Physical:mstrmojo.desc(18350,"Show the Earth's features, like landscapes, mountains, deserts, rivers, lakes, and oceans."),Relief:mstrmojo.desc(18343,"Show the elevation and depression of a given area."),Satellite:mstrmojo.desc(18341,"Display what Earth looks like from outer space."),SatelliteStreet:mstrmojo.desc(18347,"Display what Earth looks like from outer space with street data."),Border:mstrmojo.desc(18351,"Only show geographic borders."),Focused:mstrmojo.desc(18336,"Focus only on the geographic area where you have data.")};mstrmojo.gmaps.STYLES_MAP={"mapbox://styles/microstrategy/cj4huc3z734b32sqpcyursd8s":"mapbox://styles/microstrategy/ck8zbihxj08ij1iqgj5g9tcf1","mapbox://styles/microstrategy/cj4fnd0xu1ax82rnuq287rwvu":"mapbox://styles/microstrategy/ck9i5q6ja1hsv1jphvxmqzrt5","mapbox://styles/microstrategy/cj8o35v4u8ayz2rqutqgwhvxp":"mapbox://styles/microstrategy/ck9i6pst74k6r1imxbfxq4rmh","mapbox://styles/microstrategy/cj4gonmj72rih2ss2n132hwla":"mapbox://styles/microstrategy/ck9i7d7l11m1s1ilzj8ieqqa5","mapbox://styles/microstrategy/cj4fdoz771jrx2rmhajhl8yxv":"mapbox://styles/microstrategy/ck9i9pa3j68ax1iml8bqyt1af","mapbox://styles/microstrategy/cj4gpwfca95l52so2gkz3y2is":"mapbox://styles/microstrategy/ckbiqy01o0f841imq8qtkvsj0","mapbox://styles/microstrategy/cj4grefys96zg2smv7okfp8c5":"mapbox://styles/microstrategy/ck9jelaz30qfr1io6mv3tnerp","mapbox://styles/microstrategy/cj4guy8nn2y7e2so0c9h2uiav":"mapbox://styles/microstrategy/ck9jhftrm0sxo1jpndrnww4rl","mapbox://styles/microstrategy/cj621ujgo32ve2rmpuxixebjq":"mapbox://styles/microstrategy/ck9jjrsqu007s1ip5lnukt0qp","mapbox://styles/microstrategy/cj4gnpv6t2r9m2rpe417d51s1":"mapbox://styles/microstrategy/ck9je20z80ppn1ipl3hgih06s"};mstrmojo.gmaps.MapboxKeyStyles={V7_DEFAULT:"mapbox://styles/microstrategy/cj4fnd0xu1ax82rnuq287rwvu",V8_DEFAULT:"mapbox://styles/microstrategy/ck9i5q6ja1hsv1jphvxmqzrt5",BORDER:"mapbox://styles/microstrategy/ckdgsxrq70j6g1jpcr6apfyp4",FOCUSED:"mapbox://styles/microstrategy/cke29lrdk0pkd19mjlevkrgug"};(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75,GRAPHMATRIXVERTICALHISTOGRAM:76,GRAPHMATRIXGRIDCHART:78,GRAPHMATRIXVERTICALBOXPLOT:79,GRAPHMATRIXHORIZONTALBOXPLOT:80,GRAPHMATRIXVERTICALWATERFALL:81,GRAPHMATRIXHORIZONTALWATERFALL:82,KPICARD:83,VERTICALSYNCHRONIZEDAXISBAR:84,HORIZONTALSYNCHRONIZEDAXISBAR:85,VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:86,VERTICALDUALAXISLINECHART:87,HORIZONTALDUALAXISLINECHART:88};var T=mstrmojo.vi.viz.EnumVisualizationTemplates;mstrmojo.vi.viz.EnumAggregatedVisTemplates={COMBOCHART:[T.GRAPHHORIZONTALBARDUALAXISCLUSTERED,T.GRAPHHORIZONTALBARDUALAXISABSOLUTE,T.GRAPHHORIZONTALLINEDUALAXISABSOLUTE,T.GRAPHHORIZONTALAREADUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISCLUSTERED,T.GRAPHVERTICALBARDUALAXISABSOLUTE,T.GRAPHVERTICALBARDUALAXISSTACKED,T.GRAPHVERTICALLINEDUALAXISABSOLUTE,T.GRAPHVERTICALLINEDUALAXISSTACKED,T.GRAPHVERTICALAREADUALAXISABSOLUTE,T.GRAPHVERTICALAREADUALAXISSTACKED,T.GRAPHCOMBINATIONBARAREADUALAXIS,T.GRAPHCOMBINATIONBARAREA],BUBBLECHART:[T.GRAPHMATRIXSCATTERCIRCLEMM,T.GRAPHMATRIXSCATTERGRIDCIRCLEAA,T.GRAPHMATRIXBUBBLECIRCLEMM,T.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,T.GRAPHMATRIXSCATTERSQUAREAM,T.GRAPHMATRIXSCATTERSQUAREMM,T.GRAPHMATRIXSCATTERGRIDSQUAREAA,T.GRAPHMATRIXBUBBLESQUAREAM,T.GRAPHMATRIXBUBBLESQUAREMM,T.GRAPHMATRIXBUBBLEGRIDSQUAREAA],BARCHART:[T.GRAPHHORIZONTALBARCLUSTERED,T.GRAPHVERTICALBARCLUSTERED,T.GRAPHHORIZONTALBARABSOLUTE,T.GRAPHHORIZONTALBARPERCENT,T.GRAPHHORIZONTALBARSTACKED,T.GRAPHVERTICALBARABSOLUTE,T.GRAPHVERTICALBARPERCENT,T.GRAPHVERTICALBARSTACKED,],VERTICALBARCHART:[T.GRAPHMATRIXVERTICALBARAUTOMATIC],HORIZONTALBARCHART:[T.GRAPHMATRIXHORIZONTALBARAUTOMATIC],VERTICALCLUSTEREDBARCHART:[T.GRAPHMATRIXVERTICALBARCLUSTERED],VERTICALSTACKEDBARCHART:[T.GRAPHMATRIXVERTICALBARSTACKED],VERTICALPERCENTBARCHART:[T.GRAPHMATRIXVERTICALBARPERCENT],HORIZONTALCLUSTEREDBARCHART:[T.GRAPHMATRIXHORIZONTALBARCLUSTERED],HORIZONTALSTACKEDBARCHART:[T.GRAPHMATRIXHORIZONTALBARSTACKED],HORIZONTALPERCENTBARCHART:[T.GRAPHMATRIXHORIZONTALBARPERCENT],SYNCAXISBARCHART:[T.VERTICALSYNCHRONIZEDAXISBAR,T.HORIZONTALSYNCHRONIZEDAXISBAR,T.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR],MatrixBarCHART:[T.GRAPHMATRIXGRIDCHART],LINECHART:[T.GRAPHMATRIXVERTICALLINESTACKED,T.GRAPHMATRIXVERTICALLINECLUSTERED,T.GRAPHMATRIXVERTICALLINEPERCENT,T.GRAPHMATRIXHORIZONTALLINESTACKED,T.GRAPHMATRIXHORIZONTALLINECLUSTERED,T.GRAPHMATRIXHORIZONTALLINEPERCENT,T.GRAPHHORIZONTALLINEABSOLUTE,T.GRAPHVERTICALLINEABSOLUTE,T.GRAPHVERTICALLINESTACKED,T.GRAPHVERTICALLINEPERCENT,T.GRAPHMATRIXVERTICALLINEAUTOMATIC,T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC],DUALAXISLINECHART:[T.VERTICALDUALAXISLINECHART,T.HORIZONTALDUALAXISLINECHART],PIECHART:[T.PIE,T.GRAPHMATRIXPIE,],RINGCHART:[T.RING,T.GRAPHMATRIXRING],AREACHART:[T.GRAPHHORIZONTALAREAABSOLUTE,T.GRAPHVERTICALAREAABSOLUTE,T.GRAPHVERTICALAREAPERCENT,T.GRAPHVERTICALAREASTACKED],STACKEDAREACHART:[T.GRAPHMATRIXVERTICALAREASTACKED,T.GRAPHMATRIXVERTICALAREAPERCENT,T.GRAPHMATRIXHORIZONTALAREASTACKED,T.GRAPHMATRIXHORIZONTALAREAPERCENT,T.GRAPHMATRIXVERTICALAREAAUTOMATIC,T.GRAPHMATRIXHORIZONTALAREAAUTOMATIC],ABSOLUTEAREACHART:[T.GRAPHMATRIXVERTICALAREACLUSTERED,T.GRAPHMATRIXHORIZONTALAREACLUSTERED],HISTOGRAM:[T.GRAPHMATRIXVERTICALHISTOGRAM,],BOXPLOT:[T.GRAPHMATRIXVERTICALBOXPLOT,T.GRAPHMATRIXHORIZONTALBOXPLOT],WATERFALL:[T.GRAPHMATRIXVERTICALWATERFALL,T.GRAPHMATRIXHORIZONTALWATERFALL]};mstrmojo.vi.viz.EnumVisualizationTemplatesName={};var V=mstrmojo.vi.viz.EnumVisualizationTemplatesName;V[T.GRID]=mstrmojo.desc(114,"Grid");V[T.GRAPHMATRIXVERTICALBARAUTOMATIC]=mstrmojo.desc(18354,"Vertical Bar Chart");V[T.GRAPHMATRIXHORIZONTALBARAUTOMATIC]=mstrmojo.desc(18356,"Horizontal Bar Chart");V[T.GRAPHMATRIXVERTICALBARCLUSTERED]=mstrmojo.desc(18357,"Vertical Clustered Bar Chart");V[T.GRAPHMATRIXHORIZONTALBARCLUSTERED]=mstrmojo.desc(18358,"Horizontal Clustered Bar Chart");V[T.GRAPHMATRIXVERTICALBARSTACKED]=mstrmojo.desc(18359,"Vertical Stacked Bar Chart");V[T.GRAPHMATRIXHORIZONTALBARSTACKED]=mstrmojo.desc(18355,"Horizontal Stacked Bar Chart");V[T.GRAPHMATRIXVERTICALBARPERCENT]=mstrmojo.desc(18362,"Vertical Percent Bar Chart");V[T.GRAPHMATRIXHORIZONTALBARPERCENT]=mstrmojo.desc(18360,"Horizontal Percent Bar Chart");V[T.VERTICALSYNCHRONIZEDAXISBAR]=V[T.HORIZONTALSYNCHRONIZEDAXISBAR]=V[T.HORIZONTALSYNCHRONIZEDAXISBAR]=mstrmojo.desc(18361,"Synchronized Axis Bar Chart");V[T.GRAPHMATRIXGRIDCHART]=mstrmojo.desc(18931,"Matrix Bar Chart");V[T.GRAPHCOMBINATIONBARAREADUALAXIS]=mstrmojo.desc(11824,"Combo Chart");V[T.GRAPHMATRIXVERTICALLINEAUTOMATIC]=V[T.GRAPHMATRIXHORIZONTALLINEAUTOMATIC]=mstrmojo.desc(8121,"Line Chart");V[T.VERTICALDUALAXISLINECHART]=V[T.HORIZONTALDUALAXISLINECHART]=mstrmojo.desc(19130,"Dual Axis Line Chart");V[T.GRAPHMATRIXVERTICALAREASTACKED]=V[T.GRAPHMATRIXHORIZONTALAREASTACKED]=mstrmojo.desc(15233,"Stacked Area Chart");V[T.GRAPHMATRIXVERTICALAREACLUSTERED]=V[T.GRAPHMATRIXHORIZONTALAREACLUSTERED]=mstrmojo.desc(15236,"Absolute Area Chart");V[T.GRAPHMATRIXPIE]=mstrmojo.desc(11823,"Pie Chart");V[T.GRAPHMATRIXRING]=mstrmojo.desc(8296,"Ring Chart");V.MapboxVisualizationStyle=V.GoogleMapVisualizationStyle=V.ESRIMapVisualizationStyle=mstrmojo.desc(7736,"Map");V.KPICardVisualizationStyle=mstrmojo.desc(15800,"KPI");V[T.GRAPHMATRIXVERTICALWATERFALL]=V[T.GRAPHMATRIXVERTICALWATERFALL]=mstrmojo.desc(5594,"Waterfall");V.VIHeatMapVisualizationStyle=mstrmojo.desc(11819,"Heat Map");V[T.GRAPHMATRIXBUBBLECIRCLEMM]=mstrmojo.desc(11822,"Bubble Chart");V[T.GRAPHMATRIXVERTICALHISTOGRAM]=mstrmojo.desc(350,"Histogram");V[T.GRAPHMATRIXVERTICALBOXPLOT]=V[T.GRAPHMATRIXHORIZONTALBOXPLOT]=mstrmojo.desc(3156,"Box Plot");V.NetworkVisualizationStyle=mstrmojo.desc(11827,"Network");mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionConcatAgg:177,FunctionTuple:1000};(function(){mstrmojo.url=mstrmojo.provide("mstrmojo.url",{isAbsoluteURL:function I(J){return(/^(http|https|ftp|file):\/\//i.test(J));},isImageDataURL:function H(J){return(J.indexOf("data:image/")===0);},isQueryURL:function A(J){return(J.indexOf("?")!==-1);},isRelativeStaticImageURL:function C(J){return !(this.isImageDataURL(J)||this.isAbsoluteURL(J)||this.isQueryURL(J));},getAbsoluteURL:function E(J,K){if(this.isAbsoluteURL(J)){return J;}if(K){return K+(/\/$/.test(K)?"":"/")+J;}return"http://"+J;},getRealURL:function F(K){var J=K;if(mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode()){J=this.getAbsoluteURL(K,this.getWebServerUrl());}return J;},getWebServerUrl:function B(N){var R=null;if(N){if(mstrApp!==undefined&&mstrApp.getConfiguration){R=mstrApp.getConfiguration().getCurrentProjectWebServerUrl();}}else{if(mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode()){R=mstrApp.env.getDossierServerURL();}else{var L=document.location&&document.location.href;if(L){var M=L.toLowerCase();var K="/app/",U="/servlet/",S="/asp/";var J=M.indexOf(K),P=M.indexOf(U),Q=M.indexOf(S);if(J>=0){R=L.substr(0,J+1);}else{if(P>=0){if(Q<0){R=L.substr(0,P+1);}else{if(Q>=0){var O=(P>Q)?Q:P;R=L.substr(0,O+1);}}}else{if(P<0){if(Q>=0){R=L.substr(0,Q+1);}}}}}}}return R;},getFullPath:function G(S){var N=S,K=/^[A-z]:\/\//,R=mstrApp&&mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode(),Q,L;if(!(mstrApp&&mstrApp.isDossier||R)||!S||S.indexOf("data:image")===0){return S;}if(K.test(S)){N=S;}else{var P=/^(\.\.\/|\.\.\\)/;var O=/^(\.\/|\.\\)/;var M=/^(\/|\\)/;S=S.replace(P,"");S=S.replace(O,"");S=S.replace(M,"");if(mstrApp&&mstrApp.getConfiguration){var J=R?mstrApp.env.getDossierServerURL():this.getWebServerUrl(this.isTablet);if(!J){N=S;}else{N=this.getAbsoluteURL(S,J);}}}return N;},getPlaceholderImageURL:function D(){return mstrmojo.getJsRoot()+"../images/1ptrans.gif";}});}());(function(){mstrmojo._IsSelectorTarget=mstrmojo.provide("mstrmojo._IsSelectorTarget",{_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(C){var D=(C?"add":"remove")+"DirtyKey",B=this.parent;if(B&&B[D]){this.parent[D](this.k);}}});}());(function(){var E=new RegExp("^[A-Z0-9]{8}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{4}[A-Z0-9]{12}$","i");var A=2147483648;var G=Array.apply(null,Array(256)).map(function(H,I){return(I<16?"0":"")+I.toString(16).toUpperCase();});var F=(window.crypto&&window.crypto.getRandomValues)?function(){var H=new Uint32Array(4);window.crypto.getRandomValues(H);return{d0:H[0],d1:H[1],d2:H[2],d3:H[3]};}:function(){return{d0:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d1:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d2:Math.abs(Math.floor(Math.random()*A)^(+new Date())),d3:Math.abs(Math.floor(Math.random()*A)^(+new Date()))};};function D(H){var L=H.d0,K=H.d1,J=H.d2,I=H.d3;return G[L&255]+G[L>>8&255]+G[L>>16&255]+G[L>>24&255]+G[K&255]+G[K>>8&255]+G[K>>16&15|64]+G[K>>24&255]+G[J&63|128]+G[J>>8&255]+G[J>>16&255]+G[J>>24&255]+G[I&255]+G[I>>8&255]+G[I>>16&255]+G[I>>24&255];}mstrmojo.UUID=mstrmojo.provide("mstrmojo.UUID",{create:function C(){return D(F());},isUUID:function B(H){return H&&E.test(H.toString());}});mstrmojo.UUID.EMPTY="00000000000000000000000000000000";}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();(function(){mstrmojo.vi.ui._IsUnitContainerTitleBar=mstrmojo.provide("mstrmojo.vi.ui._IsUnitContainerTitleBar",{_mixinName:"mstrmojo.vi.ui._IsUnitContainerTitleBar",layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},xt:true},setDimensions:function A(D,C){return this._super("auto",C);},getTitleChildrenLayoutOffsets:function B(){return{h:0,w:12};}});}());mstrmojo.mstr.EnumDSSXMLTokenTypes={EndOfInput:-1,Reserved:0,Error:1,Unknown:2,Empty:3,ExclamationPoint:33,NumberSign:35,Dollar:36,Percent:37,Ampersand:38,LeftParen:40,RightParen:41,Asterisk:42,PlusSign:43,Comma:44,MinusSign:45,Dot:46,FwdSlash:47,Colon:58,Semicolon:59,LeftAngleBracket:60,EqualSign:61,RightAngleBracket:62,QuestionMark:63,AtSign:64,LeftSquareBracket:91,RightSquareBracket:93,Caret:94,Underscore:95,LeftAccolade:123,VerticalBar:124,RightAccolade:125,Tilda:126,Literal:258,Identifier:259,Reserved1:260,DoubleQString:261,Integer:262,Float:263,AttrRef:264,DimRef:265,MetricRef:266,AggMetricRef:267,FactRef:268,ReportRef:269,FilterRef:270,RoleRef:271,TableRef:272,PromptRef:273,ColumnRef:274,AttrFormRef:275,DimFormRef:276,SimpInfixFun1:277,SimpInfixFun2:278,SimpPrefixFun:279,AggFun:280,RelativeFun:281,CompareFun:282,AndFun:283,OrFun:284,NotFun:285,BoolPrefixFun:286,IntersectFun:287,Reserved2:288,InSetFun:289,BetweenFun:290,LikeFun:291,EnhCompareFun:292,EnhBetweenFun:293,ArrowUp:294,ArrowDown:295,ArrowUpDown:296,AggFirstInFact:297,AggLastInFact:298,KwdTrue:299,KwdFalse:300,KwdBreakBy:301,KwdSortBy:302,KwdFactID:303,DateTime:304,CaseFun:305,FreeVariable:306,LongNumber:307,RWMetricRef:308,CSQLRef:309,ConsolidationRef:310,DssTokenTypeKwdCSIUpdate:312,DssTokenTypeKwdCSISet:313,DssTokenTypeKwdCSIInsert:314,DssTokenTypeKwdCSIDelete:315,DssTokenTypeKwdCSIWhere:316,DssTokenTypeKwdCSIInto:317,DssTokenTypeKwdCSIValues:318,DssTokenTypeKwdCSIFrom:319,DssTokenTypeCSIFieldUnit:321,Elements:323,ConsolidationElementRef:324,EndOfTypes:340};mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1,CUSTOM:7};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46),SYNC_AXIS_SCALE:Math.pow(2,47)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7,HISTOGRAM:8,BOXPLOT:9,WATERFALL:10,RING:11};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE_90:3,HORI_DROP:4,ROTATE_30:5,ROTATE_45:6,ROTATE_60:7,WRAPPED:8};mstrmojo.gm.EnumABLDirection={UNDEFINED:-1,NONE:0,HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20,GET_EXTRA_X_AXIS_WIDTH:21,BUILD_MERGED_TITLE:22};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",VIS_TYPE:"visType",USER_VIS_TYPE:"userVisType",DATA_LABEL:"DataLabel",BAR_DATA_LABEL_POSITION:"bdlp",PIE_DATA_LABEL_POSITION:"pdlp",PIE_DATA_LABEL_LEADER_LINE:"pdlll",PIE_USE_NEW_SIZE_RATIO:"pnsr",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",DATA_LABELS_ROTATE:"dlrtt",ORDINAL_XAXIS_LABEL_ROTATION:"oxalr",GM_OPT_1132:"opt1132",SET_FEATURE_FLAG:"featureFlag",DATA_LABEL_FONT_SIZE_CONSTRAINT:"DataLabelFontSizeConstraint",DATA_LABEL_TEXT_ANGLE:"DataLabelTextAngle",BANDING:"Banding",SHOW_ALL_LABELS:"ShwAllLbl",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",PIE_SORT_ORDER:"pso",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_SYNC_MODE:"AxisScaleSyncMode",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn",SHOW_BOTH_TOTALS:"totalShw:intSumShw"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_ROTATION_CUSTOM_ANGLE:"xAxLbAng",X_AXIS_LABELS_WRAP_TEXT:"xAxLbWrapText",X_AXIS_LABELS_SHOW:"xAxLbShw",X_AXIS_NESTED_LABEL:"xAxLbNestedLabel",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_NGM_GRID_LINES_SHOW:"allNGMGridLnShw",X_GRID_LINES_SHOW:"xGridLnShw",Y_GRID_LINES_SHOW:"yGridLnShw",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr",SELECTION_LIMIT:"slctnLmt",CONTAINER_FIT_MODE:"cntrFitMode",SHOW_MODEBAR:"showModeBar",MEAN_SD:"meanSD",POINT_SIZE:"ptSize",PTSZ_TYPE:"ptSzType",JITTER:"jitter",JTR_TYPE:"jtrType",POINT_POS:"ptPos",PTPOS_TYPE:"ptPosType",SHOW_OUTLIERS:"shwOutliers",CUSTOM_BINS_MODE:"custMode",MANUAL_BINS_MODE:"manualBinsMode",RANGE_TYPE:"rangeType",NUM_BINS:"numBins",XBINS_START:"xBinsStart",XBINS_END:"xBinsEnd",XBINS_SIZE:"xBinsSize",HAS_UNCHECKED_AUTO:"hasUncheckedAuto",HAS_UNCHECKED_DATASET_RANGE:"hasUncheckedDstRng",DISPLAY_MODE:"displayMode",CONNECTION_LINE_STYLE:"connectionLnStyle",TOTAL_SHOW:"totalShw",TOTAL_LABEL:"totalLabel",INT_SUM_SHOW:"intSumShw",POSITIVE_COLOR:"posClr",NEGATIVE_COLOR:"negClr",START_COLOR:"startClr",TOTAL_COLOR:"totalClr",INT_SUM_COLOR:"intSumClr",INT_SUM_FULL:"intSumFull"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={NONE:1,AUTOMATIC:2,COMPACT:3,MANUAL:4};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4,SYNCHRONIZE:5};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:4,SHOW_BOTH_TEXT_VALUE:6,SHOW_PERCENT_ONLY:8,SHOW_BOTH_VALUE_PERCENT:10,SHOW_BOTH_TEXT_PERCENT:12,SHOW_TEXT_VALUE_PERCENT:14};mstrmojo.gm.EnumBarDataLabelPosition={AUTO:0,OUTSIDE_END:1,INSIDE_END:2,INSIDE_BASE:3};mstrmojo.gm.EnumPieDataLabelPosition={INSIDE:1,OUTSIDE:2};mstrmojo.gm.EnumLeaderLineMode={AUTO:1,SHOW:2,HIDE:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.EnumNGMGridLines={SHOW_Y:1,SHOW_X:2,SHOW:3,HIDE:4,AUTO:5};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};mstrmojo.gm.EnumNGMSubtype={CLUSTERED:0,STACKED:1,PERCENT:2};mstrmojo.gm.EnumBoxPlotMean={NO_MEAN:0,ONLY_MEAN:1,MEAN_STDEV:2};mstrmojo.gm.EnumBoxPlotOutliers={OUTLIERS:0,ALL_POINTS:1,JITTER:0,JTR_MAN:0.5,POINT_POS:0,POS_MAN:-1.8,POINT_SIZE:6,SIZE_MAN:10,MANUAL:1};mstrmojo.gm.EnumHistogram={AUTOMATIC:1,MANUAL:0,CUST_INPUT:2,DATASET:3,BY_BIN_SIZE:4,BY_BIN_NUMBER:5};mstrmojo.gm.EnumContainerFitModes={AUTOMATIC:0,FIT_TO_CONTAINER:1,FIT_TO_CONTENT:2};mstrmojo.gm.EnumDefaultProperty={PIE_DATA_LABEL_LEADER_LINE:mstrmojo.gm.EnumLeaderLineMode.AUTO,PIE_USE_NEW_SIZE_RATIO:1,ORDINAL_XAXIS_LABEL_ROTATION:1,X_AXIS_LABELS_WRAP_TEXT:true,PIE_SORT_ORDER:4,BAR_DATA_LABEL_POSITION:mstrmojo.gm.EnumBarDataLabelPosition.AUTO,X_AXIS_NESTED_LABEL:true,GM_OPT_1132:true};mstrmojo.gm.EnumFeatureFlags={ftFgGrpA:{ApplyOriginalFitTo:1,UseWaterfallNewMode:2,EnableSmartOrdinalXAxisLabel:4,HideGMLegendByDefault:8,ApplyMetricNamesOnAxisToRowColumn:16,DataLabelMultiInfo:32,EnableYLabelWrap:64,DataLabelOpt:128}};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5,TOC_CHAPTER:6,TOC_PAGES_LIST:7,VIZ_LAYER:8,VIZ_GALLERY:9};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.mstr.EnumNodeProperties={NORMAL:0,DRILL:1,CONDITION:2};(function(){function b(e){var f=[].slice.call(e),g=f[f.length-1],h=function(j,i){return j===i;};if(/function|string/.test(typeof g)){h=typeof g==="function"?g:function(j,i){return j[g]===i[g];};f=f.slice(0,f.length-1);}return{sets:f,compareFunc:h};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function E(f,h){var e=(f&&f.length)||0,g;for(g=0;g<e;g++){if(f[g]==h){return g;}}return -1;},includes:function(e,f){if(!e||!e.length){return false;}return e.indexOf(f)>-1;},indexOfMulti:function X(e,f){var j=[],i={},h=0,g=this;g.forEach(e,function(l,k){g.forEach(f,function(m,n){var o=(m===l);if(o){j[n]=i[n]=k;h++;}return !o;});});return{indices:j.length?j:null,map:i,count:h};},forEach:function U(g,l,j){var e=(g&&g.length)||0,h;for(h=0;h<e;h++){var k=h===(e-1);if(j){if(l.call(j,g[h],h,g,k)===false){break;}}else{if(l(g[h],h,g,k)===false){break;}}}return g;},map:function c(g,k){var e=(g&&g.length)||0,h=[],j;for(j=0;j<e;j++){h[j]=k(g[j],j);}return h;},filter:function L(g,h,j){var m=[],l=0,f=(g&&g.length)||0,e=(j&&j.max)||0,k;for(k=0;k<f;k++){if(h(g[k],k,g)){m[l]=g[k];l++;if(e&&l>=e){break;}}}return m;},filterOne:function N(e,f){var g=this.filter(e,f,{max:1});if(g.length){return g[0];}return null;},ensureArray:function R(e){return[].concat(e||[]);},find:function O(f,k,g){var e=(f&&f.length)||0,h;for(h=0;h<e;h++){var j=f[h];if(j&&j[k]==g){return h;}}return -1;},findLast:function B(f,k,g){var e=(f&&f.length)||0,h;for(h=e-1;h>-1;h--){var j=f[h];if(j&&j[k]===g){return h;}}return -1;},distinct:function C(f,k){if(f.reduce&&!k){return f.reduce(function(l,i){if(l.indexOf(i)<0){l.push(i);}return l;},[]);}var e=(f&&f.length)||0,g,j,h=[];for(g=0;g<e;g++){j=f[g];if((j!==undefined)&&((k&&this.find(h,k,j[k])<0)||(!k&&this.indexOf(h,j)<0))){h.push(j);}}return h;},findBin:function F(g,n,o,f){var k=(f||g.length)-1,i=0,e,j=n[o];while(k-i>1){if(g[e=k+i>>1][o]<j){i=e;}else{k=e;}}if(g[i][o]===j){return i;}return g[k][o]===j?k:-1;},search:function J(q,i,k){var j=q.length,g=-1,f,n=i.toUpperCase(),e=i.length;while(j-g>1){if(q[f=j+g>>1][k].substr(0,e).toUpperCase()<n){g=f;}else{j=f;}}return j;},findMulti:function S(m,f,p){if(!p){return{indices:null,map:{},count:0};}var o=p.length,t=[],e={},q=0,h=(m&&m.length)||0,l;for(l=0;l<h;l++){var s=m[l][f],g;for(g=0;g<o;g++){if(p[g][f]===s){t[g]=l;e[g]=l;q++;break;}}}return{indices:t,map:e,count:q};},removeItem:function a(e,g){var f=this.indexOf(e,g);if(f>-1){this.removeIndices(e,f,1);}return f;},removeItems:function P(e,k,f){var g=this.findMulti(e,k,f);if(g.count){var j=g.indices.concat().sort(this.numSorter).slice(0,g.count),h;for(h=j.length-1;h>-1;h--){e.splice(j[h],1);}}},numSorter:function d(f,e){return Number(f)-Number(e);},stringSorter:function K(g,f){var e=g.toLowerCase(),h=f.toLowerCase();if(e<h){return -1;}if(e>h){return 1;}return 0;},objectKeySorter:function(f,e){if(typeof e==="undefined"){e="asc";}return function(h,g){if(!h.hasOwnProperty(f)||!g.hasOwnProperty(f)){return 0;}var j=(typeof h[f]==="string")?h[f].toUpperCase():h[f];var i=(typeof g[f]==="string")?g[f].toUpperCase():g[f];var k=0;if(j>i){k=1;}else{if(j<i){k=-1;}}return((e==="asc")?k:(k*-1));};},removeIndices:function Q(e,g,f){e.splice(g,f);},insert:function G(f,e,g){if(!f){f=[];}if(e===null||e===undefined){e=f.length;}Array.prototype.splice.apply(f,[e,0].concat(g));return f;},hash:function D(f,j){j=j||{};var e=(f&&f.length)||0,g;for(g=0;g<e;g++){j[f[g]]=true;}return j;},get:function Y(f,j){if(!j){return null;}var g=[],e=j.length,h;for(h=0;h<e;h++){g[h]=f[j[h]];}return g;},deepSortArr:function H(f,h,e,g){return f.sort(function(k,i){var l=k[e][h],j=i[e][h];if(!g){return(l<=j);}return(l>j)?-1:1;});},isArray:function(e){var f=Array.isArray;if(f){return f(e);}return Object.prototype.toString.call(e)==="[object Array]";},some:function M(f,g){if(!f){return false;}if(f.some){return f.some(g);}var e=false;this.forEach(f,function(i,h){e=g(i,h,f);return !e;});return e;},difference:function Z(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var h=b(arguments),f=h.sets,g=h.compareFunc,i=f[0],e=[].concat.apply([],f.slice(1));return i.filter(function(j){return !e.some(function(k){return g(j,k);});});},intersection:function W(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var i=b(arguments),g=i.sets,h=i.compareFunc,e=g[0],f=g.slice(1);f.forEach(function(j){e=e.filter(function(k){return j.some(function(l){return h(k,l);});});});return e;},fnReduceNumber:function A(e,f){return e+f;},applyLargeArray:function I(h,k,m,n){var i=h.length,l=1000,e,f,g,j=m;if(i){for(e=0,f=l;e<i;e=f,f+=l){g=k.apply(n,h.slice(e,f));j=k.apply(n,[j,g]);}}else{j=k.apply(n,h);}return j;}});}());mstrmojo.customviz.CustomVisEnums={};mstrmojo.customviz.CustomVisEnums.LEGEND_PROPERTY_SET="sdk_legend";mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS={SHOW_LEGEND:"showLegend",LEGEND_BG_COLOR:"fillColor",LEGEND_BG_FILL_TRANSPARENCY:"fillAlpha",LEGEND_FONT_SIZE:"fontSize",LEGEND_FONT_FAMILY:"fontFamily",LEGEND_FONT_COLOR:"fontColor",LEGEND_FONT_WEIGHT:"fontWeight",LEGEND_FONT_ITALIC:"fontItalic",LEGEND_FONT_UNDERLINE:"fontUnderline",LEGEND_FONT_LINE_THROUGH:"fontLineThrough",LEGEND_MODE:"mode",LEGEND_POSITION:"position",LEGEND_WIDTH_SCALE:"widthRatio"};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_FORMATTING_PROPERTY=[mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_COLOR,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_LINE_THROUGH,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_FONT_UNDERLINE,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_BG_COLOR,mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPS.LEGEND_BG_FILL_TRANSPARENCY];mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_PROPERTY_TYPE={showLegend:"Boolean",fontWeight:"Boolean",fontItalic:"Boolean",fontUnderline:"Boolean",fontLineThrough:"Boolean",fillAlpha:"Integer",mode:"Integer",position:"Integer",widthRatio:"Float"};mstrmojo.customviz.CustomVisEnums.DEFAULT_LEGEND_PROP_VALUE={defaultTheme:{showLegend:true,fillColor:"#EEEEEE",fillAlpha:0,fontSize:"8pt",fontFamily:"Open Sans",fontColor:"#3A3835",mode:1,position:2},classicTheme:{showLegend:true,fillColor:"#EEEEEE",fillAlpha:0,fontSize:"8pt",fontFamily:"Arial",fontColor:"#747474",mode:1,position:2}};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_DATA_TYPE={COLOR_BY:1,SIZE_BY:2};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_DISPLAY_MODE={RESTORED:1,MINIMIZED:2};mstrmojo.customviz.CustomVisEnums.ENUM_LEGEND_SLOT={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.customviz.CustomVisEnums.ENUM_FONT_STYLE={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};(function(){mstrmojo.util.XtabHelper=mstrmojo.provide("mstrmojo.util.XtabHelper",{isDisplayOutline:function B(D,C){return D&&D.olm&&!(D.rw&&D.rw.row.bc>0)&&(C&&!C.txi);},getOutlineSubMode:function A(){return mstrmojo.util.XtabHelper.ENUM_OUTLINE_SUB_MODE.COMPACT;},ENUM_GROUP_HEADER_ID:"outlineModeGroup",ENUM_OUTLINE_SUB_MODE:{COMPACT:1,STANDARD:2},ENUM_GRID_PROPS:{SHOW_DEF_GRID_DZ:"shwdgdz"}});})();(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function L(U,S){if(U){S=S||{};var W;for(W in U){S[W]=U[W];}}return S;},copyProps:function I(W,Y,S){S=S||{};if(Y){var X=(W&&W.length)||0,U;for(U=0;U<X;U++){var Z=W[U];if(Y[Z]!==undefined){S[Z]=Y[Z];}}}return S;},forEach:function O(X,W,U){if(X){var S;for(S in X){if(U){if(W.call(U,X[S],S,X)===false){break;}}else{if(W(X[S],S,X)===false){break;}}}}return X;},walk:function P(Y,U){if(!U){U=mstrmojo.global;}var X=Y.split(".");if(X.length===1){return U[Y];}var W=(X&&X.length)||0,S;for(S=0;S<W;S++){U=U[X[S]];if(!U){break;}}return U;},walkModify:function D(Z,U,X){if(!U){U=mstrmojo.global;}var Y=Z.split(".");if(Y.length===1){U[Z]=X;return true;}var W=(Y&&Y.length)||0,S;for(S=0;S<W-1;S++){U=U[Y[S]];if(!U){return false;}}U[Y[W-1]]=X;return true;},isEmpty:function F(U){if(!U){return true;}var S;for(S in U){if(U[S]!==null&&U[S]!==undefined){return false;}}return true;},clear:function H(U){if(U){var S;for(S in U){delete U[S];}}return U;},any:function E(X,Y){var W;if(X){var U=this.keyarray(X);if(U.length>0){var S=U[0];W=Y?S:X[S];}}return W;},clone:function Q(Y){if(!Y){return null;}var a;if(Y.constructor===Array){a=Y.concat();var Z=a[0];if(Z&&typeof Z==="object"){var S=a.length,X;for(X=0;X<S;X++){a[X]=this.clone(Y[X]);}}}else{a={};var W;for(W in Y){var U=Y[W];if(U&&typeof U==="object"){a[W]=this.clone(U);}else{a[W]=U;}}}return a;},cloneArray:function M(U){var W=[],S=(U&&U.length)||0,X;for(X=0;X<S;X++){W[X]=this.clone(U[X]);}return W;},keyarray:function A(W,X){var S=[],U;if(W){if(Object.keys&&!X){S=Object.keys(W);}else{for(U in W){S.push(X?Number(U):U);}}}return S;},valarray:function G(W){var S=[];if(W){var U;for(U in W){S.push(W[U]);}}return S;},equals:function R(b,a){var U=mstrmojo.hash,Z=(b&&a)||(!b&&!a&&(b===a));if(Z&&b){Z=(b.constructor===a.constructor);if(Z){if(b.constructor===Array){var Y=b.length;Z=(Y===a.length);if(Z&&Y){var W;for(W=0;W<Y;W++){Z=Z&&U.equals(b[W],a[W]);}}}else{if(typeof b==="object"){var c=U.keyarray(b),X=U.keyarray(a);Z=c.length===X.length;if(Z){var S;for(S in b){Z=Z&&(U.equals(b[S],a[S]));}}}else{Z=(b===a);}}}}return Z;},obj2array:function J(Z){var a;for(a in Z){var Y=Z[a];if(Y&&typeof Y==="object"){Z[a]=this.obj2array(Y);}}var U=Z.isArray;if(U!==undefined&&U===true){var X=[],S=Z.length,W;for(W=0;W<S;W++){X.push(Z[W]);}return X;}return Z;},min:function K(X,Y,Z){var S=null,W;if(X){for(W in X){var U=Y?X[W]:W;if(Z){U=Number(U);}if((S===null)||(U<S)){S=U;}}}return S;},max:function N(X,Y,Z){var S=null,W;if(X){for(W in X){var U=Y?X[W]:W;if(Z){U=Number(U);}if((S===null)||(U>S)){S=U;}}}return S;},make:function C(U,W,S){if(!U||!W){return null;}if(U.attachEventListener){return U;}if(W.makeObservable){U=W.makeObservable(U,S)||U;}else{this.copy(W.prototype,U);if(U.init){U=U.init(S)||U;}}return U;},mergeHashes:function B(S,U){S=this.clone(S)||{};if(U){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(U).concat(this.keyarray(S))),function(W){var Y=S[W],X=U[W];if(Y===undefined){S[W]=X;}else{if(Y&&X){if(typeof Y==="object"){if(Y.constructor===Array){S[W]=Y.concat(X);}else{S[W]=this.mergeHashes(Y,X);}}else{S[W]=X;}}}},this);}return S;},invert:function(U){var W={};if(U){var S;for(S in U){if(U.hasOwnProperty(S)){if(typeof S==="number"||typeof S==="string"){W[U[S].toString()]=S;}}}}return W;}});}());mstrmojo.warehouse.EnumDatabaseType={SAP:1200,MSAS:1500,EssBase:1600,TM1:2900,XQuery:3000,SAPHana:4000,BDE:5400,SearchEngineSOLR:5500,Hive:3100,Impala:4100,SearchEngineSPLUNK:5600,Pig:6400,PHOENIX:6800,IBMBigInsights:700,Drill:7300,DB_TYPE_NEWDB_1:8100,SAPHANAMDX:18300,KYVOSMDX:18800,KYLIGENCEMDX:18900,DB_TYPE_NEWDB_5:8500,AzureCosmosDB:8700};mstrmojo.vi.enums.EnumFeatures={SUPPORT_RESPONSIVE:"support-responsive",INFO_WINDOW:"support-info-window",PANEL_STACK:"support-dossier-panelstack",PANEL_STACK_COPY_MOVE:"support-dossier-panelstack-copy-move",X_PANEL_STACK_MOVE:"support-dossier-move-across-panelstack",SUPPORT_RESPONSIVE_RESIZING:"support-responsive-resizing",SUPPORT_GHOST_IMG:"support-ghost-img",SUPPORT_NLP:"use-natural-language",SUPPORT_CONDITION_METRIC:"support_condition_metric",USE_WORKSTATION_NAMING_STYLE:"use-workstation-naming-style",SUPPORT_TOC_UPDATEPOISITION:"support-toc-updatePosition",SUPPORT_LIVEMODE:"support-livemode",SUPPORT_FREE_FORM_LAYOUT:"support-free-form-layout",NUMBER_FORMATTING:"number-formatting",SAVE_ANALYSIS:"save-analysis",INSERT_NEW_METRIC:"insert-new-metric",DATA_ENGINE_VERSION:"data-engine-version",WEB_DRILL_AND_LINK:"web-drill-and-link",WEB_IMPORT_DATABASE:"web-import-database",APPSCHEMA:"enable-app-schema",USE_METRIC_EDITOR:"use-metric-editor",USE_SUPER_GRID:"use-super-grid",USE_SUPER_GRID_DEV:"use-super-grid-dev",USE_MICROCHART:"use-microchart",SUPPORT_METRICS_IN_ROWS:"support-metrics-in-rows",SUPPORT_MULTI_XTAB_DUPLICATE:"support-multi-xtab-duplicate",CREATE_APP_OBJ:"create-app-object",SUPPORT_AMSELECTOR:"support-amselector",DOSSIER_LINKING:"dossier_linking",TEXT_IMAGE_DOSSIER_LINKING:"text_image_dossier_linking",CREATE_SURVEY:"create-survey",M2020_VERSION:"m2020-version",DUP_FIELD:"duplicate-field",DYNAMIC_SEL_AND_SORT:"dynamic-sel-and-sort",GRID_PROPERTY:"grid-Props",COMPOUND_GRID_LINKING:"compound-grid-linking",SUPPORT_DATA_SOURCE_STATE:"support-data-source-state",DOSSIER_LEVEL_FILTER:"dossier-level-filter",DOSSIER_PDF_TABLE_OF_CONTENTS:"dossier-pdf-toc",DOSSIER_PDF_GRID_PAGING_MODE:"dossier-pdf-grid-paging-mode",DOSSIER_REACT_FORMAT_PANEL:"show-react-dossier-format",RICH_TEXT:"use-richtextbox",FILL_OPACITY:"fill-opacity",SHOW_VIEW_IN_LIBRARY:"show-view-in-library",SUPPORT_ANSWER_PROMPT_WITH_FILTER_PANEL_SELECTIONS:"support-answer-prompt-with-filter-panel-selections"};mstrmojo.vi.enums.EnumFilterClearActionType={CLEAR_ALL:0,CLEAR_KEEP_ONLY:1,CLEAR_ADV_QUALIFICATION:2,CLEAR_LINKING:3,CLEAR_KEEP_ONLY_AND_LINKING:4,CLEAR_DRILLING:5,CLEAR_DOSSIER_LINKING:6};(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function E(G){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(G){var H=this._sync;this._sync=true;G.call(this);this._sync=H;},raiseFormatValueChange:function F(H,I,G){if(this._sync){return false;}this.onGroupValueChange(H,I,G);return true;},raiseCanvasSizeChange:function D(H,G){if(this._sync){return false;}this.onCanvasSizeChange(H,G);return true;},raiseFormatLayoutChange:function B(H,I,G){if(this._sync){return false;}this.onGroupLayoutChange(H,I,G);return true;},onGroupValueChange:function C(H,I,G){},onGroupLayoutChange:mstrmojo.emptyFn});}());(function(){var A=400,B=1500;mstrmojo._CanHandleTwoClicks=mstrmojo.provide("mstrmojo._CanHandleTwoClicks",{firstClickTimeStamp:undefined,firstClickTarget:undefined,onclick:function(D){var E=new Date(),C=E.getTime();if(E-this.firstClickTimeStamp<B&&E-this.firstClickTimeStamp>A){D.secondTarget=D.getTarget();D.firstTarget=this.firstClickTarget;this.onTwoClicks(D);D.cancel();}else{this.firstClickTarget=D.getTarget();this.firstClickTimeStamp=C;}if(this._super){this._super(D);}},onTwoClicks:mstrmojo.emptyFn});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(W){if(W!==null){return(W.constructor!==Array)?[W]:W;}return null;}function F(g,e,a){if(!e){return null;}var h=[],X=g.selectedIndices,W=g.allIdx,c=g.noneIdx;if(g.multiSelect&&(c>-1)&&(I.indexOf(e,c)>-1)){return h;}var Z,b,f=g.items,d=g.itemIdField,Y=g.selectedItems,k;if(g.multiSelect&&(W>-1)&&(I.indexOf(e,g.allIdx)>-1)){for(Z=0,b=f.length;Z<b;Z++){if(!X[Z]){h.push(Z);X[Z]=true;g.selectedIndex=Z;g.selectedItem=f[Z];}}}else{for(Z=0,b=e.length;Z<b;Z++){var j=e[Z];if(!X[j]){X[j]=true;if(a){h.push({idx:j,positions:a});}else{h.push(j);}g.selectedIndex=j;k=g.selectedItem=f[j];if(Y){Y[k[d]]=k;}}}}return h;}function D(Z,W){var Y=[],a=Z.selectedIndices,b=Z.selectedItems,X;for(X in a){delete a[X];if(W){Y.push({idx:parseInt(X,10),positions:W});}else{Y.push(parseInt(X,10));}}Z.selectedIndex=-1;Z.selectedItem=null;if(b){Z.selectedItems={};}return Y;}function U(g,f,a){if(!f){return null;}var c=[],X=g.selectedIndices,j=I.indexOf,W=g.allIdx,d=g.noneIdx,e=g.itemIdField,Y=g.selectedItems;if(g.multiSelect&&(((W>-1)&&(j(f,W)>-1))||((d>-1)&&(j(f,d)>-1)))){return D(g);}if(f.length>0&&X[W]){if(j(f,W)<0){f.push(W);}}var b=f.length,Z;for(Z=0;Z<b;Z++){var h=f[Z];if(X[h]){delete X[h];if(a){c.push({idx:h,positions:a});}else{c.push(h);}if(Y){delete Y[g.items[h][e]];}if(g.selectedIndex===h){g.selectedIndex=-1;g.selectedItem=null;}}}return c;}function C(Z,a,X,W){if(W){return ;}if(this.raiseEvent){if((Z&&Z.length)||(a&&a.length)){try{this.raiseEvent({name:"selectionChange",added:Z,removed:a});}catch(Y){U(this,Z);F(this,a);throw Y;}}}}function B(X){var Y=this.itemIdField,W=this.items;if(typeof X==="object"&&Y){return I.find(W,Y,X[Y]);}return I.indexOf(W,X);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(W){this._super(W);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(f){f=J(f);if(!f){return ;}var c=this.items,W=this.items.length,Y=this.selectedItems,a=[],X;c=this.items=c.concat(f);X=c.length;if(Y){var b=this.itemIdField,Z,e;for(Z=W;Z<c.length;Z++){e=c[Z];if(Y[e[b]]){a.push(Z);}}}if(a&&a.length){F(this,a);}if(X>W){var d=this.itemsContainerNode;if(d){d.innerHTML+=this._buildItemsMarkup(W,X-1).join("");}}},addSelectedItems:function S(W){this.selectItems(W,false);},setSelectedItems:function L(W){this.selectItems(W,true);},selectItems:function R(e,g){e=J(e);if(!e){return ;}if(g&&this.selectedItems){this.selectedItems={};}var Y=this.selectedItems,c=this.itemIdField,W=[],a=this.items.length,b=[],X=this.allowUnlistedValues,f,d,Z;for(Z=0;Z<e.length;Z++){f=e[Z];d=B.call(this,f);if(d<0){if(Y===null){if(X){W.push(f);d=a++;b.push(d);}}else{Y[f[c]]=f;}}else{b.push(d);}}if(W.length>0){this.addItems(W);}if(b.length>0){if(g){this.select(b);}else{this.addSelect(b);}}},unselectItems:function A(X){X=J(X);if(!X){return ;}var c=this.selectedItems,Y=[],b=this.itemIdField,a,W,Z;if(c===null){return ;}for(Z=0;Z<X.length;Z++){a=X[Z];if(c){delete c[a[b]];}W=B.call(this,a);if(W<0){Y.push(W);}}if(Y.length>0){this.removeSelect(Y);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(X,Y,W){if(X!==-1){this.select([X],Y,W);}},singleSelectByField:function O(X,Y,W){this.singleSelect(I.find(this.items,Y,X),W);},toggleSelect:function Q(W){var Y,X;if(this.selectedIndices[W]){X=U(this,[W]);}else{Y=F(this,[W]);}C.call(this,Y,X,[W]);},select:function(Y,X,W){Y=J(Y);if(!Y){return ;}var a=D(this,W),c=F(this,Y,W),Z;if(this.selectionPolicy!=="reselect"){for(Z=a.length-1;Z>=0;Z--){var b=I.indexOf(c,a[Z]);if(b>-1){a.splice(Z,1);c.splice(b,1);}}}C.call(this,c,a,Y,X);},rangeSelect:function H(X,W){var c=this.selectedIndex,a=c,b=this.allIdx,Y=[],Z;if(X===b||this.selectedIndices[b]){Y.push(b);}else{if(a===-1&&this.selectedIndices){for(Z in this.selectedIndices){a=parseInt(Z,10);break;}}a=a===-1?0:a;if(a>X){a=X;X=c;}for(Z=a;Z<=X;Z++){Y.push(Z);}}this.select(Y,W);this.selectedIndex=c;},clearSelect:function(W){C.call(this,null,D(this),[],W);if(!W){this.raiseEvent({name:"clearSelection"});if(this.parent){this.parent.raiseEvent({name:"clearSelection"});}}},addSelect:function(Z,W,X){Z=J(Z);if(!Z){return ;}var Y=F(this,Z,X),b=null,a=this.noneIdx;if(this.multiSelect&&(a>-1&&I.indexOf(Z,a)>-1)){b=U(this,Z);}C.call(this,Y,b,Z,W);},removeSelect:function(Y,W,X){Y=J(Y);if(!Y){return ;}C.call(this,null,U(this,Y,X),Y,W);},_set_selectedIndices:function P(Y,e,W){if(this.selectedItems){this.selectedItems={};}var X=this.selectedIndices;if(X===e){return false;}if(!X){X={};this.selectedIndices=X;}if(!e){e={};}var c=this.selectedIndex,b=[],d;for(d in X){if(!e[d]){d=parseInt(d,10);delete X[d];b.push(d);if(c===d){this.selectedIndex=-1;this.selectedItem=null;}}}var h=[],f=this.items,a=this.itemIdField,g;for(d in e){if(!X[d]){d=parseInt(d,10);X[d]=true;h.push(d);this.selectedIndex=d;g=this.selectedItem=f[d];if(this.selectedItems){this.selectedItems[g[a]]=g;}}}if(W!==true){var Z=[];for(d in e){if(X[d]){d=parseInt(d,10);Z.push(d);}}C.call(this,h,b,Z);}return(h.length||b.length);},_set_selectedIndex:function N(Z,X,W){var Y={};if(X>-1){Y[X]=true;}return this._set_selectedIndices("selectedIndices",Y,W);},_set_selectedItem:function E(Z,Y,X){var W=B.call(this,Y);if((W<0)&&(Y!==null&&Y!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(Y));W=this.items.length-1;}return this._set_selectedIndex("selectedIndex",W,X);},_addSelections:function(W){return F(this,W);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.customviz.PICKED_TYPE={ATTR:"attribute",METRIC:"metric",BOTH:"both"};mstrmojo.customviz.PICKED_CRITERIA={SUBSET:"subset",INTERSECTION:"intersection"};var P=mstrmojo,K=P.hash,H=P.array;mstrmojo.customviz.GraphicModel=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.customviz.GraphicModel",_$_$_$_sysProperties:null,init:function M(){this._$_$_$_sysProperties={uniqueId:null,graphicCenter:null,selector:null,isAttrSelector:null,groupHeaders:null,drillFromHeader:null,updateDropZoneActions:null};},setCustomProperties:function F(S){K.copy(S,this);},getCustomProperty:function E(S){return this[S];},setSelector:function Q(S,U){this._$_$_$_sysProperties.selector=S;this._$_$_$_sysProperties.isAttrSelector=U;},getSelector:function L(){return this._$_$_$_sysProperties.selector;},isAttributeSelector:function D(){return this._$_$_$_sysProperties.isAttrSelector;},setId:function R(S){this._$_$_$_sysProperties.uniqueId=S;},getId:function I(){return this._$_$_$_sysProperties.uniqueId;},setGroupOptions:function A(S){this._$_$_$_sysProperties.groupHeaders=H.ensureArray(S);},getGroupHeaders:function O(){return this._$_$_$_sysProperties.groupHeaders;},setDrillOptions:function N(U,S){this._$_$_$_sysProperties.drillFromHeader=U;this._$_$_$_sysProperties.updateDropZoneActions=S;},getDrillHeader:function C(){return this._$_$_$_sysProperties.drillFromHeader;},getUpdateDropZoneActions:function J(){return this._$_$_$_sysProperties.updateDropZoneActions;},setGraphicCenter:function G(U,S){this._$_$_$_sysProperties.graphicCenter={x:U,y:S};},getGraphicCenter:function B(){return this._$_$_$_sysProperties.graphicCenter;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var E=mstrmojo.hash;var B=function(G){return(mstrmojo.now()-G.getTime());};mstrmojo.storage.DOMStorage=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.storage.DOMStorage",mIsSupported:false,mStorageObj:null,itemTimeToLive:3600,init:function F(G){E.copy(G,this);return this;},isSupported:function C(){return this.mIsSupported;},checkVersion:function A(G){var H=this.getItem("__version__");if(H&&H<G){mstrmojo.dbg("DOMStorage data is old - clearing, v="+H);this.clear();}this.setItem("__version__",G,-1);return this;},length:function(){return(this.mIsSupported?this.mStorageObj.length:0);},_keyExpired:function D(G){return(G&&(G.ts>0)&&(mstrmojo.now()>G.ts));},key:function(G){return(this.mIsSupported?this.mStorageObj.key(G):null);},getItemAsString:function(H){var G=this.getItem(H);if(G){if(typeof G=="object"){G=JSON.stringify(G);}else{G=G+"";}}return G;},getItem:function(H){var G=null;if(this.mIsSupported){var J=this.mStorageObj.getItem(H);if(J){try{J=JSON.parse(J);}catch(I){}if(this._keyExpired(J)){this.removeItem(H);}else{G=J.data;}}}return G;},setItem:function(H,J,G){G=G||this.itemTimeToLive;try{if(this.mIsSupported){this.mStorageObj.removeItem(H);var L=(G>0)?(mstrmojo.now()+(G*1000)):-1;var I={ts:L,data:J};this.mStorageObj.setItem(H,JSON.stringify(I));}}catch(K){if(K!==QUOTA_EXCEEDED_ERR){throw K;}}finally{}return this;},removeItem:function(G){if(this.mIsSupported){this.mStorageObj.removeItem(G);}return this;},clear:function(){if(this.mIsSupported){this.mStorageObj.clear();}return this;}});})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(e,h,g){var i=this._layoutWidgets[h],l=e.slot||H,j=i.f,k=i.p,f=(j&&j[l]!==undefined),d=(k&&k[l]!==undefined);if(l&&((!g&&f)||d)){return f?j[l]:(i.x*parseInt(k[l],10)/100)+Q;}return e[(h==="h")?"height":"width"];}function K(j,f,d){if(j.ignoreLayout){return ;}var e=(f===G)||f==="NaNpx",i=(d===G)||d==="NaNpx";var g=j.getLayoutOffsets&&j.getLayoutOffsets();if(g){if(!e){f=(parseInt(f,10)-g.h)+Q;}if(!i){d=(parseInt(d,10)-g.w)+Q;}}if(j.setDimensions){j.setDimensions(f,d);}else{if(j.set){if(!e){j.set("height",f);}if(!i){j.set("width",d);}}}}function b(g){var e=this.children,k,m;for(k=0,m=(e&&e.length)||0;k<m;k++){var f=e[k],n=f.slot||H;if(n){var l=E.call(this,f,"h",g),o=E.call(this,f,"w",g);this.setSlotDimensions(n,l,o);K(f,l,o);var d=E.call(this,f,"h",g),j=E.call(this,f,"w",g);if(d!==l||j!==o){K(f,d,j);}this.setSlotDimensions(n,d,j);}}this.afterLayout();}function B(){var e=this.children,d=this._layoutWidgets;S.forEach(this.slotNames,function(j,k){if(!j||this.skipsSlotLayout(k)){return ;}var i=(d.h&&d.h.getSlotSizeInfo(k,e))||I,f=(d.w&&d.w.getSlotSizeInfo(k,e))||I,g=i.c||f.c;mstrmojo.array.forEach(g,function(h){K(h,i.v,f.v);});this.setSlotDimensions(k,i.sv,f.sv);},this);this.afterLayout();}function D(e){var d=this.layoutConfig.xt?B:b;d.call(this,e);}function U(k,g,i){var j=k.slot||H,h=g&&g.a;if(!h||h[j]===undefined){return ;}var e=this[j]["offset"+i],f=h[j];if(e===f){return ;}g.x-=(e-f);h[j]=e;}function J(d){this.beforeLayout();var e=this._layoutWidgets,f=d.src;U.call(this,f,e.h,"Height");U.call(this,f,e.w,"Width");D.call(this,true);}function O(f,k){if(!f){return null;}var d=this.children,u=k.toLowerCase(),l=parseInt(this[u],10),n=l,p={},s={},j={},e={},q={},m,o,g,w,t;for(t in f){if(!f.hasOwnProperty(t)){continue;}w=f[t];if(w.match(/px$/)){l-=parseInt(w,10);p[t]=w;}else{if(w.match(/%$/)){s[t]=w;}else{if(w.match(/all/)){q[t]=n;}else{j[t]=w;}}}}if(!S.isEmpty(j)&&!S.isEmpty(s)){for(m=0,o=(d&&d.length)||0;m<o;m++){g=d[m];t=g.slot||H;if(t&&j[t]&&!g.ignoreLayout){if(g.hasRendered){var h=this[t];e[t]=h.getBoundingClientRect?Math.round(h.getBoundingClientRect()[k.toLowerCase()]):h["offset"+k];l-=e[t];}else{e[t]=0;g.attachEventListener((g instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(p)?undefined:p,p:S.isEmpty(s)?undefined:s,a:S.isEmpty(e)?undefined:e,n:S.isEmpty(q)?undefined:q,x:l,getSlotSizeInfo:function(AD,y){if(!f[AD]){return I;}var x=mstrmojo.array.filter(y,function(AF){var AE=AF.slot;return AE===AD||(AD===H&&!AE);}),AB,AC;var i=p[AD];if(i){AC=i;}var AA=s[AD];if(AA){AC=(this.x*parseInt(AA,10)/100)+Q;}if(j[AD]){AC=e[AD];if(AC){AC+=Q;}else{AC=G;}AB=G;}var z=q[AD];if(z){AC=AB=z+Q;}AC=AC||"0px";return{v:AC,c:x,sv:AB||AC};}};}function R(e){var d=this.domNode;if(!d||!this.layoutConfig){return ;}d.style[e]=this[e];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,forceLayout:false,layoutConfig:null,init:function X(d){this._super(d);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var f=this.cssText||"";var d=this.height;if(d&&d!==G){f+="height:"+this.height+";";}var e=this.width;if(e&&e!==G){f+="width:"+this.width+";";}this.cssText=f;return(this._super)?this._super():true;},postBuildRendering:function Y(){this.doLayout();return this._super();},modifyLayoutConfig:function a(f,e){var d=this.layoutConfig=this.layoutConfig||{};d.h=S.copy(f,d.h);d.w=S.copy(e,d.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(f,d){var e=this._super(f,d);if(f==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return e;},doLayout:function A(){var d=this.layoutConfig;if(!d||(this.height===G&&this.width===G)){return ;}if(d.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,d.h,"Height"),w:O.call(this,d.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(d){this.setDimensions(d.h,d.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(d){return false;},adjustParentDimensions:function L(){var e=this.parent,d=e&&e._layoutWidgets;if(d){U.call(e,this,d.h,"Height");U.call(e,this,d.w,"Width");}},setDimensions:function W(g,e){var f=(g===G)||g==="NaNpx",i=(e===G)||e==="NaNpx";if((!f&&parseInt(this.height,10)!==parseInt(g,10))||(!i&&parseInt(this.width,10)!==parseInt(e,10))||this.forceLayout){if(!f){this.height=g;}if(!i){this.width=e;}var d=this.domNode,j=d&&d.style;if(j){if(!f){j.height=g;}if(!i){j.width=e;}this.doLayout();}return true;}return false;},setSlotDimensions:function Z(g,f,e){var d=this[g]&&this[g].style;if(!d){return ;}if(f!==G&&f!==undefined&&f!=="NaNpx"&&d.height!==f&&parseInt(f)>=0){d.height=f;}if(e!==G&&e!==undefined&&e!=="NaNpx"&&d.width!==e&&parseInt(e)>=0){d.width=e;}}});mstrmojo._HasLayout.getSlotSize=function c(g,i){var e=g&&g.prototype.layoutConfig;if(e){var f=e.h,d=e.w;return{h:(f&&f[i])||undefined,w:(d&&d[i])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EDIT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.Event=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Event",init:function A(B){if(B&&!B.name){B.name=B.type;}mstrmojo.hash.copy(B,this);},name:"",src:null});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(X,U){var Y=[],Q=X.selectedIndices,P=X.allIdx;var R,S,W=X.items;if(X.multiSelect&&(P>-1)&&(K.indexOf(U,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!Q[R]){Y.push(R);Q[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=U.length;R<S;R++){var Z=U[R];if(!Q[Z]&&(!mstrApp.isWorkstationPlugin||W)){Q[Z]=true;Y.push(Z);X.selectedIndex=Z;X.selectedItem=W[Z];}}}return Y;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(X,W){var S=[],Q=X.selectedIndices,Z=K.indexOf,P=X.allIdx;if(X.multiSelect&&(P>-1)&&(Z(W,P)>-1)){return J(X);}if(W.length>0&&Q[P]){if(Z(W,P)<0){W.push(P);}}var U=W.length,R;for(R=0;R<U;R++){var Y=W[R];if(Q[Y]){delete Q[Y];S.push(Y);if(X.selectedIndex===Y){X.selectedIndex=-1;X.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var W=S.selectedIndex,U=[],X,Q;for(Q in P){if(!R[Q]){X=parseInt(Q,10);delete P[Q];U.push(X);if(W===X){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],Y=S.items;for(Q in R){if(!P[Q]){X=parseInt(Q,10);P[Q]=true;Z.push(X);S.selectedIndex=X;S.selectedItem=Y&&Y[X];}}return{add:Z,rmv:U};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(Y,U,S){var R=U&&(typeof U==="object"),X=this.itemIdField,Q=-1,W=this.items;if(R&&X!=null){Q=K.find(W,X,U[X]);}else{if(U!=null){Q=K.indexOf(W,U);}}if((Q===-1)&&(U!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(W&&W.length)||0;}Q=P;this.add([U],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(U,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(U){this._set_selectedIndices(null,U,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,f){if(!Q||!Q.length){return ;}var S=this.items||[],w=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),X=Q.length,U=X-w.count,t=this.allowUnlistedValues,e=this.insertUnlistedValuesAt,Z=(t&&(e>-1))?U:0;if(e<0){e=S.length;}var R=[],W=[],h=w.map;if(U&&t){var s=0,g;for(g=0;g<X;g++){if(h[g]==null){R.push(Q[g]);W.push(e+s++);}}this.add(R,e);}var Y=[],o;for(o in h){var q=h[o];if(q>=e){q+=Z;}Y.push(q);}var u=Y.concat(W),a=this.addSelect(u,!f);if(!f){var b=K.hash(a),l=this.selectedIndices,d=[],p;for(p in l){if(!b[p]){d.push(parseInt(p,10));}}var P=this.removeSelect(d,true);G(this,a,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,949,950,952,953,954,955,956,1035,1101,1102,1375,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,2171,2202,2203,2204,2219,2220,2295,2784,2785,2786,2795,2796,2816,2903,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,4737,4738,4739,4740,4998,5282,5283,5924,5925,6047,6076,6077,6078,6079,6080,6081,6082,6114,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(D){var B=this;if(this.isLoaded){D();D=null;}else{var C={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){C.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(E){B.update(E);D();D=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(E){alert(E.getResponseHeader("X-MSTR-TaskFailureMsg"));}},C);}},update:function(B){if(B){mstrmojo.hash.copy(mstrmojo.hash.obj2array(B),this);}},isRTL:function A(B){return false;switch(B){case"1025":case"5121":case"15361":case"3073":case"2049":case"11265":case"13313":case"12289":case"4097":case"6145":case"8193":case"16385":case"10241":case"7169":case"14337":case"9217":case"1125":case"1065":case"1037":case"1114":case"1056":case"2080":return true;default:return false;}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:[mstrmojo.desc(1968,"S"),mstrmojo.desc(1969,"M"),mstrmojo.desc(1970,"T"),mstrmojo.desc(1971,"W"),mstrmojo.desc(1972,"T"),mstrmojo.desc(1973,"F"),mstrmojo.desc(1974,"S")],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},location:{LOCALE_TO_LANG:{"2052":mstrmojo.desc(2816,"Chinese (Simplified)"),"1028":mstrmojo.desc(2903,"Chinese (Traditional)"),"1030":mstrmojo.desc(4998,"Danish"),"1043":mstrmojo.desc(4737,"Dutch (Netherlands)"),"1031":mstrmojo.desc(949,"German"),"1033":mstrmojo.desc(950,"English (US)"),"2057":mstrmojo.desc(2295,"English (UK)"),"1036":mstrmojo.desc(952,"French"),"4108":mstrmojo.desc(4738,"French (Switzerland)"),"2060":mstrmojo.desc(6114,"French (Belgium)"),"2055":mstrmojo.desc(4739,"German (Switzerland)"),"1040":mstrmojo.desc(953,"Italian"),"2064":mstrmojo.desc(4740,"Italian (Switzerland)"),"1041":mstrmojo.desc(954,"Japanese"),"1042":mstrmojo.desc(955,"Korean"),"1045":mstrmojo.desc(6047,"Polish"),"1046":mstrmojo.desc(1035,"Portugese (Brasil)"),"3082":mstrmojo.desc(1375,"Spanish"),"1053":mstrmojo.desc(956,"Swedish")}},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var A=function(AE){var AC=(mstrApp&&mstrApp.docModelData&&mstrApp.docModelData.mid)||"",AD=AE.k||AE.key;return AD+"-"+AC;},G={},s={},U=mstrmojo.hash,a=mstrmojo.array,N=function(AE){var AC=U.keyarray(AE).sort(),AD=[],AF;a.forEach(AC,function(AG){AF=[];a.forEach(AE[AG],function(AH){AF.push(this.model.getNormalizedFormElementId(AH.id));},this);AD.push(AG+"-"+AF.sort().join("@"));},this);return AD.join("#");},M=function(AC){var AD=N.call(this,AC);if(!this._viSelections[AD]){this._viSelections[AD]=AC;if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},AB=function(AC){var AD=N.call(this,AC);if(!this._viContextMenuSelections[AD]){this._viContextMenuSelections[AD]=AC;}},p=function(AD){var AE=N.call(this,AD),AC=this._viSelections[AE];if(AC){delete this._viSelections[AE];if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return AC;},f=function(AD){var AE=N.call(this,AD),AC=this._viContextMenuSelections[AE];if(AC){delete this._viContextMenuSelections[AE];}return AC;},l=function(){var AC=A(this);s=s||{};if(G[AC]){s[AC]=U.clone(G[AC]);}},AA=function(AF,AE,AJ,AG,AC,AI,AD){var AH={};AH[AF]=[{id:AE,n:AJ,fm:AD,ui:AG,o:AC,axis:AI}];return AH;},H=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(AC){if(this._super){this._super(AC);}this._viSelections={};},update:function e(AD){var AC=true;if(this._super){AC=this._super(AD);}this.clearViSelection();if(!mstrApp.isInVFConfigMode){U.copy(G[A(this)],this);}if(!this.updateForInteractiveMode){l.call(this);}return AC;},onSelectionChange:function L(AC){if(this._super){this._super(AC);}},_viSelections:{},_viContextMenuSelections:{},_selectionType:H.EMPTY,_contextMenuSelectionType:H.EMPTY,_cellSelections:[],getSelectionType:function(){return this._selectionType;},getContextMenuSelectionType:function(){return this._contextMenuSelectionType;},isSingleAttrSelection:function(){var AD=null,AC;if(this.getSelectionType()===H.ATTS){AC=this.getSelections();if(AC.length>1){return !AC.some(function(AE){if(!AD){AD=AE[0].tid;return false;}return AD!=AE[0].tid;},this);}return true;}return false;},isSingleContextMenuAttrSelection:function(){var AD=null,AC;if(this.getContextMenuSelectionType()===H.ATTS){AC=this.getContextMenuSelections();if(AC.length>1){return !AC.some(function(AE){if(!AD){AD=AE[0].tid;return false;}return AD!=AE[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&U.keyarray(this._viSelections).length===1);},isSingleContextMenuSelection:function(){return(this._viContextMenuSelections&&U.keyarray(this._viContextMenuSelections).length===1);},getSelectionSize:function t(){return(this._viSelections&&U.keyarray(this._viSelections).length)||0;},getCxtMnuSelectionSize:function C(){return(this._viContextMenuSelections&&U.keyarray(this._viContextMenuSelections).length)||0;},getSelectionHash:function S(){return this._viSelections;},getContextMenuSelectionHash:function k(){return this._viContextMenuSelections;},getSelectionCache:function B(){return G[A(this)];},setSelectionCache:function Y(AC){G[A(this)]=AC;},getPrevSelectionInfo:function K(){return s[A(this)];},getSelections:function o(){var AC=[],AD;U.forEach(this.getSelectionHash(),function(AE){AD=[];AC.push(AD);U.forEach(AE,function(AF,AG){a.forEach(AF,function(AH){AD.push({tid:AG,eid:AH.id,v:AH.n,level:AH.level});});});});return AC;},getContextMenuSelections:function d(){var AC=[],AD;U.forEach(this.getContextMenuSelectionHash(),function(AE){AD=[];AC.push(AD);U.forEach(AE,function(AF,AG){a.forEach(AF,function(AH){AD.push({tid:AG,eid:AH.id,fm:AH.fm,v:AH.n,axis:AH.axis,o:AH.o,ui:AH.ui});});});});return AC;},isMetricValueSelected:function w(AC){return !!this._viSelections[N.call(this,AC)];},isAttSelected:function W(AD,AC){return this.isMetricValueSelected(AA(AD,AC));},isCtxMnuMetricValueSelected:function D(AC){return !!this._viContextMenuSelections[N.call(this,AC)];},isCtxMnuAttSelected:function z(AD,AC){return this.isCtxMnuMetricValueSelected(AA(AD,AC));},addAttributeSelection:function i(AD,AC,AE){if(this._selectionType!==H.ATTS){this.clearSelections();this._selectionType=H.ATTS;}var AF=AA.call(this,AD,AC,AE);M.call(this,AF);return AF[AD];},addContextMenuAttributeSelection:function g(AF,AE,AI,AG,AC,AH,AD){if(this._contextMenuSelectionType!==H.ATTS){this.clearCxtMnuSelection();this._contextMenuSelectionType=H.ATTS;}var AJ=AA.call(this,AF,AE,AI,AG,AC,AH,AD);AB.call(this,AJ);return AJ[AF];},removeAttributeSelection:function J(AD,AC){return p.call(this,AA.call(this,AD,AC));},removeContextMenuAttributeSelection:function X(AD,AC){return f.call(this,AA.call(this,AD,AC));},addMetricValueSelection:function n(AC){if(this._selectionType!==H.METRICS){this.clearSelections();this._selectionType=H.METRICS;}M.call(this,AC);},addContextMenuMetricValueSelection:function n(AC){if(this._contextMenuSelectionType!==H.METRICS){this.clearCxtMnuSelection();this._contextMenuSelectionType=H.METRICS;}AB.call(this,AC);},addAttrOrMetricCellSelection:function x(AE,AD,AC){this._cellSelections.push({parentElementIds:AE,target:{selectionType:AC?H.ATTS:H.METRICS,id:AD}});},getCellSelections:function j(){var AC=this;AC.clearCellSelections();var AD=function(AF,AE){var AG=[];if(AF){while(AE.hasOwnProperty("_p")){AG.push(AE._p._e.id);AE=AE._p;}}else{var AH=AC.model.getCellDataUnion(AE);a.forEach(AH,function(AI){AG.push(AI.eid);});}return AG;};a.forEach(AC.highlights,function(AI){var AE=AC.getCellForNode(AI),AJ=!AE.hasOwnProperty("mix")&&AE._e&&!AE.fi,AH=AD(AJ,AE);if(AJ){var AF=AE._e.id;AC.addAttrOrMetricCellSelection(AH,AF,true);}else{var AG=AE._tp._e.oid;AC.addAttrOrMetricCellSelection(AH,AG,false);}});return this._cellSelections;},removeMetricValueSelection:function O(AC){return p.call(this,AC);},removeContextMenuMetricValueSelection:function P(AC){return f.call(this,AC);},clearSelections:function c(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=H.EMPTY;this._viSelections={};this._selectionType=H.EMPTY;if(typeof this.clearSelectedGraphicInfo==="function"){this.clearSelectedGraphicInfo();}},clearViSelection:function I(){this._viSelections={};this._selectionType=H.EMPTY;},clearCxtMnuSelection:function u(){if(this._super){this._super();}this._viContextMenuSelections={};this._contextMenuSelectionType=H.EMPTY;},clearCellSelections:function Q(){this._cellSelections=[];},clearSelectionsCache:function R(){G={};},clearUnitSelections:function c(AD){if(this._super){this._super();}var AC={};U.forEach(this._viSelections,function(AF,AE){if(U.keyarray(AF)[0]!==AD){AC[AE]=AF;}});this._viSelections=AC;},clearAllSelectionsAndHighlight:function h(){this.clearSelections(true);this.endSelections();},endSelections:function F(){if(mstrApp&&mstrApp.isInVFConfigMode){return ;}G[A(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.raiseGraphicsSelectedEvent(this);if(this.isInFilterPanel()&&mstrApp&&mstrApp.isDossier){this.raiseGraphicsSelectionChangeEvent();return ;}this.onSelectionChange(this.getSelectionHash());},isInFilterPanel:function E(){var AC=this.node&&this.node.defn;return AC&&AC.iifp;},addSelectionsFromExpression:function y(AE){this.clearSelections();this._selectionType=AE.type;var AC=this,AD=function(AK){var AL=20,AI=19,AJ=function(AM){return(AM.nds||[]).length===1?AL:AM.fn;},AH=function(AM){return parseInt(AM.et,10)===5||parseInt(AJ(AM),10)===AI;},AF=function(AM){a.forEach(AM.es,function(AN){AC.addAttributeSelection(AM.a.did,AN.v,AN.n);});},AG=function(AO){var AN={},AM=function(AP){a.forEach(AP.es,function(AQ){U.copy(AA.call(AC,AP.a.did,AQ.v,AQ.n),AN);});};if(AO.nds){a.forEach(AO.nds,AM);}else{if(AO.es){AM(AO);}}AC.addMetricValueSelection(AN);};if(AH(AK)){AK={nds:[AK]};}a.forEach(AK.nds,function(AM){if(AH(AM)){if(AE.type===H.ATTS){AF(AM);}else{AG(AM);}}else{AD(AM);}});};AD(AE.data);},raiseGraphicsSelectedEvent:function q(){if(window.mstrApp&&window.mstrApp.isEmbedded){var AI=this,AH=AI.model,AG=AH&&AH.data,AE=AG&&AG.k,AC=AG&&AG.gts,AM=AC&&AC.row,AF=AC&&AC.col,AJ=a.ensureArray(AM).concat(AF||[]),AD=function(AO){var AN;a.forEach(AJ,function(AP){if(AP&&AP.id===AO){AN=AP.n;return false;}});return AN;},AK=[],AL=this.getSelectionHash();U.forEach(AL,function(AO){var AN=[];U.forEach(AO,function(AR,AQ){var AP=AD(AQ);a.forEach(AR,function(AS){AN.push({n:AP,nid:AQ,v:AS.n,vid:AS.id});});});AK.push(AN);});mstrApp.raiseEvent({name:"graphicsSelected",value:{graphics:AK,vizKey:AE}});}},raiseGraphicsSelectionChangeEvent:function b(){if(mstrApp&&(typeof mstrApp.raiseEvent==="function")){mstrApp.raiseEvent({name:"graphicsSelectionChange",value:{selections:G[A(this)],vizKey:this.k}});}},copyToContextMenuSelection:function m(){this._contextMenuSelectionType=this._selectionType;U.copy(this._viSelections,this._viContextMenuSelections);}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;mstrmojo.vi.ui.rw._HasVisSelections.clearAllSelectionsCache=function Z(){G={};s={};};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",O="mousemove",Q="mouseup";function G(Z){if(E.isPrimaryMouseBtn(Z)){B.startDragCheck(self,Z);}}var W,P,A="mstrmojo-dnd-avatar",U;function F(a,Z){if(Z!==undefined&&Z!==null){P.innerHTML=Z;}U.left=a.x+"px";U.top=a.y+"px";}function L(a,Z){if(!W){W=I.createElement("div");U=W.style;W.className=A;W.innerHTML='<div class="'+A+'-inner"></div>';P=W.firstChild;I.body.appendChild(W);}F(a,Z);U.display="block";}function R(){if(U){U.display="none";}}function H(Z){var a=++B.ctxt.moveCount;if(a>=B.minMoves){B.stopDragCheck();if((Z.buttons===1||Z.buttons===undefined||E.isIE9)&&(Z.which===1||Z.button===0||E.isIE8)){B.startDrag(self,Z);}}}function N(Z){if(E.isPrimaryMouseBtn(Z)){B.stopDragCheck();delete B.ctxt;}}function D(Z){B.onDragMove(self,Z);}function C(Z){if(E.isPrimaryMouseBtn(Z)){B.stopDrag(window,Z);}}function J(a){var Z=E.findWidget(a);while(Z){if(Z.draggable){return Z;}Z=Z.parent;}return null;}function S(Z){var b=Z.src,a=J(b.node);if(!a){return null;}if(a.getDragAction){Z.action=a.getDragAction(Z);}b.widget=a;b.data=a.getDragData&&a.getDragData(Z);if(a.isDragValid){if(!a.isDragValid(Z)){if(!mstrApp.isInVFInteractMode&&(!a.shouldDragBubble||a.shouldDragBubble(Z)===true)){Z.src.node=a.domNode.parentNode;return S(Z);}return null;}}if(a.ondragstart){a.ondragstart(Z);}return a;}function Y(b,a){var Z=E.findWidget(b),c=a.tgt&&a.tgt.widget;while(Z){if(Z.dropZone){if(Z===c){return Z;}if(Z.allowDrop&&Z.allowDrop(a)){return Z;}}Z=Z.parent;}return null;}function X(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Z,a){delete this.ctxt;var b=E.captureEventInfo({hWin:Z,e:a});this.ctxt={src:b,moveCount:0,last:M.copy(b.pos),getDirection:function(c){return !!this.dir[c];},getCtxtDragData:function(){var c=this.src;return(c&&c.data)||{};},getCtxtDropData:function(){var c=this.tgt;return(c&&c.data)||{};}};if(this.minMoves){E.attachEvent(I,O,H);E.attachEvent(I,Q,N);}else{this.startDrag(Z,a);}},stopDragCheck:function(){E.detachEvent(I,O,H);E.detachEvent(I,Q,N);},startDrag:function(Z,c){var a=this.ctxt;a.id=mstrmojo.now();var b=S(a);if(!b){return ;}E.clearBrowserHighlights(Z);E.preventDefault(self,c);E.attachEvent(I,O,D);E.attachEvent(I,Q,C);var f=window.mstrApp;if(f&&f.setInteractive){this._changeAppStatus=f.setInteractive(false);}if(!b.ownAvatar){var d=a.src;L(d.pos,d.data&&d.data.html);}},stopDrag:function(Z,g){E.detachEvent(I,O,D);E.detachEvent(I,Q,C);var c=this.ctxt,b=c.tgt||{},a=E.captureEventInfo({hWin:Z,e:g,data:b.data}),f=Y(a.node,c);a.widget=f;c.tgt=a;if(f){if(f.ondrop){f.ondrop(c);}else{X.call(f);}}var d=c.src.widget;if(d&&d.ondragend){d.ondragend(c);}if(d&&!d.ownAvatar){R();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(d,g){if(E.isSafari){E.clearBrowserHighlights();}var Z=this.ctxt,c=Z.tgt||{},a=c.widget,f=E.captureEventInfo({hWin:d,e:g,data:c.data}),j=f.widget=Y(f.node,Z),i=Z.last,b=f.pos;Z.dir={x:b.x>i.x,y:b.y>i.y};Z.last=M.copy(f.pos);Z.tgt=f;if(a!==j){if(a){if(a.ondragleave){a.ondragleave(Z);}else{X.call(a);}}if(j){Z.tgt.data=(j.getDropData&&j.getDropData(Z))||{};if(j.ondragenter){j.ondragenter(Z);}else{if(j.set){j.set("allowingDrop",true);}}}}if(j){if(j.ondragover){j.ondragover(Z);}}var h=Z.src.widget;if(h&&h.ondragmove){h.ondragmove(Z);}if(h&&!h.ownAvatar){F(f.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var E=mstrmojo.array,D=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function B(H,G){var F=[];G=G||[];D.forEach(G,function(I){E.forEach(I.att||[],function(J){if(J.did===H){F=F.concat(J.fs||[]);return false;}});});F=E.filter(F,function(I){return !!I.obf;});return E.distinct(F,"fid");},getObjectInfoFromDataset:function C(F,H){var G;D.forEach(H,function(I){if(!G){G=E.filterOne(I.mx.concat(I.att),function(J){return J.did===F;});}});return G;},getAllDatasetObjects:function A(H){var F=[],G=[];H=H||[];D.forEach(H,function(J,I){E.forEach(J.att||[],function(K){F.push({t:K.t,n:K.n,did:K.did,datasetId:I,da:K.da,ndetype:K.ndetype});});E.forEach(J.mx||[],function(K){G.push({t:K.t,n:K.n,did:K.did,datasetId:I,um:K.um});});});return{attribute:F,metric:G};}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.hash");var J=mstrmojo.array,B=mstrmojo.hash,E="u;",D="-1",C="hid";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function G(S,R,X){var Q,P;for(P in S){Q=S[P];if(Q.v){var U=Q.v.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f");var W=U.split(";");if(W&&W.length>1){W[1]=R;if(X&&W.length>2){W.pop();}Q.v=W.join(";").replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");}}}return S;},buildElemsCountStr:function L(W,R,Q){W=(!W||!W.length)?[]:W;R=(!R||!R.length)?[]:R;function U(X){return X.filter(function(Y){return !Y[C];});}var S=U(W).length,P=U(R).length;if(J.find(R,"v",E)>-1){P-=1;}if(J.find(R,"v",D)>-1){P-=1;}if(Q){S=(S<P)?P-S:0;}if(J.find(W,"v",E)>-1||J.indexOf(W,E)>-1){S=P;}return this.buildElemsCountStrByNum(S,P);},buildElemsCountStrByNum:function L(Q,P){if(Q===P){if(P===0){return"";}return P.toString();}else{if(P===0){return Q+" "+mstrmojo.desc(514);}else{if(Q>P){return"("+P+")";}}}return mstrmojo.desc(4891,"").replace("##",String(Q)).replace("###",String(P));},browseElements:function H(R,S,Q){var P={doNotHold:!(Q&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(Q,S),R,P);},getIdPresentation:function K(S){if(!!S){var R=S.charAt(0),P,Q,U;if((R>="g"&&R<="w")||(R>="V"&&R<="Z")){Q=false;for(U=1;U<S.length;++U){if(Q){Q=false;}else{switch(S.charAt(U)){case";":return"terseLong";case"\\":Q=true;break;}}}return"terse";}if(R>="B"&&R<="Q"){if(S.length>2){P=S.charAt(1);if(P>="A"&&P<="Q"){if(S.charAt(2)===":"){return"oldLong";}}}}if(S.length>=33&&S.charAt(32)===":"){return"old";}}return null;},terseLong2OldShort:function O(Q){if(this.getIdPresentation(Q)!=="terseLong"){return Q;}var P=Q.replace(/\\\\/g,"\u001e").replace(/\\\;/g,"\u001f"),R=P.substring(1,P.length).split(";");return(R[1]+":"+R[0]).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\;");},oldShort2terseLong:function M(Q,U){if(this.getIdPresentation(Q)!=="old"){return Q;}var P=Q.replace(/\\\\/g,"\u001e").replace(/\\\:/g,"\u001f"),S=P.split(":"),R=S.shift();return(U||"h")+(S.join(":")+";"+R).replace(/\u001e/g,"\\\\").replace(/\u001f/g,"\\:");},isNullElem:function I(P){if(!P){return true;}var S=this.getIdPresentation(P),Q=false,R;switch(S){case"terse":case"terseLong":R=P.substring(1,P.length).split(";");Q=R[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":Q=P.indexOf(this.OLD_NULL)>-1;break;}return Q;},isNonGroupNull:function(R){var P=R.eid||(R._e&&R._e.id),Q=P&&P.split(":")[0];return Q&&Q===this.NON_GROUP_NULL;},getAttributeId:function N(R){var Q,P;if(R){P=R.split(";");Q=P[1];}return Q;},getElementValue:function A(Q){var R,P;if(Q){P=Q.split(";");if(P.length>2){R=P[0]+" "+P[2];}else{R=P[0];}}return R;},isAttributeIdsLinked:function F(Q,P,R){var U=false,S=B.keyarray(R);J.forEach(S,function(W){if(W===Q){J.forEach(R[W],function(X){if(X===P){U=true;return false;}});}if(U){return false;}});return U;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000",ELEM_ALL:{t:mstrmojo.chart.model.enums.EnumDSSObjectType.DssTypeDimension,v:"u;",n:"(All)"}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var W=this.vscrollNode,X=W&&W.style;if(!X){return ;}if(this.vscrollVisible){var U=this.maxPos,Y=this.clientSize;X.height=Math.round(Y.y*Y.y/U.y)+"px";X.left=(Y.x-5)+"px";X.display="block";X.opacity=0.5;}else{X.opacity=0;}},onhscrollVisibleChange:function(){var X=this.hscrollNode,W=X&&X.style;if(!W){return ;}if(this.hscrollVisible){var U=this.maxPos,Y=this.clientSize;W.width=Math.round(Y.x*Y.x/U.x)+"px";W.top=(Y.y-5)+"px";W.display="block";W.opacity=0.5;}else{W.opacity=0;}}};var M=L.copy({onposChange:function(){var X=this.clientSize,W=this.maxPos,U=0,Y=0;if(this.scrollsVert){Y=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((X.y-(X.y*X.y/W.y))*this.pos.y/W.y)+"px)";}}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((X.x-(X.y*X.x/W.x))*this.pos.x/W.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(U,10)+"px, -"+parseInt(Y,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var X=this.clientSize,W=this.maxPos,U=0,Z=0,Y=this.scrollboxNode;if(this.scrollsVert){Z=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((X.y-(X.y*X.y/W.y))*this.pos.y/W.y)+"px";}Y.scrollTop=parseInt(Z,10);}if(this.scrollsHoriz){U=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((X.x-(X.y*X.x/W.x))*this.pos.x/W.x)+"px";}Y.scrollLeft=parseInt(U,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var Y=this.scrollboxNode,X=this.itemsContainerNode||Y.firstChild;if(Y&&Y!==X){this.scrollChild=X;var U=Y.style;U.position="relative";U.overflow="hidden";var W=X.style;W.position="absolute";W.left=0;W.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(U){if(this.usesTouches){this.detachTouchEvents();}this._super(U);},attachTouchEvents:function(){var W=this.touchNode||this.scrollboxNode;if(W){if(!this._tsCallback){var U=this;this._tsCallback=function(X){U.touchesBegin(self,X);};this._tmCallback=function(X){U.touchesMoved(self,X);};this._teCallback=function(X){U.touchesEnd(self,X);};}D.attachEvent(W,D.TOUCHSTART,this._tsCallback);this._tsNode=W;}},detachTouchEvents:function(){var U=this._tsNode;if(U){D.detachEvent(U,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(U,X){var W=X.target&&X.target.tagName;if(W&&(W==="SELECT"||W==="INPUT")){return ;}D.preventDefault(U,X);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(U,X),U);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(d,g){var b=D.getMousePosition(D.firstTouch(d,g),d);D.preventDefault(d,g);if(!this.dragging){var U=5,j=Math.abs;if((this.scrollsHoriz&&j(b.x-this.pos.x)>U)||(this.scrollsVert&&j(b.y-this.pos.y)>U)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=b;var X=this.scrollboxNode,a={x:X.clientWidth,y:X.clientHeight},h={x:X.scrollWidth,y:X.scrollHeight};this.clientSize=a;this.scrollSize=h;this.maxPos={x:Math.max(h.x-a.x,0),y:Math.max(h.y-a.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(d,g);var f=this.startTimePos,Z=this.startTouchPos,c=this.maxPos;var Y={x:this.scrollsHoriz?Math.max(Math.min(f.x-(b.x-Z.x),c.x),0):0,y:this.scrollsVert?Math.max(Math.min(f.y-(b.y-Z.y),c.y),0):0};this.set("pos",Y);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=b;var W=new Date(),i=this.lastDragTime;this.nextLastDragTime=i;this.lastDragTime=W;if((W-i)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:Y.x,y:Y.y};this.startTouchPos=b;}}},touchesEnd:function I(U,W){D.preventDefault(U,W);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(U,W);if((new Date())-this.lastDragTime<=R){this.startDeceleration(U,W);}else{this.hideScroll();}}},startDeceleration:function B(a,b){var Y=D.getMousePosition(D.firstChangedTouch(a,b),a),f=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||Y,d={x:Y.x-f.x,y:Y.y-f.y},U=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),g=U?(new Date())-U:0,X={x:g?Number(d.x*O*F/g).toFixed(2):0,y:g?Number(d.y*O*F/g).toFixed(2):0};var c=this,W=function(e){return(c.scrollsHoriz&&Math.abs(e.x)>=G)||(c.scrollsVert&&Math.abs(e.y)>=G);};if(W(X)){this.velocity=X;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var Z=function(){c.decelerate();if(!W(c.velocity)){c.stopDeceleration();c=null;}};Z();if(this.decelerating){this.decelerationTimer=window.setInterval(Z,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var Y=this.pos,X=this.velocity,W=this.friction,b=this.maxPos,Z={x:Y.x-X.x,y:Y.y-X.y},d=this.bounces,U=this.BOUNCEFRICTION;var c=Z.x;if(c<0||c>b.x){Z.x=(c<0)?0:b.x;X.x*=d?-U:0;W.x=U;}var a=Z.y;if(a<0||a>b.y){Z.y=(a<0)?0:b.y;X.y*=d?-U:0;W.y=U;}this.set("pos",Z);this.velocity={x:W.x*X.x,y:W.y*X.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var U=this.maxPos;if(this.scrollsVert&&U.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&U.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var Y=this._sourceFn;if(!Y){var X=this.source;if(X!=null){if(typeof (X)=="string"){if(!(X.match("return "))&&!(X.match(/\;\s*\S/))){X="return "+X;}Y=new Function(X);}else{if(typeof (X)=="function"){Y=X;}}this._sourceFn=Y;}}var S,Z=this.parent;if(Y){try{S=Y.apply(Z,[]);}catch(W){}}var U=this.setter,a=this.destination;if(U==null){Z[a]=S;}else{if(typeof (U)=="string"){Z[U](a,S);}else{if(typeof (U)=="function"){U.apply(Z,[a,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var U=this._chains;if(!U){this._parseChains();U=this._chains;}for(var S in U){this._attachChain(U[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var U=this._chains;if(U){for(var S in U){this._detachChain(U[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var W=this._chains;var U=this.source;if(U&&(typeof (U)=="function")){U=U.toString&&U.toString();}if(!U){return ;}function S(d,g,X,Z){var Y=d,b;while(b=Y.match(g)){var e=b[0],c=e.length,f=true;e=e.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var a in W){if(a.substr(0,c)===e){f=false;break;}else{if(e.indexOf(a)===0){delete W[a];}}}if(f){W[e]={host:(X==null)?null:b[X],parts:b[Z].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}Y=Y.substr(b.index+c);}}if(D.test(U)){S(U,O,null,1);}if(R.test(U)){S(U,M,1,2);}if(B.test(U)){S(U,L,1,2);}},_attachChain:function Q(S,W){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var f=S.evt2idx,j=S.idx2evt,b=S.parts;var g=(W>=0)?W:0,d=this.id,Y=mstrmojo.all,e=(W>0)?Y[j[g-1].context][b[g-1]]:(S.host?Y[S.host]:this.parent),U=b[g];var X=mstrmojo.array;while(e&&U){if(e.attachEventListener){var h=e[U+"_bindEvents"]||(U+"Change");if(typeof (h)=="string"){h=[h];}var a=[];for(var c=0,Z=h.length;c<Z;c++){a[c]=e.attachEventListener(h[c],d,"_callback");}for(var c=0;c<h.length;c++){f[e.id+"_"+h[c]]=g;}j[g]={context:e.id,evts:h,subs:a};}e=e[U];U=S.parts[++g];}},_detachChain:function G(S,U){var W=mstrmojo.all,l=S.idx2evt,f=S.evt2idx,c=this.id;var a=(U>-1)?U:0,d=l.length;if(a<d){for(;a<d;a++){var b=l[a];if(!b){break;}var Y=b.context,e=W[Y],k=b.evts;if(e&&e.detachEventListener){var m=b.subs;for(var h=0,X=m.length;h<X;h++){e.detachEventListener(m[h]);}}l[a]=null;for(var Z=0,g=k.length;Z<g;Z++){delete f[Y+"_"+k[Z]];}}}},_callback:function I(U){this.exec();if(!U||!U.name||!U.src){return ;}var W=U.src.id+"_"+U.name,Y=this._chains;for(var Z in Y){var X=Y[Z],S=X.evt2idx[W];if(S!=null){this._detachChain(X,S+1);this._attachChain(X,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(F){var D=(F&&F.gts&&F.gts.col)||[],H=(F&&F.gts&&F.gts.row)||[],E=[];var G=C.filter(D.concat(H),function(I){return I.otp===-1;});C.forEach(G,function(I){E=E.concat(I.es);});return{tpltProp:F.prop,mxProp:C.map(E||[],function(I){var J={};J[I.oid]=mstrmojo.hash.copy(I.prop,{n:I.n,t:I.otp});return J;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var O=/\{\@(en@)?([^\}]+)\}/gm,K=/\</gm,W=/\>/gm,F=/\S/,S=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],G=new RegExp("(\\"+S.join("|\\")+")","g"),X={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;","\u0009":"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},a={"&amp;":"&","&lt;":"<","&gt;":">","&#x09;":"\u0009","&#x0A;":"\n","&#x0D;":"\r","&quot;":'"',"&#039;":"'"},D={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#39;",'"':"&#34;"},N={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#39;":"'","&#34;":'"'},E={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","\u20ac":"&#8364;"},L={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&#34;":'"',"&#8364;":"\u20ac"};var M=function(b){if(b===null){return"null";}var c=typeof b;if(c!=="object"){return c;}if(b.length===undefined){return"object";}return"array";};var Y={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function H(c,f,e){var b;e=e||[];if(!c){return"";}var d=[];for(b in f){if(mstrmojo.array.indexOf(e,b)===-1){d.push(b.k||b);}}return c.replace(new RegExp(d.join("|"),"g"),function(g){var h=f[g];return h.v||h;});},trim:function R(b){return(b&&b.replace)?b.replace(/^\s+/,"").replace(/\s+$/,""):b;},startsWith:function Z(c,b){return c.length>=b.length&&c.substring(0,b.length)===b;},endsWith:function U(c,b){return c.length>=b.length&&c.substring(c.length-b.length)===b;},ellipsize:function A(d,c){var b=this.trim(d.substr(0,(c||1)-1));if(b!==d){b+="&hellip;";}return b;},isEmpty:function J(b){return(b===null)||(b===undefined)||!(F.test(b));},regEscape:function Q(b){return b.replace(G,"\\$1");},escapeIllegalXML:function C(b){if(!b||!b.replace){return b;}var c=/\u001a/gm,d="";return b.replace(c,d);},encodeXMLAttribute:function(b){return mstrmojo.string.multiReplace(b,X);},decodeXMLAttribute:function(b){return mstrmojo.string.multiReplace(b,a);},encodeHtmlString:function(c,b,d){if(!c||!c.replace){return c;}if(d){return mstrmojo.string.multiReplace(c,E);}return mstrmojo.string.multiReplace(c,D,b?[" "]:[]);},decodeHtmlString:function(c,b){return b?mstrmojo.string.multiReplace(c,L):mstrmojo.string.multiReplace(c,N);},htmlAngles:function(b){if(!mstrmojo.string.isEmpty(b)){b=String(b);return b.replace(K,"&lt;").replace(W,"&gt;");}return b;},apply:function I(b,d){if(!b){return"";}var c=this;return b.replace(O,function e(h,i,j){var f;try{f=mstrmojo.hash.walk(j,d);if(typeof f==="function"){f=f.call(d);}}catch(g){}f=(f===null||f===undefined)?"":f;return(!!i)?c.encodeHtmlString(f,true):f;});},json2xml:function(b,s,u){if(!(s instanceof Array)){s=[s];}var c=u&&u.isSerializable,q=(u.convertBoolean!==false),x=u&&u.skipFunctions,p,h;var k=[],f=[],j,e,g;for(p=0,h=s.length;p<h;p++){var o=s[p];for(j in o){if(x&&typeof o[j]==="function"){continue;}if(c){var w=c(j,s,p);if(w!==true){if(w===false){continue;}else{if(w.att){k.push(w.att);}if(w.child){f.push(w.child);}continue;}}}e=o[j];g=M(e);switch(g){case"array":var l,m;f.push("<"+j+">");for(l=0,m=e.length;l<m;l++){var d=u.getArrItemName(j,e,l)||l;f.push(this.json2xml(d,e[l],u));}f.push("</"+j+">");break;case"object":f.push(this.json2xml(j,e,u));break;case"string":k.push(j+'="'+mstrmojo.string.encodeXMLAttribute(e)+'"');break;case"boolean":k.push(j+'="'+(q?(e?"-1":"0"):e)+'"');break;case"null":if(!u.skipNull){k.push(j+'="'+u.nullValue+'"');}break;default:k.push(j+'="'+e+'"');break;}}}return"<"+b+" "+k.join(" ")+">"+f.join("")+"</"+b+">";},escape4HTMLText:function B(i){if(!i||!i.replace){return i;}var f=/"/gm;var d="&quot;";var j=/&/gm;var h="&amp;";var g=/</gm;var b="&lt;";var e=/>/gm;var c="&gt;";return i.replace(j,h).replace(f,d).replace(g,b).replace(e,c);},parseUri:function(f,c){c=c||Y;var b=c.parser[((c.strictMode)?"strict":"loose")].exec(f),e={},d=14;while(d--){e[c.key[d]]=b[d]||"";}e[c.q.name]={};e[c.key[12]].replace(c.q.parser,function(h,g,i){if(g){e[c.q.name][g]=i;}});return e;},removeSpecialChars:function(b){return b.replace(/[^a-zA-Z0-9]/g,"");},hashCode:function P(b){return b.split("").reduce(function(d,c){d=((d<<5)-d)+c.charCodeAt(0);return d&d;},0);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.EnumRWUnitType");var B=mstrmojo.hash,J=mstrmojo.EnumRWUnitType;mstrmojo.vi.ui._CanFreeformGroup=mstrmojo.provide("mstrmojo.vi.ui._CanFreeformGroup",{_mixinName:"mstrmojo.vi.ui._CanFreeformGroup",notifyGroup:function G(){this.raiseEvent({name:"member_changed",unit_box:this});},updateByGroup:function E(Q){var Y=Q.delta,P=this.parent,X=P.boxLayoutConfig,U=this.domNode.style,W=parseFloat(U.left),S=parseFloat(U.top),R=!!this.getBoxBorderWidth?this.getBoxBorderWidth():0;P.updateChildNode(this,{newLayout:{left:(W+Y.x)+"px",top:(S+Y.y)+"px",width:parseFloat(U.width)+R+"px",height:parseFloat(U.height)+R+"px"}});},updateConfigNode:function C(S){var P=this.parent,R=P.getFloatGroupTree();if(R){var Q=P.groupTreeLayoutConfig.getFloatGroupTreeNode(this.k);if(Q.node){P.groupTreeLayoutConfig.updateConfigNode(Q.node,S);}}},updateFreeformLayout:function F(R){var Q=this,P=this.parent;P.snapGuide.boxIntervalOperations(Q,"delete");Q.raiseEvent({name:"member_snap_guide_changed_pre"});P.boxLayoutConfig.updateFloatLayout(R,Q);P.applyGroupTree(undefined,Q.getPUKeys(false));Q.updateSelfSplitter();P.snapGuide.boxIntervalOperations(Q,"insert");Q.raiseEvent({name:"member_snap_guide_changed_post"});},createGroup:function I(P){return this.parent.groupTreeLayoutConfig.createGroup(P);},getPUKeys:function M(Q){var R=this.getParentGroup(),P=this.k;if(!R){return null;}if(!R.parent){return[P];}if(Q){return[R.k].concat(R.children.map(function(S){return S.k;}));}return[R.k,P];},isGrouped:function N(){var Q=this.parent,P=false,S=Q.getFloatGroupTree();if(S){var R=Q.groupTreeLayoutConfig.findGroupByKey(S.k);if(R&&R.children.indexOf(this)<0){P=true;}}return P;},getParentGroup:function L(){var P=this.parent,Q=P.groupTreeLayoutConfig.getFloatGroupTreeNode(this.k);return P.groupTreeLayoutConfig.findGroupByKey(Q&&Q.parent&&Q.parent.k);},selectGroup:function A(){this.parent.groupTreeLayoutConfig.selectGroupByChild(this);},moveToGroup:function D(R){var P=this.parent,Q=P.groupTreeLayoutConfig;R.addGroupMemberNode(Q.getFloatGroupTreeNode(this.k).node);},unGroup:function K(P){if(!P){P=this.parent;}var S=P.getFloatGroupTree(),Q=P.groupTreeLayoutConfig.unGroup(this.k);if(Q){if(Q.children.length===1&&Q.k!==S.k){var R=P.groupTreeLayoutConfig.findGroupByKey(S.k);R.addGroupMemberNode(P.groupTreeLayoutConfig.getFloatGroupTreeNode(Q.children[0].k).node);}}},onvisibleChange:function O(R){var U=this,Q=this.parent,W=R.value,P=R.valueWas,S=W?"insert":"delete";if(P===W){return ;}if(W){U.set("visible",W);Q.snapGuide.boxIntervalOperations(U,S);}else{Q.snapGuide.boxIntervalOperations(U,S);U.set("visible",W);}},updateNodeHiddenHandler:function H(P){if(P){this.refresh();if(B.walk("defn.t",this)===J.TEXTFIELD){this.rebuildBoxContent();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,X){var U=R[X];if(U===undefined){delete Q[X];return true;}S=Q[X]=D(S);U=R[X]=D(U);if(J(S)&&J(U)){throw (G);}else{if(J(U)){delete R[X];if(J(R[X])){E(R,Q);}}else{if(J(S)){delete R[X];if(J(R[X])){E(R,Q);}}else{try{E(R[X],Q[X]);}catch(W){switch(W){case G:R[X]=Q[X]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(W,S){var U=W.include,Y=W.exclude;if(J(U)||J(Y)){return true;}if(!J(U)&&!J(Y)){try{E(Y,U);}catch(X){switch(X){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(W,U){if(W===true||J(W)){Q.push(R+U);}else{F(W,R+U+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(W,S){var U=[];F(W.include,"",U);F(W.exclude,"!",U);R[S]=U.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,W){var U=R[W];if(U!==undefined){if(S!==true&&U!==true){K(S,U);}else{if(S===true&&U!==true){R[W]=true;}else{if(S!==true&&U===true){Q[W]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(a,U){var Y=S[U];if(Y){var W=a.include,b=a.exclude,Z=Y.include,X=Y.exclude;if(!J(X)&&!J(b)){Q=false;return Q;}if(!J(Z)&&!J(W)){K(Z,W);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(Y,W,U,X){R[Y]=X?true:{};R=R[Y];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,U){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(U){if(L(Q,U)){S[R]=B.mergeHashes(Q,U);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(U){var Q={},W={},S={};H.forEach(U,function R(Y){var X=Y.partialRetrieval;if(X){H.forEach(X.nodes,function(Z){W[Z]=true;});S=B.mergeHashes(S,X.filters);delete Y.partialRetrieval;}H.forEach(Y.actions,R);});if(!J(W)){Q.nodes=B.keyarray(W);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(U){var S={};B.forEach(U,function(Y,X){var W=S[X]={serialized:Y,include:{},exclude:{}};H.forEach(Y.split(";"),function(a){var Z=a.indexOf("!")===0;a=Z?a.slice(1):a;C(a,Z?W.exclude:W.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var S=mstrmojo.array,O=mstrmojo.hash;var W=1,N=2;var D=2,H=4,C=5;var A=3;function F(X,Y){return X[((Y===W)?"row":"col")];}function B(X,Z){var Y=Z.lm;return Y&&Y[X.mix||0];}function K(X){return X.replace(/;/g,"\\;");}mstrmojo._XtabModelShared=mstrmojo.provide("mstrmojo._XtabModelShared",{mixinName:"mstrmojo._XtabModelShared",getSortAction:function E(Y,q,a,i){var o=this.getCellTitleInfo(Y),w=o.title,s=[],h=function(){if(o.isSrcTitle){return w.axis;}return S.find(this.data.gts.col,"otp",-1)>-1?W:N;},j=h.call(this),m=this.data.gts[((j===W)?"row":"col")+"SubPos"],u=this.xtab,p,c,f,k,Z,t,d;if(u.getColumnSetCellBelongsTo){p=u.getColumnSetCellBelongsTo(Y);}q=(q===null||q===undefined)?!(Y&&Y.so):q;if(o.isSrcTitle){c=D;f=w.id;k=w.otp;Z=Y.fs&&Y.fs[0];t=Z&&Z.n==="DYNAMICLINK"?"45C11FA478E745FEA08D781CEA190FE5":w.fid;}else{c=H;k=4;d=w.stt;var n,g;do{n=Y._e;if(n){if(n.oid){f=n.oid;}else{g=K(n.id);s.push(g);}}Y=Y._p;}while(Y);}var l={sortType:c,axis:j,isAsc:q,unitID:f,unitType:k,elementList:s.join(";"),subTotalsPos:m};if(f){l.unitID=f;}if(t){l.formId=t;}if(!a){if(d){l.sortType=C;l.stt=d;}}var X;if((c===H)||(c===C)){X=["","",l.elementList||"",l.axis];}else{X=[l.formId,"21","",l.axis];}X=[l.unitType,l.unitID].concat(X);l.sortKey=X.join("!");if(a){var b=[];b.push(a);if(a===A){b=b.concat([i.did,i.t]);}l.metricSortKey=b.join("!");}if(p){l.columnSetKey=p.k;}return l;},hasDummySortKey:function M(X){var Y=X.split("!");return Y[1]==="00000000000000000000000000000000";},convertCurrentSortAxisIntoActionSort:function I(X){var Y=this;X=S.filter(X,function(Z){return !Y.hasDummySortKey(Z.key);});(X||[]).forEach(function(a){var Z=a.key;if(Z){a.key=K(Z).replace(/\u001e/g,";");}});return X;},convertCurrentSortsIntoActionSorts:function L(Z){var X=O.clone(Z),Y=this;X.forEach(function(a,b){X[b]=Y.convertCurrentSortAxisIntoActionSort(a);});return X;},getCellTitleInfo:function Q(Y,d){var Z=d?d.gts:this.data.gts,a=Z&&Z.col,c=Y&&Y.setIdx;var b=null;if(Z){if(Y&&Y.mix===undefined){b=F(Z,Y.axis)[Y.tui||Y.ui];}else{var X=function(g){var e=(g&&g.length)||0,f;for(f=e-1;f>=0;--f){if(parseInt(g[f].otp,10)===-1){return g[f];}}return null;};if(typeof c==="number"&&c>-1){a=this.xtab.getColSetColumnTitles(c,true);}b=X(a)||X(Z.row);}}return{isSrcTitle:!!Y&&(Y.o===undefined)&&!((Y.mix!==undefined)&&(Y._lp||Y._tp)),title:b};},getCellLinksInfo:function R(Y,Z){if(!Z){var X=this.getCellTitleInfo(Y);Z=X&&X.title;}return B(Y,Z);},getCellInfo:function G(Y){var X=this.getCellTitleInfo(Y),Z={isTitle:false,isHeader:false,isMetric:false};if(Y&&(Y.hasOwnProperty("mix")||Y.otp===-1)){Z.isMetric=true;if(Y._e){Z.isHeader=true;}}if(X.isSrcTitle){Z.isTitle=true;}return Z;},getAllDrillPathsForCell:function P(Y,d){if(!d){var X=this.getCellTitleInfo(Y);d=X&&X.title;}var Z=O.walk("_e.oid",Y),b=!!(d&&d.dp)?d.dp.slice(0):[];for(var a=0;a<b.length;a++){var e=b[a],c=e&&e.oid;if(c&&Z&&c!==Z){b[a]={};}}return b;},getPivotAction:function J(Y,f){var a=false,Z=Y.hasOwnProperty("mix"),g=Z?null:Y.axis,d=(Z?Y.idx:Y.ui)+1,l=(Y.otp===-1);if(!isNaN(f)){g=parseInt(f,10);d=1;if(Z){Z=false;l=true;}}else{var j=(f==="u"||f==="l"||f==="b");if(!Z){var b=F(this.data.gts,g),n=0,q={},X=false;mstrmojo.array.forEach(b,function(s){if(q[s.id]){q[s.id].frm++;}else{n++;q[s.id]={pos:n,frm:1};if(s.id===Y.id){X=true;}else{if(X){return false;}}}});d=q[Y.id].pos;var k=Y.fix;if(k){if((!j||k>1)&&!this.xtab.isOutlineMode){if(j||k!==q[Y.id].frm){d=k;a=true;}}}}else{var o=F(this.data.gts,Y.axis),i=o[Y.ui].es,e=this.data.gsi.mx;if(i.length!==e.length){var h=i[d+(j?-1:1)-1];if(h){var c=S.find(e,"did",h.oid);if(c!==-1){d=c+(j?1:-1)+1;}}}}if(f==="b"){d=1;}else{d=d+(j?-1:1);}}var m={act:"pivot",unitPos:d};if(a){m.attFormId=Y.fid;}else{if(!Z){m.axis=g;}}if(!l){var p=Z?Y._e:Y;if(!a){m.unitType=p.otp;}m.unitId=Z?p.oid:Y.id;}return m;},getPCellParentNodeByPI:function U(e){var d=O.walk("pi.ri",e),f=O.walk("pi.ci",e),Y=O.walk("data.ghs.chs.items",this),X=O.walk("data.gts.col",this);if(typeof d==="undefined"||typeof f==="undefined"||!Y||!X){return undefined;}var b=O.walk(d+".items."+f,Y),Z=X[d],a,c;if(Z.otp===-1){a=f%Z.es.length;c=Z.es[a];}else{c=Z.es[f];}b._e={id:c&&c.id,n:c&&c.n};return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array");var H=mstrmojo.array,G=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function B(){var I=this.getFormats(),L="",K=function K(M){if(I[M]){var N=this[M]||I[M];this[M]=N;if(this.isFullScreenWidget){I[M]=N;}this[M+"Limit"]=parseInt(N,10);}};K.call(this,"height");K.call(this,"width");var J=function(P,O){var M=I[P];if(M&&M.charAt(M.length-1)!=="%"){var N=parseInt(M,10);if(!isNaN(N)){if(O){N-=O;}L+=P+":"+N+"px;";}}return null;};J("height",0);J("width",0);this.scrollboxNodeCssText=L;return this._super();},postBuildRendering:function D(){var J=this._super();var I=this.gridData;if((I.afw||I.afc)&&this.hasCustomScrollbar&&!this.node.data.eg&&this.scrollboxNode.firstChild){this.scrollboxNode.firstChild.style.width=this.getFormats().width;}return J;},resize:function A(){this.clearCache();var K=this.getFormats(),J=parseInt(K.height,10),I=parseInt(K.width,10);if(I>0&&J>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}H.forEach([this.scrollboxNode,this.viewport],function(M){var L=M.style;L.height=J+"px";L.width=I+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=J&&(J!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(J,10);this.heightLimit=this.scrollboxHeight;this.scrollboxBottom=this.scrollboxTop+J;}if(I>0){this.widthLimit=I;}if(this.lockHeadersCase){this.resizeScrollBox(G.isIE);}}this.delegateGridAction(function(L){if(L&&L.onscroll){L.onscroll();}},"scrollOnResize");if(!(this.gridData&&this.gridData.eg!==undefined)){this.onGridWidthChanged();if(this.refreshResizeHandlers){this.refreshResizeHandlers();}}if(this.lockHeadersCase){this._refreshClonedNodes();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function E(){this.clearCache();this.unrender();this.render();},unrender:function F(I){this.clearCache();if(this._super){this._super(I);}},defaultAction:function C(N,I){if(this._super(N,I)){var M=this.model.sti,L=M&&M.titleId,K=M&&M.deselectCurrent;this._currentSelectedTD=K?undefined:N;if(L){var J=this.zone;this.delegateGridAction(function(P){var O=P.domNode,Q=O&&O.firstChild;if(!J&&Q&&(N.offsetParent===Q||N.offsetParent===O)){J=P;}},"defaultClickAction");if(J){J.clearHilites(L);if(!K){J.setHilites(L,N);}J.hiliteKey=L;this.model.sti=null;}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var O=mstrmojo.array,K="#000000",G=Math.round;function S(f){return("0"+Math.max(0,Math.min(255,parseInt(f,10))).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function c(f){if(f==="transparent"){return["0","0","0"];}else{return f.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);}},rgbStr2hex:function I(f){if(f.indexOf("rgb")>=0){var g=this.rgbStr2rgb(f);return"#"+this.rgb2hex(g[0],g[1],g[2]);}return f;},rgb2rgba:function d(f,g){var h=f.charAt(0)==="#"?this.hex2rgb(f):this.rgbStr2rgb(f);if(!O.isArray(h)||h.length!==3){return f;}h.push(g/100);return"rgba("+h.join(",")+")";},rgb2hex:function B(i,h,f){return S(i)+S(h)+S(f);},rgb2hsv:function b(f,m,o){var k=Math.min(f,m,o),p=Math.max(f,m,o),l=0,u,t;t=p/255;u=(p!==0)?(parseFloat(p)-parseFloat(k))/parseFloat(p):0;if(u===0){l=0;}else{var n=p-k,i=(p-f)/n,j=(p-m)/n,q=(p-o)/n;if(f===p){l=q-j;}else{if(m===p){l=2+i-q;}else{l=4+j-i;}}l=l/6;if(l<0){l=l+1;}}return[G(l*360),G(u*100),G(t*100)];},rgb2hsl:function E(f,m,n){f/=255;m/=255;n/=255;var o=Math.max(f,m,n),j=Math.min(f,m,n),i=(o+j)/2,k,q;if(o===j){k=q=0;}else{var p=o-j;q=i>0.5?p/(2-o-j):p/(o+j);switch(o){case f:k=(m-n)/p+(m<n?6:0);break;case m:k=(n-f)/p+2;break;case n:k=(f-m)/p+4;break;}k/=6;}return[k,q,i];},hsl2rgb:function D(n,u,m){var k=function k(l,h,g){if(g<0){g+=1;}if(g>1){g-=1;}if(g<1/6){return l+(h-l)*6*g;}if(g<1/2){return h;}if(g<2/3){return l+(h-l)*(2/3-g)*6;}return l;},f,o,t;if(u===0){f=o=t=m;}else{var i=m<0.5?m*(1+u):m+u-m*u,j=2*m-i;f=k(j,i,n+1/3);o=k(j,i,n);t=k(j,i,n-1/3);}return[G(f*255),G(o*255),G(t*255)];},hsl2hex:function L(i,g,f){return"#"+O.map(this.hsl2rgb(i,g,f),function(h){return S(h);}).join("");},hex2rgb:function W(j){var f=this.fixFullHexValue("#"+j.replace("#","")),g=[],h;f=f.replace("#","");for(h=0;h<3;h++){g.push(parseInt(f.substr(h*2,2),16));}return g;},hex2bgr:function N(f){return this.hex2rgb(f).reverse();},hex2hsv:function Z(g){var f=this.hex2rgb(g);return this.rgb2hsv(f[0],f[1],f[2]);},hex2hsl:function e(f){return this.rgb2hsl.apply(this,this.hex2rgb(f));},hsv2rgb:function J(u,AB,z){u=u/360;AB=AB/100;z=z/100;var f,w,y;if(AB===0){f=z*255;w=z*255;y=z*255;}else{var l=u*6;if(l===6){l=0;}var o=Math.floor(l);var k=z*(1-AB);var j=z*(1-AB*(l-o));var AA=z*(1-AB*(1-(l-o)));var x,m,n;switch(o){case 0:x=z;m=AA;n=k;break;case 1:x=j;m=z;n=k;break;case 2:x=k;m=z;n=AA;break;case 3:x=k;m=j;n=z;break;case 4:x=AA;m=k;n=z;break;default:x=z;m=k;n=j;break;}f=x*255;w=m*255;y=n*255;}return[G(f),G(w),G(y)];},hsv2hex:function P(j,i,f){var g=this.hsv2rgb(j,i,f);return this.rgb2hex(g[0],g[1],g[2]);},getContrastingColor:function R(i,g,f){var h=this.hex2rgb(i);return(((h[0]*299)+(h[1]*587)+(h[2]*114))/1000<125)?g:f;},getLuminance:function H(g){var f=this.hex2rgb(g);return 0.2126*f[0]+0.7152*f[1]+0.0722*f[2];},getHighlightColor:function Y(n,l){var f,m,o,p,q=this.hex2rgb(!l?"#FFCE7F":"#EFE6D8"),k=parseInt(n[0],10),i=parseInt(n[1],10),t=parseInt(n[2],10),j=parseInt(q[0],10),h=parseInt(q[1],10),s=parseInt(q[2],10);f=(k*j)/255;m=(i*h)/255;o=(t*s)/255;p=k*0.3+i*0.59+t*0.11;if(p<85){f=f+(63*(85-p)/85);f=f>255?255:f;m=m+(63*(85-p)/85);m=m>255?255:m;o=o+(63*(85-p)/85);o=o>255?255:o;}return"#"+this.rgb2hex(G(f),G(m),G(o));},get3DBorderColor:function X(i,l){var h=parseInt(i[0],10)*0.3+parseInt(i[1],10)*0.59+parseInt(i[2],10)*0.11;var k=parseInt(i[0],10);var j=parseInt(i[1],10);var f=parseInt(i[2],10);switch(l){case"light":if(h>150){k=k*0.9;j=j*0.9;f=f*0.9;}else{k=k*0.6+102;j=j*0.6+102;f=f*0.6+102;}break;case"dark":if(h>10){k=k*0.4;j=j*0.4;f=f*0.4;}else{k=k*0.8+30;j=j*0.8+30;f=f*0.8+30;}break;}return"#"+this.rgb2hex(G(k),G(j),G(f));},encodeColor:function M(f,g){if(g!==undefined&&(f===null||f.length===0||f==="undefined")){f=g;}if(f==="transparent"){return -1;}if(parseInt(f,10)===-2){return -2;}if(f.substring(0,1)==="#"){f=f.substring(1);}return parseInt(f.substring(4)+f.substring(2,4)+f.substring(0,2),16);},decodeColor:function A(f){f=parseInt(f,10);if(f===0){return K;}var g=16777216+(f&255)*65536+(f&65280)+(f&16711680)/65536;return"#"+g.toString(16).substring(1).toUpperCase();},fixFullHexValue:function a(f){if(f&&f.length===4){return f.replace(/([0-9a-f])/ig,"$1$1");}return f;},findMidColorHex:function U(i,h){var j=this.hex2rgb(i),f=this.hex2rgb(h),g=[];j.forEach(function(k,l){g.push(parseInt((k+f[l])/2,10));});return("#"+this.rgb2hex(g[0],g[1],g[2]));},lightenHex:function C(l,k){var h=parseInt(l.replace("#",""),16),m=Math.round(2.55*k),j=(h>>16)+m,i=(h&255)+m,f=(h>>8&255)+m;return"#"+(16777216+(j<255?j<1?0:j:255)*65536+(f<255?f<1?0:f:255)*256+(i<255?i<1?0:i:255)).toString(16).slice(1);},applyOpacityToHex:function Q(g,h){if(h>=100){return g;}var f=Math.round(h*2.55).toString(16);return g+f.padStart(2,"0");},getResponsiveFontColor:function F(k){var j=k?k.c1||k:"",f=this.getLuminance(j),h=255,m=121.71921,g=Math.max(h/f,f/h),l=Math.max(m/f,f/m),i="#fff",n="#35383a";if(g>=l){return i;}return n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var I=mstrmojo.array,Q=mstrmojo.desc(2412,"Default"),P=mstrmojo.desc(3433,"Font"),K=mstrmojo.desc(3434,"Number"),D=mstrmojo.desc(3435,"Alignment"),N=mstrmojo.desc(2886,"Borders"),E=mstrmojo.desc(3905,"Background"),R="-1,234.12",C="1,234.12",M="(1,234.12)",H="-$1,234.12",B="$1,234.12",J="($1,234.12)";var O=[{n:Q,v:"pru"}];I.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Bookshelf Symbol 1","Bookshelf Symbol 2","Bookshelf Symbol 3","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Open Sans SemiBold","Open Sans","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Wingdings 2","Wingdings 3"],function(S){O.push({n:S,v:S,symbolic:true});});function G(U,S,W){return(S&&S>=U)?G(U,S-W,W).concat(S):[];}var A=G(2,12,1);A=A.concat(G(14,24,2));A=A.concat(G(36,48,12));A=A.concat(G(72,72,1));var F=[{n:Q,v:"pru"}];I.forEach(A,function(S){F.push({n:String(S),v:String(S)});});mstrmojo._FormatDefinition={Formats:[{n:P},{n:K},{n:D},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:K},{n:D},{n:P},{n:N},{n:E}],MetricHeaderFormats:[{n:K},{n:D},{n:P},{n:N},{n:E},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0",TextBreak:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0",FillOpacity:"100"}},Families:O,Sizes:F,SizesInVI:F.slice(7,19),Styles:[{n:Q,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:Q,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:R,v:1,f:"#,##0.00"},{n:R,r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:C,r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:M,v:3,f:"#,##0.00;(#,##0.00)"},{n:M,r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:H,v:1,f:'"$"#,##0.00'},{n:H,r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:B,r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:J,v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:J,r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/16"),v:"m/d"},{n:mstrmojo.desc(2232,"04/16"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/16/20"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/16/20"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/16/2020"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(19695,"16/04/2020"),v:"dd/mm/yyyy"},{n:mstrmojo.desc(2236,"16-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"16-Apr-20"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-20"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '20"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 2020"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/16/20 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/16/20 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 16, 2020"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/16/20 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/16/20 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/16/20 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/16/20 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:Q,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:Q,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(15361,"Double"),v:6}],extractModel:function(W,Y,U){var a=U||this.DefaultFormat,Z;for(Z in W){var S=W[Z];if(!S.attachEventListener){if(!mstrmojo.hash.isEmpty(S)){Y[Z]=S;}}else{var X;for(X in S){if(a[Z]&&a[Z][X]){if(!Y[Z]){Y[Z]={};}Y[Z][X]=S[X];}}}}},getAvailableFonts:function L(){var S={success:function(W){if(W.name==="fontPicker"){var U=[{n:Q,v:"pru"}];I.forEach(W.shortcuts,function(Y){var Z=Y.attributes,a=I.filterOne(Z,function(b){return b.value;}),X=I.filterOne(Z,function(b){return b.symbolic;});U.push({n:a&&a.value,v:a&&a.value,symbolic:(X&&X.symbolic||"false").toUpperCase()==="TRUE"});});mstrmojo._FormatDefinition.Families=U;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,S,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(U,S){var X=mstrmojo.hash.clone(S||this.DefaultFormat),W;U=U||{};for(W in X){U[W]=U[W]||{};}for(W in U){if(!U[W].attachEventListener){U[W]=mstrmojo.hash.make(U[W],mstrmojo.Obj);}}return U;},saveFormatModel:function(Y,e,U,f){var d=f||this.DefaultFormat,a,S;for(a=0;a<U.length;a++){var Z=U[a],X=e[Z]||null,c=Y[Z];if(c===undefined){delete e[Z];continue;}for(S in d){var b=d[S],W;if((!X&&!c)||(X&&!X[S]&&!c[S])){continue;}for(W in b){if(c[S]===undefined||c[S]===""||c[S][W]==="pru"||c[S][W]===undefined){if(X&&X[S]&&(X[S][W]!==undefined&&X[S][W]!==null&&X[S][W]!=="pru")){X[S][W]="pru";}}else{X=X||{};X[S]=X[S]||{};X[S][W]=c[S][W];}}}if(X){e[Z]=X;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E="*",A=".",C="-",J="_",H="<";var M=new RegExp("[\\"+E+"\\"+A+"\\"+C+"\\"+J+"\\"+H+"]","g"),G=E+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function F(B){mstrmojo.array.forEach(B,function(D,K){B[K]=mstrmojo.Serializer.serializeValues(D);});return C+this.serializeValues(B)+J;},serializeValues:function I(D){var B=[];mstrmojo.array.forEach(D,function(K){if(typeof K==="Boolean"){K=K?"1":"0";}B.push(String(K).replace(M,G));});return B.join(A);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,this.getBuildConfig());if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},getBuildConfig:function B(){var I=this._super&&this._super();var H=this.buildConfig=(this.buildConfig||I||{});H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;},rebuildChildren:function C(J){var Q=this.children.slice(0),L=this.model,K=[],I,H=this,M=mstrApp.restoreVFKey,N,P;J=J||Q.slice(0);J.forEach(function(U){var R=G.indexOf(Q,U),S=U.k;if(R===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(U);U.destroy();K.push(S);},this);if(mstrApp.isInVFConfigMode&&(mstrApp.showBandingInVFConfigMode||mstrApp.showOutlineInVFConfigMode)&&!!J&&J.length===1&&!!J[0]&&J[0].k===M){delete mstrApp.showBandingInVFConfigMode;delete mstrApp.showOutlineInVFConfigMode;N=L.insertVizBox(M,H,{});L.selectVIUnit(N.id,true,{});I=[N];}else{P=L.getChildrenByKey(this.node,false,K);I=this.builder.build(P,L,this.getBuildConfig());var O={};G.forEach(J,function(R){O[R.k]=R.isNewUnitContainer;});G.forEach(I,function(R){R.isNewUnitContainer=O[R.k];});this.addChildren(I);}return I;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo,D=A.array;mstrmojo.vi.util.TemplateUtils=mstrmojo.provide("mstrmojo.vi.util.TemplateUtils",{getTemplateUnits:function B(G){if(D.isArray(G)){var F=[];D.forEach(G,function(H){F=F.concat(B(H));});return F;}var E=[].concat(G.mx||[]);(G.rows||[]).concat(G.cols||[]).forEach(function(H){if(H.did!=="-1"){E.push({did:H.did,t:H.t,n:H.n});}});return E;},findUnitsById:function C(H,F){var E=mstrmojo.vi.util.TemplateUtils.getTemplateUnits(H),G=[];D.ensureArray(F).forEach(function(K){var J=D.find(E,"did",K),I=J>-1?E[J]:null;if(I){G.push(I);}});return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=function(Y){var X=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return Y.k+"-"+X;},O={},K=mstrmojo.array;mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",{_mixinName:"mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",postBuildRendering:function J(){this._super();this.setup();this.initialHighlight();},initialHighlight:function B(){if(!this.getExp()){if(O[G(this)]){this.highlight.apply(this,O[G(this)]);}else{if(this.isVisMap){this.highlight("allLayers",this.genSelectionMapping(),true);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}}},getExp:function(){var X=this.model.data,Y=X&&X.sc&&X.sc.exp;return Y;},clearsBrushingOnHighlight:true,brushSub:null,clearSub:null,getAssociatedNodes:function W(){var X=this.defn&&this.defn.an;return X&&X.length>0?X:[];},hasAssociatedNodes:function M(){var X=this.getAssociatedNodes();return X.length>0;},getDocModelForEvent:function H(){return this.model&&this.model.docModel;},setup:function Q(){var X=this.getDocModelForEvent(),Y=this.id;if(X){[this.brushSub,this.clearSub].forEach(function(Z){if(Z){Z.clear();}});this.brushSub=X.attachEventListener("brushing",Y,this.onBrushing);this.clearSub=X.attachEventListener("clearBrush",Y,this.onClearBrushing);}},handlesMultiSelection:function F(){return(this._super&&this._super())||this.getAssociatedNodes().length>0;},getHighlightKeys:function P(){var Y=[],X=this.getAssociatedNodes();X.forEach(function(Z){Y.push(Z.k);});return Y;},onSelectionChange:function L(X){var Y=false;if(this._super){Y=this._super(X);}return this.clearHighlightForSelectionChange(Y);},onContextMenuSelectionChange:function I(X){var Y=false;if(this._super){Y=this._super(X);}return this.clearHighlightForSelectionChange(Y);},clearHighlightForSelectionChange:function U(Y){var X=this.getDocModelForEvent();if(this.clearsBrushingOnHighlight){X.raiseEvent({name:"clearBrush",from:this});}if(this.handlesMultiSelection()&&!Y){X.raiseEvent({name:"brushing",from:this,keys:this.getHighlightKeys()});return true;}return false;},onBrushing:function A(Y){var X=Y.keys.slice();var b=false,d=X.indexOf(this.k)!==-1;if(!d){var Z=this.getDocModelForEvent(),a=Z.getNodePath(this.k,Z.getLayoutKeyByUnitKey(this.k));b=X.filter(function(e){return a.indexOf(e)>-1;}).length>0;}if(d||b){if(this.highlight){var c=Y.from;this.highlight(c.getSelectionType(),c.getSelectionHash(),this.isVIXtab&&c.isVIXtab&&c.getSelectionType()==="att"&&this.model.hasRecursiveAttribute()&&c.model.hasRecursiveAttribute(),true);X.push(c.k);this.getDocModelForEvent().raiseEvent({name:"clearBrush",from:this,excludeKeys:X});}else{throw new Error(this.scriptClass+" must implement highlight method.");}}},onClearBrushing:function S(Y){var X=false;if(K.indexOf(Y.excludeKeys,this.k)===-1){if(this._super){X=this._super(Y);}if(!X){var Z=this.getAssociatedNodes();if(K.find(Z,"k",Y.from.k)!==-1){this.clearSelections(true);}}}return true;},highlight:function E(){O[G(this)]=arguments;if(this._super){this._super.apply(this,arguments);}},clearSelections:function C(){delete O[G(this)];if(this._super){this._super.apply(this,arguments);}},clearAllHighlightsCache:function(){O={};},clearCxtMnuSelection:function D(){if(this._super){this._super.apply(this);}},clearHighlightsCache:function R(){delete O[G(this)];},updateAssociatedNodesOnMove:function N(){this.clearSelections(true);this.endSelections();if(this.isLinkedFilter&&this.isLinkedFilter()){return ;}delete this.defn.an;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var F=mstrmojo.array,E={},A={},C={},G="72px",H="abcdefghijklmnopqrstuvwxyz0123456789";function B(K){return K.name+":"+(K.isItalic?"i":"n")+(K.isBold?"7":"4");}mstrmojo.util.FontLoader=mstrmojo.provide("mstrmojo.util.FontLoader",{load:function J(O,N,S){var Q=this,P=[],K;F.forEach(N,function(W){if(!Q.isFontInstalled(W)){K=B(W);if(!E[K]&&!A[K]){P.push(K);}}});if(!window.WebFont||P.length===0){return true;}var U=O,R;F.forEach(P,function(W){U=U+";"+W;});this.cancelLoadRequests(U,false);R={active:S.success,inactive:S.failure};C[U]=R;window.WebFont.load({custom:{families:P},fontactive:function(X,W){E[X+":"+W]=true;},fontinactive:function(X,W){A[X+":"+W]=true;},active:function M(){if(R.active){R.active();delete C[U];}},inactive:function L(){if(R.inactive){R.inactive();delete C[U];}}});return false;},cancelLoadRequests:function D(M,N){var L;if(N){var K;for(K in C){if(C.hasOwnProperty(K)&&K.indexOf(M)===0){L=C[K];L.active=null;L.inactive=null;delete C[K];}}}else{if(C.hasOwnProperty(M)){L=C[M];L.active=null;L.inactive=null;delete C[M];}}},isFontInstalled:function I(L){var M=document.createElement("canvas"),N=M.getContext("2d"),R=L.isItalic?"italic":"normal",K=L.isBold?"bold":"normal",P=R+" "+K+" "+G,Q,O;N.font=P+" monospace";Q=N.measureText(H).width;N.font=P+" '"+L.name+"', monospace";O=N.measureText(H).width;M=null;return Q!==O;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._BindTargetChildren=mstrmojo.provide("mstrmojo._BindTargetChildren",{target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function D(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=(I&&I.children)||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}this._ontargetChange();},_ontargetChange:mstrmojo.emptyFn,_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}this._postTargetAddChild();},_postTargetAddChild:mstrmojo.emptyFn,_onTargetRemoveChild:function B(G){var F=G&&G.value,H;for(H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}this._postTargetRemoveChild();},_postTargetRemoveChild:mstrmojo.emptyFn,_onTargetSelChg:function C(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?E.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?E.find(F,"target",N):-1;if(I>-1){J(F[I],true);}this._postTargetSelChg();},_postTargetSelChg:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums");var J=mstrmojo.gm,I=J.EnumGraphType,K=J.EnumDataLabels,A=J.EnumLegend,L=J.EnumMinSizeType,H=J.EnumFitTo,B=J.EnumContainerFitModes,D=J.EnumNGMGridLines,N=J.EnumSubtype;var M="Arial",F="Open Sans",E="ALL";var C={DEFAULT:"spatial",CLASSIC:"classic"};var O={THEME_STYLE:C.CLASSIC,LAYOUT:{allFF:M,titleFF:M,dlvPadding:2,dlvMargin:4,dlvLOH_Compensation:1,ucTBLOHeight:1,drpChildPadding:4,drpLOHW_Compensation:0,cueBottomOffset:1},GRID:{paddingSize:5,mRatio:2,lRatio:3,gridTemplateVisible:false},HEATMAP:{smallGap:2,middleGap:4,largeGap:6,largerGap:8},NGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={cntrFitMode:B.AUTOMATIC};return P;}())},OGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE,minRowHeight:20,fitTo:H.AUTOMATIC};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={};P[I.BAR]={shpBdrThk:1,shpBdrStyle:0};P[I.PIE]={shpBdrThk:1,shpBdrStyle:0};P[I.GRID]={shpFillTrans:70};return P;}())},KPI:{fontFamily:M,defaultFontClr:{1:"#444649",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}},G={THEME_STYLE:C.DEFAULT,LAYOUT:{allFF:F,titleFF:F,dlvPadding:0,dlvMargin:0,dlvLOH_Compensation:0,ucTBLOHeight:0,drpChildPadding:12,drpLOHW_Compensation:12,cueBottomOffset:-2},GRID:{paddingSize:4.52,mRatio:1050/452,lRatio:1205/452,gridTemplateVisible:true},HEATMAP:{smallGap:1,middleGap:3,largeGap:5,largerGap:5,cellTextSize:11,fontFamily:"Open Sans SemiBold",leftPadding:4,topPadding:4,lineHeightTime:1.3,marginTop:"3px"},NGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE};P[I.WATERFALL]={dataLabels:K.HIDE};return P;}()),DEFAULT_PROPS:(function(){var P={};P[E]={dlFntFml:F,rfLnFntFml:F,lgdFntFml:F,xAxTtFntFml:F,xAxLbFntFml:F,yAxTtFntFml:F,yAxLbFntFml:F,allTxtFntFml:F,rwHdrTxtFntFml:F,colHdrTxtFntFml:F,rwVlTxtFntFml:F,colVlTxtFntFml:F,ttlFntFml:F,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};P[I.WATERFALL]={yGridLnShw:D.AUTO,xGridLnShw:D.AUTO};return P;}())},OGM:{GENERAL_PROPS:(function(){var P={};P[E]={dataLabels:K.HIDE,minRowHeight:20};P[I.PIE]={legend:A.HIDE,legendShow:false,dataLabels:K.SHOW_TEXT_ONLY};P[I.SCATTER]={minSizeType:L.AUTO};return P;}()),DEFAULT_PROPS:(function(){var Q={};Q[E]={rwHdrShw:false,colHdrShw:false,dlFntFml:F,rfLnFntFml:F,lgdFntFml:F,xAxTtFntFml:F,xAxLbFntFml:F,yAxTtFntFml:F,yAxLbFntFml:F,allTxtFntFml:F,rwHdrTxtFntFml:F,colHdrTxtFntFml:F,rwVlTxtFntFml:F,colVlTxtFntFml:F,ttlFntFml:F,dlFntClr:3815477,rfLnFntClr:3815477,lgdFntClr:3815477,xAxTtFntClr:3815477,xAxLbFntClr:3815477,yAxTtFntClr:3815477,yAxLbFntClr:3815477,allTxtFntClr:3815477,rwHdrTxtFntClr:3815477,colHdrTxtFntClr:3815477,rwVlTxtFntClr:3815477,colVlTxtFntClr:3815477,ttlFntClr:3815477,yAxTtFntStyle:1,xAxTtFntStyle:1,rwHdrTxtFntStyle:1,colHdrTxtFntStyle:1,dlFntSz:"9pt",rfLnFntSz:"9pt",lgdFntSz:"9pt",xAxTtFntSz:"9pt",xAxLbFntSz:"9pt",yAxTtFntSz:"9pt",yAxLbFntSz:"9pt",allTxtFntSz:"9pt",rwHdrTxtFntSz:"9pt",colHdrTxtFntSz:"9pt",rwVlTxtFntSz:"9pt",colVlTxtFntSz:"9pt",ttlFntSz:"9pt"};Q[I.AREA]={shpBdrThk:1,shpBdrClr:15461355,};var P=Q[I.AREA];P["SUBTYPE_"+N.ABSOLUTE]={shpFillTrans:70};P["SUBTYPE_"+N.AUTO]={shpFillTrans:100};P["SUBTYPE_"+N.STACKED]={shpFillTrans:100};P["SUBTYPE_"+N.CLUSTERED]={shpFillTrans:100};P["SUBTYPE_"+N.PERCENT]={shpFillTrans:100};Q[I.BAR]={shpBdrClr:15461355,shpBdrStyle:0,shpBdrThk:1,shpFillTrans:100};Q[I.LINE]={shpFillTrans:100};Q[I.PIE]={shpBdrThk:1,shpBdrStyle:0,shpFillTrans:100,shpBdrClr:15461355};Q[I.SCATTER]={shpBdrStyle:99,shpFillTrans:40};Q[I.BUBBLE]={shpBdrStyle:99,shpFillTrans:40};Q[I.GRID]={shpBdrThk:1,shpFillTrans:100};return Q;}())},KPI:{fontFamily:F,defaultFontClr:{1:"#35383A",2:"#FFFFFF",3:"#FFFFFF",4:"#FFFFFF"}}};mstrmojo.vi.enums.EnumThemeProperties={CLASSIC_THEME_PROPS:O,DEFAULT_THEME_PROPS:G};mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE={GRID:"GRID",LAYOUT:"LAYOUT",HEATMAP:"HEATMAP"};mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME=C;mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE={DEFAULT:0,CARD:1,FLAT:2};mstrmojo.vi.enums.EnumThemeProperties.ENUM_SHADOW_STYLE={VISIBLE:0,HIDDEN:1};})();(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DI.DIConstants");mstrmojo.vi.util.DIUtils=mstrmojo.provide("mstrmojo.vi.util.DIUtils",{DIConstants:mstrmojo.DI.DIConstants,loadDIBundle:function C(){if(!mstrmojo.loader.isLoaded("mstrmojo.DI.DIContainer")){mstrmojo.requiresBundle("vi-di.js");}},createClass:function D(E){mstrmojo.vi.util.DIUtils.loadDIBundle();return mstrmojo.getInstance({scriptClass:E});},insertDIContainer:function B(){mstrmojo.vi.util.DIUtils.loadDIBundle();return mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});},DIHelpers:{standardizeDBRolesFormat:function A(E){mstrmojo.vi.util.DIUtils.loadDIBundle();return mstrmojo.DI.DIHelpers.standardizeDBRolesFormat(E);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumDSSDisplayMode");mstrmojo.requiresDescs(981);var B=mstrmojo.vi.viz;mstrmojo.vi.viz.KnownVisualizations={CUSTOM:-2,UNKNOWN:-1,GRID:0,ESRIMAP:2,GRAPHMATRIX:3,NEWGRAPHMATRIX:13,IMAGELAYOUT:4,HEATMAP:16,GOOGLEMAP:17,NETWORK:18,MAPBOX:19,KPICARD:20,getDefinition:function A(E){var F=B.KnownVisualizations,H={Grid:{id:F.GRID,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,title:mstrmojo.desc(981,"Grid")},visAjaxDatePicker:{id:1},ESRIMapVisualizationStyle:{id:F.ESRIMAP,mobileVIStyles:{IPhoneVisualization:"ViEsriMapAdapter",IPadVisualization:"ViEsriMapAdapter"}},GraphMatrixVisualizationStyle:{id:F.GRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},NewGraphMatrixVisualizationStyle:{id:F.NEWGRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},ImageLayoutVisualizationStyle:{id:F.IMAGELAYOUT,mobileVIStyles:{IPadVisualization:"IPhoneImageMapStyle",ATabletVisualization:"AndroidImageMapStyle"}},SurveyVisualizationStyle:{id:8,mobileVIStyles:{IPadVisualization:"SurveyVisualizationStyle"}},VIHeatMapVisualizationStyle:{id:F.HEATMAP,mobileVIStyles:{IPadVisualization:"IPadHeatMapStyle",ATabletVisualization:"HeatMapVisualizationStyle"}},GoogleMapVisualizationStyle:{id:F.GOOGLEMAP,mobileVIStyles:{IPhoneVisualization:"IPhoneMapStyle",IPadVisualization:"IPadMapStyle"}},MapboxVisualizationStyle:{id:F.MAPBOX,mobileVIStyles:{IPhoneVisualization:"IPhoneMapboxStyle",IPadVisualization:"IPhoneMapboxStyle"}},NetworkVisualizationStyle:{id:F.NETWORK,mobileVIStyles:{IPadVisualization:"IPhoneNetVizStyle"}},KPICardVisualizationStyle:{id:F.KPICARD,mobileVIStyles:{IPadVisualization:"IPhoneKPICardStyle"}}};var G=H[E];if(!G){var C=mstrConfig.pluginsVisList,D=C&&C[E];G={id:D?F.CUSTOM:F.UNKNOWN};G.mobileVIStyles=(D&&D.mobileVIStyles)||{};}return G;}};}());(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumDataType");var A={};var C=mstrmojo.mstr.EnumDataType;mstrmojo.NumberFormat={applicableDT:[C.DataTypeReserved,C.DataTypeInteger,C.DataTypeUnsigned,C.DataTypeNumeric,C.DataTypeDecimal,C.DataTypeReal,C.DataTypeDouble,C.DataTypeFloat,C.DataTypeBinary,C.DataTypeVarBin,C.DataTypeLongVarBin,C.DataTypeDate,C.DataTypeTime,C.DataTypeTimeStamp,C.DataTypeShort,C.DataTypeLong,C.DataTypeBigDecimal,C.DataTypeCellFormatData,C.DataTypeInt64],isNumberFormatDT:function D(E){return E===undefined||E===null||this.applicableDT.indexOf(E)!==-1;},getInstance:function B(H,I){var G=H+"--"+I;if(G in A){return A[G];}var E={parse:function(J){},format:function(J){}};if(H==="."&&I===","){E.parse=function(J){if(!J){return NaN;}var K=J.replace(/,/g,"");return Number(K);};E.format=function(J){return Number(J).toString();};}else{var F=new RegExp("\\"+I,"g");E.parse=function(K){if(!K){return NaN;}var J=K.replace(F,"").replace(H,".");return Number(J);};E.format=function(K){var J=Number(K).toString();return J.replace(".",H);};}A[G]=E;return E;},parse:function(G,F,H){if(!G){return NaN;}F=F||mstrConfig.decimalSep;H=H||mstrConfig.thousandsSep;if(F==="."&&H===","){return Number(G.replace(/,/g,""));}else{var E=G.replace(new RegExp("\\"+H,"g"),"").replace(F,".");return Number(E);}},format:function(H,F,G){F=F||mstrConfig.decimalSep;G=G||mstrConfig.thousandsSep;if(F==="."&&G===","){return Number(H).toString();}else{var E=Number(H).toString();return E.replace(".",F);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;this.missingTitles=this.titles&&this.headers?(this.headers.length-this.titles.length):0;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&this.missingTitles){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var D=mstrmojo.dom;var G=mstrmojo.array;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function F(I){if(I){return{w:I.innerWidth,h:I.innerHeight};}var H=D.windowDim(),J=(D.isFF||D.isWK)?0:2;return{w:Math.max(H.w,0)+"px",h:Math.max(H.h-J,0)+"px"};},preBuildRendering:function B(){var J=this._super(),I=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(I)!==true){this.height=I.h;this.width=I.w;}if(!this._listenerProc){var L=this.id,K=null,H=this._listenerProc=function(N){if(mstrApp&&mstrApp.isExporting){var M=N||window.event;mstrmojo.all[L].monitorWindow(M);}else{window.clearTimeout(K);K=window.setTimeout(function(){var O=N||window.event;mstrmojo.all[L].monitorWindow(O);},150);}};D.attachEvent(window,"resize",H);}return J;},destroy:function C(H){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(H);},getResizeDimensions:function A(H){var K=H.currentTarget,J=this.getBrowserDimensions(),I={w:(K?K.innerWidth+"px":J.w),h:(K?K.innerHeight+"px":J.h)};return I;},monitorWindow:function E(I){var J=this.getResizeDimensions(I);var H=["iframe","video"],N=[],M=false,L=this,K=document.fullscreenElement;if(K){G.forEach(H,function(O){N=N.concat([].slice.call(L.domNode.getElementsByTagName(O)));});G.forEach(N,function(O){if(O===K){M=true;return false;}});}if((J.h===this.height&&J.w===this.width)||parseInt(J.h,10)<=20||parseInt(J.w,10)<=20||M){return ;}if(!this.browserResized||this.browserResized(J,true)!==true){if(J.h!==this.height){this.set("height",J.h);}if(J.w!==this.width){this.set("width",J.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],U=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){U.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(U);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var I=this.ifDataHelper,H=this,G=this.scrollNode||this.domNode;this.supportsIncFetch=I&&I.hasNext();if(I&&this.supportsIncFetch){this._scroll=function F(){var J=this.scrollNode||this.domNode||G;if(Math.ceil(J.offsetHeight+J.scrollTop)>=J.scrollHeight){H.raiseEvent({name:"incFetch",id:H.id});}};E.attachEvent(G,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(J){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);I.next({complete:function(K){if(H.postNext){H.postNext();}H.set("isFetching",false);},success:function(K){H.addItems(K.items||null);},failure:function(K){H.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+K);}});});}},unrender:function D(F){var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);this._super(F);},render:function C(){this._super();if(this.supportsIncFetch){var F=this.scrollNode||this.domNode;E.attachEvent(F,"scroll",this._scroll);}},addItems:function B(F){if(this._super){this._super(F);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var G=this.scrollNode||this.domNode;E.detachEvent(G,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom;var Y="touchstart",K="mousedown",Q=G.isIOSTouch,D=G.isTouchOptimizationEnabled(),U=(Q||D)?Y:K;function Z(b){var a=b[b.hotSlot||"domNode"];if(a){if(!b._closeCallback){var d=b.id,c=function(e){return function(g){var f=mstrmojo.all[d];if(f&&!f.ignoreHover){f["auto"+e](g,self);}};};b._uncloseCallback=c("Unclose");b._closeCallback=c("Close");}G.attachEvent(a,"mouseover",b._uncloseCallback);G.attachEvent(a,"mouseout",b._closeCallback);}}function C(b){if(b._closeCallback){var a=b[b.hotSlot||"domNode"];if(a){G.detachEvent(a,"mouseover",b._uncloseCallback);G.detachEvent(a,"mouseout",b._closeCallback);}}}function H(d,b){var a=d,c;while(a){if(a.open||a.openPopup){c=a.ignoreHoverCount||0;c=b?(c+1):(c>0?c-1:c);a.ignoreHoverCount=c;if(a.set){a.set("ignoreHover",(c>0));}else{a.ignoreHover=(c>0);}}a=a.opener||a.parent;if(a&&a.shouldPropagateLockHover&&!a.shouldPropagateLockHover()){break;}}}function F(){var c=this._lockHoverCallback,b=this.curtainNode,e=this._onClickChange;if(c){G.detachEvent(document.body,U,c,true);delete this._lockHoverCallback;}if(!b||!e){return ;}var a=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||Q,d=a?Y:K;G.detachEvent(b,d,e);delete this._onClickChange;}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function W(){this._super();if(this.autoCloses){Z(this);}this.oncloseOnClickChange();},onautoClosesChange:function O(){var a=(this.autoCloses)?Z:C;a(this);},oncloseOnClickChange:function J(){if(!this.curtainNode){return ;}var c=this,a=mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp()||Q,b=a?Y:K;this._onClickChange=function(){c.close();if(a){mstrmojo.touchManager.notify([]);}};G.attachEvent(c.curtainNode,b,this._onClickChange);},autoUnclose:function I(){var a=this._autoCloseTimer;if(a){self.clearTimeout(a);delete this._autoCloseTimer;}},autoClose:function M(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var a=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[a].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function X(a){F.call(this);this._super(a);},lockHover:function S(){H(this,true);if(!this._lockHoverCallback){var b=this.id,a=this._lockHoverCallback=function(c){mstrmojo.all[b]._unlockHoverCheck(c,self);};if((G.isIE7||G.isIE8)&&window.event&&(window.event.type===U)&&this.opener){this.opener._ignoreMousedown=true;}G.attachEvent(document.body,U,a,true);}},unlockHover:function P(){H(this,false);F.call(this);},hoverLock:function(a){H(this,a);},suppressClose:function B(a){return G.contains(this.domNode,a,true,document.body);},_unlockHoverCheck:function E(d,a){var b=this.opener;if(b&&b._ignoreMousedown){delete b._ignoreMousedown;return ;}var c=G.eventTarget(a,d);if(!this.suppressClose(c)){if(this.isWithinParentWidget(c)){return ;}if(b&&b.onPopupAutoClosed){b.onPopupAutoClosed(d,a);}this.close(c);}},isWithinParentWidget:function R(b){var a=G.findWidget(b);while(a){if(a===this){return true;}a=a.parent||a.opener;}return false;},open:function L(b,a){if(this.autoCloses){this.autoUnclose();}this._super(b,a);if(this.locksHover){this.lockHover();}},close:function N(a){if(this.locksHover){this.unlockHover();}this._super(a);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var F=mstrmojo.dom;function H(K){return(K&&K.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function G(M,L){var K=this.scrollboxNode;K.scrollLeft=M.x;K.scrollTop=M.y;if(L){this.notifyScrollListeners(M);}},connectScrollbox:function E(L){if(!H(L)){return ;}var M=this.scrollListeners,K=L.id;if(!M){M={};this.scrollListeners=M;}if(!M[K]){M[K]=L;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(L){if(!H(L)){return ;}var M=this.scrollListeners,K=L.id;if(M&&M.hasOwnProperty(K)){delete this.scrollListeners[K];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(N){var Q=N||this.getScrollPos(),P=Q.y,O=Q.x,K=P-this.scrollboxTop,M=O-this.scrollboxLeft;this.scrollboxTop=P;this.scrollboxLeft=O;this.scrollboxRight=O+this.scrollboxWidth;this.scrollboxBottom=P+this.scrollboxHeight;var L=this.scrollListeners,R;for(R in L){L[R].onscroll(this,{deltaX:M,deltaY:K});}},getScrollPos:function I(){var K=this.scrollboxNode;return{x:K.scrollLeft,y:K.scrollTop};},_attachScrollDom:function A(){var P=this.scrollboxNode;if(P){var O=this.usesTouches;if(!O){if(!this.scrollCallback){var N=this.id;this.scrollCallback=function(){mstrmojo.all[N].notifyScrollListeners();};}var K=false,L=this.scrollCallback;if(F.isSafari){this.wheelCallback=function(){L();K=true;};this.scrollCallback=function(){if(K){K=false;return ;}L();};F.attachBufferedEvent(P,"wheel",this.wheelCallback,this.scrollInterval);}F.attachBufferedEvent(P,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=O?0:P.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=O?0:P.scrollLeft;}var M=function(S){var R=S.toLowerCase();var Q=P.style[R];return(!isNaN(Q)&&Q.charAt(Q.length-1)!=="%")?parseInt(Q,10):P["client"+S];};if(this.scrollboxHeight===null){this.scrollboxHeight=M("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=M("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=P;}},_detachScrollDom:function J(){var K=this._attachedScrollbox;if(K&&this.scrollCallback){if(F.isSafari){F.detachBufferedEvent(K,"wheel",this.wheelCallback,this.scrollInterval);}F.detachBufferedEvent(K,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(Y){mstrmojo.hash.copy(Y,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var Y=this;this.delayTimer=window.setTimeout(function(){Y._start();Y=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function W(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var Y=this.ease;if(typeof Y==="string"){this.ease=mstrmojo.registry.ref(Y);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var Z=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function a(){if(Z){Z.exec();Z.counter++;if(Z.counter>=Z.steps){Z._end();Z=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function U(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var Z=this.target;if(Z&&this.slot&&Z.scriptClass){var a=Z[this.slot];if(a){this.widget=Z;this.target=a;}}}}}if(!this.target){var Y=this;while(Y=Y.parent){if(!Y||Y.domNode){break;}}if(Y){this.widget=Y;this.target=Y[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(b,c){var Z=b.children,Y=(Z&&Z.length)||0,a;for(a=0;a<Y;a++){Z[a][c]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(b){this._super(b);var a=this.children;mstrmojo.registry.refArray(a);var Y=(a&&a.length)||0,Z;for(Z=0;Z<Y;Z++){a[Z].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function W(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var a=this.props,b;for(b in a){var Z=a[b],Y=Z.ease;if(typeof Y==="string"){Z.ease=mstrmojo.registry.ref(Y,{dontInst:true});}}this._super();},exec:function P(){var b=this.props,c;for(c in b){var Z=b[c],Y=(Z.ease||mstrmojo.ease.sin)(this.counter,Z.start,Z.stop-Z.start,this.steps-1);if(Z.fn){Y=Z.fn(Y);}if(Z.suffix){Y+=Z.suffix;}var a=Z.isStyle===false?this.target:this.target.style;a[c]=Y;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var c=this.srcProp,a;if(c){var Y=this.widget||this.parent;a=Y&&Y[c];if((a!=null)&&(typeof (a)!=="string")){a=String(a);}}this.stop=a;this._dynStop=true;}if(this.stop==null){this.stop="";}var b=this.target,d=null,Z=1;if(b){b.innerHTML="";d=document.createTextNode("");b.appendChild(d);Z=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=d;this.charGroupSize=Z;},exec:function(){var Z=this.targetTextNode;if(!Z){return ;}var Y;if(this.counter>=this.steps-1){Y=this.stop;}else{if(this.counter===0){Y="";}else{Y=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}Z.nodeValue=Y;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function W(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(Y){if(Y==null){Y=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(Y*100,10)+")";}else{this.target.style.opacity=Y;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function W(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function X(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(a,Z,b){var Y=Math.pow(10,b||2);if(Z){return parseInt(Y*a/Z,10)/Y;}return parseInt(Y*a,10)/Y;}mstrmojo.ease={linear:function L(Z,Y,e,a){if(Z===a){return Y+e;}if(Z===0){return Y;}return Y+e*I(Z,a);},sin:function A(Z,Y,e,a){return Y+e*Math.sin((Math.PI/2)*Z/a);},cos:function B(Z,Y,e,a){return Y+e*Math.cos((Math.PI/2)*(1-Z/a));},sincos:function K(Z,Y,e,a){if(Z>a/2){return Y+e*Math.cos((Math.PI/2)*(1-Z/a));}return Y+e*Math.sin((Math.PI/2)*Z/a);},cossin:function Q(Z,Y,e,a){if(Z>a/2){return Y+e*Math.sin((Math.PI/2)*Z/a);}return Y+e*Math.cos((Math.PI/2)*(1-Z/a));},bounce:function G(Z,Y,e,a){if((Z/=a)<(1/2.75)){return e*(7.5625*Z*Z)+Y;}if(Z<(2/2.75)){return e*(7.5625*(Z-=(1.5/2.75))*Z+0.75)+Y;}if(Z<(2.5/2.75)){return e*(7.5625*(Z-=(2.25/2.75))*Z+0.9375)+Y;}return e*(7.5625*(Z-=(2.625/2.75))*Z+0.984375)+Y;},shake:function J(Z,Y,e,a){if(Z<a/2){return Y+e*I(Math.sin(2*Math.PI*Z/8),null,2)*2*Z/a;}return Y+e*I(Math.sin(2*Math.PI*Z/8),null,2)*2*(1-Z/a);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo._XtabModelShared","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.models.datasets.DataInterface");var R=mstrmojo.array,X=mstrmojo.hash,D=mstrmojo.string,f=mstrmojo.elementHelper,U=mstrmojo._XtabModelShared,d=mstrmojo.models.datasets.DataInterface;var b=1,Y=2,E=0,e=2;var M="Metrics";function Q(j,k){var l=this.getDataService();l[j].apply(l,k);}function W(t,AA,s){var w=AA||f.getIdPresentation(t),AB,k;switch(w){case"terse":case"terseLong":t=t.replace(/\\;/g,"*ESCAPESEMICOLON*");AB=t.split(";");return(AB[0]+";"+AB[1]+(s?";"+s:"")).replace(/\*ESCAPESEMICOLON\*/g,"\\;");case"old":var m="",p=2;t=t.replace(/\*:/g,"*COLON*").replace(/\\/g,"\\\\").replace(/;/g,"\\;");AB=t.split(":");while(AB[p]){m+=":"+AB[p];p++;}return("h"+AB[1]+m+";"+AB[0]+(s?";"+s:"")).replace(/\*COLON\*/g,"\\:");case"oldLong":var l=0,z,q,u=[],AC=[],y,x,o,n=function(){if(l<0){return null;}var AF=false,j=-1,AG,AE=null;for(y=l;y<t.length;y++){AG=t.charAt(y);if(AG==="*"&&!AF){AF=true;}else{if(AG===":"&&!AF){j=y;break;}else{AF=false;}}}if(j===-1){AE=t.substring(l);l=-1;}else{AE=t.substring(l,j);l=j+1;}return AE;};o=n();if(o!=="BB"&&o!=="BF"){return t;}k=n();if(o==="BF"){k=n();}z=parseInt(n(),10);q=parseInt(n(),10);for(x=0;x<q;x++){AC[x]=parseInt(n(),10);n();}for(x=0;x<q;x++){var AD=n();if(AC[x]<z&&AC[x]>=0){u[AC[x]]=AD.replace(/\\/g,"\\\\").replace(/\*:/g,"\\:").replace(/;/g,"\\;");}}return"h"+u.join(":")+";"+k+(s?";"+s:"");}return t;}mstrmojo._DocXtabModelShared=mstrmojo.provide("mstrmojo._DocXtabModelShared",X.copy({mixinName:"mstrmojo._DocXtabModelShared",getDataService:function O(){return this.docModel.getDataService();},getNormalizedFormElementId:function I(k,j){return W(k,null,j);},getRenameTemplateUnitAction:function g(n,l,j,k){var m={act:"renameUnit",id:n,type:l,name:j};if(k){m.isDynamicAlias=true;}return m;},getRemoveTemplateUnitAction:function N(j){return{act:"removeUnit",unitId:j.did||j.id,unitType:j.t||4,is_disableonly:1};},getAdvSortData:function C(j,k){Q.call(this,"getAdvSortData",[j,k]);},getSelectorControlMapInfo:function H(){var k=[],m=this.data.gsi,l=[],j;if(this.scm){X.forEach(m,function(n){if(n instanceof Array){l=l.concat(n);}});X.forEach(this.scm,function(o,n){j=R.find(l,"did",n);if(j!==-1){k.push({did:n,n:l[j].n,sc:o});}});}return k;},compareElementsId:function G(n,m){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(n,m);}var l=f.getIdPresentation(n),k=f.getIdPresentation(m),j=W(n,l),o=W(m,k);return this.compareNormalizedElementsId(j,o);},compareNormalizedElementsId:function K(k,j){if(k===j){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(f.isAttributeIdsLinked(f.getAttributeId(k),f.getAttributeId(j),this.docModel.als&&this.docModel.als.idLinks||{})){return f.getElementValue(k)===f.getElementValue(j);}}return false;},compareElementsIdInSingleGrid:function L(m,l){var k=f.getIdPresentation(m),j=f.getIdPresentation(l);if(k!==j||k==="oldLong"||k==="terseLong"){return W(m,k)===W(l,j);}return m===l;},getFullObjectInfo:function i(j){return d.getObjectInfoFromDataset(j,this.docModel.datasets);},getNDEFormsFromDataset:function P(k){var j=this.getFullObjectInfo(k);return j&&j.fs;},getShowTotalsUnitAction:function S(m,k,l,j){return{act:"showTotals",unitId:String(m||""),unitType:k||"",subtotalType:l,clearSubtotalType:j};},getMoveSubTotalAction:function c(l,m,n,s){var y=mstrmojo.models.template.DataInterface,t=y.getGSI(this.xtab.gridInfo,n),w=(t&&t.sorts)||[],k=l&&l.axis,p=this,o;function j(AB,AC){var AE=[];if(AC.length>=AB){if(s){AE=AB===b?AC[Y-1]:AC[b-1];}else{AE=AC[AB-1];}}function AA(AF){return !!(AF&&AF.length&&AF[0].key&&!p.hasDummySortKey(AF[0].key));}var z=AA(AE),AD;if(z){AD=p.convertCurrentSortsIntoActionSorts(AC);if(s){AD.forEach(function(AG,AF){(AG||[]).forEach(function(AI){var AH=AI.key;if(AH){if(AH.indexOf("!!1")>=0){AI.key=AH.replace(/!!1/g,"!!2");}else{AI.key=AH.replace(/!!2/g,"!!1");}}});});AD=AD.reverse();}}return z?AD:[];}function q(AB,AC){if(!AC||AC.length<AB){return false;}var z=AC[AB-1];if(!z||z.length!==1){return false;}var AD="!5",AA=z[0].key;return AA&&AA.slice(-2)===AD;}function u(AC,z,AB,AA,AD){return{act:"moveSubTotal",nodeKey:AC,sorts:z,subTotalsPos:AB,stt:AD||-1,axis:AA};}function x(){var AB=this.data,AA=AB&&AB.gts,AF=AA&&AA.rowSubPos||E,z=AA&&AA.colSubPos||E,AE=[AF,z];if((!k||k===b)&&AF===E){var AD=AA&&AA.row||[],AC=false;R.forEach(AD,function(AG){if(AG.ast&&AG.ast.length>0){AC=true;return false;}});if(!AC||AB&&AB.gsi&&AB.gsi.hidesb){AE[b-1]=e;o=j(b,w);return u(n,o,AE,b);}}return null;}if(!m){return x.call(this);}else{o=j(k,w);return u(n,o,m,k,q(k,o)&&l.hst?l.hst:-1);}},getTotalsAction:function h(j,m,k){var l=this.getPivotAction(j);l.act="showTotals";l.subtotalType=m;l.clearSubtotalType=k;return l;},getRemoveAxisTotalsAction:function J(k,j){return{act:"removeAxisTotals",axis:j,subtotalType:k};},getShowDefinedSubtotalsAction:function B(){return{act:"showDefinedSubtotals"};},getUpdateGridPropsAction:function a(j){return{act:"setProperty",nodeKey:this.xtab.k,prs:"Visualization",pri:13,v:D.encodeXMLAttribute(JSON.stringify(j))};},getColumnResizeAction:function A(m,j,k,l,n){return{act:"changeXtabColumnWidth",unitId:m,unitType:j,width:k||0,depth:l||1,ec:n};},getSortGridAction:function Z(n,k,l,j,m){return X.copy(m,{sortKey:k,subTotalsPos:n,axis:l,isAsc:j});},getCellDataUnion:function F(t,k){var m=this,p=this.allowMetricHeaderSelection,j=t.isObjHeader,u=t.hasOwnProperty("mix"),l=[],s,o=X.walk("data.ghs.chs.show",this),n=function n(x){var w=m.getCellTitleInfo(x),AA=w.title,z=AA&&AA.id,y=AA&&AA.n;if(z||(j&&p&&y===M)){s={};if(x.stt){s.isSubtotal=true;}if(!k||k.indexOf(z)<0){l.push(X.copy(s,{tid:z,eid:x._e&&x._e.id,v:x.v||(x._e&&x._e.n)}));}}},q=function q(y){var w=m.getCellTitleInfo(y),z=w.title,x=X.walk("data.gts.col",m);return R.indexOf(x,z)>=0;};if(t){if(!u||(j&&p)){n(t);}else{R.forEach([t._lp,t._tp],function(w){var x=w;while(x&&x!==x._p){n(x);if(!x._p&&q(x)&&typeof o!=="undefined"&&!o){x=m.getPCellParentNodeByPI(x);}else{x=x._p;}}});}}return l;},},X.copy(U)));})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(U,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var W=G(U,Q[R]);if(!W){continue;}S.push(W);L(U,W);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var U=R[Q];if(U&&U.destroy){U.destroy(S);if(!S){N(this,U);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(W,Q,R){if(!W){return W;}var U=W.constructor===Array,P=A(this,U?W:[W]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return U?P:(P&&P[0]);},removeChildren:function J(X,R){var U=this.children,W=X?[X]:(this.children||[]).concat(),Q=W.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,W[S]);}if(X){P=K.removeItem(U,X);}else{if(U){U.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:W,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var P=mstrmojo.string,N=mstrmojo.hash,G=mstrmojo.dom;var W=mstrmojo.usesFrames?null:document.createElement("span");var M=/mstrAttach:([\w,]+)/g,O="mstrevent";var U;function Z(f,g){if(U===undefined){U=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return f.replace(M,function e(m,o){var j=o.split(","),k=[],h=j.length,l;for(l=0;l<h;l++){var n=j[l];if(n){if(U){if(n.indexOf("mouse")>-1){continue;}else{if(n==="click"){n="touchend";}}}k.push("on"+n+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+n+"', self, event)\"");}}return k.join(" ");});}function A(f){if(U===undefined){U=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}var g;g=f.replace(M,function e(m,o){var j=o.split(","),h=j.length,k=[],l;for(l=0;l<h;l++){var n=j[l];if(n){if(U){if(n.indexOf("mouse")>-1){continue;}else{if(n==="click"){n="touchend";}}}k.push(n);}}return O+'="'+k.join(" ")+'"';});return g;}function D(h,l){var e=h.getAttribute&&h.getAttribute(O),f;if(e){var k=e.split(" ");for(f=0;f<k.length;f++){var m=k[f],j="on"+m;if(h.hasAttribute(j)){G.singleReplaceInlineEventListeners(h,m);}else{G.attachEvent(h,m,function(i){G.captureDomEvent(this.curWidgetId,this.evtName,self,i);}.bind({curWidgetId:l,evtName:m}));}}h.removeAttribute(O);}if(h.hasChildNodes()){var g=h.childNodes;for(f=0;f<g.length;f++){D(g[f],l);}}}var Q="preBuildRendering",E="buildRendering",C="postBuildRendering";function c(g){var j=G.isCSPEnabled();var f=g.markupString;if(f.match(/mstrAttach:/)){f=j?A(f):Z(f,g);if(g.markupString===g.constructor.prototype.markupString){g.constructor.prototype.markupString=f;}}var e=P.apply(f,g);if(e){if(e.indexOf(j?"contextmenu":"oncontextmenu")>-1){g.hasContextMenuEvent=true;}if(mstrmojo.usesFrames){var h=(g.domNode&&g.domNode.ownerDocument)||window.document;if(!W||W.ownerDocument!==h){W=h.createElement("span");}}W.innerHTML=e;var i=W.removeChild(W.firstChild);i.mstrmojoId=g.id;if(j){D(i,g.id);}return i;}return null;}function B(g){var f=g.markupSlots,e,h;if(f){e={};for(h in f){e[h]=typeof f[h]==="string"?g.domNode.querySelector(f[h]):f[h].call(g);}}return e;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function d(){if((this[Q]&&this[Q]()===false)||(this[E]()===false)||(this[C]&&this[C]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var e="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,e)){this.raiseEvent({name:e});}return true;},buildDom:function Y(){return c(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function H(){var e=this.domNode,f=this.buildDom();this.domNode=f;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(B(this));this.paint();if(f){var i=e;if(!i){i=this.placeholder;if(i){if(typeof i==="string"){i=document.getElementById(i);}delete this.placeholder;}}if(i){G.replace(i,f);}}var g="onchildRenderingChange",h=this.parent;if(h&&h[g]){h[g](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function X(g){if(this.hasRendered){if(!g){try{var e=this.domNode;if(e.parentNode){e.parentNode.removeChild(e);}}catch(f){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function L(){var f=this.markupMethods;if(!f){return ;}var j=this,k=function(o){var m=f[o];if(m){try{m.apply(j,[true]);}catch(i){throw new Error(["Error in markup method.","Script class: "+j.scriptClass,"Widget id: "+j.id,"Method name: "+o,"Err: "+i.message].join("\n\n"));}}};var h=f.sequence,e,g,l;if(h){e=h.length||0;for(g=0;g<e;g++){k(h[g]);}}else{for(l in f){k(l);}}},redraw:function S(){return false;},refresh:function F(e){if(this.hasRendered){if(this.redraw()!==true){var f=this.domNode;this.unrender(true);this.placeholder=f;if(e){e();}this.render();}}},set:function K(i,e){this._super(i,e);if(this.domNode){var g=this.markupMethods,h=g&&g["on"+i+"Change"];if(h){h.apply(this);}}return this;},slotNames:null,addSlots:function I(f){var e=this.slotNames,g;if(!e){e={};this.slotNames=e;}for(g in f){this[g]=f[g];e[g]=true;}},removeSlots:function J(e){if(e){var f=this.slotNames,g;for(g in e){delete this[g];if(f){delete f[g];}}}},captureDomEvent:function b(h,f,i,g){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(h,f,i||f.event,g));}},playEffect:function a(f){var e=this[f];if(e&&e.constructor===Object){e=mstrmojo.insert(mstrmojo.hash.clone(e));e.widget=this;this[f]=e;}if(e){e.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function R(f,e){f.prototype.markupMethods=N.copy(e,N.copy(f.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(h,e,g,f){return{name:h,hWin:e,e:g,config:f,ctrlKey:G.ctrlKey(e,g),shiftKey:G.shiftKey(e,g),metaKey:G.isMetaKey(e,g),cancel:function(){G.stopPropogation(e,g);},preventDefault:function(){G.preventDefault(e,g);},getTarget:function(){return G.eventTarget(e,g);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash","mstrmojo.string","mstrmojo.dom");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function checkToAddRequestHeadersForXhr(xhr,params){var headers=params.xhrHeaders;if(headers){for(var hdr in headers){xhr.setRequestHeader(hdr,headers[hdr]);}delete params.xhrHeaders;}}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||mstrConfig.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var hasUserDefinedMimeType=params.hasUserDefinedMimeType;delete params.hasUserDefinedMimeType;var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);if(hasUserDefinedMimeType){xhr.overrideMimeType("text/plain; charset=x-user-defined");}checkToAddRequestHeadersForXhr(xhr,params);if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){var res=new XMLHttpRequest();var foo=res.open;res.open=function(){foo.apply(res,arguments);};return res;},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{try{rtn=JSON.parse(rt);}catch(ex){rtn=eval("("+rt+")");}}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877,CSRF_ERROR=4098;function isSessionExpiredError(res){if(res.status===401){return true;}var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function isCSRFError(res){var c=(res&&res.getResponseHeader("X-MSTR-TaskErrorCode"))||"0";c=parseInt(c,10);if(c===CSRF_ERROR){return true;}return false;}function xhrSupportsProgress(xhr){return !mstrmojo.dom.isSafari&&!!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response,xhr);}}else{if(xhr.status!==0||(!xhr.isAborted&&prevRequest.params.displayNoResErr)){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(isCSRFError(xhr)&&mstrConfig&&mstrConfig.validateRandNum){var url=window.location.href;var pos=url.indexOf("?");if(pos>0){url=url.substring(0,pos);}url+="?pg=CSRFConfirmation";window.location.href=url;}if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;var async=!!(config&&config.async);xhr.open("POST",url,async);var appReqHeaders=typeof (mstrConfig)!==undefined&&mstrConfig.requestHeaders;if(appReqHeaders){for(var key in appReqHeaders){xhr.setRequestHeader(key,appReqHeaders[key]);}}checkToAddRequestHeadersForXhr(xhr,params);if(config&&config.authToken){xhr.setRequestHeader("X-MSTR-AuthToken",config.authToken);if("projectId" in params){xhr.setRequestHeader("X-MSTR-ProjectId",params.projectId);}}var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append(params.fileFieldName?params.fileFieldName:"myFile",data,params.fileName);}else{formData.append(params.fileFieldName?params.fileFieldName:"myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"||req.params.taskId==="arch.sparkFileUpload"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var A=mstrmojo.string;mstrmojo.vi.ui._IsValidURL=mstrmojo.provide("mstrmojo.vi.ui._IsValidURL",{_mixinName:"mstrmojo.vi.ui._IsValidURL",isValidURL:function B(C){var D=!!C&&C.toLowerCase();return !!D&&(D.indexOf("javascript:")===-1)&&(!mstrApp.isSingleTier||A.startsWith(D,"http://")||A.startsWith(D,"https://"));}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var N=mstrmojo.locales,J=mstrmojo.string,Q=window.mstrConfig,G=mstrmojo.array,D=Q.units,S={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},B={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},F={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var H=96;String.prototype.reverse=function(){var X="",W;for(W=this.length;W>0;--W){X+=this.charAt(W-1);}return X;};function L(W,Y){W=W||"";Y=Y||W.match(/\".+?\"/g)||[];for(var X=0;X<Y.length;X++){W=W.replace(Y[X],Y[X].substring(1,Y[X].length-1).replace(/\$/g,"$$$$"));}return W;}function U(b){var W=86400000,a=new Date(1900,0,1,0,0,0,0),X=Math.floor(b)-1,Z=b-X-1;if(b>=59){X--;}var Y=new Date(a.getTime()+(X*W));Y.setTime(Y.getTime()+Z*W+500);return Y;}function I(a,h,j){var b={"d+":a.getDate(),"h+|H":a.getHours(),"s+":a.getSeconds()},W=N.datetime,c;if(/(y+)/.test(h)){var Z=a.getFullYear().toString(),g=RegExp.$1,Y=g.length===2,X=Z.length;h=h.replace(g,Z.substr(Y?X-2:0,Y?2:X));}if(/(^\[h\])/.test(h)&&j){h=h.replace(RegExp.$1,""+(Math.floor(j*24)));}if(/(\"?:\"?mm)/.test(h)){var d=a.getMinutes();h=h.replace(RegExp.$1,":"+(RegExp.$1.length===1?d:("00"+d).substr(d.toString().length)));}if(/(AM\/PM)/.test(h)){var i=b["h+"],e=i>11;b["h+"]=i-(e?12:0);h=h.replace(RegExp.$1,e?"PM":"AM");}for(c in b){if(new RegExp("("+c+")").test(h)){h=h.replace(RegExp.$1,RegExp.$1.length===1?b[c]:("00"+b[c]).substr((b[c].toString()).length));}}if(/(mmmm)/.test(h)){h=h.replace(RegExp.$1,W.MONTHNAME_FULL[a.getMonth()]);}else{if(/(mmm)/.test(h)){h=h.replace(RegExp.$1,W.MONTHNAME_SHORT[a.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(h)){var f=(a.getMonth()+1).toString();h=h.replace(RegExp.$1,RegExp.$1.length===1?f:("00"+f).substr(f.length));}}}return L(h);}function O(X,a){var Y=0,W=a.length,Z=0;for(;Y<W;Y++){if(a[Y]==="0"){Z++;}else{if(a[Y]==="#"){if(Z<X){Z++;}}else{continue;}}}return Z;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function E(W){var Z=this.getThousand(),Y=new RegExp("^(-)?[0-9]{1,3}(\\"+Z+"[0-9]{3})*$"),X=new RegExp("^(-)?[0-9]+$");return(String(W).indexOf(Z)&&Y.test(W))||X.test(W);},isNumeric:function P(b,c){var a=this.getDecimal(),d=this.getThousand(),Z=c?"%?":"",Y=new RegExp("^(-)?[0-9]{1,3}(\\"+d+"[0-9]{3})*(\\"+a+"[0-9]+)?"+Z+"$"),X=new RegExp("^(-)?[0-9]*(\\"+a+")?[0-9]+"+Z+"$"),W=new RegExp("^(-)?[0-9]{1}(\\"+a+")[1-9]+[eE]{1}[-]{0,1}[0-9]+"+Z+"$");return(String(b).indexOf(d)&&Y.test(b))||X.test(b)||W.test(b);},isBigDecimal:function(X){if(!X){return false;}var W=String(X).match(/^#([^#]+)#$/);if(!W||W.length<=1){return false;}var Y=W[1];return this.isNumeric(Y);},parseInteger:function M(W,X){if(!this.isInt(W)){return Number.NaN;}return parseInt(this.toString(W,true),X);},parseNumeric:function C(W){if(!this.isNumeric(W)){return Number.NaN;}return parseFloat(this.toString(W,true));},parseEnhNumeric:function A(W){if(!this.isNumeric(W,true)){return Number.NaN;}if(W.indexOf("%")!==-1){return parseFloat(this.toString(W.replace("%",""),true))/100;}return parseFloat(this.toString(W,true));},parseBigDecimal:function(W){return String(W).match(/^#(.+)#$/)[1];},inNumericRange:function R(X,Y,W){X=this.parseNumeric(X);W=(W!=null)?this.parseNumeric(this.toLocaleString(W)):Number.NaN;Y=(Y!=null)?this.parseNumeric(this.toLocaleString(Y)):Number.NaN;if(W!=Number.NaN&&(X>W||isNaN(X))){return 1;}if(Y!=Number.NaN&&(X<Y||isNaN(X))){return -1;}return 0;},convertToUSUnits:function(Z,Y,X){var W=Z;Y=Y||D;switch(parseInt(Y,10)){case S.CM:W=parseFloat(this.toString(Z))/2.54+"";break;case S.MM:W=parseFloat(this.toString(Z))/25.4+"";break;case S.PT:W=parseFloat(this.toString(Z))/72+"";break;case S.PC:W=parseFloat(this.toString(Z))/6+"";break;case S.PX:W=parseFloat(this.toString(Z))/H+"";break;}return X?W:this.toLocaleString(W);},convertToLocalUnits:function(Z,Y,X){var W;Y=Y||D;switch(parseInt(Y,10)){case S.CM:W=(parseFloat(this.toString(Z))*2.54).toFixed(4)+"";break;case S.MM:W=(parseFloat(this.toString(Z))*25.4).toFixed(4)+"";break;case S.PT:W=(parseFloat(this.toString(Z))*72).toFixed(4)+"";break;case S.PC:W=(parseFloat(this.toString(Z))*6).toFixed(4)+"";break;case S.PX:Z=parseFloat(this.toString(Z))*H;W=parseInt(Z)==Z?Z+"":Z.toFixed(4)+"";break;default:W=parseFloat(this.toString(Z)).toFixed(4)+"";}return X?W:this.toLocaleString(W);},convertUnits:function(X,Y,W){return this.convertToLocalUnits(this.convertToUSUnits(W,X,true),Y,true);},toLocaleString:function(X,W){var Y=(X+"").replace(".",this.getDecimal());if(W){return this.addSeparators(Y,this.getThousand());}return Y;},toString:function(Y,W){if(W===true){var X=this.getThousandSepRegex();if(X){Y=String(Y).replace(X,"");}}return String(Y).replace(this.getDecimal(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(this.getThousand().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(Y,X){var W=X;if(X=="."||X=="*"||X=="\\"){W="\\"+X;}return Y.reverse().replace(/(\d{3})/g,"$1"+X).reverse().replace(new RegExp("^(-)?"+W),"$1");},addSeparators2:function(Z,Y){var W=Z,X=/(\d+)(\d{3})/;while(X.test(W)){W=W.replace(X,"$1"+Y+"$2");}return W;},format:function(a,Z,d,W){var c="",b=(Z>0)?".":"",X=[];d=(d)?d:"";for(var Y=0;Y<Z;Y++){X.push("0");}X=X.join("");switch(a){case F.GENERAL:c="0.00";break;case F.PERCENT:c="0"+b+X+"%";break;case F.SCIENTIFIC:c="0"+b+X+"E+00";break;default:c='"'+d+'"#,##0'+b+X;}return this.formatByMask(c,W);},getDecimalLength:function K(Y){var W=Y.indexOf("."),Z=0;if(W!==-1){var X=Y.substr(W+1,Y.length).match(/\d+/);if(X&&X.length>0){Z=X[0].length;}}return Z;},formatByMask:function(AK,Ac,AI){var AC,p="",w,Ag=false;if(isNaN(Ac)){AC=new Date(Ac);if(isNaN(AC)||!Date.parse(Ac)){return Ac;}w=true;}if(AK==="General"){if(String(parseFloat(Ac)).indexOf(".")>-1){var AG=AI?String(parseFloat(Ac)):String(parseFloat(Ac).toFixed(2));p=AG.split(".");if(p.length===2){return p.join(this.getDecimal());}return AG;}if(isNaN(Ac)){return Ac;}return String(parseFloat(Ac));}var u=String(AK).split(";"),Z=u[0],l="\u00A4",AV=/"[^"]*"/g,o=(AK&&AK.replace(AV,l).replace(/\[.*\]/g,l))||"",Ab=["m","y","d","h","s"],AQ=false;G.forEach(Ab,function(i){AQ=AQ||o.indexOf(i,0)!==-1;});if(AQ){if(window.SSF&&!Ag){p=this.formatBySSF(AK,Ac);Ag=true;}if(p!==""){return p;}else{return I(w?AC:U(Ac),AK,Ac);}}var AO=Z.indexOf("E+"),f=Z.indexOf("%"),z=Z.match(/\".+?\"/g),AF=Z.match(/\[([=<>]*)(-?\d+\.?\d*)\]/),AA=Z.indexOf("?/?")>-1,AH=(AO!=-1)?F.SCIENTIFIC:((f!=-1)?F.PERCENT:((z&&!AF)?F.CURR:AA?F.FRACTION:F.FIXED)),t="",AX="",q=false,X=new String(Ac),e=parseFloat(Ac)||this.parseNumeric(Ac);if(z){if(Z.match(/\[\$.+?\]/g)){for(var g=0;g<z.length;g++){Z=Z.replace(z[g],z[g].substring(1,z[g].length-1));if(z[g].match(/\[\$.+?\]/g)){z[g]=z[g].replace(/\[\$.+?\]/g,z[g][z[g].indexOf("[$")+2]);}}Z=Z.replace(/\[\$.+?\]/g,'"#"'.replace("#",Z[Z.indexOf("[$")+2]));}t=L(Z,z);t=t.replace(Z.replace(/\".+?\"/g,""),l);}if(e<0){X=X.substring(1,X.length);e=-e;q=true;if(u.length>1){var c=u[1].replace(/\[.*\]/,"");AX=L(c.replace(u[0],l));}}var n=this,d=function(m,i){var j=i&&i.replace(l,m);if(i&&(j===i)&&window.SSF){if(Ag){return m;}else{Ag=true;return n.formatBySSF(i,m);}}return(i)?j:"-"+m;};if(AH===F.FRACTION){var AT,AS,Aa,s=10,AB,y=0,AM,AW,a,Y=false,AJ;if(AK.indexOf("# ")>-1){Y=true;}for(AT=5;AT>0;AT--){AJ="/";for(AS=0;AS<AT;AS++){AJ+="?";}if(AK.indexOf(AJ)>-1){for(AS=1;AS<AT;AS++){s*=10;}break;}}if(Y){y=Math.floor(Number(e));e-=y;}AW=s/2;Aa=-1;AM=e*s;for(AT=s-1;AT>=2;AT--){a=(AM*AT)/s;a=a-Math.floor(a);a=a*s;if(Math.abs(a-s)<a){a=Math.abs(a-s);}a=a/AT;if(a<AW){AW=a;Aa=AT;}else{if((a==AW)&&(a==0)){AW=a;Aa=AT;}}}AB=Math.round(Aa*AM/s);for(AT=Aa;AT>=2;AT--){if((AB%AT==0)&&(Aa%AT==0)){AB=AB/AT;Aa=Aa/AT;break;}}if(Aa==s){Aa=1;AB=0;}if(AB==0){Aa=1;}if(AB==Aa){if(Y){p=""+(y+1);}else{p="1";}}else{if(Y&&y>0){if(AB==0){p=y;}else{p=y+" "+AB+"/"+Aa;}}else{if(AB==0){p="0";}else{p=AB+"/"+Aa;}}}if(q){p=d(p,AX);}}else{if(AH==F.SCIENTIFIC){if(e!=0){var Ae=Math.floor(Math.log(e)/Math.LN10),AR=e/Math.pow(10,Ae),Af=Z.substring(0,AO),k=Af.indexOf("."),AL=Z.length-Z.indexOf("E+")-(""+Math.abs(Ae)).length-2,AT,W=Ae<0;Ae=Math.abs(Ae);for(AT=0;AT<AL;AT++){Ae="0"+Ae;}p+=Number(AR).toFixed((k!=-1)?Af.length-k-1:0);p=((q)?d(p,AX):p)+"E"+(W?"-":"+")+Ae;}else{p="0";}}else{if(AH==F.PERCENT){Z=Z.substring(0,Z.length-1);X=String(e*100);}var k=Z.indexOf("."),b=0,AZ,x=k>=0?Z.substring(0,k):Z,AD=k>=0?Z.substring(k+1,Z.length):"",h=false;if(x.match(/[#0\?],$/)){e/=1000;X=String(e);}else{if(AD.match(/^[#0]*,/)){var AE=0;h=true;while(AE<AD.length){if(AD[AE]==="0"||AD[AE]==="#"){AE++;}else{if(AD[AE]===","){e/=1000;X=String(e);AE++;}else{break;}}}}}AZ=this.getDecimalLength(X);if(k!=-1){b=O(AZ,Z.substr(k+1,Z.length));}if(X.indexOf("e")===-1||X.indexOf("e-")>-1){p=String((+(Math.round(+(X.indexOf("e")>0?String(parseFloat(X).toFixed(Math.min(b+2,20))):X+"e"+Math.min(b,20)))+"e"+-Math.min(b,20))).toFixed(Math.min(b,20)));}else{p=X;var Ad=p.split("e");Ad[0]=parseFloat(Ad[0]).toFixed(2).toString();p=Ad.join("e");if(AH==F.CURR){p=t.replace(l,p);if(p===t&&window.SSF){p=this.formatBySSF(AK,Ac,p);Ag=true;}}if(AH==F.PERCENT){p+="%";}if(q){p=d(p,AX);}return p;}if(AH===F.FIXED&&window.SSF){var AU;if(/[\[\]><=A-Za-z]|,{2}/.test(Z)){AU=this.formatBySSF(AK,Ac);p=AU!==""?AU:p;Ag=true;}var AP=q?AX:Z;if(/^\s*[\+-]{1}[#,.0]+/.test(AP)){AU=this.formatBySSF(AP,Math.abs(Ac));p=AU!==""?AU:p;Ag=true;}}var AY=p.split(".");var AN=Z.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AN!==null){if(AH===F.CURR){AY[0]=(this.formatBySSF((h?AN[0]&&AN[0].trim():AN.input&&AN.input.trim()),parseFloat(AY[0]))||"").split(".")[0];Ag=true;}if(AY[0].indexOf(",")>=0){AY[0]=AY[0].replace(/,/g,this.getThousand());}else{if(!(this.getThousand()===","&&AY[0].search(this.getThousand())>0)){AY[0]=this.addSeparators2(AY[0],this.getThousand());}}}p=AY.join(this.getDecimal());if(AH==F.CURR){p=t.replace(l,p);if(p===t&&window.SSF){p=this.formatBySSF(AK,Ac,p);Ag=true;}}if(AH==F.PERCENT){p+="%";}if(q){p=d(p,AX);}}}return p;},formatBySSF:function(Y,X,Z){var W=(Z!==undefined&&Z!==null)?Z:"";if(typeof X==="string"){X=parseFloat(X);}try{W=window.SSF.format(Y,X);}catch(a){if(window.mstr_profile){window.mstr_profile.log(a);}W=(Z||X).toString();}return W;},validateFormat:function(W){var X=true,Y=String(W).split(";");if(Y[1]&&Y[1].indexOf(Y[0])<0){X=false;}return X;},generateUniqueID:function(W){var Y="0123456789ABCDEF".split(""),Z=[];for(var X=0;X<W;X++){Z[X]=Y[0|Math.random()*16];}return Z.join("");},countOfDecimals:function(X,Y){var W=String(X);return W.length-(W.indexOf(Y!==undefined?Y:this.getDecimal())+1);},getThousand:function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},getDecimal:function(){return mstrmojo.locales.number.DECIMALSEPARATOR;}});mstrmojo.num.UNIT=S;mstrmojo.num.UNIT_SYMBOL=B;})();(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.vi.ui.rw.linkingExprHelper=mstrmojo.provide("mstrmojo.vi.ui.rw.linkingExprHelper",{makeBold:function B(C){return"<span style='font-weight:bold;'>"+C+"</span>";},getLinkingSelectorExpr:function A(F,E){var G=[],H="",D=true,I=mstrmojo.desc(5283,"OR"),C=F.keepOnly?"##":mstrmojo.desc(13232,"Not ##");if(E){I=this.makeBold(I);}F.data.every(function(J){[].concat(J).every(function(K){if(H===""){H=K.tn;}return(D=(H===K.tn));});return D;});F.data.forEach(function(L,J){var K=[];if(D){if(J>0){K.push(I);}else{K.push(C.replace("##",H+" = "));}}[].concat(L).forEach(function(O){var N=E?mstrmojo.string.encodeHtmlString(O.v):O.v,M=E?mstrmojo.string.encodeHtmlString(O.tn):O.tn;K.push((D?"":(M+" = "))+(N||mstrmojo.desc(14323,"NULL")));});G.push(K.join(" "));});return G.join(" ");}});}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){var R;for(R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){var Q;for(Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;return this;},toString:function B(){if(this.root){return this.root.getXMLString();}return"";}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.vi.enums.EnumFeatures");var K=mstrmojo.string,F=mstrmojo.dom,G=mstrmojo.vi.enums.EnumFeatures;mstrmojo.CustomVisUtility=mstrmojo.provide("mstrmojo.CustomVisUtility",{encodeHtmlString:function(O,N){return K.encodeHtmlString(O,N);},decodeHtmlString:function(N){return K.decodeHtmlString(N);},isInPauseMode:function(){return(mstrConfig&&mstrConfig.resolveOnly)||(mstrApp&&mstrApp.isAppStatePause&&mstrApp.isAppStatePause());},isRWDExpressMode:function B(){return !!(mstrApp&&mstrApp.isExpress);},isVI:function E(){return mstrApp&&mstrApp.isVI;},isVIPresentationMode:function L(){return this.isVI()&&mstrApp.isAppStatePresentation();},isDesktop:function D(){return !!(mstrApp&&mstrApp.isSingleTier);},isWorkstation:function M(){return !!(mstrApp&&mstrApp.isWorkstation);},isWSLiveMode:function I(){if(mstrApp&&typeof mstrApp.supportFeature==="function"){return mstrApp.supportFeature(G.SUPPORT_LIVEMODE)&&(typeof mstrApp.getWSLiveMode==="function")&&mstrApp.getWSLiveMode();}return false;},isWSLocalMode:function C(){return this.isDesktop()&&!this.isWSLiveMode();},isLibrary:function A(){return !!(mstrApp&&mstrApp.isDossier);},isMobile:function H(){return F.isMobile;},parseBoolean:function J(N){return N===true||N==="true";},log:function(){Function.prototype.apply.call(console.log,console,arguments);},warn:function(){Function.prototype.apply.call(console.warn,console,arguments);},error:function(){Function.prototype.apply.call(console.error,console,arguments);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var Y=mstrmojo.dom,L=mstrmojo.string,c=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:Y.isNSIE?"block":"table",DISPLAY_CELL:Y.isNSIE?"block":"table-cell",MINHEIGHT:Y.isIE6?"height":"minHeight",addClass:function M(j,h){if(j){if(h.constructor!==Array){h=[h];}var e=j.className||"",l=" "+e+" ",f=false,d=h.length,g;for(g=0;g<d;g++){var k=h[g];if(!l.match(new RegExp("\\s"+k+"\\s"))){e+=" "+k;f=true;}}if(f){j.className=L.trim(e);}}return j;},removeClass:function O(h,g){if(!h){return ;}if(g.constructor!==Array){g=[g];}var e=" "+(h.className||"")+" ",d=g.length,f;for(f=0;f<d;f++){e=e.replace(new RegExp("\\s"+g[f]+"\\s","g")," ");}h.className=L.trim(e);},addWidgetCssClass:function N(j,g){var e=j.cssClass,h=(e&&e.split(" "))||[],f;g=[].concat(g);for(f=0;f<g.length;f++){var d=g[f];if(c.indexOf(h,d)===-1){h.push(d);}}j.cssClass=h.join(" ");},removeWidgetCssClass:function G(k,h){var e=k.cssClass,j=(e&&e.split(" "))||[],g;h=[].concat(h);for(g=0;g<h.length;g++){var d=h[g];var f=c.indexOf(j,d);if(f!==-1){j.splice(f,1);}}k.cssClass=j.join(" ");},toggleClass:function X(f,e,d){if(d){this.addClass(f,e);}else{this.removeClass(f,e);}},hasClass:function A(e,f){if(e){var d=" "+(e.className||"")+" ";return !!d.match(new RegExp("\\s"+f+"\\s"));}return false;},applyShadow:function H(h,i,g,f,d){var e=h.style;if(Y.isDXIE){e.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+i+"px, OffY="+g+"px, Color='"+d+"')";}else{if(Y.isFF||Y.isWK||Y.isIE10){e[Y.CSS3_BOXSHADOW]=i+"px "+g+"px "+f+"px "+d;}}},removeShadow:function C(e){var d=e.style;if(Y.isFF||Y.isWK||Y.isIE10){d[Y.CSS3_BOXSHADOW]="";}},setOpacity:function Z(e,g){if(Y.isDXIE&&!Y.isIE9){var h=e.currentStyle.filter;var d=null;if(h.length>0){d=e.filters["DXImageTransform.Microsoft.Alpha"];}if(d){d.opacity=g;d.enabled=(g!==100);}else{if(g<100){var f="progid:DXImageTransform.Microsoft.Alpha(Opacity="+g+")";e.style.filter=(h||"")+" "+f;}}}else{e.style.opacity=g/100-(Y.isIE9?0.00001:0);}},buildGradient:function P(e,g,d){if(Y.supports(Y.cssFeatures.GRADIENTS)){var f={};if(Y.isDXIE){f.n="filter";f.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+e+",StartColorStr='"+g+"',EndColorStr='"+d+"')";}else{if(Y.isFF){f.n="background-image";f.v="-moz-linear-gradient("+((e===0)?"top":"left")+","+g+","+d+")";}else{if(Y.isIE10||Y.isIEW3C||Y.isIE11||Y.isEdge||Y.isWK){f.n="background";f.v="linear-gradient("+((e===0)?"to bottom":"to right")+","+g+","+d+")";}}}return f;}return null;},buildRoundCorners:function R(j,h){if(Y.supports(Y.cssFeatures.ROUND_CORNERS)){var e=j+"px";var l=e+(h?" "+e+" 0 0":"")+";";if(Y.isFF||Y.isWinPhone||Y.isIE10){return"border-radius:"+l;}if(Y.isWK){if(!h){return"-webkit-border-radius:"+e+";";}var k=["left","right"],g=[],d=-1,f;for(f=0;f<2;f++){g[++d]="-webkit-border-top-"+k[f]+"-radius:"+e;g[++d]="-webkit-border-bottom-"+k[f]+"-radius:0";}return g.join(";");}}return"";},getBorderWidthsOrPaddings:function E(e,h){var j={t:0,r:0,b:0,l:0,h:0,w:0};if(!e){return j;}var f=e.split(" "),d=f.length,g;for(g=0;g<d;g++){f[g]=Math.round(h*parseFloat(f[g])/72);}if(d<4){if(d===1){f[1]=f[2]=f[3]=f[0];}else{f[3]=f[1];if(d===2){f[2]=f[0];}}}j.t=f[0];j.r=f[1];j.b=f[2];j.l=f[3];j.h=j.t+j.b;j.w=j.l+j.r;return j;},getBorderWidths:function I(e,d){return this.getBorderWidthsOrPaddings(e,d);},getPaddings:function D(e,d){return this.getBorderWidthsOrPaddings(e,d);},parkAfterFade:function B(d){var e=d.target.style;if(e.opacity===0){e.left="-10000px";window.setTimeout(function(){e.opacity=0.99;},0);return true;}return false;},getStyleValue:function J(d,h){var f=(h==="float"),g;if(d.currentStyle){h=f?"styleFloat":h;g=d.currentStyle[h];}else{if(document.defaultView&&document.defaultView.getComputedStyle){h=f?"cssFloat":h;var e=document.defaultView.getComputedStyle(d,null);g=e?e[h]:null;}}return g;},getComputedStyle:function W(d,f){var e=(window.getComputedStyle)?function(g,h){return window.getComputedStyle(g,h||null);}:function(g){return g.currentStyle||{};};mstrmojo.css.getComputedStyle=e;return e(d,f);},getCssTextFromObj:function F(f){var e="",d;for(d in f){e+=d+":"+f[d]+";";}return e;},onTransitionEnd:function b(f,d){var e="transition",g=window.Modernizr;if(g.testProp(e)){Y.attachOneTimeEvent(f,Y.transEndEvtNames[g.prefixed(e)],d);}else{window.setTimeout(d,0);}},onAnimationEnd:function U(f,d){var e="animation",g=window.Modernizr;if(g.testProp(e)){Y.attachEvent(f,Y.animationEndEvtNames[g.prefixed(e)],d);}else{window.setTimeout(d,0);}},flashClass:function Q(e,d,g){this.toggleClass(e,d,true);var f=this;window.setTimeout(function(){f.toggleClass(e,d,false);},g);},convertCssToCamelCase:function K(d){return d.replace(/\-([a-z])/gi,function(e,f){return f.toUpperCase();});},printCSSInfo:function a(h){var n=document.styleSheets,q=n.length,k,l;for(l=0;l<q;l++){var m=n[l],o=m.cssRules,f=o?o.length:0,p=0;for(k=0;k<f;k++){var d=o[k].selectorText;if(d){try{p+=d.split(",").length;}catch(g){}}}var e=m.href;if(!h||(e&&e.indexOf(h)>-1)){console.log("Stylesheet: "+e||"Inline CSS Block");console.log("Total rules: "+f);console.log("Total selectors: "+p);}}},cssEscape:function S(j){if(arguments.length===0){throw new TypeError("`CSS.escape` requires an argument.");}var g=String(j),i=g.length,f=-1,h,d="",e=g.charCodeAt(0);while(++f<i){h=g.charCodeAt(f);if(h==0){d+="\uFFFD";continue;}if((h>=1&&h<=31)||h==127||(f==0&&h>=48&&h<=57)||(f==1&&h>=48&&h<=57&&e==45)){d+="\\"+h.toString(16)+" ";continue;}if(f==0&&i==1&&h==45){d+="\\"+g.charAt(f);continue;}if(h>=128||h==45||h==95||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122){d+=g.charAt(f);continue;}d+="\\"+g.charAt(f);}return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.func");var C=mstrmojo.publisher,F=mstrmojo.func;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function G(O,I){var H=false,L=this["_set_"+O],J=this[O];if(L){H=L.apply(this,arguments);}else{this[O]=I;H=(J!==I);}if(H){var M=O+"Change",N=this.audibles||{},K=(N[O]===true)||((N[O]!==false)&&(N["*"]!==false));if(K&&(this["pre"+M]||this["on"+M]||this["post"+M]||C.hasSubs(this.id,M))){this.raiseEvent({name:M,prop:O,value:I,valueWas:J});}}return this;},raiseEvent:function B(I){var N=I&&I.name;if(!N){return null;}I.src=this;this.preHandleEvent(I);var L=["pre","on","post"],M=false,J,H;for(J=0,H=L.length;J<H;J++){var K=L[J]+N;if(this[K]){if(this[K](I)===false){M=true;break;}}}if(!M){this.postHandleEvent(I);C.publish(this.id,N,I);}return I;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(H,I,J){return C.subscribe(this.id,H,J,I);},detachEventListener:function E(H){C.unsubscribe(H);},attachEventListenerOnce:function(H,J,K){var I=C.subscribe(this.id,H,F.composite([function(){C.unsubscribe(I);},K]),J);return I;},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dnd","mstrmojo.EnumRWUnitType","mstrmojo.vi.enums.EnumCanvasSizeType");var w=mstrmojo.array,X=mstrmojo.hash,s=w.fnReduceNumber,AT=mstrmojo.EnumRWUnitType,E={none:0,edit:1,preview:2};mstrmojo.vi.ui.BoxLayoutType=null;var n="c";var W="flc";var x="b";var AC="g";var Z="h";var AV="v";var u={ifwTopPerc:25,ifwLeftPerc:25,ifwWidth:50,ifwHeight:50,leftPerc:10,topPerc:5,defaultWidthPerc:30,defaultHeightPerc:30,panelStackWidthPerc:50,panelStackHeightPerc:50,imageWidthPerc:40,imageHeightPerc:12,textWidthPerc:40,textHeightPerc:12,selectorWidthPerc:65,selectorHeightPerc:12,sizeAbs:200,posAbs:0},AJ=5;var Y="|";var AG=false;function K(AW){mstrmojo.all[this.hostId].buildBoxLayout(AW);}function N(AW){var AX=this.hostId&&mstrmojo.all[this.hostId];if(AX&&AX.toggleFloatChild){AX.toggleFloatChild(AW);}}function d(AX){AX=AX||"";var AW=AX.split(Y);return{target:parseInt(AW.pop(),10),parentPathArray:AW,parentPath:AW.join(Y)};}function D(AZ,AX){if(!AZ){return undefined;}AX=AX||this.box;var AY=d(AZ),AW=AX;AY.parentPathArray.forEach(function(Ab){AW=AW.children[Ab];});var Aa=function(Ac,Ag,Ae){var Ai=Ag.children,Ab=Ai[Ac],Ah=function(Am,Ak,Al){if(Am.t===n){return mstrmojo.all[Am.id].getMinBoxSize(Ag.o)+(Al?this.padding:0);}var Aj=Am.children.map(function(An){return Ah(An,Ak,Al);});if(Am.o===Ak){return Aj.reduce(s);}return Math.max.apply(null,Aj);}.bind(this),Af=function(Ak,Am,Aj,Al){return Ak.map(function(Ao,An){return Aa(An+Am,Aj||Ag,(Al===0||Al==="0")?0:(Al||Ae));});},Ad=function(Ak){var Aj=[0,Ac];if(Ak){Aj=[Ac+1];}return Af(Array.prototype.slice.apply(Ai,Aj),Ak?Ac+1:0);};return{idx:Ac,path:(Ae||parseInt(Ae)===0)?(Ae+Y+Ac):Ac,parent:Ag,parentPath:Ae,siblings:Ai,box:Ab,getBoxLength:function(){return Ab[Ag.o==="v"?"h":"w"];},getSiblings:function(){return Af(Ai,0);},getPreviousSiblings:function(){return Ad();},getNextSiblings:function(){return Ad(true);},getMinimumBoxSize:function(Aj,Ak){return Ah(Ab,Aj,Ak);},getChildren:function(){return Af(Ab.children||[],0,Ab,this.path);}};}.bind(this);if(AW&&AW.children){return Aa(AY.target,AW,AY.parentPath);}else{return undefined;}}function U(AY,AX){var AW=mstrmojo.all[AY].getBoxConfiguration().f;return AW&&AW[AX];}function F(AW){return AW.filter(function(AX){return !AX.f;});}function j(AW){return !AW.some(function(AX){return !AX.f;});}function y(Ab,AW,Aa){if(Ab.length){var AY=Aa?0:AW,AZ=Aa?AW:0,AX=Ab[0];Ab.forEach(function(Ad){var Ac=Math.round((Ad.l/(100-AY))*AW);Ad.l+=Aa?-Ac:Ac;AZ+=Ad.l;AX=Ad;});AX.l+=100-AZ;}}function AD(AY,AX){var AW=F(AY);AX=AX||Math.round(100/(AW.length+1));y(AW,AX,true);return AX;}function G(AX,AW){y(F(AX),AW);}function H(Aa){var AZ=mstrmojo.all[this.hostId],AY=AZ.children,AX={},AW=function(Ab){return !Ab.children.some(function(Ad){if(Ad.t===n){var Ac=mstrmojo.all[Ad.id]||mstrmojo.all[AX[Ad.k]];return !Ac.getBoxConfiguration().f;}return !AW(Ad);});};w.forEach(AY,function(Ab){AX[Ab.k]=Ab.id;});return AW(Aa);}function AI(Ab,AY){var AZ=Ab.children,AX=AZ.reduce(function(Ac,Ad){return Ad.l+Ac;},0);AZ.forEach(function(Ac){delete Ac.f;Ac.l=Math.round((Ac.l/AX)*100);});if(Ab!==this.box){Ab.f=true;Ab.l=Ab[Ab.o==="h"?"h":"w"];if(AY){var AW=D.call(this,AY),Aa=AW.box;if(j(Aa.children)){AI.call(this,Aa,AW.parentPath);}}}}function z(Ab,AX){var Ae=Ab.children,AW=0;Ae.filter(function(Af){return Af.t===n;}).forEach(function(Af){AW+=Af.l;Af.f=true;Af.l=U(Af.id,Ab.o);});F(Ae).forEach(function(Af){Af.l=Math.round(Af.l*(100/(AW||100)));});var Ac=this.box;if(Ab!==Ac){var Aa=AX&&D.call(this,AX),AZ=(Aa&&Aa.box)||Ac;if(H.call(this,AZ)){z.call(this,AZ,Aa&&Aa.parentPath);return ;}var AY=AZ.children,Ad=AY.indexOf(Ab);delete Ab.f;AY.splice(Ad,1);Ab.l=AD(AY);AY.splice(Ad,0,Ab);}}function AR(AW){if(typeof AW!=="string"){return undefined;}return parseInt(AW,10);}function AA(AW,AZ){var AX=false;var AY=AR(AW);if(AY!==undefined){AW=AY;AX=true;}return{f:AX,l:AW===undefined?100:AW,r:!!AZ};}function P(AW){return function(AX,AY){if(!!AW){AX.push(AY);}else{AX.splice(0,0,AY);}return AX;};}function o(AW){if(AG){console.log(JSON.stringify({t:AW,cfg:this.box}));}}function R(Ag,Af,Ad,Ae){var AW=this.getNewRootBox(Ag===AV),Aa=this.box,Ac=Aa.children,Ab=Aa.canvasSize,AZ=this.box.floatChildren,AY=this.box.ifwChildren,AX=Ac.length>1?Object.keys(Aa).reduce(function(Ah,Ai){if(Ai!=="floatChildren"){Ah[Ai]=Aa[Ai];}return Ah;},{}):Ac[0];Af.l=Ae||100/((AX?1:0)+1);if(AX){AX.l=Ae?100:50;}AW.children=Ad([AX].filter(function(Ah){return Ah;}),Af);AW.floatChildren=AZ;AW.ifwChildren=AY;AW.canvasSize=Ab;this.box=AW;}function I(AW,Ad,AZ,Aa){var Ac=this.identifier,AX=this.box,AY=AX.children,Ae={t:n,f:false,l:100,id:AW.id},Ab=P(Aa);Ae[Ac]=AW[Ac];if(H.call(this,AX)){if(Ad){Ad=0;}else{z.call(this,AX);}}Ae.f=!!Ad;if(AZ){if(AZ===AX.o){Ae.l=Ad||AD(AY);Ab(AY,Ae);}else{R.call(this,AZ,Ae,Ab,Ad);}}else{Ae.l=Ad||AD(AY);Ab(AY,Ae);}o.call(this,"addRootChild");}mstrmojo.vi.ui.BoxLayoutConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.BoxLayoutConfig",identifier:"k",padding:4,hostId:"",box:null,boxTree:[],boxPaths:null,init:function AM(AW){X.copy(AW,this);},validateBoxLayout:function C(AW,AY){AY=AY||this.box;var Ab=this.identifier,AX=this,AZ=function(Ae){var Ad=Ae.children,Af=Ad.filter(function(Ag){return Ag.t===x;});var Ac=Ad.length;if(Ac===Af.length&&Ac===1){return false;}return Af.map(AZ).reduce(function(Ag,Ah){return Ag&&Ah;},true);},Aa=function(){var Ad=AW.map(function(Af){return Af[Ab];}),Ae=function(Ah){var Ag=[];Ah.children.forEach(function(Aj){if(Aj.t===x){Ag=Ag.concat(Ae(Aj));}else{Ag.push(Aj[Ab]);}});var Af=mstrmojo.all[AX.hostId].groupTreeLayoutConfig,Ai;if(Ah.floatChildren){if(Ah.floatChildren.length!==undefined){Ai=Ah.floatChildren;}else{if(Af&&Af.getFloatGroupTree()){Ai=Af.getLeafNodeArray(true);}}}if(!Ai){Ai=[];}Ai.forEach(function(Aj){if(Aj.t==="flc"){Ag.push(Aj[Ab]);}});return Ag;},Ac=Ae(AY);return(Ac.length!==0||Ad.length===0)&&Ac.every(function(Af){return Ad.indexOf(Af)>-1;});}.bind(this);return AZ(AY)&&Aa();},useDefaultBox:function(AZ,Ac){var AY=this.identifier,AX=Math.round(100/AZ.length),Aa=this.getNewRootBox(this.box&&this.box.o===AV),AW=0,Ab=null;Aa.children=AZ.map(function(Aj,Ag){var Ae={t:n},Af=AX,Ah=false;if(Ac){Af=Ac[Ag];var Ai=AR(Af);if(Ai!==undefined){Af=Ai;Ah=true;}}if(!Ah){AW+=Af;Ab=Ae;}Ae.l=Af;Ae.f=Ah;Ae[AY]=Aj[AY];return Ae;});if(Ab){var Ad=100-AW;if(Ad){Ab.l+=Ad;}}this.box=Aa;return Aa;},getNewRootBox:function g(AW){return{t:x,o:AW?AV:Z,children:[],floatChildren:[],ifwChildren:[],canvasSize:{sizeType:mstrmojo.vi.enums.EnumCanvasSizeType.AUTOMATIC,sizeSetting:null}};},getDefaultIfwLayout:function c(AZ,Ac){var Aa=u.ifwWidth,AX=u.ifwHeight,Af=u.ifwTopPerc,Ae=u.ifwLeftPerc,Ag=mstrmojo.all[this.hostId],Ad=Ag.getContainerNodeMargin(),AW=parseInt(Ag.width,10)-2*Ad,Ab=parseInt(Ag.height,10)-2*Ad;var AY={fixed:"0",k:AZ.k,t:"flc",hidden:0};AY.width=Aa+"|"+Aa/100*AW+"px";AY.height=AX+"|"+AX/100*Ab+"px";AY.left=Ae+"|"+Ae/100*AW+"px";AY.top=Af+"|"+Af/100*Ab+"px";return AY;},getDefaultFloatLayout:function AQ(Ad,Aq,Au){var Aw,Ax,Ai=this.box,Ao=Ad.model.getSelectedViUnit()||null,Ah=mstrmojo.all[this.hostId],Af=Ah.getContainerNodeMargin(),AW=parseInt(Ah.width,10)-2*Af,AX=parseInt(Ah.height,10)-2*Af,Al=Ah.groupTreeLayoutConfig,AZ=Al.getLeafNodeArray(),Ab,Aa=Ad.left,Ar=typeof Aa==="string"&&Aa.indexOf("|")!==-1,Ac=Ao&&Ao.parent,Av=!!(Ac&&Ah.k===Ac.k);switch(X.walk("defn.t",Ad)){case AT.TEXTFIELD:Aw=u.textWidthPerc;Ax=u.textHeightPerc;break;case AT.IMAGE:Aw=u.imageWidthPerc;Ax=u.imageHeightPerc;break;case AT.SELECTOR:Aw=u.selectorWidthPerc;Ax=u.selectorHeightPerc;break;case AT.PANELSTACK:Aw=u.panelStackWidthPerc;Ax=u.panelStackHeightPerc;break;default:Aw=u.defaultWidthPerc;Ax=u.defaultHeightPerc;}if(Aq&&Ac&&Ac.getFloatGroupTree()){var AY=Ac.groupTreeLayoutConfig,Ag=AY&&AY.getLeafNodeArray(),Ak=w.find(Ag,"k",Ao.k);if(Ak!==-1){Ab=AY.parseConfigNode(Ag[Ak]);}}var An,Am=Al.parseConfigNode(Au);if(AZ.length>0){An=parseFloat(AZ.sort(function(Az,Ay){return parseFloat(Az.zIndex)-parseFloat(Ay.zIndex);})[AZ.length-1].zIndex);}else{An=2;}Ad.unDocked=true;var Aj={fixed:"0",k:Ad.k,rk:Ad.parent&&Ad.parent.k,l:Ai.o===AV?Ax:Aw,zIndex:An+"",t:"flc",hidden:0},Ap,Ae=function(Az){var A2=Ah.getScrollPosition(),A1=AW/2-parseFloat(Az.width.split("|")[1])/2,A0=AX/2-parseFloat(Az.height.split("|")[1])/2,Ay=function(A4,A3){return Math.floor(Math.random()*A4)-(A3?A4/2:0);};A1+=A2.scrollLeft+Ay(AW*0.3,true);A0+=A2.scrollTop+Ay(AX*0.3,true);A1=A1<0?Ay(50,false):A1;A0=A0<0?Ay(50,false):A0;return{top:A0,left:A1};};if(Ab){Aj.width=Ab.width[0]+"|"+(Ab.width[0]/100*Am.width[1])+"px";Aj.height=Ab.height[0]+"|"+(Ab.height[0]/100*Am.height[1])+"px";if(!Av){Aj.left=Ab.left[0]+"|"+(Ab.left[0]/100*Am.width[1])+"px";Aj.top=Ab.top[0]+"|"+(Ab.top[0]/100*Am.height[1])+"px";}else{Ap=Ae(Aj);Aj.left=(Ap.left/Am.width[1]*100)+"|"+Ap.left+"px";Aj.top=(Ap.top/Am.height[1]*100)+"|"+Ap.top+"px";}}else{var As=Aw/100*AW,At=Ax/100*AX;Aj.width=(As/Am.width[1]*100)+"|"+As+"px";Aj.height=(At/Am.height[1]*100)+"|"+At+"px";if(Ar){Aj.left=Ad.left;Aj.top=Ad.top;}else{Ap=Ae(Aj);Aj.left=(Ap.left/Am.width[1]*100)+"|"+Ap.left+"px";Aj.top=(Ap.top/Am.height[1]*100)+"|"+Ap.top+"px";}}return Aj;},getDefaultBoxSize:function AP(AX,AW){return{width:u.defaultWidthPerc/100*AX,height:u.defaultHeightPerc/100*AW};},buildBoxTree:function f(AW){var AX={},AZ={},AY=this.boxTree=[],Aa=this.box.floatChildren;if(!Aa){return ;}Aa.forEach(function(Ab){(AX[Ab.rk]=AX[Ab.rk]||[]).push(Ab.k);if(Ab.rk){AZ[Ab.rk]=(AZ[Ab.rk]||0);}AZ[Ab.k]=(AZ[Ab.k]||0)+1;});Object.keys(AZ).forEach(function(Ab){if(Ab&&!AZ[Ab]){var Ac=this.getBoxTreeRoots(AW,Ab);Ac.k=Ab;Ac.children=[];AY.push(Ac);}},this);this.buildHelper(AY,AX,Aa);},buildHelper:function O(AW,AX,AY){AW.forEach(function(AZ){(AX[AZ.k]||[]).forEach(function(Aa){var Ab=X.copy(AY[w.find(AY,"k",Aa)]);Ab.children=[];AZ.children.push(Ab);});this.buildHelper(AZ.children,AX,AY);},this);},getBoxTreeRoots:function M(AW,AX){var AZ;if(AX===AW.k){var Aa=AW.getCanvasWidthAndHeight();AZ={left:0,top:0,width:Aa.width,height:Aa.height};}else{var AY=AW.getUnitByKey(AX).domNode.style;AZ=["left","top","width","height"].reduce(function(Ac,Ad,Ab){Ac[Ad]=Ab&2?parseFloat(AY[Ad])-(AW.panelPadding*2||0):AY[Ad];return Ac;},{});}return AZ;},newObjInBoxTree:function S(AY){var AX=AY.domNode.style,AW=this.boxTree;return AW[AW.push({left:AX.left,top:AX.top,width:parseFloat(AX.width),height:parseFloat(AX.height),k:AY.k,children:[]})-1];},findTargetNodeInBoxTree:function AN(AZ,AW){var AY;for(var AX=0;AX<AW.length;++AX){if(AW[AX].k===AZ.k){return AW[AX];}AY=this.findTargetNodeInBoxTree(AZ,AW[AX].children);if(AY){return AY;}}},findTargetParentInBoxTree:function L(AZ,AW){var AY;for(var AX=0;AX<AW.length;++AX){if(AW[AX].children.length&&AW[AX].children.find(function(Aa){return Aa.k===AZ.k;})){return AW[AX];}AY=this.findTargetParentInBoxTree(AZ,AW[AX].children);if(AY){return AY;}}},moveBoxToRelative:function e(AZ,AW){var AY=this.boxTree,AX=this.findTargetParentInBoxTree(AZ,AY),Aa=AX.children.splice(w.find(AX.children,"k",AZ.k),1)[0];(this.findTargetNodeInBoxTree(AW,AY)||this.newObjInBoxTree(AW)).children.push(Aa);this.updateAttrInFloatChildren(AZ,AW,Aa);},updateAttrInFloatChildren:function t(Aa,AX,Ac){if(this.findFloatKey(Aa)){var Ab=this.box.floatChildren,AW=Ab[w.find(Ab,"k",Aa.k)],AY=AX.domNode.style,AZ=Aa.domNode.style;[AW,Ac].forEach(function(Ad){X.copy(["left","top","width","height"].reduce(function(Ag,Ai,Af){var Ah=parseFloat(AZ[Ai]),Ae=parseFloat(AY[Ai])||0;Ag[Ai]=Af&2?Ah/Ae*100+"|"+Ah:(Ah-Ae)/(Af?parseFloat(AY.height):parseFloat(AY.width))*100+"|"+(Ah-Ae)+"px";return Ag;},{}),Ad);});AW.rk=AX.k;}},addFloat:function AO(AY,AW){var AX=this.box.floatChildren;AX.children.push(this.getDefaultFloatLayout(AY,AW,AX));},addIfwLayoutNode:function b(AX,AW){this.box.ifwChildren=this.box.ifwChildren||[];this.box.ifwChildren.push(this.getDefaultIfwLayout(AX,AW));},updateFloatLayout:function AE(AY,AX){var AW=mstrmojo.all[this.hostId];AW.updateChildNode(AX,{newLayout:AY});AX.notifyGroup();},updateIfwLayout:function AB(AY,AX){var AW=mstrmojo.all[this.hostId];AW.updateIfwNode(AX,{newLayout:AY});},addNewChild:function h(AY,AX,Aa,AZ){var AW=AA(AX,AZ);AW.t=n;AW[this.identifier]=Aa;AY.children.push(AW);},getBoxState:function q(){return JSON.parse(JSON.stringify(this.box));},getResizeBoundaries:function AS(Aa,AY){var AX={min:0,max:0},AW=function(Ac,Ab){if(!Ab){return ;}Ab.getPreviousSiblings().forEach(function(Ad){AX.min+=Ad.getMinimumBoxSize(AY,true);});Ab.getNextSiblings().forEach(function(Ad){AX.max+=Ad.getMinimumBoxSize(AY,true);});Ac.pop();Ac.pop();AW(Ac,D.call(this,Ac.join(Y)));}.bind(this);var AZ=D.call(this,Aa);AX.min+=AZ.getMinimumBoxSize(AY,true)-this.padding;AW(Aa.split(Y),AZ);return AX;},resizeBox:function AL(Ab,Ac){var AW=0,Ad=1,AZ=2,AX=function(Ag,Ao,Am,Ak){var Ai=Math.abs(Am),Ah,Al,Aj;Aj=Am=-Ai;Ah=Ag.map(function(Ap){return Ap.box.l;}).reduce(s,0);if(Ah===0){Ah=100;}Ag.forEach(function(As){var Ar=As.box,At=As.getBoxLength(),Ap=0;if(Am){Al=!Ar.f?(Aj*Ar.l/Ah):Aj/Ag.length;var Aq=Math.max(At+Al,As.getMinimumBoxSize(As.parent.o,false));Ap=At-Aq;Am+=Ap;At=Aq;}Ak.push({idx:As.idx,l:At,f:As.box.f,d:-Ap});});var An={};Ah=Ao.map(function(Ap){return Ap.box.l;}).reduce(s,0);if(Ah===0){Ah=100;}Ao.forEach(function(Ar,Ap){var Aq=Ar.getMinimumBoxSize(),As=Ar.getBoxLength();if(As<Aq&&Ai>0){An[Ap]=Math.min(Aq-As,Ai);Ai-=An[Ap];}});Ao.forEach(function(As,Aq){var Ar=As.box,Ap=0,At=As.getBoxLength();if(An[Aq]){At+=An[Aq];}Al=!Ar.f?(Ai*Ar.l/Ah):Ai/Ao.length;Ap=Al;At+=Ap;Ak.push({idx:As.idx,l:At,f:As.box.f,d:Ap});});return Am;},Aa=function(Ag,Al,Aj,Ak){var Ah=Math.abs(Aj);Aj=-Ah;Ag.forEach(function(Ao){var Ap=Ao.getBoxLength(),Am=0;if(Aj){var An=Ao.getMinimumBoxSize(Ao.parent.o,false);if(Ap+Aj>=An){Ap=Ap+Aj;Am=Math.abs(Aj);Aj=0;}else{Am=Ap-An;Aj+=Am;Ap=An;}}Ak.push({idx:Ao.idx,l:Ap,f:Ao.box.f,d:-Am});});var Ai={};Al.forEach(function(Ao,Am){var An=Ao.getMinimumBoxSize(),Ap=Ao.getBoxLength();if(Ap<An&&Ah>0){Ai[Am]=Math.min(An-Ap,Ah);Ah-=Ai[Am];}});Al.forEach(function(Ao,An){var Ap=Ao.getBoxLength(),Am=0;if(An===0){Am=Ah;Ap+=Ah;}Ak.push({idx:Ao.idx,l:Ap,f:Ao.box.f,d:Am});});return Aj;},AY=function(Ai,Ah,Aj,Ag){var Al=D.call(this,Ai),Am=Al.getPreviousSiblings().concat(Al),Ak=Am,An=Al.getNextSiblings();Am.reverse();if(Ah>=0){Ak=An;An=Am;}return Ag?Aa(Ak,An,Ah,Aj):AX(Ak,An,Ah,Aj);},Ae=function(Ah,Ag){return function(Ak,Aj,Al,Ai){var An=D.call(this,Ak),Ao=An.getSiblings(),Am=Ao,Ap=[];if(Ah){Ao.reverse();}if(Ag){Am=[];Ap=Ao;}return Ai?Aa(Am,Ap,Aj,Al):AX(Am,Ap,Aj,Al);};},Af=function(As,Au,At,Ai,Av){var Ax=D.call(this,As);if(!Ax){return ;}var Al=Ax.idx,Ak=Ax.getSiblings(),Aj=[],Am=At.call(this,As,Au,Aj,Av),Ao=0,Aw=0,Ag=0,An=false,Ap=this.padding,Ay=Aj.length-1;var Ah=Aj.filter(function(Az){return !Az.f;}).map(function(Az){Az.l+=Az.idx===Ay?0:Ap;return Az;}),Ar=Ah.map(function(Az){return Az.l;}).reduce(s,0);Ah.forEach(function(Az){Az.l=(Az.l/Ar)*100;Ao=Az.d;Aw=Ao?(Ao<0?-1:1):0;if(!An&&!Ag){An=true;Ag=Aw;}if(Ag!==Aw){An=false;}});Aj.forEach(function(A1){var A3=A1.idx,A0=Ak[A3],Az=A1.d;if(Az!==0&&(Ai!==AZ||A3!==Al)){var A2=Ae(A3<Al,Az>0);A0.getChildren().forEach(function(A4){if(A4.box.t===x){Af(A4.path+Y+"0",Az,A2,Ad,false);}});}if(Av||!An||A1.f){A0.box.l=A1.l;}});if(Ai!==Ad&&Am){var Aq=As.split(Y);Aq.pop();Aq.pop();if(Aq.length){Af(Aq.join(Y),Au<0?Am:-Am,AY,AZ,true);}}}.bind(this);Af(Ab,Ac,AY,AW,true);},insertNewRootChild:function AU(Aa,AZ,Ac,AW){var AX=Aa.getBoxConfiguration();if(!this.box.children.length){delete AX.f;}var AY=AX.o,Ab=AX.addToEnd;if(AZ){if(AZ.charAt(0)==="p"){AZ=AZ.slice(1);}AY=AZ==="Left"||AZ==="Right"?"h":"v";Ab=AZ==="Right"||AZ==="Bottom";}if(X.walk("defn.ifw",Aa)){this.addIfwLayoutNode(Aa,AW);}else{if(Ac){this.addFloat(Aa,AW);}else{I.call(this,Aa,(AX.f&&AX.f[AY])||0,AY,Ab);}}},insertExistingRootChild:function a(Aa,Ab){var AX=Aa.src.widget,AZ=Aa.box.oldPathInfo,AW=AX.getBoxConfiguration(),AY=Ab==="Left"||Ab==="Right"?"h":"v",Ac=(AW.f&&AW.f[AY])||0;if(Ac&&AZ.parent.o===AY){Ac=AZ.box.l;}I.call(this,AX,Ac,AY,Ab==="Right"||Ab==="Bottom");Aa.dropSuccessful=true;K.call(this);},getBoxOrientation:function Q(AX){var AW=D.call(this,AX);return AW&&AW.parent&&AW.parent.o;},getBoxPath:function AF(AW){return this.boxPaths[AW[this.identifier]];},deleteBox:function m(AW,Ap,Ar){var Ao=D.call(this,this.getBoxPath(AW));if(!Ao){return ;}if(!Ar){var Ak=this.boxTree,Ab=this.findTargetNodeInBoxTree(AW,Ak);if(Ab){var Af=AW.parent;Ab.children.forEach(function(Aw){var Av=Af.getUnitByKey(Aw.k);this.moveBoxToRelative(Av,Af);},this);var AY=this.findTargetParentInBoxTree(AW,Ak);if(AY){AY.children.splice(w.find(AY.children,"k",AW.k),1);}}}var Aj=Ao.box,As=Ao.idx,AZ=Ao.parent,Ad=Ao.parentPath,Ah=D.call(this,Ad),Ae=Ao.siblings;Ae.splice(As,1);if(Ae.length>1){if(j(Ae)){AI.call(this,AZ,Ad);}else{if(!Aj.f){G(Ae,Aj.l);}}}else{var At=Ae[0],Ac=At&&(At.t===x),Au=At&&At.f;if(Ah){var Ag=Ah.parent,An=H.call(this,Ag),Ai=[];if(Ac){Ai=At.children;if(An){z.call(this,Ag,d(Ag.parentPath).parentPath);}if(Au){var Al=At.ps,Aq;Ai.forEach(function(Av){Av.f=true;if(Al){Aq=Math.round((Av.l/100)*Al);}else{Aq=Av[At.o==="v"?"h":"w"];}Av.l=Aq;});}else{F(Ai).forEach(function(Av){Av.l=Math.round((Av.l/100)*AZ.l);});}}else{Ai.push(At);var AX=U(At.id,Ag.o);if(!An&&AX){Au=At.f=true;}if(Au){At.l=AX;}else{At.l=AZ.l;}}var Am=Ag.children;Am.splice.apply(Am,[Ah.idx,1].concat(Ai));}else{var Aa=this.box;if(Ac){Aa.children=At.children;Aa.o=At.o;if(Au){AI.call(this,Aa);}}else{if(At){delete At.f;At.l=100;}}}}o.call(this,"delete");if(!Ap){K.call(this,true);}else{mstrmojo.all[this.hostId].updateBoxPaths();}},findFloatKey:function l(AY){var AX=AY.k||AY,AW=mstrmojo.all[this.hostId];return AW.getFloatGroupTree&&AW.getFloatGroupTree()&&AW.getFloatGroupTreeNode(AX).node!==undefined;},findIfwKey:function k(AZ){var AX=AZ.k||AZ,AW=mstrmojo.all[this.hostId],AY=X.walk("boxLayoutConfig.box.ifwChildren",AW)||[];if(!AY.length){return false;}return w.find(AY,"k",AX)!==-1;},refreshToolbar:function B(AX){var AW=AX.parent,AY=AW.groupTreeLayoutConfig.getLeafNodeArray(true);AY.forEach(function(AZ){AW.getUnitByKey(AZ.k).generateToolbar();});},beginBoxMove:function i(AY,Ab,AZ){var Aa=this.findFloatKey(Ab),Ac=this.findIfwKey(Ab);if(Aa||Ac){Ab.parent.turnMask();var AW=Ab.parent.parentRect||Ab.domNode.parentNode.getBoundingClientRect();AY.box={initState:this.getBoxState(),boxId:Ab.id,startX:AY.last.x,startY:AY.last.y,originX:parseFloat(Ab.domNode.style.left),originY:parseFloat(Ab.domNode.style.top),minX:AW.left,maxX:AW.right,minY:AW.top,maxY:AW.bottom,parentRect:AW};if(Aa){Ab.preBoxOp();AY.highLight=Ab.createGuidesDiv(AY.box.parentRect);Ab.toggleGuidesDiv(AY.highLight,true);AY.delay=1;AY.floatIndex=Ab.domNode.style.zIndex;}}else{var Ad=D.call(this,this.getBoxPath(Ab)),AX;if(Ad){AX=Ad.box;}N.call(this,false);AY.box={initState:this.getBoxState(),oldPathInfo:Ad,boxId:Ab.id,parentPath:Ad.parentPath,length:AX.l,orientation:Ad.parent.o};if(!AZ){this.deleteBox(Ab,null,true);}}},addDropBox:function A(Ag,Af,Ac){var Ae=(Af==="Right"||Af==="Bottom"),Ai=(Af==="Top"||Af==="Bottom")?AV:Z,Aw=this.identifier,Ab=D.call(this,this.getBoxPath(Ag)),Aj=Ab.idx,Am=Ab.parent,Ap=Ab.siblings,As=Ab.parentPath,At=H.call(this,Am),Al=Am.f,AY=Ac.box,AZ=AY.boxId,Au=mstrmojo.all[AZ],Ao=Au.getBoxConfiguration(),Av=Ao.f&&Ao.f[Ai],Aa=Au.getMinBoxSize(Ai),An=U(Ag.id,Ai),Aq=Ag.getMinBoxSize(Ai),AW=AY.length,AX={t:n,f:!!Av,l:Av,id:AZ,r:!!Ao.r};AX[Aw]=Au[Aw];if(Av&&AY.orientation===Ai){Av=AW;}if(!Av&&At){z.call(this,Am,d(As).parentPath);Al=false;}if(Ai===Am.o){if(Av){if(At){delete AX.f;Av=undefined;}}if(As!==AY.parentPath){AW=undefined;}AX.l=Av||AD(Ap,AW);Ap.splice(Ae?Aj+1:Aj,0,AX);}else{if(Am===this.box&&Ap.length===1){R.call(this,Ai,AX,P(Ae),Av);}else{var Ar=Ab.box,Ah=Ar.f;var Ak={l:Ar.l,f:Ah,o:Ai,t:x};var Ad=Ak.children=[AX,Ar];Ap.splice(Aj,1);if(Ae){Ad.reverse();}if(Al){if(Av){if(An){Am.l=Math.max(Am.l,Av+An);AX.l=Ar.l=50;delete AX.f;delete Ar.f;}else{Am.l=Math.max(Am.l,Av+Aq);AX.l=Av;Ar.l=100;}}else{if(An){AX.l=100;Ar.l=An;Am.l=Math.max(Am.l,Aa+An);}else{Am.l=Math.max(Am.l,Aa+Aq);AX.l=Ar.l=50;}}}else{if(Av&&Ah){Ak.h=Ar.h;Ak.w=Ar.w;AX.l=Av;Ar.l=An;AI.call(this,Ak,As);}else{if(Av){AX.l=Av;Ar.l=100;}else{if(An){Ar.l=An;AX.l=100;if(!Ak.f){Ak.l=AD(Ap,null);}}else{Ar.f=false;Ar.l=100;AX.l=AD([Ar]);}}}}Ap.splice(Aj,0,Ak);}}Au.postDropBox();o.call(this,"drop");N.call(this,true);K.call(this);Ac.dropSuccessful=true;},cancelBoxMove:function p(AX){var AW,AZ=mstrmojo.all[this.hostId].groupTreeLayoutConfig;if(AZ&&AZ.getFloatGroupTree()){AW=AZ.getLeafNodeArray();}if(w.find(AW,this.identifier,(AX.src.widget||[]).k)!==-1){AX.src.widget.parent.turnMask();if(AX.highLight){var AY=AX.src.widget;AY.toggleGuidesDiv(AX.highLight,false);delete AX.highLight;AY.parent.snapGuide.boxIntervalOperations(AY,"insert");}}N.call(this,true);this.revertBoxState(AX.box.initState);},revertBoxState:function AH(AW){X.clear(this.box);X.copy(AW,this.box);K.call(this);},getBoxChildClass:function J(AW){var AY=AW.id,AX=AY&&mstrmojo.all[AY];if(AX){return AX.scriptClass;}return"";},replaceLayoutXmlKeys:function AK(Aa,AZ){var AY=false,AX=mstrmojo.all[this.hostId];var AW=function(Ai){if(!Ai){return ;}var Af=Ai.floatChildren,Ab;if(Af){if(Af.length!==undefined){Ab=Af.length?Af:Ai.children;}else{Ab=AX.groupTreeLayoutConfig.getLeafNodeArray(true);}}else{Ab=Ai.children;}var Ae=Ab&&Ab.length,Ad;for(Ad=0;Ae&&Ad<Ae;Ad++){var Ag=Ab[Ad];switch(Ag.t){case x:AW(Ag);break;case W:case n:var Al=Ag.k,Aj=Aa[Al]||Aa["default"],Ak=mstrApp?mstrApp.primaryScdpMap:null,Ac=(Ak&&Ak[Aj])||[];var Ah=w.indexOf(Ac,Al)!==-1;if(Aj&&!Ah){Ag.k=Aj;AY=true;}break;}}};AW(this.box);AW(AZ);return AY;}});mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes=function(AY,AZ,Aa){var AX=Aa.getBoxChildClass(AY);if(!AX){throw"BoxLayoutConfig::getMinimumChildSizes - unable to obtain script class for box.";}var AW=mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(AX);if(AY.f){AW[AZ]=AY.l;}return AW;};mstrmojo.vi.ui.BoxLayoutConfig.BoxInfoType=null;mstrmojo.vi.ui.BoxLayoutConfig.BoxAddContextType=null;mstrmojo.vi.ui.BoxLayoutConfig.EnumBoxType={BOX_TYPE_BOX:x,BOX_TYPE_CHILD:n,BOX_TYPE_FLOAT_CHILD:W,BOX_TYPE_GROUP:AC};mstrmojo.vi.ui.BoxLayoutConfig.EnumModeHidden=E;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.locales");var e=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var Y;for(Y in F){B[F[Y]]=true;}var c={};c[F.AQ]="a";c[F.AL]="a";c[F.AC]="a";c[F.AE]="a";c[F.MQ]="m";c[F.MC]="m";c[F.F]="f";c[F.R]="r";c[F.XML]="p";c[F.ANDOR]="nds";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];K[F.ANDOR]=["not","node","nds","fn"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},d={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,RECURSIVE_ATTR:3076,CONS:12032,NDE:12033},U={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},W={f:d.FILTER};var X={};X[F.MQ]=N.METRIC;X[F.MC]=N.METRIC;X[F.AQ]=N.ATTR;X[F.AL]=N.ATTR;X[F.AC]=N.ATTR;X[F.AE]=N.ATTR;X[F.F]=N.FILTER;X[F.R]=N.REPORT;var J=function(g){var H=g.length,j={},h;for(h=0;h<H;h++){var k=g[h];j[k.did]=k.n;}return j;},E=function(g){var H=g.length,h;for(h=0;h<H;h++){var f=g[h];if("tp" in f){f.t=f.tp;}}return g;},Z=function(g,j){var H=g.length,h;for(h=0;h<H;h++){var f=g[h];if("tp" in f){if(j){f.t=j;}else{delete f.t;}}}return g;},b=function(f,h){if(!h){h=[];}h.length=0;var g,H;for(g=0,H=f.length;g<H;g++){h[g]=f[g];}return h;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:c,ET2COND:K,ET2TP:X,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158,DESCENDANT:187},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:d,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30,NUMERICALLOWSPERCENTAGE:49},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":d.PROMPT,1:d.PROMPT_LONG,2:d.PROMPT_LONG,3:d.PROMPT_LONG,4:d.PROMPT_DOUBLE,5:d.PROMPT_DOUBLE,6:d.PROMPT_DOUBLE,7:d.PROMPT_DOUBLE,8:d.PROMPT_STRING,9:d.PROMPT_STRING,10:d.PROMPT_STRING,14:d.PROMPT_DATE,15:d.PROMPT_DATE,16:d.PROMPT_DATE,21:d.PROMPT_LONG,22:d.PROMPT_LONG,23:d.PROMPT_STRING,24:d.PROMPT_BOOLEAN,30:d.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(h,g){var i=this.FN,j=this.FN_MRP,H=this.FNT;if(g===H.DEF||g===undefined){switch(h){case i.BETWEEN:case i.NOT_BETWEEN:return 2;case i.IS_NULL:case i.IS_NOT_NULL:return 0;}}else{if(g===H.PER||g===H.RANK){switch(h){case j.BETWEEN:case j.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(g,H){var h=this.FN;return g==h.IN_LIST||g==h.NOT_IN_LIST;},fn_AC_MC:function a(g,H){var h=this.FN;return(g==h.EQUAL)||(g==h.NOT_EQUAL)||(g==h.GREATER)||(g==h.LESS)||(g==h.GREATER_EQUAL)||(g==h.LESS_EQUAL);},fnName:function Q(k,j,f,h){var H=this[M[k]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[h]]||H["*"];}if(k===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var g=e.find(H,"did",(f||1)+this.FN_SEP+j);if(g>-1){return H[g].n;}return"";},findTargets:function I(p,j,s){if(!s){s={};}if(p){var o;for(o in U){var AB=p[o];if(AB){if(!AB[P]){AB[P]=U[o];}if(!AB[G]&&W[o]){AB[G]=W[o];}s[AB[j]]=AB;}}if(p.dmy){var m=this.TP.ATTR,w=this.DMY_TP.ATTR,g=p.dmy.uts,AA,f;for(AA=0,f=(g&&g.length)||0;AA<f;AA++){var n=g[AA];if(n&&n.utp===w){var l=n.utgt;if(!l.t){l.t=m;}s[l[j]]=l;}}}var H=p.nds,q,y;for(q=0,y=(H&&H.length)||0;q<y;q++){this.findTargets(H[q],j,s);}var x=p.cs,z=x&&x.length;if(z){for(q=0;q<z;q++){this.findTargets(x[q],j,s);}}}return s;},onLocaleUpdated:function(){var f=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(f.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=b(Z(f.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":Z(e.filter(f.Metric.concat(f.MetricRP),function(g){return g.did&&(e.find(R["0"],"did",g.did)<0);}))};H.FORM_FNS={0:Z(e.filter(f.Attribute,function(g){return g.did&&(e.find(L["0"],"did",g.did)<0);})),1:Z(e.filter(f.Attribute,function(g){return g.did&&(e.find(L["1"],"did",g.did)<0);})),2:Z(e.filter(f.Attribute,function(g){return g.did&&(e.find(L["0"],"did",g.did)<0)&&(e.find(L["1"],"did",g.did)<0);}))};H.DIMTYLEVELS=b(Z(f.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(i){var g=-1,H=0,f=1,h=2;function j(k){switch(k.t){case N.METRIC:return f;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return k.st===d.CUSTOMGROUP?H:h;case -1:return g;default:return h;}}i=e.map(i||[],function(k){return O.copy(k,{});});return i.sort(function(o,n){var p=j(o)-j(n);if(p){return p;}var m=o.n.toUpperCase(),l=n.n.toUpperCase(),k=m.localeCompare(l);if(k){return k;}return o.n.localeCompare(n.n);});},mapBaseFormTypeToDataType:function C(g){g=parseInt(g);if(g===NaN){return -1;}var f=this.BFTP,H=this.DTP;switch(g){case f.DATETIME:return H.TIMESTAMP;case f.DATE:return H.DATE;case f.TIME:return H.TIME;case f.NUMBER:return H.REAL;case f.TEXT:return H.CHAR;case f.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var Z=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function a(d,h,c){var f=this.parseDate(d,c);var g=!!(f&&this.doesDateExist(f.month,f.day,f.year));if(h){if(g){var e=this.formatDateInfo(f,Z().DATEOUTPUTFORMAT);if(c){return{match:f.match,formatted:e};}return e;}return null;}return !!g;},formatDateInfo:function R(f,h){if(!h){return"";}var c=f.day,g=f.month,e=f.year;var d=h.replace(/dd/g,this.formatInteger(c,2)).replace(/d/g,Number(c)).replace(/yyyy/g,Number(e)).replace(/yy/g,this.formatInteger(Number(e)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,Z().MONTHNAME_FULL[Number(g)-1]).replace(/\~\~\~\~/g,Z().MONTHNAME_SHORT[Number(g)-1]).replace(/\@\@/g,this.formatInteger(g,2)).replace(/\^/g,Number(f.month));return d;},parseDate:function b(n,h,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var c=this.CACHE.PARSEDATE[h?"CONTAINS":"EQUALS"],e=c[n];if(e||(e===null)){return e;}var d=null;var k;if(l){k=[l];}else{k=[].concat(Z().DATEINPUTFORMATS);k.unshift(Z().DATEOUTPUTFORMAT);}var f,g;for(f=0,g=k.length;f<g;f++){var j=this._buildRegExp4DateFormat(k[f]),m=j&&n.match(h?j.reContains:j.reEquals);if(m){d={match:m[0],year:j.yearIndex&&this.fourDigitYear(m[j.yearIndex]),day:j.dayIndex&&parseInt(Number(m[j.dayIndex]),10),month:j.monthIndex&&this.numericMonth(m[j.monthIndex])};break;}}c[n]=d;return d;},isTime:function I(d,g,c){var h=this.parseTime(d,c);var f=!!(h&&this.doesTimeExist(h.hour,h.min,h.sec));if(g){if(f){var e=this.formatTimeInfo(h,Z().TIMEOUTPUTFORMAT);if(c){return{match:h.match,formatted:e};}return e;}return null;}return !!f;},parseTime:function J(o,h,m){if(o==null){return false;}if(typeof o!=="string"){o=String(o);}o=L.trim(o);var c=this.CACHE.PARSETIME[h?"CONTAINS":"EQUALS"],e=c[o];if(e||(e===null)){return e;}var d=null;var l;if(m){l=[m];}else{l=[].concat(Z().TIMEINPUTFORMATS);l.unshift(Z().TIMEOUTPUTFORMAT);}var f,g;for(f=0,g=l.length;f<g;f++){var k=this._buildRegExp4TimeFormat(l[f]),n=k&&o.match(h?k.reContains:k.reEquals);if(n){var j=k.ampmIndex&&n[k.ampmIndex];d={match:n[0],hour:k.hourIndex&&this.capitalHour(n[k.hourIndex],j),min:k.minIndex&&parseInt(Number(n[k.minIndex]),10),sec:k.secIndex&&parseInt(Number(n[k.secIndex]),10)};break;}}c[o]=d;return d;},formatTimeInfo:function S(f,d){if(!d){return"";}var e=!(Number(f.hour)%12)?12:(Number(f.hour)%12),c=d.replace(/HH/g,this.formatInteger(f.hour,2)).replace(/H/g,Number(f.hour)).replace(/hh/g,this.formatInteger(e,2)).replace(/h/g,e).replace(/mm/g,this.formatInteger(Number(f.min)||0,2)).replace(/m/g,Number(f.min)||0).replace(/ss/g,this.formatInteger(Number(f.sec)||0,2)).replace(/s/g,Number(f.sec)||0).replace(/a/g,(Number(f.hour)<12)?Z().AM_NAME:Z().PM_NAME).replace(/tt/g,(Number(f.hour)<12)?Z().AM_NAME:Z().PM_NAME).replace(/AM\/PM/g,(Number(f.hour)<12)?Z().AM_NAME:Z().PM_NAME);return c;},doesTimeExist:function G(i,d,g){var f=parseInt(i,10);if(f>=0&&f<=23){var c=parseInt(d,10);if(c>=0&&c<=59){if(!g){return true;}var e=parseInt(g,10);if(e>=0&&e<=59){return true;}}}return false;},capitalHour:function C(c,d){c=parseInt(Number(c),10);if(d&&(d.match(Z().AM_NAME)||d.match(/AM/i))){return c%12;}if(d&&(d.match(Z().PM_NAME)||d.match(/PM/i))){return 12+(c%12);}return c;},getTimeStamp:function O(){var d=new Date();var c=[d.getMonth()+1,d.getDate(),d.getFullYear()];var g=[d.getHours(),d.getMinutes(),d.getSeconds()];var f=(g[0]<12)?"AM":"PM";g[0]=(g[0]<12)?g[0]:g[0]-12;g[0]=g[0]||12;for(var e=1;e<3;e++){if(g[e]<10){g[e]="0"+g[e];}}return c.join("-")+" "+g.join("")+" "+f;},isDateAndOrTime:function X(c,d){return this.isDateTime(c,d)||this.isDate(c,d)||this.isTime(c,d);},isDateTime:function B(l,c){var g=this.parseDateAndOrTime(l),j=g&&g.date,f=g&&g.time,i=!!j&&!!f&&this.doesDateExist(j.month,j.day,j.year)&&this.doesTimeExist(f.hour,f.min,f.sec);if(c){if(i){var d=this.formatDateInfo(j,Z().DATEOUTPUTFORMAT),e=this.formatTimeInfo(f,Z().TIMEOUTPUTFORMAT),k=l.indexOf(j.match),h=l.indexOf(f.match);return(h<k)?e+" "+d:d+" "+e;}return null;}return !!i;},parseDateAndOrTime:function Q(d,c,h){var e=this.parseDate(d,true,c);var f=L.trim((e&&e.match)?d.replace(e.match,""):d),g=this.parseTime(f,false,h);if(!e&&!g){return null;}return{date:e,time:g};},inDateTimeRange:function P(e,g,j){var d=this.parseDateAndOrTime(e),h=d&&d.date,k=d&&d.time;if(!h&&!k){return 0;}if(g!=null){var f=this.parseDateAndOrTime(g);if(h&&f&&f.date){var l=this.compareDate(h,f.date);if(l<0){return -1;}if(l==0){if(k&&f.time&&(this.compareTime(k,f.time)<0)){return -1;}}}}if(j!=null){var c=this.parseDateAndOrTime(j);if(h&&c&&c.date){var i=this.compareDate(h,c.date);if(i>0){return 1;}if(i==0){if(k&&c.time&&(this.compareTime(k,c.time)>0)){return 1;}}}}return 0;},compareDate:function A(e,c){if(e===c){return 0;}var f=typeof e==="string"?this.parseDate(e):e,d=typeof c==="string"?this.parseDate(c):c;if(!f){return -1;}if(!d){return 1;}return(f.year-d.year)||(f.month-d.month)||(f.day-d.day)||0;},compareTime:function K(d,c){if(d===c){return 0;}var f=typeof d==="string"?this.parseTime(d):d,e=typeof c==="string"?this.parseTime(c):c;if(!f){return -1;}if(!e){return 1;}return(f.hour-e.hour)||(f.min-e.min)||(f.sec-e.sec)||0;},compareDateTime:function W(d,c){return this.compareDate(d,c)||this.compareTime(d,c);},compareDateAndOrTime:function E(j,h){if(j===h){return 0;}var d=typeof j==="string"?this.parseDateAndOrTime(j):j,c=typeof h==="string"?this.parseDateAndOrTime(h):h;if(!d){return -1;}if(!c){return 1;}var i=d.date,g=c.date,f=d.time,e=c.time;return this.compareDate(i,g)||this.compareTime(f,e);},_buildRegExp4DateFormat:function N(e){if(!e){return null;}var g=this.REGEXPS.DATES[e];if(!g){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=Z().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=Z().MONTHNAME_SHORT.join("|");}g=this.REGEXPS.DATES[e]={};g.formatStr=e;var d=g.reStr=e.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");g.reEquals=new RegExp("^"+d+"$");g.reContains=new RegExp("^"+d+"\\b");var h=[{key:"monthIndex",index:e.indexOf("M")},{key:"dayIndex",index:e.indexOf("d")},{key:"yearIndex",index:e.indexOf("y")}];h.sort(function(j,i){return j.index-i.index;});var c=1,f;for(f=0;f<3;f++){g[h[f].key]=h[f].index>-1?c++:null;}}return g;},_buildRegExp4TimeFormat:function F(f){if(!f){return null;}var h=this.REGEXPS.TIMES[f];if(!h){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[Z().AM_NAME,Z().PM_NAME,String(Z().AM_NAME).toLowerCase(),String(Z().PM_NAME).toLowerCase()].join("|");}h=this.REGEXPS.TIMES[f]={};h.formatStr=f;var e=f.replace(/\'\'/g,'"');var j=e.match(/\'(.+?)\'/g);e.replace(/\'(.+?)\'/g,"*");e=e.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var g,c;for(g=1,c=(j&&j.length)||0;g<c;g++){e=e.replace(/\*/,j[g]);}e=e.replace(/\"/g,"'");h.reEquals=new RegExp("^"+e+"$");h.reContains=new RegExp(e);var k=[{key:"hourIndex",index:f.search(/h|H/)},{key:"minIndex",index:f.indexOf("m")},{key:"secIndex",index:f.indexOf("s")},{key:"ampmIndex",index:f.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:f.search(/z|Z/)}];k.sort(function(l,i){return l.index-i.index;});var d=1;for(g=0;g<5;g++){h[k[g].key]=k[g].index>-1?d++:null;}}return h;},doesDateExist:function M(f,c,d){var e=new Date(d,f-1,c);return d==e.getFullYear()&&f==e.getMonth()+1&&c==e.getDate();},fourDigitYear:function U(d){d=parseInt(Number(d),10);if(!isNaN(d)){var c=(Z().TWODIGITYEARSTART%100)||0;if(d>=0&&d<=c){d=2000+d;}else{if(d>c&&d<100){d=1900+d;}}}return d;},numericMonth:function Y(g){var f=parseInt(Number(g),10),e=mstrmojo.array;if(!isNaN(f)){return f;}var c=(g&&g.length)||0,d=-1;if(c){if(c<=3){d=e.indexOf(Z().MONTHNAME_SHORT,g);}if(d===-1){d=e.indexOf(Z().MONTHNAME_FULL,g);}}return d+1;},formatInteger:function H(e,d){var h=String(e),g=Math.max(d-h.length,0);if(g>0){var c=[h],f;for(f=1;f<=g;f++){c.push("0");}h=c.reverse().join("");}return h;},getFirstDateOfMonth:function(d,c){return new Date(d,c-1,1);},getDateObject:function(i,c,h,f,g,e){i=i||0;c=c||1;h=h||1;f=f||0;g=g||0;e=e||0;return new Date(i,c-1,h,f,g,e);},getDateFromDateInfo:function(c){return this.getDateObject(c.date&&c.date.year,c.date&&c.date.month,c.date&&c.date.day,c.time&&c.time.hour,c.time&&c.time.min,c.time&&c.time.sec);},getDateJson:function(c){return{year:c.getFullYear(),month:c.getMonth()+1,day:c.getDate(),hour:c.getHours(),min:c.getMinutes(),sec:c.getSeconds()};},isLeapYear:function(c){return !(c%400)||(!(c%4)&&!!(c%100));},getDaysOfMonth:function(e,c){var d=[31,28,31,30,31,30,31,31,30,31,30,31];if(c==2&&this.isLeapYear(e)){return 29;}return d[c-1];},getPreMonth:function(d,c){if(c===1){return{y:d-1,m:12};}return{y:d,m:c-1};},getNextMonth:function(d,c){if(c===12){return{y:d+1,m:1};}return{y:d,m:c+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMSessionStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMSessionStorage",init:function(B){this._super(B);try{this.mIsSupported=("sessionStorage" in window)&&(window.sessionStorage!==null);this.mStorageObj=this.mIsSupported?window.sessionStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$SS=mstrmojo.global.sessionStore=new mstrmojo.storage.DOMSessionStorage();})();(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMLocalStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMLocalStorage",init:function(B){this._super(B);try{this.mIsSupported=("localStorage" in window)&&(window.localStorage!==null);this.mStorageObj=this.mIsSupported?window.localStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$LS=mstrmojo.global.localStore=new mstrmojo.storage.DOMLocalStorage({itemTimeToLive:(3600*24)});})();(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.gm.GMEnums");var A=mstrmojo.gm.EnumIdentityType;mstrmojo.gm.GMIdentities=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMIdentities"});mstrmojo.gm.HeaderCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.HeaderCellIdentity",eid:undefined,v:undefined,tid:undefined,n:undefined,tui:undefined,fid:undefined,o:undefined,isRowAttribute:undefined,at:undefined,dei:undefined,dpt:undefined});mstrmojo.gm.GeneralIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GeneralIdentity",objType:undefined});mstrmojo.gm.TitleCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TitleCellIdentity",tid:undefined,fid:undefined,n:undefined,tui:undefined,isRowAttribute:undefined,otp:undefined,init:function(B){this.fid=B.fid;this.tid=B.id;this.isRowAttribute=B.isRowAttribute;if(B.isRowAttribute){this.objType=A.ROW_TITLE;}else{this.objType=A.COL_TITLE;}this.n=B.n;this.otp=B.otp;this.ost=B.ost;this.tui=B.tui;}});mstrmojo.gm.MetricAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.MetricAxisTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AttributeAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AttributeAxiTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AxisIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AxisIdentity",isNumericAxis:undefined,metricIdxArr:undefined,attrIdArr:undefined});mstrmojo.gm.ColorSquareIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.ColorSquareIdentity",init:function(B){this._super(B);this.comb=this.getElementsCombination();},getElementsCombination:function(){var B,F=this.token,C,H,G,E,I,D;if(F){D=[];C=F.levels;H=F.elements;G=F.types;B=C.length;for(E=0;E<B;E++){I={eid:H[E],tid:C[E]};if(G){I.tp=G[E];}D.push(I);}return D;}return undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array","mstrmojo.hash");var I=mstrmojo,G=I.array,E=I.hash,A="00000000000000000000000000000000",F=-1;function K(L){return L&&L.t===4&&L.id!==A;}function H(M){var L,N=(M&&M.length)||0;if(N===0){return false;}for(L=0;L<N;L++){if(!K(M[L])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function J(L){},isMetric:function(L){return K(L);},isMetricZone:function(L){return H(L);},getMetricCountInZone:function D(M){var L=0;G.forEach(M,function(N){if(K(N)){L++;}});return L;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(L){return(parseInt(L.did,10)===F)||(L.id===A)||(L.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(U){if(!U||!U.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var X=23242571;var R=-693593;if(U.ifTime>X){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}else{if(U.ifTime>0){var Y=this.DAYSToYMD(Math.floor(U.ifTime));this.mnYear=Y.year;this.mnMonth=Y.month;this.mnDay=Y.day;S=U.ifTime-Math.floor(U.ifTime);}else{if(U.ifTime<0){var Y=this.DAYSToYMD(Math.ceil(U.ifTime));this.mnYear=Y.year;this.mnMonth=Y.month;this.mnDay=Y.day;S=Math.abs(U.ifTime)+Math.ceil(U.ifTime);}}}}S*=H;var W=S+0.5;if(W==H){W--;}if(W>0){this.mnHour=Math.floor(W/A);W-=this.mnHour*A;this.mnMinute=Math.floor(W/L);W-=this.mnMinute*L;this.mnSecond=Math.floor(W/C);W-=this.mnSecond*C;this.mnMillisecond=Math.floor(W);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var U=(S-R*H)/H;if(U<0){R--;U+=1;}return R>=0?R+U:R-U;},DAYSToYMD:function N(U){var Y=0;var a=0;var S=0;U+=693959;var X=Math.floor(U/365);var W=U-X*365;var Z=Math.floor(X/4)-Math.floor(X/100)+Math.floor(X/400);W=W-Z;if(W<0){X--;W+=365;while(W<=0){X--;W+=365;}}var R=U-(X*365+Math.floor(X/4)+(X%4?1:0)-Math.floor((X-1)/100)+Math.floor((X-1)/400));if(R==365&&!this.IsLeapYear(X)){Y=X+1;a=1;S=1;return{year:Y,month:a,day:S};}if(R==-1){Y=X-1;a=12;S=31;return{year:Y,month:a,day:S};}Y=X;a=12;while(R<B.DaysBeforeMonth[a-1]){a--;}S=R-B.DaysBeforeMonth[a-1]+1;if(a>2&&this.IsLeapYear(Y)){S--;if(S==0){a--;S=B.DaysInMonth[a-1];if(a==2){S++;}}}return{year:Y,month:a,day:S};},YMDToDAYS:function G(W,U,S){if(U<1||U>12){return 0;}var R=W*365+Math.floor(W/4)+(W%4?1:0)-Math.floor((W-1)/100)+Math.floor((W-1)/400);R+=B.DaysBeforeMonth[U-1];if(U>2&&this.IsLeapYear(W)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var J=mstrmojo.validation,C=J.TRIGGER,g=J.STATUSCODE,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5,49:7};J.VALIDATOR={DEMO:function Q(j){var i=parseInt(j,10),k=mstrmojo.validation.STATUSCODE;if(i===0||i===1||i>10){return{code:k.VALID};}return{code:k.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function L(i){var j=String(i).replace(/[^\d]/g,"");if(j.length<10){return{code:g.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!J.REGEXP.PHONE_NUMBER.test(i)){return{code:g.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:g.VALID};},VALIDATE_ZIPCODE:function I(i){var k="",j=this.dtp;if(!J.REGEXP.US_ZIP.test(i)){if(J.isNumeric(j)||J.isInt(j)){k=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(J.isString(j)){k=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:g.INVALID,msg:k};}return{code:g.VALID};},VALIDATE_EMAIL:function Y(i){var j=i.indexOf("@");if(j===-1){return{code:g.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(i.substring(j).indexOf(".")===-1){return{code:g.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return J.REGEXP.EMAIL_ADDRESS.test(i)?{code:g.VALID}:{code:g.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function U(i){var k=this.dtp,j;if(J.isNumeric(k)||J.isInt(k)){j=String(i).replace(/[^\d]/g,"");if(j.length!==9){return{code:g.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(i)){return{code:g.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:g.VALID};}};J.isInt=function F(i){return B[i]===1;};J.isNumeric=function d(i){return B[i]===2||B[i]===5;};J.isEnhNumeric=function K(i){return B[i]===7;};J.isString=function M(i){return B[i]===3;};J.isDateTime=function A(i){return B[i]===6;};var E=window.mstrConfig,P=E.listSep,X=mstrmojo.expr,O=X.DTP,e=mstrmojo.num,Z=mstrmojo.string,H=mstrmojo.date;function S(q,s){var n=q.dtp,p=q.constraints,u=p.allowedFormatChars||"",l=J.isInt(n),i=J.isNumeric(n),m=J.isEnhNumeric(n),j=J.isDateTime(n),t=mstrmojo.locales.number.THOUSANDSEPARATOR,k=mstrmojo.locales.number.DECIMALSEPARATOR,o;if(l){if(!q._intRegExp){u+="0-9-"+(q.isList?P:"")+t;q._intRegExp=new RegExp("[^"+u+"]");}o=q._intRegExp;}if(i){if(!q._numericRegExp){u+="0-9-#"+(q.isList?P:"")+k+t;q._numericRegExp=new RegExp("[^"+u+"]");}o=q._numericRegExp;}if(m){if(!q._percentageRegExp){u+="0-9-#"+(q.isList?P:"")+k+t+"%";q._percentageRegExp=new RegExp("[^"+u+"]");}o=q._percentageRegExp;}return !!o&&o.test(s);}function h(s,u){var o=s.dtp,q=s.constraints,l=J.isInt(o),i=J.isNumeric(o),m=J.isEnhNumeric(o),j=J.isDateTime(o),k=q.min,t=q.max,p;if(k===undefined&&t===undefined){return false;}if(l||i){if(e.isBigDecimal(u)){return e.inNumericRange(e.parseBigDecimal(u),k,t)!==0;}return e.inNumericRange(u,k,t)!==0;}if(j){return H.inDateTimeRange(u,k,t)!==0;}if(m){var n=e.toLocaleString(e.parseEnhNumeric(u));k=e.parseEnhNumeric(e.toLocaleString(k));t=e.parseEnhNumeric(e.toLocaleString(t));return e.inNumericRange(n,k,t)!==0;}return false;}function N(j,i){return !e.isNumeric(i)&&!e.isBigDecimal(i);}function D(j,i){return !e.isNumeric(i,true);}function W(l,j){var k=(l.dtp===O.DATE),i=(l.dtp===O.TIME);return(k?!H.isDate(j):(i?!H.isTime(j):!H.isDateAndOrTime(j)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:O.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function b(i){this._super(i);if(!this.constraints){this.constraints={};}var j=this.constraints;if(!j.hasOwnProperty("trigger")){j.trigger=C.NONE;}},_set_value:function(o,k){var l=this.value,j=(l!==k);if(j){this.value=k;var m=this.constraints.trigger,i=(m&C.VALUESET)>0;if(i){this.validate(k);}}return j;},validate:function R(){var l=(this.value!==null&&this.value!==undefined)?this.value:"",o=this.isList?l.split(P):[l],n,k,p,j=o.length,m;for(m=0;m<j;m++){n=this.doValidation(o[m]);k=(n.code>g.VALID);if(k){if(j>1){n.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",o[m]||" ");}break;}}p=k?"onInvalid":"onValid";if(!k&&this.autoFormat){this.format();}this.set("validationStatus",n);if(this[p]){this[p](n);}},format:function c(){var o=this.dtp,l=J.isDateTime(o);if(!l){return ;}var q=mstrConfig.listSep,u=this.value||"",k=this.isList?u.split(q):[u],t=o===14,s=[],j,m=mstrmojo.locales.datetime,p=k.length,n;for(n=0;n<p;n++){u=k[n];j=H.parseDateAndOrTime(u);if(j){if(t&&j.date){s.push(H.formatDateInfo(j.date,m.DATEOUTPUTFORMAT));}else{s.push((j.date?H.formatDateInfo(j.date,m.DATEOUTPUTFORMAT):"")+" "+(j.time?H.formatTimeInfo(j.time,m.TIMEOUTPUTFORMAT):""));}}}this.set("value",s.join(q));},isValid:function a(){var i=this.validationStatus;if(!i){this.validate();}return this.validationStatus.code===g.VALID;},clearValidation:function f(){this.set("validationStatus",{code:g.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function G(x){var t=this.constraints,u=t.regExp,k=t.validator,i={id:this.id,code:g.VALID,msg:""},s=this.dtp,p=J.isInt(s),j=J.isNumeric(s),q=J.isEnhNumeric(s),l=J.isString(s),m=J.isDateTime(s),o=Z.isEmpty(x),w=String(x).length,n="",z=mstrmojo.locales.validation;if(this.required&&o){i.code=g.INVALID_EMPTY;i.msg=z.requiredFieldError;return i;}x=Z.trim(x);if(!o&&S(this,x)){if(p){n=z.integerDataType;}if(j){n=z.numericDataType;}if(m){n=z.dateDataType;}i.code=g.INVALID_CHAR;i.msg=z.invalidCharError.replace("#",n);return i;}if(!o&&m&&W(this,x)){i.code=g.INVALID_BAD_DATESTRING;i.msg=z.invalidDateStringError;return i;}if(!o&&(j||p)&&N(this,x)){i.code=g.INVALID_BAD_NUMERICFORMAT;i.msg=z.invalidNumericFormatError;return i;}if(!o&&q&&D(this,x)){i.code=g.INVALID_BAD_NUMERICFORMAT;i.msg=z.invalidNumericFormatError;return i;}if(!o&&(p||j||m||q)&&h(this,x)){i.code=g.INVALID_OUTOFRANGE;if(t.min!==null&&t.max!==null){n=z.outofRangeError.replace("# ","").replace("##",e.toLocaleString(t.min)).replace("###",e.toLocaleString(t.max));}else{if(t.min!==null){n=z.noLessMinError.replace("##",e.toLocaleString(t.min)).replace("# ","");}else{if(t.max!==null){n=z.noGreaterMaxError.replace("###",e.toLocaleString(t.max)).replace("# ","");}}}i.msg=n;return i;}if(l&&t.minLen!==null&&t.maxLen!==null){if(w<t.minLen||w>t.maxLen){i.code=g.INVALID;i.msg=mstrmojo.desc(9211).replace(/#/,t.minLen).replace(/##/,t.maxLen);return i;}}if(u&&!u.test(x)){i.code=g.INVALID_REGEX;i.msg=mstrmojo.desc(9205);return i;}var y=k&&k.apply(this,[x]);if(y){i.code=y.code;i.msg=y.msg;return i;}return i;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.expr","mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(308,5923,7930,5282,5283,2793,2787,2788,12298);var D=mstrmojo.string,S=mstrmojo.expr,M=S.ET,L=mstrmojo.array,R=mstrmojo.hash;var W=S.FN,K=S.BRANCH_FNS[W.NOT],a=mstrmojo.mstr.EnumDSSXMLObjectTypes,H=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,N=mstrmojo.mstr.EnumDSSConsolidationType;function C(b){return D.htmlAngles(b)||"";}var A={betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),andText:mstrmojo.desc(5282,"AND"),orText:mstrmojo.desc(5283,"OR"),boldandText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5282,"AND")+"</span>",boldorText:"<span style='font-weight:bold;'>"+mstrmojo.desc(5283,"OR")+"</span>",whereText:mstrmojo.desc(2793,"Where (##)"),notText:mstrmojo.desc(12298,"NOT")};var Z={"*":function(c,b){return{html:c?('<span class="mstrmojo-unknown">'+(C(c.n||c.xml)||"...")+"</span>"):null,text:c?(C(c.n||c.xml)||"..."):null};}};function X(b){return !!b.not||b.fn===W.NOT_EQUAL||b.fn===W.NOT_IN_LIST||b.fn===W.NOT_BETWEEN||b.fn===W.NOT;}function I(b){if(b&&b.not){return{html:'<span class="mstrmojo-text mstrmojo-not">'+K+"</span>",text:K+" "};}return{html:"",text:""};}function U(d,c){var b=d&&((c?'<span class="mstrmojo-ListIcon t'+c+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+C(d)+"</span>");return{html:b,text:d&&((c?c+" ":"")+C(d))};}function Q(b,d){var c=d&&d.trim().split(" ")||[];if(b.t===a.Attribute&&b.st===H.AttributeRecursive){c.push("recursive");}else{if(b.t===a.Consolidation&&b.st===H.ConsolidationManaged){c.push("derived");if(b.ndetype===N.DssRecursiveDerivedElement){c.push("recursive");}}}return c.join(" ");}function G(c,b){var d=C(c.n);return{html:'<span class="mstrmojo-text mstrmojo-attr '+Q(c,b)+'">'+d+"</span>",text:d};}Z[M.R]=function(c,b){return U(c.r&&c.r.n,c.r&&c.r.t);};Z[M.F]=function(c,b){return U(c.f&&c.f.n,c.f&&c.f.t);};Z[M.XML]=function(c,b){return U(c.n||c.p&&c.p.n||c.xml,c.p&&c.p.t);};Z[M.AE]=function(q,g){var n=[],m=[],f=(g&&g.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")";if(q&&q.a&&q.a.n){var c=G(q.a);n.push(c.html);m.push("{"+c.text+"}");var b=C(S.fnName(q.et,q.fn,q.fnt));n.push('<span class="mstrmojo-text mstrmojo-fn">'+b+"</span>");m.push(" "+b+" ");var s=q.es,i=s&&s.length||0;if(i){n.push('<span class="mstrmojo-elems">');m.push("[");var j=n.length,p="";for(var o=0;o<i;o++){n[j++]='<span class="mstrmojo-text mstrmojo-elem">';p=C(s[o].n);n[j++]=p;m.push(p);if(o<i-1){n[j++]=", ";m.push(", ");}n[j++]="</span>";}n[j++]="</span>";m.push("]");}else{n.push('<span class="mstrmojo-text mstrmojo-emptyelems">'+f+"</span>");m.push(f);}}return{html:n.join(""),text:m.join("")};};Z[M.AQ]=function(y,AA){var w=[],k=[];if(y&&y.a&&y.a.n){var f=G(y.a);w.push(f.html);k.push("{"+f.text+"}");if(y.fm&&y.fm.n){var AB=C(y.fm.n);w.push('<span class="mstrmojo-text mstrmojo-form">'+AB+"</span>");k.push("("+AB+")");if(y.fn!=null){var l=C(S.fnName(y.et,y.fn,y.fnt,y.fm.dtp));w.push('<span class="mstrmojo-text mstrmojo-fn">'+l+"</span>");k.push(" "+l+" ");var m=S.fnCstCount(y.fn,y.fnt);if(y.et===M.AC){if(m>=1){if(y.a2&&y.a2.n){var q=C(y.a2.n);w.push('<span class="mstrmojo-text mstrmojo-attr2">'+q+"</span>");k.push("{"+q+"}");if(y.fm2&&y.fm2.n){var x=C(y.fm2.n);w.push('<span class="mstrmojo-text mstrmojo-form2">'+x+"</span>");k.push("("+x+")");}}if(m>1){w.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");k.push(" "+A.betweenText+" ");if(y.a3&&y.a3.n){var c=C(y.a3.n);w.push('<span class="mstrmojo-text mstrmojo-attr3">'+c+"</span>");k.push("{"+c+"}");if(y.fm3&&y.fm3.n){var e=C(y.fm3.n);w.push('<span class="mstrmojo-text mstrmojo-form3">'+e+"</span>");k.push("("+e+")");}}}}}else{if(y.et===M.AL){var b=y.cs||[],g=[];for(var s=0,u=b.length;s<u;s++){g.push(C(b[s].v));}var o=g.join(mstrConfig.listSep);w.push('<span class="mstrmojo-text mstrmojo-c1">'+o+"</span>");k.push("["+o+"]");}else{if(m>=1){var b=y.cs,p=b&&b[0];var z=C(p&&p.p&&p.p.n||p&&p.v);w.push('<span class="mstrmojo-text mstrmojo-c1">'+z+"</span>");k.push(z);if(m>1){var n=b&&b[1];w.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");k.push(" "+A.betweenText+" ");var j=C(n&&n.p&&n.p.n||n&&n.v);w.push('<span class="mstrmojo-text mstrmojo-c1">'+j+"</span>");k.push(j);}}}}}}}return{html:w.join(""),text:k.join("")};};Z[M.AC]=Z[M.AQ];Z[M.AL]=Z[M.AQ];Z[M.MQ]=function(z,AA){var y=[],n=[],s=z&&z.m,AC=s&&s.n;if(AC){var c=z.fnt,i=S.FNT.PER,x=S.FNT.RANK;AC=c===i?mstrmojo.desc(2787,"Percentage of ##").replace("##",AC):c===x?mstrmojo.desc(2788,"Rank of ##").replace("##",AC):AC;y.push('<span class="mstrmojo-text mstrmojo-metric">'+C(AC)+"</span>");n.push(C(AC));if(z.fn!=null){var o=C(S.fnName(z.et,z.fn,c,S.DTP.REAL));y.push('<span class="mstrmojo-text mstrmojo-fn">'+o+"</span>");n.push(" "+o+" ");var p=S.fnCstCount(z.fn,c);if(z.et==S.ET.MC){if(p>=1){var AB=(z.m2&&z.m2.n)||(z.c2&&z.c2.v)||"?";y.push('<span class="mstrmojo-text mstrmojo-m2">'+C(AB)+"</span>");n.push(C(AB));if(p>1){y.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");var f=(z.m3&&z.m3.n)||(z.c3&&z.c3.v)||"?";y.push('<span class="mstrmojo-text mstrmojo-m3">'+C(f)+"</span>");n.push(C(f));}}}else{if(p>=1){var e=z.cs,t=e&&e[0];var b=function(h){var d=h.v;if(z.fnt==i){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};var l=C(t&&t.p&&t.p.n||t&&t.v&&b(t));y.push('<span class="mstrmojo-text mstrmojo-c1">'+l+"</span>");n.push(l);if(p>1){var q=e&&e[1],m=C(q&&q.p&&q.p.n||q&&q.v&&b(q));y.push('<span class="mstrmojo-text mstrmojo-btwn">'+A.betweenText+"</span>");n.push(" "+A.betweenText+" ");y.push('<span class="mstrmojo-text mstrmojo-c2">'+m+"</span>");n.push(m);}}}var w=z.dmy&&z.dmy.uts,k=w&&w.length;if(k){y.push('<span class="mstrmojo-text mstrmojo-at">'+A.atText+"</span>");n.push(" "+A.atText+" ");y.push('<span class="mstrmojo-dmy">');for(var j=0;j<k;j++){var g=w[j];y.push('<span class="mstrmojo-text mstrmojo-dmyunit">');y.push(C(g.utgt?g.utgt.n:g.n));n.push(C(g.utgt?g.utgt.n:g.n));if(j<k-1){y.push(",");n.push(",");}y.push("</span>");}y.push("</span>");}}}return{html:y.join(""),text:n.join("")};};Z[M.MC]=Z[M.MQ];Z[M.ANDOR]=function(l,e){var j=[],i=[],c=(e&&e.elemsEmpty)||"("+mstrmojo.desc(2210,"Empty")+")",f=R.valarray(S.findTargets(l,"did"))[0],g=true;function m(d){if(!g){j.push('<span class="spliter"></span>');i.push(", ");}g=false;if(d){i.push(mstrmojo.desc(12298,"NOT")+" ");}}if(!f){return{html:'<span class="mstrmojo-text mstrmojo-emptyelems">'+c+"</span>",text:c};}var b=G(f,"andor");j.push(b.html);i.push("{"+b.text+"}");j.push("<span>:</span>");i.push(" : ");j.push('<span class="mstrmojo-elems">');i.push("[");L.forEach(l.nds,function k(n){if(!n){return ;}var d=X(n),u=n.fm,q=n.cs,o,s,h,p;switch(n.et){case M.ANDOR:L.forEach(n.nds,k);break;case M.AE:switch(n.fn){case W.IN_LIST:case W.NOT_IN_LIST:L.forEach(n.es,function(w){m(d);o=d?" not":"";s=C(w.n);j.push('<span class="mstrmojo-text mstrmojo-elem single'+o+'">'+s+"</span>");i.push(s);});break;case W.DESCENDANT:var t=(n.es||[]).slice();if(t.length===0){t.push({n:c});}L.forEach(t,function(x){m(d);o=d?" not":"";s=C(x.n);if(q&&q[0]){var w;p=q[0].v;if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}w=h+" "+mstrmojo.desc(12853,"of")+" "+s;j.push('<span class="mstrmojo-text mstrmojo-elem level'+o+'">');j.push(w);i.push(w);}else{j.push('<span class="mstrmojo-text mstrmojo-elem descendant'+o+'">');j.push(C(x.n));i.push(s);}j.push("</span>");});break;}break;case M.AQ:L.forEach(n.cs,function(w){m(d);o=d?" not":"";p=w.v;h=(u&&u.n)?C(u.n+" "+p):"";if(u&&u.n==="LEVEL_NUMBER"){o+=" level";if(isNaN(p)){h=p.substr(p.indexOf(";")+1);}else{h=mstrmojo.desc(493,"Level")+" "+(parseInt(p,10)+1);}}j.push('<span class="mstrmojo-text mstrmojo-elem constant'+o+'">'+h+"</span>");i.push(h);});break;}});j.push("</span>");i.push("]");return{html:j.join(""),text:i.join("")};};function O(g,f){var d=Z[g&&g.et]||Z["*"],c=I(g),e=d&&d(g,f),b=f&&f.emptyText||A.emptyText;return{html:c&&c.html+((e&&e.html)||('<span class="mstrmojo-text empty-cond">'+b+"</span>")),text:c&&c.text+((e&&e.text)||b)};}function F(b){return O(b).text;}function J(g,f,d){if(!g){return null;}var p=g.et,m=g.fn,c=g.nds;if(p===M.ANDOR){var q=d?"bold":"",b=m===W.AND?A[q+"andText"]:(m===W.OR?A[q+"orText"]:"");c=[].concat(c);if(c.length<1){return null;}var l=[],s;L.forEach(c,function(t){s=J(t,false,d);if(s){l.push(s);}});var o,n=l.length;if(n<1){return null;}else{if(n===1){o=l[0];}else{o=l.join(" "+b+" ");}}o=f||g.not?o:"("+o+")";return g.not?A.notText+" "+o:o;}else{if(p===M.RLS){var k=g.dmy&&g.dmy.uts||[],i=[],h;L.forEach(k,function(t){i.push("{"+t.n+"}");});h=i.join(", ");var e=g.nds&&g.nds[0],j=J(e,false,d);if(j){return"("+h+" "+A.whereText.replace(/\(##\)/g,"").replace(/'##'/g,"")+j+")";}return null;}else{return F(g);}}}function B(b){if(mstrmojo.fe.FilterUtils.isExprEmpty(b)){return{et:14,fn:19};}else{((b&&b.nds)||[]).forEach(function(d,c){b.nds[c]=B(d);});return b;}}mstrmojo.fe.FilterUtils=mstrmojo.provide("mstrmojo.fe.FilterUtils",{getExprXml:function(h){var c="<exp>",b="</exp>",f={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,conid:true,desc:true,did:true,attId:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true,relation:true,applySubExpr:true,useSchema:true,guide:true,rsTp:true,joTp:true,paTp:true,erTp:true,exp:true,joAttrs:true,ph:true,idx:true,idc:true,idcsi:true,ucfg:true,node:true},e={getArrItemName:function(i){return i.substr(0,i.length-1);},isSerializable:function(t,q,p){if(t==="xml"){var k=q[p].xml;return{att:'hasXML = "-1"',child:k};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],t)>-1){var u=q[p][t];if(!u){return{};}var m="<"+t+">";for(var s in u){m+="<prs n='"+s+"'>";var l=u[s];for(var i in l){var o=l[i];m+="<pr n='"+i+"' v='"+(o==="pru"?"":o)+"'";m+=o==="pru"?' pru="1"':"";m+="/>";}m+="</prs>";}m+="</"+t+">";return{child:m};}else{if(t==="cs"){var j=q[p],n=q[p][t];if(j&&j.fnt&&j.fnt==S.FNT.PER&&n){if(n[0]){n[0].v+="%";}if(n[1]){n[1].v+="%";}}return true;}else{if(t==="c2"||t==="c3"){var j=q[p];if(j&&j.et==S.ET.MC&&(j.fn==S.FN.BETWEEN||j.fn==S.FN.NOT_BETWEEN)){return true;}else{return false;}}}}}return(f[t])?true:false;},skipNull:true},d=B(h);if(!d||d.et!=M.ANDOR||d.fn===W.NOT||d.not){d={et:M.ANDOR,fn:S.FN.AND,nds:d?[d]:[]};}var g=D.json2xml("nd",[{},d],e);return c+g+b;},isExprEmpty:function(b){return(!b||(b.et===M.ANDOR&&(b.nds||[]).length<1));},getExprConditionNodeHtml:function E(b){return O(b).html;},getExprConditionNodeText:function F(b){return O(b).text;},getExprNodeHtmlAndText:function P(c,b){return O(c,b);},getExprText:function Y(c,b){return J(c,true,b);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.vi.util.TemplateUtils");var F=mstrmojo.array,E=mstrmojo.expr,D=E.ET,B=mstrmojo.vi.util.TemplateUtils;function C(J,H,L){var I=L&&B.findUnitsById(L,[J.did]),G=I&&!!I.length&&I[0].n,K;if(G&&!!G.length){return G;}else{K=H.findUnitNameInDataSetFromUnit(J.did);return !!K?K:J.n;}}mstrmojo._HasItemAliases=mstrmojo.provide("mstrmojo._HasItemAliases",{_mixinName:"mstrmojo._HasItemAliases",adjustItemName:function A(I,G,J){var H=this;if(!I||!G){return ;}if(I.a&&I.a2){I.a.n=C(I.a,G,J);I.a2.n=C(I.a2,G,J);}else{if(I.a){I.a.n=C(I.a,G,J);}else{if(I.m&&I.m2){I.m.n=C(I.m,G,J);I.m2.n=C(I.m2,G,J);}else{if(I.m){I.m.n=C(I.m,G,J);}else{if(I.et===D.ANDOR){F.forEach(I.nds,function(K){H.adjustItemName(K,G,J);});}else{if(I.n!==undefined&&I.did){I.n=C(I,G,J);}}}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" mstrevent="click" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" mstrevent="click" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxLayoutConfig");mstrmojo.vi.ui._SupportLayerNode=mstrmojo.provide("mstrmojo.vi.ui._SupportLayerNode",{_mixinName:"mstrmojo.vi.ui._SupportLayerNode",selectFromLayer:mstrmojo.emptyFn,renameFromLayer:mstrmojo.emptyFn,deleteFromLayer:mstrmojo.emptyFn,formatFromLayer:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(!K){return ;}if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var C=mstrmojo.css,J=mstrmojo.dom,S=mstrmojo.array,U={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},D="scrollingMode",k="scrolling",i=3;var e=J.isMac();function H(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function f(m,n){return(typeof this.getScrollDimension==="function"&&this.getScrollDimension(m))||n;}function l(q,n){var p=this.scrollNode,m=H.call(this),o={v:q,h:n};S.forEach(["v","h"],function(t){var s=U[t];C.toggleClass(m,s.hostCls,o[t]);C.toggleClass(p,s.scrollNodeCls,o[t]);});}function c(n,m){var t=J.eventTarget(m,n),q=this.scrollNode,p=J.position(q),s=this.scrollTrackNodes,o=this.scrollBarNodes,u=function u(AD){var AB=t===s[AD];if(AB){var AE=U[AD],w=o[AD],AF=J.position(w),y=J.getMousePosition(n,m)[AE.position],z=y-AF[AE.position],x=z>0?1:-1,AC=f.call(this,AD,q[AE.scrollDimension]),AG=Math.abs(z-(AF.h/2))*(AC/p[AE.dimension]),AA={};AA[AE.scroll]={isStyle:false,start:q[AE.scroll],stop:q[AE.scroll]+(x*Math.min(AC/3,500,AG)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:AA,duration:200,interval:10,target:q})).play();}};u.call(this,"h");u.call(this,"v");}function h(n,m){var q=this.scrollNode,p=n.type==="mousewheel",o=p?-1:1;mstrmojo.array.forEach(["h","v"],function(z){var x=U[z],t=p?"wheelDelta":"delta",w=n[t+{h:"X",v:"Y"}[z]]*o,u=Math.abs(w),s=w/u,y=u===3&&J.isFF&&!e;q[x.scroll]+=y?s*40:w;});J.stopPropogation(m,n);J.preventDefault(m,n);}function I(s){var q=U[s],p=this.scrollNode,o=J.position(p),n=o[q.dimension],t=f.call(this,s,p[q.scrollDimension]),m=Math.ceil(n)/t;return Z(m,n,t);}function Z(n,m,o){return(!isNaN(n)&&n<1)&&(Math.abs(m-o)>i);}function Q(AM){var AF="px",y=U[AM],q=this.scrollNode,z=H.call(this),AO=J.position(q),AA=AO[y.dimension],AH=f.call(this,AM,q[y.scrollDimension]),p=Math.ceil(AA)/AH,AL=this.scrollBarNodes,w=AL[AM],AD=this.scrollTrackNodes,AE=AD[AM],AJ=Z(p,AA,AH),s=y.cls;if(!w){AE=AD[AM]=document.createElement("div");var t=this,AC=function(AQ){c.call(t,AQ);},x=function(AQ){h.call(t,AQ);},AI=function(AS,AQ,AR){J.attachEvent(AS,AQ,AR);t.installedEventListeners.push({e:AS,evt:AQ,fn:AR});};AI(AE,"click",AC);AE.className="mstrmojo-scrolltrack "+s;w=AL[AM]=document.createElement("div");w.className="mstrmojo-scrollbar "+s;AE.appendChild(w);z.appendChild(AE);var AK=mstrApp.isSingleTier?"mousewheel":"wheel";AI(AE,AK,x);AI(w,AK,x);}var AP=w.style,u=(q[y.scroll]/f.call(this,AM,q[y.scrollDimension])),n=J.delta(q,H.call(this))[y.position],AG=AE.style;if(AJ){AG[y.styleDir]=n+AF;AG[y.styleDim]=AO[y.dimension]+AF;var o=p*AA,AB=35,AN=AA*u,m=AA-35;AP[y.styleDim]=(o<AB?AB:o)+AF;AP[y.styleDir]=(AN>m?m:AN)+AF;}return AJ;}function R(){return !(mstrApp.isSingleTier&&e);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function g(m){this._super(m);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=R();}this.installedEventListeners=[];},onRender:function B(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function P(){var n=this.scrollNode,o=J.isFF&&!e;if(n){var m=J.attachMarkupEvent(this.id,n,"scroll");this.installedEventListeners.push({e:n,evt:"scroll",fn:m});}if(o){C.addClass(n,"firefox-on-windows");}else{if(J.isEdge){C.addClass(n,"ms-edge");}}if(!this.hasCustomScrollbar){C.addClass(H.call(this),"mstrmojo-sb-host-show-default");C.addClass(n,"mstrmojo-sb-show-default");return ;}if(n){C.addClass(H.call(this),"mstrmojo-scrollbar-host");C.addClass(n,"mstrmojo-scrollNode");}},updateScrollbars:function d(){if(!this.hasRendered){return ;}this.setupScrollNodes();var m,o=false;if(!this.hasCustomScrollbar){if(this.scrollNode){m=this.scrollNode.style;m.overflowY=I.call(this,"v")?"scroll":"hidden";m.overflowX=I.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};l.call(this,o,o);m=this.scrollNode.style;var p=Q.call(this,"v"),n=Q.call(this,"h");m.overflowY=p?"scroll":"hidden";m.overflowX=n?"scroll":"hidden";l.call(this,p,n);}},addNoSwipeClass:function N(){if(J.isTouchOptimizationEnabled()&&this.hasRendered&&this.scrollNode&&I.call(this,"h")){C.addClass(this.domNode,"mstrmojo-no-swipe");}},onscroll:function b(){var q=this.scrollNode;if(q&&this.hasCustomScrollbar){var z=function z(AA){var AB=parseInt(AA);return AB===null||isNaN(AB)?0:AB;},x=J.position(q),w=x.h-z(C.getStyleValue(q,"padding-bottom")),o=x.w-z(C.getStyleValue(q,"padding-right")),p=f.call(this,"h",q.scrollWidth),y=f.call(this,"v",q.scrollHeight),s=y-w,m=p-o,n=this.scrollBarNodes,t=n.v,u=n.h;if(s>0){t.style.top=((w-J.position(t).h)*(q.scrollTop/(s)))+"px";}if(m>0){if(this.isRTL){u.style.right=((J.position(u).w-o)*(q.scrollLeft/(m)))+"px";}else{u.style.left=((o-J.position(u).w)*(q.scrollLeft/(m)))+"px";}}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function W(n){var q=this.scrollNode,p=J.position(q),o=n.src.node,m=this.scrollBarNodes;if(this.isDraggingScrollBar(n)){return{isScrollBar:true,direction:o===m.v?"v":"h",scrollTop:q.scrollTop,scrollLeft:q.scrollLeft,conversionRatio:{y:q.scrollHeight/p.h,x:q.scrollWidth/p.w}};}return(this._super&&this._super(n));},isDragValid:function O(m){return this.isDraggingScrollBar(m)||(this._super&&this._super(m))||false;},isDraggingScrollBar:function X(n){var o=n.src.node,m=this.scrollBarNodes;return !!m&&(o===m.v||o===m.h);},ondragstart:function Y(m){if(this.isDraggingScrollBar(m)){C.addClass(m.src.node,k);C.addClass(H.call(this),D);}if(this._super){this._super(m);}},shouldDragBubble:function F(m){var n=m.src.node,o=this.scrollTrackNodes;return !(!!o&&(n===o.v||n===o.h));},ondragmove:function G(n){if(this.isDraggingScrollBar(n)){var x=n.tgt,m=n.src,y=x.pos,o=m.pos,t=m.node,s=this.scrollNode,w=this.scrollBarNodes,u=m.data,q={y:(y.y-o.y),x:(y.x-o.x)},p=u.conversionRatio;if(t===w.v){s.scrollTop=u.scrollTop+(q.y*p.y);}else{s.scrollLeft=u.scrollLeft+(q.x*p.x);}}if(this._super){this._super(n);}},ondragend:function E(m){if(this.isDraggingScrollBar&&this.isDraggingScrollBar(m)){C.toggleClass(m.src.node,k,false);C.toggleClass(H.call(this),D,false);}if(this._super){this._super(m);}},widgetResized:function j(){if(this._super){this._super();}this.updateScrollbars();},unrender:function A(m){S.forEach(this.installedEventListeners,function(n){J.detachEvent(n.e,n.evt,n.fn);});this.installedEventListeners=[];delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(m);},getDefaultScrollBarProps:function M(m){return U[m];},disableScroll:function a(m,p){var o=this.scrollNode,n=H.call(this);S.forEach(["v","h"],function(s){var q=U[s];C.toggleClass(n,q.hostCls,false);C.toggleClass(o,q.scrollNodeCls,false);});if(o){if(p||p===undefined){o.style.overflowY="hidden";}else{if(o.style.overflowY==="hidden"){o.style.overflowY="auto";}}if(m||m===undefined){o.style.overflowX="hidden";}}},disableScrollWithoutClearTheCls:function L(m,q){var p=this.scrollNode,n=H.call(this),o;if(p){if(q||q===undefined){p.style.overflowY="hidden";o=U.v;C.toggleClass(n,o.hostCls,false);}else{if(p.style.overflowY==="hidden"){p.style.overflowY="auto";}}if(m||m===undefined){o=U.h;C.toggleClass(n,o.hostCls,false);p.style.overflowX="hidden";}}},enableScroll:function K(){this.updateScrollbars();if(!this.hasCustomScrollbar&&this.scrollNode){this.scrollNode.style.overflowY=I.call(this,"v")?"scroll":"hidden";}},scrollIntoViewIfNeeded:function(p){var w=this.scrollNode,s=p.clientHeight,q=w.clientHeight,n=J.position(p).y,t=J.position(w).y,o=n-t,m=o<0,u=o+s>q;if(m||u){w.scrollTop+=o+s/2-q/2;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx");var S=mstrmojo.css;var Q=10;function C(Y,b,a){Y.pauseScrollRendering(true);var Z=Y.scrollboxNode,X=Y.animate?Y.scrollEffect:null;if(X&&X.play){if(X.isPlaying){X.cancel();}X.props={scrollTop:{start:Z.scrollTop,stop:b,isStyle:false}};X.onEnd=function(){Y.pauseScrollRendering(false,null,a);};X.play();}else{Z.scrollTop=b;Y.pauseScrollRendering(false,null,a);}}function K(e,g,X){var Y=4;if(!X){X=0;}var h=Math.round(e.renderBlockSize/2);e.fillAt(Math.max(0,g-h),g+h);var d=e.itemsContainerNode,c=d.childNodes[g],b=e.listMapper.itemOffsetTop(e,d,null,c),f=parseInt(e.scrollboxNode.clientHeight/2,10)-c.offsetHeight/2,Z=Math.max(0,e.spacerMargin+b-f);if(Math.abs(e.scrollboxNode.scrollTop-Z)>2){C(e,Z,e.renderOnScroll?function(){if(X<=Y){K(e,g,X++);}}:null);}else{var a=e.animate?e.scrollEffect:null;if(a&&a.isPlaying&&a.cancel){a.cancel();e.pauseScrollRendering(false);}}}function J(Z){var a=Z.itemsContainerNode,X=a.lastChild,Y=X?X.offsetTop+X.offsetHeight-a.firstChild.offsetTop:0;return Y;}function W(Y){var X=J(Y),Z=Math.max(0,parseInt((Y.scrollboxNode.clientHeight-X)/2,10));C(Y,Math.max(0,Y.spacerMargin-Z));}function H(Z){var X=Z.selectedIndex,Y=X>-1;Z.set("hasSelection",Y);if(!Z.domNode){return ;}if(Y){K(Z,X);}else{W(Z);}}function E(Y){var a=Y.scrollboxNode,X=J(Y),Z=X>a.clientHeight/2;S.toggleClass(Y.upArrowNode,["enabled"],Z);S.toggleClass(Y.downArrowNode,["enabled"],Z);}function N(X,Y){var Z=X.scrollboxNode;Z.scrollTop=Math.min(Math.max(Z.scrollTop+Y,0),Z.scrollHeight-Z.offsetHeight);}function B(Y,X){if(!Y._scrollInter){var Z=Q*(X?-1:1);Y._scrollInter=window.setInterval(function(){N(Y,Z);},50);}}function R(X){if(X._scrollInter){window.clearInterval(X._scrollInter);X._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"   mstrevent="mouseover mouseout click mousedown mouseup"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)"  onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)"  onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)"  onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)"  onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow"  mstrevent="mouseover mouseout click mousedown mouseup"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)"  onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)"  onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)"  onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)"  onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var Y=this.widget[this.slot],X=(Y&&Y.offsetWidth)||0;this.props=X?{left:{start:-X,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var X=(this.cssText||"").match(/height:\s*(\d*)px/);if(X){this.spacerMargin=parseInt(Number(X[1])/2,10);var Y=this.spacerMargin+"px";this.spacerCssText="padding-top: "+Y+"; padding-bottom: "+Y+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function U(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(X){this._super(X);if(this.hasRendered){if(!this.multiSelect||(X&&X.added&&X.added.length)){this.center();}}},onclickarrow:function A(Z,Y,X){N(this,Q*(X?-1:1));},onmouseoverarrow:function L(Z,Y,X){if(!this.holdJumpOnly){B(this,X);}},onmouseoutarrow:function M(Z,Y,X){R(this);},onmousedownarrow:function F(Z,Y,X){if(this.holdJumpOnly){B(this,X);}},onmouseuparrow:function P(Z,Y,X){R(this);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","dom","hash","array","css","func","desc");var P=mstrmojo.dom,C=mstrmojo.css,Q=mstrmojo.hash,d=mstrmojo.array,o=mstrmojo.func,L=mstrmojo.desc;var K,F=[],AA="moving";mstrmojo.requiresDescs(15934,15935,15936,15937,15938,15939,15940,1006);function R(AE,AD){var AC=AE&&AE.length||0;AD=AD===undefined?30:AD;return AE+Array(Math.max(AD-AC,0)+1).join(" ");}function B(AC){if(K){window.clearTimeout(K);K=null;}G();d.forEach(AC,function(AD){C.toggleClass(AD,AA,true);});F=[].concat(AC);K=window.setTimeout(G,1000);}function G(){d.forEach(F,function(AC){C.toggleClass(AC,AA,false);});F=[];}function i(AK,AI,AC,AG){var AL=AK.rows,AD=AL.length,AF;if(AI<0||AI>=AD||AC<0||AC>AD){AF=false;}else{if(AC===AI||AC===AI+1){AF=true;}else{var AH=AL[AI],AE=AK.insertRow(AC);P.replace(AE,AH);if(mstrmojo.debugBundles&&console){console.log("move "+R('"'+AH.cells[0].textContent.trim()+'"')+' after "'+AK.rows[AH.rowIndex-1].textContent.trim()+'"');}if(!AG){B(Array.apply(null,AH.cells));}if(AI===1||AC===1){var AJ=this.getViz();AJ.offsetCellNode=S.call(this).rows[1].cells[0];}AF=true;}}return AF;}function y(AC){var AD=P.findAncestorByName(AC,"tr");return AD&&AD.rowIndex;}function H(AE,AF){var AC;if(AE){var AG=P.findAncestorByName(AE,"tr"),AD=AG&&AG.rowIndex;AC=AD+(AF?0:1);}else{if(AF){AC=S.call(this).rows.length;}else{AC=1;}}return AC;}function s(AE,AD){var AC;if(AE){AC=AE.ordinal;}else{if(AD){AC=Z.call(this)-1;}else{AC=0;}}return AC;}function Z(){var AC=this.getViz();dataBlocks=AC.dataBlocks,tc=0;d.filterOne(dataBlocks,function(AD){tc=AD&&AD.rw.row.tc;return tc!==undefined;});return tc;}function AB(AJ,AD){var AK=u.call(this),AN=AK.rowsPerPage,AL=Math.ceil((AJ+2)/AN)-1,AF=AK.pageStatus[AL],AE=[],AG;for(AG=AK.numPagesRendered;AG<AL;AG++){AE.push({idx:AG,fill:false});}var AI,AC;if(!AF||!AF.filled){if(AF&&AF.isOnDemand()){if(!AF.isDownloading&&!AK.isDownloading){var AM=AL*AN-1,AH=(AL+1)*AN-2;AF.isDownloading=true;AK.isDownloading=true;AK.cp.download(AM,AH);AI=true;AC=AH-AM+1;if(mstrmojo.debugBundles&&console){console.log("load data from orddinal "+AM+" to "+AH+" for page index "+AL+" and ordinal "+AJ);}}AE.push({idx:AL,fill:false});}else{AE.push({idx:AL,fill:true});}}if(AI&&AD){AK.parent.showDownloadStatus(AC);}else{AK.parent.closeDownloadStatus();}return AE;}function S(){var AC=u.call(this);return AC.tableNode;}function u(){var AC=this.getViz();return AC.zone;}function b(AF){var AD=this.getViz(),AC=AD.scrollboxLeft,AE=AD.scrollboxTop;if(AC!==AF.x||AE!==AF.y){AD.scrollTo(AF);}}mstrmojo.vi.controllers.CustomSortModeActionMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.CustomSortModeActionMgr",actions:null,pos:-1,historicalUnsilentActions:null,csDisplayPanel:null,init:function p(AC){Q.copy(AC,this);this.actions=[];this.historicalUnsilentActions=[];},appendHistUnsilentActions:function e(AC){this.historicalUnsilentActions=this.historicalUnsilentActions.concat(AC);},getViz:function c(){return this.csDisplayPanel.getVizBox().boxContent;},wrapCustomSortAction:function I(AD,AF,AC){var AG=this,AE=this.getViz();return{silent:true,submitAction:AD,srcEle:this.getOrdinalInfo(AF),tgtEle:this.getOrdinalInfo(AC),srcRefOrdinal:this.getRefOrdinal(AF),perform:function(AM,AP,AN){var AJ=this,AL=AJ.srcEle,AI=AJ.tgtEle,AK=AJ.submitAction.before,AQ=function(){var AV=AG.getNodeForOrdinal(AL.ordinal),AU=AG.getViz(),AS=AU.getCellForNode(AV),AR=AI&&AG.getNodeForOrdinal(AI.ordinal),AT=AR&&AU.getCellForNode(AR);if(AG.hasFailedSorts()||AS._e.id!==AL.id||AT&&AT._e.id!==AI.id){AG.addFailedSorts(AL.n,AI&&AI.n,AK);}else{i.call(AG,S.call(AG),y(AV),H.call(AG,AR,AK),AN);if(!AM){b.call(AG,{x:AU.scrollboxLeft||0,y:AG.getScrollYForGoldenSectionPoint(AV)});}}if(AP){AP();}};if(AM){AG.resetFailedSorts();AQ();}else{var AH=AJ.srcEle.ordinal,AO=s.call(AG,AJ.tgtEle,AK);if(AG.hasFailedSorts()){AG.addFailedSorts(AL.n,AI&&AI.n,AK);if(AP){AP();}}else{AG.prepareDataAndPages([AH,AO],AQ);}}},undo:function(){var AL=AG.getNodeForOrdinal(this.srcEle.ordinal),AJ=y(AL),AI=AG.getNodeForOrdinal(this.srcRefOrdinal),AH=H.call(AG,AI,false),AK=S.call(AG);i.call(AG,AK,AJ,AH);b.call(AG,{x:AG.getViz().scrollboxLeft||0,y:AG.getScrollYForGoldenSectionPoint(AL)});}};},prepareDataAndPages:function M(AH,AJ){var AF=0,AC=AH.length,AD=u.call(this),AG=this,AI=0;var AE=function(){self.setTimeout(function(){try{var AK=AB.call(AG,AH[AF]);if(AK.length>0){mstrApp.showWait();AD.preRenderPages();AD.renderPages(AK);AD.postRenderPages();AD._postPagesClearup=true;}else{if(AD._postPagesClearup){AD.postRenderPagesCleanup();AD.configureActions();AD._postPagesClearup=false;}if(AD.isRenderingComplete()){AD.postRenderingCleanup();}AF++;}if(AK.length>0||AF<AC){AI=AD.renderPause;AE();}else{AG.dpPreparingCleanUp();if(AJ){AJ();}}}catch(AL){AG.dpPreparingCleanUp();mstrApp.hideWait(true);throw AL;}},AI);};AD.renderingRows=true;AE();},dpPreparingCleanUp:function E(){u.call(this).renderingRows=false;},getRefOrdinal:function a(AE){var AG=this.getViz(),AC=AG.zone.tableNode.getElementsByTagName("tr"),AD=AE.cellIndex,AH=AE.parentElement.rowIndex,AF=AC[AH-1].cells[AD];return AG.getCellForNode(AF).o;},getOrdinalInfo:function z(AD){var AC=this.getViz().getCellForNode(AD);if(AC&&AC._e){return{id:AC._e.id,n:AC._e.n,ordinal:AC.o};}},getNodeForOrdinal:function q(AC){var AF=S.call(this).rows;if(AC>=0){var AD=AC+1,AE;AE=d.filterOne(AF,function(AG){return parseInt(AG.firstElementChild.getAttribute("r"),10)===AD;});return AE.firstElementChild;}else{return AF[0].firstElementChild;}},getScrollYForGoldenSectionPoint:function U(AG){var AD=0.618,AI=this.getViz(),AC=AI.tableContainerNode.getBoundingClientRect(),AF=AC.top+AC.height*(1-AD),AE=AG.getBoundingClientRect(),AH=AE.top+AE.width/2;return(AI.scrollboxTop||0)+AH-AF;},wrapUnsilentAction:function X(AD,AC,AF,AE){var AG=this;return{silent:false,needDataReady:!!(AE&&AE.needDataReady),submitActions:d.ensureArray(AD),undoCallback:AC,perform:function(AI,AK){var AH=[],AI=d.ensureArray(AI),AL=AG.getViz(),AM=AL.model.getDataService(),AJ;if(AI.length>0){AH=AH.concat(AI);}AH=AH.concat(this.submitActions);AJ=AL.controller._getXtabCallback(AL,Q.copy(AC));if(AK){AJ=o.wrapMethods(AJ,AK);}AF=Q.copy(AF||{});AF.hideCancel=true;AF.noUpdate=true;AF.preserveStid=true;AF.noDeltaXML=true;AM.submitUpdates(AM.getUpdateTemplateAction(AL.k,AH),AJ,AF);}};},addAction:function w(AC){var AD=this.actions,AE=this.pos;AD.splice(AE+1);AD.push(AC);this.pos=AD.length-1;this.csDisplayPanel.updateStatus();},execute:function g(AD){this.addAction(AD);if(AD.silent){AD.perform(true);}else{var AC=this.getCustomSortActAhead();AD.perform(d.ensureArray(AC));}},undo:function W(){var AD=this.actions[this.pos];if(!AD){return ;}this.pos--;this.csDisplayPanel.updateStatus();if(AD.silent){AD.undo();}else{var AC=this.getActionParts4Undo();this.csDisplayPanel.recreateCSVizForUndo(AC.splitUTActions,AC.silentActions,AD.undoCallback);}},getActionParts4Undo:function m(){var AI=[],AK=[AI],AH=[],AF=this.actions,AG=this.pos,AD,AJ;while(AG>=0){AD=AF[AG];if(AD&&AD.silent){AH=[AD].concat(AH);}else{break;}AG--;}while(AG>=0){AD=AF[AG];if(AD){if(AD.silent){AJ=this.getCustomSortActAhead(AG+1);AI.unshift(AJ);AG=AG-(AJ.actions.length-1);}else{AI.unshift.apply(AI,AD.submitActions);if(AD.needDataReady){AI=[];AK.unshift(AI);}}}AG--;}var AE=this.historicalUnsilentActions,AC;AG=AE.length-1;while(AG>=0){AC=AE[AG];AI.unshift.apply(AI,AC.submitActions);if(AC.needDataReady){AI=[];AK.unshift(AI);}AG--;}return{splitUTActions:AK,silentActions:AH};},redo:function O(){var AD=this.actions[this.pos+1];if(!AD){return ;}this.pos++;this.csDisplayPanel.updateStatus();if(AD.silent){this.resetFailedSorts();var AC=this;AD.perform(false,function(){mstrApp.hideWait(true);if(AC.hasFailedSorts()){AC.actions.splice(AC.pos);AC.pos--;AC.csDisplayPanel.updateStatus();AC.showFailedSortsAndReset();}});}else{AD.perform(this.getCustomSortActAhead());}},getContSlientActionsBehind:function Y(){var AC=this.actions.length,AD,AE=[],AF;for(AD=this.pos+1;AD<AC;AD++){AF=this.actions[AD];if(AF&&AF.silent){AE.push(AF);}else{break;}}return AE;},getContSlientActionsBefore:function f(){var AF=this.actions,AC,AD=[],AE;for(AC=this.pos;AC>=0;AC--){AE=AF[AC];if(AE&&AE.silent){AD=[AE].concat(AD);}else{break;}}return AD;},getSlientActionsBefore:function A(){var AC=this.actions.slice(0,this.pos+1);return d.filter(AC,function(AD){return AD&&AD.silent;});},getUnslientActionsBefore:function l(){var AC=this.actions.slice(0,this.pos+1);return d.filter(AC,function(AD){return AD&&!AD.silent;});},getCustomSortActAhead:function k(AG){var AC=[],AD=(AG===undefined?this.pos:AG)-1,AF=this.actions;while(AD>=0){var AE=AF[AD];if(AE.silent){AC=[AE.submitAction].concat(AC);}else{break;}AD--;}if(AC.length>0){return this.csDisplayPanel.wrapCustomSortAction(AC,true);}},isCurrentActionSilent:function N(){return this.actions[this.pos]&&this.actions[this.pos].silent;},reset:function j(){this.actions=[];this.pos=-1;this.csDisplayPanel.updateStatus();},getActionsCount:function t(){return(this.actions||[]).length;},getFailedSortsCount:function h(){return(this.failedSorts||[]).length;},resetFailedSorts:function n(){this.failedSorts=[];},hasFailedSorts:function J(){return(this.failedSorts||[]).length>0;},addFailedSorts:function D(AD,AE,AC){this.failedSorts=this.failedSorts||[];this.failedSorts.push({srcName:AD,tgtName:AE,isPost:AC});},showFailedSortsAndReset:function x(){if(this.hasFailedSorts()){var AD=this.failedSorts.length,AF,AI,AC,AG,AH=L(15934,"Below sorting manipulations fail due to change in source data:")+" ";for(var AE=0;AE<AD;AE++){AF=this.failedSorts[AE];AI=AF.srcName;AC=AF.tgtName;AG=AF.isPost;if(AC){AH+=AG?L(15935,'move "#" before "##"').replace("#",AI).replace("##",AC):L(15936,'move "#" after "##"').replace("#",AI).replace("##",AC);}else{AH+=AG?L(15937,'move "#" to the end').replace("#",AI):L(15938,'move "#" to the top').replace("#",AI);}if(AE===AD-1){AH+=L(1006,".")+" ";}else{AH+=L(15939,",")+" ";}}AH+=L(15940,"Please manually do these sortings if necessary.");mstrmojo.err({message:AH});this.resetFailedSorts();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css");var I=mstrmojo.array,L=mstrmojo.hash,W=mstrmojo.css,F=mstrmojo.dom;function K(){if(this.canTab&&!this.hasTabFocus){this.tabIndex=0;this.hasTabFocus=true;}}function H(h){var Y=this.navList,a=this.tabIndex,Z=a,d=this.tabWrap,e=Y.length,f=e>0,b=h?-1:1,c=e,g;while(!this.isValidTarget(g)&&c>=0){a+=b;c--;if(a>=Y.length){if(d){a=0;}else{a=f?e-1:0;}}else{if(a<0){if(d){a=f?e-1:0;}else{a=0;}}}if(a===Z){break;}g=Y[a];}if(!this.isValidTarget(g)){g=null;}return{idx:a,item:g,foundItem:!!g};}mstrmojo.vi.ui.rw._SupportTabNav=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportTabNav",{_mixinName:"mstrmojo.vi.ui.rw._SupportTabNav",canTab:true,tabParent:null,tabIndex:0,navList:[],tabWrap:true,tabBubbles:true,hasTabFocus:false,initTabNavigation:function P(){var Y=this.parent;while(Y&&!Y.canTab){Y=Y.parent;}this.tabParent=Y;if(!this.focusEventFn){this.focusEventFn=K.bind(this);}F.attachEvent(this.domNode,"focusin",this.focusEventFn);this.buildNavList();},postBuildRendering:function S(){if(this._super){this._super();}this.initTabNavigation();},destroy:function U(){if(this._super){this._super();}if(this.focusEventFn){F.detachEvent(this.domNode,"focusin",this.focusEventFn);}},changeTabTarget:function E(e,b){var a=typeof e==="string",d=typeof e==="number",Z=this.navList,Y=this.tabIndex,c=Z.length;I.forEach(Z,function(g,f){if(a){if(g.k===e){Y=f;return false;}}else{if(d){if(f===e){Y=f;return false;}}else{if(g===e){Y=f;return false;}}}});if(b){Y--;if(Y<0){if(this.tabWrap){Y=c>0?c-1:0;}else{Y=0;}}}this.tabIndex=Y;},resetTabNav:function O(Y){this.tabIndex=0;this.buildNavList();if(Y!==undefined){this.changeTabTarget(Y);}},buildNavList:function G(){var Y=[],Z=this.children;I.forEach(Z,function(a){if(a.canTab){Y.push(a);}});this.navList=Y;},isValidTarget:function A(Y){return !(Y===undefined||Y===null||(Y instanceof HTMLElement&&W.getStyleValue(Y,"display")==="none"));},handleTab:function M(Y,a){var b=Y.e||Y,Z=b.key;if(!this.canTab){return false;}if(Z==="Tab"){if(!this.hasTabFocus){return true;}Y.preventDefault();b.stopPropagation();if(a){this.changeTabTarget(a);}if(!Y.shiftKey){this.navigateNext();}else{this.navigatePrevious();}return true;}return false;},navigateToFirstValidTarget:function B(){var Z,Y;this.tabIndex=-1;Z=H.call(this,false);if(Z.foundItem){this.tabIndex=Z.idx;Y=Z.item;if(Y&&Y.grabFocus){Y.grabFocus(true);}}},navigateNext:function X(){var f=this.tabParent,Z=this.tabIndex,c=this.navList,b=this.tabBubbles,d=Z,a,e,Y;a=H.call(this,false);if(a.foundItem){this.tabIndex=a.idx;e=c[d];if(e!==this&&e&&e.loseFocus){e.loseFocus(true);}Y=a.item;if(Y&&Y.grabFocus){Y.grabFocus(true);}}else{if(c.length===1){return ;}else{if(f&&f.canTab&&b){if(this.loseFocus){this.loseFocus(true);}f.changeTabTarget(this);f.navigateNext();}}}},navigatePrevious:function R(){var f=this.tabParent,Z=this.tabIndex,c=this.navList,b=this.tabBubbles,d=Z,a,e,Y;a=H.call(this,true);if(a.foundItem){this.tabIndex=a.idx;e=c[d];if(e!==this&&e&&e.loseFocus){e.loseFocus(true);}Y=a.item;if(Y&&Y.grabFocus){Y.grabFocus(true);}}else{if(c.length===1){return ;}else{if(f&&f.canTab&&b){if(this.loseFocus){this.loseFocus(true);}f.changeTabTarget(this);f.navigatePrevious();}}}},navigateToParent:function Q(Z){var Y=this.tabParent;if(Y&&Y.canTab){Y.changeTabTarget(this,Z);if(this.loseFocus){this.loseFocus(true);}if(Y.grabFocus){Y.grabFocus(true);}}},grabFocus:function J(){this.hasTabFocus=true;},loseFocus:function D(){this.hasTabFocus=false;},restoreFocus:function C(){if(L.walk("navList."+this.tabIndex+".grabFocus",this)){this.navList[this.tabIndex].grabFocus(true);}},getFocusedTarget:function N(){return L.walk("navList."+this.tabIndex,this);}});mstrmojo.vi.ui.rw._SupportTabNav.nextValidItem=H;})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.CustomVisUtility","mstrmojo.customviz.GraphicModel");mstrmojo.GRAPHIC_SELECTION_TYPES={ATTR:1,METRIC:2,EMPTY:0,MIXED:4};var P=mstrmojo.array,X=mstrmojo.hash,E=mstrmojo.GRAPHIC_SELECTION_TYPES,U=mstrmojo.CustomVisUtility,d=U.log;var e=function(m){var k=X.keyarray(m).sort(),l=[],n;P.forEach(k,function(o){n=[];P.forEach(m[o],function(p){n.push(this.model.getNormalizedFormElementId(p.id));},this);l.push(o+"-"+n.sort().join("@"));},this);return l.join("#");},R=function(l,k,n){var m={};m[l]=[{id:k,n:n}];return m;},j=function(m,k){if(m&&k){var l=e.call(this,m);if(!this._customVizSelExtraInfo[l]){this._customVizSelExtraInfo[l]=k;}}},B=function(m,k){if(m&&k){var l=e.call(this,m);if(!this._customVizContextMenuSelExtraInfo[l]){this._customVizContextMenuSelExtraInfo[l]=k;}}},J=function(m){var l=e.call(this,m),k=this._customVizSelExtraInfo[l];if(k){delete this._customVizSelExtraInfo[l];}return k;},a=function(m){var l=e.call(this,m),k=this._customVizContextMenuSelExtraInfo[l];if(k){delete this._customVizContextMenuSelExtraInfo[l];}return k;};mstrmojo.customviz._HasExtraSelectionInfo=mstrmojo.provide("mstrmojo.customviz._HasExtraSelectionInfo",{_mixinName:"mstrmojo.customviz._HasExtraSelectionInfo",_customVizSelExtraInfo:{},_customVizContextMenuSelExtraInfo:{},misMatchWithVisSelection:false,graphicSelectionType:null,init:function c(k){this._super(k);this._customVizSelExtraInfo={};this._customVizContextMenuSelExtraInfo={};this.misMatchWithVisSelection=false;this.graphicSelectionType=E.EMPTY;},isSelectionEmpty:function H(){var k;for(k in this._customVizSelExtraInfo){return false;}return true;},getSelExtraInfo:function N(){return X.valarray(this._customVizSelExtraInfo);},getContextMenuSelExtraInfo:function M(){return X.valarray(this._customVizContextMenuSelExtraInfo);},clearCxtMnuSelection:function K(k){if(!k){this._super();}this._customVizContextMenuSelExtraInfo={};},clearSelections:function G(k){if(!k){this._super();}else{this.misMatchWithVisSelection=true;}this._customVizSelExtraInfo={};this.graphicSelectionType=E.EMPTY;},addMetricValueSelection:function Q(l,m,k){if(!k){this._super(l);}else{this.misMatchWithVisSelection=true;}switch(this.graphicSelectionType){case E.METRIC:break;case E.ATTR:if(k){this.graphicSelectionType=E.MIXED;}else{this.clearSelections(true);this.graphicSelectionType=E.METRIC;}break;case E.EMPTY:this.graphicSelectionType=E.METRIC;break;default:break;}j.call(this,l,m);},removeMetricValueSelection:function b(l,m,k){if(!k){this._super(l);}else{this.misMatchWithVisSelection=true;}J.call(this,l);if(this.isSelectionEmpty()){this.graphicSelectionType=E.EMPTY;}},addContextMenuMetricValueSelection:function D(l,m,k){if(!k){this._super(l);}B.call(this,l,m);},removeContextMenuMetricValueSelection:function i(l,m,k){if(!k){this._super(l);}a.call(this,l);},addAttributeSelection:function Y(m,l,q,o,k){var s=R.call(this,m,l,q),n;if(!k){n=this._super(m,l,q);}else{this.misMatchWithVisSelection=true;}switch(this.graphicSelectionType){case E.ATTR:break;case E.METRIC:if(k){this.graphicSelectionType=E.MIXED;}else{this.clearSelections(true);this.graphicSelectionType=E.ATTR;}break;case E.EMPTY:this.graphicSelectionType=E.ATTR;break;default:break;}j.call(this,s,o);return n;},removeAttributeSelection:function h(m,l,p,o,k){var n;if(!k){n=this._super(m,l,p);}else{this.misMatchWithVisSelection=true;}J.call(this,R.call(this,m,l));if(this.isSelectionEmpty()){this.graphicSelectionType=E.EMPTY;}return n;},addContextMenuAttributeSelection:function I(m,l,q,o,k){var s=R.call(this,m,l,q),n;if(!k){n=this._super(m,l,q);}B.call(this,s,o);return n;},removeContextMenuAttributeSelection:function W(m,l,p,o,k){var n;if(!k){n=this._super(m,l,p);}a.call(this,R.call(this,m,l));return n;},getGraphicModelsBySelector:function g(){},isSelectorsEqual:function Z(l,k){if(l.isSelectAttr===k.isSelectAttr){return this.getSelectorHash(l)===this.getSelectorHash(k);}return false;},getSelectorHash:function C(k){if(k.isSelectAttr){return e.call(this,R.call(this,k.tid,k.eid,k.n));}else{return e.call(this,k);}},copyToContextMenuSelection:function S(){this._super();X.copy(this._customVizSelExtraInfo,this._customVizContextMenuSelExtraInfo);},synchronizeContextMenuSelection:function A(){this.clearCxtMnuSelection();this.copyToContextMenuSelection();},needHighlight:function F(l,k){if(l){return !!this._customVizSelExtraInfo[e.call(this,R.call(this,k.tid,k.eid,k.n))];}else{return !!this._customVizSelExtraInfo[e.call(this,k)];}},needContextMenuHighlight:function O(l,k){if(l){return !!this._customVizContextMenuSelExtraInfo[e.call(this,R.call(this,k.tid,k.eid,k.n))];}else{return !!this._customVizContextMenuSelExtraInfo[e.call(this,k)];}},synchronizeToVisSelection:function L(){var m=this.getSelExtraInfo(),l=this,n=this.graphicSelectionType,k;this.clearSelections();this.misMatchWithVisSelection=false;if(n===E.ATTR){P.forEach(m,function(o){k=o.getSelector();l.addAttributeSelection(k.tid,k.eid,k.n,o);});}else{if(n===E.METRIC){P.forEach(m,function(o){l.addMetricValueSelection(o.getSelector(),o);});}}},addSelectionBySingleSelector:function f(u,t,m,o,w){var s=this,n,l,p,k,q={xTotal:0,yTotal:0,count:0};n=s.getGraphicModelsBySelector(u,t);n=P.ensureArray(n);if(n.length>0){P.forEach(n,function(x){l=x.isAttributeSelector();p=x.getSelector();if(l){o?s.addContextMenuAttributeSelection(p.tid,p.eid,p.n,x,m):s.addAttributeSelection(p.tid,p.eid,p.n,x,m);}else{o?s.addContextMenuMetricValueSelection(x.getSelector(),x,m):s.addMetricValueSelection(x.getSelector(),x,m);}if(w){k=x.getGraphicCenter();if(k){q.xTotal+=k.x;q.yTotal+=k.y;}++q.count;}});}else{d('We did not get any graphic model by the selector given what may lead to the functionality of selection and highlight not work, please check the function "getGraphicModelBySelector()" you have implemented.');}return q;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){if(this.avatar){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.css","mstrmojo.hash");var A=mstrmojo.color,E=mstrmojo.css,B=mstrmojo.hash;function G(J){J=D(J);if(isNaN(J)){J=0;}J%=16777216;return{b:J%(1<<8),g:(J%(1<<16))>>8,r:(J%(1<<24))>>16};}function F(N,O,M){N=D(N);M=B.copy(M,{retainGradientObject:false});if(C(N)){var L=F(N.c1,O),J=F(N.c2,O);if(M.retainGradientObject){return{c1:L,c2:J,or:N.or};}return E.buildGradient(N.or,L,J).v;}if(typeof O==="number"){var K=G(N);if(isNaN(N)){O=0;}return"rgba("+K.r+" ,"+K.g+" ,"+K.b+" ,"+O+" )";}else{if(isNaN(N)){N=0;}return"#"+(16777216+N%16777216).toString(16).substring(1,7);}}function D(L){var K=L.c1,J=L.c2;if(C(L)){return{c1:D(K),c2:D(J),or:L.or};}if(typeof L==="number"){return L;}if(typeof L!=="string"){return NaN;}if(L[0]!=="#"){return parseInt(L,10);}if(L.length===4){L=L[0]+L[1]+L[1]+L[2]+L[2]+L[3]+L[3];}return parseInt(L.substring(1,7),16);}function I(L,J){var O=L.value,Q=L.opacity;if(C(O)){return["c1","c2"].reduce(function(X,Y,W){var Z=I({value:O[Y],opacity:Q},J);X.value[Y]=Z.value;if(W===0){X.opacity=Z.opacity;}return X;},{value:{or:O.or}});}if(O==="transparent"){L.value=J.value;}var N=A.hex2rgb(F(L.value)),M=A.hex2rgb(F(J.value)),U=L.opacity,S=J.opacity,R=1-U,P,K;K=U+S*R;P=N.map(function(W,X){return(W*U+M[X]*S*R)/K;});return{value:"#"+A.rgb2hex.apply(undefined,P),opacity:K};}function C(J){return J&&["c1","c2","or"].every(function(K){return J.hasOwnProperty(K);});}mstrmojo.util.color=mstrmojo.provide("mstrmojo.util.color",{getCSSColorString:F,getColorValue:D,mix:I,isGradientColor:C,getRGB:G,isBrightColor:function H(N){var L=N>>16,K=(N&65280)>>8,J=(N&255),M=(L*299+K*587+J*114)/1000;return M>150;},createCanvasFillPattern:function(L,R,K,Q,J,P){var M=L.value,O=L.opacity,N;if(C(M)){N=R.createLinearGradient(K,Q,J,P);N.addColorStop(0,F(M.c1,O));N.addColorStop(1,F(M.c2,O));}else{N=F(M,O);}return N;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.array,E=mstrmojo.css,C=mstrmojo.hash,H="focus-visible",B=["menuitem","option","listitem","radio","tab"];mstrmojo._IsAccessibleList=mstrmojo.provide("mstrmojo._IsAccessibleList",{_mixinName:"mstrmojo._IsAccessibleList",listRole:"listbox",itemRole:"option",itemTabIndex:-1,itemSelectedAriaProp:"aria-selected",updateItemAriaLabel:mstrmojo.emptyFn,enableA11y:function D(){this.domNode.setAttribute("role",this.listRole);if(this.multiSelect){this.domNode.setAttribute("aria-multiselectable","true");}var L=this,K=this.selectedIndices||{},J=(this.items&&this.items.length)||0,N=F.indexOf(B,this.itemRole)>-1,M=this.itemsContainerNode&&this.itemsContainerNode.childNodes;F.forEach(M,function(P,O){P.setAttribute("tabindex",L.itemTabIndex);P.setAttribute("role",L.itemRole);if(N){P.setAttribute("aria-setsize",J);P.setAttribute("aria-posinset",O+1);}if(L.itemSelectedAriaProp){P.setAttribute(L.itemSelectedAriaProp,!!K[O]);}});},postBuildRendering:function A(){if(this._super){this._super();}if(this.enableAccessibility){this.enableA11y();}},setA11yAttribute:function(K,J){if(!this.enableAccessibility||!K){return ;}if(this.itemSelectedAriaProp){K.setAttribute(this.itemSelectedAriaProp,J);}this.updateItemAriaLabel(K,J);},getFocusNode:function I(J){return C.walk("parent.navList."+J,this);},isTabItemHighlighting:function G(){var K=this.parent,L,J;if(!this.enableAccessibility||!K.canTab){return false;}L=this.getFocusNode(K.tabIndex);J=this.getFocusNode(K.tabIndex-1);if(L&&L instanceof Element&&E.hasClass(L,H)){return true;}if(J&&J instanceof Element&&E.hasClass(J,H)){return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.color","mstrmojo.css","mstrmojo.dom");var K={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","background-opacity","fx"],RW:[]};K.RW=["z-index"].concat(K.T.concat(K.D));var J=mstrmojo.array,O=mstrmojo.color,Q=mstrmojo.css,D=mstrmojo.dom;function P(Y,a,X){var Z=Y[a]||[];Z.push(X);Y[a]=Z;}function M(b,a){var Z=((b&&b.fmts)||null);if(a){var d=b.thresholds,Y=d&&d[a];if(Y){var c={},e;for(e in Z){c[e]=Y[e]||Z[e];}for(e in Y){var X=Y[e];c[e]=(typeof X==="string")?(X+" !important"):X;}Z=c;}}return Z;}function U(Y,X){if(Y==="transparent"){return Y;}if(typeof X==="undefined"||X===null||X<0||X>=100){return Y;}return O.rgb2rgba(Y,X);}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(Y){var X=true;this.invisible=!!(Y&&Y.data&&Y.data.invisible);if(this._super){X=this._super(Y);}return X;},buildCSSFormatString:function H(i,e){var b=this.formatHandlers[i],p=b.src?e[b.src]:e;if(!p){return null;}var Z=b.props||b;if(!Z){return null;}var l=[],k=-1,c=100;var h=Z.length-1;for(h;h>=0;h--){var d=Z[h];var Y=K[d]||[d];var j=Y.length-1;for(j;j>=0;j--){d=Y[j];var n=p[d];if(n!==undefined){switch(d){case"fx":var m=n,a={};var X=m.gd;if(X){this.formatGradient(X,a);}var o=parseInt(m.rt,10);if(o){if(o===1||o===3){this.formatTextRotation(m.rt,a);}}if(m.ds){this.formatDropShadow(m,a);}var g;for(g in a){l[++k]=g+":"+a[g].join(" ");}break;case"background-opacity":c=n;break;case"background-color":l[++k]=d+":"+U(n,c);break;default:l[++k]=d+":"+n;}}}}if(this.invisible){l.push("visibility:hidden");}return l.join(";")+";";},applyCSSFormatToNode:function I(a,X){var b=this[a],Z=b&&b.style;if(Z){var Y=this.buildCSSFormatString(a,X)||"";Y.split(";").forEach(function(c){var d=c.split(":");Z[Q.convertCssToCamelCase(d[0])]=d[1];});}},clearSlotBackgroundCSS:function F(Y){var Z=this[Y],X=Z&&Z.style;if(X){X.background="transparent none 0 0 no-repeat";X.filter="none";}},preBuildRendering:function B(){this._super();var a=this.formatHandlers,X=this.getFormats();if(a&&X){var b=this.defn=this.defn||{},c=this.getCacheKey(),Z=b[c];if(!Z){Z=b[c]={};for(var Y in a){var e=Y+"CssText";this[e]=Z[e]=this.buildCSSFormatString(Y,X)||"";}}else{var d;for(d in Z){this[d]=Z[d];}}}return true;},formatGradient:function S(X,Z){var Y=Q.buildGradient(X.t,X.sc,X.ec);if(Y){P(Z,Y.n,Y.v);}},formatDropShadow:function L(b,Z){if(D.supports(D.cssFeatures.DROP_SHADOW)){var a=b.ds;if(D.isDXIE){P(Z,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+a+",OffY="+a+")");}else{var X=[a,a],Y=parseInt(b.rt,10);if(Y===1||Y===3){X[((Y===1)?1:0)]=-a;}P(Z,(D.isWK?"-webkit-":"")+"box-shadow",X.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(Y,X){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){P(X,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+Y+")");}else{var Z=(Y===1)?90:-90;P(X,D.CSS3_PREFIX+"transform-origin","top left");P(X,D.CSS3_PREFIX+"transform","rotate("+Z+"deg)");}}},getFormats:function W(){if(!this.fmts){this.fmts=M.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function R(){delete this.defn[this.getCacheKey()];},unrender:function N(X){if(this.thresholdId){this.fmts=null;}this._super(X);}});mstrmojo._Formattable.getBorderWidths=function(c){var a=c.getFormats(),X=(a.border)?a.border.match(/(\d*|\d*\.\d*)pt/)[0]:a["border-width"],Z=c.model,Y=Z.docModel;return Q.getBorderWidths(X,(Y&&Y.dpi)||Z.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var E=mstrmojo.dom,Q=mstrmojo.css,B=mstrmojo.string,I="selected",L="hidden";function P(X,Y,Z,W,b){var a=b.listHooks[X];if(a&&a.call(b,Y,Z,W)){return ;}Q.toggleClass(Y,I,X==="select");}function G(Z,Y,X){var a=this[Z],W=a?a.split(Y):[];this[Z]=mstrmojo.array.distinct(W.concat(X.split(Y))).join(Y);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,allowHTML:false,init:function N(W){this._super(W);this._shiftStartIndex=-1;},getItemMarkup:function D(X,W){var Y=(this.allowHTML?"":"@en");return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{'+Y+'@title}">{'+Y+"@n}</{@tag}>";},getItemDisplayName:function M(W){return W.n||"";},getItemProps:function R(a,W){var X=!!this.selectedIndices[W],b={tag:"div",sel:X,cls:"",n:this.getItemDisplayName(a),style:"",idx:W,addCls:function Y(d){G.call(this,"cls"," ",d);},addStyle:function Z(d){G.call(this,"style",";",d);},title:a.title||""};if(b.n&&B.isEmpty(b.n)){b.n=B.decodeHtmlString("<br/>");}if(X){b.addCls(I);}var c=a.cls;if(c){b.addCls(c);}if(a.hid){b.addCls(L);}return b;},itemRenderer:{render:function S(X,W,Y){X._renderIdx=W;return mstrmojo.string.apply(Y.getItemMarkup(X,W),Y.getItemProps(X,W));},select:function K(X,Y,W,Z){P("select",X,Y,W,Z);},unselect:function H(X,Y,W,Z){P("unselect",X,Y,W,Z);}},onclick:function U(W){try{var Y=this.getItemFromTarget(W.getTarget());if(Y){W.cancel();this.doItemSelect(Y,W||{});}}catch(X){mstrApp.onerror(X);}},doItemSelect:function C(l,k){var d=k.hWin,f=k.e,i=l._renderIdx,g=l._positionIdx,X=E.isMetaKey(d,f),c=E.shiftKey(d,f),Y=this.multiSelect,b=this.useListModKeys,j=this._shiftStartIndex,Z=this.selectedIndices;if(Y&&b&&c&&j>-1){var W=[],a=[];this.processContinuousSelection(W,a,i);this.addSelect(W);this.removeSelect(a);}else{if(Y&&(!b||X)){var h=(Z[i])?"remove":"add";this[h+"Select"](i,false,g);}else{this.singleSelect(i,false,g);}this._shiftStartIndex=i;}},processContinuousSelection:function J(Y,X,W){var d=this._shiftStartIndex,c=this.selectedIndices,b=Math.min(d,W),a=Math.max(d,W),Z;for(Z=0;Z<this.items.length;Z++){if(b<=Z&&Z<=a){if(!c[Z]){Y.push(Z);}}else{if(c[Z]){X.push(Z);}}}},onclearSelection:function A(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function F(X){var W=E.findAncestorByAttr(X,"idx",true,this.domNode);return(W&&W.node)||null;},getItemFromTarget:function O(Y){var X=this.getItemNodeFromTarget(Y),W=X&&parseInt(X.getAttribute("idx"),10);if(W!==null&&!isNaN(W)&&this.items){return this.items[W];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=I;mstrmojo._IsList.HIDDEN_CLS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(U){if(this._editComplete){return ;}var Z,R=false,Y=this.text,W=false;if(U===C){Z=Y;W=true;R=true;}if((!U&&U!==0)||(!this.allowNewLine&&U===L)){var S=this[this.editableSlot],X=S&&(S.innerText||S.textContent)||"";if(!this.allowNewLine){Z=X.replace(/\n/g,"");}else{Z=X;}R=true;if(!this.allowEmptyText&&Z.length===0){Z=Y;W=true;}}if(R){this._editComplete=true;Z=Z.replace(/\u00A0/g,"\u0020");this.text=Z;this.set("isEditing",false);this.onTextEditComplete(Z!==Y,Y);delete this._editComplete;}if(W){this.refresh();}}function E(R){var S={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[S[R.name]]||(R.name==="click"&&this.editOnTwoClicks)&&R.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(U,S,R){if(typeof S["on"+R]!=="function"){H.attachMarkupEvent(U,S,R);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,editOnTwoClicks:false,firstClickTime:undefined,allowEmptyText:false,allowTrimming:true,allowNewLine:false,editOnDoubleClick:false,onTextEditBegin:mstrmojo.emptyFn,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var U=this.editableSlot,R=this[U],W=this[this.editButtonSlot||U];K.addClass(R,"hasEditableText");this.text=this.text||R.innerText||R.textContent||"";R.innerHTML=this.getEditableTextInnerHTML();var S=this.id;if(this.editOnClick||this.editOnTwoClicks){F(S,W,"click");}F(S,W,"dblclick");F(S,R,"blur");F(S,R,"keyup");F(S,R,"keydown");},getEditableTextInnerHTML:function Q(){return this.allowHTML?this.text:N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");},onclick:function P(R){if(this.editOnClick){E.call(this,R);}if(this._super){this._super(R);}},onTwoClicks:function(R){if(this.editOnTwoClicks){E.call(this,R);}if(this._super){this._super(R);}},ondblclick:function G(R){E.call(this,R);},onblur:function M(){I.call(this);},onkeyup:function B(S){var R=window.event||S.e;I.call(this,R.keyCode);},onkeydown:function J(S){var R=window.event||S.e;if(R.keyCode===L){I.call(this,R.keyCode);S.cancel();}},_set_text:function D(U,R){var S=this.text;this.text=R;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(R||"",true);}return(S!==R);},onisEditingChange:function O(){if(this.hasRendered){var R=this[this.editableSlot],S=!!this.isEditing;R.contentEditable=S;R.spellcheck=false;K.toggleClass(R,"editable",S);if(S){R.focus();H.setElementSelection(R);this.onTextEditBegin();}else{R.blur();R.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.num","mstrmojo.color","mstrmojo.hash","mstrmojo.array","mstrmojo.string");var p=mstrmojo.color,AZ=mstrmojo.hash,Aj=mstrmojo.array,BP=mstrmojo.css,B=mstrmojo.num,Am=mstrmojo.string;var BZ=1,n=2,BJ=3,y=4,Ak=5,A8=6;var m="FormattingFont",O="FormattingAppearance",AK="FormattingAlignment",Z="FormattingSize",A1="FormattingPatterns",Bz="FormattingBorder",BQ="FormattingOrder",AV="FormattingView",M="FormattingSelector",BS="Template Formatting",Aa="FormattingPadding",Bv="AnalyticalEngineProperties",AO="RWDocumentProperties",S="FormattingPage",u="Mobile",L="VLDB Select",Ba="FormattingNumber",BD="RWDExecution",Au="ConfigurationProperties";var A3=1;var Az="n",Bg="h",s="w",BM="wm",AH="pw",At="ml",Bq="mr",AU="upwalw",As="ff",BY="fsz",AD="fw",e="fit",Bp="fun",B1="fst",Ah="fc",P="atp",W="alh",l="alv",Ac="atw",AP="atd",k="autoSizeText",BR="textOverflow",K="textFieldType",Ab="bc",J="bo",BH="bgs",Bs="btc",BE="brc",Bf="bbc",Ao="blc",c="bts",Bn="brs",U="bbs",BT="bls",Bb="borderColor",N="borderStyle",AF="zIndex",C="showTitleBar",AE="useAsInfoWindow",Ax="title",A0="StyleForSwitchingPanel",Bw="InformationWindowPlacement",Be="TitleBarDisplay",t="ctrlIFW",Br="ctrlStyle",AY="ctrlOrientation",x="ctrlOrientationBehavior",Bh="ctrlMultiselect",Al="ctrlAutoSearchEnabled",AG="ciwm",Bm="cmcy",Bu="sec",a="easow",Aq="layoutXml",B6="lockAspectRatio",R="ism",I="shw",AX="mg",A6="lhv",A7="rowslhv",Bi="colslhv",AM="gridVPadding",BU="gridHPadding",Af="ln",B7="papo",Bd="sar",B3="hnv",AR="iw",BL="ih",AA="tsp",AI="visible",By="rf",BI="jad",f="jdc",BX="ode",F="showBaseViewInLibrary",BV="oddp",Ae="fs",B4="ssc",H="sstyle",A="hgl",Y="nct",AT="ncp",Ai="ncs",BN="ndp",h="nfs",E="nnn",AS="nth",Bk="gi",Bo="st",Ar="stfurh",G="stfuch",B0="stfuva",b="ch",Bl="rh",AQ="va",w="olm",D="gdc",i="gda",Bx="layoutstyle",A4="hideVizBoxShadow",BK="stroke",BC="strokeWidth",Ag="strokeDasharray",j="fill",AB="fillOpacity";function B2(B8){return B8;}function AL(B8){return parseInt(B8,10);}var BB={name:"encode",_def:B2};BB[BJ]=function(B8){return B8?1:0;};BB[n]=function(B8){if(B8==="transparent"){return -1;}if(B8.length===4){B8=B8.replace(/([0-9a-f])/ig,"$1$1");}B8=p.rgbStr2hex(B8);return parseInt(B8.substring(5)+B8.substring(3,5)+B8.substring(1,3),16);};BB[y]=AL;BB[BZ]=function(B8){if(typeof B8==="number"){return B.toLocaleString(B8);}return B2(B8);};BB[A8]=function(CA){if(CA==="none"){return 0;}var B9=CA.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],B8=CA.match(/pt ([\w\W]*)/)[1];if(B9==="2pt"){return 5;}switch(B8){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var An={name:"decode",_def:B2};An[BJ]=function(B8){return parseInt(B8,10)===1;};An[n]=function(B8){if(B8===-1){return"transparent";}if(typeof B8==="number"){return p.decodeColor(B8);}if(B8.length===4){return B8.replace(/([0-9a-f])/ig,"$1$1");}return p.rgbStr2hex(B8);};An[y]=AL;An[A8]=function(CA){if(CA===undefined||CA===0){return"none";}var B9="1pt",B8="solid";if(CA===5){B9="2pt";}if(CA===3){B8="dashed";}else{if(CA===4){B8="dotted";}}return B9+" "+B8;};function Ad(){return this.pn.toLowerCase();}function Bj(B8,CA,CB){var B9=document.createElement("div");B9.style[CB||CA]=B8[CA];return B9;}function Ay(B8){return function(){return p.rgbStr2hex(B8.apply(this,arguments));};}function Ap(){var B8=Ad.call(this);return B8==="underline"?B8:"line-through";}var AJ={name:"extract"},BF=AJ._def=function(B8,CA,CB){var B9=Bj(B8,CA||this.getFormatBlockName(),CB);return B9.style[this.getCssName()];};AJ[n]=Ay(BF);function Aw(B8){return BF.call(this,B8,this.getFormatBlockName())===Ad.call(this);}function Av(B8){var B9=BF.call(this,B8,this.getFormatBlockName(),this.getCssName());return B9.indexOf(Ap.call(this))>-1;}function AW(B8){var B9=this.getFormatBlockName();return p.rgbStr2hex(BF.call(this,B8,B9,B9+this.pn));}var Bc={name:"resolve"},AC=Bc._def=function(B8,CB,CA,CC){CA=CA||this.getFormatBlockName();var B9=Bj(B8,CA);B9.style[CC||this.getCssName()]=CB;return B9.style[BP.convertCssToCamelCase(CA)];};Bc[n]=function(B8,CA,B9,CB){if(CA.or!==undefined){return CA;}return p.rgbStr2hex(AC.call(this,B8,CA,B9,CB));};function BG(B8,B9){return Am.multiReplace(AC.call(this,B8,B9?Ad.call(this):"normal"),{'"':"'"});}function AN(B8,B9){return Am.multiReplace(AC.call(this,B8,B9),{'"':"'"});}function o(B9,CB){var CA=(B9[this.getFormatBlockName()]||"").split(" "),B8=Ap.call(this);if(CB){if(CA.indexOf(B8)===-1){CA.push(B8);}}else{CA=CA.filter(function(CC){return CC!==B8;});}return AC.call(this,B9,CA.join(" "));}var Q={name:"update"},BA=Q._def=function(B8,B9){B8[this.getFormatBlockName()]=this.resolve(B8,B9);return B8;};var A2={};A2[Az]={ps:O,pn:"Name",pt:BZ};A2[Bg]={ps:Z,pn:"Height",pt:BZ};A2[s]={ps:Z,pn:"Width",pt:BZ};A2[BM]={ps:Z,pn:"WidthMode",pt:y};A2[AH]={ps:S,pn:"PageWidth",pt:BZ};A2[At]={ps:S,pn:"MarginLeft",pt:BZ,fn:"margin-left"};A2[Bq]={ps:S,pn:"MarginRight",pt:BZ,fn:"margin-right"};A2[AU]={ps:S,pn:"UsePageWidthAsLayoutWidth",pt:BJ};A2[As]={ps:m,pn:"Name",pt:BZ,fn:"font",cn:"fontFamily",extract:function(){return BF.apply(this,arguments).replace(/['"]/g,"");},resolve:function(B8,CA){var B9=Bj(B8,"font");B9.style.fontFamily="'"+CA+"'";return Am.multiReplace(B9.style.font,{'"':"'"});}};A2[BY]={ps:m,pn:"Size",pt:y,fn:"font",cn:"fontSize",resolve:AN};A2[AD]={ps:m,pn:"Bold",pt:BJ,fn:"font",cn:"fontWeight",extract:Aw,resolve:BG};A2[e]={ps:m,pn:"Italic",pt:BJ,fn:"font",cn:"fontStyle",extract:Aw,resolve:BG};A2[Bp]={ps:m,pn:"Underline",pt:BJ,fn:"text-decoration",extract:Av,resolve:o};A2[B1]={ps:m,pn:"Strikeout",pt:BJ,fn:"text-decoration",extract:Av,resolve:o};A2[Ah]={ps:m,pn:"Color",pt:n};A2[P]={ps:Aa,pn:[["TopPadding","BottomPadding"],["LeftPadding","RightPadding"]],pt:BZ};A2[W]={ps:AK,pn:"Horizontal",pt:y,fn:"text-align"};A2[Ac]={ps:AK,pn:"TextWrap",pt:BJ,fn:"white-space"};A2[AP]={ps:AK,pn:"TextDirection",pt:y};A2[l]={ps:AK,pn:"Vertical",pt:y};A2[k]={ps:Z,pn:"AutoSizeText",pt:BJ};A2[BR]={ps:Z,pn:"TextOverflow",pt:BJ};A2[K]={ps:O,pn:"TextFieldType",pt:BJ};A2[Ab]={ps:A1,pn:"FillColor",pt:n,x:A3,fn:"background-color",update:function(B8,CA){var B9=B8.fx;if(CA.or!==undefined){if(!B9){B9=B8.fx={};}var CB=B9.gd=B9.gd||{};CB.ec=CA.c2;CB.sc=CA.c1;CB.t=CA.or;delete B8[this.getFormatBlockName()];B8.fx=B9;}else{if(B9){delete B9.gd;}BA.call(this,B8,CA);}return B8;}};A2[J]={ps:A1,pn:"FillOpacity",pt:y,fn:"background-opacity"};A2[BH]={ps:A1,pn:"FillStyle",pt:y};A2[B4]={ps:A1,pn:"SelectorSelectionColor",pt:n};A2[H]={ps:A1,pn:"SelectorSelectionFillStyle",pt:y};A2[Bs]={ps:Bz,pn:"TopColor",pt:n,fn:"border",extract:AW};A2[BE]={ps:Bz,pn:"RightColor",pt:n,fn:"border",extract:AW};A2[Bf]={ps:Bz,pn:"BottomColor",pt:n,fn:"border",extract:AW};A2[Ao]={ps:Bz,pn:"LeftColor",pt:n,fn:"border",extract:AW};A2[Bb]={ps:Bz,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:n,fn:"border",extract:AW,resolve:Ay(function(B8,CA){var CB=this.getFormatBlockName(),B9=AC.call(this,B8,CA,CB,CB+"Color"),CC=B9.indexOf("rgb");if(CC>-1){B9=B9.slice(0,CC)+p.rgbStr2hex(B9.slice(CC));}return B9;})};A2[N]={ps:Bz,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:A8,fn:"border",extract:AW,resolve:function(B8,CB){var B9=CB.split(" "),CC=this.getFormatBlockName();if(!B8[CC]){B8[CC]="transparent";}B8[CC]=AC.call(this,B8,B9[0],CC,CC+"Width");var CA=AC.call(this,B8,B9[1]||"none",CC,CC+"Style"),CD=CA.indexOf("rgb");if(CD>-1){CA=CA.slice(0,CD)+p.rgbStr2hex(CA.slice(CD));}return CA;}};A2[c]={ps:Bz,pn:"TopStyle",pt:A8,fn:"border",extract:AW};A2[Bn]={ps:Bz,pn:"RightStyle",pt:A8,fn:"border"};A2[U]={ps:Bz,pn:"BottomStyle",pt:A8,fn:"border",extract:AW};A2[BT]={ps:Bz,pn:"LeftStyle",pt:A8,fn:"border",extract:AW};A2[AF]={ps:BQ,pn:"ZIndex",pt:y,fn:"z-index"};A2[AE]={ps:AV,pn:"UseAsInformationWindow",pt:BJ};A2[C]={ps:AV,pn:"ShowTitleBar",pt:BJ};A2[Ax]={ps:AV,pn:"Title",pt:BZ};A2[A0]={ps:AV,pn:"StyleForSwitchingPanel",pt:y};A2[Bw]={ps:AV,pn:"InformationWindowPlacement",pt:y};A2[Be]={ps:AV,pn:"TitleBarDisplay",pt:y};A2[t]={ps:M,pn:"InformationWindowTarget",pt:BZ};A2[Br]={ps:M,pn:"Style",pt:y};A2[AY]={ps:M,pn:"Orientation",pt:y};A2[x]={ps:M,pn:"OrientationBehavior",pt:y};A2[Bh]={ps:M,pn:"Multiselect",pt:BJ};A2[Al]={ps:M,pn:"AutoSearchEnabled",pt:BJ};A2[AG]={ps:M,pn:"ItemWidthMode",pt:y};A2[Bm]={ps:M,pn:"MetricConditionType",pt:y};A2[Bu]={ps:M,pn:"ShowElementCount",pt:y};A2[a]={ps:M,pn:"ExportAsShownOnWeb",pt:y};A2[Aq]={ps:Z,pn:"LayoutXML",pt:Ak};A2[B6]={ps:Z,pn:"LockAspectRatio",pt:BJ};A2[R]={ps:Z,pn:"ImageSizeMode",pt:y};A2[BL]={ps:Z,pn:"ImageHeight",pt:BZ};A2[AR]={ps:Z,pn:"ImageWidth",pt:BZ};A2[AA]={ps:AO,pn:"layoutBarPosition",pt:BZ};A2[Ae]={ps:AO,pn:"ExecutionFullScreenMode",pt:BJ};A2[Bx]={ps:AO,pn:"LayoutStyle",pt:y};A2[A4]={ps:AO,pn:"hideVizBoxShadow",pt:y};A2[AI]={ps:O,pn:"Visible",pt:BJ};A2[Af]={ps:BS,pn:"LongNames",pt:BZ};A2[B7]={ps:BS,pn:"ParentPosition",pt:BZ};A2[w]={ps:BS,pn:"Indented",pt:y};A2[Bd]={ps:Bv,pn:"ShowAllRows",pt:BZ};A2[B3]={ps:Bv,pn:"HideNullZeroValues",pt:BZ};A2[BU]={ps:Aa,pn:["LeftPadding","RightPadding"],pt:BZ};A2[AM]={ps:Aa,pn:["TopPadding","BottomPadding"],pt:BZ};A2.rowsshw={ps:BS,pn:"ShowRowHeaders",pt:BZ};A2.rowsmg={ps:BS,pn:"MergeCells",pt:BZ};A2[A7]={ps:BS,pn:"LockRowHeaders",pt:BZ};A2.colsshw={ps:BS,pn:"ShowColumnHeaders",pt:BZ};A2.colsmg={ps:BS,pn:"MergeColumnCells",pt:BZ};A2[Bi]={ps:BS,pn:"LockColumnHeaders",pt:BZ};A2[Ar]={ps:BS,pn:"SubtotalFormatUseRowHeaders",pt:BZ};A2[G]={ps:BS,pn:"SubtotalFormatUseColumnHeaders",pt:BZ};A2[B0]={ps:BS,pn:"SubtotalFormatUseValues",pt:BZ};A2[By]={ps:u,pn:"RefreshFrequency",pt:y};A2[BI]={ps:L,pn:"Join Across Datasets",pt:y};A2[f]={ps:L,pn:"MCE Join To Get Data Combination",pt:y};A2[BX]={ps:BD,pn:"OnDemandEvaluation",pt:y};A2[F]={ps:Au,pn:"ShowBaseViewInLibrary",pt:y};A2[BV]={ps:BD,pn:"OnDemandDUPopulation",pt:y};A2[A]={ps:O,pn:"Highlight",pt:y};A2[Y]={ps:Ba,pn:"Category",pt:y};A2[h]={ps:Ba,pn:"Format",pt:BZ};A2[Ai]={ps:Ba,pn:"CurrencySymbol",pt:BZ};A2[BN]={ps:Ba,pn:"DecimalPlaces",pt:y};A2[AT]={ps:Ba,pn:"CurrencyPosition",pt:y};A2[E]={ps:Ba,pn:"NegativeNumbers",pt:y};A2[AS]={ps:Ba,pn:"ThousandSeparator",pt:y};A2[Bk]={ps:O,pn:"GroupInfo",pt:BZ};A2[D]={ps:A1,pn:"GradientColor",pt:n};A2[i]={ps:A1,pn:"GradientAngle",pt:y};Aj.forEach(AZ.keyarray(A2),function(B8){var B9=A2[B8];B9.getFormatBlockName=function(){var CB=this.fn;if(!CB){var CA=this.pn;CB=CA.charAt(0).toLowerCase()+CA.substr(1);}return CB;};B9.getCssName=function(){var CA=this.getFormatBlockName.call(this),CB=this.cn;if(!CB){CB=BP.convertCssToCamelCase(CA);}return CB;};Aj.forEach([BB,An,AJ,Bc,Q],function(CA){var CB=CA.name;B9[CB]=B9[CB]||CA[B9.pt]||CA._def;});});function B5(CA,B8,B9){var CD=B9[CA.ps]=B9[CA.ps]||{},CG=CA.pn,CF=Aj.isArray(CG)&&Aj.isArray(CG[0]);B8=CA.encode(B8);if(CF){for(var CE=0;CE<CG.length;CE++){var CC=B8&&B8.split(" ")[CE]||B8,CB=CG[CE];Aj.forEach([].concat(CB),function(CH){CD[CH]=CC;});}}else{Aj.forEach([].concat(CG),function(CH){CD[CH]=B8;});}return B9;}function d(CE,CD,B8){var CC=CE.x;if(CC){if((CC&A3)>0){var CB=!!CD.c1,CA=0;if(CB){B5(CE,CD.c1,B8);var B9=B8[A1];B9.GradientColor=CE.encode(CD.c2);B9.GradientAngle=CD.or?0:90;B9.GradientXOffset=0;B9.GradientYOffset=0;CA=2;}else{if(CE.encode(CD)===-1){CA=1;}else{B5(CE,CD,B8);}}return B5(A2[BH],CA,B8);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function X(B9,CC,B8){var CB=A2[B9];if(!CB){throw new Error("Invalid property "+B9+" in FormatModel::getFormatUpdate.");}B8=B8||{};var CA=d.call(this,CB,CC,B8);if(CA){return CA;}return B5(CB,CC,B8);},getUnsetFormatUpdate:function Bt(B9,CA,B8){return{unset:this.getFormatUpdate(B9,CA,B8)};},getFormatPropertyInfo:function BO(B8){return A2[B8];},getValueFromUpdate:function g(B9,CA){var CC=A2[B9],B8=null;try{B8=CA[CC.ps][CC.pn];}catch(CB){}return B8;},getGradientValues:function A9(B9){var B8=B9.fx&&B9.fx.gd;if(B8){var CB={c1:B8.sc,c2:B8.ec,or:B8.t};return CB;}if(B9[BH]===2){if(!!B9.bc.c1){return B9.bc;}var CA={c1:B9.bc,c2:B9.gdc,or:B9.gda===90?0:1};return CA;}return null;},decodeGradientValue:function A5(B8){if(B8&&B8.c1){B8.c1=this.decodeValue(D,B8.c1);B8.c2=this.decodeValue(D,B8.c2);return B8;}return null;},decodeValue:function q(B8,B9){return A2[B8].decode(B9);},updateFormatBlock:function z(B8,B9,CA){return A2[B9].update(B8,CA);},getFormatBlockValue:function BW(B8,B9){return A2[B9].extract(B8);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:Az,HEIGHT:Bg,WIDTH:s,WIDTH_MODE:BM,PAGE_WIDTH:AH,MARGIN_LEFT:At,MARGIN_RIGHT:Bq,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:AU,FONT_FAMILY:As,FONT_SIZE:BY,FONT_WEIGHT:AD,FONT_STYLE:e,UNDERLINE:Bp,LINE_THROUGH:B1,COLOR:Ah,TEXT_PADDING:P,TEXT_ALIGN:W,VERTICAL_ALIGN:l,TEXT_WRAP:Ac,TEXT_DIRECTION:AP,AUTO_SIZE_TEXT:k,TEXT_OVERFLOW:BR,TEXT_TYPE:K,BACKGROUND_COLOR:Ab,FILL_OPACITY:J,FILL_STYLE:BH,GRADIENT_COLOR:D,GRADIENT_ANGLE:i,BORDER_TOP_COLOR:Bs,BORDER_RIGHT_COLOR:BE,BORDER_BOTTOM_COLOR:Bf,BORDER_LEFT_COLOR:Ao,BORDER_TOP_STYLE:c,BORDER_RIGHT_STYLE:Bn,BORDER_BOTTOM_STYLE:U,BORDER_LEFT_STYLE:BT,BORDER_COLOR:Bb,BORDER_STYLE:N,Z_INDEX:AF,USE_AS_INFO_WINDOW:AE,SHOW_TITLE_BAR:C,TITLE:Ax,CONTROL_IFW:t,CONTROL_STYLE:Br,CONTROL_ORIENTATION:AY,CONTROL_ORIENTATION_BEHAVIOR:x,CONTROL_MULTISELECT:Bh,CONTROL_AUTOSEARCH:Al,CONTROL_ITEM_WIDTH_MODE:AG,CONTROL_METRIC_CONDITION_TYPE:Bm,CONTROL_SHOW_ELEMENT_COUNT:Bu,CONTROL_EXPORT_AS_SHOWN_ON_WEB:a,LAYOUT_XML:Aq,LOCK_ASPECT_RATIO:B6,IMAGE_SIZE_MODE:R,SHOW_HEADER:I,MERGE_HEADER:AX,LOCK_HEADER:A6,LOCK_ROW_HEADER:A7,LOCK_COL_HEADER:Bi,LONG_NAME:Af,PARENT_POSITION:B7,SHOW_ALL_ROWS:Bd,HIDE_NULL:B3,IMAGE_WIDTH:AR,IMAGE_HEIGHT:BL,VISIBLE:AI,LAYOUT_TAB_POSITION:AA,GRID_VERTICAL_PADDING:AM,GRID_HORIZONTAL_PADDING:BU,REFRESH:By,JOIN_ACROSS_DATASET:BI,MCE_JOIN_TO_GET_DATA_COMBINATION:f,ON_DEMAND_EVALUATION:BX,BASE_VIEW_IN_LIBRARY:F,OPTIMIZE_DERIVED_OBJ:BV,FULL_SCREEN_MODE:Ae,SELECTOR_SELECTION_COLOR:B4,SELECTOR_SELECTION_FILL_STYLE:H,VIZ_HIGHLIGHTING:A,GROUP_INFO:Bk,SUBTOTAL:Bo,SUBTOTAL_FORMAT_USE_ROWHEADERS:Ar,SUBTOTAL_FORMAT_USE_COLUMNHEADERS:G,SUBTOTAL_FORMAT_USE_VALUES:B0,FMT_COL_HEADER:b,FMT_ROW_HEADER:Bl,FMT_VALUES:AQ,OUTLINE:w,LAYOUT_STYLE:Bx,VIZ_BOX_SHADOW_HIGHLIGHT:A4,SVG_STROKE:BK,SVG_STROKE_WIDTH:BC,SVG_STROKE_DASHARRAY:Ag,SVG_FILL:j,SVG_FILL_OPACITY:AB,STYLE_FOR_SWITCHING_PANEL:A0,INFO_WINDOW_PLACEMENT:Bw,TITLE_SRC:Be},ENUM_PROPERTY_SETS:{FORMATTING_NUMBER:Ba},ENUM_NUMBER_FORMAT_KEYS_OBJ:{CATEGORY:Y,CURRENCY_POSITION:AT,CURRENCY_SYMBOL:Ai,DECIMAL_PLACES:BN,FORMAT:h,NEGATIVE_NUMBERS:E,THOUSAND_SEPARATOR:AS},ENUM_REACT_FORMAT_TABS:{PROPERTY_TAB:"PROPERTY_TAB",TEXT_FORMAT_TAB:"TEXT_FORMAT_TAB",TITLE_TAB:"TITLE_TAB"}};}());(function(){mstrmojo.requiresClsP("mstrmojo","hash","css","array","RaErrorHandler","desc");var S=mstrmojo.hash,n=mstrmojo.func,B=mstrmojo.css,K=mstrmojo.RaErrorHandler,h=mstrmojo.array;var E={lv:-1,hcd:false,epd:false,hid:false,dhid:false,children:[],displayChildren:[],parent:null,displayParent:null},l={rootItems:{},items:[],itemMap:{}};var m="hidden",C="expanded",s="collapsed",J="hierarchy",e="hasChildren",q="u;",Z=10,N=7,p=32;mstrmojo.ui._IsHierarchyList=mstrmojo.provide("mstrmojo.ui._IsHierarchyList",{_mixinName:"mstrmojo.ui._IsHierarchyList",itemValueField:"v",init:function o(t){this._super(t);this.clearItems();},getItemProps:function i(w,t){var u=this._super(w,t),x=0;if(w.hcd){u.addCls(e);}if(w.v===q){u.addCls(m);}if(this.isHiearachyDisplay()){u.addCls(J);if(w.hid){u.addCls(m);}x=w.lv>=0?w.lv*Z:0;}u.indent=x;return u;},_getItemNode:function U(t){var u=this.itemsContainerNode;return h.filterOne(u&&u.childNodes,function(w){return parseInt(w.getAttribute("idx"),10)===t;});},_buildItemsMarkup:function k(AA,u,w,x,y,z){var t;if(this.isHiearachyDisplay()){t=this._buildDescendantsMarkup();}else{t=this._super(AA,u,w,x,y,z);}return t;},_buildDescendantsMarkup:function c(AA,y){var AD=[],z=this.itemRenderer&&this.itemRenderer.render,AB=AA?(y?[AA]:AA.displayChildren):(this.raad?this.getDisplayRoots():this.getRootItems()),u=this.blockCount,x=function(AE){if(!AE.hid&&!AE.dhid){AD.push(z(AE,AE.idx,this));}if(AE.epd||AE.hid){h.forEach(AE.displayChildren,function(AG,AF){return AC.call(this,AG,AF);},this);}},AC=function(AF,AE){if(this.raad&&AE>=u){var AG=this.createRenderer(AF.lv,AF.displayParent,AF.parent,this.items.length,AE);this.items.push(AG);if(AG.displayParent){AG.displayParent.displayChildren.push(AG);}if(AG.parent){AG.parent.children.push(AG);}x.call(this,AG);return false;}else{x.call(this,AF);}};if(z&&typeof z==="function"){if(this.raad&&!AA){if(AB.length>u){var t=AB.slice(0,u),w=this.createRenderer(AB[u-1].lv,null,null,this.items.length,u);this.items.push(w);AB.push(w);t.push(w);AD=this._buildSiblingsMarkup(t);}else{AD=this._buildSiblingsMarkup(AB);}}else{h.forEach(AB,function(AF,AE){return AC.call(this,AF,AE);},this);}}return AD;},getItems:function W(){return this.items;},getItemByValue:function D(t){return this.itemMap[t];},isRootItem:function(t){return t.lv>=0&&t.v!==q&&!t.pid&&!t.parent;},getRootItems:function f(){return S.valarray(this.rootItems);},getDisplayRoots:function a(){if(!this.displayRoots){var w=this.displayRoots=[],t=this.getRootItems(),u=function(x){h.forEach(x,function(y){if(!y.hid){w.push(y);}if(y.epd||y.hid){u(y.displayChildren);}});};u(t);}if(!this.initialDisplayRoots){this.initialDisplayRoots=w.slice();}return this.displayRoots;},getInitialDisplayRoots:function A(){if(!this.initialDisplayRoots){this.initialDisplayRoots=(this.getDisplayRoots()||[]).slice();}return this.initialDisplayRoots;},createRenderer:function I(y,u,x,t,w){return{n:mstrmojo.desc(1005,"More..."),lv:y,displayParent:u,parent:x,idx:t,fetcher:true,fake:true,config:{nextSiblingIdx:w}};},getItemAncestorMap:function F(u){var t=this.itemValueField,w={};while(u&&u[t]){w[u[t]]=true;u=u.parent;}return w;},getItemDescendantMap:function b(w){var t=this.itemValueField,x={},u=function(y){x[y[t]]=true;h.forEach(y.children,function(z){u(z);});};u(w);return x;},clearItems:function j(){var t=this.itemsContainerNode;S.copy(S.clone(l),this);if(t){t.innerText="";this.updateScrollbars();}},addItems:function g(z,w){var u=this.items,y=this.itemMap,t=this.rootItems,x=this.itemValueField,AB=[];h.forEach(z,function(AC){var AF=AC[x],AD=this.getItemByValue(AF),AE=S.copy(AC,(AD?AD:S.clone(E)));if(!AD){AE.idx=u.length;u.push(AE);if(AF){y[AF]=AE;}}if(this.isRootItem(AE)){t[AF]=AE;}AB.push(AE);},this);h.forEach(AB,function(AE){var AC=this.getItemByValue(AE.pid),AD=this.getItemByValue(AE.dpid)||AC;if(AC){if(!AE.parent){AE.parent=AC;AC.children.push(AE);}if(!AE.hid&&!AE.dhid&&!AE.displayParent){AD.hcd=true;AE.displayParent=AD;AD.displayChildren.push(AE);}}delete AE.pid;delete AE.dpid;},this);if(!w){if(this.postAddItems){this.postAddItems(AB);}var AA=this.itemsContainerNode;if(AA){if(this.isHiearachyDisplay()){this.refresh();}else{AA.innerHTML+=this._buildSiblingsMarkup(this.getFlatDisplayItems(AB)).join("");this.updateScrollbars();}}}return AB;},addSiblingItems:function G(AB,y){var x=this.getItemByValue(y),u;if(x){h.forEach(AB,function(AD){if(AD.v!==y){AD.pid=AD.pid||y;}});}u=this.addItems(AB,true);if(this.postAddSiblingItems){this.postAddSiblingItems(u,x);}var z=this.itemsContainerNode;if(z&&this.isHiearachyDisplay()){var AA=this._buildSiblingsMarkup(u).join("");if(!y){z.innerHTML+=AA;}else{if(x){var AC={},w=this._getItemNode(x.idx),t;if(w){AC[x.v]=true;while(w.nextSibling){t=this.getItemFromTarget(w.nextSibling);if(t&&t.displayParent&&AC[t.displayParent.v]){AC[t.v]=true;w=w.nextSibling;}else{break;}}w.outerHTML+=AA;}}}this.updateScrollbars();}return u;},addBranchItems:function M(u,y){var t=this.getItemByValue(y),x;if(t){h.forEach(u,function(AA){AA.pid=AA.pid||y;});}x=this.addItems(u,true);if(this.postAddBranchItems){this.postAddBranchItems(x,t);}var w=this.itemsContainerNode;if(w&&this.isHiearachyDisplay()){if(!y){h.forEach(x,function(AA){if(this.isRootItem(AA)){w.innerHTML+=this._buildDescendantsMarkup(AA,true).join("");}},this);}else{if(t){var z=this._getItemNode(t.idx);if(z){z.outerHTML+=this._buildDescendantsMarkup(t).join("");}}}this.updateScrollbars();}return x;},updateItems:function H(t,u){if(u){h.forEach(t,function(AA,x,y){var z=u[x],w=y[z.p_index];if(w){AA.pid=w.v;}});}this.handleOriginalParent(t,u);this.setDisplayParent(t,u);this.clearItems();this.addItems(t,true);},handleOriginalParent:function Q(t,u){if(u){h.forEach(t,function(AB,x,y){var AA=u[x],w=y[AA.p_index],z=y[AA.original_p_index];if(w&&w.t===N&&AB.lv!==w.lv&&z&&z.pid===w.v){AB.pid=z.v;}});}},setDisplayParent:function L(t,y,x){if(x){this.idMap=this.idMap||{};h.forEach(t,function(AA){this.idMap[AA.v]=AA;},this);}var w=this,u=function(AC,AB){var AA;if(!x&&y){var AD=y[AB].p_index;AA=t[AD];}else{if(x){AA=w.idMap[AC.pid];}}return AA;};h.forEach(t,function z(AD,AB,AC){var AA=u(AD,AB);if(!AA||w.isRootItem(AD)){return AD.v;}if(!AD.dpid){AD.dpid=AA.hid?z(AA,y&&y[AB]&&y[AB].p_index,AC):AA.v;}return AD.dpid;});},fetchItems:function X(x,AA){if(this.raad&&this.isHiearachyDisplay()&&(this.items||[]).length>0){return ;}x=x||{};var u=this,t=x.branch,z=x.browseFlags&p,y=parseInt(x.level,10),w=y>=0;this.fetchItemsThroughTaskCall(x,n.wrapMethods(AA,{success:function(AB){if(u.raad===undefined&&AB&&u.isHiearachyDisplay()){u.raad=AB.raad;}if(AB&&AB.es){var AC=AB.es;if(y===(t&&t.lv+1||0)||(z&&!u.raad)){u.addSiblingItems(AC,t&&t.v);}else{if(t&&!w){u.addBranchItems(AC,t.v);}else{u.addItems(AC);}}}},failure:function(AB){K.handleRAPopUpError(AB);}}));},updateItemNodesStatus:function Y(){var t=this.itemsContainerNode&&this.itemsContainerNode.childNodes;h.forEach(t,function(w){var u=this.getItemFromTarget(w);if(u){B.toggleClass(w,CSS_SELECTED,u.isSelected);}},this);},_buildSiblingsMarkup:function P(w){var t=[],u=this.itemRenderer&&this.itemRenderer.render;if(u&&typeof u==="function"){h.forEach(w,function(x){t.push(u(x,x.idx,this));},this);}return t;},toggleCollapseExpandCss:function R(u,t){B.toggleClass(u,s,!t);B.toggleClass(u,C,t);},doExpandCollapse:function d(t,AC){var AD=!AC.epd;AC.epd=AD;this.toggleCollapseExpandCss(t,AD);if(!this.isHiearachyDisplay()){return ;}var AA=this.getItemDescendantMap(AC),w,AB;if(AD){var u=AC.displayChildren&&AC.displayChildren[0];if(u){var y=this.getItemFromTarget(t.nextSibling);if(y&&y.displayParent===AC){var z={},x;w=t.nextSibling;while(w){AB=this.getItemFromTarget(w);x=AB&&AB.displayParent;if(!x||!AA[AB.v]){break;}if(z[x.v]){B.addClass(w,m);z[AB.v]=true;}else{B.removeClass(w,m);if(!AB.epd){z[AB.v]=true;}}w=w.nextSibling;}}else{t.outerHTML+=this._buildDescendantsMarkup(AC).join("");}}else{this.fetchItems({branch:AC,level:AC.lv+1});}}else{w=t.nextSibling;while(w){AB=this.getItemFromTarget(w);if(!AB||!AA[AB.v]){break;}B.addClass(w,m);w=w.nextSibling;}}this.updateScrollbars();},isHiearachyDisplay:function O(){return true;},fetchItemsThroughTaskCall:mstrmojo.emptyFn,getFlatDisplayItems:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J=mstrmojo.dom,A=false,M=3.5,N=5,I=1,O=2;function D(f,R){var Y=R.parentRect.x||R.parentRect.left,c=R.parentRect.y||R.parentRect.top,Z={},W=R.info&&R.info.min,e=R.info&&R.info.max,b=R.target,d=b&&b.getAttribute("pos"),g=d&&parseInt(d,10),U=b&&!b.isSide;Z.x=Math.min(Math.max(W.x,J.getMousePosition(f,window).x),e.x);Z.y=Math.min(Math.max(W.y,J.getMousePosition(f,window).y),e.y);var X=R.targetContainer,Q=R.skipGuideOperation,a=X.parent.snapGuide,P=!Q?a.findIntersect(Z.y-c,"y"):null,S=!Q?a.findIntersect(Z.x-Y,"x"):null;Z.y=P?parseFloat(P.mid)+c:Z.y;Z.x=S?parseFloat(S.mid)+Y:Z.x;Z.shouldYSnap=P!==null;Z.shouldXSnap=!!S&&((g===O)||(U&&g===I));return Z;}function B(P,Q){var e=Q.parentRect,R=Q.parentScrollPos,i=(e.x||e.left)+R.scrollLeft,S=(e.y||e.top)+R.scrollTop,W=Q.targetContainer,j=W.parent.snapGuide,c=P.x-i,X=P.width,Z=c+X,Y=P.y-S,f=P.height,g=Y+f,k=[c,Z,null,Y,g,null].reduce(function(h,l,b){var n=null;if(l!==null&&!Q.skipGuideOperation){n=j.findIntersect(l,Math.floor(b/3)?"y":"x");}h.push(n);return h;},[]);if(!Q.skipGuideOperation){W.updateGuidesDiv(Q.highLight,k,e);}[].forEach.call(Q.boxOverlay.children,function(h,b){mstrmojo.hash.copy({left:((b%2?P.x-i:b?P.x-i+P.width:P.x-i))+"px",top:((b%2?b&2?P.y-S+P.height:P.y-S:P.y-S))+"px",width:(b%2?P.width:3)+"px",height:(b%2?3:P.height)+"px"},h.style);});if(J.isIE11){var a=mstrmojo.hash.walk("targetContainer.parent.containerNode",Q),m=a&&a.getBoundingClientRect(),U=a&&Math.floor(m.left),d=a&&Math.floor(m.top);[].forEach.call(Q.boxOverlay.children,function(b){b.style.transform="translate("+U+"px, "+d+"px)";});}}function K(R,P,Q){return function(S){R.call(mstrmojo.all[P],S,Q);};}function C(Q,S){var X={},U=S.targetContainer,R=(U&&!!U.getBoxBorderWidth)?U.getBoxBorderWidth()/2:0;var W=Q.y+S.parentScrollPos.scrollTop,P=Q.x+S.parentScrollPos.scrollLeft;if(S.isSide){if(S.isV){X.x=P>S.info.axis.x?S.info.axis.x-R:P;X.y=S.info.axis.y-R;X.width=Math.abs(P-S.info.axis.x)+(Q.shouldXSnap?0:M);X.height=S.boxRect.height;}else{X.x=S.info.axis.x-R;X.y=W>S.info.axis.y?S.info.axis.y-R:W;X.width=S.boxRect.width;X.height=Math.abs(W-S.info.axis.y);}}else{X.x=P>S.info.axis.x?S.info.axis.x-R:P;X.y=W>S.info.axis.y?S.info.axis.y-R:W;X.width=Math.abs(P-S.info.axis.x)+(Q.shouldXSnap?0:N);X.height=Math.abs(W-S.info.axis.y);}return X;}function L(P,Q){var R=D(P,Q);B(C(R,Q),Q);}function H(Z,P){if(!A){return ;}J.detachEvent(window.document,"mousemove",P.fnMove);J.detachEvent(window.document,"mouseup",P.fnUp);A=false;mstrApp.setInteractive(true);(this.children||[]).forEach(function(a){a.domNode.style.pointerEvents="inherit";});var X=D(Z,P),W=C(X,P),Q=P.targetContainer,R=(Q&&!!Q.getBoxBorderWidth)?Q.getBoxBorderWidth()/2:0,U=P.target,S;if(R!==0&&U&&Q){if(U.className==="resizer"&&Q.resizerCache){S=Q.resizerCache.indexOf(U);if(S<=1){W.height+=R;}if(S===0||S===3){W.width+=R;}}else{if(U.className==="edge"&&Q.splitterCache){S=Q.splitterCache.indexOf(U);if(S===0){W.width+=R;}else{if(S===1){W.height+=R;}}}}}this.resizerMouseUp(W,P);var Y=P.highLight;if(Y){this.toggleGuidesDiv(Y,false);delete P.highLight;}delete P.fnMove;delete P.fnUp;delete P.boxOverlay;}function G(Q){if(A){return ;}if(!this.resizable){return ;}if(this.boxContentDisAllowResizing&&this.boxContentDisAllowResizing()){return ;}mstrApp.setInteractive(false);var U={},X=J.eventTarget(window,Q);U.boxRect=this.domNode.getBoundingClientRect();U.info=this.getResizerInfo(X.getAttribute("pos")^2,X.isSide);U.startPos=J.getMousePosition(Q,window);U.target=X;if(X.isSide){U.isSide=X.isSide;}U.isV=X.isV;(this.children||[]).forEach(function(Z){Z.domNode.style.pointerEvents="none";});var P=this.parent.parentRect||this.domNode.parentNode.getBoundingClientRect();U.highLight=this.createGuidesDiv(P);this.toggleGuidesDiv(U.highLight,true);U.boxOverlay=document.createElement("div");U.targetContainer=this;for(var S=0;S<4;++S){var Y=document.createElement("div");Y.setAttribute("pos",S);Y.style.position="fixed";Y.style.background="#4286f4";U.boxOverlay.appendChild(Y);}this.resizerMouseDown(U);var W=K(L,this.id,U),R=K(H,this.id,U);J.attachEvent(window.document,"mousemove",W);J.attachEvent(window.document,"mouseup",R);U.fnMove=W;U.fnUp=R;A=true;Q.stopPropagation();}mstrmojo.vi.ui.rw._boxCornerResizer=mstrmojo.provide("mstrmojo.vi.ui.rw._boxCornerResizer",{_mixinName:"mstrmojo.vi.ui.rw._boxCornerResizer",registerResizerHandler:function E(P){this.resizerEvtMouseDownHandler=K(G,this.id);J.attachEvent(P,"mousedown",this.resizerEvtMouseDownHandler);},unregisterResizerHandler:function F(P){if(this.resizerEvtMouseDownHandler){J.detachEvent(P,"mousedown",this.resizerEvtMouseDownHandler);}},getResizerInfo:mstrmojo.emptyFn,resizerMouseUp:mstrmojo.emptyFn,resizerMouseDown:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,G=100,L=700;var B="mojo-safari-hide-nativeTooltip",H=mstrmojo.css;function M(O,N){return function(Q){var P=mstrmojo.all[O];if(P.customTooltipHandler){P.customTooltipHandler(Q);}P[(N?"move":"show")+"Tooltip"](Q,self);};}function A(){var O=this.tooltipNode||this.domNode,Q=this.id,N,P="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(R){mstrmojo.all[Q].hideTooltip(R,self);};}if(!this[P]){this[P]=M(Q,this.isDynamicTooltip);}O=[].concat(O);for(N=0;N<O.length;N++){O[N].removeAttribute("title");C.attachEvent(O[N],(this.isDynamicTooltip?"mousemove":"mouseover"),this[P]);C.attachEvent(O[N],"mouseout",this._ontooltipout);}}function I(){var Q=this.tooltipNode||this.domNode,P;if(Q&&Q.constructor!==Array){Q=[Q];}if(Q){var R=this._ontooltipover,O=this._ontooltipout,N=this._ontooltipmove;for(P=0;P<Q.length;P++){if(R){C.detachEvent(Q[P],"mouseover",R);}if(O){C.detachEvent(Q[P],"mouseout",O);}if(N){C.detachEvent(Q[P],"mousemove",N);}}}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,isIgnoreTooltipCloseDelay:false,hasWidgetContent:false,tooltipCloseDelay:G,hasOpenTooltip:false,postBuildRendering:function(){var N=this._super();if(this.useRichTooltip){A.call(this);}return N;},onuseRichTooltipChange:function K(){if(this.hasRendered){if(this.useRichTooltip){A.call(this);}else{I.call(this);this.hideTooltip();}}},showTooltip:function J(Q,P){var O=this;if(!O.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(Q);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var S={};for(var N in Q){S[N]=Q[N];}Q=S;}var U=this.richTooltip?this.richTooltip.areaId:undefined;if(C.isSafari&&Q){var R=Q.srcElement;if(window.getComputedStyle(R)["text-overflow"]==="ellipsis"){this.baseElement=R;H.toggleClass(R,B,true);}}this._tooltipTimeOut=window.setTimeout(function(){var W=O.richTooltip;if(O._closeTooltipTimeout){window.clearTimeout(O._closeTooltipTimeout);delete O._closeTooltipTimeout;}mstrmojo.tooltip.open(O,Q,P);O.tooltip.onmouseover=function(){if(O.richTooltip&&O.richTooltip.enableHover){window.clearTimeout(O._closeTooltipTimeout);window.clearTimeout(O._deactivationTimeout);if(O.tooltip){O.tooltip.onmouseout=function(X){var Y=X.e;if((!Y.toElement&&!Y.relatedTarget)||!C.contains(this.domNode,X.e.toElement||X.e.relatedTarget)){O.hideTooltip();}};}}};O.tooltip.allowOtherTooltips=O.allowOtherTooltips;if(W&&W.onClose){O.tooltip.onClose=W.onClose;}O.hasOpenTooltip=true;O._hasActiveArea=true;O._tooltipAreaId=U;window.clearTimeout(O._deactivationTimeout);delete O._deactivationTimeout;},(this._hasActiveArea&&U&&U===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function D(N,P){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var R=this,O=N,Q=P;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(R,O,Q);},this.tooltipOpenDelay);},hideTooltip:function F(){var N=this;if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);}if(C.isSafari&&this.baseElement){H.toggleClass(this.baseElement,B,false);}if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete N._deactivationTimeout;delete N._hasActiveArea;delete N._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if((!this.isIgnoreTooltipCloseDelay)&&N.richTooltip&&N.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete N._closeTooltipTimeout;},N.richTooltip.tooltipCloseDelay||this.tooltipCloseDelay);}else{if(N.tooltip){this.isIgnoreTooltipCloseDelay=false;mstrmojo.tooltip.close();}}this.hasOpenTooltip=false;},unrender:function E(N){I.call(this);this.hideTooltip();this._super(N);}});mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY=L;mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY=G;}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});mstrmojo.ui._HasUITheme.EnumThemeNames={LIGHT_THEME:"mojo-theme-light",DARK_THEME:"mojo-theme-dark"};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(X){if(!X.pageSize||X.pageSize<=0){var Y=X.scrollboxNode;X.pageSize=Y&&Y.clientHeight||0;}return X.pageSize;}function U(X,Y){if(X.usePaging){X.totalPages=1;var a=X.itemsContainerNode,Z=B(X);if(X.usePaging&&a&&Z){X.totalPages=Math.ceil((a.clientHeight-parseInt(a.style&&a.style.paddingBottom||0,10))/Z);}if(a){X.itemsContainerNode.style.paddingBottom=Z+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(X){return'<div class="'+this.getWrapperCss(X)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(X){return X&&X.childNodes;},wrapperParentNode:function D(X){return X;},createWrapperNode:function G(X){var Y=X&&X.ownerDocument,Z=Y.createElement("div");return Z;},findScrollRange:function N(m,b,l,q,Y,e,s,o){if(!b){return{start:0,end:0};}var g=this.wrapperNodes(m),k=parseInt(b/2,10),a=parseInt(Math.log(b)/Math.log(2),10),Z=0,X=b-1,j=l+q,f=g[0].offsetTop,d;for(var n=1;n<=a;n++){d=g[k].offsetTop-f+o;if(d<l){Z=k;}else{if(d>j){X=k;}}var c=Math.round(b/Math.pow(2,n+1));k+=(d>l)?-c:c;k=Math.min(Math.max(0,k),b-1);}return{start:Z,end:X};},findWrapper:function L(Z,X){var Y=this.wrapperNodes(Z);return Y&&Y[X];},findIndex:function F(X,a,Z){var Y=this._nd2iw(X,a,Z);return Y?this._iw2idx(X,a,Y):-1;},itemOffsetTop:function W(Y,c,X,a){if(!a){var Z=this.wrapperNodes(c);a=Z&&Z[X];if(!a){return 0;}}var b=c.firstChild;if(!b||(b===a)){return 0;}else{return a.offsetTop-b.offsetTop;}},whereDrop:function S(e,X,Z,d,Y){var a=this._nd2iw(e,X,Z),f,c,g;if(a){c=this._iw2idx(e,X,a);f=c;g=this.itemOffsetTop(e,X,null,a);var b=a.offsetHeight;if(d.y>Y.top+g+b/2){f++;g+=b;}}else{return e.dropCuePos;}return{left:0,top:g,idx:f,idxActual:c};},getWrapperCss:function(X){return K;},postBuildRendering:function(b,a,Z,Y,X){U(Y,this);},buildItemWrappers:function P(g,d,l,f,c,m){var n=this.itemWrapperPrefix(l),i=this.itemWrapperSuffix,b=n+this.itemWrapperPrefill+i,a=[this.markupPrefix],Y=1,X=l.selectedIndices||{},p=function o(k,j){for(var q=k;q<j;q++){a[Y++]=n;var t=d.build(l,f,g[q],q);if(X[q]){t=t.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}a[Y++]=t;a[Y++]=i;}};var e=(g&&g.length)||0;c=c&&d?Math.min(c,e):0;if(c){p(0,c);}m=m&&d?Math.min(m,e-c):0;var h=e-m;for(var Z=c;Z<h;Z++){a[Y++]=b;}if(m){p(h,e);}a.push(this.markupSuffix);return a;},fillItemWrappers:function H(Z,j,f,o,h,Y,d,n){var g=(j&&j.length)||0,m=this.wrapperNodes(Z),q=h.itemStatus,X=mstrmojo.css,b=o.selectedIndices||{};for(var e=Y,l=Math.min(d+1,g),c=0;e<l;e++){if(q[e]!==A){m[e].innerHTML=f.build(o,h,j[e],e);if(b[e]){var a=m[e].firstChild;if(a){X.addClass(a,["selected"]);}}c++;if(c===n){break;}}}return c;},onadd:function O(g,X,b,h){if(X&&h){var d=h.value.length,e=this.wrapperNodes(X),f=e[h.index],a=this.getWrapperCss(g);for(var Z=0;Z<d;Z++){var Y=this.createWrapperNode(X);Y.className=a;Y.innerHTML=J;if(f){this.wrapperParentNode(X).insertBefore(Y,f);}else{this.wrapperParentNode(X).appendChild(Y);}}U(g,this);}},onremove:function Q(a,e,X,Z){if(e&&Z){var d=this.wrapperNodes(e);if(d){var f=Z.value.length;for(var b=Z.index+f-1,Y=Z.index;b>=Y;b--){if(d[b]){this.wrapperParentNode(e).removeChild(d[b]);}}}U(a,this);}},onchange:function R(k,Z,e,m){if(Z&&m){var f=this.wrapperNodes(Z);if(f){var Y=mstrmojo.css,n=e.itemStatus,l;for(var d=0,X=m.removed,h=X&&X.length;d<h;d++){l=X[d];if(n[l]){Y.removeClass(f[l].firstChild,["selected"]);}}for(var c=0,g=m.added,b=g&&g.length;c<b;c++){l=g[c];if(n[l]){Y.addClass(f[l].firstChild,["selected"]);}}}}},_nd2iw:function E(Y,b,a){b=this.wrapperParentNode(b);if(b&&a&&b!==a){var X=Y.domNode,Z=a.parentNode;while(Z){if(Z===b){return a;}if(Z===X){break;}a=Z;Z=a.parentNode;}}return null;},_iw2idx:function M(Z,d,c){var Y=Z.items&&Z.items.length,a=this.wrapperNodes(d),X=I.findBin(a,c,"offsetTop",Y);for(var b=X;b<Y;b++){if(a[b].offsetHeight){return b;}}return -1;},toPage:function(X,Z){var Y=X.scrollboxNode;if(X.usePaging&&Y){Y.scrollTop=Z*B(X);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(X){var Y=X.scrollboxNode,Z=B(X);return Math.round((Y&&Z&&Y.scrollTop/Z)||0);},toItem:function(b,d){var Z=b&&b.itemsContainerNode,g=b.scrollboxNode,X=this.itemOffsetTop(b,Z,d),e=this.wrapperNodes(Z)[d].clientHeight,Y=g.clientHeight,f=g.scrollTop,a=f;if(X<f){a=X;}else{if(f+Y-e<X){a=Math.min(X,X-Y+e);}}g.scrollTop=a;}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.func","mstrmojo.array");var C=mstrmojo.css,D=mstrmojo.array,A="focus-visible";mstrmojo.vi.util.A11yUtility=mstrmojo.provide("mstrmojo.vi.util.A11yUtility",{enableAccessibility:function(H,J,F){var G=H.domNode,E=H.widget||G,I=H.focusNode||G;if(!G){return ;}E.grabFocus=function(K){if(K){G.focus();var L=G&&G.tagName;if(typeof L==="string"&&L.toUpperCase()==="INPUT"){G.select();}}C.addClass(I,A);};E.loseFocus=function(K){if(K){G.blur();}C.removeClass(I,A);};G.onblur=mstrmojo.func.composite([G.onblur||mstrmojo.emptyFn,function(){C.removeClass(I,A);}]);G.setAttribute("tabindex","-1");if(J){G.setAttribute("role",J);}if(typeof F==="string"){G.setAttribute("aria-label",F);}else{if(typeof F==="object"){D.forEach(Object.keys(F),function(K){if(F[K]){G.setAttribute(K,F[K]);}});}}},isKeyBoardEvent:function B(E){return E&&E.type==="keydown";},removeTabIndex:function(E,G){if(!E){return ;}var F=E.querySelectorAll('[tabindex="0"]'),H;D.forEach(F,function(I){I.removeAttribute("tabindex");});if(G){H=E.querySelectorAll("input, a, textarea");D.forEach(H,function(I){I.setAttribute("tabindex","-1");});}}});mstrmojo.vi.util.A11yUtility.CSS_FOCUS_VISIBLE=A;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash");var M=1,D=2,B=1;function P(S,R){return F(S,R)&&S.o===R.o;}function F(S,R){return S&&R&&S.ui===R.ui&&S.axis===R.axis&&S.mix===R.mix;}function C(X,S,U){var W=U.getCellTitleId(S),R=U.getCellUnitIndex(S);U.selections[W]=U.selections[W]||{};U.selections[W][R]=U.selections[W][R]||[];U.selections[W][R].push(X);O(X,S,U);}function O(X,S,U){if(S){var W=U.getCellTitleId(S),R=U.getCellUnitIndex(S);if(!U.selectionsForCopy){U.selectionsForCopy={};}U.selectionsForCopy[W]=U.selectionsForCopy[W]||{};U.selectionsForCopy[W][R]=U.selectionsForCopy[W][R]||[];U.selectionsForCopy[W][R].push(X);E(X);}}function Q(S){var Y=S.selectionsForCopy;for(var X in Y){for(var W in Y[X]){for(var U=0,R=Y[X][W].length;U<R;U++){L(Y[X][W][U]);}}}S.selections={};S.selectionsForCopy={};}function E(R){mstrmojo.css.setOpacity(R,50);if(R.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(R,"showGridBorder");}}function L(R){mstrmojo.css.setOpacity(R,100);if(R.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(R,"showGridBorder");}}function H(U,W){if(U.mix===undefined){var Z=W.gridData.gts[U.axis===M?"row":"col"],S=Z[U.tui||U.ui],Y=0;for(var X=0,R=Z.length;X<R;X++){if(Z[X].id===S.id){Y++;}}return Y;}return 0;}function J(){var S="_xtabSelectionsHiddenField",R;R=document.getElementById(S);if(!R){R=document.createElement("textarea");R.id=S;R.style.opacity=0;R.style.position="absolute";R.style.top=0;R.style.height=0;R.style.width=0;document.body.appendChild(R);}return R;}function I(){var a="",c={},U,f=[],j=[],S={},W={},R=this.selectionsForCopy,Z=mstrmojo.hash,b=mstrmojo.array,h=function(k,l){if(k.hasOwnProperty("mix")){return l.es[k.mix].n;}else{return l.n;}},X,d,Y,i,g,e=0;Z.forEach(R,function(k){Z.forEach(k,function(l){b.forEach(l,function(m){e++;d=m.offsetLeft;Y=m.offsetTop;if(!c[d]){c[d]={};}U=c[d];U[Y]=m.innerText;if(b.indexOf(f,d)===-1){f.push(d);}if(b.indexOf(j,Y)===-1){j.push(Y);}i=this.getCellForNode(m);g=this.model.getCellTitleInfo(i).title;if((!g.id&&g.axis===M)||(g.id&&g.axis===D)){W[Y]=h.call(this,i,g);}else{S[d]=h.call(this,i,g);}},this);},this);},this);f.sort(function(l,k){return l-k;});j.sort(function(l,k){return l-k;});if(e>1&&!Z.isEmpty(W)){a="\t";}if(e>1&&!Z.isEmpty(S)){b.forEach(f,function(k){a+=(S[k]||"")+"\t";});a+="\n";}b.forEach(j,function(k){if(e>1&&!Z.isEmpty(W)){a+=(W[k]||"")+"\t";}b.forEach(f,function(l){a+=(c[l][k]||"")+(e>1?"\t":"");});if(e>1){a+="\n";}});X=J();X.value=a;X.focus();X.select();}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelectForCopy:function K(R){var Z=this.getCellForNode(R),c=R.parentElement.rowIndex,g,h,e,f=Z&&Z.mix!=undefined,W=function(j,i){i=i||{};j=j||{};if(f){return j.mix==i.mix;}else{return j.mix==i.mix&&j.ui==i.ui;}};if(!Z){return ;}if(Z.mix===undefined&&(this.lockHeadersCase&B)&&this.clonedRowHeader.isRendered()){e=this.clonedRowHeader.getTableNode();}else{e=this.zone?this.zone.tableNode:mstrmojo.dom.findAncestorByName(R,"table",false);}h=e.rows;for(var Y=0,a=h.length;Y<a;Y++){var d=h[Y].cells;for(var X=0,U=d.length;X<U;X++){var S=d[X],b=this.getCellForNode(S);if(b!=Z&&W(b,Z)){O(S,b,this);}}}},updateSelectionsForCopy:function A(c){var R=this.selectionsForCopy,Z,X,W,S,U,Y,a,b;for(Z in R){for(X in R[Z]){S=R[Z][X].length;for(W=0;W<S;W++){U=R[Z][X][W];Y=this.getCellForNode(U);if(Y.mix===undefined){R[Z][X][W]=c.rows[U.parentElement.rowIndex].cells[U.cellIndex];}}}}},singleSelect:function G(S,c){var a=this.getCellForNode(S),l=S.parentNode;if(c){var Z=this.getCellTitleId(a),f=this.getCellUnitIndex(a);selectedTitle=this.selections[Z];selectedUnit=selectedTitle&&selectedTitle[f];if(selectedUnit){for(var b=0,d=selectedUnit.length;b<d;b++){L(selectedUnit[b]);}delete selectedTitle[f];return ;}}var Y=H(a,this);if(a.axis===M){for(var b=0,R=0,d=l.cells.length;b<d&&R<Y;b++){var W=l.cells[b],e=this.getCellForNode(W);if(P(e,a)){C(W,e,this);R++;}}}else{if(a.axis===D){var h=mstrmojo.dom.findAncestorByName(S,"table",false),k=h.rows;for(var b=0,R=0,d=k.length;b<d&&R<Y;b++){var g=k[b].cells;for(var X=0,U=g.length;X<U;X++){var W=g[X],e=this.getCellForNode(W);if(P(e,a)){C(W,e,this);R++;break;}}}}else{C(S,a,this);}}},rangeSelect:function N(n,o){var k=this.getCellForNode(n),R=this.getCellForNode(o);if(F(k,R)){if(k.o>R.o||k._ei>R._ei){var s=n;n=o;k=this.getCellForNode(n);o=s;R=this.getCellForNode(o);}var e=H(k,this),S=k.axis,p=mstrmojo.dom.findAncestorByName(n,"table",false),b=p.rows,l=n.parentNode,t=l.rowIndex,d=l.cells,g=o.parentNode.rowIndex;if(S===M){for(var h=t;h<=g;h++){var U=b[h].cells,W=false;for(var f=0,m=U.length,X=0;f<m&&X<e;f++){var Z=U[f],c=this.getCellForNode(Z);if(F(c,k)){C(Z,c,this);X++;}}}}else{if(S===D){for(var h=0,m=b.length,q=0;h<m&&q<e;h++){var U=b[h].cells,a=false;for(var f=0,Y=U.length;f<Y;f++){var Z=U[f],c=this.getCellForNode(Z);if(P(c,k)){a=true;}if(a){C(Z,c,this);}if(P(c,R)){break;}}if(a){q++;}}}else{if(t==g){for(var h=n.cellIndex,m=o.cellIndex;h<=m;h++){var Z=d[h],c=this.getCellForNode(Z);C(Z,c,this);}}else{for(var h=t,m=g;h<=m;h++){var U=b[h].cells;for(var f=0,Y=U.length;f<Y;f++){var Z=U[f],c=this.getCellForNode(Z);if(F(c,k)){C(Z,c,this);break;}}}}}}}},doSelection:function(a,Z,X){var b=mstrmojo.dom,R=b.isMetaKey(Z,a),S=b.shiftKey(Z,a);if(!R){Q(this);}this.clearAllHighlights();var Y=this.getCellForNode(X);var U=Y&&(Y.mix===undefined&&Y.o!==undefined),W=Y&&(Y.mix!==undefined&&(Y._lp||Y._tp));if(U||W){if(S){this.rangeSelect(this.lastSelectedTD,X);}else{this.singleSelect(X,R);this.lastSelectedTD=X;}}else{this.singleSelectForCopy(X,R);}I.call(this);},clearAllHighlights:function(){var S=this.getCellForNode(this.lastSelectedCell),W=S&&this.gridData.gts[S.axis===1?"row":"col"],R=W&&W[S.tui||S.ui];var U=R&&R.sc&&R.sc.tks&&R.sc.tks.split("\x1E");if(U&&this.model.docModel.getTargetInfoWin(U).length==U.length){this.clearHighlights();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,I=mstrmojo.css,C="active";var A=false;mstrmojo.util.ui.SplitterParamsType=null;function H(N,Q){var P=Q.info,O=P&&P.min,M=P&&P.max,L=Q.start+(F.getMousePosition(N,window)[Q.mouseProp]-Q.mousePosition)*(P&&!!P.isReverseMove?-1:1);if(O!==undefined){L=Math.max(L,O);}if(M!==undefined){L=Math.min(L,M);}return L;}function G(M,L,N){return function(O){M.call(mstrmojo.all[L],O,N);};}function B(L,M){M.target.style[M.styleProp]=H(L,M)+"px";}function K(L,N){if(!A){return ;}var M=window.document;F.detachEvent(M,"mousemove",N.fnMove);F.detachEvent(M,"mouseup",N.fnUp);delete N.fnMove;delete N.fnUp;A=false;mstrApp.setInteractive(true);I.removeClass(N.target,C);this.splitterMoved(H(L,N)-N.start,N.info);(this.children||[]).forEach(function(O){O.domNode.style.pointerEvents="inherit";});this.splitterMouseUp();}function J(X){if(A){return ;}mstrApp.setInteractive(false);var L=this.id,M,N,Q=F.eventTarget(window,X),S=(Q.className.indexOf("v")===-1),R=S?"y":"x",P={};P.target=Q;P.info=this.getSplitterInfo(Q);N=P.info&&!!P.info.isReverseMove;M=S?"Top":N?"Right":"Left";P.start=N?parseInt(Q.style.right):Q["offset"+M];P.mouseProp=R;P.mousePosition=F.getMousePosition(X,window)[R];P.styleProp=M.toLowerCase();(this.children||[]).forEach(function(Y){Y.domNode.style.pointerEvents="none";});this.splitterMouseDown(P);I.addClass(Q,C);var O=G(B,L,P),W=G(K,L,P);var U=window.document;F.attachEvent(U,"mousemove",O);F.attachEvent(U,"mouseup",W);P.fnMove=O;P.fnUp=W;A=true;}mstrmojo.util.ui._HostsSplitter=mstrmojo.provide("mstrmojo.util.ui._HostsSplitter",{_mixinName:"mstrmojo.util.ui._HostsSplitter",registerSplitter:function E(L){this.splitterEvtMouseDownHandler=G(J,this.id);F.attachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);},unRegisterSplitter:function D(L){if(this.splitterEvtMouseDownHandler){F.detachEvent(L,"mousedown",this.splitterEvtMouseDownHandler);}},getSplitterInfo:mstrmojo.emptyFn,splitterMoved:mstrmojo.emptyFn,splitterMouseDown:mstrmojo.emptyFn,splitterMouseUp:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.css");function B(){var D=this.maskNode,E=this.isMasked;D.style.display=E?"block":"none";mstrmojo.css.toggleClass(D,"masked",E);}mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,postBuildRendering:function C(){if(this._super){this._super();}B.call(this);},onisMaskedChange:function A(){if(!this.hasRendered){return ;}B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,U){if(U){var N=P.itemWidgets,L,O,I,R;for(O=0,I=U.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=U.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.enums.EnumFilterClearActionType","mstrmojo.vi.enums.EnumVisFilterType","mstrmojo.vi.ui.rw.linkingExprHelper");var H=mstrmojo.array,K=mstrmojo.hash,A=mstrmojo.string,M=mstrmojo.vi.ui.rw.linkingExprHelper,E=mstrmojo.vi.enums.EnumFilterClearActionType,J=mstrmojo.vi.enums.EnumVisFilterType;function D(S){if(S.vfl){return K.valarray(S.vfl)[0].tpl;}return S.tpl;}mstrmojo.vi.ui.rw._SupportViewFilterInVizBox=mstrmojo.provide("mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",{_mixinName:"mstrmojo.vi.ui.rw._SupportViewFilterInVizBox",getSelectorObjectsFromTemplateLimit:function G(){return this.getSelObjsFromTemlateLimitHandler();},getSelectorObjectsFromViewFilter:function P(){return this.getSelObjsFromVFHandler();},getSelObjsFromVFHandler:function L(){var W=this,S=W.model,U=W.node.data,X=U&&U.vfexpr;return S&&S.getSelectorDataFromViewFilter(X);},getSelObjsFromTemlateLimitHandler:function O(){var W=this,S=W.model,U=W.node.data,X=U&&D(U);return S&&S.getSelectorDataFromTemplateLimit(X);},makeBold:function F(S){return M.makeBold(S);},getSelectorExpr:function B(Y,X){var Z=[],a="",W=true,U=Y.keepOnly?"##":mstrmojo.desc(13232,"Not ##"),S,b=mstrmojo.desc(5283,"OR");if(X){b=this.makeBold(b);}Y.data.every(function(c){[].concat(c).every(function(d){if(a===""){a=d.tn;}return(W=(a===d.tn));});return W;});Y.data.forEach(function(e,c){if(c>0){Z.push(b);}var d=[];[].concat(e).forEach(function(h){var g=X?A.encodeHtmlString(h.v):h.v,f=X?A.encodeHtmlString(h.tn):h.tn;d.push((W?"":(f+" = "))+(g||mstrmojo.desc(14323,"NULL")));});Z.push(d.join(" "));});if(Z.length>0){S=U.replace("##",(W?(X?A.encodeHtmlString(a):a)+" = ":"")+Z.join(" "));}return S;},getLinkingSelectorExpr:function R(U,S){return M.getLinkingSelectorExpr(U,S);},getFilterMenuPairs:function N(S){var W=this,X=[],U=mstrmojo.desc(2827,"Clear");if(S instanceof Array){S.forEach(function(b,a){var Z=W.getSelectorExpr(b),Y=W.getSelectorExpr(b,true);X.push({menuString:U+' "'+Z+'"',menuTtpString:U+' "'+Y+'"',ctxt:a,isBranch:b.isBranch});});}return X;},filterMenuHandler:function Q(S,X){var W=this,U=W.controller;switch(S.type){case E.CLEAR_KEEP_ONLY:S=S.idx;U.applyKeepOnly(W,X,undefined,S,false);break;case E.CLEAR_ALL:U.clearFiltersForVis(W,[J.KEEP_ONLY,J.LINKING,J.DRILLING,J.DOSSIER_LINKING],X);break;case E.CLEAR_ADV_QUALIFICATION:U.clearFiltersForVis(W,[J.ADV_QUALIFICATION],X);break;case E.CLEAR_KEEP_ONLY_AND_LINKING:U.clearFiltersForVis(W,[J.KEEP_ONLY,J.LINKING],X);break;case E.CLEAR_LINKING:U.clearLinkingFilter(S,X);break;case E.CLEAR_DRILLING:U.clearFiltersForVis(W,[J.DRILLING],X);break;case E.CLEAR_DOSSIER_LINKING:U.clearFiltersForVis(W,[J.DOSSIER_LINKING],X);break;default:break;}},hasKeepOnly:function C(S){return S===null||S.length>0;},getSelectorDataForKeepOnly:function I(U,Z){var X=this,W=X.model,Y=X.model.data||X.node.data,S=D(Y),a;if(Z===-1){a=[];}else{a=[].concat(W.getSelectorDataFromTemplateLimit(S));if(Z===-2){a=H.filter(a,function(b){return !b.keepOnly;});}else{if(Z>=0){a.splice(Z,1);}}}if(U){a=a.concat(U);}return a;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.num","mstrmojo.locales");var D=mstrmojo.array,A=mstrmojo.num,B=mstrmojo.locales;mstrmojo.vi.util.NumberFormatUtility=mstrmojo.provide("mstrmojo.vi.util.NumberFormatUtility",{applyFormatToNumber:function C(P,Q,G){var H="\u00A4",L=/"[^"]*"/g,F=P.match(L),K=P.replace(L,H),O=["m","y","d","h","s"],N=G||false,E=new Date(),M=E.getFullYear(),J=E.getMonth(),I=E.getDay(),S=B.datetime,R;D.forEach(O,function(U){N=N||K.indexOf(U,0)!==-1;});if(N){K=K.replace(/y{3,}/g,M).replace(/y{1,2}/g,M.toString().slice(2,4));K=K.replace(/m{4,}/g,S.MONTHNAME_FULL[J-1]).replace(/m{3}/g,S.MONTHNAME_SHORT[J-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");K=K.replace(/d{4,}/g,S.dayNames[I-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");K=K.replace(/hh/g,"08").replace(/h/g,"8");K=K.replace(/ss/g,"04").replace(/s/g,"4");K=K.split(H);R=K[0];D.forEach(F,function(W,U){R+=W+K[U+1];});return R;}if(A.isNumeric(Q)){return A.formatByMask(P,A.parseNumeric(Q));}return Q;}});}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array","mstrmojo._FormatDefinition");var B=mstrmojo.num,G=mstrmojo.hash,F=mstrmojo.string,C=mstrmojo.array,E=mstrmojo._FormatDefinition.NumberFormatCategory;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},ErrorCode:{EmptyValue:"emptyValueVIWarning",InvalidValue:"invalidValueVIWarning",OutOfRange:"outOfRangeVIWarning",NotInteger:"notIntegerVIWarning"},getQuaByFunc:function(L,M){var I=this.F,H=this.Q,K=H._G,J=function(N){return C.indexOf(I[1],N)!==-1;};if(J(L)){K=(M===this._RANK)?H._RT:H._PT;}else{K=(M===this._RANK)?H._RB:H._PB;}return K;},getFuncInfo:function(K,L){var J={},I=this.Q,H=this.F;J[I._G]={ft:this._GENERIC,f:H[0][K]};J[I._RT]={ft:this._RANK,f:H[1][K]};J[I._RB]={ft:this._RANK,f:H[2][K]};J[I._PT]={ft:this._PERCENT,f:H[1][K]};J[I._PB]={ft:this._PERCENT,f:H[2][K]};return J[L]||{};},getOpIdxByfunc:function(J,K){if(!J||!K){return -1;}var H=this.F,I=-1;switch(K){case this._GENERIC:I=C.indexOf(H[0],J);break;case this._RANK:case this._PERCENT:I=C.indexOf(H[1],J);if(I===-1){I=C.indexOf(H[2],J);}break;}return I;},getIncludeByOp:function(I){var H=this.OP;return I===H._EQUALS||I===H._GREATER_EQUAL||I===H._LESS_EQUAL||I===H._BETWEEN||I===H._IN;},formatNumber:function(J,L,I){var M,K=this.Q,N=I.fm,H=I.cat;if(!B.validateFormat(N)){N="#,##0.00;(#,##0.00)";}if(J===K._G){M=(N)?B.formatByMask(N,L):B.format(I.cat,I.dp,I.curr,L);}else{if(J===K._RB||J===K._RT){M=String(parseInt(L,10));}else{if(J===K._PB||J===K._PT){M=parseFloat(L)+"%";}}}if((H===E.Fixed||H===E.Currency||H===E.Percentage)&&L<0&&!F.startsWith(M,"(")&&!F.startsWith(M,"-")){M="-"+M;}return M;},doValidation:function(U,L,P,N){var O=L.qua,R=L.low,K=L.high,M=this.Q,W=O===M._RT||O===M._RB,H=O===M._PT||O===M._PB,S="",J,I=this.ErrorCode;if(F.isEmpty(U)){S=I.EmptyValue;}else{if(!(B.isNumeric(U)||(H&&String(U).match(/^\d+(\.\d+)?%$/))||(N&&!H&&B.isBigDecimal(U)))){S=I.InvalidValue;}else{if((O===M._PT||O===M._PB)&&B.inNumericRange(parseFloat(U),R,K)){S=I.OutOfRange;J=H?["0","100%"]:[R,K];}else{if(W&&(!B.isInt(U)||B.parseInteger(U,10)<0)){S=I.NotInteger;}}}}return G.copy(P,{invalid:!!S,errorCode:S,args:J||[]});},restoreMetricSelectorProps:function D(I,H){if(!I||!H){return ;}G.copyProps(["max","min","cnt","dt","nov"],H,I);},restoreMetricSelectorSelections:function A(I,H){if(!I||!H){return ;}G.copyProps(["f","ft","cs"],H,I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.xhr");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(L){K.response=L;if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(typeof J==="string"&&J[0]==="{"){try{J=JSON.parse(J);}catch(K){}}if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E&&E.response(G,true,J);},failure:function(L){var M=L.status,K=L.getResponseHeader("X-MSTR-TaskErrorCode"),J;if(M===0){M=K||M;J=mstrmojo.desc(15666,"The connection to the MicroStrategy Web Server failed. Please wait a few minutes and then attempt to reload the page. If the condition persists, please contact your administrator.");}else{M=K||M||"-999";J=L.getResponseHeader("X-MSTR-TaskFailureMsg")||L.responseText||"Unexpected error, please contact your administrator";}E&&E.response(G,false,{code:M,message:J});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._HasMarkup");var J=mstrmojo.dom,D=mstrmojo._HasMarkup,P,Q=mstrmojo.global.document,K,A="touchstart",C="touchmove",I="touchend",N="contextmenu";function O(S){var R=J.findWidget(S);while(R){if(R.hasContextMenuEvent){return R;}R=R.parent;}return null;}function M(R){var U=R.src,S=O(U&&U.node);if(!S){return null;}return S;}function H(R){if(R&&R.touches.length===1){P.startTapHoldCheck(self,R);}}function B(){var R=++P.ctxt.moveCount;if(R>P.minMoves){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}}function L(){P.stopTapHoldCheck();if(K){window.clearTimeout(K);}}mstrmojo.taphold=mstrmojo.taphold||mstrmojo.provide("mstrmojo.taphold",{timeThreshold:750,minMoves:3,startTapHoldCheck:function G(R,S){delete this.ctxt;var U=J.captureEventInfo({hWin:R,e:S});this.ctxt={src:U,moveCount:0};J.attachEvent(Q,C,B);J.attachEvent(Q,I,L);S.name=N;K=window.setTimeout(function(){P.stopTapHoldCheck();var W=D.newDomEvent(N,window,S),X;for(X in S){if(!W[X]){W[X]=S[X];}}W.type=N;P.triggerContextMenu(W);},this.timeThreshold);},triggerContextMenu:function F(R){var S=this.ctxt,U=M(S);if(!U){return ;}if(U.raiseEvent){U.raiseEvent(R);}},stopTapHoldCheck:function E(){J.detachEvent(Q,C,B);J.detachEvent(Q,I,L);},enable:function(){if(J.isIOSTouch){J.attachEvent(Q,A,H);}},disable:function(){J.detachEvent(Q,A,H);}});P=mstrmojo.taphold;P.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.vi.util.A11yUtility","mstrmojo.css");var F=mstrmojo.array,A=mstrmojo.css,E=mstrmojo.dom,D=mstrmojo.vi.util.A11yUtility;function B(){var Y=this,N=this.navMode||(this.popupConfig&&this.popupConfig.navMode),M=this.itemsContainerNode,H=(M&&M.childNodes)||[],P=this.multiSelect===true,O,J,X,Q=function(){for(O=0;O<H.length;O++){X=H[O];if(X===document.activeElement){X.blur();A.removeClass(X,D.CSS_FOCUS_VISIBLE);A.addClass(X,"ignore-hover");break;}}},G=function(Z){if(N){A.addClass(Z.target,D.CSS_FOCUS_VISIBLE);}},S=function(Z){if(N){A.removeClass(Z.target,D.CSS_FOCUS_VISIBLE);}},W=function(Z){if(N){Q();Y.navMode=N=false;}else{J=Z.target.parentElement;if(!J.classList.contains("separator")){J.focus();A.removeClass(J,D.CSS_FOCUS_VISIBLE);}for(O=0;O<H.length;O++){X=H[O];A.removeClass(X,"ignore-hover");}}},L=function(Z){if(N){J=Z.target.parentElement;if(!J.classList.contains("separator")){A.removeClass(X,"ignore-hover");}}},U=function(Z){var b=Z.code==="ArrowUp",a=Z.code==="ArrowDown";if(!b&&!a){return ;}if(N){J=Z.target;var c=parseInt(J.getAttribute("idx"),10)+(b?-1:1);while(c>=0&&c<=H.length&&H[c]&&H[c].classList.contains("separator")){c+=(b?-1:1);}for(O=0;O<H.length;O++){X=H[O];if(O===c){A.removeClass(X,"ignore-hover");}else{A.addClass(X,"ignore-hover");}}}else{Q();Y.navMode=N=true;}};for(O=0;O<H.length;O++){X=H[O];if(P){X.setAttribute("role","checkbox");var K=X.classList.contains("selected");X.setAttribute("aria-checked",K);var R=this.parent&&this.parent.btnNode&&this.parent.btnNode.children||[];F.forEach(R,function(Z){Z.setAttribute("aria-role","button");});}else{X.setAttribute("role","menuitem");}X.setAttribute("tabindex","-1");if(X.classList.contains("pop")){X.setAttribute("aria-haspopup",true);}X.onfocus=G;X.onblur=S;X.onmouseover=W;X.onmouseout=L;X.onkeydown=U;if(N&&O===0){X.focus();}}var I=this.scriptClass==="mstrmojo.vi.ui.InteractiveUnitList"?this.getListContainer():this.domNode;if(I){I.setAttribute("role","menu");E.attachEvent(I,"keydown",function(Z){E.captureDomEvent(this.id,this.evtName,Y,Z);}.bind({id:I.mstrmojoId,evtName:"keydown"}));}}mstrmojo._IsAccessibleMenu=mstrmojo.provide("mstrmojo._IsAccessibleMenu",{_mixinName:"mstrmojo._IsAccessibleMenu",hasAccessibility:true,enableAccessibility:function C(){if(this._super){this._super();}var H="popup-mid-render";var G=(this.children&&this.children[0])||this;if(G.accessibilityMenuContainer){var I=G.accessibilityMenuContainer();A.removeClass(this.domNode,H);B.call(I);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(W,L,S,Z,I,P,a,Y){var Q=this.wrapperNodes(W),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,U=I+P,M=Q[0].offsetLeft,O;for(var X=1;X<=K;X++){O=Q[R].offsetLeft-M+a;if(O<=I){J=R;}else{if(O>=U){H=R;}}var N=Math.round(L/Math.pow(2,X+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo._Fetchable");var A=mstrmojo.hash;mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(B){var C=B&&B.browseConfig;this.blockBegin=(C&&C.blockBegin)||1;this.blockCount=(C&&C.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(B);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(E,C,B){var D=this.getBrowseConfig();D.blockBegin=E;mstrmojo.func.override({success:function(F){if(this._super){this._super(mstrmojo.hash.copy(F,{items:F.es,totalSize:F.sz}));}}},C);this.source.browseElements(D,C,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",maxLengthField:"maxLength",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.num","mstrmojo.mstr.EnumNodeDimty");var G=mstrmojo.array,S=mstrmojo.expr,L=S.ET,K=S.TP,D=S.DTP,M=mstrmojo.mstr.EnumNodeDimty,P=S.ET2TGT,O=S.ET2COND,C=mstrmojo.meta.TP,B=mstrmojo.num;function Q(X,A){var W=(A&&A.did)?A.did.split(S.FN_SEP):null,E=W&&parseInt(W[0],10),U=W&&parseInt(W[1],10),Y=X.et;X.fnt=E;X.fn=U;if(Y!=L.AE&&S.fn_List(U,E)){X.et=L.AL;X.a2=null;X.cs=null;}else{if(Y==L.AL&&!S.fn_List(U,E)){X.et=L.AQ;X.cs=null;}else{if(Y==L.MC&&!S.fn_AC_MC(U,E)){X.et=L.MQ;X.m2=null;}else{if(Y==L.AC&&!S.fn_AC_MC(U,E)){X.et=L.AQ;X.a2=null;}}}}switch(U){case S.FN.IS_NULL:case S.FN.IS_NOT_NULL:X.a2=null;X.a3=null;X.fm2=null;X.fm3=null;X.m2=null;X.m3=null;X.cs=null;break;case S.FN.BETWEEN:case S.FN.NOT_BETWEEN:break;default:X.a3=null;X.fm3=null;X.m3=null;while(X.cs&&X.cs.length>1){X.cs.pop();}}}function H(a,b,d){var E=2+b,Y;if((!!a.a||!!a.m)&&a.fnt===3){d.dtp=D.REAL;}else{if(B.isBigDecimal(d.v)){d.dtp=D.BIGDECIMAL;}}switch(d.t){case K.PROMPT:Y=a.cs;var Z;if(!Y){Y=[];a.cs=Y;}Y[b]={};Z=Y[b];Z.p=d;a["a"+E]=null;a["m"+E]=null;switch(a.et){case L.AC:a.et=L.AQ;break;case L.MC:a.et=L.MQ;break;}break;case K.METRIC:a["a"+E]=null;a.cs=null;a.et=L.MC;a["m"+E]=d;break;case K.ATTR:a["m"+E]=null;a.cs=null;a.et=L.AC;a["a"+E]=d;a["fm"+E]=null;break;default:a["a"+E]=null;a["m"+E]=null;Y=a.cs;if(!Y){Y=[];a.cs=Y;}if("did" in d){a["a"+E]=null;a["fm"+E]=null;a["m"+E]=null;if(Y[b]&&Y[b].p){Y[b].p=null;}}else{if(d&&d.v!=null){Y[b]=d;}else{if(Y[b]&&a.et!==L.AL){Y=Y.splice(b,1);}}}if(!d.skipET){switch(a.et){case L.MC:if((!a.c2||!a.m3)&&(!a.m2||!a.c3)){a.et=L.MQ;}break;case L.AC:a.et=L.AQ;break;case L.AL:if(!("did" in d)&&d.v){var A,W=d.dtp;Y=[];A=d.v.split(mstrConfig.listSep);for(var U=0,X=A.length;U<X;U++){Y.push({v:mstrmojo.string.trim(A[U]),dtp:W});}a.cs=Y;}break;}}}}var J={};J[L.AQ]={target:1,fm:1,fn:1,cs:1};J[L.AL]={target:1,fm:1,fn:1,cs:1};J[L.AE]={target:1,fn:1,es:1};J[L.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};J[L.MQ]={target:1,fn:1,cs:1,dmy:1};J[L.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};J[L.F]={target:1};J[L.R]=J[L.F];J[L.XML]={target:1};J[L.ANDOR]={target:1};var I=function(A){return A!==null&&A!==undefined;};var N=function(b){if(b.data){return true;}if(!b||!I(b.et)){return false;}var a=true,A=J[b.et],Y=b.cs,X;a=a&&(!A.target||b[P[b.et]]);a=a&&(!A.fm||b.fm);a=a&&(!A.fn||I(b.fn));var W=S.fnCstCount(b.fn,b.fnt);if(a&&A.cs){for(X=0;X<W;X++){a=a&&Y&&I(Y[X]);}}if(a){var Z=[P[b.et],"fm"];for(var E=0;E<2;E++){for(X=0;X<W;X++){var c=Z[E]+(2+X);a=a&&(!A[c]||b[c]);}}}a=a&&(!A.es||b.es&&(b.es.length>0));var U=b.dimtyTypes;a=a&&(!A.dmy||U[M.NodeDimtyUnspecified]||U[M.NodeDimtyNone]||(U[M.NodeDimtyOutputLevel]&&b.dmy&&b.dmy.uts&&(b.dmy.uts.length>0)));return a;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",data:null,completed:false,defaultETAttr:L.AQ,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function R(q,g,AB){var X=this[q];if(X===g){return ;}this.etWas=this.et;switch(q){case"not":g=!!(g&&g.did===S.FN.NOT);X=!!this.not;if(g===X){return ;}this.not=!!g||null;break;case"target":var AF=this.et;if(g){switch(g[C]){case K.ATTR:case K.CONS:X=this.a;if(AF!==L.AQ&&AF!==L.AE&&AF!==L.ANDOR){this.et=this.defaultETAttr;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AF!==L.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case K.METRIC:X=this.m;if((AF!==L.MQ)&&(AF!==L.MC)){this.et=L.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=M.NodeDimtyUnspecified;}this.m2=null;break;case K.REPORT:X=this.r;if(AF!==L.R){this.et=L.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case K.FILTER:X=this.f;if(AF!==L.F){this.et=L.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case K.PROMPT:X=this.prms&&this.prms[0];if(AF!==L.XML){this.et=L.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this.data=null;this[P[this.et]]=g;break;case"fm":if(g&&g[C]==="fn"){this.et=L.AE;this.fm=null;Q(this,g);}else{this.fm=g;if(g&&(this.et==L.AE)){this.et=L.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[q]=g;break;case"fn":Q(this,g);break;case"es":var AI=this.es;if(g&&g.removed&&AI){G.removeItems(AI,g.itemIdField,g.removed);}if(g&&g.added){if(!AI){AI=g.added.concat();this.es=AI;}else{G.insert(AI,AI.length,g.added);}}break;case"c0":H(this,0,g);break;case"c1":H(this,1,g);break;case"dmy":var AC=this.dmy;if(!AC){AC={cc:true,fres:true,uts:[]};this.dmy=AC;}var y=AC&&AC.uts;if(!y){y=[];AC.uts=y;this.dmt=M.NodeDimtyOutputLevel;}var U={};U[S.TP.ATTR]=true;U[S.TP.DIM]=true;if(g&&g.removed){var l=[],A=false,e=[],W=false;for(var p=0,Y=g.removed,E=Y.length;p<E;p++){var d=Y[p],AE=d[C] in U;if(AE){W=true;}else{A=true;}var o=AE?e:l;o.push(d);}if(A){G.removeItems(y,"did",l);}if(W){var AH={};for(var j=0,h=y&&y.length;j<h;j++){var f=y[j];if(f&&f.utgt){AH[f.utgt.did]=j;}}var Z=[];for(var AD=0,AA=e.length;AD<AA;AD++){var m=AH[e[AD].did];if(m>-1){Z.push(m);}}Z.sort(G.numSorter);for(var x=Z.length-1;x>-1;x--){y.splice(Z[x],1);}}}if(g&&g.added){var AJ=[],s=S.DMY_TP.DIM,w=S.DMY_TP.ATTR;for(var AG=0,z=g.added,k=z.length;AG<k;AG++){var t=z[AG];AJ.push((t[C] in U)?{utgt:t,utp:t[C]===K.DIM?s:w,agg:1,flt:2,gb:true,rps:0,n:t.n}:t);}G.insert(y,y.length,AJ);}break;case"data":this.data=g;break;}this._updateCompleted();if(!AB){this.raiseEvent({name:"edit",prop:q,value:g,valueWas:X});}},get:function F(){var A=this.data?this.data:this;var E=O[A.et]||[];E.push("et");return mstrmojo.hash.copyProps(E,A);},_updateCompleted:function(){this.set("completed",N(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");function D(K,J){this.raiseEvent({name:"viCompBuilt",type:K,widget:J});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function H(J){this._super(J);this.relativePanels={};this.comps={};},addRelativePanel:function G(J){this.relativePanels[J]=true;},isRelativePanel:function F(J){return !!this.relativePanels[J];},isComponent:function E(K,J){return this.getComponentKey(K)===J;},getComponent:function C(J){return this.comps[J];},setComponent:function I(K,J){this.comps[K]=J;},getComponentKey:function B(K){var J=this.getComponent(K);return(J&&J.k)||"";},createComponent:function A(M,L,K){D.call(this,M);var J=new L(K);this.setComponent(M,J);D.call(this,M,J);return J;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var C=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(D,E){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(D,E,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(D,E,H){var F=D.blockCount,G={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:F,includeAncestorInfo:"true",includeObjectDesc:D.includeObjectDesc,encodeObjectInfo:false};if(D.folderLinksContextId){G.folderLinksContextId=D.folderLinksContextId;}if(D.sId){G.sessionState=D.sId;}if(E.fid){G.rootFolderID=E.fid;}else{if(E.fty){G.rootFolderType=E.fty;}}if(D.browsableTypes){G.objectType=D.browsableTypes;}if(E.blockBegin){G.blockBegin=E.blockBegin;}if(E.searchPattern){if(D.enableQuickSearch){G.quickSearch=D.enableQuickSearch;}G.searchPattern=E.searchPattern;if(E.recursive){G.recursive=E.recursive;}}this.serverRequest(G,H);},newFolder:function(G,H,F,D){var E={taskId:"createFolder",taskContentType:"json",folderID:G,name:H,description:F};this.serverRequest(E,D);},loadObjects:function B(H,I,D,G){var E=[],F=[];C.forEach(H,function(J){E.push(J.did);F.push(J.t);});if(H.length>0&&G){this.serverRequest({taskId:"getObjectInfo",objectIDs:E.join(","),objectTypes:F.join(","),includeDetails:true},I,D);}else{I.success();}},loadRecentSaveAsFolders:function A(E){var D={taskId:"getRecentSaveAsFolders"};this.serverRequest(D,E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var F=mstrmojo.hash;var D={SOLID_COLOR:0,NO_FILL:1,GRADIENT:2};mstrmojo.threshold.PropertyModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.PropertyModel",threshold:undefined,gridValueFormat:undefined,submitChange:function G(){this.raiseEvent({name:"propertyModelChange",threshold:this.threshold});},updateControl:function E(I){var H=this.threshold,J=F.copy(H.fmt,this.gridValueFormat);I.textGroup.setFormatSource(H);I.charGroup.setFormatSource(J);I.containerGroup.setFormatSource(J);},changeFormatProperty:function B(I,J,L){var H=this.threshold,K=I==="threshold"?H:H.fmt;if(!K&&I==="fmt"){K=H.fmt={};}K[J]=L;if(J==="bc"){if(typeof (L)==="string"){K.bgs=D.SOLID_COLOR;delete K.gdc;delete K.gda;}else{if(L===-1){K.bgs=D.NO_FILL;}else{K.bgs=D.GRADIENT;}}}},getReplaceTypeName:function A(){return"rtp";},getReplaceTextName:function C(){return"rtxt";}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var L=mstrmojo.hash;var S=0;var F=[];var K={};var M=false;var H=false;function J(Y){var Z=Y.callback;if(Z.submission){Z.submission(Y.id,this.userInteractionRequired(Y),Y);}this.submitRequest(Y);}function G(){if(F.length&&!M&&!H){J.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(i,f,Z,a){if(Z){this.cancelRequests();}var c=this.id,d=this.transport,Y=mstrmojo.now()+f.taskId+S++,b=i.canceled||mstrmojo.emptyFn;i.canceled=function(j){b();i.complete(true);return d.cancelRequest(j);};i=mstrmojo.func.wrapMethods(i,{complete:function(j){mstrmojo.all[c]&&mstrmojo.all[c].deleteRequest(j);}});var e=!L.isEmpty(this._requests),g=this.createRequest(Y,i,f,a),h=(M||e||H)&&!a.doNotHold;if(h){F.push(g);}else{J.call(this,g);}return Y;},hasRequests:function Q(){return !L.isEmpty(this._requests)||M;},createRequest:function U(a,c,b,Y){var Z=this._requests;if(!Z){Z=this._requests={};}Z[a]={id:a,callback:c,params:b,config:Y};return Z[a];},submitRequest:function N(Y){this.transport.serverRequest(this.id,Y.id,Y);},cancelRequests:function X(){var Y=false;L.forEach(this._requests,function(Z){if(Z.gotResponse===undefined){Y|=Z.callback.canceled(Z.id);}});this._requests={};F=[];return Y;},cancelRequest:function C(c){var Z=false,b=this._requests[c],a,Y=F.length;for(a=0;a<Y;a++){if(F[a]===b){break;}}if(a<Y){F.splice(a,1);delete this._requests[c];Z|=b.callback.canceled(b.id);}return Z;},response:function A(c,Y,a){$MAPF(false,"AndroidServerTransport","transportRequest");var b=this.getRequest(c);if(b){b.gotResponse=true;var d=b.callback,Z=(Y&&!a.mstrerr)?"success":"failure";try{if(d[Z]){d[Z](a,b);}}finally{d.complete(c);}}G.call(this);},deleteRequest:function P(Z){var Y=this._requests;delete Y[Z];},getRequest:function I(Z){var Y=this._requests;return Y&&Y[Z];},userInteractionRequired:function B(Y){return false;},addLoadingGraph:function D(Y){K[Y]=true;M=true;},removeLoadingGraph:function W(Y){delete K[Y];if(L.isEmpty(K)){M=false;G.call(this);}},pauseSubsequentRequst:function R(){H=true;},resumeSubsequentRequst:function O(){H=false;G.call(this);},_serverRequestParallel:function(Z,b,c,Y){var a=Y||new mstrmojo.SimpleXHR();a.request("POST",Z,{success:function(d){if(c.success){c.success(d);}},failure:function(d){if(c.failure){c.failure({code:d.getResponseHeader("X-MSTR-TaskErrorCode"),message:d.getResponseHeader("X-MSTR-TaskFailureMsg")});}},complete:function(){if(c.complete){c.complete();}}},b);},serverRequestParallel:function(Z,a,Y){this._serverRequestParallel(mstrConfig.taskURL,Z,a,Y);},upload:function(e,d,c,Z,b,a,Y){mstrmojo.xhr.upload("POST",mstrConfig.taskURL,e,d,c,Z,b,a,Y);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.vi.enums.EnumPromptType");var B=mstrmojo.string,A=mstrmojo.vi.enums.EnumPromptType;mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,USE_FILTER_PANEL_SELECTIONS:10,toXml:function C(){var O=this,F=function(W,X){return" "+W+'="'+X+'"';},E=function(W,X){return F(W,mstrmojo.string.encodeXMLAttribute(X));},J=new mstrmojo.StringBuffer(),H=function(X,Y){var W=mstrmojo.string.multiReplace(Y.disp_n,{"&nbsp;":" "});X.append("<e"+E("ei",B.decodeXMLAttribute(Y.ei))+E("disp_n",B.decodeXMLAttribute(W))+F("emt",Y.emt)+"/>");};var M=this.prms,D=M&&M.length;if(D||O.aopam!=O.DO_NOT_ANSWER){J.append("<hl"+F("mid",O.mid)+F("srct",O.srct)+F("aopam",O.aopam)+">");if(D){J.append("<prms>");for(var I=0;I<D;I++){var U=M[I];J.append("<prm"+F("id",U.id)+F("am",U.am)+F("pt",U.pt));if(U.orid){J.append(F("orid",U.orid)+F("ortp",U.ortp));}J.append(">");switch(U.am){case O.DO_NOT_ANSWER:case O.CLOSE:case O.USE_DEFAULT_ANSWER:case O.SAME_PROMPT:break;case O.STATIC:J.append('<pa ia="1"><es>');var S=U.pa.es,R=S&&S.length||0;for(var N=R-1;N>=0;--N){var L=S[N];H(J,L);}J.append("</es></pa>");break;case O.DYNAMIC:case O.CURRENT_UNIT:case O.DYNAMIC_OR_SAME_PROMPT:var Q=U.pa;if(Q){J.append('<pa ia="1">');var P=Q.a;if(P){J.append("<a"+F("id",P.id)+E("n",P.n)+">");}if(U.pt===A.CONSTANT){J.append(mstrmojo.string.encodeXMLAttribute(Q.v));}else{J.append("<es"+F("dispForms",P&&P.dispForms>=0?P.dispForms:"")+">");var S=Q.es;R=S&&S.length||0;for(var N=R-1;N>=0;--N){var L=S[N];H(J,L);}J.append("</es>");if(P){J.append("</a>");}}J.append("</pa>");}break;case O.USE_FILTER_PANEL_SELECTIONS:var Q=U.pa;if(Q&&U.pt===A.EXPRESSION){J.append('<pa ia="1">');J.append(JSON.stringify(Q.exp));J.append("</pa>");}break;case O.ALL_VALID_UNITS:var Q=U.pa;if(Q){J.append('<pa ia="1">');var P=Q.a,K=(P&&P.length)||0,G;if(K===0&&U.pt===A.CONSTANT){J.append(mstrmojo.string.encodeXMLAttribute(Q.v));}else{J.append("<attGroups><attGroup>");for(G=0;G<K;G++){J.append("<a"+F("id",P[G].id)+E("n",P[G].n)+">");if(U.pt===A.CONSTANT){J.append(mstrmojo.string.encodeXMLAttribute(Q.v));}else{J.append("<es"+F("dispForms",P[G].dispForms>=0?P[G].dispForms:"")+">");H(J,Q.es[G]);J.append("</es>");}J.append("</a>");}J.append("</attGroup></attGroups>");}J.append("</pa>");}break;default:break;}J.append("</prm>");}J.append("</prms>");}else{J.append("<prms/>");}J.append("</hl>");}return J.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");var D={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};var C={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:D,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,useDarkTheme:false,init:function H(I){this.clear();this._super(I);},setAlignment:function E(I,J){this.alignment={host:I,popup:J};},addPopupHandlers:function F(I,K,J){this.popupHandlers[I]={open:K,close:J};},clear:function B(){this.popupHandlers={};var I=this.ENUM_CORNERS;this.alignment={host:I.BOTTOM_LEFT,popup:I.TOP_LEFT};},destroy:function(I){this.anchorElement=null;this.hostElement=null;if(this._super){this._super(I);}}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=D;mstrmojo.ui.PopupConfig.directionCfg={menuDirection:C.LEFT_TO_RIGHT,isRightToLeft:function G(){return this.menuDirection===C.RIGHT_TO_LEFT;},setDirection:function A(I){this.menuDirection=I?C.RIGHT_TO_LEFT:C.LEFT_TO_RIGHT;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(u,w){return this.raiseEvent({name:"touchesBegin",srcId:u,touch:w});}});var X=mstrmojo.dom,q=X.attachEvent,s=X.detachEvent,B=Math,Y=window.mstrConfig,Q=false,J=null,j=Y&&Y.allowDefaultTouches;var i=5,D=250,F=400,a=100;var h="Begin",N="End",e="Move",S="Cancel";var n=1,o=2,C=3,P=4;var K={};K[n]="Select";K[o]="Swipe";K[C]="Multi";K[P]="Tap";if(document&&document.body){q(document.body,"touchmove",function(u){if(!Y||!Y.allowDefaultTouches){if(u.preventDefault){u.preventDefault();return false;}}return true;});}function Z(u){var w=u.identifier;return(w===undefined)?1:w;}function k(y,z,x,w){if(Q){var u=w?Z(w)+" ":"";window.console.log(y+":"+(x?" "+x.scriptClass+" "+x.id:"")+" "+u+(z||""));}}function l(u){return(J===u);}function U(u){if(!l(u)){return ;}k("detachWinEvts","",u);s(window,X.TOUCHMOVE,u._tmCallback,true);s(window,X.TOUCHEND,u._teCallback,true);s(window,X.TOUCHCANCEL,u._teCallback,true);J=null;}function W(u){if(l(u)){return ;}var w=J;if(w){k("forced deactivation","",w);U(w);}k("attachWinEvts","",u);q(window,X.TOUCHMOVE,u._tmCallback,true);q(window,X.TOUCHEND,u._teCallback,true);q(window,X.TOUCHCANCEL,u._teCallback,true);J=u;}function M(w,u){return"touch"+((u&&K[u])||"")+(w||"");}function b(x,y,w){var u=M(y,w);return(x[u]!==undefined)?u:"";}function p(y,AA,AB,x,w){w=w||y.gestures[AB.id];var z=(w&&w.bubbleTarget)||y,u=b(z,AA,x);if(u){k("fire",u,z);AB.methodName=u;return z[u](AB);}k("no handler",M(AA,x),z);return true;}function f(AD,AE,u,z){var AA=u.pageX,y=u.pageY,AB=AD.timeStamp,w=Z(u),AI={x:B.round(AA-AE.pageX),y:B.round(y-AE.pageY)};var AH={id:w,evt:AD,pageX:AA,pageY:y,clientX:u.clientX,clientY:u.clientY,target:u.target,delta:AI,date:AB,stop:function(){k("event stopped",w);AD.stopPropagation();AD.cancelBubble=true;}};if(z){var x=AB-z.date,AG=z.delta,AC={x:B.abs(AI.x-AG.x),y:B.abs(AI.y-AG.y)};AH.velocity={x:AC.x/x,y:AC.y/x};AH.isVertical=(AC.y>AC.x);AH.accelDelta=AC;var AF=AH.direction={};if(AA!==z.pageX){AF.x=(AA<z.pageX);}else{if(AA!==AE.pageX){AF.x=(AA<AE.pageX);}}if(y!==z.pageY){AF.y=(y<z.pageY);}else{if(AA!==AE.pageX){AF.y=(y<AE.pageY);}}}return AH;}function I(y,u,x,w){return{s:y,p1:u,p2:x,evt:w,target:w.target};}function L(w,u){if(w){w.gestures[u]=null;}}function c(w,u){U(w);p(w,N,u);}function G(u){if(u._selectHandle){window.clearTimeout(u._selectHandle);delete u._selectHandle;k("cancelSelect","",u);}}function m(u){if(u.stopPropagation){u.stopPropagation();}if(u.preventDefault){u.preventDefault();}u.cancelBubble=true;return false;}function H(AB,AD){var z=AD.which;if(z&&z===3){k("ignore","right mouse click",AB);return ;}var AC=AB.gestures,AA=AD.touches||[AD],u=(AD.changedTouches&&AD.changedTouches[0])||AD,AG=l(AB),AH=f(AD,u,u),AF=I(AH,AH,AH,AD);k("touchBegin","",AB,u);if(X.isTouchOptimizationEnabled()&&AB.ontouchstart){AB.ontouchstart(AD);}if(AA.length>1){if(!AG){AH.stop();k("ignore","cross widget multitouch",AB,u);var y=J;if(y&&y.onCrossWidgetMultitouch!==undefined){k("call onCrossWidgetMultitouch for","",y);y.onCrossWidgetMultitouch();}return false;}}else{if(AG){k("forced deactivation","",AB,u);U(AB);AG=false;}}if(AB.singleNode&&u.target!==AB._tn){k("ignore","target is not touch node",AB,u);return ;}if(mstrmojo.touchManager.notify(AB.id,AH).ignore){AH.stop();return ;}if(!AG){var x=AH.target.tagName;x=x&&x.toLowerCase();if(x==="select"||x==="input"){k("ignore","target is input or select",AB,u);if(AB.monitorInputs){p(AB,null,AH,P);}return ;}}AC[AH.id]=AF;if(AG){if(!AB.multiTouch){G(AB);var w=AA[AA.length-2],AE=AC[Z(w)];p(AB,S,w,AE.action,AE);}else{AF.action=C;if(AB._singleTouch){G(AB);AB._singleTouch.action=C;delete AB._singleTouch.bubbleTarget;delete AB._singleTouch;p(AB,h,AH,C);}}AH.stop();return ;}if(!X.contains(AB._tn,AD.target,true,AB.domNode)){delete AC[AH.id];return ;}AB._singleTouch=AF;if(p(AB,h,AH)===false){return ;}if(!mstrmojo.dom.isTouchOptimizationEnabled()){AH.stop();}if(b(AB,h,n)){AB._selectHandle=window.setTimeout(function(){AF.action=n;if(p(AB,h,AH,n)===false){c(AB,AH);}delete AB._selectHandle;},F);}W(AB);if(!AB.enableBubble){m(AD);}}function t(z,AA){var AC=(AA.changedTouches&&AA.changedTouches[0])||AA,w=z.gestures[Z(AC)];if(!w){return ;}var x=f(AA,w.s,AC,w.p2),y=w.action;w.p2=w.p1;w.p1=x;if(!y&&(B.abs(x.delta.x)>i||B.abs(x.delta.y)>i)){y=w.action=o;G(z);if(!b(z,h,y)&&!b(z,e,y)){x.methodName=M(h,y);return z.bubbleTouchEvent(x);}if(p(z,h,x,y)===false){c(z,x);return ;}}if(y){var u=w.lastMove||w.s.date,AB=x.date-u;if(!mstrApp.isTouchApp()||AB>=a){w.lastMove=x.date;p(z,e,x,y);}}if(!z.enableBubble){m(AA);}}function E(z,AB){var u=(AB.changedTouches&&AB.changedTouches[0])||AB,AC=(AB.touches&&AB.touches.length)||0,AA=z.gestures,AF=Z(u),AE=AA[AF];if(!AE){k("No gesture",AF,z,u);return ;}var y=AE.action,AG=f(AB,AE.s,u,AE.p2);if(!y){G(z);if(!AE.wasMulti){y=P;}}if(AC===0){U(z);z.gestures=[];k("gestures","clear all",z,u);}else{AA[AF]=null;k("gestures","clear single",z,u);}L(AE.bubbleTarget,AF);switch(y){case o:case n:if(!mstrmojo.dom.isTouchOptimizationEnabled()){AG.stop();}p(z,N,AG,y,AE);break;case C:if(AC<2){p(z,N,AG,y,AE);if(AC===1){var x=AB.touches[0],AD=f(AB,x,x),w=I(AD,AD,AD,AB);w.wasMulti=true;AA[Z(x)]=w;z._singleTouch=w;}}if(AC>0){return ;}break;case P:if(!b(z,null,y)){break;}var AH=z._tapHandler;if(AH){window.clearTimeout(AH.h);}if(AG.date-AE.s.date<F){if(p(z,"Before",AG,y,AE)===false){break;}if(!z.multiTap){AG.count=1;p(z,null,AG,y,AE);}else{if(AH){AH.count++;}else{AH=z._tapHandler={count:1};}AH.h=window.setTimeout(function(){AG.count=AH.count;p(z,null,AG,y,AE);delete z._tapHandler;},D);}}else{delete z._tapHandler;}break;}p(z,N,AG,undefined,AE);if(!z.enableBubble){m(AB);}}function d(w){var u=w._tn;if(!u){return ;}if(!w._tmCallback){w._tsCallback=function(x){H(w,x);};w._tmCallback=function(x){t(w,x);};w._teCallback=function(x){E(w,x);};}q(u,X.TOUCHSTART,w._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:true,enableBubble:true,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];d(this);},bubbleTouchEvent:function g(AB){var y=AB.methodName,u=AB.id,w=this.gestures[u],x=this.parent;while(x){var AA=x[y],z=x.touchBegin;if(AA&&(!z||p(x,h,AB)!==false)){AB.methodName=y;L(w.bubbleTarget,u);w.bubbleTarget=x;x.gestures[u]=w;k("bubble",((this.k)?" "+this.k:"")+"] bubbled "+y+" to ["+x.scriptClass+((x.k)?" "+x.k:"")+"]",this,AB);return AA.call(x,AB);}x=x.parent;}return false;},unrender:function A(w){if(l(this)){U(this);}var u=this._tn;if(u){X.detachEvent(u,X.TOUCHSTART,this._tsCallback);}this._super(w);},restoreDefaultTouches:function R(u){if(Y){Y.allowDefaultTouches=u&&j;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.css","mstrmojo.UUID","mstrmojo.fe.FilterUtils","mstrmojo.desc");var Q=mstrmojo.func,L=mstrmojo.hash,J=mstrmojo.array,N=mstrmojo.expr,U=mstrmojo.css,R=N.DTP,F=mstrmojo.UUID,W=mstrmojo.fe.FilterUtils,U=mstrmojo.css;var H=16,E=32;function O(b,a,d){var Y=L.copyProps(["did","t","st","n"],b),Z=(b.fs||[]).filter(function(e){return e.fnm==="LEVEL_NUMBER"||e.n==="LEVEL_NUMBER";})[0],c;if(a){c={et:N.ET.AE,fn:N.FN.DESCENDANT,a:Y,es:[{v:a.v,n:a.n}]};if(parseInt(d,10)>=a.lv){c.cs=[{v:d-a.lv,dtp:R.INTEGER},{v:2,dtp:R.INTEGER}];}}else{if(parseInt(d,10)>=0&&Z){c={et:N.ET.AQ,fn:N.FN.EQUAL,a:Y,fm:{did:Z.did||Z.fid,n:Z.n||Z.fnm,dtp:R.INTEGER},cs:[{v:d,dtp:R.INTEGER}]};}}return c?W.getExprXml(c):"";}mstrmojo.ui._IsIncFetchHierarchyList=mstrmojo.provide("mstrmojo.ui._IsIncFetchHierarchyList",{_mixinName:"mstrmojo.ui._IsIncFetchHierarchyList",blockCount:500,getDataHelper:mstrmojo.emptyFn,getAttribute:mstrmojo.emptyFn,isHiearachyDisplay:mstrmojo.emptyFn,getItemMarkup:function C(a,Y){var Z;if(a.fetcher){Z='<{@tag} class="item fetcher {@cls}" idx="{@idx}" style="{@style}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="text">{@en@n}</span></{@tag}>';}else{Z=this._super(a,Y);}return Z;},isFetcher:function K(Y){if(Y instanceof HTMLElement){Y=this.getItemFromTarget(Y);}return Y&&Y.fetcher;},fetchItems:function I(Y,Z){this._super(Y,Q.wrapMethods(this.getFetchItemsCallback(Y),Z));},fetchItemsThroughTaskCall:function P(c,h){var b=this.getDataHelper(),a=this.getAttribute();if(b&&a&&!this.isFetching){this.set("isFetching",true);var e=this,f=c.branch,Y=parseInt(c.level,10),d=c.blockBegin||1,g=c.blockCount||this.blockCount,Z=c.browseFlags||0;b.set("browseConfig",L.copy({blockBegin:d,blockCount:g,browseFlags:Z,expressionXML:(f||Y>=0)?O(a,f,Y):"",otp:a.t,compress:1},L.copy(b.browseConfig)));b.getItems(d,Q.wrapMethods({success:function(i){if(i){L.copy({bb:d,bc:g},i);J.forEach(i.es,function(j){if(!j.pid&&j.pi>-1){j.pid=i.es[j.pi].v;delete j.pi;}L.copy({lv:j.lv||0,hcd:!!j.hcd,hid:!!j.hid,dhid:!!j.hid,pid:j.pid||""},j);});}}},h,{complete:function(i){e.set("isFetching",false);}}),{hideFailureErr:h.failure});}},getFlatDisplayItems:function B(Y){return Y.filter(function(Z){var a=Z.fhid;delete Z.fhid;return !a;});},getFetchItemsCallback:function M(b){var a=this,Z=b.branch,c=parseInt(b.level,10),Y=this.isHiearachyDisplay();return{success:function(d){if(d&&d.es){var f=d.es,e=d.bb+d.bc-1;if(d.sz>e&&!d.raad){f.push({v:"fetcher"+F.create(),n:mstrmojo.desc(1005,"More..."),fetcher:true,lv:Y?(c>=0?c:(Z?Z.lv+1:0)):-1,config:L.copy({blockBegin:e+1},L.copy(b))});}if(!Y){f.forEach(function(h){var i=h.hid,g=a.getItemByValue(h.v);delete h.epd;delete h.hid;if(g){delete h.hcd;}L.copy({fhid:i,dhid:!g||g.dhid},h);});}if(a.setDisplayParent){a.setDisplayParent(f,null,true);}}}};},getMaxLevel:function A(){var Y=this.getAttribute(),Z=(Y&&Y.lvfs||[]).length;if(Z>0){return Z-1;}return this._super?this._super():0;},getLevels:function D(){var Y=this.getAttribute(),a=Y&&Y.lvfs||[],Z;return a.map(function(c,b){Z=parseInt(c.lv);return{v:(Z===0)?0:(Z||b),n:c.lvfn};});},initElements:function S(d){if(this.isHiearachyDisplay()){delete this.displayRoots;var a=this.getItems(),Z=a.length,c,Y;if(Z>0){if(this.raad){for(var b=Z-1;b>-1;b--){c=a[b];if(c.fetcher&&c.fake){c.hid=true;Y=J.find(c.parent&&c.parent.children,"idx",c.idx);if(Y>-1){c.parent.children.splice(Y,1);}Y=J.find(c.displayParent&&c.displayParent.displayChildren,"idx",c.idx);if(Y>-1){c.displayParent.displayChildren.splice(Y,1);}}}}this.refresh();}else{this.fetchItems({browseFlags:E},d);}}else{this.clearItemsNode();this.fetchItems({blockCount:500,browseFlags:H},d);}},clearItemsNode:function G(){var Y=this.itemsContainerNode;if(Y){Y.innerText="";this.updateScrollbars();}},onclick:function X(i){var f=i.getTarget(),Z=this.getItemNodeFromTarget(f),j=this.getItemFromTarget(f);if(j&&j.fetcher){if(U.hasClass(f,"text")){if(j.fake){var e=function(k){if(k.displayParent){if(!k.displayParent.hid){return k.displayParent;}else{return e(k.displayParent);}}},c=e(j),b=c?c.displayChildren:this.getDisplayRoots(),g=this.items,Y=j.config.nextSiblingIdx,d=this.blockCount,a=Y+d,h;if(b.length-1>a){h=b.slice(Y,a);j.config.nextSiblingIdx+=d;j.lv=h[h.length-1].lv;h.push(j);}else{b.pop();if(j.parent){j.parent.children.pop();}g.splice(J.find(g,"idx",j.idx),1);h=b.slice(Y,b.length);}Z.outerHTML=this._buildSiblingsMarkup(h).join("");this.updateScrollbars();}else{this.fetchItems(j.config,{success:function(k){j.hid=true;Z.outerHTML="";}});}}i.cancel();}else{this._super(i);}},});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui.theme","mstrmojo.dom");function i(j,l){if(!mstrmojo.DocInfoWindow){return ;}var k=j;while(k){if(k instanceof mstrmojo.DocInfoWindow){k[l?"registerScrollLock":"releaseScrollLock"](this);break;}k=k.parent;}}var O=mstrmojo.array,D=mstrmojo.dom,U=mstrmojo.hash,g=mstrmojo.css,H="px",L=mstrmojo.ui._HasUITheme.EnumThemeNames;var C=false;function N(j,l){if(!mstrmojo.DocInfoWindow){return ;}var k=j;while(k){if(k instanceof mstrmojo.DocInfoWindow){k[l?"registerLock":"releaseLock"](this);this.lockIW=l?k:null;break;}k=k.parent;}}var Y=mstrmojo.ui.PopupConfig,P=Y.directionCfg,B=Y.ENUM_CORNERS,b=B.TOP_LEFT,X=B.TOP_RIGHT,J=B.BOTTOM_RIGHT,I=B.BOTTOM_LEFT;function K(j){return(j===I||j===b);}function f(j){return(j===X||j===J);}function R(j){return(j===J||j===I);}function W(j){return(j===X||j===b);}function c(s,l,AB,AH){var AK=AB.x,AJ=AB.y,AG=AB.w||0,w=AB.h||0,k=AH.w,AC=AH.h,AF=s.alignment,p=AF.popup,n=AF.host,AI=f(n),AL=R(n),AE=false,z=false,m=false,AA=false,o=false,x=false,AD=D.isMobile,t=mstrmojo.ui.PopupConfig.directionCfg;if(K(p)){var q=AK+k+(AI?AG:0);AE=l.w<q;o=AD&&(AE||t.isRightToLeft());}if(W(p)){var y=AJ+AC+(AL?w:0);z=l.h<y;x=AD&&z;}if(f(p)||o){var u=AK-k+((AI&&!o)?AG:0);m=u<0;}if(R(p)||x){var j=AJ-AC+((AL&&!x)?w:0);AA=j<0;}return{top:AA,bottom:z,left:m,right:AE};}function G(k){var j=this.popupConfig;if(j){U.forEach(j.popupHandlers,function(m,n){var l=m[k?"open":"close"];if(l){l.call(mstrmojo.all[n]||l,!!k);}});}}function M(k){var j=this.popupConfig;if(j&&!j.isHostedWithin){var l=this.hostProxy;if(l){l.style.display=k?"":"none";}}}function h(j){return j!==undefined&&j!==null&&!isNaN(j);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function Q(l,j){G.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(j,l);}else{U.forEach(j,function(o,n){this.set(n,o);},this);}var k="popup-mid-render";this.set("opener",l);if(!this.hasRendered){var m=this.visible;this.visible=false;this.render();g.addClass(this.domNode,k);this.set("visible",m);}if(this.nudge){this.domNode.style.top="-10000px";}M.call(this,true);this.set("visible",true);if(this.lockIWForScroll){i.call(this,this.opener,true);}if(j&&j.lockIW){N.call(this,j.lockIW,true);}if(this.nudge){this.nudge();}if(this.adjustSize){this.adjustSize();}this.adjustCornersForPopupOverflow();this.onOpen();g.removeClass(this.domNode,k);},adjustCornersForPopupOverflow:function d(){var u=this.popupConfig;if(!u){return false;}var AZ=(u.includeScroll!==undefined)?u.includeScroll:true;var o=u.anchorElement||u.hostElement,m=u.position||D.position(o,AZ),AF=o&&o.style&&o.style.zIndex||u.zIndex;if(!u.isHostedWithin){var Ah=this.hostProxy,AY=this.hostProxy=document.createElement("div");document.body.appendChild(AY);AY.appendChild(this.domNode);if(Ah){Ah.parentNode.removeChild(Ah);}var AP=AY.style,AQ={x:"left",y:"top",w:"width"};AY.className=u.hostProxyCssClass;AP.position="absolute";AP.background="none";g.addClass(AY,"mstrmojo-popup-widget-hosted");AP.height="0";O.forEach(["x","y","w"],function(Aq){var Ap=m[Aq];if(h(Ap)){AP[AQ[Aq]]=Ap+H;}});this.adjustPopupPosInMobile(m,AP);}var AE=u.ENUM_CORNERS,An=AE.BOTTOM_LEFT,AR=AE.BOTTOM_RIGHT,k=AE.TOP_RIGHT,AK=AE.TOP_LEFT;var s=u.isStaticAnchor?D.windowDim():D.position(document.body),AT=D.position(this.domNode),Ac=c(u,s,m,AT),q=Ac.right,AD=Ac.bottom,Ao=Ac.left,AX=Ac.top,AG=u.alignment,AO=AG.popup,l=AG.host,y=AO,AC=l,AS=D.isMobile,AB=o&&o.classList&&o.classList.contains("mstrmojo-ui-Menu-item"),AU=this.id,z=o&&o.parentNode,AV=z&&z.parentElement,AN=o||this.domNode,AL,Ai=this.domNode.style;if(AV&&AV.classList.contains("mstrmojo-ui-Menu")){AN=AV;}AL=D.position(AN);if(AB&&((Ao&&q)||(AX&&AD))){if(AV){Ai.top=AL.y+"px";Ai.left=AL.x+"px";var Ag=document.getElementsByClassName("mstrmojo-ui-Menu");O.forEach(Ag,function(Ap){if(AU!==Ap.id){Ap.style.visibility="hidden";}});}u.anchorElement=AN;u.position={h:0,w:0,x:(AL.x+AT.w)>s.w?Math.min(AL.x,5):AL.x,y:(AL.y+AT.h)>s.h?Math.min(AL.y,90):AL.y};this.adjustCornersForPopupOverflow();return ;}if(P.isRightToLeft()&&(!AS||AT.w>0)){if(!AS||!Ao){q=true;}else{if(!AS||!q){P.setDirection(false);this.resetDirection=true;if(AS){AC=(AC===k)?AK:An;}}}}else{if(q){P.setDirection(true);this.resetDirection=true;}}if(q||Ao){if(K(AC)){AC=W(AC)?k:AR;}else{if(f(AC)){AC=W(AC)?AK:An;}}if(q&&K(y)){y=W(y)?k:AR;}else{if(Ao&&f(y)){y=W(y)?AK:An;}}}if(AD||AX){if(K(AC)){AC=W(AC)?An:AK;}else{if(f(AC)){AC=W(AC)?AR:k;}}if(AD&&W(y)){y=K(y)?An:AR;}else{if(AX&&R(y)){y=K(y)?AK:k;}}}if(AX||q||AD||Ao){if(C){console.log("Overflow directions: "+JSON.stringify(Ac));}this._orgalgn={host:l,popup:AO};u.setAlignment(AC,y);}if(!u.isHostedWithin){if(h(m.y)&&h(m.h)){this.hostProxy.style.top=(m.y+(R(y)?(u.alignWithAnchor===true?m.h:0):(u.alignWithAnchor===true?0:m.h)))+H;this.hostProxy.style.zIndex=(h(AF)&&(AF>100))?AF+1:101;}}var AW,Ak={};if(u.isHostedWithin&&!!this.opener){AW=g.getComputedStyle(this.opener.domNode);}O.forEach(["left","right","top","bottom"],function(Ap){Ak[Ap]=AW?parseInt(AW["border-"+Ap+"-width"]||0,10):0;});var Ae=R(AC),Af=f(AC),x=R(y),p=f(y),Aa=function(Aq,Ap){return"calc(100% + "+(Ap?Ak[Aq]:0)+"px)";},AA=function(Aq,Ap){return(Ap?-Ak[Aq]:0)+"px";};var t,Ab,j,n;t=Ab=j=n="auto";if(x){j=Ae?AA("top"):Aa("top");}else{t=Ae?Aa("bottom"):AA("bottom");}if(p){Ab=Af?AA("left"):Aa("left");}else{n=Af?Aa("right"):AA("right");}Ai.top=t;Ai.right=Ab;Ai.bottom=j;Ai.left=m.isAndroidMobile?0+H:n;var w=D.position(this.domNode),AM=5;if(AD||AX){var Al=w.y,AH=D.getMaxScrollHeight()+"px",Aj=this.scrollNode,AI=Aj&&Aj.style.maxHeight;if(Al<0||(Al+w.h>s.h)){if(Aj&&AH!==AI){Aj.style.maxHeight=AH;this.updateScrollbars();}var Ad=(-m.y+AM)+H;if(!u.isHostedWithin){if(this.hostProxy){this.hostProxy.style.top=0;}Ad=AM+H;}Ai.top=Ad;Ai.bottom="auto";}}if(Ao||q){var Am=w.x;if(Am<0||(Am+w.w>s.w)){var AJ=(-m.x+AM)+H;if(!u.isHostedWithin){if(this.hostProxy){this.hostProxy.style.left=0;}AJ=AM+H;}Ai.left=AJ;Ai.right="auto";}}return true;},adjustPopupPosInMobile:function E(s,m){if(s.isAndroidMobile&&s.interval&&s.boundingRect&&s.widgetRect){var l=s.interval,k=s.boundingRect,j=s.widgetRect,p=D.position(this.domNode),u=10,o=0,t=0;if((k.topLeft.x===0)&&(k.topLeft.y===0)&&(k.bottomRight.x===0)&&(k.bottomRight.y===0)){o=j.x;t=(j.h-p.h)/2+j.y;}else{if(p.w<l.left-u){o=k.topLeft.x-p.w-u;t=k.topLeft.y;}else{if(p.w<l.right-u){o=k.bottomRight.x+u;t=k.topLeft.y;}else{if(p.h<l.top-u){o=k.topLeft.x;t=k.topLeft.y-p.h-u;}else{if(p.h<l.bottom-u){o=k.topLeft.x;t=k.bottomRight.y+u;}else{o=k.topLeft.x;t=k.topLeft.y+(k.bottomRight.y-k.topLeft.y-p.h)/2;}}}}}var n=window.innerWidth,q=window.innerHeight;o=Math.min(Math.max(0,o),n-p.w);t=Math.min(Math.max(0,t),q-p.h);m.left=o+H;m.top=t+H;}},close:function S(k){if(this.keepOpen){return ;}if(this.onClose){this.onClose(k);}M.call(this,false);if(this.lockIWForScroll){i.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){N.call(this,this.lockIW,false);}G.call(this,false);var j=this._orgalgn;if(j){this.popupConfig.setAlignment(j.host,j.popup);}if(this.resetDirection){this.resetDirection=false;P.setDirection(false);}},preBuildRendering:function A(k){this._super(k);var n=this.popupConfig;if(n&&!n.isHostedWithin){var j=n.hostProxyCssClass.split(" "),m=false;O.forEach(U.keyarray(L),function(o){if(j.indexOf(L[o])>=0){m=true;return false;}});if(!(m||n.noInheritTheme)){var l=mstrmojo.vi.ui.theme.getThemeClass.call(this);if(l){j.push(l);}}n.hostProxyCssClass=j.join(" ");}},buildRendering:function F(){var j=this._super();if(j){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return j;},postBuildRendering:function a(){var j=this,k=this.popupConfig;if(k&&!this._ListenerProc){this._ListenerProc=function(){j.monitorWindow();};D.attachEvent(window,"resize",this._ListenerProc);}this._super();},monitorWindow:function(){var l=D.getMaxScrollHeight(),j=window.orientation||U.walk("screen.orientation.angle",window);if(this.updateScrollbars&&this.scrollNode){this.scrollNode.style.maxHeight=(this.scrollNodeMaxHeight||l)+"px";this.updateScrollbars();}if(this.orientationAngle!==undefined&&this.orientationAngle!==j){this.close();}if(this.visible){var k=this,m=null;window.clearTimeout(m);m=window.setTimeout(function(){if(k.scrollNode&&k.scrollNode.style){k.scrollNode.style.maxHeight=(k.scrollNodeMaxHeight||l)+H;k.adjustCornersForPopupOverflow();}},175);}},destroy:function e(j){if(this._ListenerProc){D.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(j);},unrender:function Z(j){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(j);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer","mstrmojo.ResSetLink","mstrmojo.vi.enums.EnumFeatures","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo._XtabModelShared");var d=1,O=2;var R=1,J=4;var b=mstrmojo.array,X=mstrmojo.hash,H=mstrmojo.mstr.EnumDSSXMLObjectSubTypes;function E(e,f){return e[((f===d)?"row":"col")];}function B(e,g){var f=g.lm;return f&&f[e.mix||0];}function Z(f,l,s){var p=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:l.target.t||2,aopam:l.daMode});var m=l.ans,q=m&&m.length;if(q){var n=p.prms=[],g=0;for(g=0;g<q;g++){var w=m[g];var h=w.pid,k=parseInt(w.m,10),u={id:h,am:k,pt:w.pt};n.push(u);if(w.po){u.orid=w.po.did;u.ortp=w.po.t;}switch(k){case p.DO_NOT_ANSWER:case p.CLOSE:case p.USE_DEFAULT_ANSWER:case p.SAME_PROMPT:break;case p.STATIC:var e=w.es,t=(e&&e.length)||0,o;u.pa={es:[]};for(o=t-1;o>=0;--o){var j=e[o];u.pa.es.push({ei:j.id,disp_n:j.n,emt:1});}break;case p.DYNAMIC:case p.ALL_VALID_UNITS:case p.CURRENT_UNIT:case p.DYNAMIC_OR_SAME_PROMPT:if(s.els){A.call(this,w,s,u,k,p);}else{G.call(this,w,s,u,k,p);}break;}}}return p;}function A(l,f,e,k,j){var i=l.dunits,g=f.els,h=e.pa={};b.forEach(g,function(m){if(b.find(i,"id",m.id)>=0){if(k!==j.DYNAMIC&&k!==j.DYNAMIC_OR_SAME_PROMPT){h.a={id:m.id,n:m.disp_n,dispForms:m.dfi};}if(l.pt===1){h.v=m.v;}else{h.es=[];h.es.push({ei:m.ei,emt:m.emt,disp_n:m.disp_n});}}});}function G(w,q,u,i,l){var m=w.dunits,o=w.dsUnits,j=X.walk("data.ghs.chs.show",this);if(m&&m.length&&q){var n=u.pa={};var h=q,g=(q.mix!==undefined)&&(q._lp||q._tp);if(g){h=q._lp||q._tp;}var f=parseInt(h.axis,10);while(h){var t=this.getPTitle(h,f);if(t&&b.find(m,"id",t.id)>=0){var k={id:t.id,n:t.n,dispForms:t.dfi};if(i===l.ALL_VALID_UNITS){n.a=(n.a||[]).concat(k);}else{if(i!==l.DYNAMIC&&i!==l.DYNAMIC_OR_SAME_PROMPT){n.a=k;}}if(w.pt===1){var e=w.formMap;n.v=e&&e[h.fmi]?e[h.fmi]:h.v;break;}else{var p={ei:h._e.id,emt:1,disp_n:h._e.n};if(i===l.ALL_VALID_UNITS){n.es=(n.es||[]).concat(p);}else{n.es=[].concat(p);}}if(i===l.CURRENT_UNIT){break;}}var s=this.getPCellParentNode(h,f);if(g&&!s&&f===d){f=O;s=q._tp;}if(!s&&f===O&&typeof j!=="undefined"&&!j){s=this.getPCellParentNodeByPI(h);}h=s;}}else{if(o&&o.length&&q){u.pa={es:o};}}}function M(g){var f=this.getCellTitleInfo(g[0]),j=[],l=function(i){if(i){if(mstrApp.useBinaryFormat){if(i._e){j.push(i.axis+"A"+(i.ui+1)+"A"+i._e.id);}l(i._p);}else{j.push(i.axis+"A"+(i.ui+1)+"A"+i.o);}}},h,e;if(!f.isSrcTitle){for(h=0,e=g.length;h<e;h++){var k=g[h];if(k.mix!==undefined&&(k._lp||k._tp)){l(k._lp);l(k._tp);}else{l(k);}}}return(mstrApp.useBinaryFormat)?j:j.join(",");}function F(i,h,f){var g=true,e=f.length;while(i<e){if(f[i].id!==h.id){g=false;break;}i++;}return g;}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._XtabModelShared],{scriptClass:"mstrmojo.XtabModel",getMessageId:function N(){return this.data.mid;},getCellDrillsInfo:function D(e,g){var f=this.getAllDrillPathsForCell(e,g);if(!f||f.length===0){return undefined;}return f[e.mix||0];},getLinkDrillAction:function K(e){return this.getActionObject(e);},getAction:function Q(e){return this.getActionObject(e);},getActionObject:function I(f){var e=f[0]&&f[0].at,g=null;if(e){if((e&J)>0){g={h:"onLink",a:this.getLinkAction(f[0])};}else{if((e&R)>0){g={h:"onDrill",a:this.getDrillAction(f)};}}}return g;},getSubTotalsPos:function U(){var e=this.data.gts;if(e){return[e.rowSubPos,e.colSubPos];}return[0,0];},isPvtButtonVisible:function a(l,g){var i=l.axis,h=E(this.data.gts,i),k=l.ui,f=l.hasOwnProperty("mix");if(g==="b"&&k===0){return false;}if(!isNaN(g)){if(parseInt(g,10)===i){return false;}if(f){return !!h[l.ui]._hid;}return true;}var j=h[l.ui].es,e=f?j.length:h.length;if(e===1){return false;}if(i===(f?O:d)){if(g==="u"||g==="d"){return false;}}else{if(g==="l"||g==="r"){return false;}}if(f?l._e===j[0]:k===0){if(g==="l"||g==="u"){return false;}}if(f?l._e===j[e-1]:(this.xtab.isOutlineMode&&l.fix)?F(k+1,l,h):k===e-1){if(g==="r"||g==="d"){return false;}}return true;},getDrillAction:function C(e,g){var f=g||this.getCellDrillsInfo(e[0])||{};return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:f.within,drillPathKey:f.k,drillPathIndex:f.dpi,drillElements:M.call(this,e)};},isVis:function Y(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var e=this.controller&&this.controller.view;if(e&&e.isVis){return e.isVis();}}return false;},getPTitle:function c(g,f){var e;if(this.isVis()){e=g.titleInfo;}else{e=E(this.data.gts,f)[g.tui];}return e;},getPCellParentNode:function L(g,f){var e;if(this.isVis()){e=(f===d)?g._lp:g._tp;}else{e=g._p;}return e;},getLinkAction:function P(g,f){var e,h;if(this.isVis()){g=g.node;h=g.titleInfo;}else{e=this.getCellTitleInfo(g,this.xtab.dataBlocks[g._gd]);h=e.title;}return this.getLinkActionImpl(g,h,f);},getLinkActionImpl:function W(q,m,o){var g=B(q,m),n=g&&g.links,t=(g&&g.onw)?"_blank":"";if(o===null||o===undefined){o=(g&&g.di)||0;}var j=n&&n[o];if(!j){return null;}var h={linkInfo:j,linkTarget:t};var e=j.url;if(e){var i="&CurrentElement";if(q&&m&&e.indexOf(i)>-1){e=e.replace(i,q._e.id);}h.url=e;}else{var k=j.target,p,f;switch(parseInt(k&&k.t,10)){case 55:if(parseInt(k.st,10)===14081){if(k.dvm&(8192|2048)&&!((k.dvm&2048&&mstrApp.features["run-vi-flash"]))){p=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(15474,"To work with HTML5 dossiers, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}f="objectID";}else{p=2048001;f="documentID";}}else{p=32001;f="documentID";}break;case 3:p=4001;f="reportID";var s=parseInt(k.st,10);h.reportViewMode=s===H.ReportGridAndGraph?3:(s===H.ReportGraph?2:1);break;default:return null;}h.evt=p;h[f]=k.did;h.srcMsgId=this.getMessageId();var l=Z.call(this,g,j,q);if(l){h.link=l;}return h;}},getDownloadAction:function S(h,f,j,g,i,e,k){return{xtabId:i,rowPosition:h,maxRows:f,colPosition:j,maxColumns:g,rowMode:k,memo:e};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Model","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.taphold","mstrmojo.array","mstrmojo.dom");var E=mstrmojo.dom,C=mstrmojo.string,R=E.isIOSTouch,X=mstrmojo.css,M=mstrmojo.array;var O=1,D=2,K=4,a=8,Z=16,L=512,N=-1;function Q(h,c){var g=h.getCellForNode(c),b=g&&g.at,f=0;if(b){f=(b&D)||(b&K)||(b&O);}if(f===K){var k=h.model.getCellLinksInfo(g);if(!k||isNaN(k.di)){return"";}var j=k.links[k.di];return j.n;}if(f===O){var i=h.model.getCellDrillsInfo(g);if(i){return mstrmojo.desc(183,"Drill to")+" "+i.n;}}if(g){var d=("mix" in g)?g._e:g;if(d&&d.desc){return C.decodeHtmlString(d.desc);}}return"";}function B(c,g){if(!mstrApp.isExpress){return[];}if(!c.onDemandDrillDynamicItems){c.onDemandDrillDynamicItems={};}var f="drill"+g,b=c.onDemandDrillDynamicItems[f]||[];if(b.length===0&&c.gridData.odd){c.loadingDCM=true;var e=new mstrmojo.SimpleXHR({async:false});e.request("POST",mstrConfig.taskURL,{success:function d(h){M.forEach(h.dynamicMenus,function(i){c.onDemandDrillDynamicItems[i.n]=i.items;if(i.n===f){b=i.items;}});c.onDemandDrillItems=h.menuItems;delete c.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:1,usePartDisplay:1,docGridKey:c.k,rwb:c.model.docModel.bs});}return b;}function J(k,c){var i=k.getCellForNode(c),b=i&&i.at;if((b&a)>0||(b&Z)>0||(b&L)>0||(i&&i.otp===N)){return true;}var g,e;if(i){g=k.model.getCellTitleInfo(i);e=B(k,g.title.id);}var d=0;if((b&O)>0&&i.sdm===undefined&&(e.length>0||k.model.getCellDrillsInfo(i))){return true;}if((b&K)>0){d++;}if((b&D)>0){d++;}if(d>1){return true;}if((b&K)>0){var l=k.model.getCellLinksInfo(i),j=l&&l.links,h=i.v?C.decodeHtmlString(i.v):i.v;var f=(j&&j.length)||0;if(l&&!isNaN(l.di)&&!C.isEmpty(h)){f--;}if(f>0){return true;}}return false;}function I(b){return b.viewport.clientWidth-(b.scrollboxNode.offsetWidth-b.scrollboxNode.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function F(){var c=this.parent;if(c&&c.getCellForNode){var b=c.zones,d;for(d in b){this.addMgrElement(d);}if(!this._sub_ihc){this._sub_ihc=c.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){c._pl=I(c);},0);}},addMgrElement:function U(d){var g=this.parent,f=this,h=d===undefined?g.contentNode:g.zones[d].tableNode;if(h&&g&&g.getCellForNode){if(!this.fCtxMenu){this.fCtxMenu=function(i){f.oncontextmenu(i,self);};}if(!this.fOver){this.fOver=function(i){f.onhover(i,self);};}if(!this.fOut){this.fOut=function(i){f.onunhover(i,self);};}var e=this.fCtxMenu,c=this.fOver,b=this.fOut;if(!E.isTouchOptimizationEnabled()){E.attachEvent(h,"mouseover",c);E.attachEvent(h,"mouseout",b);E.attachEvent(h,"contextmenu",e);if(R){this.xtabContextMenuListener=g.attachEventListener("contextmenu",h.id,e);g.hasContextMenuEvent=true;}}else{X.addClass(document.body,"touch-device");}}},shutdown:function A(){var d=this.parent,c=d&&d.zones,e;if(!E.isTouchOptimizationEnabled()){for(e in c){var b=c[e].tableNode;if(b){E.detachEvent(b,"mouseover",this.fOver);E.detachEvent(b,"mouseout",this.fOut);E.detachEvent(b,"contextmenu",this.fCtxMenu);}}if(R&&d&&this.xtabContextMenuListener){d.detachEventListener(this.xtabContextMenuListener);d.hasContextMenuEvent=false;}}},onXtabWidthChanged:function(){var b=this.parent;b._pl=I(b);},onChangeIgnoreHover:function(){var b=this.parent;if(!b.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function G(g,b,f){if(this.parent.ignoreHover){this._ignored=E.eventTarget(b,g);return ;}var d=this.parent,h=this.getEvtTargetCell(g,b,d,f);if(h&&d){var c=Q(d,h);if(c){h.title=c;}}if(this.showHvrBtn(d,h)){this.td=h;if(!d._pl){d._pl=I(d);}d.openPopup("cellHoverPopupRef",{xtab:d,td:h});}else{this.onunhover(g,b,f);}},onunhover:function P(){if(this.parent.ignoreHover){return ;}var c=this.parent,b=c._lastOpened;if(!b){return ;}if(b.autoCloses){b.autoClose();}else{c.closePopup();}},getEvtTargetCell:function H(g,b,f,d){var c=d||E.eventTarget(b,g);return c&&E.findAncestorByName(c,"td",true,f.viewport);},oncontextmenu:function S(h,b,g){var f=this.parent,j=this.getEvtTargetCell(h,b,f,g);this.processRightClick(h,b,j);if(j&&this.shouldShowPopup(f,j,true)){if(!(E.isMetaKey(b,h)||E.shiftKey(b,h))||(E.shiftKey(b,h)&&h.keyCode===121)){var d=E.getMousePosition(h,b);f.openPopup("cellHoverPopupRef",{xtab:f,td:j,cmPos:d});if(f.hasAccessibility&&!d.x&&!d.y){var c=h.target;var c=h.srcElement;var i=c.getBoundingClientRect();d.x=i.left+i.width/2;d.y=i.top+i.height/2;}f.cellHoverPopupRef.btn.openPopup();if(f.tooltipWin){f.tooltipWin.hide(true);}}f.closePopup();E.preventDefault(b,h);E.stopPropogation(b,h);}},processRightClick:mstrmojo.emptyFn,shouldShowPopup:function Y(e,f,d){var c=f.mstrShowPopup;if(c!==undefined){return c;}c=J(e,f);f.mstrShowPopup=c;return c;},showHvrBtn:function W(b,c){if(mstrApp.isDossier||mstrApp.isVI){return false;}return this.shouldShowPopup(b,c,false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ServerProxy");mstrmojo.ME.WorkstationPluginProxy=mstrmojo.declare(mstrmojo.ServerProxy,null,{workstationEnv:null,createRequest:function(B,D,C,A){return this._super(B,D,C,A);},serverRequestParallel:function(C,D,A){var B=mstrmojo.hash.copy(C);B.taskContentType=B.taskContentType||"json";B.taskEnv=B.taskEnv||"xhr";this.request(D,C,false,{});},upload:function(J,E,G,D,B,C,A){if(G===null){this.request(J,E,undefined,D);}else{var H=new FileReader();var I=this;var F=function(){H.onload=null;};if(!this.fileReaderUnloader){this.fileReaderUnloader={};}this.fileReaderUnloader[E.tableID]=F;if(E.fileFieldName){E[E.fileFieldName]=G;}else{E.myFile=G;}I.request(J,E,undefined,D);}},cancelFileReader:function(C){var B=this.fileReaderUnloader||{};var A=B[C];if(A){A();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"maxLength",this.maxLengthField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var F=mstrmojo.Widget,E=mstrmojo.string;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click,keydown><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}" aria-label="{@en@value}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:F.visibleMarkupMethod,onheightChange:F.heightMarkupMethod,onwidthChange:F.widthMarkupMethod,onvalueChange:function G(){this.selectedNode.innerHTML=this.value||"";this.selectedNode.setAttribute("aria-label",E.encodeHtmlString(this.value||"",true));},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var H=this.selectedIndex,I=this.selectedIndices;if(H!==undefined){this.set("selectedIndex",H);}if(I!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(I||{}));}},onitemsChange:function C(){var H=this.getPopupList();if(H){H.set("items",this.items);}},onPopupWidgetOpened:function(){var H=this.getPopupList();if(H&&(!H.items||H.items.length===0)){H.close();}else{if(this.enableAccessibility){this.selectedNode.setAttribute("aria-expanded","true");}}},onPopupWidgetClosed:function(){if(this.destroyed){return ;}if(this.enableAccessibility){this.selectedNode.setAttribute("aria-expanded","false");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css");var E=mstrmojo.css,G=mstrmojo.string,A=mstrmojo.desc(14058,"Show Details"),D=mstrmojo.desc(14059,"Hide Details"),C=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content {@cssClass}" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div class="contact">'+C+'</div><div class="toggle-details-link" >'+A+'</div><div class="error-details">{@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];},errorDetailsNode:function(){return this.domNode.firstChild.children[3];}},markupMethods:{onshowDetailsChange:function(){var J=this.showDetails;this.toggleDetailsNode.innerHTML=J?D:A;E.toggleClass(this.domNode,"show-details",J);this.updateScrollbars();}},cssClass:undefined,shortDesc:undefined,longDesc:undefined,showDetails:false,showToggle:true,enableContactStr:true,allowHTML:false,init:function H(J){this._super(J);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function I(J){var L=J.getTarget(),K,M=this.longDesc;if(L===this.contactNode){K="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(M?("&body="+encodeURI("Detail:\r\n"+M)):"");mstrApp.openPage(K,"_self");}else{if(L===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);this.parent.raiseEvent({name:"EditorResized"});this.parent.positionDialog();}}},setupScrollNodes:function B(){this.scrollNode=this.scrollNode;},preBuildRendering:function F(){this._super&&this._super();if(!this.allowHTML){this.longDesc=G.encodeHtmlString(G.decodeHtmlString(this.longDesc),true);}},postBuildRendering:function(){var J=this.domNode.firstChild.children[1];this._super&&this._super();!this.showToggle&&E.addClass(this.toggleDetailsNode,"hide");!this.enableContactStr&&E.addClass(J,"invisible");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget","mstrmojo._ListSelections");var F=mstrmojo.dom,G=mstrmojo.css,O=mstrmojo.string,M=mstrmojo.Enum_Keys;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" aria-label="{@en@ariaLabel}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu,keydown><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function K(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onariaLabelChange:function(){this.domNode.setAttribute("aria-label",O.encodeHtmlString(this.ariaLabel,true));}},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,keydownIndex:0,enableAccessibility:false,ariaLabel:"",init:function P(R){this._super(R);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function E(){this.itemsHtml="";var R=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(R){this.itemsHtml=this._buildItemsMarkup(0,R-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(R,W,d,S,e,U){var f=[],Z=0;f[Z++]=d||"";var Y=this.itemRenderer,c=Y&&Y.render;if(c&&typeof c==="function"){var a=this.items,b=Math.min(W+1,((a&&a.length)||0)),X,g;for(X=R;X<b;X++){g=a[X];if(g.skip){continue;}f[Z++]=e||"";f[Z++]=c(g,X,this);f[Z++]=U||"";}}f[Z+1]=S||"";return f;},setA11yAttribute:mstrmojo.emptyFn,onselectionChange:function L(f){if(!f){return ;}var b=this.itemRenderer;if(!b){return ;}var d=this.items;if(f.added&&f.added.length>0&&d.length>0&&!mstrmojo.array.some(f.added,function(i){return !d[i]||!d[i].dsbld;})){return ;}var X=b.unselect,a=this.items||[],g=f.removed,W,U,S,Y,h;if(X&&g){for(Y=0,h=g.length;Y<h;Y++){W=g[Y];if(typeof (W)==="object"){U=(W.idx==0)?0:W.positions;W=W.idx;}else{U=W;}S=this._getItemNode(U);if(S){X(S,a[W],U,this);this.setA11yAttribute(S,false);}}}var R=b.select,e=f.added,Z,c;if(R&&e){for(Z=0,c=e.length;Z<c;Z++){W=e[Z];if(typeof (W)==="object"){U=(W.idx==0)?0:W.positions;W=W.idx;}else{U=W;}S=this._getItemNode(U);if(S){R(S,a[W],U,this);this.setA11yAttribute(S,true);}}}if(this.onchange){this.onchange({added:f.added,removed:f.removed});}},_set_items:function C(W,R){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(R&&R.length));}var U=this.items;this.items=R;if(U!==R){var S=this.hasRendered;if(S){this.unrender(false);}this.clearSelect();if(S){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function J(R){F.preventDefault(window,R.e);var U=R.getTarget(),S=this.getItemFromTarget&&this.getItemFromTarget(U);if(S){if(this.onItemContextMenu(S,R)){R.cancel();}}},getA11yCSS:mstrmojo.emptyFn,arrowKeySupported:function(R){return false;},updateItemStyle:function I(U){if(!this.enableAccessibility){return ;}var R=this.getA11yCSS(),S=this.getSelectedNode(this.keydownIndex);if(S){S[U?"focus":"blur"]();G.toggleClass(S,R,U);}},onkeydown:function H(S){var R=S.hWin,W=S.e||R.event,U=W.keyCode;if(!this.enableAccessibility||!this.arrowKeySupported(U)){return false;}if(U===M.DOWN_ARROW||U===M.RIGHT_ARROW||U===M.END){S.cancel();S.preventDefault();this.updateItemStyle(false);if(U===M.END){this.keydownIndex=this.items.length-1;}else{this.keydownIndex=(this.keydownIndex+1)%this.items.length;}this.updateItemStyle(true);this.scrollToSelectedItem(this.keydownIndex);return true;}if(U===M.UP_ARROW||U===M.LEFT_ARROW||U===M.HOME){S.cancel();S.preventDefault();this.updateItemStyle(false);if(U===M.HOME){this.keydownIndex=0;}else{this.keydownIndex=(this.keydownIndex>0)?(this.keydownIndex-1):(this.items.length-1);}this.updateItemStyle(true);this.scrollToSelectedItem(this.keydownIndex);return true;}return false;},getSelectedNode:function Q(R){var S=this.itemsContainerNode&&this.itemsContainerNode.childNodes;return S&&S[R!==undefined?R:this.selectedIndex];},scrollToSelectedItem:function D(W){var Z=this.getSelectedNode(W);if(Z){var S=this.scrollNode,Y=S.clientHeight,X=Z.offsetTop,R=S.clientWidth,U=Z.offsetLeft;if(X-S.scrollTop+Z.offsetHeight>Y){S.scrollTop=X+Z.offsetHeight-Y;}else{if(X<S.scrollTop){S.scrollTop=Math.max(X-10,0);}}if(U-S.scrollLeft+Z.offsetWidth>R){S.scrollLeft=U+Z.offsetWidth-R;}else{if(U<S.scrollLeft){S.scrollLeft=Math.max(U-10,0);}}}},_getItemNode:function N(R){var S=this.itemsContainerNode;return(S&&S.childNodes[R])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var c=mstrmojo.hash,h=mstrmojo.array,g=mstrmojo.boxmodel,e=mstrmojo.dom;function A(k,m,j){var l=k.listSelector;if(l){l[m](k,k.itemsContainerNode,j);}}function L(k,j){var l=k.lastPagePos;if(!l||l.dragId!==j){l=g.offset(k.itemsContainerNode);l.dragId=j;k.lastPagePos=l;var m=k.scrollboxNode;k.lastScrollPos={left:m.scrollLeft,top:m.scrollTop,width:m.clientWidth,height:m.clientHeight};}}function O(m,p,k){var l=p&&p.node;if(l===m.dropCueNode||l===m.dropCueNode.firstChild){return m.dropCuePos;}var n=m.listMapper;var j=n&&n.whereDrop(m,m.itemsContainerNode,l,p.pos,{left:m.lastPagePos.left-m.lastScrollPos.left,top:m.lastPagePos.top-m.lastScrollPos.top,width:m.lastScrollPos.width,height:m.lastScrollPos.height});var o=m.dropCuePos;return((k!==false)&&o&&j&&(o.idx===j.idx)&&(o.left===j.left)&&(o.top===j.top))?o:j;}var i="attachEventListener";function D(k,j){if(k.makeObservable){j=j||[];if(!j[i]){mstrmojo.hash.make(j,k.itemsScriptClass||mstrmojo.Arr);}}return j;}function H(k,j){if(j&&j[i]){k._sub_its=j;k._sub_add=j[i]("add",k.id,"preadd");k._sub_rmv=j[i]("remove",k.id,"preremove");}}function G(j){if(j._sub_its){var k=mstrmojo.publisher;k.unsubscribe(j._sub_add);k.unsubscribe(j._sub_rmv);delete j._sub_add;delete j._sub_rmv;delete j._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,j=k&&k.style;if(!j){return ;}var m=this.dropCuePos,l=!!m;if(l){j.left=m.left+"px";j.top=m.top+"px";}j.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function b(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function I(j){return D(this,j);},preBuildRendering:function Y(){var n=this.listBuilder,q=n.newContext(this);this.ctxtBuilder=q;var k=this.markupSlots,m=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,j=(l&&l.length)||0,o=m?this.firstRenderBlockSize:j,p=m?this.firstRenderBlockSize:0;this._eros=m;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,n,this,q,o,p).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var n=mstrmojo.all[q];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function Z(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(l,j,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(j,k);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var j=this;this._fillTmr=self.setTimeout(function(){j.fill();j=null;},50);}}if(this._super){this._super();}},fill:function d(j,n){try{if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var o=(this.items&&this.items.length)||0;if(!o){if(n){n();}}else{var l=this.scrollboxNode,p=this.itemsContainerNode,m=mstrmojo.boxmodel.offset(p,l),t=this.listMapper;if(l){var q=t.findScrollRange(p,o,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,m.left,m.top);if(this.fillAt(q.start,q.end)){if(j){j();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(j,n);},100);}else{if(n){n();}}}}}catch(s){console.error(s);}},fillAt:function M(l,k){var j=this.listMapper;if(j){return j.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function R(k,j){if(!k||!k.length){return -1;}var l=this.items;if(j==null){j=c.min(this.selectedIndices,false,true);if(j!==null&&j!==undefined){j++;}}if(j==null||j===-1){j=(l&&l.length)||0;}if(l&&l.add){l.add(k,j);}else{this.set("items",l?h.insert(l.concat(),j,k):k);}return j;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,j=l.value.length;this.fillAt(m,m+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function W(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function W(l){var k=this.items;if(!k||(l==null)){return -1;}var j;if(!isNaN(l)){j=l;}else{j=this.itemIndex(l);}if(j>-1){if(k.remove){k.remove(j,1);}else{k=k.concat();k.splice(j,1);this.set("items",k);}}return j;},duplicate:function a(o,k,l){var m=this.items,j=-1;if(!m||(o==null)){return -1;}if(!isNaN(o)){if(k===null||k===undefined){k=o+1;}o=m[o];}else{if(k===null||k===undefined){k=this.itemIndex(o)+1;}}if(o){var n;n=c.copy(l,c.clone(o));j=this.add([n],k);}return j;},preremove:function N(k){if(this.hasRendered){var m=this.listMapper;if(m){m.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function S(m,s){function p(u,t){return s>=u&&s<=u+t;}var q=(this.items&&this.items.length)||0;if(s===-1||s==null||isNaN(s)){s=q;}else{s=Math.min(s,q);}var l,j,o,n;if(m.constructor===Array){j=m;o=m;n=(j&&j.length)||0;if(p(m[0],m.length)){return false;}l=h.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;j=this.itemIndex(l[0]);o=[j];if(p(j,1)){return false;}}else{j=m;o=[m];n=1;if(p(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<n;k++){if(o[k]<=s){s--;}}if(l[0]!=null){this.remove(j);this.add(l,s);}return true;},itemIndex:function F(j){if(j==null){return -1;}var k=this.itemIdField;return k?h.find(this.items,k,j[k]):h.indexOf(this.items,j);},prechange:function U(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,j=k.length;m<j;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(p,j){var o=this.items;j=this.initItems(j);this.items=j;if(o!==j){var m=this,l=function(){if(m.autoHide){m.set("visible",!!(j&&j.length));}m=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return o!==j;},premousedown:function f(j){A(this,"premousedown",j);},premouseup:function Q(j){A(this,"premouseup",j);},scrollTo:function X(k){var j,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){j=k;}else{j=this.itemIndex(k);}if(j>=0){l.toItem(this,j);}}},draggable:false,getDragData:function(n){L(this,n.id);var l=O(this,n.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var m=this.sortSelectedIndices(),j=h.get(this.items,m)||[];switch(j.length){case 1:return c.copy({html:j[0][this.itemDisplayField],index:m[0]},c.copy(j[0]));case 0:return null;default:return c.copy({html:j.length+" selections",indices:m},j);}}},dropZone:false,ondragenter:function(j){L(this,j.id);this.set("dropCuePos",O(this,j.tgt));},ondragover:function(j){this.set("dropCuePos",O(this,j.tgt));},ondragleave:function(j){this.set("dropCuePos",null);},isDragValid:function C(j){return j&&j.src&&j.src.data;},ondragstart:function(j){if(!(j&&j.src&&j.src.data)){return false;}},allowCopy:false,ondragend:function(m){var k=m&&m.tgt,j=k&&k.widget;if(j===this){}else{if(this.tree&&j&&j.tree===this.tree){if(!this.allowCopy||!e.ctrlKey(k.hWin,k.e)){var l=m.src&&m.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(t){var x=t&&t.src,q=x&&x.data;if(q){var l=O(this,t.tgt,false),u=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;u=Math.min(u,o&&o.length)||0;var w=true;if(x.widget===this){w=this.move(k,u);h.forEach(k,function(s){if(s<=u){u--;}});}else{this.add(m?q:[q],u);}if(w){var p=m?q.length:1,j={};for(var n=0;n<p;n++){j[u+n]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@en@tooltip}" mstrAttach:keydown><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@en@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;if(this.domNode){this.domNode.setAttribute("aria-checked",this.checked);}if(this.labelNode&&this.labelNode.enableAccessibility){this.labelNode.setAttribute("aria-checked",this.checked);}}},checked:false,onkeydown:function D(E){var G=E.e||E,F=G.key;if(this._super){this._super(E);}if(F==="Enter"||F===" "){G.preventDefault();G.stopPropagation();this.inputNode.checked=!this.inputNode.checked;this.preclick();}},preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||(mstrmojo.getJsRoot()+"../images/1ptrans.gif");if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.dom","mstrmojo.url","mstrmojo.expr","mstrmojo.string","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.hash","mstrmojo.vi.ui._IsValidURL");var O="<tr>";var h=mstrmojo.dom;var w=['<table role="grid" tabindex="-1" cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var b="&nbsp;";var t="fsbp_1 ";var g="fsbp_2 ";var Y="fsbp_3 ";var q=1,s=2,J=3,p=4,AB=5,a={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},N=1,y=3;var E=mstrmojo.css,l=mstrmojo.array,z=mstrmojo.string,X=mstrmojo.chart.model.enums.EnumDSSBaseFormType,i=mstrmojo.expr.TP,S=mstrmojo.hash;var Q=4,u=i.ATTR;var U="<a data='",j="' href='",B="' target='_blank' rel='noopener noreferrer'>",D="</a>",AC=new RegExp(/<a tabindex="-1" data='([\s\S]*)' href='([\s\S]*)' target='_blank'(?: rel='noopener noreferrer')?>([\s\S]*)<\/a>/);var f={dcpp:20,limit:60,dcw:50,tcc:0,curSel:{rows:{},cols:undefined},currColSec:0,isIncremental:false,getPaddingHTML:function m(AE,AG,AF,AD){AE[1]=AF;AE[3]=1;AE[5]=AE[5]+" gd-col-padding ";AE[11]=AG;AE[13]='<div style="width: '+AD+'px">&nbsp;</div>';return AE.join("");},getBeginIndex:function d(){return Math.max(this.currColSec-1,0)*this.dcpp;},getEndIndex:function C(){return Math.min(this.tcc,(this.currColSec+2)*this.dcpp);}};function k(AG,AH,AD){var AF=true,AE=0;if(AD.cs>1){for(AE=0;AE<AD.cs;AE++){AF=AF&&AG[AH+AD.cs-AE-1];}}else{AF=AG[AH];}return AF;}function c(AF,AE){for(var AG=0,AD=AF.length;AG<AD;AG++){var AI=AF[AG];var AH=AE.rows[AI.rows].cells[AI.cells];if(AH){mstrmojo.css.addClass(AH,t);}}}function o(AF){var AH=AF.indexOf('src="');if(AH<0){return AF;}var AG=AF.substring(AH+5),AE=AG.indexOf('"'),AI;AG=AG.substring(0,AE);AI=AG;if(mstrApp.isDossier){AI=mstrmojo.url.getFullPath(AG);}else{var AD=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(AD&&AD.getImage){AI=AD.getImage(AG);}}return AF.replace(AG,AI);}function AA(AI,AH,AG){var AD="",AJ="#srcend",AE=-1,AF,AK=AI.split("#srcstart");AK.forEach(function(AL){AE=AL.indexOf(AJ);AF=AL.split(AJ);AF.forEach(function(AN,AM){if(AM===0&&AE!==-1){AN=AN.substring(0,AE);if(AG){AN=mstrmojo.url.getFullPath(AN);}AD+='<img src="'+AN+'" '+AH+">";}else{AD+=AN;}});});return AD;}function H(AF,AE,AD){var AK=AF.outLvl,AG="outlineMode",AJ=this.parent.outlineState,AI=AF._ei,AH=AI?(' ei="'+AI+'"'):"";if(AJ&&AJ[AI]){AG+=AF.hidden?" hiddenRow":"";}else{if((AD>0&&AK>AD)){AG+=" hiddenRow";}}if(this.parent.hasEmptyTBody&&AG.indexOf("hiddenRow")===-1){this.parent.hasEmptyTBody=false;}return' level="'+AK+'" class="'+AG+'"'+AH+">";}var M=(function(){var AG=/\n/g,AL="<br/>",AQ=/<a\s[^>]+>/gi,AP="<a ",AZ='<a target="_blank" ',AE="target=";var AO='<a href="',AM="",AJ="</a>",AF="<span>",AD="</span>",AW="<div>",AU="</div>",AS='<span class="text">',AR="</span>",AN='<span rabtn class="raBtn ',AK='"></span>',AT="iconRA-expand",AI="iconRA-collapse",AY="<span>",AX="</span>",AV='<div class="htmlEnc"></div>',AH=function(Aa){return Aa.fnm==="DYNAMICLINK";};return function(Ab,Af){var Aq=Af&&Af.forceNewBrowserWindow,Ao=Af&&Af.gridId,Au=Af&&Af.isServerEncoded,Az=mstrmojo.all[Ao],Ah=Az.model,Ax,Av=Ab.v||Ab.n||b,Ak=Ab.ts===X.DssBaseFormUrl,An=Ab.ts===X.DssBaseFormHTMLTag,Ag=Ab.isDynamicLink,Ae=Av.toLowerCase().indexOf("<img")>-1,Ar=Ab.isNDE&&Ab.dei===undefined,At=Ab.lv!==undefined;if(Ar){Ax=Ah.getFullObjectInfo(Ab.id);if(Ax){Ax=Ah.getFullObjectInfo(Ax.attId);if(Ax){if(Ax.formType===X.DssBaseFormHTMLTag){An=true;}else{if(l.filter(Ax.fs,AH).length===1){Ag=true;An=true;}}}}}Av=(Ab.ts===X.DssBaseFormText||Ab.mdf===1)?Av.replace(AG,AL):Av;if(An){if(Au&&!Ag){Av=AV;}else{Av=Av.replace("<a",'<a tabindex="-1"');if(Ag){var Ac=AC.exec(Av);if(Ac&&Ac.length>=4){if(this.isValidURL(Ac[2])){Av=[U,z.encodeHtmlString(Ac[1],true),j,z.encodeHtmlString(Ac[2],true,true),B,z.encodeHtmlString(Ac[3],true),D].join("");}else{Av=Ac[3];}}}if(Aq){(Av.match(AQ)||[]).forEach(function(A1){if(A1.indexOf(AE)===-1){Av=Av.replace(A1,A1.replace(AP,AZ));}});}}}else{if(Ak){if(!AM){AM=Aq?'" target="_blank">':'">';}if(this.isValidURL(Av)){Av=AO+Av+AM+Av+AJ;}}}if(Ae){var Ad=document.createElement("div");Ad.innerHTML=Av;var Al=Ad.querySelectorAll("img");l.forEach(Al,function(A2){A2.onload=function A1(){var A3=mstrmojo.all[Ao];if(A3){if(A3._updateScrollbarTimer){clearTimeout(A3._updateScrollbarTimer);}if(A3.updateScrollbars){A3._updateScrollbarTimer=setTimeout(function(){A3.updateScrollbars();},100);}}};});Av=Ad.innerHTML;}if((Ab.css&&Ab.css.indexOf("hl")>-1)||Ak){Av=AF+Av+AD;}if(At){var Ay=Ab.lv,A0="&nbsp;&nbsp;&nbsp;&nbsp;",Aj="",Aa="",Ap="",As;for(As=0;As<Ay;As++){Aj+=A0;}if(Ab.hcd&&Ab.fi===undefined){Ap=AN+(Ab.epd?AI:AT)+AK;}else{Aj+=A0;}if(Ab.axis===1){Aa=AY+Aj+AX;}Av=AW+Aa+Ap+AS+Av+AR+AU;}else{if(Ab.outLvl&&Ab.cs>1&&!Ab.isLeaf){var Aw=(Ab.stt===1&&!Ab.dpt),Ai=Aw?"":"icon-outline-span"+(Ab.epd?" outline-expand":" outline-collapse"),Am=!Aw&&Ab.epd?' collapsed="true"':"";Av='<span class="'+Ai+'"  sty="outimg" dpt="'+Ab.outLvl+'"'+Am+"></span>"+Av;}else{if(Ab.expandLevel){Av='<span class="icon-outline-span outline-collapse" expandTo="'+Ab.expandLevel+'" title=""></span>'+Av;}else{if(Ab.fillerCell&&Av===b){Av="";}}}}return Av;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker,mstrmojo.vi.ui._IsValidURL],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function F(AD){this._super(AD);},numColumnCanMerge:0,icr:mstrmojo.hash.clone(f),preBuildRendering:function A(){var AD=this.cp;if(!AD){return ;}AD.initContent();this.rc=AD.rc||0;this.cws=AD.colWidths||[];this.cc=this.cws.length;this.tdWidths=AD.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=AD.getNumAutoHeightRows&&AD.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},resetICR:function R(){var AD=this.icr.isIncremental;this.icr=mstrmojo.hash.clone(f);this.icr.isIncremental=AD;},buildRendering:function n(AE){var AD=this._super(AE);this.renderGrid();return AD;},renderGrid:function I(AE){var AD=this.getGridContainer();this.resetICR();this.preBuildGridTable();this.buildGridTable(AD,AE);this.postBuildGridTable();},getGridContainer:function L(){return this.gridContainerNode;},buildGridTable:function P(AF,AD){var AE=this.getTableStartMarkup();var AL=this.getTableEndMarkup();if(AD){this.mergeHdrsAcrossBlks=true;}this._hasInlineListener=false;var AJ=this.buildTableRowsMarkup(this.start,this.end,AE,AL).join("");if(AD){var AH=document.createElement("div");AH.innerHTML=AJ;if(this._hasInlineListener){h.recursiveReplaceInlineEventListeners(AH);this._hasInlineListener=false;}var AK=AF.firstChild,AM=AK&&AK.tBodies,AG=AH.firstChild.tBodies[0],AI=this.matchedHdrsAcrossBlks;AK.appendChild(AG);if(AI&&AI.length>0){c(AI,AM[AM.length-2]);}}else{AF.innerHTML=AJ;if(this._hasInlineListener){h.recursiveReplaceInlineEventListeners(AF);this._hasInlineListener=false;}}this.markPages(this.start,this.end);},getTableStartMarkup:function G(){var AF=this._getGridWidths(),AD=w.slice();if(mstrApp.isDossier&&mstrApp.isVI){var AE=this.parent&&this.parent.parent?this.parent.parent.title:"";AD[0]=AD[0].replace("<table",'<table aria-label="'+z.encodeHtmlString(AE,true)+'"');}AD[1]=AF.tableLayout;AD[3]=AF.totalColWidths;AD[5]=this.tableCssClass?"class="+this.tableCssClass:"";AD[7]="<colgroup>"+AF.colgroup+"</colgroup>";if(this.tbodyStyle){AD[8]='<tbody style="'+this.tbodyStyle+'">';}return AD.join("");},getTableEndMarkup:function W(){return"</tbody></table>";},_getGridWidths:function Z(){var AS={};var AN="",AK=[],AR="fixed",AH=this.cws,AO=AH.length;if(AO){var AM=this.icr;AM.tcc=AO;var AE=AM.getBeginIndex(),AI=this.parent.titlesCP,AJ=AI.getSpanDimension(),AG=AJ.nCol,AD=AM.getEndIndex();var AQ=function AQ(AT){if(!AM.isIncremental){return true;}if(AT<AG){return true;}if(AT>=AE-1&&AT<=AD){return true;}return false;};AN=0;AK=[];for(var AL=0;AL<AO;AL++){if(AH[AL].w!==""){AN+=parseInt(AH[AL].w,10);}}for(AL=0;AL<AO;AL++){if(AQ(AL)){var AF=AH[AL];if(AF.w!==""&&!this.autoFitWindow&&!this.autoFitContent){var AP=parseInt(AF.w,10);if(h.isIE7){if(AP===0){AK.push('<col style="width:0%;display:none"></col>');}else{AK.push('<col style="width:'+(AP/AN*100)+'%"></col>');}}else{if(h.isWK&&AP===0){AK.push('<col style="width:-1px"></col>');}else{AK.push('<col style="width:'+AF.w+'"></col>');}}}else{AK.push("<col />");AR="auto";}}}this.totalColWidth=AN;}AS.colgroup=AK.join("");AR=this.tableLayout||AR;if(this.autoFitWindow){AR=this.tableLayout||AR||"fixed";AN="100%";}else{if(AR==="fixed"){AN+="px";}else{AN="auto";}}AS.totalColWidths=AN;AS.tableLayout=AR;return AS;},_CELL_MARKUP:['<td tabindex="-1" role="gridcell" rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function K(AX,Ay,AR,AK,AE){var BP=[],Ax=0;BP[Ax++]=AR||"<table><tbody>";var Ao=this.cp,BO=this.acws,BT=this.rowMerge,Bh=this.headerOffset,Bi=this.mxPos,Ba=!!Ao.gemh,Bl=Ao.getRowHeight(),AD=this._CELL_MARKUP,Bj=Bl?'<tr style="height:'+(Bl?Bl+"px":"")+'">':O;var BW=true,Bf=true,At=[],Bo;var A9=function A9(Bq){var Bp=-1;mstrmojo.array.forEach(BO,function(Bs,Br){Bq=Bq-Bs;if(Bq<0){Bp=Br;return false;}});return Bp;};var Ah=function Ah(Br,Bq){var Bp=-1;mstrmojo.hash.forEach(Ao.gemh,function(Bs,Bt){if(Br<=Bt&&Br+Bq>Bt){Bp=Bt;return false;}});return Bp;};var AW=function AW(Bt,Bu,Bs){var Br="",Bq,Bp;Bp=Bt.gemh&&Bt.gemh[Bu];if(Bp){Bq=A9(Bs);if(Bp[Bq]&&Bp[Bq].v===0){Br+=t;}}Bp=Bt.gsmh&&Bt.gsmh[Bu];if(Bp){Bq=A9(Bs);if(Bp[Bq]&&Bp[Bq].v===0){Br+=Y;}}return Br;};var BU,Al,BG,Am=[],Aw,Aq,AJ=0,A6=0,Au,AS,AI=Ao.colWidths&&Ao.colWidths.length,Bn=0,BK=0,BD=AE||((AR&&AR.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto"),Ad=mstrApp.isSingleTier,As=mstrApp&&(mstrApp.isDossier||(mstrApp.getWSLiveMode&&mstrApp.getWSLiveMode())),AZ=this.parent,BQ=S.walk("controller.model.encodeHtmlContent",AZ)&&!AZ.isViewOnly;if(BO&&Ba){for(Aw=0;Aw<BO.length-1;Aw++){BK+=BO[Aw];}}BK=BK||this.numColumnCanMerge;if(BD==="fixed"){BU=[];for(Al=0,BG=this.cws.length;Al<BG;Al++){if(window.parseFloat(this.cws[Al].w)<=0){BU[Al]=true;}else{BU[Al]=false;}}}this.matchedHdrsAcrossBlks=[];var AM=Ay,Bk=AZ.isOutlineMode,BE=AZ.gridData,Bg=BE.maxLevel,Az=BE.lvlepd,AO=AZ.id,Ap=0;Ao.renderingNewPage=true;var AF=this.icr,BX=this.parent.titlesCP,BA=BX.getSpanDimension(),BN=BA.nCol,BF=AF.isIncremental,Ab=AF.currColSec,A0=0,Ag=0,BR=AF.getBeginIndex(),BB=AI;AF.tcc=AI;if(BF){BB=AF.getEndIndex();var A7=this.columnSecWidth,Af;for(Af=BN;Af<(Ab-1)*AF.dcpp;Af++){A0+=A7[Af];}A0=Math.max(A0,AF.leftOffset||0);for(Af=(Ab+2)*AF.dcpp;Af<AI;Af++){Ag+=A7[Af];}if(h.isIE&&AI>10000){if(A0>0){var BZ=this.parent.scrollNode,AP=0;for(Af=0;Af<BN;Af++){AP+=A7[Af];}for(Af=(Ab-1)*AF.dcpp;Af<Ab*AF.dcpp;Af++){AP+=A7[Af];}A0=BZ.scrollLeft-AP;for(Af=Ab*AF.dcpp;Af<(Ab+2)*AF.dcpp;Af++){AP+=A7[Af];}Ag=BZ.scrollWidth-BZ.scrollLeft-AP;}else{Ag=80000;}}}for(var Ar=AX;Ar<=Ay;Ar++){AJ=0;Bo=Ax++;BP[Bo]=Ar<this.numAutoHeightRows?O:Bj;var AG=Ao.updateCounter,A1=Ao.getRowCells(Ar);if(Bk&&window.mstrApp&&mstrApp.isExporting){var Ac=Ao.updateCounter-AG;if(Ac>0){Ap=Ac;}if(Ap>0){Ap--;BP[Bo]=BP[Bo].substr(0,BP[Bo].length-1)+' extra="1">';}}var A5=Ay+1-Ar;var Aj=0;AS=BT;Au="";if(!this.mergeHdrsAcrossBlks){if(BW&&AX>0&&A1.length<Ao.colWidths.length){var BI=Ao.getUnmergedCells(AX),BC;if(BI){Aj=BI.length;}for(Aw=0,BG=Aj;Aw<BG;Aw++){var BM=BI[Aw],Be=BM.rs;if(Be>A5){AD[1]=A5;AD[5]=g+BM.css;}else{AD[1]=Be||1;AD[5]=Y+BM.css;}if(BU&&BU[A6+AJ]){AD[5]+=" nwFixedWidth0 ";}if(Be&&Be>1){Am.push(Be);}AJ+=BM.cs||1;if(BM.cet){AD[5]+=" mstrmojo-selected-cell";this.addHilitePosition(BM.cet,Ar,Aw);}if(BM._ei){this.addExtraInfoMap(BM._ei,Ar,Aw);AD[5]+=" pt";}AD[9]="";AD[13]=b;AD[3]=BM.cs;if(BM._ei===undefined){BC=Ao.getRowCells(BM.o+(Ao.cps[0]&&Ao.cps[0].rc||0),true);BM=l.filterOne(BC,function(Bp){return Bp.dpt===BM.dpt&&Bp.idx===BM.idx;});}AD[7]=BM._ei;AD[11]=Ar;if(Ba){if(AS){Au=AW(Ao,Ar-Bh,Aw);}if(!!Au){AD[5]=Au+AD[5];}else{AS=false;}Au=AW(Ao,Ah(Ar-Bh,AD[1]),Aw);if(!!Au){AD[5]=t+AD[5];AS=true;}}BP[Ax++]=AD.join("");}BW=false;}}var BY=false;var AN=0;Bn=AI;BG=A1.length;var A3;for(A3=0;A3<BG;A3++){Bn-=A1[A3].cs||1;}for(A3=0;A3<BG;A3++){var Ak=A1[A3],Bd;AN=0;if(BF){var A4=Bn;if(A4>=BN){if(A4>=BB){break;}if(A4<BR){if(!BY){BP[Ax++]=AF.getPaddingHTML(AD,Ar,Ak.rs||1,A0);BY=true;}if(A4+(Ak.cs||1)<=BR){Bn+=Ak.cs||1;continue;}else{AN=Math.min((Ak.cs||1)-(BR-A4),BB-BR);}}else{if(A4+(Ak.cs||1)>BB){AN=BB-A4;}}}}if(Ak.outLvl){var Bb=H.call(this,Ak,Bg,Az);BP[Bo]=BP[Bo].replace(">",Bb);if(Ao.updateCounter>0){Ay=AM+Ao.updateCounter;}}Ak.colIx=Bn;if(Ak.rs&&Ak.rs>A5){AD[1]=A5;AD[5]=t+Ak.css;if(Ak._ei){this.addExtraInfoMap(Ak._ei,Ar,A3);}}else{AD[1]=Ak.rs||1;AD[5]=Ak.css;}if(BU&&BU[Bn]){if(Ak.cs===undefined||k(BU,Bn,Ak)){AD[5]+=" nwFixedWidth0 ";}}if(Ak.rs&&Ak.rs>1){Am.push(Ak.rs);}AJ+=Ak.cs||1;if(Ak.rowType!==q){AD[5]+=" xtab-td ";}if(Ak.cet){AD[5]+="sc_"+this.parent.k;this.addHilitePosition(Ak.cet,Ar,A3);}if(Ak.lv!==undefined){AD[5]+=" ra ";}Bd=Ak.rowType;if(Bd){AD[5]+=a[Bd]||"";var An=Ao.getRowHeight(Bd);if(An){BP[Bo]='<tr style="height:'+(An?An+"px":"")+'">';}}AD[3]=AN||Ak.cs||1;AD[7]=Ak._ei!==undefined?Ak._ei:"";if(Ak.fs||Ak._e){this.addTitleHeaderPositionMap(Ar,A3+Aj,Ak);}if(Ak._ei!==null){this.addPositionMap(Ak._ei,Ar,A3+Aj);}AD[11]=Ar;var BH=Ak.v&&Ak.v.indexOf("#srcstart")>=0;if(Ak.ts===Q){if(As&&!BH){Ak.v=mstrmojo.url.getFullPath(Ak.v);}var BS=Ak.v;if(this.imgCacheMap){var Av=this.imgCacheMap,Aa=BS&&BS.replace(/\\/g,"/");if(Av.cachedImg[Aa]){Ak.v=BS=Av.baseURL+Av.cachedImg[Aa];}else{if(Aa&&!Av.unCachedImg[Aa]){Av.unCachedImg[Aa]=Aa;}}}else{var AQ=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(AQ&&AQ.getImage){BS=AQ.getImage(BS);}}if(Ak.rowType){var AY=(Ao.getRowHeight(Ak.rowType)||Ao.rh||Bl),Ae=AY,Bm=this.tdWidths,AU=Ak.colIdx,AL=0,AT=0;var A8=Ao.getPadding(N),BV=Ao.getPadding(y);if(Ak.rowType===q||Ak.rowType===p){AT=AY>(A8+BV)?(AY-A8-BV):0;}else{if(Ak.rowType===s||Ak.rowType===J){AT=AY>2*BV?(AY-2*BV):0;}else{if(Ak.rowType===AB){AT=AY>(BV*2)?(AY-BV*2):0;}}}if(AU!=="undefined"&&AU>-1&&Bm&&Bm.length>AU){var Ai=Bm[AU]&&Bm[AU].w;if(Ai!=="undefined"){AL=parseInt(Ai,10);}}var AH=AL>30?(AL-30):0;AD[13]='<div><div style="top:'+(-parseInt(Ae/2,10))+"px;height:"+(AY-1)+"px;line-height:"+(AY-1)+'px !important;">&nbsp;<img style="max-height:'+AT+"px; max-width: "+AH+'px;" src="'+BS+'"></img></div></div>';}else{AD[9]="";var BJ="",AV=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,BL=AV.getZoomFactor();if(BL!==1){BJ=' mstrevent="load" onload="this.style.height = parseInt((this.style.height || 0), 10) > 0 ? this.style.height : '+BL+" * this.offsetHeight+'px';\"";this._hasInlineListener=true;}if(Bk){if(BH){Ak.v=AA(BS,BJ,As);}else{Ak.v='<img src="'+BS+'" '+BJ+"></img>";}AD[13]=M.call(this,Ak,{forceNewBrowserWindow:Ad,gridId:AO,isServerEncoded:BQ});}else{var A2=mstrmojo.hash.clone(Ak);A2.v='<img src="'+BS+'" '+BJ+"></img>";AD[13]=M.call(this,A2,{forceNewBrowserWindow:Ad,gridId:AO,isServerEncoded:BQ});}if(Ak.css&&Ak.css.indexOf("hl")>-1){AD[13]="<span>"+AD[13]+"</span>";}}}else{AD[9]="";if(Bk&&BH){Ak.v=AA(Ak.v,"",As);AD[13]=M.call(this,Ak,{forceNewBrowserWindow:Ad,gridId:AO,isServerEncoded:BQ});}else{if((mstrApp.isDossier||mstrApp.useBinaryFormat)&&Ak.v&&Ak.v.indexOf("img")>=0){Ak.v=o.call(this,Ak.v);}AD[13]=M.call(this,Ak,{forceNewBrowserWindow:Ad,gridId:AO,isServerEncoded:BQ});}}if(A3<BK){if(Ar===AX&&this.mergeHdrsAcrossBlks){var Bc=this.rowHdsAcrossBlks;if(Bf&&Ak.v&&Bc&&Bc[A3]){if(Ak.v===Bc[A3].v){AD[1]=Ak.rs||1;AD[5]=Y+Ak.css;AD[13]="";this.matchedHdrsAcrossBlks.push(Bc[A3]);}else{Bf=false;}}}if(Ba&&AS){Au=AW(Ao,Ar-Bh,Bn);if(!!Au){AD[5]=Au+AD[5];if(Au.indexOf(Y)>=0&&Ar-Bh>1){AD[13]=b;}}else{AS=false;}Au=AW(Ao,Ah(Ar-Bh,AD[1]),Bn);if(!!Au){AD[5]=t+AD[5];AS=true;}}if(AD[1]>=A5&&Ak.v){At.push({rows:Ar-AX,cells:A3,v:Ak.v});}}Bn+=Ak.cs||1;BP[Ax++]=AD.join("");}if(BF&&AI>BB){BP[Ax++]=AF.getPaddingHTML(AD,Ar,1,Ag);}BP[Ax++]="</tr>";for(A3=Am.length-1;A3>=0;A3--){Aq=Am[A3];if(Aq<=1){Am.pop();}else{Am[A3]=--Aq;}}A6=Am.length;}BP[Ax++]=AK||"</tbody></table>";this.rowHdsAcrossBlks=At;return BP;},addHilitePosition:function(AE,AF,AD){var AG=this.hiliteCellsMap[AE];if(!AG){this.hiliteCellsMap[AE]={pos:[],nodes:[]};}this.hiliteCellsMap[AE].pos.push({row:AF,cell:AD,page:0});},addExtraInfoMap:function(AE,AD,AF){if(!this.eiMap[AE]){this.eiMap[AE]=[];}this.eiMap[AE].push({row:AD,cell:AF,page:0});},addPositionMap:function(AE,AD,AF){if(!this.posMap[AE]){this.posMap[AE]={row:AD,cell:AF,page:0};}},addTitleHeaderPositionMap:function(AD,AF,AE){this.thPosMap.push({row:AD,cell:AF,page:0,obj:AE});},clearHilites:function(AG){var AK=this.hiliteCellsMap[AG],AI=AK&&AK.nodes,AH=this.parent;if(AI){if(AI.length===0&&AK.pos){AI=this.getNodesByPositions(AK.pos);}for(var AF=0,AE=AI.length;AF<AE;AF++){var AJ=AI[AF],AD=AH.getCellForNode(AJ);if(AD){delete AD.cet;}E.removeClass(AJ,"sc_"+AH.k);}this.hiliteCellsMap[AG].nodes=[];}},setHilites:function(AE,AF){E.addClass(AF,"sc_"+this.parent.k);if(!this.hiliteCellsMap[AE]){this.hiliteCellsMap[AE]={pos:[],nodes:[]};}this.hiliteCellsMap[AE].nodes.push(AF);var AD=this.parent.getCellForNode(AF);if(AD){AD.cet=AE;}},getNodesByPositions:function(AH){var AG=this.tableNode,AD=[];for(var AF in AH){var AE=AH[AF];AD.push(AG.tBodies[0].rows[AE.row].cells[AE.cell]);}return AD;},preBuildGridTable:function e(){},postBuildGridTable:function x(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});if(this.tableNode&&mstrApp&&mstrApp.isSingleTier){h.redirectUrlToFormWrapper(this.tableNode);}}});mstrmojo.GridBase.ColRenderSetting=f;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.string");var D=mstrmojo.dom,B=mstrmojo.hash,G=mstrmojo.css,J=mstrmojo.string;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",ariaLabel:"",enabled:true,selected:false,markupString:'<div id="{@id}" role="button" aria-label="{@getAriaLabel}" tabindex="-1" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup,keydown><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){G.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){G.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;if(!this.ariaLabel){this.domNode.setAttribute("aria-label",this.getAriaLabel());}},onariaLabelChange:function(){this.domNode.setAttribute("aria-label",this.getAriaLabel());},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function E(M){var N=this.domNode;if(this.hasRendered&&N){N.className=N.className.replace(M.valueWas,"")+" "+M.value;}},onclick:mstrmojo.emptyFn,ontouchend:function L(M){this.onclick(M);},onkeydown:function F(M){var O=M.e||M,N=O.key;if(this._super){this._super(M);}if(N==="Enter"||N===" "){O.preventDefault();O.stopPropagation();this.onclick(M);}},getAriaLabel:function C(){return J.encodeHtmlString(this.ariaLabel||this.text,true);}});mstrmojo.Button.newIconButton=function K(O,R,P,M,Q){var N={scriptClass:"mstrmojo.Button",title:O,cssClass:R,text:"",onclick:P};if(M){N.bindings=M;}B.copy(Q,N);return N;};function I(P,Q,M,S){var O=[];if(M){O.push(M);}var R=S&&S.cssClass;if(R){O.push(R);delete S.cssClass;}var N={scriptClass:"mstrmojo.Button",cssClass:O.join(" "),text:P};if(Q){N.onclick=Q;}return B.copy(S,N);}mstrmojo.Button.newInteractiveButton=function H(P,Q,S,R){var O={glowClass:"glow"};if(S&&(D.isFF||D.isWK)){B.copy({onmousedown:function M(){G.applyShadow(this.domNode,0,0,10,S);},onmouseup:function N(){G.removeShadow(this.domNode);}},O);}return I(P,Q,"mstrmojo-InteractiveButton",B.copy(R,O));};mstrmojo.Button.newWebButton=function A(N,M,P,O){return I(N,M,"mstrmojo-WebButton"+(P?" hot":""),O);};mstrmojo.Button.newActionButton=function(N,O,P){var M=mstrmojo.Button.newWebButton(N,O,false,P);M.cssClass=M.cssClass+" action-button";return M;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(B.decodeHtmlString(C),true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(X,R){var W=X?[X]:(this.children||[]),O=W.length,S;for(S=O-1;S>-1;S--){var Q=W[S],P=Q&&Q.domNode;if(P){var U=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===U){U.removeChild(P);}}}return this._super(X,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var Y=O&&O.domNode;if(!Y){return ;}var P=this.defaultChildSlot,X=O.slot||P,a=this[X],Q=this.children;if(!a){if(Y.parentNode){Y.parentNode.removeChild(Y);}}else{if(Y.parentNode===a){return ;}if(!this.preserveChildDomOrder){a.appendChild(Y);}else{var R,W;for(W=Q.length-1;W>=0;W--){var Z=Q[W];if(Z===O){break;}if(X===(Z.slot||P)){var b=Z.domNode;if(b&&b.parentNode===a){R=b;}}}if(R){a.insertBefore(Y,R);}else{a.appendChild(Y);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,U;for(U=0;U<S;U++){if(!Q[U].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var L=mstrmojo.color,H=mstrmojo.dom;var I=68.5,M=77.5,D=83;function B(O,N){return{x:O.clientX-N.x-M,y:O.clientY-N.y-M};}function K(){var N=this._hsl[1],P=this._hsl[2];var O=this.slHandleNode.style;O.left=Math.round(D*(0.5-N)+M)+"px";O.top=Math.round(D*(0.5-P)+M)+"px";}function F(){var N=this._hsl[0],P=N*2*Math.PI;var O=this.hueHandleNode.style;O.left=Math.round(Math.sin(P)*I+M)+"px";O.top=Math.round(-Math.cos(P)*I+M)+"px";this.slNode.style.backgroundColor=L.hsl2hex(N,1,0.5);}function C(){this._hsl=L.hex2hsl(this.color);if(this.slHandleNode&&this.hueHandleNode){K.call(this);F.call(this);}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function G(N){},postBuildRendering:function A(){C.call(this);},oncolorChange:function J(){C.call(this);},onmousedown:function E(Q){var S=this,N=H.position(this.domNode),U=this._hsl,P=Q.e,R=B(P,N),W=Math.max(Math.abs(R.x),Math.abs(R.y))*2>D,O=function(Z){var c=B(Z,N),Y=U[0],a=U[1],b=U[2];if(W){Y=Math.atan2(c.x,-c.y)/(2*Math.PI);if(Y<0){Y+=1;}S._hsl=[Y,a,b];F.call(S);}else{a=Math.max(0,Math.min(1,-(c.x/D)+0.5));b=Math.max(0,Math.min(1,-(c.y/D)+0.5));S._hsl=[Y,a,b];K.call(S);}var X=L.hsl2hex(Y,a,b);S.color=X;S.onColorPicked(X);H.stopPropogation(window,Z);return false;};H.attachMouseMoveEvents(O);O(P);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image class="{@imgCssClass}" src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.css;mstrmojo.TabButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.TabButton",cssDisplay:"inline",markupString:'<span id="{@id}" class="mstrmojo-TabButton {@cssClass}" style="{@cssText}" mstrAttach:click></span>',markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod,ontitleChange:function(){this.domNode.innerHTML=this.title||"";},onbackgroundColorChange:function(){this.domNode.style.backgroundColor=this.backgroundColor||"";},onselectedChange:function(){A.toggleClass(this.domNode,["selected"],!!this.selected);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@en@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}" mstrevent="change" onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.vi.util.A11yUtility","mstrmojo.css");var E=mstrmojo.Widget,B=mstrmojo.vi.util.A11yUtility;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",ariaLabel:"",markupString:'<div id="{@id}" role="checkbox" aria-label="{@en@ariaLabel}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click,keydown></div>',markupMethods:{onvisibleChange:E.visibleMarkupMethod,oncheckedChange:function D(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);if(this.domNode){this.domNode.setAttribute("aria-checked",this.checked);}},onenabledChange:E.enabledMarkupMethod},checked:false,onclick:function A(F){this.actionByKeyboard=B.isKeyBoardEvent(F&&F.e);this.set("checked",!this.checked);},onkeydown:function C(F){var H=F.e||F,G=H.key;if(this._super){this._super(F);}if(G==="Enter"||G===" "){H.preventDefault();H.stopPropagation();this.onclick(F);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.Widget");var Z=mstrmojo.hash,h=mstrmojo.css,L=mstrmojo.dom,e="animate",P="px";function c(i){return Z.copy(((!!mstrApp.isWSStyling)?Z.walk(i,window).boxConfigurationWS:undefined)||Z.walk(i,window).boxConfiguration||mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration);}function H(k){var j=k.boxCache,l=j&&j[this.id],i=false;if(!l){i=this.domNode.className.indexOf(e)>-1;this.cacheCtxtBoxPosition(k);}k.boxAnimating=i;}mstrmojo.vi.ui._IsBoxLayoutChild=mstrmojo.provide("mstrmojo.vi.ui._IsBoxLayoutChild",{_mixinName:"mstrmojo.vi.ui._IsBoxLayoutChild",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||1;}},id:null,left:"0px",top:"0px",zIndex:1,draggable:false,dropZone:false,getBoxConfiguration:function C(){return c(this.scriptClass);},getBoxBorderWidth:function I(){return 0;},getMinBoxSize:function A(i){return mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(this.scriptClass)[i];},getIdentifier:function Q(){return this.id;},updateLayout:function O(l,i){if(Z.equals(l,this._currentLayout)){return ;}mstr_profile.log(this.title+" layout update.");var k=this.domNode,n=window.Modernizr,m=this.getBoxBorderWidth();if(k&&i&&n.testProp("transition")){h.addClass(k,e);h.onTransitionEnd(k,function(){h.removeClass(k,e);});}var j=this._currentLayout;this._currentLayout=Z.copy(l);this.applyBoxSize(Math.max((this.unDocked?parseFloat(l.height):parseInt(l.height,10))-m,0)+P,Math.max((this.unDocked?parseFloat(l.width):parseInt(l.width,10))-m,0)+P,l.top,l.left);if(this.hasRendered&&this.doLayout){this.doLayout();}this.postUpdateLayout(j);},postUpdateLayout:function D(){},applyBoxSize:function a(i,l,n,m){this.height=i;this.width=l;this.top=n;this.left=m;var k=this.domNode;if(k){var j=this.domNode.style;j.top=n;j.left=m;j.height=i;j.width=l;if(parseInt(i,10)<=0||parseInt(l,10)<=0){j.borderWidth="0";}}},createAvatar:function X(){return this.offsetAvatar(this.domNode);},offsetAvatar:function S(i){i.style.margin="20px 0 0 20px";return i;},setMaskVisibility:function U(i){var j=this.maskNode.style;j.display=i?"block":"none";if(!i){this.resetMask();}},isDragValid:function F(i){return true;},initializeDrag:function G(i){},ondragstart:function g(i){this.initializeDrag(i);delete this._currentLayout;this.parent.beginBoxMove(i,this);if(!this.unDocked){this._super(i);}},ondragend:function N(i){if(!this.unDocked){this._super(i);}this.parent.endBoxMove(i,this);if(!i.dropSuccessful){this.parent.cancelBoxMove(i);}var j=this.domNode;j.style.margin="0";},allowDrop:function K(i){var k=i.src,j=k&&k.widget;return(j&&j.parent===this.parent);},wasDropped:function M(i){},cancelBoxMove:function J(i){return false;},ondragenter:function W(i){this.setMaskVisibility(true);},ondragover:function Y(i){H.call(this,i);this.highlightMask(this.parent.getPanelTargetEdge(i)||this.getTargetDropZone(i),i);if(i.boxAnimating){delete i.boxCache[this.id];}},cacheCtxtBoxPosition:function E(j){var i=j.boxCache=j.boxCache||{};i[this.id]=L.position(this.domNode);},ondrop:function d(i){H.call(this,i);var k=i.src.widget;if(k.wasDropped){k.wasDropped(i);}var j=this.parent;if(k.parent===j){j.dropBox(i,this,this.maskNode.zone,true);}this.setMaskVisibility(false);},ondragleave:function B(){this.setMaskVisibility(false);},highlightMask:function f(l,k){var i=this.maskNode,j=k.boxAnimating;if(l!==i.zone||j||i.isAnimating!==j){i.zone=l;i.isAnimating=j;this.parent.updateDropCue(l,k,k.boxCache[this.id]);}},getTargetDropZone:function R(i){return mstrmojo.boxmodel.getEdgeQuadrantByPoint(i.boxCache[this.id],i.tgt.pos);},resetMask:function b(){this.parent.updateDropCue("");var i=this.maskNode;delete i.zone;delete i.isAnimating;},getBoxDimension:mstrmojo.emptyFn,postDropBox:mstrmojo.emptyFn});mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration={addToEnd:true};mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums=function(i){var j=c(i);return Z.copy(j.minSize||j.f||{h:75,v:75});};mstrmojo.vi.ui._IsBoxLayoutChild.BoxConfigurationType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(H,I);}else{mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);}},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget","mstrmojo.fe.FilterUtils");var I=mstrmojo.dom,A=mstrmojo.css,E=mstrmojo.fe.FilterUtils,D=E.getExprConditionNodeHtml,B=E.getExprNodeHtmlAndText;function C(J){var K=J.data;return D(K);}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="'+mstrmojo.getJsRoot()+'../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" mstrevent="click" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){A.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){A.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();var J=B(this.data);this.textNode.innerHTML=J.html;this.textNode.title=J.text;this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function H(J){this._super(J);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function G(){var J=this.parent;if(J&&J.remove&&this.data){J.remove(this.data);}},isEmpty:function(){var K=this.data,J=K&&K.et,L=J&&mstrmojo.expr.ET2TGT[J];return !(L&&K[L]);},isSelectableArea:function(J){return I.contains(this.condNode,J,true);},preclick:function F(J){var L=null,K=I.eventTarget(J.hWin,J.e);if(I.contains(this.prefixNode,K,true)){L="andor";}else{if(I.contains(this.textNode,K,true)){L="condition";}else{if(I.contains(this.textPostfixNode,K,true)){I.stopPropogation(J.hWin,J.e);return false;}}}J.part=L;}});mstrmojo.ConditionNode.getFunctionNode=C;})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.threshold.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{scriptClass:"mstrmojo.threshold.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass} mstrAttach:mousedown"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" mstrevent="click" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span></div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},preclick:function A(C){var F=null,E=B.eventTarget(C.hWin,C.e),D=this._super(C);if(B.contains(this.addConditionNode,E,true)){F="addCondition";}C.part=F||C.part;return D;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.Checkbox");var A={ROUND:"round",RECT:""};mstrmojo.ui.ToggleButton=mstrmojo.declare(mstrmojo.ui.Checkbox,null,{scriptClass:"mstrmojo.ui.ToggleButton",markupString:'<div id="{@id}" class="mstrmojo-ui-ToggleButton {@cssClass}" mstrAttach:click><div class="container"><div class="slider {@sliderStyle}"></div></div></div>',sliderStyle:A.ROUND});mstrmojo.ui.ToggleButton.EnumStyle=A;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.Image");mstrmojo.threshold.ImageBand=mstrmojo.declare(mstrmojo.Image,null,{scriptClass:"mstrmojo.threshold.ImageBand",cssClass:"mstrmojo-Image color-band"});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ImageBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(11668,15187,15188,15189,15190);function B(L,K,I){var J=K,H;for(;J>0;J--){H=Array(J+1).join("#");L=L.replace(H,I[J-1]);}return L;}var C='<div class="ghost-vis-txt-metric">',A='<div class="ghost-vis-txt-attr">',E='<div class="ghost-vis-txt-attr-time">',G="</div>";var D={grid:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),heatmap:B(mstrmojo.desc(15187,"Add # or more ##attributes### and/or #### or more #####metrics######"),6,[1,A,G,1,C,G]),barchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),verticalbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),horizontalbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),verticalclusteredbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),horizontalclusteredbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),verticalstackedbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),horizontalstackedbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),verticalpercentbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),horizontalpercentbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),syncaxisbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),matrixbarchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),linechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),dualaxislinechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),stackedareachart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),absoluteareachart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),bubblechart:B(mstrmojo.desc(15190,"Add # or more ##metrics### and #### or more #####attributes######"),6,[2,C,G,1,A,G]),piechart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),ringchart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),combochart:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,2,C,G]),network:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[2,A,G,1,C,G]),histogram:B(mstrmojo.desc(15667,"Add # or more ##attributes### and ####  #####metric######"),6,[1,A,G,1,C,G]),boxplot:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),waterfall:B(mstrmojo.desc(15188,"Add # or more ##attributes### and #### or more #####metrics######"),6,[1,A,G,1,C,G]),kpicard:B(mstrmojo.desc(15878,"Add # or more ##attributes### and #### #####metric######"),6,[1,A,G,1,C,G]),surveymonkey:mstrmojo.desc(17267,"Choose a survey from ## account, or insert a ## URL").replace(/##/gi,"SurveyMonkey"),surveygizmo:mstrmojo.desc(17267,"Choose a survey from ## account, or insert a ## URL").replace(/##/gi,"Alchemer"),amselector:B(mstrmojo.desc(16875,"Add #attributes## or ###metrics#### here"),4,[A,G,C,G])};function F(H){return D[H]?D[H]:mstrmojo.desc(11668,"Drag objects here.");}mstrmojo.vi.ui.rw.GhostImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-ghostImgTableCell"><div class="mstrmojo-ghostImgDiv"><div class="ghost-vis-img"></div><div class="ghost-vis-name">{@visName}</div><div class="ghost-vis-desc">{@visDesc}</div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",visDesc:""});mstrmojo.vi.ui.rw.GhostImageContainer.getVisDesc=F;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");function B(K,J,H){var I=J,G;for(;I>0;I--){G=Array(I+1).join("#");K=K.replace(G,H[I-1]);}return K;}var C='<div class="freezing-vis-txt-metric">',A='<div class="freezing-vis-txt-attr">',E="</div>",F="("+mstrmojo.desc(16294,"data retrieval paused")+")";var D=function(J,I){if(J<1&&I<1){return null;}var H=[],G="# ## ### ####";if(J>0){H.push(B(G,4,[A,J,J>1?mstrmojo.desc(3581,"Attributes"):mstrmojo.desc(518,"Attribute"),E]));}if(I>0){H.push(B(G,4,[C,I,I>1?mstrmojo.desc(3582,"Metrics"):mstrmojo.desc(517,"Metric"),E]));}return H.join(",");};mstrmojo.vi.ui.rw.FreezingImageContainer=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-rw-freezingImageContainer mstrmojo-vi-ui-rw-GhostImageContainer {@cssClass}"><div class="mstmojo-freezingImgTableCell"><div class="mstrmojo-freezingImgDiv"><div class="freezing-vis-img ghost-vis-img"></div><div class="freezing-vis-desc"><label class="visName">{@visName}</label><div class="freezing-details">{@freezingDetails}</div></div><div class="vis-dropzone">{@visDropzoneMsg} </div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;}},visName:"",freezingDetails:F,visDropzoneMsg:""});mstrmojo.vi.ui.rw.FreezingImageContainer.getVisDropzoneMsg=D;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var W=H.slot;if(!this[W]){var M=W&&W.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),X=parseInt(M[2],10),Q=this.containerNode,U=this[(B+R)],N=[];if(!U){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}U=N[B+R];}var P=U.cells&&U.cells.length||0;for(var K=P;K<=X;K++){var I=U.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo.Button","mstrmojo.vi._MonitorsAppState");var K=mstrmojo.array;var E=1,B=2,P=4,M=8,I=16,S=32;function L(Z,Y,W,X,a,U){return mstrmojo.Button.newWebButton(Z,function(b){this.parent.set("_targetMode",Y);b.cancel();},W,{alias:X,flgVis:a,flgEnabled:U||undefined});}mstrmojo.vi.ui.TargetSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TargetSelector",markupString:'<div id="{@id}" class="mstrmojo-TargetSelector {@cssClass}" style="{@cssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function O(U){this._super(U);if(!this.hostId){throw new Error("You must pass the hostId when instantiating mstrmojo.vi.ui.TargetSelector.");}if(!this.srcId){this.srcId=this.hostId;}this.hostBox=mstrmojo.all[this.hostId];this.srcBox=mstrmojo.all[this.srcId];this._targetMode=E;},onAppStateChange:function N(U){var X=mstrmojo.vi.VisualInsightApp.APP_STATES,Y=X.SELECTOR_TARGETING,W=this.btnSelect;if(U.valueWas&Y||U.value&Y){W.set("enabled",!mstrApp.isAppStateSelection());}},hostId:null,srcId:null,srcPanelStackId:null,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onhostIdChange:function(){this.hostBox=mstrmojo.all[this.hostId];},onsrcIdChange:function(){this.srcBox=mstrmojo.all[this.srcId];},on_targetModeChange:function(){var b=this,a=this._targetMode,c=this.hostBox,U=this.srcBox,W=this.id,f=U.model,X=c.currentPanelKey?mstrmojo.all[f.getNodeDataByKey(c.currentPanelKey).id]:f.getVizContentPanel(),e=a===S,Y=function(){this.preChangeTargetSelectionMode(false,f);X.exitTargetSelectionMode(e,this.restoreChildren.bind(this));}.bind(this);this.children.forEach(function(g){g.set("visible",(g.flgVis&a)>0);g.set("enabled",(!g.flgEnabled||(g.flgEnabled&a)>0));g.refresh();});this.set("visible",a!==E);if(e||a===B){Y();if(!e){this.set("_targetMode",this._cancelMode);this.cancel(c);}this.exitTargetSelectionMode(c);}else{if(a===M){this.preChangeTargetSelectionMode(true,f);X.enterTargetSelectionMode(function(h,i){var g=i?E:M;if(!i&&c.isSelectionDirty(h,i)){g=I;}mstrmojo.all[W].set("_targetMode",g);if(i){c.setTargets(h);}},this.srcId,c.getTargetKeys(),this.enterTargetSelectionMode.bind(this),Y);}}var Z=mstrmojo.vi.VisualInsightApp.APP_STATES,d=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();mstrApp.set("appState",a===M||a===I?(d?Z.SELECTOR_TARGETING|Z.PAUSE:Z.SELECTOR_TARGETING):(d?Z.PAUSE:Z.DEFAULT));}},ignoreLayout:true,setSourceByKey:function H(U){var W=this.srcBox.model.getNodeDataByKey(U),Y=W?mstrmojo.all[W.id]:undefined,X=Y?Y.parent:undefined;if(X){this.set("srcId",X.id);}},preChangeTargetSelectionMode:function R(Y,W){var Z=W.getDocVIVisualizationsPanelStack().selector,X=W.controller.view,U=X.layoutViewer.docLayout.selector;U.set("isMasked",Y);Z.set("isMasked",Y);},enterTargetSelectionMode:function G(a,Z){var Y=this.srcId,X=mstrmojo.all[Y],U=X.isAMSelector instanceof Function&&X.isAMSelector(),W=X.isPanelSelector instanceof Function&&X.isPanelSelector();a.setMaskClass(Y,Z);a.set("enabled",Z!=="disabled"&&a.validateTarget&&a.validateTarget(U,W,Y));},exitTargetSelectionMode:function D(U){U.close();},restoreChildren:function J(U){U.set("enabled",true);U.clearMaskClass();},cancel:function C(U){if(U){U.cancel();}if(this.srcBox.isAMSelector instanceof Function&&this.srcBox.isAMSelector()){this.srcBox.tmp_replaceRelation={};}},enterPreSelectMode:function F(){this._cancelMode=P;this.set("_targetMode",P);},enterSelectMode:function Q(){this._cancelMode=E;this.set("_targetMode",M);},enterOffMode:function A(){this._cancelMode=E;this.set("_targetMode",E);},children:[L(mstrmojo.desc(4799,"Select Target"),M,true,"btnSelect",P),L(mstrmojo.desc(221,"Cancel"),B,false,"btnCancel",M+I),L(mstrmojo.desc(134,"Apply"),S,true,"btnApply",M+I,I)]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TabStripBase=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TabStripBase",target:null,targetProps:null,isStrip:true,ontargetChange:function A(I){var J=I&&I.valueWas;if(J){var G=this._targetSubs;if(G){J.detachEventListener(G.add);J.detachEventListener(G.rem);J.detachEventListener(G.sel);}this.removeChildren();}var K=this.target;if(K){var E=this.targetProps,D=(E&&E.children)||"children",B=K[D];this.addTabButtons(B,0);var H="attachEventListener",C=this.id,F;if(K[H]){this._targetSubs={add:K[H]("addChild",C,function(L){var M=L&&L.value;if(M&&M.length){this.addTabButtons(M,L.index);}}),rem:K[H]("removeChild",C,function(M){var L=M&&M.value;for(F=((L&&L.length)||0)-1;F>-1;F--){this.removeTabButton(L[F]);}}),sel:K[H]("selectedChange",C,function(L){this.selectionChange(L);})};}}},addTabButtons:mstrmojo.emptyFn,removeTabButton:mstrmojo.emptyFn,selectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo.ui._HasScroller","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.ThreeColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ThreeColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider1"'+D+'></div><div class="vi-col2"'+D+'></div><div class="divider2"'+D+'></div><div class="vi-col3"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},divider1Node:function H(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.childNodes[2];},divider2Node:function B(){return this.domNode.childNodes[3];},col3Node:function E(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"30%",divider1Node:"5px",col2Node:"30%",divider2Node:"5px",col3Node:"40%"},xt:true},shouldPropagateEnabled:true,col1Width:"30%",divider1Width:"5px",col2Width:"30%",divider2Width:"5px",col3Width:"40%",init:function G(I){this._super(I);var J=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),K=J.w;K.col1Node=this.col1Width;K.divider1Node=this.divider1Width;K.col2Node=this.col2Width;K.divider2Node=this.divider2Width;K.col3Node=this.col3Width;},getControl:function F(I){return(this.children||[]).filter(function(J){return J.slot==="col"+I+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui._HasUITheme","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.ui._HasUITheme");var B=mstrmojo.func,D=mstrmojo.dom,C=mstrmojo.ui._HasUITheme.EnumThemeNames,G="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function J(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);}this._super(N);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function E(){var N=this.getPopupWidget();if(!N||N._pbCfg){return ;}var O=function O(Q,P){return function(){Q.apply(P,arguments);};};N.onOpen=B.composite([O(this.onPopupWidgetOpened,this),N.onOpen||mstrmojo.emptyFn]);N.onClose=B.composite([O(this.onPopupWidgetClosed,this),N.onClose||mstrmojo.emptyFn]);N._pbCfg=true;},onclick:function L(N){if(this.isClickingAnchorSlot(N)){var O=this.getPopupWidget();if(!O.visible){this.openPopup(O);}else{this.closePopup();}}},isClickingAnchorSlot:function M(N){var O=N.getTarget();return O===this[this.anchorSlot]||O.parentNode===this[this.anchorSlot];},onPopupAutoClosed:function I(O,N){if(D.contains(this[this.anchorSlot],D.eventTarget(N,O),true)){return false;}},getPopupHostNode:function K(){return this.containerNode;},getPopupConfig:function H(){var O=[G],N=this.hostedCSSClass;if(N){O.push(N);}var P=new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:O.join(" ")});return this.disposables?this.addDisposable(P):P;},unrender:function F(N){if(this._listenerProc){D.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(N);},postBuildRendering:function A(){var R=this.getPopupWidget();if(R){var U=this.getPopupConfig();if(!U.isHostedWithin){var P=this.parent||this.opener,O=U.hostProxyCssClass.split(" ");O.push(this.domNode.className);while(P){var S=P.themeClassName;if(S){O.push(S);break;}P=P.parent||P.opener;}if(U.useDarkTheme){O.splice(O.indexOf(C.LIGHT_THEME),1);O.push(C.DARK_THEME);}U.hostProxyCssClass=O.join(" ");}mstrmojo.Obj.free(R.popupConfig);R.popupConfig=R.addDisposable(U);}if(!((this.editableSlot||this.containEditableWidget)&&D.isMobile)){var N=R.id,Q=this._listenerProc=function(){var W=mstrmojo.all[N];if(W&&W.visible&&W.adjustCornersForPopupOverflow){W.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){D.attachEvent(window,"resize",Q);}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",keepOpen:false,markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,U,R){var W="connectScrollbox";if(R){W="dis"+W;}var Q=S&&S.parent;while(Q){if(Q[W]){Q[W](U);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(X){var b=mstrmojo.all[R];if(!b){return ;}delete b._paintHandle;var U=[O],c=b.cssClass;if(c){U.push(c);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),Z=b.opener;if(Z&&Z.getTooltipThemeClass){S=Z.getTooltipThemeClass();}U.push(S);b.domNode.className=U.join(" ");var a=b.content,W=b.contentNode,Y=b.arrowNode;W.className=(O+"-content "+A+" "+b.contentNodeCssClass);W.style.cssText=b.contentNodeCssText;if(!b.hasWidgetContent){W.innerHTML=a;I.recursiveReplaceInlineEventListeners(W);}Y.style.cssText="";b.domNode.style.visibility=!!a?"visible":"hidden";b.updatePosition();if(!X&&b.optimizePos){b.optimizePos();}b.updateScrollbars();b.addScrollNodeProperties();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(X,g,l,Y){var b=g&&(g.richTooltip||g.tooltip),o=l?I.getMousePosition(l,Y||self):null,f=b&&(typeof b==="string");var m="",d="",a="",j=b,Q=false,c=null,R=mstrmojo.tooltip.POS_TOPLEFT,U=null,h=null,S=null,n=false,W=null,Z=mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;var i=false,k=false;if(b&&!f){d=b.cssClass||d;m=b.contentNodeCssClass||m;a=b.contentNodeCssText||a;j=b.content||"";c=b.refNode||c;Q=!!b.offsetAlgo;R=b.posType||R;U=b.left||0;h=b.top||0;i=b.keepArrowXPos||i;k=b.keepArrowYPos||k;S=b.updatePosition||null;n=b.hasWidgetContent;W=b.children;Z=b.tooltipCloseDelay||mstrmojo._HasTooltip.TOOLTIP_CLOSE_DELAY;}X.set("contentNodeCssClass",m);X.set("cssClass",d);X.set("contentNodeCssText",a);X.set("content",j);X.set("refNode",c);X.set("offsetAlgo",Q);X.set("posType",R);X.set("left",f?((o&&o.x)||X.left):U);X.set("top",(f||!b)?((o&&(o.y+E))||X.top):h);X.set("keepArrowXPos",i);X.set("keepArrowYPos",k);if(S){X.set("updatePosition",S);}else{X.set("updatePosition",mstrmojo.Tooltip.prototype.updatePosition);}X.set("hasWidgetContent",n);X.set("children",W);X.set("tooltipCloseDelay",Z);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",allowOtherTooltips:false,markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){if(!this.hasWidgetContent){this.contentNode.innerHTML=this.content;I.recursiveReplaceInlineEventListeners(this.contentNode);}this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(X){if(!this.visible&&!X){return ;}var W=this.refNode,U;if(W){if(!this.offsetAlgo){U=L.offset(W,document.body);}else{var h=W.getBoundingClientRect(),j=document.documentElement.getBoundingClientRect();U={left:h.left-j.left,top:h.top-j.top};}}else{U={left:I.getHorizontalScroll(),top:I.getVerticalScroll()};}var p=this.domNode.style,i=this.containerNode,m=i.offsetWidth,b=i.offsetHeight,R=this.posType,e=R.indexOf("R")>-1,Y=R.indexOf("B")>-1,d=this.top!==null?parseInt(this.top,10)+U.top-(Y?b:0):null,S=this.left!==null?parseInt(this.left,10)+U.left-(e?m:((R.indexOf("C")>-1)?Math.floor(m/2):0)):null,n=false,c=false,f,Z,l=I.windowDim(),k=I.getHorizontalScroll()+l.w,Q=I.getVerticalScroll()+l.h,g=this.arrowNode,o=null;if(S!==null){f=Math.min(Math.max(S,0),k-m);p.left=f+"px";n=S!==f;}if(d!==null){Z=Math.min(Math.max(d,0),Q-b);p.top=Z+"px";c=d!==Z;}if(n||c){var a,s=this.keepArrowXPos&&n,q=this.keepArrowYPos&&c;if(s||q){o=M.getComputedStyle(g);a=o.left;}if(a&&mstrmojo.string.endsWith(a,"%")){a=parseFloat(a)/100*m;}if(s){g.style.left=(parseInt(a,10)+S-f)+"px";}if(q){g.style.top=(parseInt(o.top,10)+d-Z)+"px";}}M.toggleClass(this.domNode,"offset",n||c);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(U,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,U,S,Q){if(R&&R.hasWidgetContent&&J){J.destroy();}if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=U;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J&&!J.allowOtherTooltips){var Q=J.opener;if(Q){Q.tooltip=null;}J.close();if(Q&&Q.hasWidgetContent){J.destroy();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.Container");mstrmojo.requiresDescs(1442,2140);var C=mstrmojo.dom;mstrmojo.ui.menus.ToolbarEditor=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._IsMenuPopup,mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.menus.ToolbarEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-ToolbarEditor mstrmojo-ui-MenuEditor {@cssClass}" style="..." mstrAttach:mouseover,mouseout,click><div class="te-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},popupConfig:null,children:null,autoCloses:false,locksHover:true,visible:true,onclick:function B(E){C.stopPropogation(null,E.e);},init:function D(F){this._super(F);var E=this.popupConfig,G=E.contents;if(!G){throw new Error("Cannot open editor without editor content.");}this.cssClass=E.cssClass;this.addChildren(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.util.A11yUtility");var e=mstrmojo.css,G=mstrmojo.dom,Z=mstrmojo.func,R=mstrmojo.vi.util.A11yUtility;var f={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var i=this.value,h=this.inputNode,j=h.value,g=(i!==null&&i!==undefined)?String(i):"";if(g!==j&&(!this.keepEmpty||j!==this.emptyText)){h.value=g;}if(h.mstrmojoEmpty){e.removeClass(h,[this.emptyClass]);h.mstrmojoEmpty=null;}}function d(){var g=this.inputNode;g.value=this.emptyText||"";e.addClass(g,[this.emptyClass]);g.mstrmojoEmpty=true;}function P(){var g=this.inputNode;if(g){this.readingDom=true;this.set("value",g.value);this.readingDom=false;}}function b(g){var h=this;if(g===-1){P.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete h._lastTimeoutId;P.call(h);},g||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,spellCheck:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown,mousedown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function X(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function Q(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var g=this.inputNode;g.disabled=!this.enabled;e.toggleClass(g,"disabled",!this.enabled);},onvalueChange:function S(){var g=this.value,h=(g===undefined)||(g===null)||(g==="");if(h){if(!this.hasFocus){d.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(G.isIE9){this.inputNode.type=h?"text":this.type;}},ontooltipChange:function W(){this.domNode.title=this.tooltip;},onreadOnlyChange:function I(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){e.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function a(){this._super();var g=this,h=this.inputNode;if(this.autoComplete=="new-password"){h.setAttribute("autocomplete","new-password");}else{h.setAttribute("autocomplete",this.autoComplete?"on":"off");}h.setAttribute("autocorrect",this.autoCorrect?"on":"off");h.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");h.setAttribute("spellcheck",this.spellCheck?"on":"off");if(this.enableAccessibility){h.setAttribute("tabindex","-1");h.onblur=Z.composite([h.onblur||mstrmojo.emptyFn,function(){g.loseFocus();}]);}},focus:function U(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(g){}}},grabFocus:function O(g){if(!this.enableAccessibility){return ;}var h=this.inputNode;if(g){h.focus();}h.onblur=mstrmojo.func.composite([h.onblur||mstrmojo.emptyFn,function(){e.removeClass(h,R.CSS_FOCUS_VISIBLE);}]);e.addClass(h,R.CSS_FOCUS_VISIBLE);},loseFocus:function F(h){if(!this.enableAccessibility){return ;}var g=this.inputNode;if(h){g.blur();}e.removeClass(g,R.CSS_FOCUS_VISIBLE);},prefocus:function N(){this.hasFocus=true;A.call(this);},blur:function Y(){this.inputNode.blur();},preblur:function c(){window.setTimeout(function(){},200);this.hasFocus=false;P.call(this);var g=this.value;if(((g===null||g==="")&&this.emptyText)||(this.keepEmpty&&g===this.emptyText)){d.call(this);}},prekeyup:function J(h){var g=h.hWin,i=h.e||g.event;b.call(this,this.valueChangeDelay);var j=f[i.keyCode];if(this["on"+j]){this["on"+j](h);}},preinput:function K(){b.call(this,this.valueChangeDelay);},prepaste:function L(){b.call(this);},precut:function H(){b.call(this);},setInvalidState:function C(g){this.set("textValid",false);if(g){this.domNode.setAttribute("title",g);}},cleanUp:function M(){this.inputNode.value="";this.set("textValid",true);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.string");var E=function(){var G=this.opener;if(G.direction.toLowerCase()==="up"){this.domNode.style.top=-G.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"",text:"",direction:"down",enabled:true,title:"",allowHTML:true,markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.getTextInnerHTML();},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function C(){if(this._super){this._super();}var G=this.popupRef;if(G){if(G.nudge){G.nudge=mstrmojo.func.composite([G.nudge,E]);}else{if(this.direction.toLowerCase()!=="down"){G.nudge=E;}}}},popupRef:null,popupOpenConfig:null,destroy:function D(G){var H=this.popupRef;if(H&&H.hasRendered){H.destroy(false);}if(this._super){this._super(G);}},togglePopup:function F(){var G=this._lastOpened;if(G&&G.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(G){this.togglePopup();},getTextInnerHTML:function B(){if(!this.allowHTML){this.text=mstrmojo.string.encodeHtmlString(this.text);}return this.text;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui._HasScroller");var D=mstrmojo.Widget;mstrmojo.ui.ScrollableContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ScrollableContainer {@cssClass}" style="{@cssText}"><div class="ScrollableContainer-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},accessibilityMenuContainer:function(){return this.children[0];},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onheightChange:D.heightMarkupMethod,onwidthChange:D.widthMarkupMethod},setupScrollNodes:function C(){this.scrollNode=this.containerNode;},onOpen:function B(){this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo._CanHandleTwoClicks","mstrmojo.Label","mstrmojo.Widget");var C=mstrmojo.css,A=mstrmojo.Label.prototype.markupMethods;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._CanHandleTwoClicks,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',markupMethods:mstrmojo.hash.copy({onwidthChange:function(){mstrmojo.Widget.widthMarkupMethod.call(this);},ontextChange:function(){if(A.ontextChange){A.ontextChange.call(this);}this.widgetResized();},onvisibleChange:function(){if(A.onvisibleChange){A.onvisibleChange.call(this);}if(this.visible){this.widgetResized();}}},mstrmojo.hash.copy(A)),onkeyup:function E(F){this._super(F);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var G=this;this._autoApplyTimer=window.setTimeout(function(){G.set("isEditing",false);},this.autoApplyDelay);}},postBuildRendering:function D(){if(this._super){this._super();}this.widgetResized();},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function B(){var G=this[this.editableSlot],F=!!this.selectable;G.selectable=F;G.setAttribute("unselectable",!F?"on":"off");C.toggleClass(G,"unselectable",!F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.css","mstrmojo.hash");var H=mstrmojo.css,D=mstrmojo.hash,B="glow";var F=mstrmojo.android.ui.Button=mstrmojo.declare(mstrmojo.Button,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Button",onclick:mstrmojo.emptyFn,touchBegin:function E(){if(this.enabled){H.addClass(this.domNode,B);}},touchTap:function C(J){if(this.enabled){this.onclick({e:J.evt});}},touchSelectBegin:mstrmojo.emptyFn,touchSelectEnd:function A(J){if(this.enabled){this.onclick({e:J.evt});}},touchEnd:function I(){H.removeClass(this.domNode,B);}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.newButton=function G(M,L,K){var J={scriptClass:"mstrmojo.android.ui.Button",text:M};if(L){J.onclick=L;}D.copy(K,J);return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.dom","mstrmojo.GridBase","mstrmojo.array");var b=mstrmojo.css,Q=mstrmojo.color,g=mstrmojo.css,F=mstrmojo.dom,J=F.isEdge;function D(i,j){var k=i&&i.parent;while(k&&k.scriptClass.indexOf("DocPanelStack")===-1){if(j in k){return k;}k=k.parent;}return null;}function C(j){var i=document.createElement("img");j.appendChild(i);j.removeChild(i);}function G(i,j){var l=Math.floor(i/j.rowsPerPage),n=i%j.rowsPerPage,m=j.tableNode.tBodies[l],k=m.rows[n].cells;return k;}function K(){var j=this._renderTimer;if(j){for(var i in j){self.clearInterval(j[i]);}delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function I(i){this._super(i);this.forceFixedSizes=true;},initPageSettings:function O(){var l=this.parent,j=l.gridData,k=this.defaultRowsPerPage,i=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*l.model.docModel.getZoomFactor();if(l&&l.numRowFixed){k=i;}else{if(l&&l.scrollboxHeightFixed){k=Math.ceil(l.scrollboxHeight/this.effectiveRh);k=Math.max(k,this.minRowsPerPage);if(i<k){k=this.minRowsPerPage;this._shouldRenderNextPage=true;}}}if(l.isOutlineMode){k=Math.min(200,i);}this.pageStatus=[];this.columnSecWidth=[];this.rowsPerPage=k;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;this.initColumnSec(this.columnSecWidth);},initColumnSec:function A(k){var l,m=this.cp.colWidths,j=m&&m.length||0,n=this.icr.dcw;this.totalColumnSecs=Math.ceil(j/this.icr.dcpp);for(l=0;l<j;l++){k[l]=(k[l]||0)+(parseInt(m[l].w,10)||n);}},initPageStatus:function e(m){var l=this.rowsPerPage,j,o,k,n=function(q,s,i){var p=this;return function(){if(p._onDemand===undefined){p._onDemand=!q.isDataAvailable(s,i);}return p._onDemand;};};this.totalPages=(l&&Math.ceil(this.cp.rc/l))||0;m=m||this.pageStatus;for(j=0;j<this.totalPages;++j){o=j*l;k=o+l-1;if(!m[j]){m[j]={};}delete m[j]._onDemand;m[j].isOnDemand=n.call(m[j],this.cp,o,k);}},buildRendering:function H(){var i=false;if(this.renderMode==="vscroll"){this.initPageSettings();var l=this.pageStatus[0];i=l&&l.isOnDemand();this.start=0;this.end=-1;if(!i){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!i);}this._super();if(this.renderMode==="vscroll"){var k=this.parent;this.gridContainerNode.style[g.MINHEIGHT]=(this.cp.rc*this.effectiveRh)+"px";if(!this.connectedScrollbox){if(k&&k.connectScrollbox){k.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!i);this.postRenderPages();var j=k&&!k.scrollboxHeightFixed&&!k.numRowFixed;if(j&&this.numPagesRendered>=this.totalPages&&!i){this.postRenderingCleanup();}else{if(i||j||this._shouldRenderNextPage||(k.isOutlineMode&&this.getPageHeight(this.pageNum)<this._defaultPageHeight)){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function U(){},postRenderPages:function f(){if(mstrApp&&mstrApp.isExpress){var j=this.parent.scrollboxNode,k=j.scrollTop,l=j.scrollLeft,i=(k>5)?k-5:0;this.parent.scrollTo({x:l,y:i});this.parent.scrollTo({x:l,y:k});}},configureActions:function P(){var i=this.parent;if(i&&i.configureActions){i.configureActions();}},preRenderPage:function R(i,j){this.pageNum=i;},postRenderPage:function M(j,l,m){if(j+1>this.numPagesRendered){this.numPagesRendered=j+1;}var i=this.pageStatus,k=i[j];if(!k){k=i[j]={};}if(l){k.filled=true;k.dirty=false;}var n=this.gridContainerNode.style;if(j===this.totalPages-1&&n){n[g.MINHEIGHT]="";}},invalidAllPages:function(){for(var j=0;j<this.totalPages;++j){var k=this.pageStatus[j];if(k.filled){k.dirty=true;}delete k._onDemand;k.filled=false;k.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function h(i){var j=this.id;K();this.renderingRows=true;this._renderTimer=this._renderTimer||{};this._renderTimer[Date.now()]=self.setInterval(function(){try{var m=mstrmojo.all[j];if(!m){return ;}var k=m.getPagesToRender(i);if(k.length>0){m.preRenderPages();m.renderPages(k);m.postRenderPages();m._postPagesClearup=true;}else{if(m._postPagesClearup){m.postRenderPagesCleanup();m.configureActions();m._postPagesClearup=false;}K.call(m);if(m.isRenderingComplete()){m.postRenderingCleanup();}}}catch(l){K.call(mstrmojo.all[j]);throw l;}},this.renderPause);},onscroll:function d(j,i){if(i&&i.deltaY===0&&this.icr.isIncremental&&!this.icr.sectionChanged){return ;}if(!this.renderingRows){if(j===true){var k=this.parent;if(k&&k.maskNode){b.addClass(k.maskNode,"wait");}}window.clearTimeout(this.scrollingTimeOut);this.scrollingTimeOut=window.setTimeout(function(){this._startPageRenderThread(i);this.icr.sectionChanged=false;}.bind(this),150);}},isRenderingComplete:function S(){if(this.end>=this.cp.rc-1){for(var j=this.pageStatus,k=this.totalPages-1;k>-1;k--){if(!j[k]||!j[k].filled){return false;}}return true;}return false;},renderPages:function E(l){var n=this.icr,t=n.isIncremental,o,s,z=2;if(t){var q=false;mstrmojo.array.forEach(l,function(i){if(i.idx===0){q=true;return false;}});if(!q){this.renderPage(0,true,true);}var m=false;s=l.length;for(o=0;o<s;++o){if(l[o].fill){m=true;}}var u=n.renderedPages||[],p=l[0].idx,y=this.tableNode,w=this.parent,j=w.lockHeadersCase&z;y.firstChild.innerHTML="<colgroup>"+this._getGridWidths().colgroup+"</colgroup>";if(j){w.resetColgroupNodes(y.firstChild);}if(m){var k=this.domNode.ownerDocument.createElement("table");for(o=1;o<y.tBodies.length;o++){if(o!==p&&o!==p+1&&(y.tBodies[o].childElementCount>1||y.tBodies[o].children[0].childElementCount>1)){k.innerHTML='<tbody n="'+o+'"><tr><td style="height:'+y.tBodies[o].getBoundingClientRect().height+'px">&nbsp;</td></tr></tbody>';if(j){w.onPageRendered(k.tBodies[0],o,true,true);}y.replaceChild(k.tBodies[0],y.tBodies[o]);}}}}n.renderedPages=[];var x=n.curSel.rows={};s=l.length;for(o=0;o<s;++o){this.renderPage(l[o].idx,l[o].fill,o!==s-1||t);x[l[o].idx]=true;}},renderPageInView:function W(){if(!this.renderingRows&&!this._renderTimer){this._startPageRenderThread();}},renderPage:function c(t,k,x){var z=this.pageStatus,n=(this.numPagesRendered>=t+1);if(n){if(!k||((z[t]&&z[t].filled)&&!this.icr.forceRender)){return ;}}var y=this.rowsPerPage,o=this.domNode,s=this.parent;this.start=t*y;this.end=Math.min(this.start+y,this.cp.rc)-1;this.preRenderPage(t,k);if(k&&s.isOutlineMode){s.hasEmptyTBody=true;}var j=this.tempTable;if(!j){j=this.tempTable=o.ownerDocument.createElement("div");}var w=this.tableNode,u=this.start,l=this.end,q=s.isViewOnly?'class="empty-block" ':"";tInnerHTML=k?this.buildTableRowsMarkup(u,l,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",w.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td '+q+'style="height:'+(s.isOutlineMode?this._defaultPageHeight:(this.effectiveRh*(this.end-this.start+1)))+'px">&nbsp;</td></tr></tbody></table>';if(k&&s.hasEmptyTBody){if(!s.outlineState.hasTBodyElementsToExpand){tInnerHTML='<table><tbody n="'+this.pageNum+'"><tr style="height:'+0+'px"></tr></tbody></table>';}else{s.outlineState.hasTBodyElementsToExpand=false;}}j.innerHTML=tInnerHTML;var m=j.firstChild.tBodies[0];if(!n){w.appendChild(m);if(s.isOutlineMode&&s.isAutoTableLayout()){if(s.clonedColHeader){s.clonedColHeader.getTableNode().appendChild(m.cloneNode(true));}if(s.clonedTitle&&s.clonedTitle.getTableNode()){s.clonedTitle.getTableNode().appendChild(m.cloneNode(true));}}}else{w.replaceChild(m,w.tBodies[t]);}if(m&&mstrApp&&mstrApp.isSingleTier){F.redirectUrlToFormWrapper(m);}if(k){this.markPages(u,l);}this.postRenderPage(t,k,m);var i=this.parent;if(i.onPageRendered){i.onPageRendered(m,t,n,k,x);}},getPagesToRender:function Y(AN){var l=[],AT=this.parent,AL=this._defaultPageHeight,AQ=null,AW=this.pageStatus,AD=this;if(!this.tableNode){return[];}function AI(i){var j=AW[i];if(j&&(j.filled||j.dirty)){if(!AQ){AQ=AD.tableNode.tBodies;}j.height=AQ[i].getBoundingClientRect().height;if(J){j.height-=11;}return j.height;}else{return AL;}}var AR=0,AB=null,x=null,Ab=AT.scrollboxTop;for(var AZ=0,AF=this.totalPages,AE=this.pageStatus;AZ<AF;AZ++){AR+=AI(AZ);if(AR>=Ab){AB=AZ>0?AZ-1:AZ;break;}}if(AB===null){AB=x=Math.max(AF-1,0);}else{var AG=AT.scrollboxBottom;if(isNaN(AG)&&AT.numRowFixed){AG=Ab;}for(var AY=AB+1;AY<AF;AY++){if(parseInt(AR,10)>AG){x=AY;break;}AR+=AI(AY);}}if(x===null){x=AF-1;}else{if(x<AF-1&&x<=AB){x=x+1;}}for(var AV=this.numPagesRendered;AV<AB;++AV){l.push({idx:AV,fill:false});}var u=0,k=this.rowsPerPage,z=false,AZ,q=false,AA=this.icr.isIncremental;if(AA){var s=this.parent.titlesCP,AS=s.getSpanDimension(),AO=AS.nCol,AP=this.cp.colWidths&&this.cp.colWidths.length;function w(m){if(AQ){var Ac=[],y=AQ[0].lastChild,p=AQ[0].firstChild,j;for(j=0;j<AO;j++){m[j]=p.children[j].offsetWidth;}for(j=0;j<y.childElementCount;j++){if(y.children[j].className.indexOf("gd-col-padding")>-1){Ac.push(j);}}var n=AC.getBeginIndex();if(Ac.length===2){var Ae=Ac[0]+1,Ad=Ac[1]-Ae;for(j=0;j<Ad;j++){m[n+j]=y.children[Ae+j].offsetWidth;}}else{if(Ac[0]<y.childElementCount-1){for(j=1;j<=AP-n;j++){m[AP-j]=y.children[y.childElementCount-j].offsetWidth;}}else{for(j=AO;j<Ac[0];j++){m[j]=y.children[j].offsetWidth;}}}}}var AC=this.icr,AH=AC.currColSec;w(this.columnSecWidth);var AM=function AM(){var p=AT.scrollNode,m=p.offsetWidth,j=p.scrollLeft,Ad=0,n=this.columnSecWidth,Ac,Ae=AP-1,Ag=0;if(j===AC.scrollLeft){return AC.currColSec;}if(F.isIE&&AP>10000){var Af=j/(p.scrollWidth-m);Ae=AP*Af;return Math.floor(Ae/AC.dcpp);}for(Ac=0;Ac<AP;Ac++){Ag+=n[Ac];}for(Ac=0;Ac<AP;Ac++){Ad+=n[Ac];if(Ad>=j){Ae=Ac;break;}}var Ah=Math.floor(Ae/AC.dcpp);if(Ah>0&&Math.abs(Ah-AC.currColSec)<=1&&AQ[0]){Ah=AC.currColSec;var y=AQ[0].firstChild.children[AO+1];if(F.position(y).x>0){Ae-=AC.dcpp;Ah--;}else{if(Ae<AP-1){y=AQ[0].firstChild.lastChild;if(mstrmojo.dom.position(y).x-F.position(p).x<m){Ae+=AC.dcpp;Ah++;}}}}AC.currColIdx=Ae;return Ah;};var AU=AM.call(this);AC.leftOffset=AT.scrollboxLeft-AT.scrollboxNode.offsetWidth;AC.forceRender=false;if(AH!==AU){q=true;AC.scrollLeft=AT.scrollboxLeft;if(!(AU===this.totalColumnSecs-1&&AH+1===AU)){AC.forceRender=true;}if(AU===Math.ceil(this.columnSecWidth/AC.dcpp)){AU=AU-1;}AC.currColSec=AU;}for(var AZ=AB;AZ<=x;++AZ){if(!AC.curSel.rows[AZ]&&AW[AZ]&&AW[AZ].filled){q=true;AC.forceRender=true;}}}for(var AX=AB;AX<=x;++AX){var Aa=AW[AX];if(!Aa||!Aa.filled){if(Aa&&Aa.isOnDemand()){z=true;if(!Aa.isDownloading&&!this.isDownloading){u+=k;Aa.isDownloading=true;this.isDownloading=true;var AJ=AX*k,t=AJ+k-1;this.cp.download(AJ,t,AN);}if(!AA||this.numPagesRendered<=AX){l.push({idx:AX,fill:false});}}else{l.push({idx:AX,fill:true});}}else{if(q){l.push({idx:AX,fill:true});}}}if(AT.isOutlineMode&&l.length===0){var o=AT.scrollboxNode.getBoundingClientRect().bottom;while(l.length===0&&x<this.totalPages-1){var AK=AQ[x].getBoundingClientRect().bottom;if(AK<o){x++;if(!AW[x].filled){l.push({idx:x,fill:true});}}else{break;}}}if(z){this.parent.showDownloadStatus(u);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return l;},addHilitePosition:function(j,l,i){var m=this.hiliteCellsMap[j];if(!m){this.hiliteCellsMap[j]={pos:[],nodes:[]};}var k=l-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[j].pos.push({row:k,cell:i,page:this.pageNum});},setHilites:function(m,n){var o=n.getAttribute("ei"),p=this.eiMap[o],j=this.getNodesByPositions(p);if(!j.length){this._super(m,n);return ;}for(var l=0,k=j.length;l<k;l++){this._super(m,j[l]);}},addExtraInfoMap:function(j,k,i){if(!this.eiMap[j]){this.eiMap[j]=[];}this.eiMap[j].push(this.getPosObj(k,i));},addPositionMap:function(j,k,i){if(!this.posMap[j]){this.posMap[j]=this.getPosObj(k,i);}},addTitleHeaderPositionMap:function(k,i,j){var l=this.getPosObj(k,i);l.obj=j;this.thPosMap.push(l);},getPosObj:function(j,l){var k=this.pageNum||0,i=this.rowsPerPage||0;return{row:j-k*i,cell:l,page:k};},getNodeByPosition:function(i){return this.tableNode.tBodies[i.page].rows[i.row].cells[i.cell];},getRowIdxByCell:function(i){var j=this.posMap[i._ei];return j.page*this.rowsPerPage+j.row;},getNodesByPositions:function(s){var n=[];for(var l in s){var u=s[l],k=(u&&u.page)||0,j=u&&u.row,o=u&&u.cell,m=this.tableNode.tBodies[k],q=m&&m.rows[j],t=q&&q.cells[o];if(t){n.push(t);}}return n;},getPageHeight:function X(i){var j=this.tableNode.tBodies;return(j&&j[i]&&j[i].offsetHeight)||0;},getTargetCell:function(q,p){var n=0,l=0,o;for(o=this.totalPages;l<o;l++){n+=this.getPageHeight(l);if(p<=n){break;}}var m=this.tableNode.tBodies[l];if(m){for(l=0,o=m.rows.length;l<o;l++){var u=m.rows[l];for(var k=0,t=u.cells.length;k<t;k++){var s=u.cells[k];if(s.offsetTop+s.offsetHeight>=p){if(q>=s.offsetLeft&&q<=s.offsetLeft+s.offsetWidth){return s;}}else{break;}}}}},postRenderPagesCleanup:function L(){var k=this.parent;if(k&&k.gridData&&k.gridData.afc){var j=this.tableNode;if(j&&(this.lastWidth!==j.offsetWidth)){if(k.onGridWidthChanged){k.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(l){delete l.height;});this.lastWidth=j.offsetWidth;}var i=D(k,"adjustAutoWidth");if(i){i.adjustAutoWidth(k);}}if(k.gridPagesRendered){k.gridPagesRendered();}if(F.isIE&&!F.isIE8){C(this.domNode);}if(k&&k.maskNode){b.removeClass(k.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function N(){var s=this.cp.getUpdatedRows(),n=this,q,j,p,t,l,m,o,k=[];if(s){mstrmojo.hash.forEach(s,function(u,i){o=parseInt(i,10);q=n.cp.getRowCells(o);j=G(o,n);p=j.length;t=q.length-1;if(t>=0){for(l=p-1;l>=0;l--){m=j[l];if(t<0){break;}if(q[l]._d){var x=m.style.backgroundColor,w=m.style.color;k.push({dom:m,bgcolor:x,ftcolor:w});m.style.backgroundColor=Q.getHighlightColor(Q.rgbStr2rgb(g.getStyleValue(m,"backgroundColor"),true));m.style.color=Q.getContrastingColor(Q.rgbStr2hex(g.getStyleValue(m,"backgroundColor")),"#ffffff","#000000");delete q[l]._d;}t--;}}});if(k.length>0){window.setTimeout(function(){mstrmojo.array.forEach(k,function(i){i.dom.style.backgroundColor=i.bgcolor;i.dom.style.color=i.ftcolor;});},300);}}},postRenderingCleanup:function B(){var i=this.parent;if(i&&this.connectedScrollbox){i.disconnectScrollbox(this);}this.connectedScrollbox=false;if(i&&!i.scrollboxHeightFixed){var j=D(i,"performCanGrowCanShrink");if(j){if(i.isOutlineMode){j.performCanGrowCanShrink([i],false);C(j.domNode);}else{j.performCanGrowCanShrink([i],true);}}}},getRowInfoByPosition:function(i){return this.cp.getRowCellInfo(i);},unrender:function a(i){K.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(i);},dataDownloaded:function Z(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.dom","mstrmojo.vi.util.A11yUtility","mstrmojo.css");var E=mstrmojo.css,K=mstrmojo.vi.util.A11yUtility,C=mstrmojo.dom;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",enableAccessibility:false,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){E.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,hasSpacing:false,cssItemMarkup:undefined,textItemMarkup:undefined,init:function J(M){this._super(M);var L=["mstrmojo-ui-ButtonBar"];if(this.hasSpacing){L.push("spacing");}if(!this.showIcon){L.push("btn-text");}E.addWidgetCssClass(this,L);},toggleFocusForSelectedItem:function B(M){var L=this._getItemNode(this.selectedIndex);if(!L){return ;}E.toggleClass(L,K.CSS_FOCUS_VISIBLE,M);if(M){L.focus();}else{L.blur();}},postBuildRendering:function A(){this._super();if(!this.enableAccessibility){return ;}this.domNode.tabindex=-1;this.focusOutFn=function(){this.toggleFocusForSelectedItem(false);}.bind(this);C.attachEvent(this.domNode,"focusout",this.focusOutFn);if(this.accessibilityHook){this.accessibilityHook();}},destroy:function H(){this._super();if(this.focusOutFn){C.detachEvent(this.domNode,"focusout",this.focusOutFn);}},grabFocus:function(){if(!this.enableAccessibility){return ;}this.toggleFocusForSelectedItem(true);},loseFocus:function(){if(!this.enableAccessibility){return ;}this.toggleFocusForSelectedItem(false);},onkeydown:function D(M){var O=M.e||M,N=O.key;if(!this.enableAccessibility){M.preventDefault();O.stopPropagation();return ;}if(N==="Tab"||N==="Escape"){return ;}M.preventDefault();O.stopPropagation();var L;if(N==="ArrowLeft"){this.toggleFocusForSelectedItem(false);if(this.selectedIndex<=0){L=this.items.length-1;}else{L=this.selectedIndex-1;}this.set("selectedIndex",L);this.toggleFocusForSelectedItem(true);}else{if(N=="ArrowRight"){this.toggleFocusForSelectedItem(false);if(this.selectedIndex>=this.items.length-1){L=0;}else{L=this.selectedIndex+1;}this.set("selectedIndex",L);this.toggleFocusForSelectedItem(true);}}},getItemMarkup:function I(L){if(!this.textItemMarkup){this.textItemMarkup=this._super(L);if(this.enableAccessibility){this.textItemMarkup=this.textItemMarkup.replace("title=",'tabindex="-1" title=');}}if(!this.cssItemMarkup){this.cssItemMarkup=this.textItemMarkup.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon&&!L.tx?this.cssItemMarkup:this.textItemMarkup;},getItemProps:function F(N,L){var M=this._super(N,L);var O=N.css;if(O){M.addCls(O);}M.n=N.n||"";return M;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(G,F){if(!A){var I=this.itemField,H=(this.allowHTML?"":"@en");A=this._super(G).replace(H+'@title}">{'+H+"@n}<",H+"@"+I+'}">{'+H+"@"+I+"}<");}return A;},getItemProps:function C(H,F){var G=this._super(H,F),I=this.itemField;if(!mstrmojo.string.isEmpty(H[I])){G[I]=H[I];}return G;},onclick:function B(F){if(this.disableClick){return false;}var K=this,H=this.parent,J=H.opener,G=D.isMetaKey(F.hWin,F.e);if(G&&!this.multiSelect){this.multiSelect=J.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var M=K.selectedIndices;if(J){J.suggestionShown=false;if(M&&!E.isEmpty(M)){var L=[];E.forEach(K.selectedIndices,function(O,N){L.push(K.items[N]);});J.handleSuggestionItemSelect(L);}H.close();}K.multiSelect=false;});}}this._super(F);if(!this.multiSelect){J.suggestionShown=false;var I=this.selectedItem;if(I){J.handleSuggestionItemSelect(I);}H.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(C){if(C&&C.className){C.className+=" selected";}},unselect:function(C){if(C&&C.className){C.className=C.className.replace(/selected/g,"");}},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(K){var G=K.hWin,H=K.e,F=this._findMatch(G,H);if(F){var J=parseInt(F.value,10),I=mstrmojo.dom,C=I.isMetaKey(G,H),D=I.shiftKey(G,H);if(C||D){I.clearBrowserHighlights(G);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var E=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(J);if(E&&J<this.items.length&&this.selectedIndices[J+1]){J++;}this.selectedIndex=J;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(J);}else{this.singleSelect(J);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var H=this.itemsNode,G=this.renderAllItems,F=H&&H.tBodies,E=G?0:Math.floor(C/100),D=G?C:C%100,I=F&&F[E]&&F[E].rows&&F[E].rows[D];return I&&I.cells[0].firstChild;}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.ErrorDialogContent","mstrmojo.css","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(14058,14059,20218);var D=mstrmojo.css,E=mstrmojo.DI.DIConstants,A=mstrmojo.desc(20218,"Please set the {OAuth Parameters} and try again.").replace("{",'<span class="dyn-link">').replace("}","</span>"),F=mstrmojo.desc(14058,"Show Details"),B=mstrmojo.desc(14059,"Hide Details");mstrmojo.ui.editors.OAuthErrorDialogContent=mstrmojo.declare(mstrmojo.ui.editors.ErrorDialogContent,null,{scriptClass:"mstrmojo.ui.editors.OAuthErrorDialogContent",markupString:'<div class="mstrmojo-error-content {@cssClass}" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div class="contact">'+A+'</div><div class="toggle-details-link" >'+F+'</div><div class="error-details">{@longDesc}</div></div></div>',markupMethods:{onshowDetailsChange:function(){var G=this.showDetails;this.toggleDetailsNode.innerHTML=G?B:F;D.toggleClass(this.domNode,"show-details",G);this.updateScrollbars();}},source:{},onclick:function C(G){var H=G.getTarget();if(H===this.contactNode&&this.source){mstrApp.getRootController().showDialog(E.dialogType.setOAuthParaDialog,{sourceName:this.source.name,did:this.source.dbRoleID,isOneTier:!!mstrApp.isSingleTier,sourceItem:{sourceInfo:this.source}});this.parent.close();}else{if(H===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);this.parent.raiseEvent({name:"EditorResized"});this.parent.positionDialog();}}},});})();(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.date");var A=mstrmojo.date;mstrmojo.DateStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.DateStepperContentProvider",curVal:null,init:function(F){this._super(F);var G=this.item,E=G[this.intField],I=G[this.valField],H=this.minField,D=this.maxField,C=G[H],B=G[D];this.min=C&&A.getDateFromDateInfo(C);this.max=B&&A.getDateFromDateInfo(B);this.curVal=I?A.getDateFromDateInfo(I):(this.min?new Date(this.min):new Date());this.createChildProviders();},createChildProviders:function(){var B=this;mstrmojo.array.forEach(["year","month","day"],function(C){B[C+"CP"]=new mstrmojo.NumStepperContentProvider({item:{interval:1},canLoop:true,updateConfig:function(E,D,F){this.curVal=E;this.max=D;this.min=F;},onTraverse:function(){B.traverse(C,this.curVal);}});});this.updateChildProviders();},updateChildProviders:function(){var I=this.max,D=this.min,G=this.curVal.getFullYear(),F=this.curVal.getMonth(),H=this.curVal.getDate(),C=I&&(G===I.getFullYear()),E=D&&(G===D.getFullYear()),J=C&&(F===I.getMonth()),B=E&&(F===D.getMonth());this.yearCP.updateConfig(G,I?I.getFullYear():null,D?D.getFullYear():null);this.monthCP.updateConfig(F+1,C?I.getMonth()+1:12,E?D.getMonth()+1:1);this.dayCP.updateConfig(H,J?I.getDate():mstrmojo.date.getDaysOfMonth(G,F+1),B?D.getDate():1);},traverse:function(E,D){var C=this.curVal,G=(E==="year")?D:this.curVal.getFullYear(),B=(E==="month")?D:this.curVal.getMonth()+1,F=(E==="day")?D:this.curVal.getDate();F=Math.min(mstrmojo.date.getDaysOfMonth(G,B),F);C.setFullYear(G,B-1,F);if(this.max){C=Math.min(this.max,C);}if(this.min){C=Math.max(this.min,C);}this.curVal=new Date(C);this.updateChildProviders();if(this.onTraverse){this.onTraverse();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.WorkstationPluginProxy");mstrmojo.ME.WorkstationPluginTransport={serverRequest:function A(F,E,C){if(!workstation){return ;}function D(H,G){mstrApp.hideWait&&mstrApp.hideWait(true);mstrmojo.all[F]["response"](E,!!H,G);}mstrApp.workstationDataFetchTaskProc&&mstrApp.workstationDataFetchTaskProc(C.params).then(function(G){window.setTimeout(function(){D(true,G);},0);},function(G){window.setTimeout(function(){var H={code:G.iServerErrorCode,messagge:G.errorMessage};D(false,H);},0);});},cancelRequest:function B(C){return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.mstr.EnumFunction","mstrmojo.ME.WorkstationPluginProxy","mstrmojo.ME.WorkstationPluginTransport");var n=mstrmojo.array,i=mstrmojo.mstr.EnumFunction;var O={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},R={"8107C326DD9911D3B98100C04F2233EA":"Rank"},z={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},AA={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},s={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},Z={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"},H={"8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31CDD9911D3B98100C04F2233EA":"Count",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C32DDD9911D3B98100C04F2233EA":"Median","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode","8107C32CDD9911D3B98100C04F2233EA":"Product","8107C32FDD9911D3B98100C04F2233EA":"Stdev","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31BDD9911D3B98100C04F2233EA":"Sum","8107C330DD9911D3B98100C04F2233EA":"Var",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",A202C23DDD9D11D3B98100C04F2233EA:"Fvschedule",A202C23CDD9D11D3B98100C04F2233EA:"IRR",A202C240DD9D11D3B98100C04F2233EA:"MIRR",A202C23EDD9D11D3B98100C04F2233EA:"NPV","8107C34ADD9911D3B98100C04F2233EA":"Percentile","9C374203DD9F11D3B98100C04F2233EA":"AvgDev","9C374228DD9F11D3B98100C04F2233EA":"ChiSquareTest","9C374225DD9F11D3B98100C04F2233EA":"Correlation","9C374224DD9F11D3B98100C04F2233EA":"Covariance","9C374237DD9F11D3B98100C04F2233EA":"ForecastV","9C37422FDD9F11D3B98100C04F2233EA":"FTest","9C374234DD9F11D3B98100C04F2233EA":"GrowthV","9C37422EDD9F11D3B98100C04F2233EA":"HeteroscedasticTTest","9C37422DDD9F11D3B98100C04F2233EA":"HomoscedasticTTest","9C37422ADD9F11D3B98100C04F2233EA":"Intercept","9C374204DD9F11D3B98100C04F2233EA":"Kurtosis","9C374222DD9F11D3B98100C04F2233EA":"MeanTTest","9C37422CDD9F11D3B98100C04F2233EA":"PairedTTest","9C374226DD9F11D3B98100C04F2233EA":"Pearson","9C374227DD9F11D3B98100C04F2233EA":"RSquare","9C374205DD9F11D3B98100C04F2233EA":"Skew","9C374229DD9F11D3B98100C04F2233EA":"Slope","9C37422BDD9F11D3B98100C04F2233EA":"SteYX","9C374231DD9F11D3B98100C04F2233EA":"TrendV","9C374223DD9F11D3B98100C04F2233EA":"VarTest","4A99DC7BC5254A319F6B8098E7D652C1":"ConcatAgg"},b={AND283:"And",OR284:"Or",NOT285:"Not",IF305:"If"},p={BEGINSWITH279:"Begins with",ENDSWITH279:"Ends with",IN289:"In",BETWEEN290:"Between",CONTAINS291:"Contains",LIKE291:"Like"};function Q(AF){var AD=function(AH,AG){return mstrmojo.array.stringSorter(AH.n,AG.n);},AE,AC;AF=AF.sort(AD);for(AE=0,AC=AF.length;AE<AC;AE++){AF[AE].fns=AF[AE].fns.sort(AD);}return AF;}function a(AF,AG){var AC=AF.length,AE;for(AE=0;AE<AC;AE++){var AD=AF[AE].fns;if(mstrmojo.array.find(AD,"did",AG)>-1){return AE;}}return -1;}function M(AD){var AC=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();AD=mstrmojo.hash.copy(AD,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(AC){AD.quickSearch=AC;AD.nameWildcards=16;AD.sortKey=-1;}return AD;}function I(AD,AC){if(mstrApp.serverRequest){mstrApp.serverRequest(AC,AD);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(AD,AC,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function F(){if(!this.serverProxy){if(mstrApp.isWorkstationPlugin){this.serverProxy=new mstrmojo.ME.WorkstationPluginProxy({transport:mstrmojo.ME.WorkstationPluginTransport});}else{this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}}return this.serverProxy;},getMetricDefintion:function U(AE,AC){var AD={taskId:"getMetricDefinition",metricId:AE.id,outputFlags:65599};if(AE.msgID){AD.msgID=AE.msgID;}I.call(this,AC,AD);},validateMetric:function g(AE,AC){var AD={taskId:"validateMetric",metricId:AE.metricId,tokenStreamXML:AE.tokenStreamXML,metricXML:AE.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(AE.metricId)){AD.isNew=true;}if(AE.msgID){AD.msgID=AE.msgID;}if(AE.formID){AD.frmid=AE.formID;}if(AE.isIDForm){AD.isIDForm=AE.isIDForm;}if(AE.objectType){AD.objectType=AE.objectType;}I.call(this,AC,AD);},getMetricComponents:function B(AG,AD){var AC=this,AE=this.metricComponents;if(!this.noCache&&AE&&AE.items.length==AE.sz){AD.success(AE);return ;}AD.success=mstrmojo.func.composite([AD.success,function(AH){if(AC.metricComponents&&AC.metricComponents.items){AC.metricComponents.items.push(AH.items);}else{AC.metricComponents=AH;}}]);var AF=M({blockBegin:AG.blockBegin,blockCount:AG.blockCount,searchPattern:AG.pattern,rootFolderType:AG.rootFolderType||24,objectType:AG.objectType||"12,13,43"});I.call(this,AD,AF);},getAttributes:function S(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||26,objectType:12});I.call(this,AC,AD);},getFacts:function L(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||29,objectType:13});I.call(this,AC,AD);},getMetrics:function G(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||5,objectType:4});if(AE.isVerify){AD.nameWildcards=2;}I.call(this,AC,AD);},getFunctions:function W(AH){var AJ=this,AK=window.sessionStorage,AG=this.functions||(AK&&AK.getItem("functions")),AI=AK&&AK.getItem("mstrLocaleId"),AE=mstrApp&&mstrApp.localeId;if(AG&&AI==AE){AG=Q(JSON.parse(AG).fncs);AH.success(AG);}else{var AD={failure:AH.failure,textResponse:true},AF={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};var AC=function(AL){n.forEach(AL,function(AN){var AM=AN&&AN.fns;n.forEach(AM,function(AP){var AO=AP.pros;var AQ=n.filterOne(AO,function(AR){return AR.n==="UseLookupForAttributes";});if(AQ){AQ.dfv="0";}});});};AD.success=function(AL){if(typeof AL==="string"||(!mstrApp.isSingleTier&&(!mstrApp.isWorkstationPlugin||typeof mstrApp.isSingleTier!=="undefined"))){AL=AL.replace(/\\'/g,"'");var AN=JSON.parse(AL),AM=AN.fncs;AC(AM);AL=JSON.stringify(AN);if(AK){AK.setItem("functions",AL);AK.setItem("mstrLocaleId",AE);}AJ.functions=AL;AG=Q(JSON.parse(AL).fncs);}else{AC(AL.fncs);AG=Q(AL.fncs);AJ.functions=JSON.stringify(AL);}AH.success(AG);};I.call(this,AD,AF);}},getAggFunctions:function C(){if(this._aggFunctions){return this._aggFunctions;}var AC=this.parseFuncStr();AC=mstrmojo.array.filter(AC[this.getBasicCategoryIndex(AC)].fns,function(AE){var AD=AE.did,AF;if(AD!=="B2C0FA4020C711D6AD1400C04F0423DE"&&AD!=="B2C0FA4120C711D6AD1400C04F0423DE"){AF=O[AD];}return AF;});return AC;},getOLAPAggFunctions:function E(AC){var AD=this.parseFuncStr();AD=mstrmojo.array.filter(AD[this.getOLAPCategoryIndex(AD)].fns,function(AE){switch(AC){case"moving":return AA[AE.did];case"running":return s[AE.did];case"olap":default:return z[AE.did];}return false;});return AD;},getFunctionCatList:function u(){if(this._functionCatList){return this._functionCatList;}var AC=this.parseFuncStr();AC=mstrmojo.hash.make(AC,mstrmojo.Arr);this._functionCatList=AC;return AC;},getCategoryIndex:function t(AD,AC){return a(AC||this.getFunctionCatList(),AD);},getBasicCategoryIndex:function J(AD){var AC="B2C0FA4020C711D6AD1400C04F0423DE";return a(AD||this.getFunctionCatList(),AC);},getDataMiningCatIndex:function l(AC){var AD="F17CD4F3FF134D91B80DDAB9CA73C919";return a(AC||this.getFunctionCatList(),AD);},getDateTimeCategoryIndex:function y(AD){var AC="C50F2A4F75AE49D6B20E00224967B500";return a(AD||this.getFunctionCatList(),AC);},getStringCategoryIndex:function j(AD){var AC="6F7DF5FF449111D5BEA300B0D01A55EF";return a(AD||this.getFunctionCatList(),AC);},getOLAPCategoryIndex:function J(AD){var AC="D221F90EB35540E3A1204ED6CC9A8267";return a(AD||this.getFunctionCatList(),AC);},getInternalCategoryIndex:function X(AD){var AC="8107C337DD9911D3B98100C04F2233EA";return a(AD||this.getFunctionCatList(),AC);},getFunctionDetails:function w(AE,AC){var AD={taskId:"getSystemFunctions",functionId:AE.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};I.call(this,AC,AD);},getTransformations:function P(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||38,objectType:43});I.call(this,AC,AD);},getFilters:function m(AE,AC){var AD=M({blockBegin:AE.blockBegin,blockCount:AE.blockCount,searchPattern:AE.pattern,rootFolderType:AE.rootFolderType||4,objectType:1});I.call(this,AC,AD);},getAttributeForms:function h(AE,AC){var AD={taskId:"getAttributeForms",attributeID:AE.attributeID,displayedForms:AE.displayedForms,styleName:"WidgetElementListStyle"};I.call(this,AC,AD);},getSubtotalFunctions:function Y(AE,AC){var AD=M({objectType:"1025,1026",searchPattern:""});I.call(this,AC,AD);},isBasicAggMap:function o(AC){var AD=!!O[AC];if(AC==="B2C0FA4020C711D6AD1400C04F0423DE"||AC==="B2C0FA4120C711D6AD1400C04F0423DE"){AD=false;}return AD;},isOLAPAgg:function AB(AC){return !!z[AC];},isMovingAgg:function c(AC){return !!AA[AC];},isRunningAgg:function f(AC){return !!s[AC];},isBanding:function k(AC){return !!Z[AC];},isOLAP:function K(AD){var AE=this.getFunctionCatList(),AC=AE[this.getOLAPCategoryIndex(AE)].fns;return mstrmojo.array.find(AC,"did",AD)>-1;},isRank:function D(AC){return !!R[AC];},isScalar:function e(AC){return(AC||{}).sqt===3;},hasLookupForAttributesProps:function(AC){return !!H[AC];},getFunctionHelpTopic:function q(AC){var AD="<div class='func-details' mstrevent='click' onclick='mstrmojo.ME.MetricDataService.showFunctionHelpTopic(\"##HELPTOPIC##\")'>"+mstrmojo.desc(5811,"Details...")+"</div>";if(mstrApp.isWorkstationPlugin){AD="<div class='func-details'><a href="+mstrmojo.ME.MetricDataService.getFunctionHelpTopicUrl("##HELPTOPIC##")+" target='_blank'>"+mstrmojo.desc(5811,"Details...")+"</a></div>";}AD=AD.replace("##HELPTOPIC##",AC);return AD;},showFunctionHelpTopic:function x(AD){var AE=mstrApp.isSingleTier,AC=((mstrApp.helpUrl||"../help/")+"FunctionsRef/");if(AE){AC=AC+"index.htm#cshid="+(AD||"");window.FormWrapper.openPage(AC);}else{if(AD){AC=AC+"Content/"+AD+".htm";}else{AC=AC+"index.htm";}window.open(AC);}return false;},getFunctionHelpTopicUrl:function N(AD){var AC=((mstrApp.helpUrl||"../help/")+"FunctionsRef/");if(AD){AC=AC+"Content/"+AD+".htm";}else{AC=AC+"index.htm";}return AC;},sortFunctions:function A(AD){var AE={},AC=function(AG,AF){return mstrmojo.array.stringSorter(AG.n,AF.n);};mstrmojo.array.forEach(AD,function(AF){mstrmojo.array.forEach(AF&&AF.fns,function(AG){if(AG&&AG.did){AE[AG.did]=AG;}});});return mstrmojo.hash.valarray(AE).sort(AC);},parseFuncStr:function d(){var AC=window.sessionStorage,AD=this.functions||AC&&AC.getItem("functions");if(AD){return Q(JSON.parse(AD).fncs);}},isValEqual:function(AF,AE){if(AF===AE){return true;}var AC=[-1,"-1","True",true],AD=[0,"0","False",false];if(AC.indexOf(AF)>-1&&AC.indexOf(AE)>-1){return true;}else{if(AD.indexOf(AF)>-1&&AD.indexOf(AE)>-1){return true;}}return false;},isFuncHasUseLookupForAttributeProp:function(AD){var AC=[i.FunctionSum,i.FunctionCount,i.FunctionAvg,i.FunctionMin,i.FunctionMax,i.FunctionProduct,i.FunctionMedian,i.FunctionMode,i.FunctionStdev,i.FunctionVar,i.FunctionGeomean,i.FunctionPercentile,i.FunctionStdevP,i.FunctionVarP,i.FunctionFirst,i.FunctionLast,i.ConcatAgg];return AC.indexOf(AD)>-1;},isLogicOrCompFunc:function(AD){var AC=AD.v.toUpperCase()+AD.tp;return !!b[AC]||!!p[AC];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.array","mstrmojo.date","mstrmojo.Stepper","mstrmojo.android.ui.Button","mstrmojo.DateStepperContentProvider","mstrmojo.NumStepperContentProvider");var W=mstrmojo.array,Q=mstrmojo.date,L=mstrmojo.hash,R=mstrmojo.android.ui.Button.newButton,I=mstrmojo.expr.DTP,D={interval:1},G={min:1,max:12,interval:1,value:12},N={min:0,max:23,interval:1,value:0},E={min:0,max:59,interval:1};function C(){var Y=this.dtp,b=this.stepperClass,Z=this[this.valueField],M=[],a,H;if(this._hasDate){M.push({scriptClass:b,slot:"monthNode",alias:"monthStepper",title:mstrmojo.desc(871,"month"),provider:this.dateProvider.monthCP},{scriptClass:b,slot:"dayNode",alias:"dayStepper",title:mstrmojo.desc(872,"day"),provider:this.dateProvider.dayCP},{scriptClass:b,slot:"yearNode",alias:"yearStepper",title:mstrmojo.desc(873,"year"),provider:this.dateProvider.yearCP});}if(this._hasTime){M.push({scriptClass:b,slot:"hourNode",alias:"hourStepper",provider:this.hourProvider},{scriptClass:b,slot:"minNode",alias:"minStepper",provider:this.minProvider});}if(!this.hideSwitchers){if(Y!==I.TIME){a=(Z&&Z.date)?Q.formatDateInfo(Z.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT):mstrmojo.desc(2052,"Date");M.push(R(a,function(){this.parent.toDateView();},{alias:"dateToggle",slot:"switcherNode",cssClass:"",selected:true}));}if(Y!==I.DATE){H=(Z&&Z.time)?Q.formatTimeInfo(Z.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT):mstrmojo.desc(2170,"Time");M.push(R(H,function(){this.parent.toTimeView();},{alias:"timeToggle",slot:"switcherNode",cssClass:"",selected:Y==I.TIME}));}}if(this._hasDate){this.viewCssClass="dateView";}else{if(this._hasTime){this.viewCssClass="timeView";}}this.addChildren(M);}function P(){var c=[this.valueField,"min","max"],M=L.copy(D),b=this.is24HourMode?L.copy(N):L.copy(G),a=L.copy(E),Z=this[this.valueField],H=Z&&Z.time,Y=this;W.forEach(c,function(d){M[d]=L.copy(Y[d]);});if(this._hasDate){this.dateProvider=new mstrmojo.DateStepperContentProvider({item:M,valField:this.valueField,canLoop:true,onTraverse:function(){Y.updateDate();}});}if(this._hasTime){if(this.minuteInterval!==undefined){a.interval=this.minuteInterval;}delete this.minuteInterval;if(H){if(!this.is24HourMode){b.value=H.hour%12||12;this.set("meridiem",(H.hour<12));}else{b.value=H.hour;}a.value=H.min;}this.hourProvider=new mstrmojo.NumStepperContentProvider({item:b,valField:"value",canLoop:true,onTraverse:function(){Y.updateTime();}});this.minProvider=new mstrmojo.NumStepperContentProvider({item:a,valField:"value",canLoop:true,renderer:{render:function(d){return String(d).length===1?("0"+d):d;}},onTraverse:function(){Y.updateTime();}});}}mstrmojo.DateTimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DateTimePicker",value:null,min:null,max:null,meridiem:true,hideSwitchers:false,minuteInterval:null,is24HourMode:false,dtp:mstrmojo.expr.DTP.TIMESTAMP,viewCssClass:"",valueField:"value",stepperClass:"mstrmojo.Stepper",markupString:"<div id='{@id}' class='mstrmojo-DateTimePicker' style='{@cssText}'><div class='switcher'></div><div class='{@viewCssClass}'><span class='stepNode month'></span><span class='stepNode day'></span><span class='stepNode year'></span><span class='stepNode hour'></span><span class='stepNode min'></span><span class='meridiem' mstrAttach:click></div></div></div>",markupSlots:{switcherNode:function(){return this.domNode.firstChild;},viewNode:function(){return this.domNode.children[1];},monthNode:function(){return this.domNode.children[1].children[0];},dayNode:function(){return this.domNode.children[1].children[1];},yearNode:function(){return this.domNode.children[1].children[2];},hourNode:function(){return this.domNode.children[1].children[3];},minNode:function(){return this.domNode.children[1].children[4];},meridiemNode:function(){return this.domNode.children[1].children[5];}},markupMethods:{onmeridiemChange:function(){if(this.is24HourMode){this.meridiemNode.display="none";}else{this.meridiemNode.innerHTML=this.meridiem?mstrmojo.locales.datetime.AM_NAME:mstrmojo.locales.datetime.PM_NAME;}},onviewCssClassChange:function(){this.viewNode.className=this.viewCssClass;}},init:function O(M){this._super(M);var H=this.dtp;this._hasDate=(H===I.DATE||H===I.TIMESTAMP);this._hasTime=(H===I.TIME||H===I.TIMESTAMP);P.call(this);C.call(this);},getDateTime:function B(){return{date:this.getDate(),time:this.getTime()};},getDate:function F(){if(this._hasDate){var H=this.dateProvider.curVal;return{year:H.getFullYear(),month:H.getMonth()+1,day:H.getDate()};}return null;},getTime:function S(){if(this._hasTime){return{hour:!this.is24HourMode?Q.capitalHour(this.hourProvider.curVal,this.meridiem?" AM":" PM"):this.hourProvider.curVal,min:this.minProvider.curVal};}return null;},getDateTimeString:function K(){var H="";if(this._hasDate){H+=Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT);}if(this._hasDate&&this._hasTime){H+=" ";}if(this._hasTime){H+=Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return H;},updateDate:function A(){if(this.hasRendered){var H=this;W.forEach(["year","month","day"],function(M){H[M+"Stepper"].updateDisplayText();});}if(this.dateToggle){this.dateToggle.set("text",Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}},updateTime:function J(){if(this.timeToggle){this.timeToggle.set("text",Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}},toDateView:function U(){this.set("viewCssClass","dateView");this.dateToggle.set("selected",true);var H=this.timeToggle;if(H){H.set("selected",false);}},toTimeView:function X(){this.set("viewCssClass","timeView");var H=this.dateToggle;if(H){H.set("selected",false);}this.timeToggle.set("selected",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],b=this._pageHeight,d=null,Y=this._pageStatus,a=this;function R(e){var f=Y[e];if(f&&f.filled){if(!f.height){if(!d){d=a.itemsNode.tBodies;}f.height=d[e].offsetHeight;}return f.height;}else{return b;}}var c=0,S=null,O=null,M=this.scrollboxTop;for(var X=0,Z=this._totalPages;X<Z;X++){c+=R(X);if(c>=M){S=X;break;}}if(S==null){S=O=Z-1;}else{var L=this.scrollboxBottom;for(var U=S+1;U<Z;U++){if(c>=L){O=U-1;break;}c+=R(U);}}if(O==null){O=Z-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var W=Y[Q];if(!W||!W.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var X=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(X[R]&&X[R].filled)){return ;}}var W=this._rowsPerPage,L=R*W,N=Math.min(L+W,this._rc)-1;var U=this.tempTableCont;if(!U){U=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';U.innerHTML=Q;var O=U.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate","mstrmojo.MetricSelectorUtility");var D=mstrmojo.MetricSelectorUtility,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,N=D.OP,F=[{n:mstrmojo.desc(2795,"Equals"),v:N._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:N._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:N._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:N._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:N._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:N._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:N._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:N._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:N._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:N._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:N._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:N._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var C=function(b,S,U,X,W){var Y;if(W===2){return S;}var c=String(b).split(";"),Z=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(X&&c&&c.length>1){S.code=Z;}else{for(Y=0;Y<c.length;Y++){var a=parseFloat(c[Y],10);if(isNaN(a)||(U&&((c[Y].match(/^\d+(\.\d+)?%$/)===null&&c[Y].match(/^\d+(\.\d+)?$/)==null)||a<0||a>100))||(!U&&c[Y].match(/\d+$/)===null)){S.code=Z;}if(S.code!==R){break;}}}if(S.code!==R){S.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return S;};var M=function(R){R=parseFloat(R);return isNaN(R)?"54px":((R*72/16)+"pt;");},Q=function(U){if(U.hasRendered){var S=U.domNode.style;S.font=U.font;S.width=M(S.fontSize);}else{var R=U.font.match(/[^\s]*?pt/)||[];U.cssText=U.cssText+" font:"+U.font+"; width:"+M(R[0]);}},I=function(R){if((R>=8&&R<=16)||(R>=23&&R<=25)){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function P(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(R){if(this._super){this._super(R);}this._init();},_init:function(U){var S;switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(U){this.cs=[];this.f=this.ft=null;}var X=D.getOpIdxByfunc(this.f,this.ft),W=I(this.dt)?N._GREATER_EQUAL:N._IS_NULL;this.set("opId",(X==-1)?W:X);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId===N._IN||this.opId===N._NOT_IN){for(S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function B(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this._init();},onquaChange:function O(R){this._init(true);this.func.items=(this.qua!==0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!==0)?L:I(this.parent.dt)?F:H;},onchange:function(){var S=this.parent,U=this.selectedItem;if(U&&U.v!==null&&U.v!==undefined){var R=D.getIncludeByOp(U.v);S.include=R;if(S.parent&&R!==S.parent.include){S.changeInclude=true;}else{S.changeInclude=false;}S.set("opId",U.v);}if(mstrApp.isMobile&&(U.v===N._IS_NULL||U.v===N._IS_NOT_NULL)){if(S.onchange){S.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){var S=this.parent,R=this.domNode;S.set("cs1",this.value);if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(S){var R=S.hWin,X=S.e||R.event,W=this.parent,U=S.src.domNode;if(X.keyCode===13&&W.apply&&W.apply.enabled){W.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},U=this.parent;C(R,S,(U.qua===3||U.qua===4),(U.opId!==8&&U.opId!==9),(U.numFmts&&U.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){this.parent.set("cs2",this.value);var R=this.domNode;if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(S){var R=S.hWin,W=S.e||R.event,U=this.parent;if(W.keyCode===13&&U.apply&&U.apply.enabled){U.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var U=this.parent,Y=(U.qua===D.Q._PT||U.qua===D.Q._PB),R;U.cs=[];var W=function(Z){return Z+((Y&&!String(Z).match(/^\d+%$/))?"%":"");};var S=function(Z,a){return((Z===2||Z===3)&&a===0)?14:5;};if(U.opId===N._IN||U.opId===N._NOT_IN){var X=String(U.cs1).split(";");for(R=0;R<X.length;R++){if(!mstrmojo.string.isEmpty(X[R])){U.cs.push({dtp:5,v:W(X[R])});}}}else{if(U.vldTbL.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:W(U.cs1)});}if(U.vldTbH.visible){U.cs.push({dtp:S((U.numFmts&&U.numFmts.cat),U.qua),v:W(U.cs2)});}}if(U.onchange){U.onchange();}if(U.makeSelection){U.makeSelection();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.dom","mstrmojo.vi.util.A11yUtility","mstrmojo._IsAccessibleList","mstrmojo.string","mstrmojo.css");var R=mstrmojo.css,P=mstrmojo.vi.util.A11yUtility,O=mstrmojo.Enum_Keys,A=mstrmojo.string;var U;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller,mstrmojo._IsAccessibleList],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" aria-label="{@en@ariaLabel}" tabindex="-1" mstrAttach:click,contextmenu,keydown><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function K(){return this.domNode.firstChild;},itemsContainerNode:function S(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function E(){R.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function J(){R.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function B(){R.toggleClass(this.domNode,"disabled",!this.enabled);},onhideCheckMarkChange:function H(){R.toggleClass(this.domNode,"hideCheckMark",this.hideCheckMark);},onariaLabelChange:function(){this.domNode.setAttribute("aria-label",A.encodeHtmlString(this.ariaLabel,true));}},multiSelect:true,hideCheckMark:false,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,listRole:"application",itemRole:"checkbox",itemSelectedAriaProp:"aria-checked",getItemMarkup:function F(Y){if(!U){U=this._super(Y).replace(">{@en@n}<",'title="{@tt}"><span class="text">{@en@n}</span><');}return U;},getItemProps:function W(b,Z){var a=this._super(b,Z),Y={"\r\n":" ","\n":" ","\r":" "};var c=b.css;if(c){a.addCls(c);}a.tt=b.tt||"";b.n=mstrmojo.string.multiReplace(b.n,Y);a.n=b.n||"";return a;},postBuildRendering:function Q(){if(this._super){this._super();}this.resetKeydownIndex();},onvisibleChange:function(Y){if(this._super){this._super(Y);}this.updateItemStyle(Y.value);},refresh:function G(Y){if(this._super){this._super(Y);}if(this.domNode){this.domNode.focus();}this.updateItemStyle(true);},resetKeydownIndex:function(){var Z=Object.keys(this.selectedIndices),Y=Z.length;this.keydownIndex=Y>0?parseInt(Z[0]):0;},setKeydownIndex:function(){this.keydownIndex=0;},grabFocus:function N(Y){if(!this.enableAccessibility){return ;}var Z=this.domNode;if(Y){Z.focus();}this.navMode=true;this.updateItemStyle(true);},loseFocus:function D(Z){if(!this.enableAccessibility){return ;}this.updateItemStyle(false);var Y=this.domNode;if(Z){Y.blur();}this.navMode=false;},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},getA11yCSS:function(){return this.navMode?[P.CSS_FOCUS_VISIBLE]:[];},arrowKeySupported:function(Y){return Y===O.DOWN_ARROW||Y===O.UP_ARROW||Y===O.END||Y===O.HOME;},onclick:function X(Y){var Z=false;if(this._super){Z=this._super(Y);}if(this.enableAccessibility&&!this.multiSelect){this.keydownIndex=this.selectedIndex;}return Z;},onkeydown:function L(Y){var a=Y.e||hWin.event;if(!this.enableAccessibility){return ;}if(this._super){this._super(Y);}if(a.keyCode===O.ENTER||a.keyCode===O.SPACE||(!this.multiSelect&&(a.keyCode===O.DOWN_ARROW||a.keyCode===O.UP_ARROW))){Y.cancel();Y.preventDefault();var Z=this.items[this.keydownIndex];if(Z){this.doItemSelect(Z,Y);}}},preselectionChange:function C(Z){var a=this.minimumSelectCnt,Y=this.getSelectedItems().length,b=Z.removed;if(b&&a){if(Y<a){this.select(b,true);return false;}}R.toggleClass(this.itemsContainerNode,"disableSelected",Y<=a);return true;},buildRendering:function I(){this._super();R.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu,keydown><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function E(){return this.domNode.firstChild;},scrollNode:function F(){return this.domNode.firstChild;}},postBuildRendering:function B(){var G=this.parent;if(this.renderOnScroll){if(!this.onScrollEnd){var I=this.id;this.onScrollEnd=function H(){var J=mstrmojo.all[I];J.doScroll();J.updateScrollbars();};}}if(this._super){this._super();}if(this.enableAccessibility&&G.canTab&&G.navList.length&&this.getNavList){G.navList=this.getNavList();if(this.isTabItemHighlighting&&this.isTabItemHighlighting()){G.restoreFocus();}}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,onkeydown:function D(G){var H=G.e||G;if(!this.enableAccessibility){G.preventDefault();H.stopPropagation();}if(this._super){return this._super(G);}},doScroll:function A(){if(this.renderOnScroll){var H,I=this.scrollNode,G=(this.renderIndex+1)*this.renderBlockSize;if(G>=this.items.length){return ;}if(mstrmojo.dom.position(I).h===I.scrollHeight){H=this.domNode;}else{H=I;}if((mstrmojo.dom.position(H).h+H.scrollTop)>=H.scrollHeight){this.renderIndex++;var J=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");this.itemsContainerNode.innerHTML+=J;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,W,U){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=W[S.itemField];var P=mstrmojo.string.escape4HTMLText,X="";if(Q){var M=W.anc&&W.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){X+=M[L].n+" > ";}X+=P(M[O-1].n);}else{if(W.path){X+=P(W.path);}}}if(!U){if(W.st===8704){X+=(X.length===0?"":" > ")+P(W.ab);}else{X+=(X.length===0?"":" > ")+P(I);}}if(J){var N=W[S.itemDescField],K=120;if(N){X+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return X;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var M=J.path||J.getAttribute("path");if(M){I.set("path",K.path);return ;}var L={success:function(O){var P=H(O.toString())||"";K.path=P;I.set("path",P);}},N={taskId:"getObjectDetails",objectID:K.did,objectType:K.t};if(mstrApp.isWorkstationPlugin){mstrApp.workstationDataFetchTaskProc&&mstrApp.workstationDataFetchTaskProc(N).then(function(O){L.success(O);});}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,L,N,undefined);}},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,mstrApp.isWorkstationPlugin?!!this.path.excludeSelf:this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.ButtonBar");var C={JUSTIFY:6,LEFT:0,RIGHT:1,CENTER:2};mstrmojo.vi.ui.TextAlignButtonBar=mstrmojo.declare(mstrmojo.ui.ButtonBar,null,{scriptClass:"mstrmojo.vi.ui.TextAlignButtonBar",includeJustify:true,init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"txtAlign");var E=this.itemsValueMap,D=this.items;if(!this.includeJustify){D=D.filter(function(G){return G.id!=="justify";});}this.items=D.map(function(H){var G=mstrmojo.hash.copy(H);G.v=E[G.id];return G;});},onValueChange:mstrmojo.emptyFn,itemsValueMap:{left:0,center:2,right:1,justify:6},items:[{n:mstrmojo.desc(3049,"Left"),id:"left"},{n:mstrmojo.desc(2193,"Center"),id:"center"},{n:mstrmojo.desc(2166,"Right"),id:"right"},{n:mstrmojo.desc(2068,"Justify"),id:"justify"}],getItemProps:function A(F,D){var E=this._super(F,D);E.addCls(F.id);return E;},postselectionChange:function(D){var E=this.items,F=E[D.added[0]],G=E[D.removed&&D.removed[0]];this.onValueChange(F.v,G&&G.v);}});mstrmojo.vi.ui.TextAlignButtonBar.TEXT_ALIGN=C;}());(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+mstrmojo.string.encodeHtmlString(E.substring(0,G))+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom,F=mstrmojo.string;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,allowHTML:false,_set_items:function(I,G){var H=this.items;this.items=G||[];return H!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var H=this.value,G=this.selectedIndex,J=this.items||[],K,I;if(G===undefined||(H!==null&&(G===-1||(G!==-1&&J[G]&&J[G][this.itemIdField]!==H)))){G=mstrmojo.array.find(J,this.itemIdField,H);G=(G>-1)?G:this.defaultSelection;this.selectedIndex=G;}else{if(H===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=K=J[this.selectedIndex];if(K){I=K[this.itemField];}else{I=this.defaultText||"";}this.set("text",I);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var H=this.value,G=-1;if(H!==null){G=mstrmojo.array.find(this.items,this.itemIdField,H);}if(G>-1){this.selectedItem=this.items[G];this.selectedIndex=G;}},togglePopup:function E(){if(this.popupToBody){var J=B.position(this.popupNode,true),I=this.popupRef,G={left:Math.round(J.x)+"px",top:Math.round(J.y)+"px"};if(!I.hasRendered){delete I.slot;G.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(G,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var H=this.popupRef.domNode;if(H){if(this.fixWidth){H.style.width=(this.domNode.offsetWidth-2)+"px";}else{H.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(G){if(B.getButton(G.hWin,G.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(G){var H=this.popupRef;if(this.popupToBody&&H.hasRendered){H.unrender(false);}if(this._super){this._super(G);}},itemName:function(I,G,H){return this.allowHTML?I[H.itemField]:F.encodeHtmlString(I[H.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,adjustSize:function(){var H=this.opener,G=this.domNode;if(H&&H.fixWidth){mstrmojo.css.addClass(G,["fix-width"]);}if(H&&H.fixHeight){mstrmojo.css.addClass(G,["fix-height"]);}},onOpen:function(){var I=this.opener,H=I&&I.popupZIndex,J=(I&&I.popupCssClass)||"",G=this.domNode;if(H){G.style.zIndex=H;}if(J){mstrmojo.css.addClass(G,[J]);}this.adjustSize();},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(M,G,I){var L=I.parent.opener,K=M[I.itemCSS]||L.item2textCss&&L.item2textCss(M)||"",N=L.itemName,J=M[I.itemTitleField||I.itemField],H=L.allowHTML?J:F.encodeHtmlString(J);return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+K+'" title="'+H+'">'+(N(M,G,I)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var I=this.parent,J=I.visible,G=I.opener,H=this.selectedItem;if(!G||!H||!J){return ;}G.set("value",H[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,U=this.parent.parent;if(R===""){U.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);U.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur,paste,cut></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label {@labelClass}" title="{@labelTitle}">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.ToolbarEditor","mstrmojo.hash");mstrmojo.ui.menus.ToolbarEditorConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.ToolbarEditorConfig",cssClass:"",contents:null,init:function C(D){this._super(D);this.initBindings();},clear:function A(){this._super();this.contents=null;},newInstance:function B(D){return new mstrmojo.ui.menus.ToolbarEditor(mstrmojo.hash.copy({popupConfig:this},D));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,listenOnRootView:false,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},addListener2RootView:function(K){var L=document.querySelector("#rootView");var M=L.style.height;var J=L.style.width;this.observer=new MutationObserver(function(N){N.forEach(function(P){var O=L.style.height;var Q=L.style.width;if(P.attributeName==="style"&&(M!==O||J!==Q)){K();M=O;J=Q;}});});this.observer.observe(L,{attributes:true});},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();if(this.listenOnRootView){this.addListener2RootView(K);}else{D.attachEvent(window,"resize",K);}}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){if(this.listenOnRootView){this.observer&&this.observer.disconnect();}else{D.detachEvent(window,"resize",J);}}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",menuItemTooltip:false,tooltipOrientation:"horizontal",tooltipOffset:8,tooltipOffsetX:0,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(D.encodeHtmlString(I.ttp,true)||D.encodeHtmlString(I.n,true))||"";},showTooltip:function G(b,N){var Q=this;if(!Q.hasOpenTooltip&&!(Q._lastOpened&&Q._lastOpened.visible&&!Q.menuItemTooltip)){var h=E.eventTarget(N,b),c=Q.getItemFromTarget(h),W=Q.getItemNodeFromTarget(h),j=Q.getTooltipText(c),P=Q.tooltipCss;if(!j||c.ttpDisabled){return ;}if(Q.showTooltipForLargeText){if(W.offsetWidth>=W.scrollWidth){return ;}}var i=E.position(W),a,R,L,Y="",Z=Q.tooltipOffset,O=(c&&c.ctxt)||{};if(this.tooltipOrientation==="vertical"){a=i.x+i.w/2;L=O.posType||C.POS_TOPCENTER;R=i.y+i.h+Z;var M="mojo-theme-light vi-regular vi-tooltip-A";if(!O.posType){M+=" A-center";}Q.tooltipCss=F.copy({cssClass:M},P);}else{var K=E.windowDim(),X=40,d=i.x+i.w+Z,J=i.x-Z,g=J-X,I=K.w-(d+X),f="vi-regular vi-tooltip-",U;R=i.y;if(I>=g){a=d;U=I;L=O.posType||C.POS_TOPLEFT;P.cssClass=f+"C "+P.rightCssClass;}else{a=J;U=g;L=O.posType||C.POS_TOPRIGHT;P.cssClass=f+"D "+P.leftCssClass;}Y="max-width: "+U+"px;";}if(Q.tooltipContrast){P.cssClass=P.cssClass+" contrast";}if(P&&P.getItemCssClass){P.cssClass=H.filter([P.cssClass,P.getItemCssClass(c)],function(e){return !!e;}).join(" ");}var S=Q.richTooltip=F.copy(Q.tooltipCss,{content:D.apply(Q.tooltipMarkup,{c:j,style:Y}),top:R,left:a,posType:L});if(Q.itemDisabled){S.cssClass+=" vi-warning";}if(O.hoverable){S.enableHover=true;}if(O.posType==="TL"){S.left=i.x+Q.tooltipOffsetX;}S.keepArrowXPos=!!Q.keepArrowXPos;S.keepArrowYPos=!!Q.keepArrowYPos;this._super(b,N);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var P=0,E=mstrmojo.dom,J=mstrmojo.array,B=mstrmojo.string;function Q(){var X=this.textNode,Z=this.imgNode;if(this.eg!=null){Z.style.display="none";X.innerHTML=this.eg||"";X.style.display="block";this.domNode.style.display=(this.visible&&this.eg.length>0)?"block":"none";}else{X.style.display="none";this.domNode.style.display=this.visible?"block":"none";Z.style.display="block";if(this.tooltip){Z.setAttribute("ttl",this.tooltip);}var Y=this.getFormats();this.retrieveGraphSrc(Y.height,Y.width);}}var W={6:"poly",7:"rect",100:"circle"};function I(){var g=this.as,c=g&&g.length;if(!c){return ;}var b=this.id,f=b+"_map"+P++,Z=[],e=-1,a;for(a=0;a<c;a++){var Y=g[a];Y.id=b;Y.aid=a;Y.tooltip=B.multiReplace(Y.tooltip||"",{"&#13":"<br />","&#32":" ",'"':"&quot;"});if(!isNaN(Y.shape)){Y.shape=this.getAreaShapeName(Y.shape);}if(!mstrApp.isDossier&&(Y.tks||Y.tks===""||Y.tty===1)){Y.extra=' href="#" ';}Z[++e]=B.apply(this.areaMarkup,Y);}var d='<map id="'+f+'" name="'+f+'">'+Z.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+f+'" ';this.map=d;}else{var X=document.createElement("div");X.innerHTML=d;if(this.mapNode){X=X.firstChild;this.mapNode.innerHTML=X.innerHTML;E.recursiveReplaceInlineEventListeners(this.mapNode);}else{this.imgNode.setAttribute("usemap","#"+f);E.recursiveReplaceInlineEventListeners(X);this.mapNode=this.domNode.appendChild(X.firstChild);}}}var A=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}" hidefocus="true" />{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function K(){return this.domNode.childNodes[1];},mapNode:function G(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function N(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function L(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function C(){I.call(this);return this._super();},postBuildRendering:function R(){Q.call(this);return this._super();},setModel:function M(X){this.model=X;},updatingTooltipHelper:function S(b,l,f){var Y=b&&b.getAttribute("aid"),X=b&&b.getAttribute("ttl"),a=b.getAttribute("SC"),e={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},k=(this.model.getZoomFactor?this.model.getZoomFactor():(this.model.docModel?this.model.docModel.getZoomFactor():1))+"em";if(Y==this.cAreaIdx){return ;}this.cAreaIdx=Y;e.content=X||this.defaultTooltip;var Z="font-size:"+k+";";if(a){Z+="border-color:#"+a;}e.contentNodeCssText=Z;var g=b.getAttribute("coords"),j=99999,h=99999;if(!f){if(g&&g.length>0){g=g.split(",");var d=0;while(d+1<g.length){j=Math.min(j,parseInt(g[d++],10));h=Math.min(h,parseInt(g[d++],10));}}}if(j===99999){j=l.x;}if(h===99999){h=l.y;}e.top=h;e.left=j;this.richTooltip=null;this.set("richTooltip",e);},redraw:function O(){if(!this.hasRendered){return false;}Q.call(this);var X=this.getFormats();if(this.as&&X.height&&X.width){this.refreshMap();}return true;},refreshMap:function H(){if(this.as){I.call(this);}},getAreaShapeName:function D(X){return W[parseInt(X,10)]||"default";}});var U=A.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",F=A.canvasCLS="mobile-graph-highlight-canvas";A.hideTooltips=function(){J.forEach(document.getElementsByClassName(U),function(X){X.style.display="none";});J.forEach(document.getElementsByClassName(F),function(X){X.getContext("2d").clearRect(0,0,X.width,X.height);X.width=X.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(X,U){if(!X){return ;}var S=U&&U.length||0,W;for(W=S;W>0;W--){X=X.replace(new Array(W+2).join("#"),U[W-1]);}return X;},L=function L(U){if(!U){return ;}var b=this,X=J.position(U.refNode||b.refNode),a=J.position(b.domNode),Z=U.position||R.RIGHT,W=0,c=0,S=9+(U.margin!==undefined?U.margin:0),Y=" ";switch(Z){case R.TOP:c=-a.h-S;Y+="t";break;case R.BOTTOM:c=X.h+S;Y+="b";break;case R.LEFT:W=-a.w-S;Y+="l";break;case R.RIGHT:W=X.w+S;Y+="r";break;}mstrmojo.hash.forEach(C(U,{left:W,top:c,contentNodeCssClass:Y,visible:false}),function(d,e){this[e]=d;},this);this.set("visible",U.invalid);},A=function A(S){var Y=this,W,X=S.errorCode,Z=S.errorMsg,U=S.args,a=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){W={content:X!==null?(Y.generateContentHTML(Q(a[X],U))||a["*"]):Z};}return W;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),minValueVIWarning:mstrmojo.desc(19051,"Please enter a value greater than ##."),maxValueVIWarning:mstrmojo.desc(19050,"Value is too large."),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead."),largeSelectionVIWarning:mstrmojo.desc(19052,"Selecting a large number of elements may severely affect performance.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(W){var b=this,d=b.warningSlotName,f=b[d],S=W&&W.lasting||6000,Z=W&&W.offsetAlgo,a=W.refNode||this.domNode,U=W.highlight!==false,e=W.closeOnClick===false?false:true,c;if(!f){f=new mstrmojo.Tooltip({refNode:a,offsetAlgo:Z,highlight:U,closeOnClick:e,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});b.addDisposable(f);b[d]=f;c=b.closeOnClick=b.getCloseOnClickListener();J.attachEvent(document.body,"click",c);}var Y=W.position||R.TOP,X="vi-warning vi-tooltip-";switch(Y){case R.TOP:f.cssClass=X+"V";break;case R.BOTTOM:f.cssClass=X+"A";break;case R.LEFT:f.cssClass=X+"D";break;case R.RIGHT:f.cssClass=X+"C";break;}f.open(b,A.call(b,W));this.adjustPosition(W);if(U){P.toggleClass(f.refNode,"mstrmojo-Warning",true);}window.clearTimeout(b._warningTimeOut);b._warningTimeOut=window.setTimeout(function(){b.hideWarning();},S);},hideWarning:function H(){var U=this,S=U[U.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(U._warningTimeOut);delete U._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var U=S[S.warningSlotName];if(U.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var U=this;L.call(U[U.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(W){if(!W||!W.attachEventListener){return ;}var X=W._validationEventListener,U;if(X){W.detachEventListener(X);delete W._validationEventListener;}U=this.getValidationEvtListener();if(U){W._validationEventListener=W.attachEventListener("validationChange",this.id,U);}},this);},getValidationEvtListener:function B(){var U=this;return function S(W){var X=W.value;U[(X&&X.invalid?"show":"hide")+"Warning"](X);};},unrender:function K(S){var U=this[this.warningSlotName];if(U){U.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsList","mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.string","mstrmojo.tooltip","mstrmojo.ListBase");var F=mstrmojo.array,G=mstrmojo.css,E=mstrmojo.dom,I=mstrmojo.string;function B(){var K,P,J=this.itemsContainerNode,L,Q=this.items,U=[],S,N,R=this.padding,O,M=0;this.items.pop();if(!this.width){return ;}K=parseInt(this.width,10);P=J.scrollWidth||E.position(J).w;if(P<=K){return ;}S=J.lastChild;G.removeClass(S,"hide");N=E.position(S).w;L=J.children;O=L.length-1;while(M<O){K-=(E.position(J.children[M]).w+R);if(K<N){break;}M++;}while(M<O){J.removeChild(L[L.length-2]);U.push(Q[M++]);}S.textContent=mstrmojo.desc(15124,"## more").replace("##",U.length);this.tooltipContent=F.map(U,function(W){return I.encodeHtmlString(W.n);}).join("</br>");}mstrmojo.vi.ui.TruncatedList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.TruncatedList",cssClass:"mstr-truncList",padding:0,overflowCls:"",getAdditionalProperties:mstrmojo.emptyFn,useRichTooltip:true,getItemProps:function H(M,J){var L=this._super(M,J),K=M.style;if(K){L.addStyle(K);}this.getAdditionalProperties(L,J);return L;},buildRendering:function C(){this.items.push({alias:"overflowItem",cls:this.overflowCls+" hide",n:mstrmojo.desc(15124,"## more").replace("##",this.items.length)});if(this._super){this._super();}},setWidth:mstrmojo.emptyFn,postBuildRendering:function A(){this.setWidth();B.call(this);if(this._super){this._super();}},updateTooltipConfig:function D(K){var M=this.itemsContainerNode.children,J=M.length,L=J&&M[J-1],N;if(L&&L===E.eventTarget(window,K)){N=E.position(L);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.tooltipContent,top:N.y+N.h+10,left:N.x};}else{delete this.richTooltip;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._ListSelections","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.string","mstrmojo.hash","mstrmojo.css");var R=mstrmojo.dom,m=mstrmojo.string,C=mstrmojo.css,S=mstrmojo.hash,L=mstrmojo.all,g=mstrmojo._HasMarkup,h="px";var D={},K=false,c;function f(){var t={mousedown:["touchstart","mousedown"],mouseup:["touchend","mouseup"],mousemove:["touchmove","mousemove"]},s;for(s in t){D[s]=K?t[s][0]:t[s][1];}}function p(t){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var s=document.body;R.detachEvent(s,"mousemove",this._mousemoveCallback);R.detachEvent(s,"mouseup",this._cancelCallback);this.initDrag(t);}}function k(t){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var s=document.body;R.detachEvent(s,"touchmove",this._touchmoveCallback);R.detachEvent(s,"touchend",this._cancelCallback);if(c){window.clearTimeout(c);}this.initDrag(t);}}function I(w){var s=document.body,u=K?"_touchmoveCallback":"_mousemoveCallback";R.detachEvent(s,D.mousemove,this[u]);R.detachEvent(s,D.mouseup,this._cancelCallback);if(c){window.clearTimeout(c);}var t=this.afterDragCancel;if(t){t.call(this.target,w);}}function G(y){K=true;f();R.preventDefault(window,y);if(this.dragging){return true;}var u=this.target.id,w=document.body,t=y&&y.touches&&y.touches[0]||y;if(!this._touchmoveCallback){this._touchmoveCallback=function(z){k.call(L[u].dnd,z&&z.touches&&z.touches[0]||z);return true;};}this._moveCnt=0;this.startE=S.copy(t);R.attachEvent(w,"touchmove",this._touchmoveCallback);if(!this._cancelCallback){this._cancelCallback=function(z){I.call(L[u].dnd,t);return true;};}R.attachEvent(w,"touchend",this._cancelCallback);var x=this,s=t;s.type=s.name="contextmenu";c=window.setTimeout(function(){var AA=x.target,AB=AA&&AA.docSelector,z=AB&&AB.parent;R.detachEvent(w,"touchmove",this._touchmoveCallback);R.detachEvent(w,"touchend",this._cancelCallback);if(z){z.raiseEvent(g.newDomEvent("contextmenu",window,s));}},1000);return false;}function i(u){K=false;f();R.preventDefault(window,u);if(this.dragging){return true;}var s=this.target.id,t=document.body;if(!this._mousemoveCallback){this._mousemoveCallback=function(w){p.call(L[s].dnd,w);return true;};}this._moveCnt=0;this.startE=S.copy(u);R.attachEvent(t,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(w){I.call(L[s].dnd,w);return true;};}R.attachEvent(t,"mouseup",this._cancelCallback);return false;}function E(t){var s=this.duringDrag;if(s){s.call(this.target,t);}return true;}function O(u){this.dragging=false;var s=document.body;R.detachEvent(s,D.mousemove,this._dragCallback);R.detachEvent(s,D.mouseup,this._dragEndCallback);var t=this.afterDragEnd;if(t){t.call(this.target,u);}return true;}function Z(){if(this._mousemoveCallback){R.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._touchmoveCallback){R.detachEvent(document.body,"touchmove",this._touchmoveCallback);delete this._touchmoveCallback;}if(this._cancelCallback){R.detachEvent(document.body,"mouseup",this._cancelCallback);R.detachEvent(document.body,"touchup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){R.detachEvent(document.body,"mousemove",this._dragCallback);R.detachEvent(document.body,"touchmove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){R.detachEvent(document.body,"mouseup",this._dragEndCallback);R.detachEvent(document.body,"touchmove",this._dragEndCallback);delete this._dragEndCallback;}}mstrmojo.DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DnDComponent",isDragging:false,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,init:function X(s){S.copy(s,this);},initDrag:function o(x){this.dragging=true;var t=this.target.id,w=document.body;var y=this._dragCallback;if(!y){y=this._dragCallback=function(z){if(K){z=z&&z.touches&&z.touches[0]||z;}return E.call(L[t].dnd,z);};}R.attachEvent(w,D.mousemove,y);var s=this._dragEndCallback;if(!s){s=this._dragEndCallback=function(z){if(K){z=z&&z.touches&&z.touches[0]||z;}return O.call(L[t].dnd,z);};}R.attachEvent(w,D.mouseup,s);var u=this.afterDragStart;if(u){u.call(this.target,x);}this._dragCallback(x);}});function b(s){this.getUnit=function t(){var u=s.items.length;return u>1?s._effLen/(u-1):1;};this.calcMinMax=function(w,u){var x=Math.round((w/s.unit+u/s.unit)/2);return{min:x,max:x};};this.preUpdateThumb=function(){s.start=Math.min(s.min*s.unit,s._effLen)+h;s.sdCssText=s.orCfg.posCssP+":"+s.start+";";};this.updateThumb=function(){s.containerNode.style[s.orCfg.posCssP]=s.start=Math.min(Math.round(s.min*s.unit),s._effLen)+h;};return this;}function n(s){this.getUnit=function(){return s._effLen/s.items.length;};this.calcMinMax=function(w,u){return{min:Math.floor(w/s.unit+0.5),max:Math.floor(u/s.unit-0.5)};};function t(){var u=s.min,x=s.unit;var y=s.start=(u*x)+h;var w=s.length=Math.max(Math.round((s.max-u+1)*x-s.gap),0)+h;return{st:y,len:w};}this.preUpdateThumb=function(){var w=s.orCfg,u=t();s.sdCssText=w.posCssP+":"+u.st+";"+w.lenCssP+":"+u.len+";";};this.updateThumb=function(){var w=s.orCfg,u=t(),x=s.containerNode.style;x[w.posCssP]=u.st;x[w.lenCssP]=u.len;};return this;}var F="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div id="{@id}" class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:"TL",useRichTooltip:true,init:function l(s){this._super(s);if(s.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;this.titleHeight=(s.docSelector.fmts.ttl&&s.docSelector.fmts.ttl.height)?parseInt(s.docSelector.fmts.ttl.height,10):0;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(s.multiSelect){this.typeHelper=new n(this);}else{this.clsType="sc1";this.typeHelper=new b(this);}this.tooltipOpenDelay=100;},markupSlots:{dndNode:function(){return this.domNode.firstChild;},bgNode:function(){return this.domNode.firstChild.firstChild;},sdcNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.lastChild.firstChild;},frontNode:function(){return this.domNode.firstChild.lastChild.firstChild.firstChild;},thumbNode:function(){return this.domNode.firstChild.lastChild.firstChild.childNodes[1];},endNode:function(){return this.domNode.firstChild.lastChild.firstChild.lastChild;},tooltipNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){this.synchronizeSlider();}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,dndNode:null,synchronizeSlider:function J(){var AA=this.orCfg,z=AA.lenCssP,u=this[z],s=parseInt(u,10),AF=this.hasRendered,AD=this.titleHeight||0;var w=this._effLen=isNaN(s)?0:(s-this._exRoom-AD);if(u){var AE={};AE[z]=Math.max(parseInt(u,10)-(2*this.cssBkBW),0)-AD+h;var x={};x[z]=w+h;x[AA.posCssP]=Math.round(this._exRoom/2)+h;x[AA.opPosCssP]="0"+h;if(AF){S.copy(AE,this.bgNode.style);S.copy(x,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(AE);this.sdcCssText=C.getCssTextFromObj(x);}}var AH=this.selectedIndices;if(!S.isEmpty(AH)){var AC=this.items.length,y=-1,AG=-1,AB;for(AB=0;AB<AC;AB++){if(AH[AB]){if(y<0){y=AB;}AG=AB;}else{if(y>-1){break;}}}this.min=y;this.max=AG;}var t=this.typeHelper;this.unit=t.getUnit();if(AF){t.updateThumb();}else{t.preUpdateThumb();}},preBuildRendering:function A(){this.synchronizeSlider();},postBuildRendering:function W(){this._super();if(this.items.length>1){var s=this.dnd=new mstrmojo.DnDComponent({target:this});var t=this.id;this.__mouseDownEvt=function(u){R.stopPropogation(window,u);i.call(L[t].dnd,u);return true;};R.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);if(R.supportsTouches){this.__touchstartEvt=function(u){if(R.isTouchOptimizationEnabled()&&C.hasClass(u.target,"bk")){return ;}R.stopPropogation(window,u);G.call(L[t].dnd,u);return true;};R.attachEvent(this.dndNode,"touchstart",this.__touchstartEvt);}s.afterDragStart=this.initDrag;s.duringDrag=this.ondrag;s.afterDragEnd=this.ondrop;s.afterDragCancel=this.cancelDrag;}},initDrag:function o(y,s){s=s||window;var x=this.configureGhost(true),t=this.orCfg,w=this.dnd,u=w.startE;w.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:x.containerNode[t.lenP],offset:R.getMousePosition(u,s)[t.offsetP],td:R.eventTarget(s,u)};},configureGhost:function e(t){var w=this.ghost;if(!w){var y=this.containerNode.cloneNode(true),x=y.childNodes;C.addClass(y,"gh");y.style.display="none";w=this.ghost={containerNode:y,frontNode:x[0],thumbNode:x[1],endNode:x[2]};this.sdcNode.appendChild(y);}var u=this.ghost.containerNode.style,s=this.orCfg;S.copyProps([s.posCssP,s.lenCssP],this.containerNode.style,u);if(t){u.display="block";}return w;},ondrag:function P(AB,AA){AA=AA||window;var AC=this.dnd.initD,x=this.ghost.containerNode,AG,u,s,z=this.min,AD=this.max,y=this.orCfg,t=y.lenCssP,AF=y.posCssP;var AE=R.getMousePosition(AB,AA)[y.offsetP]-AC.offset;switch(AC.td){case this.thumbNode:AG=Math.max(Math.min(AC.tP+AE,AC.sL-AC.contL),0);u=AG+AC.contL;x.style[AF]=AG+h;var w=this.typeHelper.calcMinMax(AG,u);z=w.min;AD=w.max;break;case this.frontNode:AG=Math.max(Math.min(AC.tP+AE,AC.tP+AC.contL),0);s=Math.max(Math.min(AC.contL-AE,AC.tP+AC.contL),0);x.style[AF]=AG+h;x.style[t]=s+h;z=Math.min(Math.floor(AG/this.unit+0.5),this.max);break;case this.endNode:s=Math.max(Math.min(AC.contL+AE,AC.sL-AC.tP),0);u=AC.tP+s;x.style[t]=s+h;AD=Math.max(Math.floor(u/this.unit-0.5),this.min);break;default:return ;}if(z!==this.min||AD!==this.max){this.min=z;this.max=AD;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function a(){this.typeHelper.updateThumb();var x=this.ghost;if(x){x.containerNode.style.display="none";}this.hideTooltip();var y=this.dnd&&this.dnd.initD;if(this.makeSelection&&y){this.makeSelection({selItem:y.td});}var s=this.items;if(s&&s.length){var u=[],t;for(t=this.min;t<=this.max;t++){var w=s[t];if(w){u.push(t);}}this.select(u);}this.dnd.initD=null;},cancelDrag:function N(t,s){if(this.makeSelection){this.makeSelection({selItem:R.eventTarget(s||window,this.dnd.startE)});}},showTooltip:function q(t,s){this.configureGhost(false);this._updateTooltip(t,s);this._super(t,s);},hideTooltip:function Q(t,s){if(this.dnd&&this.dnd.dragging){return ;}this._super(t,s);},_updateTooltip:function U(){var AA=this.orCfg,AB={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},t=(this.ghost)?this.ghost.containerNode:this.containerNode;AB[AA.opPosCssP]=0;AB[AA.posCssP]=t.style[AA.posCssP];AB.content="";var y=this.items,w=y.length;if(y&&w){var s=(y[this.min]||y[0]),u=this.getItemTooltip(s),x=u;if(this.min!==this.max){var z=(y[this.max]||y[w-1]);x=mstrmojo.desc(146,"From:")+" '"+u+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(z)+"'";}AB.content=F.replace(/\{@content\}/g,x);}this.set("richTooltip",AB);},getItemTooltip:function Y(s){var t=s?s.n:"";if(this.allowHTMLOnSelector){return t;}t=m.encodeHtmlString(t,true);return"'"+(t.length>20?t.slice(0,20)+"...":t)+"'";},unrender:function B(t){this.ghost=null;this.hideTooltip();this.min=0;this.max=(this.items&&this.items.length-1)||0;var u=this.dndNode,w=this.__mouseDownEvt,s=this.__touchstartEvt;if(w&&u){R.detachEvent(u,"mousedown",w);}if(s&&u){R.detachEvent(u,"touchstart",s);}Z.call(this);this._super(t);},onselectionChange:function M(){var s=this.selectedIndices,t=S.isEmpty(s);if(s){this.set("max",t?this.items.length-1:S.max(s,false,true));this.set("min",t?0:S.min(s,false,true));if(this.typeHelper){this.typeHelper.updateThumb();}}if(this.onchange){this.onchange();}},onclick:function d(AD){var AA=AD.getTarget();if(AA&&R.contains(this.sdcNode,AA,true)){return ;}var s=parseInt(AD.src.containerNode.style.left,10),t=parseInt(AD.hWin.event.offsetX),y=this.isHoriz&&t<s,u=parseInt(AD.src.containerNode.style.width,10);var AB=parseInt(AD.src.containerNode.style.top,10),w=parseInt(AD.hWin.event.offsetY),z=parseInt(AD.src.containerNode.style.height,10);moveTop=!this.isHoriz&&w<AB;if(this.multiSelect){if(this.bgNode!==AD.hWin.event.target){return ;}var AC=S.max(this.selectedIndices,false,true),x=S.min(this.selectedIndices,false,true);if(y||moveTop){this._addSelections([x-1]);this.removeSelect(AC);}else{if((!isNaN(u)&&t>s+u)||(!isNaN(z)&&w>AB+z)){this._addSelections([AC+1]);this.removeSelect(x);}}}else{if(y||moveTop){if(this.selectedIndex>0){this.select([this.selectedIndex-1]);}}else{if(this.selectedIndex<0&&this.items.length>1){this.select(1);}else{if(this.selectedIndex<this.items.length-1){this.select([this.selectedIndex+1]);}}}}},onmouseover:function H(s){this.showTooltip();},onmouseout:function j(s){this.hideTooltip();}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.dom");var B=mstrmojo.dom;var A="openXtabCellMenu";mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onmousedown:function(D){this.openPopup(true,D);B.stopPropogation(D.hWin,D.e);B.preventDefault(D.hWin,D.e);return false;},openPopup:function(F,D){var E=this.xtab[A]?this.xtab:mstrmojo.findAncestor(this.xtab,A);if(E){E.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos,lockIW:this.xtab,singleCellClick:F===true,evt:D});}this.domNode.oncontextmenu=function(G){B.stopPropogation(window,G);B.preventDefault(window,G);return false;};},closePopup:function(){var D=mstrmojo.findAncestor(this.xtab,A);if(D){D.closePopup();}}}],updatePopupConfig:function C(F){var G=F&&F.td,O=F&&F.xtab,D=this.btn;var H=this._lastTd;if(H!==G){D.closePopup();this._lastTd=G;}D.xtab=O;D.td=G;D.cmPos=F&&F.cmPos;if(!G||!O){return ;}var I=B.findAncestorByName(G.parentNode,"table",false,O.viewport),K=O.zones,N="",E;if(I){for(E in K){var L=K[E];if(L&&L.tableNode===I){N=L.slot;break;}}}var M=mstrmojo.boxmodel.offset(G,O.overlayNode),J=23;this.set("location",{left:0,top:M.top,width:Math.min(G.offsetWidth+M.left,O._pl),height:J});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var D=this.location;if(!D){return ;}var E=this.domNode.style;E.left=(D.left+Math.max(D.width-20,0))+"px";E.top=D.top+(D.height?Math.round(D.height/2)-7:0)+"px";}}};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(E){this._super(E);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}var D=["mstrmojo-ui-MenuPopup"],F=C.cssClass;if(F){D.push(F);}if(C.hasToggleItem){D.push("hasToggleItem");}mstrmojo.css.addWidgetCssClass(this,D);this.addChildren(C.contents);},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui.PopupConfig","mstrmojo.css");mstrmojo.ui.editors.ToolbarPopup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.ToolbarPopup",popupConfig:null,anchorElement:null,autoCloses:false,locksHover:true,init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ToolbarPopup");this.popupConfig=new mstrmojo.ui.PopupConfig({isHostedWithin:false,hostProxyCssClass:(mstrApp&&mstrApp.getThemeClassName())||"",anchorElement:this.anchorElement});},open:function A(D,C){D.closePopup();this._super(D,C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.Box","mstrmojo.css");var A=mstrmojo.css;mstrmojo.vi.ui.rw.VisFilterIndicator=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.rw.VisFilterIndicator",cssClass:"VisFilterIndicator",init:function D(F){var G=F.unitContainer.domNode,E=G.style;if(G){if(F.hasOwnProperty("width")===false){F.width=(E&&E.width)||(G.clientWidth+"px");}if(F.hasOwnProperty("left")===false){F.left=G.offsetLeft+"px";}if(F.hasOwnProperty("top")===false){F.top=(G.offsetTop)+"px";}}this._super(F);this.placeholder=G.appendChild(document.createElement("div"));},children:[{scriptClass:"mstrmojo.Label",slot:"containerNode",alias:"lblTitle",text:mstrmojo.desc(15297,"Items selected in configuration mode will not be applied to visualization filter.")}],postBuildRendering:function(){this._super();var F=this.domNode,E=this;F.style.left=this.left;F.style.top=this.top;if(!this.animationListener){var G=this.animationListener=function(H){if(H.animationName==="indicatorout"){A.addClass(F,"hidden");E.destroy();}};A.onAnimationEnd(F,G);}},updateDimension:function C(){if(this.hasRendered&&!this.destroyed&&this.unitContainer){var E=this.unitContainer.domNode;if(E){this.set("width",(E.style.width||(E.clientWidth+"px")));}}},destroy:function B(){if(this.animationListener){this.animationListener=null;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasOwnAvatar","mstrmojo.css","mstrmojo.dom");var E=mstrmojo.css,D=mstrmojo.dom;function F(K){var L=K.src.node,M=this.children.filter(function(N){return D.contains(N.domNode,L,true,this.domNode);});return M[0];}function J(K){var N=K.tgt,X=this.children,R=D.getMousePosition(N.e,N.hWin),Q,S,W,M,U,P,L=R.y;for(var O=X.length-1;O>=0;O--){W=X[O];Q=D.position(W.domNode);U=Q.h;M=Q.y;P=M+U/2;if(P<L&&(O===X.length-1||L<=M+U)){S=O;break;}else{if((O===0||M<L)&&L<=P){S=O-1;break;}}}return S;}function I(K){return K===-1?"top":"bottom";}mstrmojo.threshold.ThresholdRowPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",dropZone:true,draggable:true,restrictedToAxis:"y",avatarCssClass:"threshold-drag-avatar",getDragData:function H(K){return{row:F.call(this,K)};},createAvatar:function B(M,L){var K=L.src.data.row.domNode.cloneNode(true);K.style.left=D.position(this.domNode).x+"px";return K;},isDragValid:function G(K){var L=K.getCtxtDragData().row;return !(this.children.length===1||!L||L.draggableNode!==K.src.node)||this._super(K);},ondragstart:function(K){this._super(K);this.removeChildren(K.getCtxtDragData().row);},ondragmove:function A(M){var O=M.getCtxtDragData(),N=this.children,L=J.call(this,M);var K=O.lastRowIdx;if(K!==L){if(K!==undefined){E.removeClass(N[Math.max(K,0)].domNode,I(K));}E.addClass(N[Math.max(L,0)].domNode,I(L));O.lastRowIdx=L;}this._super(M);},ondragend:function C(L){var M=L.src.data,K=M.lastRowIdx;if(K!==undefined){E.removeClass(this.children[Math.max(K,0)].domNode,I(K));}this._super(L);this.parent.parent.model.moveThreshold(L.getCtxtDragData().row.idx,K+1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css");var B=mstrmojo.css;mstrmojo.vi.ui.editors.EditorGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},showDivider:true,isNested:false,isContainer:false,init:function D(E){this._super(E);B.addWidgetCssClass(this,["mstrmojo-vi-EditorGroup","ctrl-group"]);},preBuildRendering:function A(){var E=[];if(this.showDivider){E.push("divide");}if(this.isContainer){E.push("container");}if(E.length){B.addWidgetCssClass(this,E);}return this._super();},getLayoutOffsets:function C(){return{h:0,w:this.isNested?0:19};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,anchorSlot:"clickableNode",getLayoutOffsets:function B(){return{h:2,w:2};},updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._BindTargetChildren","mstrmojo.TabButton","mstrmojo.TabStripBase");var E=mstrmojo.array;function D(G,F){if(G.autoHide){G.set("visible",F);}}mstrmojo.TabStrip=mstrmojo.declare(mstrmojo.TabStripBase,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},btnCssDisplay:"inline",autoHide:true,tabButtonClass:"TabButton",init:function C(F){if(F&&F.autoHide){F.visible=false;}this._super(F);},addTabButtons:function B(G,O){var K=this.targetProps||{},U=K.childTitle||"n",P=K.childColor||"tbc",S=this.tabButtonClass,L=[],R=this.target,J=this.btnCssDisplay,F=function(){R.set("selected",this.target);};mstrmojo.requiresCls("mstrmojo."+S);for(var M=0,N=(G&&G.length)||0;M<N;M++){var Q=G[M],I=Q[U];if(I){var H=mstrmojo.insert({scriptClass:"mstrmojo."+S,title:I,backgroundColor:Q[P],target:Q,cssDisplay:J,onclick:F});L.push(H);}}if(L.length){D(this,L.length);this.addChildren(L,O);}this.selectionChange();},removeTabButton:function A(G){var F=E.filter(this.children,function(H){return(H.target===G);},{max:1});if(F&&F[0]){D(this,F.length-1);this.removeChildren(F[0]);F[0].destroy();}},clearButtons:function(){var F=E.map(this.children,function(G){return G.id;});this.removeChildren();E.forEach(F,function(G){if(mstrmojo.all[G]){mstrmojo.all[G].destroy();}});}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.VisFilterIndicator");mstrmojo.vi.ui.rw._HasVisFilterIndicator=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisFilterIndicator",{displayVisFilterIndicator:function B(){if(mstrApp.isInVFConfigMode){var D=this.parent,E=D&&D.isIndicatorDisplayed,C;if(E){return ;}C=new mstrmojo.vi.ui.rw.VisFilterIndicator({unitContainer:this});C.render();this.indicator=C;D.isIndicatorDisplayed=true;}},updateVisFilterIndicator:function A(){var C=this.indicator;if(mstrApp.isInVFConfigMode&&C){C.updateDimension();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",hasToggleItem:false,contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.ui._HasScroller","mstrmojo.func");mstrmojo.requiresDescs(1442,2140);var H=mstrmojo.dom,G=mstrmojo.hash,K=mstrmojo.array,B=mstrmojo.func;function L(Q,S){var P=2140,W="Cancel",U="this.parent.popupConfig."+(Q?"ok":"cancel"),R=S&&S[(Q?"ok":"cancel")+"BtnText"];if(Q){P=1442;W="Ok";}return mstrmojo.Button.newWebButton(R||mstrmojo.desc(P,W),function(Y){var Z=this.parent,X=Z.popupConfig;Z.closeAllMenus();X["fn"+W](X.data,Z);H.stopPropogation(Y.hWin,Y.e);},Q,{slot:"btnNode",bindings:{enabled:U+"Enabled",visible:U+"Visible"},cssDisplay:"inline-block"});}function C(R,Q){var P=Q?R.nextElementSibling:R.previousElementSibling;if(P&&P.classList.contains("separator")){P=C(P,Q);}return P;}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" tabindex="-1" mstrAttach:mouseover,mouseout,click><div class="scroll-container" style="{@scCssText}"><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div></div>',markupSlots:{containerNode:function E(){return this.domNode.firstChild.firstChild;},btnNode:function M(){return this.domNode.firstChild.children[1];},bottomNode:function M(){return this.domNode.firstChild.children[2];},scrollNode:function(){return this.domNode.firstChild;},scrollbarHostNode:function(){return this.domNode;}},popupConfig:null,postBuildRendering:function A(P){this._super(P);if(this.popupConfig&&this.popupConfig.supportsScroll){var Q=this;window.setTimeout(function(){Q.updateScrollbars();},10);}},onmouseover:function O(Q){var P=this.popupConfig;if(P&&!P.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(Q.name,Q.hWin,Q.e,{targetHostElement:P.hostElement}));}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll){var Q=this.scrollNode;if(!Q){return ;}var P=H.getComputedScrollbarWidth(Q);Q.style.marginRight=-P+"px";Q.style.paddingRight=0;}},monitorWindow:function J(){var Q=document.activeElement,P=null;if(Q!==null&&Q.id!==""){P=this.domNode.querySelector("#"+Q.id)?Q:null;}this._super();if(P){P.focus();}},init:function N(R){this._super(R);var Q=this.popupConfig,P=Q.bottomNode;if(Q&&Q.supportsScroll&&Q.maxHeight>0){if(Q.cssClass.indexOf("RoleMenu")>-1){Q.maxHeight=360;}this.cssText=(this.cssText||"")+";max-height:"+Q.maxHeight+"px";this.scCssText=(this.scCssText||"")+";max-height:"+Q.maxHeight+"px";}if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}this.data=Q.data||{};if(Q.onOpen){this.onOpen=Q.onOpen;}this.onOpen=B.composite([this.onOpen,this.notifyChildrenOpen]);this.addChildren([L(true,Q),L(false)]);if(P){P.slot="bottomNode";this.addChildren(P);}G.copyProps(["buildNavList","onkeydown","isValidTarget"],Q,this);},onOpen:function D(){if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}},notifyChildrenOpen:function F(){K.forEach(this.children,function(P){if(P.scriptClass==="mstrmojo.ui.ScrollableContainer"&&P.onOpen){P.onOpen();}});},onkeydown:function I(Y){var R=Y.getTarget(),Z=Y.e.keyCode,U;switch(Z){case 37:case 27:var S=this,X=S.opener,P=X.openerMenuElement;if(P){S.close();P.focus();delete X.openerMenuElement;}break;case 39:break;case 38:case 40:var Q=Z===40?true:false;U=C(R,Q);if(U){U.focus();}break;case 13:var W=mstrmojo.dom.findWidget(R.parentElement);W.onclick(Y);Y.e.preventDefault();Y.e.stopImmediatePropagation();break;default:Y.e.preventDefault();break;}Y.e.stopPropagation();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo.dom","mstrmojo.hash","mstrmojo._CanAutoClose","mstrmojo._IsAccessibleList","mstrmojo.vi.util.A11yUtility","mstrmojo.ui._HasListTooltip");var L=mstrmojo.Enum_Keys,E=mstrmojo.hash,B="hover",O=mstrmojo.vi.util.A11yUtility;mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo._IsAccessibleList],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,scrollNodeMaxHeight:undefined,parentDomNode:undefined,keydownString:null,lastKeydownTime:null,keydownInterval:500,enableAccessibility:true,listRole:"menu",itemRole:"menuitem",itemSelectedAriaProp:undefined,closeAfterSelection:true,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" tabIndex="-1" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu,keydown><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function K(){return this.domNode.firstChild.firstChild;},scrollboxNode:function C(){return this.domNode.firstChild;}},setupScrollNodes:function H(){this.scrollNode=this.scrollboxNode;},onOpen:function G(){this._super();this.updateScrollbars();var Q=this;setTimeout(function(){Q.scrollToSelectedItem();if(Q.opener&&Q.opener.focusOnPopup){Q.focus();}Q.updateItemStyle(true);},10);Q.updateItemStyle(false);this.keydownIndex=this.selectedIndex;},onclick:function N(Q){this.closeAfterSelection=true;this._super(Q);},postBuildRendering:function A(){var R=this._super();if(!this.parent){var Q=this.parentDomNode=this.parentDomNode||document.body;Q.appendChild(this.domNode);}return R;},closePopup:function M(){this.set("visible",false);},getA11yCSS:function(){return this.navMode?[B,O.CSS_FOCUS_VISIBLE]:[B];},arrowKeySupported:function(Q){return Q===L.DOWN_ARROW||Q===L.UP_ARROW||Q===L.END||Q===L.HOME;},getNavContainer:function I(){if(!this.enableAccessibility){return ;}var Q=this.parent;while(!Q.canTab){Q=Q.parent;}return Q;},onkeydown:function J(b){if(!this.opener||!this.opener.focusOnPopup){return ;}var S=b.hWin,W=b.e||S.event,Z=this.getNavContainer(),Q=this.keydownString,R=E.walk("parent.parent",this);this.locksHover=false;this.closeAfterSelection=false;if(Z){Z.handleTab(b);}if(this._super&&this._super(b)){return ;}if(W.keyCode===mstrmojo.Enum_Keys.ENTER||W.keyCode===mstrmojo.Enum_Keys.SPACE){b.cancel();b.preventDefault();this.closeAfterSelection=true;this.singleSelect(this.keydownIndex);if(this.parent&&this.parent.grabFocus){this.parent.grabFocus(true);}if(R&&R.isAMSelector&&R.isAMSelector()){R.selectByKey=true;}if(R&&R.isPanelSelector&&R.isPanelSelector()){var a=R.parent;if(a&&a.addRestoreFocusFlag){a.addRestoreFocusFlag();}}}else{if(W.keyCode===mstrmojo.Enum_Keys.ESCAPE){b.cancel();b.preventDefault();this.close();if(this.parent&&this.parent.grabFocus){this.parent.grabFocus(true);}}else{if(W.keyCode===mstrmojo.Enum_Keys.TAB){this.close();}else{var X=new Date(),U=X.getTime(),c=W.key&&W.key.toLowerCase()||String.fromCharCode(W.keyCode).toLowerCase(),Y=this;if(this.lastKeydownTime===null){this.keydownString=c;}else{if(U-this.lastKeydownTime<this.keydownInterval){this.keydownString=this.keydownString+c;}else{this.keydownString=c;}}Q=this.keydownString;if(this._holdTimer){clearTimeout(this._holdTimer);}this._holdTimer=setTimeout(function(){Y.changeSelectedItem(b);Y.adjustPosition();},Y.keydownInterval);this.lastKeydownTime=U;}}}},changeSelectedItem:function F(Q){var U=this.selectedIndex,S=this.items&&this.items.length;if(S>0){var R;for(R=this.selectedIndex+1;R<this.items.length;R++){if(this.items[R].n.toLowerCase().indexOf(this.keydownString)==0){U=R;break;}}if(U===this.selectedIndex){for(R=0;R<this.selectedIndex;R++){if(this.items[R].n.toLowerCase().indexOf(this.keydownString)==0){U=R;break;}}}if(U!==this.selectedIndex){this.set("selectedIndex",U);}}},focus:function P(){this.domNode.focus();},adjustPosition:function D(){this.adjustCornersForPopupOverflow();this.scrollToSelectedItem();this.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.vi.util.A11yUtility","mstrmojo.ui._HasListTooltip");var D=mstrmojo.dom,R=mstrmojo.css,L=mstrmojo.vi.util.A11yUtility,K=mstrmojo.ui.PopupConfig.directionCfg;var S={};var N=false;function F(Z,Y){var X=Y?Z.nextElementSibling:Z.previousElementSibling;if(X&&X.classList.contains("separator")){X=F(X,Y);}return X;}function G(b,c){if(b.pop){if(c&&b.ax){window.clearTimeout(this._popupAxTimeout);b.actionFn();this.closeAllMenus();}else{var Z=b.fn.call(mstrmojo.all[b.scope],b.ctxt);if(this.hasAccessibility){Z.hasAccessibility=true;Z.navMode=this.navMode||(this.popupConfig&&this.popupConfig.navMode);}var a=Z.ENUM_CORNERS,Y=Z.maxHeight,X=D.getMaxScrollHeight();Z.setAlignment(a.TOP_RIGHT,a.TOP_LEFT);Z.hostId=this.id;Z.hostElement=this._getItemNode(b._renderIdx);Z.includeScroll=this.includeScroll;Z.supportsScroll=true;Z.alignWithAnchor=true;Z.isHostedWithin=false;Z.maxHeight=Y?Math.min(X,Y):X;this.openPopup(Z.newInstance());}}else{if(b.dsbld!==true){if(b.fn(b,this)!==false){this.closeAllMenus();}}}}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,accessibilityMenuContainer:function(){return this;},tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var Y=this.scrollNode;if(!Y){return ;}var X=D.getComputedScrollbarWidth(Y);Y.style.marginRight=-X+"px";Y.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function O(Z){this._super(Z);if(!!mstrApp.isWSStyling){this.themeClassName="mojo-theme-light";}if(Z.themeClassName){this.themeClassName=Z.themeClassName;}var X=this.popupConfig;this.items=X.getMenuItems();var Y=["mstrmojo-ui-Menu","unselectable"],a=X.menuCssClass;if(a){Y.push(a);}if(X.hasToggleItem){Y.push("hasToggleItem");}R.addWidgetCssClass(this,Y);if(X&&X.supportsScroll&&X.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+X.maxHeight+"px";}this.useRichTooltip=!!X.useTooltip;this.tstid=X.tstid;},markupMethods:{onvisibleChange:function M(){var X=this.visible;if(!N||X){R.toggleClass(this.domNode,"visible",X);}}},getItemMarkup:function C(c,Y){if(c.getItemMarkup){return c.getItemMarkup.apply(this,[c,Y]);}var a=!!c.pop,b=a?"submenu":"item",Z=S[b],X='<div class="micn"></div>';if(!Z){X+=!!mstrApp.isWSStyling?'<div class="mtxt">{@en@n}</div>':"{@en@n}";if(a){X+='<div class="arw"></div>';}Z=this._super(c,Y).replace("{@en@n}",X);S[b]=Z;}if(c.tstid){Z=Z.replace("{@tag}","{@tag} "+mstrmojo.tstid(c)+" ");}return Z;},getItemProps:function U(Z,X){var Y=this._super(Z,X);Y.tag="a";Y.addCls("mstrmojo-ui-Menu-item");Y.addCls(Z.cls);return Y;},onkeydown:function H(c){var Z=c.getTarget(),g=c.e.keyCode,a;switch(g){case 37:var b=this.opener,X=b.openerMenuElement;if(X){this.close();X.focus();delete b.openerMenuElement;}break;case 39:var h=this.items[Z.getAttribute("idx")].pop,e=this.xtab||this.opener.boxContent;if(h){this.openerMenuElement=Z;this.onclick(c);}if(e){e.isMenuClicked=true;}break;case 38:case 40:var Y=g===40;a=F(Z,Y);if(a){a.focus();}break;case 13:var h=this.items[Z.getAttribute("idx")].pop,e=this.xtab||this.opener.boxContent,f=e&&e.zone&&e.zone.tableNode;if(h){this.openerMenuElement=Z;}this.onclick(c);if(this.selectedItem.n==="Copy Rows"&&e){f.focus();}else{if(e){e.isMenuClicked=true;}}break;case 27:var b=this.opener,e=this.xtab||this.opener.boxContent,d=b.openerMenuElement||this.td||this.popupConfig.hostElement;if(d){this.actionByKeyboard=true;this.close();delete b.openerMenuElement;}if(e){e.isMenuClicked=false;}break;default:break;}c.e.preventDefault();c.e.stopPropagation();},onmouseover:function E(d){var b=d.config&&d.config.targetHostElement?d.config.targetHostElement:d.getTarget(),f=this.getItemFromTarget(b),c=this,Y=c._lastOpened,g=Y&&this.getItemFromTarget(Y.popupConfig.hostElement),X=g&&g._renderIdx,Z=this.getItemNodeFromTarget(b),a=(X!==undefined&&D.contains(this._getItemNode(X),b,true,this.domNode));if(f){this._lastHoverIx=f._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==X&&!a){this._popupTimeOut=window.setTimeout(function(){if(c._lastOpened&&c._lastOpened.visible){c.closePopup();}if(c.visible&&f.pop){if(f.ax){c._popupAxTimeout=window.setTimeout(function(){R.removeClass(Z,"hlt-ax");G.call(c,f);},0);}else{G.call(c,f);}}},400);if(f.pop&&f.ax){R.addClass(Z,"hlt-ax");}}}var e=this.popupConfig;if(e&&!e.isHostedWithin&&this.opener){this.opener.raiseEvent(mstrmojo._HasMarkup.newDomEvent(d.name,d.hWin,d.e,{targetHostElement:e.hostElement}));}},onclick:function W(X){this._evtTarget=X.getTarget();this.actionByKeyboard=L.isKeyBoardEvent(X.e);this._super(X);X.cancel();},postselectionChange:function I(X){var Y=X.added;if(Y){var Z=this.items[Y[0]];G.call(this,Z,!(Z.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function P(X){D.preventDefault(window,X.e);return false;},postBuildRendering:function Q(X){this._super(X);if(this.popupConfig.supportsScroll){var Y=this;window.setTimeout(function(){Y.updateScrollbars();},10);}},showTooltip:function B(b,a){var Z=D.eventTarget(a,b),Y=this.getItemNodeFromTarget(Z),X=this.getItemFromTarget(Z);this.itemDisabled=X&&X.dsbld;if(Y&&((X&&X.ttp)||(Y.scrollWidth>Y.clientWidth)||(Z.scrollWidth>Z.clientWidth))){this._super(b,a);}},onCloseMenuCallBack:null,onOpen:function J(){if(this._super){this._super();}if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}},onClose:function A(X){if(this._super){this._super(X);}this.closePopup();if(this.onCloseMenuCallBack){this.onCloseMenuCallBack();}if(this.navMode){var Z=this.popupConfig&&this.popupConfig.hostId,Y=Z&&mstrmojo.all[Z];if(Y){Y.raiseEvent({name:"menuClosed",needFocus:this.actionByKeyboard});}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],Z=["width","height"],p="p_fmts";var m="px";var k={getContentHeight:function(t,w){var u=w.ttl&&w.ttl.height;if(t&&u&&!this.floatingToolbar){return Math.max(parseInt(t,10)-parseInt(u,10),0)+m;}return"";},getPortletMinHeight:function(t){return t.ttl.height;},adjustTitleCss:function(){return ;}};var h={getContentHeight:function(t){return t;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(t){t.titlebarNodeClass+=" floating";return ;}};function A(x,u){var w=this.parent,t=x+"DirtyKey";if(w[t]){w[t](u);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function j(){var u=this.parent,x=u&&u.defn;if(x&&parseInt(x.t,10)===mstrmojo.EnumRWUnitType.PANEL){var t=u.parent,w=t.defn;if(w&&w.ifp){return t;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:k,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var u=this.content,t=u&&u.getFormats();return t&&t[p];},updateContentHeight:function f(y){var t=this.getFormats(),u=this.content,x=u.dimNode||u.domNode,w=((t.ttl&&parseInt(t.ttl.height,10))||0);if(x){if(!y){w+=((this.fc||this.isInFilterPanel())?x.offsetHeight:(t.height?parseInt(t.height,10):0));}this.containerNode.style.height=w+m;this.shadowNode.style.height=w+m;}},init:function q(t){this._super(t);var u=this.content;this.n=(t&&t.defn&&t.defn.n)||"";if(u&&u.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var u=this._ts=(this.floatingTitle)?h:k;if(this.isInFilterPanel()){var w=R.clone(this.formatHandlers);w.portletContainerNode=["z-index","height","B","backgroud-color"];w.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=w;}this._super();u.adjustTitleCss(this);var t="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=t;}if(!this.toolbar){this.toolbarNodeCssText+=t;}var x=mstrmojo._Formattable.getBorderWidths(this);if(x.l||x.t||x.r){this.borderCss="has-border";}},postBuildRendering:function a(){var AI=mstrmojo.dom,AD=this.titleNode,AK=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var AC=mstrmojo.css,AJ=this.contentNode,AL=this;if(!this._onhover){this._onhovertt=function(){AC.addClass(AL.titleNode,["visible"]);AL._onflt=true;return true;};this._onhoverofftt=function(){AC.removeClass(AL.titleNode,["visible"]);AL._onflt=false;return true;};this._onhover=function(){var AN=AL.titleNode;AC.addClass(AN,["visible"]);var AO=AI.position(AL.contentNode,true);AN.style.top=(AO.y-AN.clientHeight+2)+m;AN.style.left=AO.x+m;return true;};this._onhoveroff=function(){AC.removeClass(AL.titleNode,["visible"]);return true;};}AI.attachEvent(AJ,"mouseover",this._onhover);AI.attachEvent(AJ,"mouseout",this._onhoveroff);AI.attachEvent(AD,"mouseover",this._onhovertt);AI.attachEvent(AD,"mouseout",this._onhoverofftt);}if(AD&&AK){AI.attachEvent(AD,"click",AK);}if(this._super){this._super();}var AM=this.getFormats();this.set("fc",AM&&!AM.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var AF=this.portletContainerNode.style,AG=this.shadowNode.style,AB=this.parent;AF.width=AG.width="99%";AF.top=AG.top=AB.topStart+m;AF.left=AG.left=G+m;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(AM.left,10)+G*this.orgPos+m;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){var x=this.model.getZoomFactor();var AA=function(AN,t){if(!AN){return t;}return parseInt(AN,10)*x;};var u=this.buttonbarNode.getElementsByClassName("mstrmojo-Button mstrmojo-FilterPanel-Btn");var AE=8;var z=0;for(var AH=0;AH<u.length;AH++){var w=u[AH];var y=window.getComputedStyle(w);z=Math.max(z,AA(y.width,31));w.style.height=w.style.lineHeight=w.clientHeight*x+"px";w.style.fontSize=AE*x+"pt";w.style.marginTop=AA(y.marginTop,5)+"px";w.style.marginBottom=AA(y.marginBottom,5)+"px";w.style.borderRadius=AA(y.borderRadius,12)+"px";w.style.borderWidth=AA(y.borderWidth,1)+"px";}for(var AH=0;AH<u.length;AH++){u[AH].style.width=z+"px";}}},adjustFPHeight2Fit:function(){var w=mstrmojo.dom,t=w.position(this.titleNode),u=w.position(this.contentNode).y-t.y-t.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-u+"px";},unrender:function E(w){if(this.floatingTitle&&this.titleNode){var y=this.domNode,u=this.titleNode,x=mstrmojo.dom;if(y&&this._onhover){x.detachEvent(y,"mouseover",this._onhover);}if(y&&this._onhoveroff){x.detachEvent(y,"mouseout",this._onhoveroff);}if(u&&this._onhovertt){x.detachEvent(u,"mouseover",this._onhovertt);}if(u&&this._onhoverofftt){x.detachEvent(u,"mouseout",this._onhoverofftt);}if(u){document.body.removeChild(u);}}if(this._super){this._super(w);}},updateStyle:function(u,t){var y=this.shadowNode.style,x=this.containerNode.style;y.height=x.height=u;y.width=x.width=t;},_createFormats:function X(){var z=this.content&&this.content.getFormats(),x;x=z.p_fmts={};var t,y;for(t in Q){y=Q[t];if(z[y]!==undefined){x[y]=z[y];delete z[y];}}for(t in Z){y=Z[t];if(z[y]!==undefined){x[y]=z[y];}}z.height=this._ts.getContentHeight(z.height,x);if(mstrmojo.dom.isIE&&x.fx&&x.fx.ds&&!x["background-color"]){x["background-color"]="#ffffff";}var w=x.ttl,u=w&&w["background-color"];if(u){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(u,"light","dark");}},refresh:function s(){if(!this.hasRendered){return ;}var u=this.children,t;for(t=u.length-1;t>=0;t--){u[t].refresh();}},isInFilterPanel:function L(){return(j.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var t=this.getFilterPanel();return t&&t.defn&&parseInt(t.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return j.call(this);},getContainerHeight:function e(){return this.containerNode.clientHeight;},relocate:function C(t){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=t+m;}},setInfoWindowDimensions:function o(y){var u=this.domNode.style,t=this.shadowNode.style,w=this.portletContainerNode.style,x=mstrmojo._Formattable.getBorderWidths(this);y.h-=x.h;y.w-=x.w;t.height=w.height=u.height=y.h+m;t.width=w.width=u.width=y.w+m;y.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(t){A.call(this,"add",t);},removeDirtyKey:function J(t){A.call(this,"remove",t);},setDirtyChildren:function b(){var t=this.content;if(t&&t.setDirtyChildren){t.setDirtyChildren.apply(t,arguments);}}});var Y=0,O=1,l=2;function N(t){var u=this.content.defn;if(u){u.set("ds",t);}}function n(t){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:t}};}function c(AG,AE,t,AH){var AC=this.content,AF=AC.k,AB=mstrmojo.boxmodel.px2Inches,x=AC.model.docModel||AC.model,AJ=x.getZoomProps(),y=this.getFormats(),u=AE!==undefined&&t!==undefined,AI={},z=this,AA=n.call(this,AG),AD=!(AC.defn.t===mstrmojo.EnumRWUnitType.GRIDGRAPH||AC.defn.t===mstrmojo.EnumRWUnitType.GRAPH);if(u){AA.FormattingSize={OldHeight:AB(AJ,AE),OldWidth:AB(AJ,t),Height:AB(AJ,parseInt(y.height,10)),Width:AB(AJ,parseInt(y.width,10))};}AI.success=function(w){var AK=w&&w.data;if(AK){x.loadPartialData(AK,AF);}N.call(z,AG);var AL=z.parent;if(AL.adjustSectionSize&&u){AL.adjustSectionSize();}};x.updateUnitFormat(AC,1,AA,AI,{params:{suppressData:AD,rapidExec:AD},config:u?null:{silent:true},preserveUndo:true});if(!u&&!(AH&&AH.all)){if(x.saveRWProps){x.saveRWProps(AF,undefined,1,this.loadDataOnResize,AI,true);}}}function U(){var AA=this.content;if(!AA){return ;}var y=function(AE){mstrmojo.array.forEach(AE,function(AF){if(AF.ds!==undefined){AF.set("visible",(AF.ds!==AA.defn.ds));}});},AB;if(this.isInFilterPanel()){var w=(parseInt(this.defn.ds,10)===Y);AA.set("visible",w);this.updateContentHeight(!w);AB=this.leftToolbar;y(AB&&AB.children);var x=this.parent;if(x.refreshFP){x.refreshFP();}}else{var t=AA.getFormats(),AC=this.getFormats(),u=this.portletContainerNode.style,AD=this.shadowNode.style,z=this.contentNode.firstChild.style;z.height=t.height;z.width=t.width;AD.height=u.height=AC.height;AD.width=u.width=AC.width;AD.top=u.top=AC.top;AD.left=u.left=AC.left;if(AC["z-index"]!==undefined){AD.zIndex=u.zIndex=AC["z-index"];}AB=this.rightToolbar;y(AB&&AB.children);if(AA.resize){AA.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function X(){this._super();var u=this.getFormats();var t=parseInt(this.defn.ds,10);if(t===Y){u.normHeight=u.height;u.normWidth=u.width;if(u["z-index"]!==null&&u["z-index"]!==undefined){u.normZIndex=u["z-index"];}}if(t!==l){u.normTop=u.top;u.normLeft=u.left;}},onmaximize:function g(){var x=this.parent,AA=this.content,z=AA&&AA.getFormats(),w=this.getFormats(),u=w.height,t=w.width,y=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AA.clearCache();w.height=(parseInt(x.getHeight(),10)-y.h)+m;z.height=this._ts.getContentHeight(w.height,w);w.width=z.width=(x.getWidth()-y.w)+m;w.top=w.left=0;w["z-index"]=x.getMaxZIndex()+1;c.call(this,l,u,t);},onminimize:function d(){var z=this.content,u=z.dimNode||z.domNode,y=z&&z.getFormats(),x=this.getFormats(),w=x.height||u.offsetHeight,t=x.width;this.clearCache();z.clearCache();x.width=y.width=x.normWidth;x.top=x.normTop;x.left=x.normLeft;if(x.normZIndex!==null&&x.normZIndex!==undefined){x["z-index"]=x.normZIndex;}y.height=0;x.height=this._ts.getPortletMinHeight(x);c.call(this,O,w,t);},onrestore:function S(){var y=this.content,x=y&&y.getFormats(),w=this.getFormats(),u=w.height,t=w.width;this.clearCache();y.clearCache();w.height=w.normHeight;x.height=this._ts.getContentHeight(w.height,w);w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}c.call(this,Y,u,t);},changeWindowState:function I(x){N.call(this,x);var u=this.content,y=n.call(u,x),t=u.model.docModel||u.model;return t.getUnitFormatAction(u,1,y);},oncollapse:function W(t){c.call(this,O,undefined,undefined,t);},onexpand:function D(t){c.call(this,Y,undefined,undefined,t);},adjustFP:function i(){var u=(parseInt(this.defn.ds,10)===Y);this.content.set("visible",u);this.updateContentHeight(!u);var t=this.parent;if(t.refreshFP){t.refreshFP();}},postBuildRendering:function a(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,U);}this._super();if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===Y);this.updateContentHeight(!t);}}});mstrmojo.DocPortlet.ST_RESTORE=Y;mstrmojo.DocPortlet.ST_MAX=l;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent","mstrmojo.ui.editors.OAuthErrorDialogContent","mstrmojo.vi.ui.rw._SupportTabNav","mstrmojo.vi.util.A11yUtility");var n=mstrmojo.func.composite,M=mstrmojo.dom,d=mstrmojo.Button.newWebButton,D=mstrmojo.css,c=mstrmojo.all,N=mstrmojo.hash,a=mstrmojo.array,f=mstrmojo.vi.util.A11yUtility;function Z(w){if(!this.modal){return ;}var x=window.mstrApp;if(x&&x.modalEditorChange){x.modalEditorChange(this.id,w);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme,mstrmojo.vi.ui.rw._SupportTabNav],{scriptClass:"mstrmojo.Editor",title:"",allowHTMLTitle:false,help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,onEditorResized:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" tabindex="-1" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu,keydown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function b(){return this.domNode.firstChild;},titleContainerNode:function o(){return this.domNode.firstChild.firstChild;},titlebarNode:function q(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function U(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function s(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function W(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function t(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.allowHTMLTitle?this.title:mstrmojo.string.encodeHtmlString(this.title);}},onzIndexChange:function(){var w=this.zIndex;this.editorNode.style.zIndex=w;this.curtainNode.style.zIndex=w-1;},onvisibleChange:function(z){if(z){return ;}var y=this.visible,x="closeEffect",w="none";if(y){x="openEffect";w="block";}if(this[x]){this.playEffect(x);}else{this.editorNode.style.display=w;if(this.modal){this.curtainNode.style.display=w;}}},onhelpChange:function i(){if(this.showTitle){var x=this.help,w=this.helpNode;if(!x){w.style.display="none";}else{w.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function S(x,w){this._super(x,w);Z.call(this,true);},close:function l(w){this._super(w);Z.call(this,false);},unrender:function B(w){this._super(w);Z.call(this,false);},destroy:function m(w){this._super(w);Z.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;Z.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},postBuildRendering:function P(){this._super();if(this.accessibilityHook){this.accessibilityHook();}},getMovingHandle:function p(){return this.titlebarNode;},getMovingTarget:function Y(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function R(w){var x=w.getTarget();if(x===this.closeNode||x===this.helpNode){D.toggleClass(x,"active",true);}},premouseup:function Q(w){var x=w.getTarget();if(x===this.closeNode||x===this.helpNode){D.toggleClass(x,"active",false);}if(w.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function h(w){if(w.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{var x=(mstrApp.isWorkstationPlugin?((mstrApp.helpUrl||"../help/")+"WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/Content/"):mstrmojo.helpPath())+(this.help||"");if(typeof workstation!=="undefined"&&mstrApp.openHelpLink){mstrApp.openHelpLink(x);}else{window.open(x,"_blank");}return false;}}},onkeydown:function O(w){if(!this.enableAccessibility){return ;}this.handleTab(w);if(!this.exitByKeyBoard){return ;}var y=w.e,x=y.keyCode;if(x===mstrmojo.Enum_Keys.ESCAPE){this.exitByKeyBoard(w);w.cancel();w.preventDefault();}},suppressClose:function(){return false;},_set_visible:function g(AB,y){var x=(this[AB]!==y);if(x){this[AB]=y;var AA=this._close_handler;if(y){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var z=this;AA=this._close_handler=AA||function(AC){var AD=M.eventTarget(self,AC);if(!z.suppressClose()&&AD&&AD.parentNode&&!M.contains(z.editorNode,AD,true,document.body)){z.close();}};M.attachEvent(document.body,"mousedown",AA);}}else{var w=this._curtain_handler;if(w){M.detachEvent(window,"resize",w);}if(AA){M.detachEvent(document.body,"mousedown",AA);}}}return x;},showTooltip:function u(AB,AA){var z=this,x=M.findAncestorByAttr(M.eventTarget(AA,AB),"tooltip",true,this.domNode),y=x&&x.value;if(!z.hasOpenTooltip&&y){var w=M.position(x.node);z.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:y,top:Math.max(w.y+40,0),left:Math.max(w.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(AB,AA);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(w){w=Math.round(w);return["rgb(",w,",",w,",",w,")"].join("");}}},preStart:function(){var x=this.target,w=this.widget;w.editorNode.style.display="block";if(!w.modal){return false;}x.style.display="block";D.setOpacity(x,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var w=this.widget;w.editorNode.style.display="none";return !!w.modal;}};function C(w){return function(){c[w].destroy();};}function J(x,AE,AF,AG){var w=AE.id||"mojoAlertx9",AB,AD=AE.buttons;a.forEach(AD,function(AI){var AH=AI.onclick;AI.onclick=function(AJ){var AK=c[w];if(AH&&AH.call(AI,AJ)===false){return ;}AK.destroy();if(AE.enableAccessibility&&AE.navMode&&AE.docModel){AE.docModel.raiseEvent({name:"dialogClosed",dialogName:"exportPDF",needFocus:f.isKeyBoardEvent(AJ.e)});}AK=null;};});try{!!c[w]&&c[w].destroy();}catch(AC){}var y=AE.cssClass,z=[];if(y){z.push(y);delete AE.cssClass;}if(AG){z.push(AG);}z.push("mstrmojo-alert");AB={scriptClass:"mstrmojo.Editor",id:w,width:"475px",zIndex:1000,title:AF||mstrmojo.desc(11812,"Notification"),cssClass:z.join(" "),children:[{scriptClass:"mstrmojo.Box",cssClass:AE.boxCSS||"alert-content",children:[{scriptClass:"mstrmojo.Label",text:x,arialLabel:AE.arialLabel,allowHTML:AE.allowHTML}]}],visible:true};var AA=new mstrmojo.Editor(N.copy(AE,AB));AA.render();return AA;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(x,AD,y){y=y||{};var AE=y.forceClose,AC=y.callback||mstrmojo.emptyFn,AB=N.copy(AD||{},{buttons:AE?[mstrmojo.Button.newActionButton((y.buttonText||mstrmojo.desc(8607,"Dismiss")),AC)]:null,showTitle:false,modal:false,top:"42px"}),z=y.duration||6000;var AA=J(x,AB,"",AE?"ed-notify":"ed-toast"),w=AA.id;if(!AE){window.setTimeout(n([AC,C(w)]),z);}else{window.setTimeout(function(){if(c[w]){c[w].editorNode.style.opacity=0.75;}},6000);}return AA;};mstrmojo.confirm=function k(w,AC,AE){AC=AC||{};var y=AC.confirmBtn||{},AB=AC.cancelBtn||{},AD=y.hot!==false,x=!!AB.hot,AA=AE&&AE.title,z=[d(y.t||mstrmojo.desc(219,"Yes"),y.fn,AD,y.cfg),d(AB.t||mstrmojo.desc(218,"No"),AB.fn,x,AB.cfg)];return J(w,N.copy(AE||{},{buttons:z,onPreClose:function(){if(AB&&AB.fn){AB.fn();}return true;}}),AA,[]);};mstrmojo.warn=function K(y,w,x){x=x||{};x.cssClass=(x.cssClass||"")+" mstrmojo-warning";return mstrmojo.confirm(y,w,x);};mstrmojo.alert=function e(AB,y,AA,AC,w,z){var x={title:AA||mstrmojo.desc(12405,"Alert"),zIndex:AC,cssClass:w,buttons:[d(mstrmojo.desc(1442,"OK"),y,true)],onPreClose:function(){if(y){y();}return true;}};N.forEach(x,function(AE,AD){if(!AE){delete x[AD];}});return J(AB,N.copy(z,x),AA,[]);};mstrmojo.error=function X(AB,x,AA){var y=AB||{};var z=mstrmojo.desc(96,"Error");var w=true;if(AA){z=(AA.title)?AA.title:mstrmojo.desc(96,"Error");AA.title=z;if(AA.enableContactStr===false){w=false;}}J("",N.copy(AA||{},{buttons:[d(mstrmojo.desc(1442,"OK"),x,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:y.shortDesc,longDesc:y.longDesc,showToggle:!!(y.longDesc),enableContactStr:w,allowHTML:!!(AA&&AA.allowHTML===true)}]}),z,[]);};mstrmojo.oauthError=function j(x,AB,w,AA){var y=AB||{};var z=mstrmojo.desc(11812,"Notification");if(AA){z=AA.title||z;AA.title=z;}J("",N.copy(AA||{},{buttons:[d(mstrmojo.desc(1442,"OK"),w,true)],children:[{scriptClass:"mstrmojo.ui.editors.OAuthErrorDialogContent",shortDesc:y.shortDesc,longDesc:y.longDesc,source:x,showToggle:!!(y.longDesc),allowHTML:true}]}),z,[]);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller");function b(h){var j=document.createElement("div"),i=j.style,g=h.domNode;j.className="mstrmojo-DataGrid-avatar";i.height=g.clientHeight+"px";g.appendChild(j);h.avatar=j;return j;}function Q(g){var h=mstrmojo.dom.position(g.domNode,true);return h.x;}function O(g){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+g+'"></div>';}function d(i){var h=i.getAttribute("rh"),g=h&&parseInt(h,10);return g;}function a(h,k,g){var j=g.src,l=j&&j.data,i=l&&l.resizingIdx;if(!(i&&i>0)){return k&&k.apply(h,[g]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(j,i){var g=j.colSizeArray;var h=[-g[i-1]+j.minColWidth,(i==g.length-1)?g[i]-j.resizeHandleWidth-j.minColWidth:g[i]-j.minColWidth];return h;},updateSize:function F(j,i,h){var g=j.colSizeArray;g[i-1]=g[i-1]+h;g[i]=g[i]-h;},updateColumnWidth:function U(j,h,k,i){var g=j.colSizeArray;h[i-1].style.width=g[i-1]+"px";k[i-1].style.width=g[i-1]+"px";h[i].style.width=g[i]+"px";k[i].style.width=g[i]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(k,o,h){var n=k.minColWidth+k.resizeHandleWidth,l=k.colSizeArray;l[o-1]=l[o-1]+h;var g=[];for(var j=0;j<l.length-o;++j){g[j]=o+j;}g.sort(function(i,q){return l[i]-l[q];});for(var j=0;j<g.length;++j){var p=h/(g.length-j);var m=l[g[j]];h-=(m>=p+n)?p:m-n;l[g[j]]=(m>=p+n)?m-p:n;}},updateColumnWidth:function U(l,h,m,k){var g=l.colSizeArray;for(var j=k-1;j<g.length;++j){h[j].style.width=g[j]+"px";m[j].style.width=g[j]+"px";}}};mstrmojo.RESIZE_CURRENT_COLUMN_MODE={getRange:function G(m,l){var n=m.minColWidth+m.resizeHandleWidth,g=m.colSizeArray,j=0;for(var k=l;k<g.length;++k){j+=g[k]-n;}var h=[-g[l-1]+n,j];return h;},updateSize:function F(j,i,h){var g=j.colSizeArray;g[i-1]=g[i-1]+h;},updateColumnWidth:function U(j,h,k,i){var g=j.colSizeArray;h[i-1].style.width=g[i-1]+"px";k[i-1].style.width=g[i-1]+"px";j.widgetResized();}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function e(){var h,m,k,j,l,g;m=this.headerContainerNode;k=m&&m.getElementsByTagName("table")[0];j=k.rows[0].cells;h=[];for(l=0,g=j.length;l<g;l++){h.push(j[l].offsetWidth);}return h;},postBuildRendering:function X(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(g){var i=g.src,j=i.node,h=d(j);if(h&&h>0){return{resizingIdx:h,startingX:i.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(g);}return null;},allowDrop:function K(g){var i=g.src,j=i&&i.data,h=j&&j.resizingIdx;if(h&&h>0){return true;}return this.dropZone;},ondragenter:function R(g){a(this,this._super,g);},ondragover:function S(g){a(this,this._super,g);},ondragleave:function B(g){a(this,this._super,g);},ondrop:function Y(g){a(this,this._super,g);},isDragValid:function C(g){var i=g.src,j=i&&i.data,h=j&&j.resizingIdx;if(h&&h>0){return true;}if(this._super){return this._super(g);}return false;},ondragstart:function Z(g){var j=g.src,k=j&&j.data,i=k&&k.resizingIdx;if(i&&i>0){var h=this.avatar||b(this);this.ownAvatar=true;h.style.left=(k.startingX-k.baseX)+"px";h.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}k.resizingRange=this.resizeColumnBehavior.getRange(this,i);return ;}if(this._super){this._super(g);}},ondragmove:function P(h){var o=h.src,i=o&&o.data,m=i&&i.resizingIdx;if(m&&m>0){var n=h.tgt,j=this.avatar,l=i.resizingRange,k=n.pos.x-i.startingX,g=Math.min(l[1],Math.max(k,l[0]));i.deltaX=g;if(j){j.style.left=(i.startingX-i.baseX+g)+"px";}}else{if(this._super){this._super(h);}}},ondragend:function L(l){var u=l.src,m=u&&u.data,q=m&&m.resizingIdx;if(q&&q>0){var g=this.titleColGroup,t=g&&g.childNodes,o=this.dataColGroup,p=o&&o.childNodes,k=t.length,n=this.colSizeArray,h=m.deltaX;this.resizeColumnBehavior.updateSize(this,q,h);if(this._firstTimeResize){var j;for(j=0;j<k;j++){t[j].style.width=n[j]+"px";p[j].style.width=n[j]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,t,p,q);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(l);}}}});mstrmojo.requiresCls("mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(j){var m=document.createElement("colgroup"),g=j.length,h,l;for(l=0;l<g;l++){var k=document.createElement("col");h=j[l];if(h.colWidth){k.style.width=h.colWidth+"px";}k.className=h.colCss||("col"+l);m.appendChild(k);}return m;}function I(h){var j=h._headerWidgets_,g=j&&j.length;if(g>0){var k;for(k=0;k<g;k++){j[k].destroy(true);}}}function A(k,g,j,m,h){var i=[],l=k.headerWidget;j=j?(" "+j):"";m=m||this._headerWidgets;h=h?(" "+h):' w="1"';i.push("<td"+j+">");if(g>0&&this.resizableColumns){i.push(O(g));}i.push('<div class="mstrmojo-DataGrid-headerText');i.push(k.headerCss?" "+k.headerCss:"");if(l){m.push(mstrmojo.hash.copy(l));i.push('"'+h+">");}else{i.push('">');}i.push(k.headerText||"&nbsp");i.push("</div>");i.push("</td>");return i.join("");}function c(g,o){var j,m,n,h,p,l,k=[];g=g||"_headerWidgets";o=o||"1";j=this[g];m=j.length;if(m>0){n=this.headerContainerNode.getElementsByTagName("div");h=mstrmojo.array.filter(n,function(i){return i.getAttribute("w")==o;});for(l=0;l<m;l++){j[l].placeholder=h[l].firstChild;j[l].dataGrid=this;p=mstrmojo.registry.ref(j[l]);p.render();k.push(p);}}this[g+"_"]=k;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},shouldDisableItem:function(){return false;},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;},headerRows:function(){return this.domNode.firstChild.firstChild.rows;},bodyRows:function(){return this.domNode.lastChild.firstChild.firstChild.rows;}},markupMethods:{oncontentWidthChange:function(){var h=this.contentWidth,i=this.headerContainerNode,g=this.itemsContainerNode;if(h&&i&&g){i.style.width=h;g.style.width=h;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(i,g,h){var j=new mstrmojo.DataRow({columns:h.columns,data:i,disable:h.shouldDisableItem(i),idx:g,dataGrid:h,parent:h});return j;},preBuildRendering:function D(){var m=this.renderHook;if(m&&m.pre){m.pre.apply(this,[A]);}else{var h=this.columns,g=h.length,j=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],l;this._headerWidgets=[];var k;for(k=0;k<g;k++){l=A.apply(this,[h[k],k]);j.push(l);}j.push("</tr></table>");this.headerHtml=j.join("");}if(this._super){this._super();}},postBuildRendering:function X(){if(this._super){this._super();}var i=this.renderHook;if(i&&i.post){i.post.apply(this,[J,c]);}else{c.apply(this);this.titleColGroup=J(this.columns);}var g=this.titleColGroup,n=g.cloneNode(true),k=this.headerContainerNode,m=k&&k.getElementsByTagName("table")[0],o=this.itemsContainerNode,l=this.scrollboxNode,j=this.domNode,h=o&&o.getElementsByTagName("table")[0];this.dataColGroup=n;if(m&&h){m.insertBefore(g,m.firstChild);h.insertBefore(n,h.firstChild);}if(this.lockHeader){l.style.height=j.offsetHeight-k.offsetHeight+"px";mstrmojo.dom.attachEvent(l,"scroll",function(p){k.style.left=-l.scrollLeft+"px";});}},refresh:function H(g){I(this);if(this._super){this._super(g);}},destroy:function f(g){I(this);this._super(g);},unrender:function W(l){var j=this._headerWidgets_,h=j&&j.length,g;if(h>0){var k;for(k=0;k<h;k++){g=j[k];if(g&&g.hasRendered){g.unrender(true);}}}this._super(l);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",dataTextCSSClass:"mstrmojo-DataRow-text",columns:null,disable:false,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var n=document.createElement("tr"),s=this.data,x=this.idx,h=this.dataGrid,o=this.cssClass,z=this.columns,g=this.children,k=this.disable,j,t=-1,y,u;n.setAttribute("id",this.id);if(h.banding){o+=(x%2==1)?" odd":" even";}n.className=o+(mstrmojo.string.isEmpty(s[h.itemDisplayField||"n"])?" empty-row":"")+(" "+s[h.itemCSSField||"itemCss"]||"")+(k?" disabled":"");var m,q;for(m=0,q=z.length;m<q;m++){y=z[m];u=(y.dataWidgetBuilder&&y.dataWidgetBuilder(s))||y.dataWidget;j=document.createElement("td");if(y.applyStyle2Cell&&y.colCss){j.setAttribute("class",y.colCss);}n.appendChild(j);if(u){j.setAttribute("w","1");t++;g.push(mstrmojo.hash.copy(u,{slot:"slot"+t,data:s,idx:x,dataGrid:h}));}else{if(y.dataFunction){j.innerHTML=y.dataFunction(s,x,h);}else{var l=mstrmojo.string.htmlAngles(s[y.dataField||"n"])||"&nbsp",p=y.tooltip?' title="'+l+'"':"";j.innerHTML='<div class="'+this.dataTextCSSClass+'" '+p+">"+l+"</div>";}}}this.initChildren();n.mstrmojoId=this.id;return n;},buildRendering:function N(){this._super();var l=this.domNode.childNodes,g=l.length,k={},j=0,m,h;for(h=0;h<g;h++){m=l[h];if(m.getAttribute("w")=="1"){k["slot"+j]=m;j++;}}this.addSlots(k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var E=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function C(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=E.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(!mstrApp.isWorkstationPlugin||E.position(K).w||E.position(K).h){if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Box","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.Checkbox","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.enums.EnumPromptType");var G=mstrmojo.array,E=mstrmojo.hash,D=mstrmojo.string,F=mstrmojo.vi.enums.EnumFeatures,B=mstrmojo.vi.enums.EnumPromptType;var A="ANY_OTHER_PROMPTS";var C={USE_THE_SAME_ANSWER_FROM_THE_SOURCE_PROMPT:1,PROMPT_USER:2,IGNORE_THE_PROMPT:3,USE_THE_SELECTED_OBJECT_AS_THE_PROMPT_ANSWER:4,USE_THE_DEFAULT_ANSWER:8,USE_FILTER_PANEL_SELECTIONS:10};mstrmojo.ui.editors.controls.PromptAndAnswerList=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ui.editors.controls.PromptAndAnswerList",cssClass:"prompts-wrapper",visible:false,prompts:[],aopam:C.PROMPT_USER,fromVis:false,onAnswerChange:mstrmojo.emptyFn,promptList:undefined,promptAnswersPulldown:undefined,selectedPromptId:undefined,init:function(H){this._super(H);this.prompts=E.clone(H.prompts||[]);this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(17001,"Choose prompt")},this.getPromptList(),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(17002,"Answer prompt")},this.getPromptAnswersPulldown()]);},setStateOfPrompts:function(){if(this.prompts.length>0){this.promptList.set("items",this.generatePromptItems());this.promptList.set("selectedIndex",0);this.selectedPromptId=this.prompts[0].id;this.setSelectedPromptAnswer();}else{this.promptList.set("items",[]);this.promptList.set("selectedIndex",-1);this.selectedPromptId=undefined;}},postpromptsChange:function(){this.prompts=E.clone(this.prompts||[]);this.setStateOfPrompts();},postaopamChange:function(){this.setStateOfPrompts();},generatePromptItems:function(){var H=this;return G.map(this.getRealPrompts(),function(I){return{n:D.apply('<span class="prompt-name" title="{@name} ({@am})">{@name}</span><span class="answer-mode" title="{@name} ({@am})">({@am})</span>',{name:I.nm,am:(G.filterOne(H.getAnswerList(I),function(J){return J.id===I.am;})||{}).n})};});},setSelectedPromptAnswer:function(){var H=this.getPromptInfo(),I=this.getAnswerList(H);this.promptAnswersPulldown.set("items",I);this.promptAnswersPulldown.set("selectedIndex",G.find(I,"id",H.am));},getPromptAnswer:function(I){if(I===A){return this.aopam;}var H=this.getPromptIndex(I);if(H!==-1){return this.prompts[H].am;}return undefined;},getAnswerList:function(H){var J=1,I=[{n:mstrmojo.desc(17350,"Prompt user"),id:C.PROMPT_USER},{n:mstrmojo.desc(17349,"Use the default answer"),id:C.USE_THE_DEFAULT_ANSWER},{n:mstrmojo.desc(17351,"Ignore the prompt"),id:C.IGNORE_THE_PROMPT}];if(H&&(H.id===A||H.hsp)){I.splice(1,0,{n:mstrmojo.desc(17348,"Use the same answer from the source prompt"),id:C.USE_THE_SAME_ANSWER_FROM_THE_SOURCE_PROMPT});}if(H&&H.pt===B.ATTRIBUTE_LELMENT_LSIT&&this.fromVis){I.splice(1,0,{n:mstrmojo.desc(17352,"Use the selected object as the answer"),id:C.USE_THE_SELECTED_OBJECT_AS_THE_PROMPT_ANSWER});J=2;}if(mstrApp.supportFeature(F.SUPPORT_ANSWER_PROMPT_WITH_FILTER_PANEL_SELECTIONS)&&H&&H.orid&&(H.pt===B.ATTRIBUTE_LELMENT_LSIT||H.pt===B.EXPRESSION)){I.splice(J,0,{n:mstrmojo.desc(20144,"Use the filter panel selection(s) as the answer"),id:C.USE_FILTER_PANEL_SELECTIONS});}return I;},getPromptInfo:function(H){H=H===undefined?this.selectedPromptId:H;return G.filterOne(this.getRealPrompts(),function(I){return I.id===H;});},getPromptIndex:function(H){H=H===undefined?this.selectedPromptId:H;return G.find(this.getRealPrompts(),"id",H);},getRealPrompts:function(){return this.prompts.concat({id:A,am:this.aopam,nm:mstrmojo.desc(17000,"Any other prompts")});},getPromptList:function(){var J=this,K,I=this.generatePromptItems();this.promptList=new mstrmojo.ui.ScrollableList({cssClass:"target-prompts",allowHTML:true,items:I,postitemsChange:function(){if(this.scrollNode){this.scrollNode.scrollTop=K;}},selectionAdded:function(M){if(M.added.length===0){return ;}var L=M.added[0],N=J.getRealPrompts()[L].id;if(J.selectedPromptId===N){return ;}J.selectedPromptId=N;J.setSelectedPromptAnswer();}});var H=this.promptList.set;this.promptList.set=function(M,L){if(M==="items"){K=this.scrollNode?this.scrollNode.scrollTop:0;}return H.call(this,M,L);};return this.promptList;},getPromptAnswersPulldown:function(){var H=this;this.promptAnswersPulldown=mstrmojo.ui.Pulldown.newPulldown(this.getAnswerList(),function(I){if(H.getPromptAnswer(H.selectedPromptId)===I.id){return ;}H.setPromptAnswer(H.selectedPromptId,I.id);H.promptList.set("items",H.generatePromptItems());H.promptList.set("selectedIndex",H.getPromptIndex());},0);return this.promptAnswersPulldown;},setPromptAnswer:function(J,I){if(J===A){this.aopam=I;this.onAnswerChange(true,I);return ;}var H=this.getPromptIndex(J);if(H!==-1){this.prompts[H].am=I;this.onAnswerChange(false,E.clone(this.prompts));}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.EnumSubtotals");var F=mstrmojo.array,B=mstrmojo.EnumSubtotals.TYPES;function C(I,H){var G=H?I.nextElementSibling:I.previousElementSibling;if(G&&G.classList.contains("separator")){G=C(G,H);}return G;}mstrmojo.express.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:true,accessibilityMenuContainer:function(){return this;},init:function E(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-subtotals");},_set_selectedItems:function(J,H){var G=[],I=this.prevSelection={};F.forEach((H||[]),function(K){G.push(K.t);});F.forEach(G,function(K){I[K]=true;});this.setSelectedItems(F.filter(this.items,function(K){return F.indexOf(G,K.v)>-1;}));},onkeydown:function D(R){var K=R.getTarget(),U=R.e.keyCode,N;var H=function(){var X=window.event,e=X.keyCode,c=mstrmojo.dom.findWidget(this.offsetParent),Y=mstrmojo.dom.findWidget(c.containerNode.firstChild),W=Y.itemsNode,f=this.parentElement.childNodes[0],b=this.parentElement.childNodes[1],d=null,a=this.textContent==="OK";switch(e){case 9:if(!X.shiftKey){d=a?b:W;break;}d=a?W:((f.classList.contains("disabled"))?W:f);break;case 13:var Z=c.opener&&c.opener.td;this.onclick(X);if(this===b&&Z){Z.focus();}break;default:X.stopPropagation();}if(d){if(d!==W){d.setAttribute("tabindex","-1");d.setAttribute("role","button");mstrmojo.dom.attachEvent(d,"keydown",H);}d.focus();}X.preventDefault();X.stopImmediatePropagation();};switch(U){case 37:case 27:var M=this.parent,P=M.opener,G=P.openerMenuElement;if(G){M.close();G.focus();delete P.openerMenuElement;}break;case 39:break;case 38:case 40:var J=U===40?true:false;N=C(K,J);if(N){N.focus();}break;case 13:var O=K.getAttribute("aria-checked")==="true";K.setAttribute("aria-checked",!O);this.onclick(R);break;case 9:var Q=mstrmojo.dom.findWidget(this.domNode.offsetParent),I=Q.btnNode&&Q.btnNode.hasChildNodes(),L=I&&Q.btnNode.children,S;if(K.classList.contains("item")){if(I&&!L[0].classList.contains("disabled")){S=L[0];}else{if(I){S=L[1];}}}if(S&&S.classList.contains("mstrmojo-WebButton")){mstrmojo.dom.attachEvent(S,"keydown",H);S.setAttribute("role","button");S.setAttribute("tabindex","-1");S.focus();}R.e.preventDefault();break;default:R.e.preventDefault();break;}R.e.stopPropagation();},getSubtotalTypes:function A(){var I=this.items,J=this.selectedIndices,L=this.prevSelection,H=I.filter(function(N,M){return J[M]&&!L[N.v];}),K=I.filter(function(N,M){return !J[M]&&L[N.v];}),G=function(M){return M.v;};return[H.map(G),K.map(G)];},items:B});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.ui._IsHierarchyList","mstrmojo.css","mstrmojo.array","mstrmojo.EnumSelectionType");var R=mstrmojo.css,J=mstrmojo.array,A=mstrmojo.EnumSelectionType;var N="selected",Q="dynamic",P="expanded",F="collapsed";function O(Y){this.updateBtnSelectionStatus(Y);J.forEach(Y.children,function(Z){O.call(this,Z);},this);}mstrmojo.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsHierarchyList],{scriptClass:"mstrmojo.ui.HierarchyCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="header"></div><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div><div class="footer"></div></div>',markupSlots:{headerNode:function E(){return this.domNode.firstChild;},footerNode:function C(){return this.domNode.lastChild;},scrollboxNode:function H(){return this.domNode.children[1];},itemsContainerNode:function S(){return this.domNode.children[1].firstChild;}},getItemMarkup:function D(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></{@tag}>';},getItemProps:function U(a,Y){var Z=this._super(a,Y);if(a.isSelected){Z.addCls(N);}if(this.isHiearachyDisplay()){if(a.hcd){Z.addCls(a.epd?P:F);}}return Z;},setupScrollNodes:function I(){this.scrollNode=this.scrollboxNode;var Y=this.domNode.clientHeight-this.headerNode.clientHeight-this.footerNode.clientHeight;if(Y>0){this.scrollNode.style.height=Y+"px";}},onclick:function X(Y){var a=Y.getTarget(),b=this.getItemNodeFromTarget(a),Z=this.getItemFromTarget(a);if(Z){if(R.hasClass(a,"triangle")){if(Z.hcd){this.doExpandCollapse(b,Z);}}else{if(!R.hasClass(a,"indent")){this.doBranchSelect(b,Z,!Z.isSelected);}}Y.cancel();}},doElementSelect:function W(a,Z,Y){Z.isSelected=Y;this.onSelectionChange(A.ELEMENT,Y,Z);this.updateItemNodesStatus();},doBranchSelect:function M(b,Z,Y){var a=function(c){c.isSelected=Y;c.isBranchSelected=Y;J.forEach(c.children,function(d){a.call(this,d);},this);};a.call(this,Z);this.onSelectionChange(A.BRANCH,Y,Z);O.call(this,Z);this.updateItemNodesStatus();},doLevelSelect:function G(Z,Y){this.getItems().forEach(function(a){if(a.lv===Z){a.isSelected=Y;}});this.onSelectionChange(A.LEVEL,Y,null,Z);this.updateBtnSelectionStatus();if(this.docSelector&&!this.docSelector.incFetch){this.initDescStatusForNonIncFetch();}this.updateItemNodesStatus();},doBranchLevelSelect:function B(c,Z,b,Y){var a=function(d){if(d.lv===b){d.isSelected=Y;}else{if(d.lv<b){(d.children||[]).forEach(function(e){a(e);});}}};a(Z);this.onSelectionChange(A.BRANCH_LEVEL,Y,Z,b);O.call(this,Z);if(this.docSelector&&!this.docSelector.incFetch){this.initDescStatusForNonIncFetch();}this.updateItemNodesStatus();},doAllSelect:function K(Y){this.getItems().forEach(function(Z){Z.isSelected=Z.isBranchSelected=Y;Z.hcsd=Y?Z.hcd:false;});this.onSelectionChange(A.ALL,Y);this.updateItemNodesStatus();},updateItemNodesStatus:function L(){var Y=this.itemsContainerNode&&this.itemsContainerNode.childNodes;J.forEach(Y,function(a){var Z=this.getItemFromTarget(a);if(Z){R.toggleClass(a,Q,Z.isBranchSelected);R.toggleClass(a,N,Z.isSelected);}},this);},onSelectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.string","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+mstrmojo.string.encodeHtmlString(D[E.itemDisplayField])+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz","mstrmojo.string");var B=mstrmojo.string;var A={render:function(G,C,H){var J=(H.htmlName+C),E=H.selectedIndices[C]?"checked ":"",F=E?" selected":"",D=G.v!=="u;"?" nAll":"",I=G[H.itemDisplayField||"n"];return'<div class="'+H.itemCssClass+F+D+'"><input type="'+H.inputType+'" name="'+H.htmlName+'" id="'+J+'" value="'+C+'" '+E+'/><label for="'+J+'" title="'+B.encodeHtmlString(G[H.itemTitleField]||"")+'" style="'+H.labelCssText+'">'+(H.allowHTML?I:B.encodeHtmlString(I))+"</label></div>";},select:function(D){var C=D&&D.firstChild;if(C){if(!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},unselect:function(D){var C=D&&D.firstChild;if(C){if(C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);}},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(C){this._super(C);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(F){var E=F.hWin,H=F.e,G=mstrmojo.dom.eventTarget(E,H);if(G&&G.nodeName.match(/input/i)){var D=parseInt(G.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(D);}else{var C=(G.checked)?"add":"remove";this[C+"Select"](D);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var U=R.data,S=U&&U.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,W=R&&R.itemWidgets,Q=W&&W[0],U=Q&&Q.data;if(U&&U.not&&(W.length>0)){delete U.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(U,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var U=S||this.suppressConsolidation;if(!U){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var W=this.parent;if(!W||!W.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var U=R?S[0]:null,Q=this.childIndex();if(U){W.add([U],Q);}W.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var Y=R.nds,X=Q&&Q.fn||this.data&&this.data.fn,W={et:M.ET.ANDOR,nds:Y,fn:X};if(Y.length===2&&Y[0].not){if(Y[1].not){delete Y[0].not;delete Y[1].not;W.not=true;W.fn=(X===M.FN.AND?M.FN.OR:M.FN.AND);}else{var U=Y[0];Y[0]=Y[1];Y[1]=U;}}this.add([W],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var U=J(this,R);if(!U){return ;}this.remove(U.idxs,true);if(this.data.not){U.nds[0].not=true;}S.add(U.nds,this.childIndex());this.consolidate(false);},edit:function D(b,e,S){if(!b){return ;}var a=this.data,Z=a&&a.fn,R=b.data,h=R&&R.not;if(!R){R={};b.data=R;}R.not=!!S;if(Z!==e){var Q=a.nds;if(Q&&Q.length>2){var g=b.childIndex();if(g>0){this.indent([g-1,g],{fn:e});}}else{a.fn=e;var X=this.ctxtBuilder,W=X&&X.itemWidgets;for(var U=0,Y=(W&&W.length)||0;U<Y;U++){var f=W[U];if(f){f.paint();}}}}else{b.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),U=P.findWidget(S),Q=U.getAvatarNode&&U.getAvatarNode();if(!Q){Q=U.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=U.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,U.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.func","mstrmojo.string","mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.Label","mstrmojo._HasLayout","mstrmojo.Editor","mstrmojo.ui.CheckList","mstrmojo.ui.ToggleButton","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(10,1763,15120,15801);var L=mstrmojo.array,b=mstrmojo.css,D=mstrmojo.dom,Q=mstrmojo.expr,W=mstrmojo.func,B=mstrmojo.string,R=mstrmojo.Button.newWebButton,d=mstrmojo.mstr.EnumDSSXMLObjectTypes,S=mstrmojo.hash;var Y=mstrmojo.desc(1763,"Clear All");mstrmojo.vi.ui.IncCheckList=mstrmojo.declare(mstrmojo.ui.CheckList,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.IncCheckList",allowUnlistedValues:false,cssClass:"elementsList",initElements:function a(g){var f=this.ifDataHelper,e=this;if(!f){return ;}g=W.wrapMethods({success:function(h){e.clearSelect(true);e.set("items",[]);e.initScroll();e.addItems(h&&h.es);}},g);f.getItems(1,g,{hideFailureErr:true});},addItems:function N(e){this._super(e||[]);this.postAddItems();this.updateScrollbars();},postAddItems:mstrmojo.emptyFn});function F(e){return !L.filterOne(e.fs,function(f){return f.isbf&&(!!f.dtp?f.dtp:Q.mapBaseFormTypeToDataType(f.bftp))!==Q.DTP.CHAR;});}mstrmojo.vi.ui.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.ElementsBrowser",markupString:'<div id="{@id}" class="mstrmojo-Box mstrmojo-ui-vi-ElementsBrowser {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},searchBoxNode:function(){return this.domNode.firstChild;},buttonPanelNode:function(){return this.domNode.childNodes[1];},elementListNode:function(){return this.domNode.childNodes[2];}},layoutConfig:{h:{searchBoxNode:"26px",buttonPanelNode:"36px",elementListNode:"100%"},w:{searchBoxNode:"100%",buttonPanelNode:"100%",elementListNode:"100%"},xt:true},onBrowseElementsFailure:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:mstrmojo.desc(10,"Search"),cssClass:"eb-searchBox",valueChangeDelay:300,onEnter:function I(){var f=this.value,e=this.parent.parent.parent;e.set("searchPattern",f);},onvalueChange:function P(){var f=this.value,e=this.parent.parent.parent;e.set("searchPattern",f);}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var e=this.parent.searchBox;e.set("value","");e.cleanUp();e.focus();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15120,"View Selected"),cssClass:"eb-viewSelected",title:mstrmojo.desc(15120,"View Selected")},{scriptClass:"mstrmojo.ui.ToggleButton",alias:"toggleSelected",oncheckedChange:function J(){var e=this.parent.parent;e.onsearchPatternChange();}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel",children:[{scriptClass:"mstrmojo.Button",text:Y,title:Y,alias:"clearAllBtn",cssClass:"eb-clearAll",useRichTooltip:true,updateTooltipConfig:function X(){var e=D.position(this.domNode);this.richTooltip={content:mstrmojo.desc(16192,"This function is currently not supported for non-text elements in the searching result."),cssClass:"vi-info vi-tooltip-C",left:e.x+60,top:e.y+5};},onclick:function(){var f=this.parent.parent,h=f.elementList;h.clearSelect(false);var e=f.getLocalSearchItems(),g=f.itemIdField;f.onItemsSelectionChange({added:[],removed:e,itemIdField:g});L.removeItems(f.selectedItems,g,e);},showTooltip:function C(h,g){var f=this.parent.parent;if(!this.enabled&&!B.isEmpty(f.getSearchBox().value)&&!F(f.attribute)){mstrmojo._HasTooltip.showTooltip.call(this,h,g);}}},]},{scriptClass:"mstrmojo.vi.ui.IncCheckList",alias:"elementList",slot:"elementListNode",itemIdField:null,bindings:{ifDataHelper:"this.parent.ifDataHelper",itemIdField:"this.parent.itemIdField"},postAddItems:function(){var e=this.parent.selectedItems||[];this.setSelectedItems(e);}}],itemIdField:"v",ifDataSource:null,searchPattern:null,ifDataHelper:null,attribute:null,attributeId:null,selectedItems:[],init:function(e){this._super(e);this.set("ifDataHelper",new mstrmojo.mstr.DocElementDataHelper({source:this.ifDataSource}));if(this.ifDataSource&&this.attribute){this.onattributeChange();}this.elementList.attachEventListener("selectionChange",this.id,"onElementsListchange");},updateClearAllBtnState:function O(){this.buttonPanel&&this.buttonPanel.clearAllBtn.set("enabled",(B.isEmpty(this.getSearchBox().value)||F(this.attribute))&&(this.getLocalSearchItems().length>0));},onElementsListchange:function H(k){var j=k&&k.added||[],h=k&&k.removed||[],i=this.elementList.items,e=this.itemIdField;if(!this.selectedItems){this.selectedItems=[];}var g=this.selectedItems,f=[],l=L.get(i,h);L.removeItems(g,e,l);var m;L.forEach(j,function(n){m=i[n];if(m&&L.find(g,e,m[e])<0){g.push(m);f.push(m);}});this.updateClearAllBtnState();if(l.length>0||f.length>0){this.onItemsSelectionChange({added:f,removed:l,itemIdField:e});}},onItemsSelectionChange:mstrmojo.emptyFn,updateBrowseConfig:function K(){var g=this,k=this.attributeId,e=this.attribute,j=this.searchPattern,i=function(m,n){m.set("textValid",!n);m.domNode.title=B.encodeHtmlString(n,true);};if(!k){return ;}this.ifDataHelper.set("items",null);var f={attributeID:k};if(j&&j!==""){f.searchPattern=j;f.matchCase=false;f.otp=e.t||d.Attribute;}this.onUpdateBrowseElementsParams(f);this.ifDataHelper.set("browseConfig",f);var l=g.getSearchBox();this.elementList.initElements({success:function(m){i(l,"");},failure:function(s){var o=parseInt(s.code,10)+4294967296,q=2147762269,m=2147762227,n=2147762262,p=2147894808;if(o===m||o===n){i(l,"");}else{if(o!==q){var t=(o!==p)?g.onBrowseElementsFailure.bind(g,o):null;var u={shortDesc:mstrmojo.desc(15402,"This object is not available at this time."),longDesc:s.message},w={title:mstrmojo.desc(15403,"Invalid Object"),buttons:[R(mstrmojo.desc(13197,"Got it"),t,false)]};mstrmojo.error(u,undefined,w);i(l,"");}else{i(l,s.message);}}}});var h=this.util&&this.util.toggleSelected;if(h){h.checked=false;b.toggleClass(h.domNode,"checked",false);}this.updateClearAllBtnState();},isObjSearchable:function E(g,f){var h=S.walk("sapIsInListModeSupported",f),e=S.walk("sapType",f);if(h&&e!=="Edm.String"){return false;}return !(g&&g.t===d.Consolidation);},onattributeChange:function A(){var e=this.attribute;this.attributeId=e&&e.did;this.searchPattern=null;this.selectedItems=[];this.updateBrowseConfig();var h=this.getSearchBox(),f=S.walk("parent.parent.parent.parent.model.a",this),g=this.isObjSearchable(e,f);if(h){h.set("enabled",g);h.set("hint",g?mstrmojo.desc(10,"Search"):mstrmojo.desc(15801,"Not searchable"));}},getSearchBox:function M(){var e=this.util,f=this.util&&this.util.box;return f&&f.searchBox;},onifDataSourceChange:function G(){this.ifDataHelper.set("source",this.ifDataSource);this.ifDataHelper.set("items",null);},onsearchPatternChange:function Z(){var f=this.util&&this.util.toggleSelected;if(!f||!f.checked){this.updateBrowseConfig();}else{var e=this.getLocalSearchItems();this.elementList.clearSelect(true);this.elementList.set("items",[]);this.elementList.addItems(e);this.updateClearAllBtnState();}},getLocalSearchItems:function U(){var f=[],e;if(this.searchPattern&&this.searchPattern!==""){var g=this.searchPattern.toLowerCase();L.forEach(this.selectedItems,function(h){e=(h.n||"").toLowerCase();if(e.indexOf(g)>-1){f.push(h);}});}else{f=(this.selectedItems||[]).slice(0);}return f;},_set_selectedItems:function c(i,e){var h=this.selectedItems,g=this.itemIdField;e=e||[];this.selectedItems=e;this.updateClearAllBtnState();if(h.length!==e.length){return true;}var f=L.intersection(h,e,g);return f.length!==h.length;},onselectedItemsChange:function(){this.elementList.setSelectedItems(this.selectedItems);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","Box","Button","dom","css","desc","hash","array");mstrmojo.requiresCls("mstrmojo.vi.controllers.CustomSortModeActionMgr");var R=mstrmojo.Button.newWebButton,G=mstrmojo.dom,a=mstrmojo.css,J=mstrmojo.desc,M=mstrmojo.array,P=mstrmojo.hash,L=36,A=600;mstrmojo.requiresDescs(1442,221,5705,134);function I(){var f=this.vizBox=this.model.createVizBoxForCustomSort(this.nodeKey,{width:this.width,height:(parseInt(this.height)-L-this.spacer)+"px",left:"0px",top:this.spacer+"px"});this.visContainer.addChildren(f);var d=f.boxContent.controller,e=d.model.oid,g=e+"."+(this.oldNodeKey||this.srcViz.k),i=(d.getScrollPosition(g))||{x:0,y:0},h=e+"."+this.nodeKey;d.addScrollPosition(h,i.x,i.y);return f;}function O(){var e=this.titleContainerNode,d=e.style,f=G.position(e);if(f.w<A){d.width=A+"px";d.position="relative";d.left=(f.w-A)/2+"px";d.border="solid 1px rgba(68,70,73,0.2)";}}function W(){var f=G.position(mstrApp.rootCtrl.view.domNode),e=G.position(this.titleContainerNode),d=G.position(this.editorNode),g;if(f.w>=e.w){if(e.x<f.x){g=d.x-e.x;this.set("left",(f.x+g)+"px");}else{if(e.x+e.w>f.x+f.w){g=e.x+e.w-(d.x+d.w)+8;this.set("left",(f.x+f.w-d.w-g)+"px");}}}}function Q(){var d=this.editorNode.style;d.width=this.width;d.height=this.height;}function N(){this.vizBox.toggleBoxSelection(true);}function c(i){var f=this.actionMgr.getSlientActionsBefore();if(f.length>0){var g=M.map(f,function(j){return j&&j.submitAction;}),h=this.wrapCustomSortAction(g,false),e=this.srcViz,d={hideCancel:true};e.model.customSort(h,e.controller._getXtabCallback(e,P.copy(i)),d);}}function b(){var e=this.actionMgr.getContSlientActionsBefore(),d=this,f={success:function(g,i){if(e.length>0){var k=M.map(e,function(n){return n&&n.submitAction;}),m=d.wrapCustomSortAction(k,true),j=d.vizBox.boxContent,h={hideCancel:true,noUpdate:true,preserveStid:true,noDeltaXML:true},l=j.model.getDataService();l.submitUpdates(l.getUpdateTemplateAction(j.k,m),j.controller._getXtabCallback(j),h);}}};c.call(this,f);}mstrmojo.vi.ui.rw.CustomSortDisplayPanel=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.rw.CustomSortDisplayPanel",cssClass:"mstrmojo-CustomSortDisplayPanel",actionMgr:null,init:function S(d){this.actionMgr=new mstrmojo.vi.controllers.CustomSortModeActionMgr({csDisplayPanel:this});this._super(d);},postBuildRendering:function U(){this.getVizBox();var f=this._super();if(!this._listenerProc){var e=this,g=null,d=this._listenerProc=function(h){window.clearTimeout(g);g=window.setTimeout(function(){W.call(e);},150);};G.attachEvent(window,"resize",d);}return f;},destroy:function Z(d){if(this._listenerProc){G.detachEvent(window,"resize",this._listenerProc);}this._super(d);},children:[{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"leftBox",cssClass:"left title",children:[{scriptClass:"mstrmojo.Label",text:J(5705,"Custom Sort")}]},{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"urBox",cssClass:"left icons",children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id="{@id}" class="icn {@cssClass}" mstrAttach:click></div>',alias:"undo",cssClass:"undo disabled",enabled:false,onclick:function(){if(this.enabled){var d=this.parent.parent;d.actionMgr.undo();}},bindings:{enabled:function(){return !!this.parent.parent.canUndo;}},onenabledChange:function(){a.toggleClass(this.domNode,"disabled",!this.enabled);}},{scriptClass:"mstrmojo.Widget",alias:"redo",cssClass:"redo disabled",enabled:false,markupString:'<div id="{@id}" class="icn {@cssClass}" mstrAttach:click></div>',onclick:function(){if(this.enabled){var d=this.parent.parent;d.actionMgr.redo();}},bindings:{enabled:function(){return !!this.parent.parent.canRedo;}},onenabledChange:function(){a.toggleClass(this.domNode,"disabled",!this.enabled);}}]},{scriptClass:"mstrmojo.HBox",slot:"titlebarNode",alias:"btnBox",cssClass:"btnBox",children:[R(J(1442,"OK"),function(){if(this.enabled){var d=this.parent.parent;d.removeCSViz(function(){c.call(d);d.close();},false);}},true,{alias:"savebtn",enabled:false,bindings:{enabled:function(){return this.parent.parent.canApply;}}}),R(J(134,"Apply"),function(){if(this.enabled){var d=this.parent.parent,e=d.actionMgr;b.call(d);e.appendHistUnsilentActions(e.getUnslientActionsBefore());e.reset();}},true,{enabled:false,bindings:{enabled:function(){return this.parent.parent.canApply;}}}),R(J(221,"Cancel"),function(){var d=this.parent.parent;d.removeCSViz(null,true);d.close();})]},{scriptClass:"mstrmojo.Box",alias:"visContainer",slot:"containerNode"}],oldNodeKey:null,nodeKey:null,vizBox:null,model:null,srcPanelKey:null,srcLayoutKey:null,srcViz:null,srcUnit:null,srcAxis:-1,getVizBox:function D(){return this.vizBox=this.vizBox||I.call(this);},setVizBoxPortalStateRestore:function K(){this.getVizBox().defn.ds=0;},onOpen:function H(){Q.call(this);O.call(this);N.call(this);W.call(this);var e=this.vizBox.boxContent,d=e.selCells||[];M.forEach(d,function(f){e.handleSelection({},null,f);e.clearHighlights();});},onClose:function E(){var e=this.vizBox,d=this.model;if(e.boxContent.cellHoverMgr.removeCue){e.boxContent.cellHoverMgr.removeCue();}mstrmojo.dnd.enable();delete this.actionMgr;delete this.silentMask;this.destroy();},removeCSViz:function F(i,h){var e=this.model,f,d;if(h){f={config:{silent:true}};}else{f={hideCancel:true};}f.style={params:{treesToRender:0}};f=P.copy({noUpdate:true,preserveStid:true,noDeltaXML:true},f);if(i){d={success:function(){i();}};}var g=e.getRemoveUnitAction(this.vizBox);g.clearTargets=true;e.getDataService().submitUpdates(g,d,f);},recreateCSVizForUndo:function Y(o,n,q){var s=this.model,t=this.srcViz.model,p=t.getDataService(),e=s.getNextKey(),f,m=this;var d=s.getRemoveUnitAction(this.vizBox);d.clearTargets=true;f=[d];var g=0,h=o.length,l;if(g<h){l=o[g];g++;}f=f.concat(t.getCreateCSVizActions(this.srcUnit,this.srcAxis,e,l));var k=function(AA){var x=m.srcLayoutKey,u=m.srcPanelKey,y=AA.data,w=M.filterOne(y.layouts,function(AD){return AD.k===x;});s.controller.view.updateXtabStyles(x,w.xtabStyles);s.updateDefnCache(AA.defn,[e,u]);s.updateDataCache(y,s.getTargetDefn(e));m.oldNodeKey=m.nodeKey;m.nodeKey=e;m.vizBox.destroy();delete m.vizBox;m.setVizBoxPortalStateRestore();var AB=m.getVizBox();AB.render();var z=0,AC=(n||[]).length,i=function(){if(z<AC){n[z++].perform(false,i,true);}else{mstrApp.hideWait(true);var AE=m.actionMgr;if(AE.hasFailedSorts()){var AD=AE.getActionsCount()-AE.getFailedSortsCount();AE.actions.splice(AD);AE.pos=AD-1;m.updateStatus();AE.showFailedSortsAndReset();if(q&&q.fail){q.fail();}}else{if(q&&q.success){q.success();}}}};i();},j=function(){p.submitUpdates(f,{success:function(i,u){if(g<h){f=p.getUpdateTemplateAction(e,o[g]);g++;j();}else{k(i);}}},{style:{params:{treesToRender:3}},noUpdate:true,preserveStid:true,noDeltaXML:true,hideCancel:true});};j();},wrapCustomSortAction:function B(h,f){var g=this.srcUnit,e=f?1:this.srcAxis,d=1,i=this.srcViz.model.data.gts[((this.srcAxis===d)?"row":"col")+"SubPos"];return{act:"customSortAddActions",unitType:g.otp,unitId:g.id,axis:e,subTotalsPos:[i],actions:h};},maskSilently:function X(d){var g=this.silentMask;if(!g){var f=this.curtainNode,e=document.createElement("div");e.innerHTML=f.outerHTML;e.firstChild.style.zIndex=this.zIndex+1;e.firstChild.style.opacity="0";e.firstChild.style.display="none";g=this.silentMask=this.domNode.appendChild(e.firstChild);}g.style.display=d?"block":"none";},updateStatus:function C(){var d=this.actionMgr;this.set("canUndo",d.pos>=0);this.set("canRedo",(d.actions.length-1)>d.pos);this.set("canApply",d.getSlientActionsBefore().length>0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(c,Z){var b=this.list,X=b.selectedIndex,W=b.items.length,Y=c?W-1:0;if(X===Y){b.clearSelect();return ;}if(X===null||X<0){X=c?0:W-1;}else{X+=c?1:-1;}if(Z){var a=b.items[X];while(a&&a.type==="dummy"){if(X===Y){b.clearSelect();return ;}X+=c?1:-1;a=b.items[X];}}b.singleSelect(X);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,nameWildcardsHLList:[2,32],getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(W){this.hideSuggestion();},getSearchPattern:function U(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(X){var W=this.getSuggestion(X);if(!this.noCache&&W!==-1){this.updateSuggestion(W);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(W){if(this.suggestionShown){this._lastOpened.nextHighlight(W);}},preHighlight:function H(W){if(this.suggestionShown){this._lastOpened.preHighlight(W);}},getSuggestion:function S(k){var f=this.candidates,d=f&&f.items,Z=f&&f.isComplete,j=this._last_hit;if(!this.noCache&&(f||j)){var h=this.filterCandidates(d,k,this.REQUEST_THRESHOLD),e=h.length,g=this.suggestCount,W=false;if(!Z&&e<g){var X=j&&j.pattern;if(j&&X&&(k.indexOf(X)>-1)){W=true;var m=this.filterCandidates(j.items,k,this.REQUEST_THRESHOLD),a=m&&m.length,Y=mstrmojo.array,l=this.itemField,b;for(b=0;b<a;b++){if(Y.find(h,l,m[b][l])===-1){h.push(m[b]);}}e=h.length;}}if(!Z&&((k.length>2&&e<this.REQUEST_THRESHOLD)||(e<g))){this.requestCandidates(k);return -1;}return(e<g)?h:h.slice(0,g);}this.requestCandidates(k);return -1;},requestCandidates:function A(W){this._request_pattern=W;var Z=this,X=this.getSuggestionTarget(),Y={success:function(g){if(!g){return ;}var f=Z.getSuggestionTarget();if(!f||(X!==f)){return ;}var l=f.getSearchPattern(),d=g.items;Z._last_hit={items:d,pattern:W};Z.sz=g.sz;if(!Z.noCache&&d){var h=(Z.candidates&&Z.candidates.items)||[],j=[].concat(d),e=d.length,b;for(b=0;b<e;b++){var a=j[b];if(mstrmojo.array.indexOf(h,a)>-1){mstrmojo.array.removeItem(d,a);}}if(Z.candidates){Z.candidates.items=h.concat(d);}}if((l||l==="")&&l.indexOf(W)>-1){var k=Z.filterCandidates(d,l);Z.updateSuggestion(k);}},failure:function(a){if(a.getResponseHeader){mstrmojo.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:W,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},Y);},filterCandidates:function Q(Z,Y,W){W=W||this.suggestCount;Y=mstrmojo.string.regEscape(Y);var a=this.itemField,X=mstrmojo.array.filter(Z,function(b){return(new RegExp("\\s"+Y+"|^"+Y,"i")).test(b[a]);},{max:W});return X;},getHighlightedText:function P(Y,b){if(!this.highlightPattern||mstrmojo.string.isEmpty(Y)){return b;}try{if(!this.nameWildcards||mstr.$A.find(this.nameWildcardsHLList,parseInt(this.nameWildcards,10))>-1){b=b.replace(new RegExp("(^|\\s)("+Y+")","gi"),"$1<b>$2</b>");}else{var a=Y.split(" "),X,W;for(X=0,W=a.length;X<W;X++){if(a[X]!==""){b=b.replace(new RegExp("("+a[X]+")","gi"),"<b>$1</b>");}}}}catch(Z){}return b;},updateSuggestion:function O(Z){var X=Z&&Z.length,W=this.browseItemVisible;if(X||W){if(W){Z=Z||[];Z.push({n:"Browse...",t:-99,cssClass:(X?"br":"bro")});}this.set("suggestionItems",Z);if(this.suggestionShown){var Y=this._lastOpened;if(Y&&Y.nudge){Y.nudge();}if(this.autoSelect&&Y){Y.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}var Y=this._lastOpened||this.suggestionPopup;if(mstrApp.isWorkstationPlugin&&Y&&this.updateSuggestionListHeightThenNudge){this.updateSuggestionListHeightThenNudge(Y);}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Editor-ObjectSelector",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var W=this.opener;if(W&&W.onBrowserClose){W.onBrowserClose();}},onOpen:function(){var W=this.opener;if(W&&W.onBrowserOpen){W.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(W,X){if(this.browseItemVisible&&W.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var Y=this.zIndex;this.openPopup("ob",{zIndex:(Y&&(Y+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(X,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(W);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(W){D.call(this,true,W);},preHighlight:function(W){D.call(this,false,W);},getSelected:function M(){var W=this.list;return W.items[W.selectedIndex];},onOpen:function I(){var W=this.opener;if(W){mstrmojo.css.addClass(this.domNode,W.suggestionPopupCssClss||"");if(W.autoSelect){this.list.singleSelect(0);}if(W.nudge){W.nudge(this);}}},onClose:function F(){this.list.clearSelect();var W=this.opener;if(W){W.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,W.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){var K="";if(J.getResponseHeader){K=J.getResponseHeader("X-MSTR-TaskFailureMsg");}else{if(J.message){K=J.message;}}K&&mstrmojo.alert(K);}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.DynamicClassFactory","mstrmojo._IsAccessibleMenu");mstrmojo.ui.menus.MenuItemType=null;var B=mstrmojo.array,O=mstrmojo.css,b="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasToggleItem:false,hasMenuItems:function X(){var c=B.filter(this.menus||[],function(d){return d.cls!==b;});return !!c.length;},getMenuItems:function F(c){var e=B.filter(this.menus.slice().reverse(),function(i,h,g){var f=g[h+1];return c||i.cls!==b||(h&&f&&f.cls!==b);}).reverse();var d=(e&&e.length)||0;if(!c&&d>0&&e[d-1].cls===b){e.pop();}return e;},getMenuItem:function D(f){var e=this.menus,c;if(e!==null){for(c=0;c<e.length;c++){var d=e[c];if(d.cls===f){return d;}}}return null;},absorbMenuItems:function Z(c){this.menus=this.menus.concat(c.menus);if(!this.hasToggleItem&&c.hasToggleItem){this.hasToggleItem=true;}},addMenuItem:function K(i,j,h,g,f,d){var k,e,c;if(!i||typeof i==="string"){k=i;}else{k=i.n;e=i.ttp;}c={n:k,ttp:e,cls:j,fn:h,ctxt:g};if(isNaN(f)||f>=this.menus.length){this.menus.push(c);}else{this.menus.splice(f,d?1:0,c);}if(j.indexOf(/\bon\b/)>-1){this.hasToggleItem=true;}return c;},addCustomMenuItem:function a(h,e,g,d,c){var f=this.addMenuItem(h,e,g,c);f.getItemMarkup=d;return f;},addDisabledMenuItem:function R(d,c){this.addNonInteractiveMenuItem(d,c,true);},addNonInteractiveMenuItem:function P(g,d,c){var e=["non-int"];if(d){e.push(d);}if(c){e.push("disabled");}if(g&&typeof g!=="string"&&g.ttp){this.useTooltip=true;}var f=this.addMenuItem(g,e.join(" "),mstrmojo.emptyFn);f.dsbld=true;},addSeparator:function E(c){var d=[b];if(c){d.push(c);}this.addMenuItem("",d.join(" "),function(){return false;});},addPopupMenuItem:function Y(i,k,h,j,g,f,c){var e=["pop "];if(j){e.push(j);}var d=this.addMenuItem(i,e.join(" "),h,g,f,c);d.pop=true;d.scope=k;return d;},addActionPopupMenuItem:function N(j,d,h,i,e,c,g){var f=this.addPopupMenuItem(j,d,i,(e||"")+" ax",c,g);f.actionFn=h;f.ax=true;},addSubMenuItem:function M(g,e,d,f,c){this.addPopupMenuItem(g,d,f,e,c);},addEditorMenuItem:function S(g,d,f,c,e){this.addPopupMenuItem(g,d,f,"",c,e);},getToggleItemStates:function G(k,m,c,i,e,h){var f,g,d,j;if(typeof k==="string"){f=g=k;d=j="";}else{f=k.on||"";g=k.off||"";d=k.ttpOn||"";j=k.ttpOff||"";}var l=[{n:f,ttp:d,cls:m+" on",fn:i,ctxt:h},{n:g,ttp:j,cls:m,fn:c,ctxt:h}];if(!e){l.reverse();}return l;},addToggleMenuItem:function L(j,f,h,e,d,i,c){var g=this.getToggleItemStates(j,f,h,e,i,c);this.hasToggleItem=true;return this.addDualStateItem(d,g[0],g[1]);},addDualStateItem:function I(d,c,e){return this.addMenuItem({n:c.n,ttp:c.ttp},c.cls,this.getDualStateHandler(d,c,e),c.ctxt);},getDualStateHandler:function J(d,c,e){return function(g,h){var f=[c,e];if(g.cls===c.cls){f.reverse();}f[1].fn.call(mstrmojo.all[d],g,h);if(g.cls.indexOf("toggleManualMode")===-1){g.n=f[0].n;g.ttp=f[0].ttp;g.cls=f[0].cls;}};},addRadioMenuGroup:function C(e,j,f,d,c,i,h){var g=[];this.hasToggleItem=true;f.forEach(function(n,k){if(n.separator){this.addSeparator();return ;}var p=n.text,o=(d||"")+" "+(n.cls||"")+(i?"":" radio")+(n.value===e?" on":""),m=function(){if(j.call(this.ctxt,n.value,e,n)===false){return false;}e=n.value;g.forEach(function(q){q.cls=q.cls.replace(/ on$/,"")+(q.radioValue===e?" on":"");});return true;},l=h?this.addCustomMenuItem(p,o,m,h(n,k),c):this.addMenuItem(p,o,m,c);l.radioValue=n.value;g.push(l);},this);},addExclusiveMenuGroups:function U(e,j,g,d,c,i){var h=[],f=[];this.hasToggleItem=true;g.forEach(function(m){if(m.separator){this.addSeparator();return ;}var p=m.text,o=m.group,q=m.cls||" ";if(f[o]===undefined){f[o]=0;}f[o]+=m.value;var n=(d||"")+" "+(m.cls||"")+(!!(m.value&e)?" selected":""),l=function(t,x){if(e===t.checkboxValue){return false;}var w=!!(f[o]&e),u,s=!(e&t.checkboxValue);if(s){u=w?e|m.value:m.value;}else{u=w?e&~m.value:m.value;}j.call(this.ctxt,u,e,m);e=u;x.selectedIndices=[];h.forEach(function(y){O.addClass(x._getItemNode(y._renderIdx),[y.optionCls]);if(!(y.checkboxValue&e)){O.removeClass(x._getItemNode(y._renderIdx),["selected"]);}else{x.selectedIndices[y._renderIdx]=true;O.addClass(x._getItemNode(y._renderIdx),["selected"]);}});return c.closeAfterSelection;},k=i?this.addCustomMenuItem(p,n,l,i,c):this.addMenuItem(p,n,l,c);k.checkboxValue=m.value;k.optionCls=q;h.push(k);},this);},addToggleMenuGroup:function W(e,i,f,d,c,h){var g=[],j;this.hasToggleItem=true;f.forEach(function(m){if(m.separator){this.addSeparator();return ;}var o=m.text,n=(d||"")+" "+(m.cls||"")+(m.value===e?" selected":""),l=function(q,s){var p=true;if(i.call(this.ctxt,m.value,e,m)===false){p=false;}if(j&&m.value!==e){O.removeClass(s._getItemNode(j._renderIdx),"selected");j=null;}return p;},k=h?this.addCustomMenuItem(o,n,l,h,c):this.addMenuItem(o,n,l,c);if(m.value===e){j=k;}g.push(k);},this);},clear:function Q(){this._super();this.menus=[];},newInstance:function A(d){var c=mstrmojo.ui.menus.Menu;if(this.hasAccessibility||(this.xtab&&this.xtab.hasAccessibility)){c=mstrmojo.DynamicClassFactory.newComponent(c,[mstrmojo._IsAccessibleMenu]);}return new c(mstrmojo.hash.copy({popupConfig:this},d));},addMenuTitle:function H(c){this.addMenuItem(c||"","menu-item-title",mstrmojo.emptyFn);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.util.A11yUtility","mstrmojo.ui._HasListTooltip");var C=mstrmojo.dom,H=mstrmojo.vi.util.A11yUtility;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(J){this._super(J);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(M,J){var K=this.toolbarCfg,L=(K!==J);if(L){if(K){K.destroy();}this.toolbarCfg=J;}return L;},getItemProps:function E(L,J){var K=this._super(L,J);K.addCls(L.cls);K.addStyle("display:inline-block");return K;},postBuildRendering:function A(){var J=document.createElement("div");J.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(J);return this._super();},postselectionChange:function(J){var K=J.added;if(K){var L=this.items[K[0]];if(L.tp==="pb"&&L.isMenuClicked){L.menufn(L,this);}else{L.fn(L,this,J);}}},ontoolbarCfgChange:function B(J){var L=J.valueWas;if(L){L.destroy();}var K=J.value;if(!K){return ;}this.set("items",K.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function D(N,J){var M=this.id,K=this._getItemNode(J._renderIdx),L;N.hostId=M;N.hostElement=K;L=N.newInstance();L.navMode=!!this.actionByKeyboard;if(L.navMode&&L.scriptClass==="mstrmojo.ui.menus.Menu"){this.attachEventListenerOnce("menuClosed",M,function(O){if(O&&O.needFocus&&K&&K.grabFocus){K.grabFocus(true);}});}this.openPopup(L);},onclick:function I(J){var L=J.target||C.eventTarget(J.hWin,J.e),K=this.getItemFromTarget(L);if(K&&K.tp==="pb"){if(L&&L.className){K.isMenuClicked=L.className.indexOf("icn")===-1;}}this.actionByKeyboard=H.isKeyBoardEvent(J.e);this.toolbarClicked(J);this._super(J);},destroy:function F(K){var J=this.toolbarCfg;if(J){J.destroy();}delete this.items;this._super(K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasTooltip","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.string","mstrmojo.css","mstrmojo.array","mstrmojo.func","mstrmojo.vi.util.A11yUtility","mstrmojo._CanAutoClose");var b=mstrmojo.css,N=mstrmojo.array,G=mstrmojo.dom,B=mstrmojo.string,W=mstrmojo.func,Q=mstrmojo.vi.util.A11yUtility;function I(d){this.set("richTooltip",{cssClass:"vi-regular vi-tooltip-C",content:B.encodeHtmlString(d)});}mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,onSelectedItemChange:mstrmojo.emptyFn,useRichTooltip:true,allowHTML:false,useDarkTheme:false,init:function U(d){this._super(d);b.addWidgetCssClass(this.getPopupList(),"ctrl-popup-list");},unrender:function X(d){if(this._blurListenerProc){G.detachEvent(this.selectedNode,"blur",this._blurListenerProc);delete this._blurListenerProc;}if(this._super){this._super(d);}},initChildren:function C(){this.children=this.getPopupListConfig();this._super();},postBuildRendering:function Y(){if(this._super){this._super();}var d=this,e=this.getSelectedItem();if(e){I.call(this,e.n);}if(this.enableAccessibility){this.selectedNode.setAttribute("tabindex","-1");this.selectedNode.setAttribute("role","combobox");this.selectedNode.setAttribute("aria-haspopup","menu");this.selectedNode.setAttribute("aria-owns",this.getPopupList().id);if(!this._blurListenerProc){this._blurListenerProc=function(){d.loseFocus();};G.attachEvent(this.selectedNode,"blur",this._blurListenerProc);}}},grabFocus:function P(e){if(!this.enableAccessibility){return ;}var f=this.selectedNode,d=this.getPopupWidget();if(e){f.focus();}d.navMode=true;b.addClass(f,Q.CSS_FOCUS_VISIBLE);},loseFocus:function D(f){if(!this.enableAccessibility){return ;}var e=this.selectedNode,d=this.getPopupWidget();if(f){e.blur();}d.navMode=false;b.removeClass(e,Q.CSS_FOCUS_VISIBLE);},onkeydown:function L(d){var f=d.e||d,e=f.key;if(!this.enableAccessibility){return ;}if(this._super){this._super(d);}if(e==="Enter"||e===" "){d.cancel();d.preventDefault();this.onclick(d);}},showTooltip:function E(i,h){var f=this.selectedNode,g=this.richTooltip;if(f.offsetWidth>=f.scrollWidth){return ;}if(!g.top){var d=G.position(this.selectedNode);g.top=d.y-3;g.left=d.x+d.w+6;}if(this._super){this._super(i,h);}},getSelectedItem:function O(){var d=this.items;return d&&d[this.selectedIndex];},selectItemByField:function A(e,d){this.set("selectedIndex",N.find(this.items||[],e,d));},getPopupWidget:function F(){return this.list;},getPopupList:function K(){return this.list;},_set_items:function J(g,d){var f=this.items;this.items=d;delete this.selectedIndex;if(f!==d){var e=this.hasRendered;if(e){this.refresh();}return true;}return false;},onclick:function c(d){this._super(d);var f=this,e=f.getPopupWidget();f.mw=f.mw||function(g){if(!G.contains(e.domNode,G.eventTarget(self,g),true,document.body)){e.close();}};if(!e.onCloseFuncWrapped){e.onClose=W.composite([e.onClose,function(){G.detachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",f.mw);}]);e.onCloseFuncWrapped=true;}G.attachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",f.mw);if(f.focusOnPopup){e.domNode.focus();e.navMode=Q.isKeyBoardEvent(d&&d.e);}},_set_selectedIndex:function R(k,h,f){if((h!==0&&!h)||h<0){return false;}var e=this.selectedIndex=h,d=this.getPopupList(),g=d&&d.items,j=g&&g[e],i=this.selectedNode;if(j&&j.dsbld){return false;}if(d){mstrmojo._ListSelections._set_selectedIndex.call(d,"selectedIndex",e,f);}if(i&&g&&g[e]){this.updateSelectedNode(g[e]);}if(g&&g[e]){if(this.focusOnPopup&&d&&!d.closeAfterSelection){d.itemsContainerNode.children[e].style.color="";}else{this.onitemSelected(g[e],e);}}return true;},updateSelectedNode:function(d){if(this.selectedNode&&d){this.selectedNode.innerHTML=this.getPulldownTextInnerHTML(d);this.selectedNode.title=d.title||"";this.selectedNode.setAttribute("aria-label",B.encodeHtmlString(d.n||"",true));}},getPulldownTextInnerHTML:function H(d){return this.allowHTML?d.n:B.encodeHtmlString(d.n,true);},postselectedIndexChange:function S(d){var h=d.value,f=d.valueWas;if(h!==f){var e=this.items,g=e[h];if(g){I.call(this,g.n);}this.onSelectedItemChange(g,e[f]);}},getPopupConfig:function M(){var d=this._super();d.useDarkTheme=this.useDarkTheme;return d;},_set_allowHTML:function(e,d){if(this.allowHTML===d){return false;}this.allowHTML=d;this.getPopupList().set("allowHTML",d);return true;},getPopupListConfig:function a(){return{scriptClass:"mstrmojo.ui.PopupList",enableAccessibility:this.enableAccessibility,alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,allowHTML:this.allowHTML,listHooks:{select:function d(h,i,g){this.parent.set("selectedIndex",g);if(this.visible&&this.closeAfterSelection&&!this.selectedItem.dsbld){this.close();}}},getItemProps:function e(i,g){var h=mstrmojo._IsList.getItemProps.call(this,i,g);h.style=this.parent.itemCssText||"";return h;},suppressClose:function f(g){return mstrmojo._CanAutoClose.suppressClose.call(this,g)||G.contains(this.parent.domNode,g,true,document.body);}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function Z(e,i,d,h,g){h=h||{};h.items=e;var f;if(g===true){f=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:d||0},h);}else{f=new mstrmojo.ui.Pulldown(h);if(d!==undefined){f.set("selectedIndex",d);}}f.onSelectedItemChange=i||mstrmojo.emptyFn;return f;};}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricSelectorUtility","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo._FormatDefinition","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var W=mstrmojo.dom,N=mstrmojo.hash,S=mstrmojo.MetricSelectorUtility,k=mstrmojo._FormatDefinition.NumberFormatCategory,J=mstrmojo.desc,X=mstrmojo.css,Z=mstrmojo.num,B=Math,d=B.max,H=B.min,f=B.floor,Y=B.round,b=9;function M(AC,AB,z,y){var AA="px",s=AC._length,p=AC.handleSize,o=AC.orCfg,AG=o.posCssP,t=o.lenCssP,u=false;z=d(z,-1);y=H(y+b,s);if(z>y){u=true;}var AD=H(z,y),AE=d(z,y),AF=AE-AD-(u?0:p+b),AF=d(AF,0),w=d(s-AE,0);if(AC.hasRendered){AB.handle1Node.style[AG]=z+AA;AB.handle2Node.style[AG]=(y-b)+AA;var n=AB.lowerRange.style,x=AB.thumbNode.style,q=AB.upperRange.style;n[AG]=0;x[AG]=(AD+(u?0:p))+AA;q[AG]=(AE+p-b)+AA;n[t]=d(AD,0)+AA;x[t]=AF+AA;q[t]=w+AA;}else{AA+=";";AG+=":";t+=":";AC.handle1CssText=AG+z+AA;AC.handel2CssText=AG+(y-b)+AA;AC.lowerRangeCssText=t+d(AD,0)+AA;AC.thumbCssText=AG+(AD+p)+AA+t+AF+AA;AC.upperRangeCssText=AG+(AE+p-b)+AA+t+w+AA;}return{handle1:z,handle2:y};}function O(n){this.getUnit=function(){return n._length/d((n.items.length-1),1);};this.calcMinMax=function(q,p){var s=n.unit;return{min:f(q/s+0.5),max:f(p/s+0.5)};};this.calcPxIdx=function(p){return f(p/n.unit+0.5);};this.getStep=function(){var q=n.high-n.low,p=parseInt(n.numFmts.cat,10),s=(p===4)?2:(p===5)?4:0;q=(q===0)?1:q;if(q>1){return(q>(n._length-2))?Number(Number(q/(n._length-2)).toFixed(n.numFmts.dp+s)):1;}return q/(n._length-2);};this.getIdx=function(p){return H(d(Y((p-n.low)/n.step),0),n.items.length-1);};this.initialMetricSlider=function o(){var u=function(AH){return AH!==undefined&&AH!==null;},s=function(AH){return(u(AH.da)&&u(AH.da.low)&&u(AH.da.high)&&u(AH.da.cnt)&&u(AH.f)&&u(AH.ft)&&u(AH.qua));},q=function(AH){var AL=true,AK=true,AI=parseInt(AH.ft,10),AJ=parseInt(AH.f,10);if(AI===S._GENERIC){AL=AJ!==S.FN.ISNULL&&AJ!==S.FN.ISNOTNULL&&AJ!==S.FN.NOTIN&&AJ!==S.FN.IN;}else{if(AI===S._PERCENT||AI===S._RANK){AK=AJ!==S.MRPFN.INASCENDING&&AJ!==S.MRPFN.INDESCENDING&&AJ!==S.MRPFN.NOTINDESCENDING&&AJ!==S.MRPFN.NOTINASCENDING;}}return !AL||!AK;},AE=0;n.include=n.parent.include;n.clsType="scm ";n.staticStatus=!(u(n.da)&&u(n.da.low)&&u(n.da.high)&&u(n.da.cnt)&&u(n.qua));if(n.staticStatus){n.da.low=1;n.da.high=7;n.ft=S._GENERIC;n.f=S.FN.BETWEEN;n.qua=S.Q._G;n.cs=[{n:"",v:1},{n:"",v:7}];n.numFmts={cat:9,dp:0,fm:""};}switch(n.qua){case 0:var AD=parseInt(n.numFmts.cat,10);AE=AD===4?2:AD===5?4:0;n.low=Number(Number(n.da.low).toFixed(n.numFmts.dp+AE));n.high=Number(Number(n.da.high).toFixed(n.numFmts.dp+AE));break;case 1:case 2:n.low=1;n.high=n.da.cnt;break;case 3:case 4:n.low=0;n.high=100;break;}var AG=!n.staticStatus&&!n.da.nov;n.set("lowText",AG?n.formatNumber(n.low):"");n.set("highText",AG?n.formatNumber(n.high):"");n.step=(n.qua===1||n.qua===2)?1:this.getStep();n.cs1Vl=n.low;n.cs2Vl=n.high;var t=n.low,AA=n.high,AF=[],AC=0;if(u(t)&&u(AA)){var x=t,z;for(z=0;x<=AA;z++,x+=n.step){AF[z]={n:S.formatNumber(n.qua,x,n.numFmts),v:Number(Number(x).toFixed(n.numFmts.dp+AE))};}AC=AF.length;if(AC>0&&AF[AC-1].v!==AA){AF[AC-1]={n:S.formatNumber(n.qua,AA,n.numFmts),v:AA};}}n.items=AF;var p=S.OP,AB=n.cs,y=(AB&&AB.length>0)?Z.parseNumeric(String(AB[0].v).replace("%","")):t,w=(AB&&AB.length>1)?Z.parseNumeric(String(AB[1].v).replace("%","")):AA;if(y<n.low){n.frtUst=true;}if(w>n.high){n.ndUst=true;}n.opId=(n.f!==null&&n.ft!==null)?S.getOpIdxByfunc(n.f,n.ft):p._BETWEEN;switch(n.opId){case p._EQUALS:case p._NOT_EQUALS:n.cs1Vl=n.cs2Vl=y;break;case p._LESS_EQUAL:case p._GREATER:n.cs1Vl=t;n.cs2Vl=y;break;case p._GREATER_EQUAL:case p._LESS:n.cs1Vl=y;n.cs2Vl=AA;break;case p._IN:case p._NOT_IN:case p._IS_NULL:case p._IS_NOT_NULL:break;default:n.cs1Vl=y;n.cs2Vl=w;break;}n.cs1Idx=this.getIdx(n.cs1Vl);n.cs2Idx=this.getIdx(n.cs2Vl);n.cs1Nm=u(n.cs1Vl)?S.formatNumber(n.qua,n.cs1Vl,n.numFmts):n.items[n.cs1Idx].n;n.cs2Nm=u(n.cs2Vl)?S.formatNumber(n.qua,n.cs2Vl,n.numFmts):n.items[n.cs2Idx].n;n.unit=this.getUnit();n.set("unSet",(!s(n)||q(n)||(!n.cs||n.cs.length===0))&&!n.staticStatus);};this.updateOpCs=function(){var t=(n.cs1Vl>n.cs2Vl)?n.cs2Vl:n.cs1Vl,z=(n.cs1Vl>n.cs2Vl)?n.cs1Vl:n.cs2Vl,s=n.low,w=n.high,y=n.include,p=S.OP,u=parseInt(n.qua,10),q=(u===S.Q._PT||u===S.Q._PB),AA,x=[];if((t>=s&&z<=w)||t<s||z>w){n.opId=y?p._BETWEEN:p._NOT_BETWEEN;}if(t===z){n.opId=y?p._EQUALS:p._NOT_EQUALS;}if(t===s&&z<w){n.opId=y?p._LESS_EQUAL:p._GREATER;}if(t>s&&z===w){n.opId=y?p._GREATER_EQUAL:p._LESS;}AA=s==t&&z==w;if(!AA){switch(n.opId){case p._BETWEEN:case p._NOT_BETWEEN:x.push({dtp:5,v:Z.toLocaleString(t)+(q?"%":"")});case p._EQUALS:case p._NOT_EQUALS:x.push({dtp:5,v:Z.toLocaleString(z)+(q?"%":"")});break;default:if(t>s){x.push({dtp:5,v:Z.toLocaleString(t)+(q?"%":"")});}if(z<w){x.push({dtp:5,v:Z.toLocaleString(z)+(q?"%":"")});}}}n.cs=x;n.parent.node.data.cs=x;n.set("unSet",AA);};this.updateThumb=function(){var p=n.cs1Idx,t=n.cs2Idx;if(p!==undefined&&t!==undefined){var q=n.unit,s=n.gap;N.copy(M(n,n,Y(p*q-s),Y(t*q-s)),n);}};this.joinConst=function(){var s=n.cs;if(s){var p=[],q;for(q in s){p.push(s[q].v);}return p.join(",");}};}var E="<span {@ttpCssText}>{@content}</span>";function D(){if(this.staticStatus){return null;}var q=this.ghost;if(!q){var u=this.containerNode.cloneNode(true),t=u.childNodes;X.addClass(u,["gh"]);q=this.ghost={containerNode:u,lowerRange:t[0],handle1Node:t[1],thumbNode:t[2],handle2Node:t[3],upperRange:t[4]};this.sdcNode.appendChild(u);}var o=this.orCfg,n=o.posCssP,p=o.lenCssP,s=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AA,w){var z=mstrmojo.all[s],y=z[AA].style,x=q[AA].style;if(w){x[n]=y[n];}x[p]=y[p];});q.containerNode.style.display="block";return q;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style=""><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:9px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:9px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},sliderNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);}},init:function h(n){this._super(n);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new O(this);this.useRichTooltip=false;},typeHelper:null,unSet:false,preBuildRendering:function A(){var q=this.orCfg,p=this.isHoriz;q.cPosCssP=p?"right":"bottom";q.cLenCssP=p?"height":"width";var u=q.lenCssP,t=this[u],s=parseInt(t,10),o=this.handleSize;var n=this._length=(isNaN(s))?0:(s-o-b);if(n<=0){n=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-o;}if(t){this.bkCssText=u+":"+d(s-(2*this.cssBkBW),0)+"px;";this.sdcCssText=q.posCssP+":"+b+"px;"+u+":"+n+"px;"+q.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function R(){this._super();if(!this.staticStatus&&!this.da.nov){var o=this.lowNode,n=parseInt(o.style.fontSize,10);if(isNaN(n)){o.style.fontSize=8*this.parent.model.getZoomFactor()+"pt";}this.updateSummary();}this.lowNode.style.marginLeft=b+"px";this.highNode.style.marginRight=b+"px";this.sliderNode.style.height="0px";},onmouseover:function G(n){this.showTooltip(n.e,self);},onmouseout:function g(n){this.hideTooltip(n.e,self);},summaryLabels:{db:J(8153,"Between ## and ###"),dnb:J(8154,"Not between ## and ###"),din:J(587,"In"),dnin:J(2204,"Not in"),dnull:J(2202,"Is Null"),dnnull:J(2203,"Is not Null"),req:J(8155,"Rank ="),rneq:J(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:J(8157,"Rank exclude bottom"),rext:J(8158,"Rank exclude top"),rb:J(8159,"Rank bottom"),rt:J(8160,"Rank top"),rbt:J(8161,"Rank between ## and ###"),rnbt:J(8162,"Rank not between ## and ###"),rin:J(8163,"Rank in"),rnin:J(8164,"Rank not in"),peq:J(8165,"Percent ="),pneq:J(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:J(8167,"Exclude bottom"),pext:J(8168,"Exclude top"),pb:J(7576,"Bottom"),pt:J(7575,"Top"),pbt:J(8153,"Between ## and ###"),pnbt:J(8154,"Not between ## and ###"),pin:J(8169,"Percent in"),pnin:J(8170,"Percent not in")},formatNumber:function i(u){var p=this,z=Math.abs(u),y=p.numFmts.cat,o=1000,AA=["K","M","B","T","P","E","Z","Y"],w=AA.length,t;if(z>=o&&(y===k.Default||y===k.Fixed||y===k.General||y===k.Currency)){for(t=0;t<w;t++,o*=1000){if(z<o*1000){var n=z/o,s=(n*10).toFixed(0)%10>0?1:0,x=n.toFixed(s)+AA[t];return u<0?"("+x+")":x;}}}return S.formatNumber(p.qua,u,p.numFmts);},updateSummary:function L(){if(this.summaryNode&&!this.staticStatus){var AH=this.f,p=this.ft,AG=S,AB=S.FN,o=S.MRPFN,y="",AE=(this.cs1Vl<this.cs2Vl)?this.cs1Vl:this.cs2Vl,AC=(this.cs1Vl>this.cs2Vl)?this.cs1Vl:this.cs2Vl,w=this.formatNumber(AE),u=this.formatNumber(AC),t=this.typeHelper,x=this.summaryLabels,n=parseInt(p,10),q=parseInt(AH,10),AD=(n===AG._GENERIC&&(q===AB.ISNULL||q===AB.ISNOTNULL||q===AB.NOTIN||q===AB.IN))||((n===AG._PERCENT||n===AG._RANK)&&(q===o.INASCENDING||q===o.INDESCENDING||q===o.NOTINDESCENDING||q===o.NOTINASCENDING));if(this.unSet||AE<=this.low&&AC>=this.high&&this.include){y=mstrmojo.desc(2058,"All");}if(!this.unSet||AD){switch(p){case AG._GENERIC:switch(AH){case AB.EQUALS:y="= "+w;break;case AB.NOTEQUALS:y=String.fromCharCode(8800)+" "+w;break;case AB.GREATERTHAN:y="> "+u;break;case AB.GREATERTHANEQUALS:y=String.fromCharCode(8805)+" "+w;break;case AB.LESSTHAN:y="< "+w;break;case AB.LESSTHANEQUALS:y=String.fromCharCode(8804)+" "+u;break;case AB.BETWEEN:y=w+" - "+u;break;case AB.NOTBETWEEN:y=mstrmojo.desc(1099)+" "+w+" - "+u;break;case AB.ISNULL:y=x.dnull;break;case AB.ISNOTNULL:y=x.dnnull;break;case AB.IN:y=x.din+" "+t.joinConst();break;case AB.NOTIN:y=x.dnin+" "+t.joinConst();break;}break;case AG._PERCENT:case AG._RANK:var AF="r";if(parseInt(p,10)===AG._PERCENT){AF="p";}switch(AH){case o.EQUALSDESCENDING:case o.EQUALSASCENDING:y=x[AF+"eq"]+" "+w;break;case o.NOTEQUALSDESCENDING:case o.NOTEQUALSASCENDING:y=x[AF+"neq"]+" "+w;break;case o.GREATERTHANEQUALSASCENDING:y=x[AF+"exb"]+" "+w;break;case o.GREATERTHANASCENDING:y=x[AF+"exb"]+" "+u;break;case o.GREATERTHANEQUALSDESCENDING:y=x[AF+"ext"]+" "+w;break;case o.GREATERTHANDESCENDING:y=x[AF+"ext"]+" "+u;break;case o.LESSTHANASCENDING:y=x[AF+"b"]+" "+w;break;case o.LESSTHANEQUALSASCENDING:y=x[AF+"b"]+" "+u;break;case o.LESSTHANDESCENDING:y=x[AF+"t"]+" "+w;break;case o.LESSTHANEQUALSDESCENDING:y=x[AF+"t"]+" "+u;break;case o.BETWEENDESCENDING:case o.BETWEENASCENDING:y=x[AF+"bt"].replace("##",w).replace("###",u);break;case o.NOTBETWEENASCENDING:case o.NOTBETWEENDESCENDING:y=x[AF+"nbt"].replace("##",w).replace("###",u);break;case o.INASCENDING:case o.INDESCENDING:y=x[AF+"in"]+" "+t.joinConst();break;case o.NOTINDESCENDING:case o.NOTINASCENDING:y="";y=x[AF+"nin"]+" "+t.joinConst();break;}break;}}var z=this.summaryNode,AA=(y!=="")?"":0;z.innerHTML=y;z.style.margin=AA;}},getClientHeight:function U(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function l(s,n){if(!this.staticStatus&&!this.da.nov){n=n||window;var t=W.eventTarget(n,this.dnd.startE);if(t===this.handle1Node||t===this.handle2Node){var q=D.call(this),o=this.orCfg,p=this.dnd;p.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10)-b,length:this._length,contL:q.containerNode[o.lenP],offset:W.getMousePosition(this.dnd.startE,n)[o.offsetP]};p.initD.td=t;X.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function K(u,t){if(!this.staticStatus){t=t||window;var x=this.dnd.initD;if(x){var AD=this.ghost,AE=x.handle1,q=x.handle2,s=this.cs1Idx,p=this.cs2Idx,AB=this.unit,z=this.gap,o=x.length;var AA=W.getMousePosition(u,t)[this.orCfg.offsetP]-x.offset;switch(x.td){case this.handle1Node:AE=d(H(d(x.handle1+AA,0),o)-z,-1);s=d(f(AE/AB+0.5),0);break;case this.handle2Node:q=d(H(d(x.handle2+AA,0),o)-z,-1);p=d(B.ceil(q/AB+0.5),0);break;default:return ;}M(this,AD,AE,q);var w=this.items,n=(w&&w.length)||0;if(n&&s>=0&&s<n&&p>=0&&p<n){var AC=false,y;if(s!==this.cs1Idx){this.cs1Idx=s;y=this.items[s];this.cs1Vl=y.v;this.cs1Nm=y.n;AC=true;}if(p!==this.cs2Idx){this.cs2Idx=p;y=this.items[p];this.cs2Vl=y.v;this.cs2Nm=y.n;AC=true;}if(AC){this.typeHelper.updateThumb();this._updateTooltip(x.td);}}}}},ondrop:function a(o){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var n=this.ghost;if(n){n.containerNode.style.display="none";}this.hideTooltip(o,self);var p=this.dnd&&this.dnd.initD;if(this.makeSelection&&p){this.makeSelection({selItem:p.td});}if(this.items&&this.items.length&&this.ghost){this[(W.eventTarget(self,o)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function Q(){var n=this.typeHelper,p=this.cs1Vl,o=this.cs2Vl,t=this.qua,s=this.numFmts;this.cs1Idx=n.getIdx(p);this.cs2Idx=n.getIdx(o);this.cs1Nm=S.formatNumber(t,p,s);this.cs2Nm=S.formatNumber(t,o,s);n.updateOpCs();this.onselectionChange();this.updateSummary();},onincludeChange:function C(){if(!this.staticStatus){this.changeInclude=true;this.selectRange();}},showTooltip:function m(o,n){var p=W.eventTarget(n,o);this._updateTooltip(p);mstrmojo.tooltip.open(this,o,n);},_updateTooltip:function P(s){if(N.walk("handle1Node",this.ghost)===s||N.walk("handle2Node",this.ghost)===s){return ;}var o=this.orCfg,q=o.posCssP,n,p={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};p[o.opPosCssP]=-parseInt(this.font,10)/2;p[q]=s.style[q];n=String((s===this.handle1Node)?this.cs1Nm:this.cs2Nm);p.content=E.replace(/\{@content\}/g,n);this.set("richTooltip",p);},onclick:function c(n){if(!this.staticStatus&&!this.da.nov){var o=W.eventTarget(n.hWin||window,n.e);this.hideTooltip(n.e,self);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((o===this.handle1Node)?this.handle1Node:((o===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(o===this.handle1Node),tgt:o});if(this._onThumb){this._onThumb(n);}}},onselectionChange:function I(n){this._super(n);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function e(n){var p=S.getFuncInfo(this.opId,n.valueWas),q=S.getFuncInfo(this.opId,n.value),o;if(p.ft!==q.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();o=true;}}else{this.f=S.getFuncInfo(this.opId,n.value).f;o=false;}this.unSet=o||this.unSet;this.changeQual=true;this.selectRange();},updateData:function F(n,o){this.da=n;this.updateExpr(o);},updateExpr:function j(n){if(n){this.cs=n.cs;this.f=n.f;this.ft=n.ft;this.qua=n.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",H(d(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var p=this.opener,o=this.children[0];if(p){var n=this.isfrt?p.cs1Vl:p.cs2Vl;o.edt.set("value",Z.toLocaleString(n));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!==0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(o){if(this.parent.apply.enabled){var n=o.hWin,p=o.e||n.event;if(p.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var o=this.parent.parent,q=o.opener,n=this.parent.edt.value;if(o&&q&&String(n).length>0){q[o.isfrt?"cs1Nm":"cs2Nm"]=n;n=Z.parseNumeric(n);q[o.isfrt?"cs1Vl":"cs2Vl"]=n;}q[o.isfrt?"frtUst":"ndUst"]=true;q.selectRange();q.typeHelper.updateThumb();o.close();}}]}]},openEditValue:function(n){this.openPopup("editValueRef",n);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!=this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.vi.ui.rw._SupportTabNav","mstrmojo.ui.menus.MenuEditor","mstrmojo.dom");var F=mstrmojo.dom;function E(){F.attachEvent(this.domNode,"keydown",function(H){F.captureDomEvent(this.id,this.evtName,self,H);}.bind({id:this.id,evtName:"keydown"}));}mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function G(H){this._super(H);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function D(){var H=mstrmojo.ui.menus.MenuEditor;if(this.hasAccessibility){H=mstrmojo.DynamicClassFactory.newComponent(H,[mstrmojo._IsAccessibleMenu]);}else{if(this.canTab){H=mstrmojo.DynamicClassFactory.newComponent(H,[mstrmojo.vi.ui.rw._SupportTabNav]);}}return new H({popupConfig:this});},onOpen:function B(){if(this._super){this._super();}if(this.popupConfig.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}if(this.canTab){E.call(this);if(this.domNode&&this.popupConfig.editorRole){this.domNode.setAttribute("role",this.popupConfig.editorRole);}if(this.popupConfig.navMode){this.navigateToFirstValidTarget();}}},destroy:function C(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("enabled",this.enabled);this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",nextAriaLabel:"",prevAriaLabel:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next" role="button" aria-label="{@en@nextAriaLabel}">+</div><div class="text"></div><div class="prev" role="button" aria-label="{@en@prevAriaLabel}">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;if(!!mstrApp.isWSStyling){this.layoutConfig=null;}this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,maxLength:G.maxLength,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css","mstrmojo.util.color");mstrmojo.requiresDescs(16164);var R=1,b=2,S=mstrmojo,B=S.css,U=S.array,X=mstrmojo.util.ui.ColorPicker,J=S.util.color,P=Math.round,a=R,N=0,D=1,Y=2,d="txtColor",g="automatic",j="#ffffff",A="transparent";var F=[{n:mstrmojo.desc(12071,"Color fill"),id:N},{n:mstrmojo.desc(12072,"No fill"),id:D},{n:mstrmojo.desc(12073,"Gradient"),id:Y}];function O(){return this.color!==g?this.color:this.autoPreviewColor;}function W(m){return J.getCSSColorString(m);}function c(o,n,m){return mstrmojo.Button.newWebButton(o,m,n,{slot:"buttonNode",cssDisplay:"inline-block"});}function l(n){var o={},m=O.call(this);if(n&&(typeof m==="string")){if(m!==A){m=W(m);}var p=m.toLocaleLowerCase();n.forEach(function(s,q){if(p===s.id.toLocaleLowerCase()){o[q]=true;}});}return o;}function Q(m){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:m,selectedIndices:l.call(this,m),postselectionChange:function(n){var q=n.added;if(q){var p=this.parent,o=this.items[q[0]].id;p.set("color",o);p.colorChanged(o);}}};}function G(m){return"#"+m.replace("#","");}function E(){var m=this.txtColor1,p=this.txtColor2,n=this.color,o=false,q=this.colorStyle;switch(q.items[q.selectedIndex].id){case N:n=G(m.value);break;case D:n=A;break;case Y:n={or:this.gradientOrientation.getSelectedItems()[0].id,c1:G(m.value),c2:G(p.value)};o=true;break;}B.toggleClass(this.containerNode,"grad",o);this.set("color",n);}function L(m){this.set("activeColor",m);var n=this[m];U.forEach([1,2],function(p){var o=this[d+p];B.toggleClass(o.domNode,"on",o===n);},this);this.colorWheel.set("color",G(n.value));}function K(m,n,p,q){if(typeof p==="string"){if(p===A){p=j;}}else{if(!!p&&p.c1){p=p["c"+m];}else{p=j;}}p=W(p);var o=15;return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:d+m,cssDisplay:"block",label:n,labelTitle:n.length>o?n:"",labelClass:n.length>o?"ellipsisStyle":"",autoCorrect:false,maxLength:6,size:6,value:p.replace("#",""),bindings:q,onfocus:function(){L.call(this.parent,this.alias);},onvalueChange:function(s){if(!/^[0-9a-fA-F]{0,6}$/.test(s.value)){this.value=s.valueWas;}else{if(this.value.length===6){var t=this.parent;t.colorWheel.set("color",G(this.value));E.call(t);}}}};}function H(){var p=O.call(this),o="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",t=o+" === "+Y,s=o+" !== "+D,x=(this.showNoFill&&p===A)?1:0,u=F.slice(0,this.showGradient?3:2),m=0,n=this.showGradient,w=!!p&&p.c1;if(!this.showNoFill){u.splice(1,1);}if(w){x=U.find(u,"id",Y);m=p.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:x,items:u,visible:(u.length!=1||(w&&!n)),onRender:function q(){if(!n&&w){this.selectedNode.innerHTML='<div class="mstrmojo-ui-Pulldown-Gradient" style="color:#C0C0C0">'+mstrmojo.desc(16164,"Gradient (Not supported)")+"</div>";}},onitemSelected:function(){E.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:m,bindings:{visible:t},postselectionChange:function(y){if(y.added){E.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:t},onclick:function(){var AA=this.parent,z=AA.txtColor1,AB=AA.txtColor2,y=z.value;z.set("value",AB.value);AB.set("value",y);E.call(AA);}},K(1,mstrmojo.desc(12074,"Color HEX:"),p,{visible:s,label:o+" === "+Y+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),K(2,mstrmojo.desc(12076,"Color 2 HEX:"),p,{visible:t}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:(!!p&&!!p.c1)?p.c1:(p||j),onColorPicked:function(y){var z=this.parent;z[z.activeColor].set("value",y.replace("#",""));},bindings:{visible:s}},c(mstrmojo.desc(1442,"Ok"),true,function(){var z=this.parent,y=z.color;if(!y.c1){X.addCustomColor(y);}z.colorChanged(y);}),c(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);L.call(this,d+"1");}function f(o){var q=this.sampleNode,p=q.offsetWidth-q.clientWidth,n=q.clientWidth,s=q.clientHeight,t=Math.sqrt(n*n+s*s)-p,m=Math.atan2(s,n)*(-180)/Math.PI+2;q.style.backgroundColor="#FFFFFF";o.display="block";o.top=q.offsetTop+P(s/2)+"px";o.left=q.offsetLeft+"px";o.width=P(t)+"px";o[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+P(m)+"deg)";}function k(){var o=O.call(this),n=this.sampleNode.style;if(o){if(o.c1){var p=B.buildGradient(o.or,o.c1,o.c2);n[B.convertCssToCamelCase(p.n)]=p.v;}else{n.background=o;if(this.showNoFill&&this.noFillNode&&this.enabled){var m=this.noFillNode.style;if(A===o){f.call(this,m);}else{m.display="none";}}}}n.backgroundOrigin="border-box";}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div><div class="slash"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.childNodes[2];},noFillNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function M(){a=this.pickerMode;this.renderContent();},oncolorChange:function e(){k.call(this);},onautoPreviewColorChange:function i(){k.call(this);}},color:"#000fff",showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:d+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:R,init:function h(m){this._super(m);this.pickerMode=a;},renderContent:function I(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function C(){var o=this;this.removeChildren();var p=a===R;if(p){var n=X.getBasicColors();if(!this.showNoFill){n.shift();if(n[0]._renderIdx!==0){U.forEach(n,function(s,q){s._renderIdx=q;});}}if(this.showAutomatic&&this.color!==g){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function m(){o.set("color",g);o.colorChanged(g);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},Q.call(o,n)),Q.call(o,(mstrApp&&mstrApp.getPreferredColors)?U.map(mstrApp.getPreferredColors(),function(q){return{n:q,id:q};}):[]),Q.call(o,X.getCustomColors())]);}else{H.call(this);}B.toggleClass(this.swatchBtnNode,"on",p);B.toggleClass(this.paletteBtnNode,"on",!p);this.buttonNode.style.display=p?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Z(m){var n=m.getTarget(),o=this.pickerMode;if(n===this.swatchBtnNode){o=R;this.set("pickerMode",o);}else{if(n===this.paletteBtnNode){o=b;this.set("pickerMode",o);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=g;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo._FillsBrowser","mstrmojo.Container","mstrmojo.EnumRWUnitType","mstrmojo.Label","mstrmojo.ui.PopupButton","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.TruncatedList","mstrmojo.elementHelper");mstrmojo.requiresClsP("mstrmojo.vi.models","EnumPanelTypes");var Z=mstrmojo.hash,h=mstrmojo.array,E=mstrmojo.css,R=mstrmojo.dom,p=mstrmojo.string,i=mstrmojo.Button.newWebButton,O=mstrmojo.EnumRWUnitType,k=mstrmojo.vi.models.EnumPanelTypes,c=mstrmojo.vi.enums.EnumFeatures,a={SHARED:0,SEPARATE:1},C=mstrmojo.elementHelper.ELEM_SEPARATOR,l=null,L=function(s){var t=this.vis.model,w=s.panelKey,u=this.currentPanelKey||t.getVizContentPanel().k;if(w===u){return ;}if(this.targetContainer.getTargetChildren().length===0){this.goToPage(s);return ;}this._tocNavWarn(s);},D=function(){var s=mstrApp.rootCtrl,AC=s.view,t=s.vizControlPanel,x=s.toggleViewBar,AA=s.tocPanel,u=s.datasetsPanel,AB=s.layersPanel,y=this.vis.model,AD=[],z,w;z=[x,u,AB];this.isCPVisible=w=AC.isCPVisible;h.forEach(z,function(AE){AD.push(AE&&AE.getOpenStatus());});this.vizControlSelectedPanel=t.getSelectedPanel();this.panelsIsOpen=AD;this.panels=z;if(this.tocEnabled){if(!w){AC.setIsCPVisible(true,true);}this.isTocNav=AA.visible;if(!mstrApp.supportFeature(c.PANEL_STACK)||Z.walk("srcBox.parent.parent.defn.psType",this.targetSelector)===k.VISUALIZATION){AA.set("isMasked",false);this.setNavIcon(true,true);}}if(this.vizControlSelectedPanel!==AB){t.selectPanel(AB,true);}if(y.attachEventListener){this.layoutSelectedSubscription=y.attachEventListener("targetLayoutSelected",this.id,L.bind(this));}},U=function(){var y=this.vis.model,AB=mstrApp.rootCtrl.view,AC=this.panelsIsOpen,s=mstrApp.rootCtrl,AA=s.layersPanel,t=s.vizControlPanel,x=this.isCPVisible,w=this.vizControlSelectedPanel,z=this.panels;var u=AC[z.indexOf(AA)];if(u&&w){t.selectPanel(w,false);}h.forEach(z,function(AD,AE){AD.setOpenStatus(AC[AE],true,undefined,false,true);});if(this.tocEnabled){if(!x){AB.setIsCPVisible(x,true);}this.setNavIcon(false,true);}if(y.detachEventListener){y.detachEventListener(this.layoutSelectedSubscription);}},e=function(AD){var AE=AD.length,u=this.targetContainer.getTargetChildren(),y=u.map(function(AF){return AF.key;}).sort(h.stringSorter),AA=y.length,t,w,AB,z,AC,x=[],s=this.vis.isPanelSelector();if(s){if(!y.length){if(AD.length){this.targetContainer.addAndRemoveKeys([this.targetKeys[AD[0]]],true);}}else{if(!AD.length){this.targetContainer.addAndRemoveKeys([this.targetKeys[y[0]]],false);}else{this.targetContainer.addAndRemoveKeys([this.targetKeys[AD[0]]],true);this.targetContainer.addAndRemoveKeys([this.targetKeys[y[0]]],false);}}return ;}if(AE>AA){t=AA;w=AD;z=true;}else{t=AE;w=y;z=false;}for(AB=0;AB<t;AB++){if(AD[AB]!==y[AB]){this.targetContainer.addAndRemoveKeys([this.targetKeys[w[AB]]],z);return ;}}for(AB;AB<w.length;AB++){AC=this.targetKeys[w[AB]];if(AC){x.push(AC);}}if(x.length){this.targetContainer.addAndRemoveKeys(x,z);}},J=function(s){var t=s.getVizContentPanel()._tgtSelections;if(t){t.notify();}},G=function(s){if(this.options){this.csl.set("enabled",s);this.options.set("enabled",s);}};function Y(){var s=this.vis.model,u=this.vis.k,t;if(!this.targetSelector){this.targetSelector=this._createTargetSelector();}else{this.targetSelector.set("hostId",this.id);if(!mstrmojo.all[this.vis.id]){t=s.getLayoutKeyByUnitKey(u);if(t===s.getCurrentLayoutKey()){this.targetSelector.setSourceByKey(u);}}}this.showControlOverlay([this.targetSelector]);this.targetSelector.enterSelectMode();}function S(){var u,w=this.sc,s=w&&w.isNavigation&&w.navPage,t=this.options;if(this.vis.model.getVizContentPanel().children){if(t){t.closeDialog();}delete this.children;this.refresh();if(!s||s===this.currentPanelKey){u=Z.valarray(this.targetKeys).filter(function(x){return x.v;}).map(function(x){return x.k;}).sort(h.stringSorter);if(u.length){e.call(this,u);}}}}function F(u){var s=u.boxContent,AD=s.isVisMap,AB=AD?s.getWidgetForTemplateSelection().node.defn:u.defn,x=s.model,y=(this.srcPanelKey===u.model.getVizContentPanel().k),AC,w,t=0,AA,z;this.cgbs=z=(x&&x.getSelectorControlMapInfo?x.getSelectorControlMapInfo():[]);if(z.length>0){AC=z[0].sc;this.unitId=z[0].did;this.singleUnit=true;}else{AA=AB.an;AC=s.selectorControl||(x&&s.findSelectorControl&&s.findSelectorControl());this.singleUnit=false;w=(AC&&AC.tks&&AC.tks.split(C))||[];t=h.some(AA,function(AE){return !h.includes(w,AE.k);})?1:0;}this.cachedFiltertypeIndex=(!!AA&&AA.length>0)&&!this.singleUnit&&!AC?1:t;if(l===null){l=y&&(AC?AC.showall:true);}this.sc=AC;this.an=AA;}mstrmojo.vi.ui.InlineDialogBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.vi.ui.InlineDialogBase",cssClass:"mstrmojo-inline-dialog",title:mstrmojo.desc(12136,"Filtering options"),targetKeys:null,vis:null,buttons:null,origTargetKeys:[],changes:{},sc:null,singleUnit:null,cgbs:null,unitId:null,an:null,panelsIsOpen:null,panels:null,vizControlSelectedPanel:null,isCPVisible:null,srcPanelKey:null,shouldNavigate:true,cachedFiltertypeIndex:0,numBoxesChecked:0,optionsStateForRefresh:{openOnRefresh:false,showAll:false},layoutSelectedSubscription:null,tocEnabled:true,isTocNav:false,isOnTocChange:false,selectFilters:false,fromContextual:false,onClickBack2Link:null,targetSelector:null,markupString:'<div id="{@id}" class="mstrmojo-Dialog-Bar {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-bar"><div class="mstrmojo-bar-content"></div><div class="mstrmojo-bar-buttons"></div></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.lastChild;}},init:function o(t){if(this._super){this._super(t);}this.srcPanelKey=this.vis.parent.k;var s=this.vis.model;if(s.attachEventListener){s.attachEventListener("buildBoxLayoutComplete",this.id,this.buildBoxLayoutComplete);}},buildBoxLayoutComplete:function q(){var s=this.vis.model;if(this.tocEnabled&&!this.isTocNav){this.setNavIcon(true,true);}S.call(this);if(this.isOnTocChange){var u=s.getVizContentPanel()._tgtSelections,t=Z.valarray(this.targetKeys).filter(function(w){return w.v;}).map(function(w){return w.k;});if(u){h.forEach(t,function(w){s.getUnitInstance(w,1).parent.toggleBoxSelection(true);if(!u.toggleSelection(w)){u.toggleSelection(w);}});this.isOnTocChange=false;}}J(s);},getSrcPanelStackId:function M(){return this.vis.model.getOwningNodeByType(O.PANELSTACK,this.vis.k).id;},_createTargetSelector:function j(){return new mstrmojo.vi.ui.TargetSelector({alias:"targetSelector",orientation:"h",hostId:this.id,srcPanelStackId:this.getSrcPanelStackId(),srcId:this.vis.id});},_createOptionsButton:function I(){var w=this,y=w.vis,t=y.model,u=(this.srcPanelKey===(this.currentPanelKey||t.getVizContentPanel().k));return{scriptClass:"mstrmojo.ui.PopupButton",alias:"options",cssDisplay:"inline-block",isHostedWithin:false,anchorSlot:"btnNode",markupString:'<div id="{@id}" class="mstrmojo-ui-OptionsButton {@cssClass}" style="{@cssText}"><div class="opts" mstrAttach:click></div></div>',markupSlots:{btnNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onRender:function(){if(this._super){this._super();}E.toggleClass(this.domNode,"disabled",!this.enabled);},onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},getPopupWidget:function x(){return this.optionEditor;},getPopupConfig:function s(){var AA=mstrmojo.ui.PopupConfig.ENUM_CORNERS,z=this.constructor.prototype.getPopupConfig.call(this);z.alignment={host:AA.BOTTOM_RIGHT,popup:AA.TOP_RIGHT};return z;},openDialog:function(){var AA=w.optionsStateForRefresh,z=this.optionEditor;if(AA.openOnRefresh){AA.openOnRefresh=false;z.clrSel.set("checked",AA.showAll);z.open();}},closeDialog:function(){var AA=w.optionsStateForRefresh,z=this.optionEditor;if(z.visible){AA.openOnRefresh=true;AA.showAll=z.clrSel.checked;z.close();}},children:[{scriptClass:"mstrmojo.ui.PopupWidget",alias:"optionEditor",visible:false,onClose:function(){this.clrSel.set("checked",l);this.buttons.enableApply(false);},handleSelectionSubmit:function(z){var AA=w.changes;if(z){if(AA.clearAll!==undefined){delete AA.clearAll;}else{AA.clearAll=w.csl.checked;}l=w.csl.checked;J(t);}this.close();},children:[{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",cssDisplay:"inline-block",cssText:"white-space: nowrap;",alias:"clrSel",enabled:false,checked:l,label:mstrmojo.desc(11957,"Allow users to clear all selections"),onenabledChange:function(){if(!u){this.enabled=false;this.set("checked",false);}else{if(!w.filterType.isFilter){this.set("checked",true);}else{this.set("checked",l);}}},oncheckedChange:function(){var z=this.parent;if(z){z.buttons.enableApply(this.enabled&&this.checked!==l);}}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttonBox",children:[i(mstrmojo.desc(8473,"Done"),function(){var z=this.parent.parent;z.handleSelectionSubmit(true);},true,{cssDisplay:"inline-block",enabled:false}),i(mstrmojo.desc(221,"Cancel"),function(){var z=this.parent.parent;z.handleSelectionSubmit(false);},false,{cssDisplay:"inline-block"})],enableApply:function(z){this.children[0].set("enabled",z);}}]}]};},_createBack2LinkButton:function(){var s=this;return{scriptClass:"mstrmojo.Widget",alias:"back2EditLink",cssDisplay:"inline-block",markupString:'<div class="back-to-edit-link" mstrAttach:click>'+mstrmojo.desc(null,"Edit Contextual Link")+"</div>",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onclick:function(){if(s.onClickBack2Link){s.close();s.onClickBack2Link();}},};},validT:function B(u){if(u){var s=u.t;if(this.selectFilters){return Math.round(s/10)===52||s===O.SELECTOR||s===O.MOJOVISUALIZATION||s===O.SURVEYCONTAINER||s===O.PANELSTACK;}else{return Math.round(s/10)===52||s===O.MOJOVISUALIZATION||s===O.PANELSTACK;}}return false;},setNavIcon:function H(w,z){var AC=this.vis,x=AC.model,AB=x.getDocVIVisualizationsPanelStack().selector,AA=x.controller.view,t=AA.layoutViewer.docLayout.selector,s=mstrApp.rootCtrl,y=s.tocPanel,u=AC.k;if(this.isTocNav){y.setTOCIcon(w,z);}else{if(z||!w){t.setLinkIcon(w,z?x.getLayoutKeyByUnitKey(u):null);}AB.setLinkIcon(w,z&&AC.defn.pnk);}},getTargetKeys:function(){var s=[];Z.forEach(this.targetKeys,function(u,t){if(u.v){s.push(t);}});s.sort(h.stringSorter);return this.origTargetKeys=s;},setTargets:function(AD){var x=this.targetKeys,t=this.vis,w=t.model,u=this.currentPanelKey||w.getVizContentPanel().k,y=[],AC=this.changes,z=this.singleUnit,AA=this.srcPanelKey,s=this.filterType;AD=w.updateFilterTargetsForSdp(AD);h.forEach(this.an,function(AE){if(!x[AE.k]){x[AE.k]={c:false,v:true};}});h.forEach(AD,function(AE){if(x[AE]){y.push(AE);}});Z.forEach(x,function(AF,AE){if(h.some(AD,function(AG){return AG===AE;})){if(!AF.v){AF.v=true;AF.c=true;}}else{if(AF.v){AF.v=false;AF.c=true;}}});AC.filterKeys=y;AC.targetKeys=x;AC.singleUnit=z;if(z){AC.unitId=this.unitId;}if(AA!==u){AC.isNav=true;AC.navPage=u;AC.srcKey=AA;}AC.sc=this.sc;AC.isFilter=s&&s.isFilter;var AB=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(AB.PAUSE|AB.SELECTOR_TARGETING):AB.SELECTOR_TARGETING);this._setTargetsFunc();},_setTargetsFunc:mstrmojo.emptyFn,isSelectionDirty:function Q(AB){var z=false,s=this.vis,AC=AB.length,y=this.origTargetKeys,AA=this.changes;AB.sort(h.stringSorter);e.call(this,AB);if(s.isAMSelector instanceof Function&&s.isAMSelector()){for(var u=0;u<AC;u++){if(!s.tmp_replaceRelation[AB[u]]){return false;}}}if(AC===y.length){h.forEach(AB,function(AE,AD){if(AE!==y[AD]){z=true;return false;}});if(z){return z;}if(AC>0){var t=Z.walk("filterType.selectedIndex",this);if((t!==undefined)&&(t!==this.cachedFiltertypeIndex)){return true;}if(AA.isLayerChanged){return true;}if(AA.clearAll!==undefined){return true;}if(s.isAMSelector instanceof Function&&s.isAMSelector()){for(var x=0;x<AB.length;x++){if(s.tmp_replaceRelation[AB[x]].id!==s.replaceRelation[AB[x]].id){return true;}}}}return false;}else{if(AC===0||AC<y.length){return true;}if(s.isAMSelector instanceof Function&&s.isAMSelector()){for(var w=0;w<AC;w++){if(!Z.equals(s.tmp_replaceRelation[AB[w]],s.replaceRelation[AB[w]])){return true;}}return false;}else{return true;}}},goToPage:function N(s){var t=this.vis.model,u=s.layoutKey,w=s.panelKey;t.raiseEvent({name:"layoutSelected",panelKey:w,layoutKey:u});},_tocNavWarn:mstrmojo.emptyFn,onTocPageChange:function(u){var t,s;if(this._super){this._super(u);}if(this.visible){if(this.srcPanelKey===this.currentPanelKey){t=this.vis.model.getVizContentPanel().children;if(t){s=h.find(t,"k",this.vis.k);if(s!==-1){this.vis=t[s];}}else{return ;}}this.setNavIcon();if(!this.isTocNav){this.setNavIcon(true,true);}this.isOnTocChange=true;S.call(this);}},open:function b(){var s=this.vis;this.shouldNavigate=false;Y.call(this);D.call(this);if(s.setSelectTargetsState){s.setSelectTargetsState(false);}},close:function n(){var t=this.vis;mstrApp.rootCtrl.view.closeInlineDialog();U.call(this);this.targetContainer.addAndRemoveKeys(this.targetContainer.getTargetChildren());var s=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?s.PAUSE:s.DEFAULT);l=null;if(t.setSelectTargetsState){t.setSelectTargetsState(true);}},cancel:function f(){var t=this.vis.model,w=t.getLayoutKeyByUnitKey(this.vis.k),s=this.srcPanelKey,x=t.getOwningWidgetByType&&t.getOwningWidgetByType(O.PANELSTACK,this.srcPanelKey,w);var u=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",mstrApp.isAppStatePause()?(u.PAUSE|u.SELECTOR_TARGETING):u.SELECTOR_TARGETING);t.raiseEvent({name:"layoutSelected",panelKey:s,panelStackKey:x,layoutKey:w});},onwidthChange:function(){if(this.editorNode){this.editorNode.style.width=this.width;}},updateViz:function K(s){this.vis=s;this.srcPanelKey=this.vis.parent.k;this.targetSelector.set("srcId",this.vis.id);this.shouldNavigate=true;S.call(this);this.shouldNavigate=false;},toggleFields:function X(){var t=this.filterType,s=this.cgbs;if(s.length!==0){this.forType.set("visible",true);}if(this.sc){G.call(this,true);}if(this.srcPanelKey===(this.currentPanelKey||this.vis.model.getVizContentPanel().k)&&(Z.keyarray(this.targetKeys).length>0||s.length!==0)){t.set("enabled",true);}else{t.set("enabled",false);t.set("selectedIndex",0);}},_createTruncatedList:function P(){var s=this;return{scriptClass:"mstrmojo.vi.ui.TruncatedList",alias:"targetContainer",cssDisplay:"inline-block",items:[{alias:"defaultItem",cls:"tgtDefault",n:this.selectFilters?mstrmojo.desc(16167,"Click on elements to select targets"):mstrmojo.desc(15090,"Click on visualizations to select targets"),key:"-1"}],padding:12,overflowCls:"truncMore",cmCssClass:"mstrmojo-bar-overflow",setWidth:function t(){var y=this.parent,w=this.id,z,AA=this.padding,x=parseInt(y.width,10);if(!this.width&&R.position(y.buttonNode).w){h.forEach(y.children,function(AB){z=AB.domNode;if(z&&AB.id!==w){x-=Math.ceil(R.position(z).w+(AB.scriptClass==="mstrmojo.ui.Pulldown"||AB.alias==="ctrlOverlay"?0:AA));}});if(R.isMac()&&(R.isSafari||mstrApp.isWorkstation)){x-=AA;}this.width=x+"px";}this.domNode.style.width=this.width;},getAdditionalProperties:function u(x,w){if(w===0&&this.items.length>2){x.addCls("hide");}return x;},updateFields:function(){var x,w=s.filterType&&s.filterType.isFilter;s.numBoxesChecked=this.items.length-1;x=s.numBoxesChecked>0;s.forType.set("enabled",x&&w);G.call(s,x&&w);},getTargetChildren:function(){return this.items.slice(1);},addAndRemoveKeys:function(AA,x){var w,AB=false,z=this.items;if(x){AB=true;var y={};y[a.SHARED]="filter";y[a.SEPARATE]="viz";y[O.SURVEYCONTAINER]="survey";h.forEach(AA,function(AC){if(!AC.mp||AC.mp===AC.k){var AD=y[AC.ft]||y[a.SHARED];z.push({n:AC.t,cls:"tgtItem "+AD,cssClass:"tgtItem "+AD,key:AC.k});}});}else{h.forEach(AA,function(AC){w=AC?h.find(z,"key",AC.k||AC.key):-1;if(w>-1){AB=true;z.splice(w,1);}});}if(AB){this.refresh();this.updateFields();s.setNavIcon(z.length!==1);}}};},_addVis:function d(t,u){var AC=this,s=AC.vis,w=t.boxContent,AD=w.isVisMap,AA=AC.cgbs||[],AB=AC.an,AF,z,y,x;if(AB){AF=mstrmojo.array.find(AB,"k",t.k)!==-1;}else{if(AA.length>0){if(AA[0]&&AA[0].sc&&AA[0].sc.tks){AF=AA[0].sc.tks.indexOf(t.k)>-1;}}}AC.numBoxesChecked+=AF?1:0;if(t!==s&&AC.validT(t.defn)){var AE=t.defn.t===O.SELECTOR;if(!AE){z=w.getFilterTarget&&w.getFilterTarget()||w.getFilterType();y=w.model.getSelectorControlMapInfo&&w.model.getSelectorControlMapInfo();}if(AD){x=w.getAllLayerKeys(true);h.forEach(x,function(AG){u[AG]={c:false,v:AF,ft:z,cgbs:y,t:t.title,k:AG,mp:t.k};});}else{u[t.k]={c:false,v:AF,ft:z,cgbs:y,t:t.title,k:t.k};}}},_addChildren:function m(){var AF=this,u=AF.vis,AC=u.model,x={scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"inline-block",alias:"filterType",selectedIndex:AF.filterType?AF.filterType.selectedIndex:this.cachedFiltertypeIndex,isHostedWithin:true,isFilter:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(AJ){this.isFilter=AJ.v;G.call(AF,AF.numBoxesChecked>0&&this.isFilter);AF.forType.set("enabled",this.isFilter);if(this.enabled){J(AC);}},onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);}},y=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:mstrmojo.desc(15031,"Use visualization <span>#</span> to").replace("#",p.encodeHtmlString(u.title)),visible:true},x,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"inline-block",text:mstrmojo.desc(15032,"data on selection in"),visible:true},AF._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(this.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(AJ){AF.changes.forAllData=AJ.v;},onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);}},AF._createOptionsButton()],s=AC.getPanel(this.currentPanelKey,this.currentLayoutKey).children||[],AB,AA={};for(AB=s.length-1;AB>=0;AB--){AF._addVis(s[AB],AA);}var z=u.boxContent,AH=z&&z.mapViewer&&z.isVisMap;if(AH){var AG=p.encodeHtmlString(u.title),AI="Use % of <span>#</span> to % the following targets:",AD=mstrmojo.desc(15162,AI),t=AD.split("%")||[],w,AE=h.map(z.getGraphicLayerNameArr(),function(AJ){return{n:AJ.n,v:AJ.k};});if(t.length!==3){t=AI.split("%");}w=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:t[0].replace("#",AG),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"",cssDisplay:"inline-block",alias:"sourceLayer",selectedIndex:h.find(AE,"v",z.getKeyForTemplateSelection()),isHostedWithin:true,enabled:true,items:AE,onitemSelected:function(AK){var AJ=AF.changes;AJ.layerKey=AK.v;AJ.isLayerChanged=AK.v!==z.getKeyForTemplateSelection();J(AC);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:t[1].replace("#",AG),visible:true},x,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:t[2].replace("#",AG),visible:true}];y.splice(0,3);y=w.concat(y);}this.addChildren(y);this.targetKeys=AA;this.csl=this.options.optionEditor.clrSel;},preBuildRendering:function A(){var w=this,x=w.vis,s=x.model,y,u,t,z;F.call(this,x);y=this.sc;u=this.an;if(this.shouldNavigate&&u&&u.length){t=s.getLayoutKeyByUnitKey(u[0].k);z=y&&y.isNavigation&&y.navPage;if(z&&z!==this.currentPanelKey&&t){this.shouldNavigate=false;s.raiseEvent({name:"layoutSelected",panelKey:z,layoutKey:t});}}this._addChildren();this.addChildren([{scriptClass:"mstrmojo.Box",cssClass:"ctrlOverlay",alias:"ctrlOverlay",slot:"buttonNode"}]);this.toggleFields();this._super();},postBuildRendering:function W(){var s=this.targetContainer,t=this.sc;this.editorNode.style.width=this.width;this._super();this.changes={};if(l!==(t?t.showall:true)){this.changes.clearAll=l;J(this.vis.model);}Y.call(this);if(s&&!s.width){s.setWidth();}if(this.options){this.options.openDialog();}},showControlOverlay:function g(u,t){var w=this.ctrlOverlay,y=w.domNode;function x(z){var AA=z.children;if(AA&&AA.length){z.removeChildren();AA.forEach(function(AB){AB.destroy();});}}if(y){var s=["ctrlOverlay","or-h"];if(t){s.push(t);}y.className=s.join(" ");}w.set("visible",true);x(w);w.addChildren(u);E.addClass(this.domNode,"overlay");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var K=mstrmojo.array,F=mstrmojo.dom,D=mstrmojo.string,N=mstrmojo.hash,J=mstrmojo.Enum_Keys,A=19,G=J.ENTER,H=J.SPACE,M=J.ESCAPE,R=J.TAB,E=J.DOWN_ARROW,O=J.UP_ARROW;function Q(a){var d=!!a.list,c=d?a.list:a,b=this.parent;this.focusOnPopup=true;if(d){c.grabFocus(true);if(b.canTab){b.resetTabNav();}}else{c.focus();}}mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,enableAccessibility:true,editOnClick:false,init:function U(e){this._super(e);var a=this.getPopupList();a.renderOnScroll=this.renderOnScroll||a.renderOnScroll;a.renderBlockSize=this.renderBlockSize||a.renderBlockSize;var d=[];if((mstrApp.isWorkstation&&F.isMac())||F.isSafari){d=["clip-safari"];}mstrmojo.css.addWidgetCssClass(this,["mstrmojo-ui-SearchablePulldown"].concat(d));var c=a.constructor.prototype,b=a.getItemProps||c.getItemProps,f=a.getItemMarkup||c.getItemMarkup;a.getItemProps=function(k,h){var i=this._spft||"",m=k.n,j=m?m.toUpperCase().indexOf(i):-1,g=function(o){var n=[],p;K.forEach(o.split(";"),function(q){p=q.split(":");if(p.length===2&&p[0].toLowerCase()!=="color"){n.push(q);}});return n.join(";");};if(j===-1){i="";}var l=b.call(this,k,h);if(this.selectedIndices[h]){l.style=g(l.style);}if(m){l.before=m.slice(0,j);l.input=m.substring(j,j+i.length);l.after=m.slice(j+i.length,m.length);if(!D.trim(m)){l.after+=D.decodeHtmlString("<br/>");}}return l;};a.getItemMarkup=function(i,g){var h=f.call(this,i,g);if(i.n&&i.v!=="u;"){return h.replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");}return h;};this._originalFocusOnPopup=this.focusOnPopup;this.focusOnPopup=false;},onclick:function Z(a){if(this._originalFocusOnPopup!==undefined){this.focusOnPopup=false;}if(this.isClickingAnchorSlot(a)){var c=a.e.offsetX>=(this.selectedNode.offsetWidth-A),b=this.getPopupWidget().visible;if(!b||(b&&c)){this._super(a);this.set("isEditing",!b);}else{if(!this.isEditing){this.set("isEditing",true);}}}},setDefaultListAndIndex:function(e,f){var d=this.getPopupList(),b=this.text,a=K.find(e,"n",b);if(a===-1&&!this.allowCustomText){var c=d.items[0]||e[0];a=K.find(e,"n",c.n);}d.set("items",e);if(f){this.set("selectedIndex",a);}},onPopupWidgetClosed:function B(a){this.set("isEditing",false);var b=this.getPopupList(),c=b._oldItems;delete b._oldItems;if(c){this.setDefaultListAndIndex(c,a&&a.pressingEnter);}},_set_selectedIndex:function C(c,a){if(this.allowCustomText&&a===-1){this.selectedIndex=-1;this.onitemSelected(null,a);}else{this.isSearching=false;this._super(c,a,true);if(this.hasRendered){var b=this.selectedNode;this.text=b.innerText||b.textContent;}}return true;},stopEvt:function X(a){var b=a.e||a;a.preventDefault();b.stopPropagation();},onkeydown:function I(e){var d=this.parent,g=e.e||e,c=d.parent;if(d.handleTab&&d.handleTab(e)){return ;}this._super(e);var b=window.event||e.e,f=b.keyCode,a=this.getPopupWidget();if(f===G&&a.visible){a.close({pressingEnter:true});}else{if(this._originalFocusOnPopup&&(f===E||f===O)){Q.call(this,a);a.raiseEvent(e);}else{if(f===G){this.stopEvt(e);this.openPopup(a);Q.call(this,a);}else{if(f===M&&c.grabFocus){this.stopEvt(e);this.loseFocus(true);c.grabFocus(true);}else{g.stopPropagation();}}}}},onkeyup:function S(c){var a=window.event||c.e,d=a.keyCode,b=this.getPopupWidget();if(d===R||(!b.visible&&(d===G||(d===H&&!this.isEditing)))){this.stopEvt(c);return ;}this._super(c);if(d===M||d===G){this.stopEvt(c);if(b.visible){b.close();}if(d===M&&this.grabFocus){this.grabFocus(true);}}else{if(this.isEditing&&d!==E&&d!==O){this.processSearch();}}},processSearch:function P(){this.isSearching=true;this.hideTooltip();var a=[],c=this.getPopupList(),e=this.selectedNode.innerText,f=c._oldItems||c.items,b=e.toUpperCase(),d;b=b.replace(/<BR>/,"");if(b.length>0){K.forEach(f,function(g){d=g.n;if(d&&d.toUpperCase().indexOf(b)>-1){a.push(N.clone(g));}},this);}else{a=f;}c._spft=b;if(this.customizeSearchResult){this.customizeSearchResult(a);}c.set("items",a);if(c.adjustCornersForPopupOverflow){c.adjustCornersForPopupOverflow();}delete c._spft;c._oldItems=f;c.set("visible",c.items.length!==0);},getNavList:function W(){var a=N.walk("parent.parent.menuBtnInfo.btn",this);return[this,a];},updateAriaLabel:function Y(){var d=this.selectedNode,c=this.getPopupList(),a,b,e;a=this.text||"";b=a+(c.visible?"":", collapsed, popup");e=D.encodeHtmlString(b,true);if(d){if(d.getAttribute("aria-label")!==e){d.setAttribute("aria-label",e);}d.setAttribute("role","button");}},grabFocus:function L(){this.updateAriaLabel();if(this._super){this._super(true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Obj","mstrmojo.ui.ButtonBar","mstrmojo.ui.Checkbox","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ThreeColumnContainer");var D=mstrmojo.hash;mstrmojo.vi.models.editors.ControlsViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.ControlsViewFactory",getEditorGroup:function B(H,I){return new mstrmojo.vi.ui.editors.EditorGroup(D.copy(I,{children:H}));},getLabelAndControl:function G(J,K,M,O,L,N){var P=new mstrmojo.Label({text:J,setDimensions:function(S,Q){var R=this.domNode;if(R){R.style.width=Q;}}}),I=P,H=K;if(L){I=K;H=P;}I.slot="col1Node";H.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(D.copy(N,{col1Width:M||"40%",col2Width:O||"60%",children:[I,H],getLabel:function(){return P;},getCtrl:function(){return this.children.filter(function(Q){return Q!==P;})[0];}}));},getLabelAndControlWithMsg:function C(L,M,P,O,S,H,N,Q){var R=new mstrmojo.Label({text:L,setDimensions:function(Y,W){var X=this.domNode;if(X){X.style.width=W;}}}),U=new mstrmojo.Label({text:P?mstrmojo.desc(14548,"Changes will be applied after Desktop is restarted."):"",setDimensions:function(Y,W){var X=this.domNode;if(X){X.style.width=W;}},setText:function(W){this.text=W;}}),K=R,J=M,I=U;if(N){K=M;J=R;}K.slot="col1Node";J.slot="col2Node";I.slot="col3Node";return new mstrmojo.ui.editors.controls.ThreeColumnContainer(D.copy(Q,{col1Width:O||"30%",col2Width:S||"30%",col3Width:H||"40%",children:[K,J,I],getLabel:function(){return R;},getCtrl:function(){return this.children.filter(function(W){return W!==R;})[0];},getMessage:function(){return U;}}));},getPulldown:function F(I,L,H,K,J){return mstrmojo.ui.Pulldown.newPulldown(I,function(M,N){L.call(this,M.v,N&&N.v);},H,K,J);},getCheckboxAndLabel:function A(N,L,K){var J=new mstrmojo.ui.Checkbox({checked:N,oncheckedChange:function(){var O=this.checked;K.call(this,O,!O);}});var M=this.getLabelAndControl(L,J,"14px","100%",true);M.cssClass="checkLabel";var I=M.getLabel();I.onclick=function H(){J.onclick();};I.cssDisplay="inline-block";return M;},getButtonBar:function E(J,H,L,K){K=K||{};K.items=J;var I=new mstrmojo.ui.ButtonBar(K);I.singleSelect(H);I.postselectionChange=function(M){var N=this.items,O=N[M.removed&&M.removed[0]];L.call(this,N[M.added[0]],O);};return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.StackContainer","mstrmojo.TabContainer","mstrmojo.TabStrip","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui._IsValidURL","mstrmojo.vi.enums.EnumFeatures","mstrmojo.ui.editors.controls.PromptAndAnswerList","mstrmojo.ui.Checkbox");var a=mstrmojo.array,q=mstrmojo.Button,B=mstrmojo.css,K=mstrmojo.dom,L=mstrmojo.hash,p=mstrmojo.string,b=q.newWebButton,u=mstrmojo.vi.enums.EnumFeatures,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,F="http://",J={DISABLED:-1,URL:0,LINK_MSTR:1,LINK_PAGE:3,LINK_DOSSIER:4},k=[{n:mstrmojo.desc(16999,"Select a page in the dossier"),idx:0}],d=function(){return mstrApp.isSingleTier&&mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode();},U=function(x,w){var AA={navpagenm:1,tnm:1,prms:1};var z=new mstrmojo.XMLBuilder();z.addChild("hls");if(w){z.addAttribute("onw",1);}z.addChild("hl");L.forEach(x,function(AC,AB){if(!AA[AB]){z.addAttribute(AB,AC);}});var y=x.prms;if(y&&y.length>0){z.addChild("prms");a.forEach(y,function(AB){z.addChild("prm");L.forEach(AB,function(AD,AC){if(AC!=="nm"&&AC!=="hsp"){z.addAttribute(AC,AD);}});z.closeElement();});z.closeElement();}z.closeElement();z.closeElement();return z.toString();},W=function(x,w,y){return{Hyperlinks:U({idf:1,so:2,lt:J.LINK_MSTR,tid:x.tid,ttp:x.t,navpage:x.navPage,np:x.navPage,psf:x.psf,aopam:x.aopam,prms:x.prms,dtxt:y},w),ResolvedHyperlinks:"",};},e=function(AF,AB,AH,w,y){var AN=function(AO,AQ,AP){if(AP){return"<"+AO+AQ+">"+AP+"</"+AO+">";}return"<"+AO+AQ+"/>";},AG=function(AP,AO){return(AP!==undefined?" "+AO+'="'+AP+'"':"");},AC=w?1:undefined,AA=2,z=(AF===J.URL?p.encodeXMLAttribute(AB||""):undefined),AE=0,AM=(AF===J.LINK_MSTR?AH.did:undefined),AJ=(AF===J.LINK_MSTR?AH.t:undefined),x=(AF===J.LINK_MSTR?AH.st:undefined),AI=(AF===J.LINK_PAGE?AH.navPage:undefined),AK=p.encodeXMLAttribute(y||""),AL=1;var AD={};AD.Hyperlinks=AN("hls",AG(AC,"onw"),AN("hl",AG(AL,"idf")+AG(AA,"aopam")+AG(AK,"dtxt")+AG(z,"url")+AG(AF,"lt")+AG(AJ,"ttp")+AG(AM,"tid")+AG(x,"tstp")+AG(AI,"np")+AG(AE,"so")));AD.ResolvedHyperlinks="";if(AF===J.URL){AD.ResolvedHyperlinks=AN("hls","",AN("hl",AG(0,"index")+AG(AB,"url")));}return AD;},E=J.DISABLED,h={},N,l=function l(x){if(x.linkType!==undefined){return x.linkType;}var w=x.node.data;if(w.psf!==undefined){if(w.isAvailable===false){return J.LINK_MSTR;}if(!mstrApp.supportFeature(u.TEXT_IMAGE_DOSSIER_LINKING)){return J.DISABLED;}return J.LINK_DOSSIER;}if(w.navpage){return J.LINK_PAGE;}if(w.tid){return J.LINK_MSTR;}if(x.url){return J.URL;}return J.DISABLED;},j=function(w,x){return a.ensureArray(x).indexOf(w)>-1;},m=function m(w){return j(w,[J.LINK_DOSSIER,J.LINK_MSTR]);},C=function C(x){return p.decodeHtmlString(L.walk("defn.dl.items.0.n",x)||x.tooltip||"");},I=false,t=false,G=function(w,y){var x=function(z){return(z||[]).map(function(AA){return{id:AA.id,am:AA.am};});};return L.equals(x(w),x(y));},Z=function Z(){var y=this,AE=mstrmojo.all[this.hostId],w=L.walk("node.data",AE),AC=L.walk("tabgroup.tabstack",this),z=L.walk("selected.linkType",AC),AB=(E!==z),AF=C(AE)!==this.getCurrentTooltipText(),AA,x=AE.target==="_blank",AD=function(){return x!==y.getCurrOpenInNewWinStatus();},AG=false;if(this.hasRendered&&!I){switch(z){case J.DISABLED:AG=AB;break;case J.URL:AA=L.walk("urlSelector.linkText.text.value",AC);if(!mstrmojo.string.isEmpty(AA)&&AA!==F&&this.isValidURL(AA)){AG=AB||(AA!==AE.url)||AF;}break;case J.LINK_MSTR:if(h.did){AG=AB||(!w||w.tid!==h.did)||AD()||AF;}break;case J.LINK_PAGE:if(h.navPage){AG=AB||!w||w.tid!==h.tid||w.navpage!==h.navPage||AF;}break;case J.LINK_DOSSIER:if(h.navPage){AG=AB||!w||w.tid!==h.tid||w.navpage!==h.navPage||w.psf!==h.psf||w.aopam!==h.aopam||!G(w.prms,h.prms)||AF||AD();}break;default:break;}this.set("dirty",AG);}},O=function(AE){if(AE){var AD=this,AK=AD.docModel,AF=mstrmojo.all[this.hostId],AG=this.getSelectedTab(),x=AG.linkType,w=x===J.URL?true:(x===J.LINK_PAGE?false:this.getCurrOpenInNewWinStatus()),AA=this.getCurrentTooltipText(),AJ=p.encodeHtmlString(AA,true),AH=x===J.URL?L.walk("tabgroup.tabstack.urlSelector.linkText.text.value",this):undefined,y,AC,AM,AN,AL=x===J.LINK_DOSSIER&&h.tid,AO=function(){var AQ=AF?AF.model.getSelectedViUnit():null,AP=AF?AF.parent:null;if(AF&&AQ&&AQ.k===AP.k&&AP.id){AF.model.selectVIUnit(AF.parent.id,true);}AP.generateToolbar();},AB=["tid","tnm","ttp","tstp","navpage","navpagenm","psf","prms","aopam"],z=function(){return L.copyProps(AB,AF.node.data);},AI=function(AP){t=true;AF.defn.dl=AP.dl;AF.target=AP.target;AF.url=AP.url;AF.ourl=AP.ourl;AF.tooltip=AP.tooltip;AF.linkType=AP.linkType;AB.forEach(function(AQ){delete AF.node.data[AQ];});L.copy(AP.linkObjInfo,AF.node.data);t=false;AO();};if(!t){if(x===J.DISABLED){y={Hyperlinks:""};AN=true;}else{if(AH||h||w!==undefined){if(AL){y=W(h,w,AJ);}else{y=e(x,AH,h,w,AJ);}}}AC={dl:L.clone(AF.defn.dl),target:AF.target,url:AF.url,ourl:AF.ourl,tooltip:AF.tooltip,linkType:AF.linkType,linkObjInfo:z()};if(AA!==undefined||AN!==undefined){AF.tooltip=AN?"":AJ;if(AF.defn.dl){AF.parent.defn.dl.items[0].n=AN?"":AJ;}}AK.editLink(AF.parent,y,{success:function(AP){AF.linkType=x;AK.partialUpdate(AP.data,AK.getTargetDefn(AF.k),AP.defn);if(x===J.DISABLED){delete AF.defn.dl;delete AF.node.data.dl;delete AF.target;delete AF.url;}else{AF.target=w?"_blank":"";}AM={dl:L.clone(AF.defn.dl),target:AF.target,url:AF.url,ourl:AF.ourl,tooltip:AF.tooltip,linkType:x,linkObjInfo:z()};AO();},undo:function(){AI(AC);},redo:function(){AI(AM);}});}}this.close();},n=function(AA){var z=0,y=[{n:mstrmojo.desc(15776,"Select a page in this dossier"),idx:z++}],AC=AA.defn.layouts,x,w,AB;a.forEach(AC,function(AD){x=AD.units;y.push({n:AD.title,idx:z++});w=AA.getVisPanelKeys(AD.k,true);a.forEach(w,function(AE){AB=x[AE];y.push({n:AB.ttl,navPage:AE,idx:z++});});});return y;},P=function P(y,x){var w=L.walk("node.data.tnm",y);switch(x){case J.LINK_MSTR:w=h.n;break;case J.LINK_DOSSIER:w=h.tnm;break;default:}return w;},Y=function(y,x){var w="";if(x){w+=p.apply('<span class="link-tab-icon {@iconCSSClass}"></span>',{iconCSSClass:x});}w+=p.apply('<span class="link-tab-text">{@text}</span>',{text:y});return w;},X=function(x,z){var y=mstrmojo.vi.ui.DatasetUnitMenuUtils,w;if(z.onPopupOpen){z.onPopupOpen();}y.showObjectPicker(function(AB){var AA=L.walk("anc.items",AB);if(AA&&AA.length>0){N=AA[AA.length-1].did;}x(AB);},z.noReport?[H.DocumentDefinition]:[H.DocumentDefinition,H.ReportDefinition],z.folderLinksContextId,z.browsableViewMedias,N||z.parentFolderId,true,true)();w=y.getObjectPicker();if(!w._editorCloseFunction){w._editorCloseFunction=w.onClose;w.onClose=mstrmojo.func.composite([w.onClose,function(){if(z.onPopupClose){z.onPopupClose();}}]);}},c=function(y,x){var z={},w=L.clone(x)||[];a.forEach(y,function(AA){z[AA.id]=AA;});return w.map(function(AA){return L.copy(z[AA.id],AA);});},M=function(y,AA){var w=mstrmojo.desc(17005,"This Dossier");var x=[{n:w,id:0}];if(mstrApp.supportFeature(u.TEXT_IMAGE_DOSSIER_LINKING)){x.push({n:mstrmojo.desc(18450,"Choose another dossier..."),id:1});}return new mstrmojo.ui.Pulldown({alias:AA.alias,slot:AA.slot,cssClass:"link-dossier-selector",items:x,selectedIndex:-1,setSelectedDossier:function(AC,AB){this.set("value",AC?w:AB);},getPopupListConfig:function z(){var AC=this;var AB=this.addDisposable(mstrmojo.ui.Pulldown.prototype.getPopupListConfig());AB.listHooks={select:function(AD,AE){if(AE.id===1){X(function(AF){AC.selectedNode.innerText=AF.n;y(false,AF);},L.copy(AA,{noReport:!!mstrApp.isSingleTier,folderLinksContextId:30,browsableViewMedias:mstrApp.isSingleTier?"2048,8192":undefined}));}else{AC.selectedNode.innerText=w;y(true);}if(this.visible&&this.closeAfterSelection){this.close();}return true;}};AB.getItemProps=function(AE,AD){var AF=mstrmojo._IsList.getItemProps.call(this,AE,AD);return AF;};AB.getItemMarkup=function(AE,AD){if(AD===0){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><i class="file-icon"></i><span>{@en@n}</span></{@tag}>';};return AB;}});},f=function(z,w,y){var x=function(){var AA=this;X(function(AB){AA.parent.text.set("value",AB.n);w(AB);},y);};return new mstrmojo.Box({cssClass:"linkDoss",slot:y.slot,alias:y.alias,children:[{scriptClass:"mstrmojo.TextBox",alias:"text",cssClass:"rwselector",readOnly:true,hint:y.placeholder,tooltip:z,value:z,onvalueChange:function(){this.set("tooltip",this.value);},onclick:x,},q.newIconButton("","icon",x),],});},Q=function(y,x,AA,w,AB){var AC;if(typeof y==="string"){AC=a.filterOne(x,function(AD){return AD.navPage===y;})||{};}else{AC={idx:y};}return new mstrmojo.ui.Pulldown({alias:AB.alias,slot:AB.slot,cssClass:"linkPage "+(AC.idx?"":"mstrmojo-empty"),items:x,selectedIndex:AC.idx||0,onSelectedItemChange:function(AD){var AE=!AD.idx;w(AD,AE);B.toggleClass(this.domNode,"mstrmojo-empty",AE);},getPopupListConfig:function z(){var AD=this.addDisposable(mstrmojo.ui.Pulldown.prototype.getPopupListConfig());AD.listHooks={select:function(AF,AG,AE){var AH=AG.navPage;if(!AH||AA()===AH){return true;}this.parent.set("selectedIndex",AE);if(this.visible&&this.closeAfterSelection){this.close();}},unselect:function(){var AE=this.selectedItem,AF=AE&&AE.navPage;if(!AF||AA()===AF){return true;}}};AD.getItemProps=function(AF,AE){var AG=mstrmojo._IsList.getItemProps.call(this,AF,AE),AH=AF.navPage;AG.style=this.parent.itemCssText||"";if(AE===0){AG.addCls("hidden");}else{if(!AH){AG.addCls("chap");}else{if(AH===AA()){AG.addCls("curr_pg");}}}return AG;};AD.getItemMarkup=function(AF){var AG=AF.navPage,AE='<span class="current-page">'+mstrmojo.desc(15777,"(current page)")+"</span>";if(!AG){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div></div>{@en@n}'+(AG===AA()?AE:"")+"</{@tag}>";};return AD;}});},g=function(w,x,y){return new mstrmojo.Box({alias:"buttons",cssClass:"buttonBox",children:[b(mstrmojo.desc(15701,"Remove Link"),w,false,{alias:"rmvBtn",cssDisplay:"inline-block",cssClass:"link-editor-rmv-btn"}),{scriptClass:"mstrmojo.Box",alias:"rtBtns",cssClass:"buttonBoxRt",cssDisplay:"inline-block",children:[b(mstrmojo.desc(118,"Save"),x,true,{alias:"saveBtn",cssDisplay:"inline-block",enabled:false}),b(mstrmojo.desc(221,"Cancel"),y,false,{alias:"cancelBtn",cssDisplay:"inline-block"})]}]});},D=function(x,w){var y=a.filterOne(w,function(z){return z.navPage===x;})||{};return y.idx;},s=function(z,y,x,AA){var w=function(AD){var AB=k.slice(),AC=1;a.forEach(AD,function(AE){AB.push({n:AE.cnm,idx:AC++});a.forEach(AE.pages,function(AF){AB.push({n:AF.pnm,navPage:AF.pid,idx:AC++});});});return AB;};if(!z){return ;}mstrApp.serverRequest({taskId:"getDossierTOCAndPrompts",rwb:x.bs,messageId:x.mid,dossierId:z,objectType:y},{success:function(AB){AB.pages=w(AB.toc);delete AB.toc;AA(AB);}});},A=function(w){K.center(w.hostProxy,w.domNode.clientWidth,w.domNode.clientHeight);w.domNode.style.left=0;w.domNode.style.top=0;w.domNode.style.right="auto";w.domNode.style.bottom="auto";w.hostProxy.style.top="100px";},R=function(x){var w=this,y=w.tabgroup.tabstack.pageSelector;y.pagePulldown.text.set("items",x.pages);y.pagePulldown.text.set("selectedIndex",x.pageIndex);y.filter.set("visible",true);y.filter.checkbox.set("checked",x.psf);y.promptAndAnswer.set("visible",x.prms.length>0);y.promptAndAnswer.set("prompts",x.prms);y.promptAndAnswer.set("aopam",x.aopam);Z.call(w);},i=function i(){var AC=this,AG=mstrmojo.all[this.hostId],y=AG.node.data,x=AG.node.data.navpage,AE=n(this.docModel),AB=false,AF=L.walk("tabgroup.tabstack",this),w=AF.urlSelector,AD=AF.pageSelector,AH=C(AG),AA;E=l(AG);if(E===J.LINK_MSTR){if(mstrApp.isSingleTier){h={};AH="";E=J.DISABLED;}else{h={n:y.tnm,did:y.tid,t:y.ttp,st:y.tstp};}}else{if(E===J.LINK_PAGE||E===J.LINK_DOSSIER){h={};AB=AG.hasDossierLinking();if(AB){h={tid:y.tid,t:y.ttp,tstp:y.tstp,navPage:x,n:y.navpagenm,idx:0,psf:y.psf,prms:y.prms,aopam:y.aopam,tnm:y.tnm};s(y.tid,y.ttp,this.docModel,function(AJ){var AI=D(x,AJ.pages)||0;h.prms=c(h.prms,AJ.prms);h.idx=AI;R.call(AC,{pages:AJ.pages,pageIndex:AI,psf:!!h.psf,aopam:h.aopam,prms:h.prms});});}else{if(y.tid===undefined){h={navPage:x,n:y.navpagenm,idx:D(x,AE)};if(h.idx===undefined){h={};}}}}else{h={};if(E===J.DISABLED){AH="";}}}var z=AF.selected;switch(E){case J.DISABLED:break;case J.URL:z=w;break;case J.LINK_MSTR:case J.LINK_PAGE:case J.LINK_DOSSIER:z=AD;break;default:}AF.set("selected",z);a.forEach((AF&&AF.children)||[],function(AI){if(AI){if(AI===AF.selected){AI.set("tooltip",AH);AI.set("linkType",E===J.DISABLED?z.defaultLinkType:E);}else{AI.set("tooltip","");AI.set("linkType",AI.defaultLinkType);}}});if(w){w.linkText.text.set("value",AG.url?(AG.ourl||AG.url):"");}if(AD){AD.dossierPulldown.text.set("enabled",!d());AD.pagePulldown.text.set("items",AB?k:n(AC.docModel));AD.pagePulldown.text.set("selectedIndex",h.idx||0);AA=L.walk("openNewWin.check",AD);if(AA){AA.set("checked",m(E)?(AG.target==="_blank"):true);}}this.set("dirty",false);},S=function(w){L.copy({ontooltipChange:function(){var x=L.walk("tooltipGroup.text",w);if(x){x.set("value",this.tooltip);}}},w);};mstrmojo.ui.editors.controls.LinkGroup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.vi.ui._IsValidURL],{scriptClass:"mstrmojo.ui.editors.controls.LinkGroup",dirty:false,onOpenCallback:mstrmojo.emptyFn,onCloseCallback:mstrmojo.emptyFn,init:function o(y){this._super(y);var AB=[],AA=this,z=mstrmojo.all[this.hostId],x=[],w=this.createUrlTab(),AC=this.createDossierTab();AB.push(w);AB.push(AC);x.push({scriptClass:"mstrmojo.Widget",markupString:p.apply('<div class="link-to-where">{@text}</div>',{text:mstrmojo.desc(16998,"Where to link to?"),}),});x.push({scriptClass:"mstrmojo.TabContainer",cssClass:"style"+AB.length,alias:"tabgroup",children:[{scriptClass:"mstrmojo.TabStrip",btnCssDisplay:"block",slot:"top",alias:"tabstrip",target:this.parent.tabstack,useRichTooltip:true,tooltipOpenDelay:0,updateTooltipConfig:function(AF){var AG=L.walk("children.1.domNode",this),AE=K.position(AG),AD;if(d()){AD=mstrmojo.desc(18780,"Choose any page in this Dossier. To link to another Dossier, save this Dossier in an environment.");}else{if(mstrApp.isSingleTier){AD=mstrmojo.desc(18700,"Choose any Dossier");}else{AD=mstrmojo.desc(18701,"Choose any Dossier, Document, or Report.");}}this.richTooltip=null;if(AG&&AG.contains&&AG.contains(AF.target)){this.richTooltip={enableHover:true,cssClass:"vi-regular vi-tooltip-C",content:AD,refNode:AG,top:1,left:AE.w};}}},{scriptClass:"mstrmojo.StackContainer",slot:"stack",alias:"tabstack",cssClass:"linkGroup",linkType:J.URL,onselectedChange:function(){if(AA.tabgroup){Z.call(AA);}},postCreate:function(){this.set("selected",w);},children:AB}]});x.push(g(function(){AA.getSelectedTab().set("linkType",J.DISABLED);O.call(AA,true);AA.close();},function(){O.call(AA,true);},function(){O.call(AA,false);}));this.addChildren(x);},postBuildRendering:function(){this.mousedownListener=K.attachMarkupEvent(this.id,this.domNode,"mousedown");if(!this.popupConfig){this.popupConfig=this.parent.getPopupConfig();}this._super();},onmousedown:function(w){w.cancel();},createTooltip:function(w){var x=this;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:w||"tooltipGroup",cssClass:"linkGroup linkGroup-tooltip",children:[{scriptClass:"mstrmojo.Label",alias:"label",slot:"col1Node",text:mstrmojo.desc(15698,"Tooltip")},{scriptClass:"mstrmojo.TextBox",alias:"text",slot:"col2Node",valueChangeDelay:1000,value:"",hint:mstrmojo.desc(12070,"Hyperlink#").replace("#",""),onkeydown:function(z){if(z.e.keyCode===13){this.blur();}},onvalueChange:function y(){var z=L.walk("parent.parent",this);if(z){z.tooltip=this.value;}Z.call(x);}}]};},createUrlTab:function(){var z=this,y=mstrmojo.all[this.hostId],w=y.url||"",x=new mstrmojo.Box({alias:"urlSelector",linkType:J.URL,defaultLinkType:J.URL,n:Y(mstrmojo.desc(9922,"URL"),"url-link-icon"),tooltip:"",children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"linkText",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(9922,"URL")},{scriptClass:"mstrmojo.TextBox",slot:"col2Node",alias:"text",hint:F,value:w||F,onfocus:function(){if(!this.value){this.set("value",F);}},onblur:function(){if(this.value===F){this.set("value","");}},onkeydown:function(AB){if(AB.e.keyCode===13){this.blur();}},onvalueChange:function AA(){var AB=this,AC=function(){AB.set("textValid",false);AB.domNode.setAttribute("title","");};if(this.hasRendered){if(z.isValidURL(this.value)){AC();}else{if(this.value){this.setInvalidState(mstrmojo.desc(12068,"Invalid URL"));}else{AC();}}Z.call(z);}}}]},this.createTooltip("tooltipGroup")]});S(x);return x;},createDossierTab:function(){var x=this,w=mstrmojo.all[this.hostId],y=new mstrmojo.Box({alias:"pageSelector",linkType:J.LINK_PAGE,defaultLinkType:J.LINK_PAGE,n:Y(mstrmojo.desc(15452,"Dossier"),"dossier-link-icon"),tooltip:"",children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"dossierPulldown",cssText:"margin-bottom: 10px",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(15463,"Dossier")},M(function(AA,z){var AC=L.walk("tabgroup.tabstack",x),AB=AC&&AC.pageSelector;if(AA){h={idx:0};AB.pagePulldown.text.set("items",n(x.docModel));AB.pagePulldown.text.set("selectedIndex",0);AB.set("linkType",J.LINK_PAGE);Z.call(x);}else{if(z&&(z.dvm===2048||z.dvm===8192)&&mstrApp.supportFeature(u.TEXT_IMAGE_DOSSIER_LINKING)){h={tid:z.did,tnm:z.n,t:z.t,navPage:undefined,n:undefined,idx:0,psf:h.psf||1,aopam:2,prms:[]};AB.set("linkType",J.LINK_DOSSIER);s(z.did,z.t,x.docModel,function(AD){h.idx=2;h.prms=AD.prms;R.call(x,{pages:AD.pages,pageIndex:h.idx,psf:!!h.psf,aopam:h.aopam,prms:h.prms});});}else{h=z;AB.set("linkType",J.LINK_MSTR);Z.call(x);}}},{slot:"col2Node",alias:"text",parentFolderId:x.docModel.pfid,onPopupOpen:function(){x.set("closeOnClick",false);},onPopupClose:function(){x.set("closeOnClick",true);}})]},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"pagePulldown",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(3687,"Page")},Q(h.idx,k,function(){if(h.tid){return null;}return x.docModel.getVizContentPanel().k;},function(z,AA){if(!AA){if(h.tid){h.navPage=z.navPage;h.n=z.n;}else{h=z;}Z.call(x);}},{alias:"text",slot:"col2Node"})]},this.createTooltip(),{scriptClass:"mstrmojo.Box",cssClass:"should-pass-filter",alias:"filter",children:[new mstrmojo.ui.Checkbox({alias:"checkbox",cssDisplay:"inline-block",checked:!!h.psf,oncheckedChange:function(){h.psf=Number(this.checked);Z.call(x);}}),new mstrmojo.Label({cssDisplay:"inline-block",text:mstrmojo.desc(17003,"Pass the filter conditions to the target page"),onclick:function(){this.parent.children[0].onclick();}})]},{scriptClass:"mstrmojo.Box",alias:"openNewWin",cssClass:"open-in-new-tab",children:[new mstrmojo.ui.Checkbox({alias:"check",cssDisplay:"inline-block",checked:w.target==="_blank",oncheckedChange:function(){Z.call(x);}}),new mstrmojo.Label({cssDisplay:"inline-block",text:mstrmojo.desc(18451,"Open in new tab"),onclick:function(){this.parent.children[0].onclick();}}),new mstrmojo.Label({cssDisplay:"inline-block",cssClass:"desc-text",text:mstrmojo.desc(18449,"(Web only)"),onclick:function(){this.parent.children[0].onclick();}})]},{scriptClass:"mstrmojo.ui.editors.controls.PromptAndAnswerList",alias:"promptAndAnswer",onAnswerChange:function(AA,z){if(AA){h.aopam=z;}else{h.prms=z;}Z.call(x);}}],_set_linkType:function(AA,z){this[AA]=z;return true;},onlinkTypeChange:function(){var z=this.linkType;this.dossierPulldown.text.setSelectedDossier(j(z,[J.LINK_PAGE,J.DISABLED]),P(w,z));this.pagePulldown.set("visible",j(z,[J.LINK_PAGE,J.LINK_DOSSIER,J.DISABLED]));this.filter.set("visible",z===J.LINK_DOSSIER);this.filter.checkbox.set("checked",!!h.psf);this.promptAndAnswer.set("visible",z!==J.LINK_DOSSIER?false:L.walk("prms.length",h)>0);this.openNewWin.set("visible",m(z));}});S(y);return y;},monitorWindow:function(){A(this);},getSelectedTab:function(){return L.walk("tabgroup.tabstack.selected",this);},getCurrentTooltipText:function(){return L.walk("tabgroup.tabstack.selected.tooltipGroup.text.value",this)||"";},getCurrOpenInNewWinStatus:function(){return L.walk("tabgroup.tabstack.pageSelector.openNewWin.check.checked",this);},onOpen:function(){A(this);i.call(this);this.buttons.rmvBtn.set("enabled",E!==J.DISABLED);this.onOpenCallback();},onClose:function(){this.onCloseCallback();},oncloseOnClickChange:function(){if(this.closeOnClick&&this._zIndex!==undefined){this.domNode.parentNode.style.zIndex=this._zIndex;delete this._zIndex;this.hoverLock(false);this.lockHover();}else{if(!this.closeOnClick){this._zIndex=this.domNode.parentNode.style.zIndex;this.domNode.parentNode.style.zIndex="1";this.unlockHover();this.hoverLock(true);}}},ondirtyChange:function(){this.buttons.rtBtns.saveBtn.set("enabled",this.dirty);},destroy:function(w){K.detachEvent(this.domNode,"mousedown",this.mousedownListener);this._super(w);}});L.copy({getFileBrowser:f,getPageSelector:Q,getCtrlBtns:g,generateTabBtnMarkup:Y,center:A,getInfoOfDossier:s,genDLXML:U},mstrmojo.ui.editors.controls.LinkGroup);}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css","mstrmojo.dom");var C,E=mstrmojo.css,D=mstrmojo.dom;var K=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function H(L){if(!C){C=this._super(L).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function G(N,L){var M=this._super(N,L);M.addCls("bst"+L);if(L){M.title=N.n;M.n="";}else{M.tt="";}return M;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showNoneOption:true,showThickOption:true,markupMethods:{onenabledChange:function F(){E.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function J(M){this._super(M);var L=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){L.push("no-thick");}if(!this.showNoneOption){L.push("no-none");}E.addWidgetCssClass(this,L);},getListCfg:function I(){var L=this.items||[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}];return new K({selectionPolicy:"reselect",items:L});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},getSelectedValue:function(){return this.selectedValue;},updatePreview:function B(){var O=this.borderStyleNode,M=this.getSelectedValue().split(" "),L=this.selectedValue==="conflict";E.toggleClass(this.previewNode,"conflict",L);if(O&&!L){var N=O.style;if(M.length===1){N.borderTopStyle=M[0];if(M[0]==="none"){N.position="static";O.innerHTML=mstrmojo.desc(2258,"None");O.classList.add("ellipsis");}}else{N.borderTopWidth=M[0];N.borderTopStyle=M[1];N.position="";O.innerHTML="";}}else{if(L){D.emptyNode(O);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.css");var D=mstrmojo.css;var B;mstrmojo.vi.ui.toolbars.TitleToolbar=mstrmojo.declare(mstrmojo.vi.ui.toolbars.Toolbar,null,{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",init:function F(H){this._super(H);D.addWidgetCssClass(this,"mstrmojo-VITitleToolbar");},markupMethods:{onvisibleChange:function A(){var H=this.visible,I=this.domNode;D.toggleClass(I,"visible",H);if(!H){D.onTransitionEnd(I,function(){D.addClass(I,"hidden");});}else{D.removeClass(I,"hidden");}}},getItemMarkup:function E(H){if(!B){B=this._super(H).replace("{@en@n}",'<div class="icn"></div>');}return B;},ontoolbarCfgChange:function G(H){var I=H.value;if(I){if(I.showContextMenu){I.addMenuToolbarBtn("","mnu");}if(I.hasCloseButton){I.addToolbarBtn(I.closeButtonText,"cls",function(K,J){J.parent.close();});}}this._super(H);},onItemContextMenu:function C(I,H){this.closePopup();if(I.fn){I.fn(I,this,H);return true;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(M){return function(O,N){N.openMenu(M,O);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,showContextMenu:true,addCloseButton:function E(M){this.hasCloseButton=true;if(M){this.closeButtonText=M;}},preShowMenu:mstrmojo.emptyFn,addToolbarBtn:function I(S,N,Q,M,O,R){var P={n:S,cls:N,fn:Q,ctxt:M,ttp:R};if(isNaN(O)||O>=this.btns.length){this.btns.push(P);}else{this.btns.splice(O,0,P);}return P;},addDisabledToolbarBtn:function I(P,N,M){var O=this.addToolbarBtn(P,(N||"")+" disabled",mstrmojo.emptyFn,M);O.dsbld=true;},addToolbarPickerBtn:function B(S,N,Q,R,M,O){var P={n:S,cls:N,fn:Q,ctxt:M,tp:"pb",menufn:G(R||this)};if(isNaN(O)||O>=this.btns.length){this.btns.push(P);}else{this.btns.splice(O,0,P);}},addMenuToolbarBtn:function H(Q,M,P,N,O){if(!P&&!this.hasMenuItems()){return ;}this.addToolbarBtn(Q,M,A.composite([this.preShowMenu,G(P||this),(O||mstrmojo.emptyFn)]),null,N);},addToggleToolbarButton:function D(U,P,R,O,N,S,M){var Q=this.getToggleItemStates(U,P,R,O,S,M);this.addDualStateItem(N,Q[0],Q[1],true);},addDualStateItem:function L(N,M,O,P){this["add"+(P?"ToolbarBtn":"MenuItem")](M.n,M.cls,this.getDualStateHandler(N,M,O),M.ctxt,undefined,M.ttp);},getDualStateHandler:function C(N,M,O){var P=this._super(N,M,O);return function(Q,R){P.call(this,Q,R);if(Q.cls.indexOf("toggleManualMode")===-1){R.refresh();}};},addToolbarDivider:function K(){this.addToolbarBtn("","divider",mstrmojo.emptyFn);},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.ScrollableContainer","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.Button");var H=mstrmojo.Button.newWebButton,E=mstrmojo.hash,L=mstrmojo.css,J=mstrmojo.dom;var B="grouping",C="highlight",I="disabled";function F(O,Q){J.preventDefault(window,O);J.stopPropogation(window,O);if(this.groupingOverlay.domNode.className.indexOf(C)===-1&&this.domNode.className.indexOf("selected")===-1){return ;}Q=E.copy(Q,{supportsScroll:true,isHostedWithin:false,maxHeight:J.getMaxScrollHeight()});var P=this.parent.getGroupContextMenuConfig(new mstrmojo.ui.menus.MenuConfig(Q),this.k);if(P.hasMenuItems()){this.openPopup(P.newInstance());}}mstrmojo.vi.ui._CanGroup=mstrmojo.provide("mstrmojo.vi.ui._CanGroup",{_mixinName:"mstrmojo.vi.ui._CanGroup",startGrouping:function G(O){L.addClass(this.domNode,B);var Q=this.groupingOverlay;if(!Q){var P=this,S=this.id;this.addChildren({scriptClass:"mstrmojo.ui.ScrollableContainer",cssClass:"groupingOverlay",alias:"groupingOverlay",cssDisplay:"",slot:"domNode",children:[H(mstrmojo.desc(1911,"Group"),function(U){U.cancel();P.groupSelection();},true,{cssClass:"btnGroup",cssDisplay:""}),H("",function(U){var W=mstrmojo.ui.PopupConfig.prototype.ENUM_CORNERS;F.call(mstrmojo.all[S],U.e,{hostId:S,hostElement:this.domNode,alignment:{host:W.BOTTOM_LEFT,popup:W.TOP_LEFT}});},false,{cssClass:"btnMenu",cssDisplay:""})]});this.groupingOverlay.render();var R=this.groupingOverlay.domNode;J.attachEvent(R,"contextmenu",function(U){F.call(P,U,{position:J.getMousePosition(U,window)});});J.attachEvent(R,"click",function(U){var W=U.target;if(W.className.indexOf("mstrmojo-scrollbar")!==-1){J.stopPropogation(window,U);}});}this.setGroupingStatus(O?"":I);this._menuBtnInfo=this.menuBtnInfo;this.menuBtnInfo=null;this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};},setGroupingStatus:function K(O){var Q=this,P=[I,C];P.forEach(function(R){L.toggleClass(Q.groupingOverlay.domNode,R,O===R);});},endGrouping:function N(){L.removeClass(this.domNode,B);this.setGroupingStatus("");this.menuBtnInfo=this._menuBtnInfo;delete this._menuBtnInfo;this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;},initializeDrag:function A(){return this.domNode.className.indexOf(B)===-1;},groupSelection:function D(){this.parent.groupSelection();},widgetResized:function M(){if(this._super){this._super();}var O=this.groupingOverlay;if(O){this.groupingOverlay.updateScrollbars();}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","css","dom","num");var I=mstrmojo.css,D=mstrmojo.dom,G=mstrmojo.num;mstrmojo.threshold.ColorMarker=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorMarker",markupString:'<div class = "marker {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:contextmenu,mousedown,mouseover,mouseout></div>',markupMethods:{onleftChange:mstrmojo.Widget.leftMarkupMethod},hovered:false,selected:false,index:undefined,position:0,updatePosition:function E(M){this.set("position",M);},compValue:undefined,updateCompValue:function K(M){this.set("compValue",M);},realValue:undefined,updateRealValue:function F(M){this.set("realValue",M);},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onselectedChange:function C(M){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerSelected(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnselected(this.index);}this.parent.onMarkerUnhovered(this.index);},oncontextmenu:function H(N){D.preventDefault(window,N.e);var M=this,O=M.parent.parent;var P=new mstrmojo.ui.menus.MenuConfig({position:D.getMousePosition(N.e,N.hWin),isHostedWithin:false});P.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){O.bands.remove(M.index);O.markers.remove(M.index);O.hoverBubble.hideBubble();O.update();});this.openPopup(P.newInstance());},onmousedown:function B(M){this.set("selected",!this.selected);},onmouseover:function L(){this.set("hovered",true);},onmouseout:function J(){this.set("hovered",false);},onhoveredChange:function A(M){if(!this.selected){if(M.valueWas===false&&M.value===true){I.toggleClass(this.domNode,"selected",true);this.parent.onMarkerHovered(this.index);}else{I.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnhovered(this.index);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ME.MetricDataService");mstrmojo.requiresDescs(3224);var a=["(",")","{","}","-","+","*","/","<",">","|","~",","],I={" ":true,"@":true},Z=null,Y=mstrmojo.dom,K=mstrmojo.css,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,b=mstrmojo.ME.MetricDataService;function O(f){if(!Z){Z={};var e,d;for(e=0,d=a.length;e<d;e++){Z[a[e]]=true;}}return Z.hasOwnProperty(f);}function c(f){if(!f){return false;}var d=f.length,e,g;for(e=0;e<d;e++){g=f.charAt(e);if(g==="["){return false;}if(O(g)||I[g]){return true;}}return false;}function A(d){return c(d)?"["+d+"]":d;}function M(h){if(!h){return null;}var d=h.length,g=h.split("["),f=g.length,j,i;if(f===1){return h.split("@");}else{if(f===3){j=g[1];j="["+j.substring(0,j.length-1);i="["+g[2];}else{if(g[0].length===0){var k=g[1],e=k.indexOf("]");j="["+k.substring(0,e+1);if(e===k.length-1){return[j];}else{i=k.substring(e+2);}}else{var k=g[0];j=k.substring(0,k.length-1);i="["+g[1];}}}return[j,i];}var R={8:true,9:true,10:true};var C=function(e,d){return R[e]&&!/^\".*\"$/.test(d)?'"'+d+'"':d;};var F=function(e,d,f){var g=typeof f==="undefined"?true:R[f];if(d.length===2&&d==='""'){return d;}return e.tp===261&&d.length>=2&&g?(/^\s+$/.test(d.substr(1,d.length-2))?d:d.substr(1,d.length-2)):d;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}" mstrAttach:contextmenu></span>',active:false,markupMethods:{ondataChange:function(){var g=this.data,f=g.tp||this.dataType,h=this.isEmbeddedFilter(),e=h?"&nbsp;":mstrmojo.string.encodeHtmlString(String(g.v));if(g.v===","){this.domNode.innerHTML=e+"&nbsp;";}else{if(f===259&&g.v==="Desc"){this.domNode.innerHTML="&nbsp;"+e;}else{if(b.isLogicOrCompFunc({v:g.v.trim(),tp:f})){this.domNode.innerHTML="&nbsp;"+e+"&nbsp;";}else{this.domNode.innerHTML=e;}}}K.toggleClass(this.domNode,["mstr"],this.isMstrO());K.toggleClass(this.domNode,["nfn"],!this.isFunction());K.toggleClass(this.domNode,["invalid"],g.sta===-1);K.toggleClass(this.domNode,["embeddedFilter"],h);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},oncontextmenu:function W(d){this.closePopup();if(this.isEmbeddedFilter()){var f=new mstrmojo.ui.menus.MenuConfig({position:Y.getMousePosition(d.e,d.hWin),isHostedWithin:false,alignWithAnchor:true});var e=this;f.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){var g=e.parent;if(g&&g.editEmbeddedFilterToken){g.editEmbeddedFilterToken(e);}});this.openPopup(f.newInstance());}},isMstrO:function X(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t===H.Function);},isEmbeddedFilter:function J(){var f=this.data.oi,e=f&&f.t,d=f&&f.st;return this.isMstrO()&&e===H.Filter&&d===D.Filter&&f.isEmbedded;},brackets:A,length:function E(){return this.isEmbeddedFilter()?1:this.data.v.toString().length;},isDelimiter:function U(){return this.data.isDelimiter||(this.length()===1&&O(this.data.v));},split2Tokens:function L(h){var g=this.data,f=g&&g.v.toString(),i=f.substring(0,h),e=f.substring(h);return[{v:i,isNew:true},{v:e,isNew:true}];},mergeTo:function N(f){var h=this.data,g=h&&h.v.toString(),e=f.data.v.toString();return{v:g+e,isNew:true};},brackets:A,setItemInfo:function S(e){var f=this.data;f.v=this.brackets(e.n);f.oi=e;f.sta=1;f.isNew=true;this.set("data",f);this.paint();},spliceContent:function P(k,i,f){var j=this.data,h=j&&j.v.toString(),l=h.substring(0,k);i=(i===null||i===undefined)?(h.length-k):i;var e=h.substring(k+i),g=l+(f||"")+e;j.v=g;j.isNew=true;j.sta=1;j.ift=(this.isAttributeToken()||j.at)&&(j.v.indexOf("@")>=0);if(j.ift){j.at=j.oi||j.at;}else{delete j.at;}if(j.tp){this.dataType=j.tp;}delete j.oi;delete j.exv;delete j.extp;delete j.tp;this.set("data",j);this.paint();},isAttributeToken:function G(){return this.data&&this.data.oi&&this.data.oi.t===H.Attribute;},setFormInfo:function Q(f){var g=this.data,e=g.oi||g.at;g.v=this.brackets(e.n)+"@"+this.brackets(f.n);g.exv=f.did;g.extp=8;g.sta=1;g.isNew=true;g.oi=g.at;delete g.at;this.set("data",g);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=O;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.splitAttrAndAttrForm=M;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=F;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=R;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var A=mstrmojo.css,N=mstrmojo.dom,M="draggedTab",J="stopDragging",m=1,L=2,q=4,G=8,l=16;function n(s){return function(){A.toggleClass(this.tabStripMenuNode,"active",s);};}function i(AD){var y=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:N.getMaxScrollHeight()}),s=this.getMenuActions(),AB=this.index,u=this.id,w=this.total,z=this.parent,t=function(){var AE=z&&z.getTabs();return AE&&AE.length>AB?AE[AB]:mstrmojo.all[u];};if((s&l)>0){this.addNewTabMenuItem(y);}if((s&q)>0){var AA=mstrmojo.desc(3397,"Duplicate"),AC=this.parent.scriptClass;if(AC.indexOf("LayoutTabStrip")>=0){AA=mstrmojo.desc(15022,"Duplicate Chapter");}else{if(AC.indexOf("PanelTabStrip")>=0){AA=!z.usePanelTitle()?mstrmojo.desc(14923,"Duplicate Page"):mstrmojo.desc(6048,"Duplicate Panel");}}y.addMenuItem(AA,"dup",function(){t().tabDuplicated();});}if(AC&&AC.indexOf("PanelTabStrip")>=0){y.addMenuItem(!z.usePanelTitle()?mstrmojo.desc(18367,"Format Page"):mstrmojo.desc(19745,"Format Panel"),"fmt",function(){t().tabFormat(true);});}if((s&L)>0){if(AB){y.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){t().tabMoved(true);});}if(AB<w-1){y.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){t().tabMoved(false);});}}y.addSeparator();if((s&m)>0){y.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){t().lbl.set("isEditing",true);});}if((s&G)>0){if(w>1){y.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){t().tabDeleted();});}}var x=this.getCustomMenu();if(x&&x.hasMenuItems()){y.addSeparator();y.absorbMenuItems(x);}y.addPopupHandlers(this.id,n(true),n(false));this.showTabMenu(this.updateMenuCfg(y),AD);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:contextmenu,click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function S(){return this.domNode.firstChild.firstChild;},menuBtnNode:function p(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function I(){this.lbl.set("text",this.title);},onisSelectedChange:function j(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function k(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,isCutoff:false,isHidden:false,isLeftMost:false,isRightMost:false,leftEdgeHiddenWidth:0,rightEdgeHiddenWidth:0,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function X(t,s){if(t){this.parent.titleEdited(this.text,s);}}}],postBuildRendering:function Q(){var s=this.isValidMode();if(!s||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this.lbl.set("editOnDoubleClick",s);this._super();},oncontextmenu:function c(s){this.onclick(s);s.e.handledByTab=true;s.preventDefault();},onclick:function f(s){var u=this.domNode;if(A.hasClass(u,J)){A.removeClass(u,J);return ;}var t=function(){if(this.isValidMode()){this.postTabClicked(this,s);}};if(!this.isSelected){this.tabSelected({success:t.bind(this)});}else{t.call(this);if(this.tabSelectCurrent){this.tabSelectCurrent();}}s.e.handledByTab=true;},postTabClicked:function o(w,t){w=this.findSelectedTab(this)||w;var s=w.menuBtnNode,x=t.getTarget().className===s.className,u;if(x){u=N.position(s);}if(t.name==="contextmenu"||(x&&!(u.x||u.y))){u={x:t.e.clientX,y:t.e.clientY};}if(u){i.call(w,u);}},getMenuActions:function e(){return 0;},getCustomMenu:function Z(){return null;},isDragValid:function R(){return this.parent.children.length>1&&!this.lbl.isEditing&&this.isValidMode();},createAvatar:function U(){var s=document.createElement("div");s.appendChild(this.domNode.cloneNode(true));s.style.margin="-5px 0 0 10px";return s;},addTabDnDStyle:function Y(){var s=this.lbl.domNode;if(s&&!this.isSelected){A.addClass(s,M);}},clearTabDnDStyle:function F(){var s=this.lbl.domNode;if(s&&!this.isSelected){A.removeClass(s,M);}},allowDrop:function D(s){var t=s.src.widget;return t&&t.parent===this.parent;},dropTab:function K(s){var w=s.src,u=w.data,t=w.widget;t.clearTabDnDStyle();this.parent.moveTab(u.idx,this.index,u.fromIdx);},ondragenter:function H(t){this._super(t);var w=t.src.data,u=t.src.widget,s=this.index;this.parent.moveTab(w.idx,s);w.idx=s;},ondragover:function b(u){var s=u.tgt.node,t=u.tgtData,w=t&&t.node,x=u.src.widget;if(!t||w!==s){u.tgtData={node:s};}if(x&&!x.isSelected){x.addTabDnDStyle();}},ondragleave:function P(s){this._super(s);var t=s.src.widget;if(t&&!t.isSelected){t.addTabDnDStyle();}},ondragend:function C(s){this._super(s);A.addClass(this.domNode,J);this.dropTab(s);},getDragData:function d(){var u=this.id,s=this.index;return{setAvatarClass:function t(w){var z=mstrmojo.all[u],x=z.avatar;if(x){var y=[z.avatarCssClass,"hasOwnAvatar",w];x.className=y.join(" ");}},fromIdx:s,idx:s};},getDropAvatarIcon:function B(){return"pivot";},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},cleanUpAfterTarget:function g(s){this.clearTabDnDStyle();this._super(s);},onAppStateChange:function h(t){var w=this.lbl,u=this.isValidMode(),s=mstrApp.isLayoutPreview(t.value);w.set("isEditing",false);w.set("editOnDoubleClick",u);this.draggable=u&&!s;},onLayoutModeChange:function O(t){var u=this.isValidMode(),s=mstrApp.isLayoutPreview(t.value);this.draggable=u&&!s;},addNewTabMenuItem:function W(s){this.throwAbstractMethodError("addNewTabMenuItem");},findSelectedTab:mstrmojo.emptyFn,tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function a(s){return s;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:l,RENAME:m,MOVE:L,DUPLICATE:q,DELETE:G};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasLayout","mstrmojo._HasSuggestion","mstrmojo.hash","mstrmojo.css");var H=mstrmojo.css,B=mstrmojo.hash,E="clear";function F(){this.searchTriggered(this.inputNode.value);}mstrmojo.ui.SearchBox=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.SearchBox",markupString:'<div id={@id} class="mstrmojo-ui-SearchBox cf {@cssClass}" style="{@cssText}"><input class="mstrmojo-ui-sb-input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" mstrAttach:keyup,blur,focus/><div class="mstrmojo-ui-sb-btn" mstrAttach:click ></div></div>',markupSlots:{inputNode:function J(){return this.domNode.firstChild;},searchNode:function C(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{inputNode:"20px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"22px"},xt:true},getLayoutOffsets:function(){return{w:2,h:0};},searchNode:undefined,inputNode:undefined,searchDelay:-1,init:function N(Q){this._super(Q);var P=this.searchDelay;if(P===-1||isNaN(P)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},onfocus:function O(P){var Q=P.getTarget();if(Q===this.inputNode){this.inputNode.placeholder="";H.addClass(this.domNode,"onInputFocus");}},onblur:function I(P){var Q=P.getTarget();if(Q===this.inputNode){this.inputNode.placeholder=mstrmojo.desc(12666,"Search...");H.removeClass(this.domNode,"onInputFocus");}},onclick:function M(P){var Q=P.getTarget();if(Q===this.searchNode){if(this._hasText){this.clearSearch();}else{F.call(this);}}},onkeyup:function A(R){var Q=R.hWin,X=R.e||Q.event,U=B.walk("parent.parent",this);if(X.keyCode===27){this.clearSearch();return ;}var W=this,P=this.text,Y=this.text=this.inputNode.value,S=this._hasText=Y.length>0;if(P!==Y){H.toggleClass(this.searchNode,[E],S);window.clearTimeout(this._searchTimeoutId);this._searchTimeoutId=window.setTimeout(function(){F.call(W);},this.searchDelay);if(U&&U.canTab){U.buildNavList();}}},unrender:function G(){this.text="";this._super();},clearSearch:function K(P){this.text=this.inputNode.value="";H.removeClass(this.searchNode,[E]);delete this._hasText;if(!P){F.call(this);}this.postClearSearch();},isClear:function D(){return !this.text||this.text.length===0;},postClearSearch:mstrmojo.emptyFn,searchTriggered:function L(P){}});}());(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode");mstrmojo.threshold.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,null,{scriptClass:"mstrmojo.threshold.AndOrNode",cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);},consolidate:function A(){if(this.parent!==this.tree||this.itemCnt===0){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasItemAliases","mstrmojo.WidgetTree","mstrmojo.hash","mstrmojo.expr","mstrmojo.mstr.EnumNodeProperties","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var C=mstrmojo.hash,G=mstrmojo.expr,A=mstrmojo.mstr.EnumNodeProperties,I=G.ET;function E(J){var L=J&&J.src,M=L&&L.data,K=M&&M.et;return(K in G.ETs);}function H(J){return J&&J.et===I.ANDOR&&!(J.node&A.CONDITION);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,[mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.FilterExpr",allowDrop:E,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(J){this.clearTreeSelect();},onnodemousedown:function(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e),M=K.src,J=M.listMapper.findIndex(M,M.itemsContainerNode,L),N=J>=0?M.ctxtBuilder.itemWidgets[J]:null;if(!N||(N.isSelectableArea&&!N.isSelectableArea(L))){this.onBlankClick(K);}},getItemIdentityProp:function(J){return J.et;},itemFunction:function(O,L,P){var K=P.tree,M=K.getItemConfig(O,L,P),N=K.nodeClassMap,J=N[K.getItemIdentityProp(O)]||N["*"];return J&&(new J(M));},getItemConfig:function(S,P,L){var N=this,J=H(S),U=L.tree||L,M=C.walk("tree.editor",U),R=M&&M.docModel,Q=M&&M.xtab,O=Q&&Q.gridInfo,K={data:S,tree:U,parent:L,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(J)?L.itemFunction:null,draggable:J?U.draggable:false,dropZone:J?U.dropZone:false,allowDrop:J&&U.dropZone?U.allowDrop:null,allowCopy:J?U.allowCopy:false,editable:U.isEditable?U.isEditable(S):U.editable,makeObservable:J&&L.makeObservable,onclick:U.onnodeclick,onadd:U.onnodeadd,onremove:U.onnoderemove};N.adjustItemName(S,R,O);return K;},getDragData:function(J){var L=this._super(J);if(L&&!L.html){var K=L.et&&G.ET2TGT[L.et];L.html=K?L[K]&&L[K].n||"":L.n||"";}return L;},newCondition:function D(N){N=N||{et:I.AQ};var M=this.selectionParentNode,J;M=(M&&M.hasRendered)?M:this;if(M!==this){J=M.add([N]);}else{var L=this.addCondition([N],null,true);J=L.index;M=L.widget;}var K={widget:M,index:J,data:N};if(this.onNew){this.onNew(K);}return K;},addCondition:function F(L,N){var O=this.items,K=O&&O.length,Q=L&&L.length;if(!Q){return null;}var M,J;if(K&&H(O[0])){M=this.ctxtBuilder.itemWidgets[0];J=M.add(L,null);}else{if(!K&&(Q===1)){M=this;J=0;this.add(L,0);}else{if(K){var P=O[0];this.remove(P);L.unshift(P);}this.add([{et:I.ANDOR,fn:G.FN.AND,nds:L}],0);M=this.ctxtBuilder.itemWidgets[0];J=K?1:0;}}return{widget:M,index:J};},addSingleCondition:function B(K,J){var L=this.addCondition([K],J);return L.widget.ctxtBuilder.itemWidgets[L.index];},ondrop:function(M){if(this._super){this._super(M);}var K=this.items,J=K&&K.length,L=K.concat();if(J>1){if(K.remove){K.remove(0,K.length);}else{this.set("items",null);}this.add([{et:I.ANDOR,fn:G.FN.AND,nds:L}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<=N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(U){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(U);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=U.added,P=U.removed,Q=[],L=[],K=U.src,N,M,O,W;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,W=S&&S.length;M<W;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.string","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.vi.util.DIUtils");var R=mstrmojo.hash,b=mstrmojo.func,A=mstrmojo.string,N=mstrmojo.meta.TP,H="5CECE58CC1D549F890EB61C4DB2156A3",Y="E0CCB9CF22104A489CBE78D974AFD19E",U=mstrmojo.chart.model.enums.EnumDSSObjectType,M=mstrmojo.array,E=mstrmojo.dom,F=mstrmojo.vi.util.DIUtils,Q=F.DIConstants,d=function(l,n,g){var j=l.scrollableIncFetch,i=j?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",k={scriptClass:i,items:n.items,multiSelect:g};if(j){k.browseConfig={blockBegin:n.bb,blockCount:n.bc,totalSize:n.sz,folderLinksContextId:l.folderLinksContextId,rootFolderID:n.did,browsableTypes:l.browsableTypes,browsableViewMedias:l.browsableViewMedias,dataProvider:l.dataProvider};k.onwaitingChange=function(){if(l.booklet){l.booklet.set("waiting",this.waiting);}};}var h=mstrmojo.insert(k);h.render();return h;},B=function(j,k,g){var i=mstrmojo.ObjectBrowser.widgetHandler||d;return i(j,k,g);},P={success:function(i){var j=this.ob,h=i.items,k=j.pageCache[j.currentPage],g=k._w;k.items=h;g.set("items",h);this.ob=null;this.item=null;window.clearTimeout(j._btm);j.booklet.set("waiting",false);if(j.scrollableIncFetch&&g.scrollNode){g.initScroll();g.updateScrollbars();}},failure:function(g){window.alert(g.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},X=function(l,k,i){var j=i?-1:1,h=l.pageCache.length,m;for(m=l.currentPage+j;m<h&&m>=0;m+=j){var g=l.pageCache[m];if(g._k===k.k){return{steps:m-l.currentPage,cache:g};}}return null;},D=function(k,j,i,m){var n=k.currentPage+1,h=k.pageCache.length,g;for(g=n;g<h;g++){k.pageCache[g]._w.destroy();delete k.pageCache[g].items;}k.pageCache=k.pageCache.slice(0,n);m._w=i;m._k=j.k;k.pageCache[n]=m;k.cacheChange();},J=function(h){var g=mstrmojo.hash.walk("anc.items.0.items",h);this.set("canGoUp",!(!h.pf||!g));},K=function(k,j,l,i,h){if(!k.hasRendered){return ;}delete k._btm;var g;if(!i){g=B(k,l,k.multiSelect);g.attachEventListener("change",k.id,"navigate");if(k.useDblSelect||k.useBothSglDblSelect){g.attachEventListener("dblclick",k.id,"dblselect");}}else{g=l._w;}k.obList=g;k.booklet.turn(g,h>0);window.setTimeout(function(){k.onBrowsing=false;},300);if(!i){D(k,j,g,l);}k.set("currentFolder",l);k.set("currentPage",k.currentPage+h);k.updateUpButton(l);if(k.scrollableIncFetch&&g.scrollNode){g.initScroll();g.updateScrollbars();}},S=function(i,h,g){var j=X(i,h,false);j=j||X(i,h,true);if(!j){window.clearTimeout(i._btm);i._btm=window.setTimeout(function(){i.booklet.set("waiting",true);},300);g.ob=i;g.item=h;i.getDataProvider().fetchFolderContents(i,h,g);}else{K(i,h,j.cache,true,j.steps);}},C=function(h,i,j,g){S(h,{fid:h.pageCache[h.currentPage].did,blockBegin:i,searchPattern:j,recursive:g},P);},L={success:function(h){var i=this.ob;if(i){window.clearTimeout(i._btm);if(!h.items){h.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var g=function k(l){var o=l.length,m;for(m=0;m<o;m++){var n=l[m];if(n.did===H||n.did===Y){n.n=(n.did===H)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(n.items){g(n.items);}}};if(h.did===H||h.did===Y){h.n=(h.did===H)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(h.anc&&h.anc.items){g(h.anc.items);}}if(h&&h.items&&i.browsableViewMedias){var j={};M.forEach(i.browsableViewMedias.split(","),function(l){j[parseInt(l,10)]=true;});h.items=M.filter(h.items,function(l){return(l.t!==U.DssTypeDocumentDefinition)||j[l.dvm];});}if(h&&h.items&&mstrApp&&mstrApp.isSingleTier){h.items=M.filter(h.items,function(l){return(l.st!==772);});}if(i.isImportFromCube){h.items=M.filter(h.items,function(l){return(l.et!==Q.DSSExType.DSSEXDISPARK);});}if(h.did&&this.item.k!==h.did){this.item.k=h.did;}K(i,this.item,h,false,1);this.ob=null;this.item=null;}},failure:function(g){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(g);}else{if(g.getResponseHeader){mstrmojo.alert(g.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{var h=g.message;if(g.code==mstrmojo.mstr.EnumWebAPIErrorCodes.MDSVR_E_NO_ID){h=this.ob.parent.title+": "+h;}mstrmojo.alert(h);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},f=function(i){var h=i.pageCache.length,g;for(g=0;g<h;g++){i.pageCache[g]._w.destroy();}i.pageCache=[];i.currentPage=-1;i.cacheChange();},O=function(j,i,k){var g=j.onBrowseFolder;if(g){g[0][g[1]](i);}if(i&&parseInt(i.acg,10)===33){return ;}var h={};if(i){h.k=i.did;h.fid=i.did;}else{if(j.rootFolderID){h.k=j.rootFolderID;h.fid=j.rootFolderID;}else{if(j.rootFolderType){h.k=j.rootFolderType;h.fty=j.rootFolderType;}else{if(j.folderLinksContextId){h.k=j.folderLinksContextId;}}}}S(j,h,b.wrapMethods(k,R.copy(L)));},a=function(l,g,i){if(!i){return g;}var j=l.showCompletePath,o=g[0],k,h;while(o){var m;for(m=i.length-1;m>=0;m--){if(o.did===i[m].did){i.splice(m,1);o._isSc=true;}}h=o;o._open=true;o=o.items;o=o&&o[0];if(!o){h.lastLeaf=true;}}if(!j){o=g[0];while(o){if(o._isSc){g[0]=o;break;}o=o.items;o=o&&o[0];}}return g.concat(i);},Z=function(h,g,i){h._naviInfo=a(h,g,i);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",alias:"popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var g=this.opener.parent.parent,j=this.tree,i=g._naviInfo,h=this.parent.parent.parent.extraDDItems;if(j.items!==i){j._pup=this;this.ob=g;if(h){M.forEach(h,function(k){k.isExtra=true;});i=i.concat(h);}j.set("items",i);}if(g.getRecents&&!mstrApp.isSingleTier){g.getRecents(this);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(l,g,h){var k=mstrmojo.WidgetTree.prototype.itemFunction(l,g,h);if(l.isExtra){if(l.cssClass){k.cssClass=l.cssClass;}k.onmousedown=l.onmousedown||mstrmojo.emptyFn;return k;}if(l._open){k.state=1;}k._ll=!!l.lastLeaf;k._pup=h._pup;k.onmousedown=function(i){var m=mstrmojo.dom.eventTarget(i.hWin,i.e),n=this._pup;if(m===this.domNode||m===this.textNode){if(!this._ll){O(n.ob,this.data);}n.close();}};k.markupMethods=R.copy(k.markupMethods);k.markupMethods.onstateChange=function(){var i=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[i]||"closed");this.itemsContainerNode.style.display=(i===1)?"block":"none";};k.useRichTooltip=true;var j=k.postBuildRendering;k.postBuildRendering=function(){if(j){j.call(k);}if(k.textNode.parentNode.clientWidth){k.textNode.style.width=(k.textNode.parentNode.clientWidth-20)+"px";}};k.premouseover=function(n){if(this.useRichTooltip){var m=this.textNode;if(m.clientWidth<m.scrollWidth){var i=E.position(m);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:A.encodeHtmlString(this.data[this.itemDisplayField]),top:i.y-2,left:i.x+i.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(n.hWin,n.e);}return true;};return k;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(g,h){this.parent.parent.getDataProvider().serverRequest(g,h);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},postBuildRendering:function c(){if(this._super){this._super();}this.inputNode.setAttribute("placeholder"," "+mstrmojo.desc(12666,"Search..."));},onUpdateSearchParams:function I(i){var h=this.parent.parent,g=h.sId;if(g){i.sessionState=g;}if(h.useOldSearch){i.quickSearch=0;i.nameWildcards=1;i.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(i){var k=parseInt(this.height,10),g=this.np>1,j={target:this.domNode,props:{height:{start:(g?0:k),stop:(g?k:0),suffix:"px"}},onEnd:function(){if(g){this.target.style.overflow="visible";}}},l=new mstrmojo.fx.AnimateProp(j);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);l.play();},onifsChange:function(g){var h=this.np;mstrmojo.hash.copy(g.value,this);if(this.np>1){this.children=null;this.refresh();}if((h<=1&&this.np>1)||(h>1&&this.np<=1)||(h===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function e(){f(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var i=this.searchUpBar;if(i&&i.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var g=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){g.attachEventListener("ifsChange",this.id,function(j){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",j.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var h=this.obIncFetch;h.attachEventListener("fetch",this.id,function(j){h.cp=j.v;h.children=null;h.refresh();C(this,(j.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(h){var i=h.value,g=this.pageCache[this.currentPage]._w;if(!i||i.length===0){i=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var j={};M.forEach(this.browsableViewMedias.split(","),function(k){j[parseInt(k,10)]=true;});i=M.filter(i,function(k){return(k.t!==U.DssTypeDocumentDefinition)||j[k.dvm];});}}g.set("items",i);},navigate:function(o){var g=o.src,p=g.selectedItem,i=this.multiSelect,l=i&&g.getSelectedItems(),n=this,h=o.added&&o.added.length,k=o.removed&&o.removed.length,j=i?l.length===1&&(!k||h):!!p;if(j&&p.did==="empty"){return ;}if(j&&parseInt(p[N],10)===8){if(!this.onBrowsing){this.onBrowsing=true;O(this,p);}}else{if((p&&(!this.useDblSelect||this.useBothSglDblSelect))||l){this.select(i?l:p);}}},browseFolder:function(g,h){O(this,{did:g,n:h});},onFishEyeChange:function(g){this.goToPage(g.value);},goToPage:function(g){if(g<this.pageCache.length&&g!==this.currentPage){var i=g>this.currentPage,h=this.pageCache[g];this.set("currentPage",g);this.booklet.turn(h._w,i);this.set("currentFolder",h);J.call(this,h);}},oncurrentPageChange:function(g){if(this.fishEye){this.fishEye.setSelectedIndex(g.value);}var h=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(h.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",h.items||[]);this.obSearchBox.set("totalSize",h.sz);this.obSearchBox.set("rootID",h.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(h.sz/h.bc)+((h.sz%h.bc>0)?1:0),cp:Math.floor(h.bb/h.bc)+((h.bb%h.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(h,g){R.copy(h,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}f(this);O(this,undefined,g);},close:function(){var h=this.ctx||this,g=h.onCloseCB;if(g){g[0][g[1]]();}h.set("visible",false);},select:function(h){var g=this.onSelectCB;if(g){g[0][g[1]](h);}if(this.closeOnSelect){this.close();}},dblselect:function W(h){var i=h&&h.src.selectedItem;if(!i||(i&&i.did==="empty")||i[N]===8){return ;}if(this.useBothSglDblSelect){var g=this.onDblSelectCB;if(g){g[0][g[1]](i);}if(this.closeOnSelect){this.close();}}else{this.select(i);}},goUp:function(){if(this.canGoUp){O(this,{did:this.currentFolder.pf});}},updateUpButton:function G(g){J.call(this,g);},oncurrentFolderChange:function(g){var h=g.value;Z(this,h.anc.items,h.sc);},refreshContent:function(g){C(this,g);},onError:null,onheightChange:function(){var g=["titleBar","fishEye","searchUpBar","obIncFetch"],k=0,j;for(j in g){k+=parseInt(this[g[j]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-k+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var F=mstrmojo.array;var C=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:F.hash(C),item:null,OKFn:null,init:function(I){this._super(I);this.addChildren([{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+C.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:!!this.searchVisible,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",isImportFromCube:"this.parent.isImportFromCube",}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function H(){var K=this.parent.parent;this.parent.parent.close({item:K.item});var J=K.OKFn;if(J){J(K.item);}K.set("item",null);},bindings:{enabled:function G(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function H(){var J=this.parent.parent;this.parent.parent.close();J.set("item",null);}}]}]);},preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function B(){if(this._super){this._super();}this.browse();},onOBSelect:function D(G){this.set("item",((this.supportedTypes[G.t]||this.supportedTypes[G.st])?G:null));},browse:function E(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor");var C=mstrmojo.func,E=mstrmojo.array;function B(){var G={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var I=this.parent.parent,H={zIndex:I.zIndex+10,navigateAfter:false,fId:I.ob.currentFolder.did,okFn:function(J,K){I.ob.refreshContent();if(K){I.ob.browseFolder(J.fid,I.newFolder);}}};if(I.ob.dataProvider){H.dp=I.ob.dataProvider;}I.openPopup("newFolder",H);},postCreate:function(){this.set("visible",false);}},F=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);F.push(G);return F;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B(),getRecents:function(F){var G=this;F.onClose=function(){if(G.recentFolders){this.removeChildren(this.recentLable);this.removeChildren(this.recentList);delete G.recentFolders;}};this.getDataProvider().loadRecentSaveAsFolders({success:function(H){if(G.recentFolders){F.removeChildren(F.recentLable);F.removeChildren(F.recentList);delete G.recentFolders;}if(H&&H!==""){G.recentFolders=G.getList(H.objects,F);F.addChildren(G.recentFolders);}},failure:function(H){mstrmojo.alert(H.message||H.getResponseHeader("X-MSTR-TaskFailureMsg"));},});},getList:function(G,F){var H=this;return[{scriptClass:"mstrmojo.Label",alias:"recentLable",cssClass:"recentLabel",text:mstrmojo.desc(14354,"Recents")},{scriptClass:"mstrmojo.ui.List",alias:"recentList",items:G,cssClass:"recentList",onclick:function(I){var J=this.getItemFromTarget(I.getTarget());H.browseFolder(J.did,"");F.close();}}];}});var A={success:function(F){var G=this.parent;if(G.onObjectSaved){G.onObjectSaved({name:G.name,did:F.did,desc:G.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",G.typeDesc||"Object").replace("###",G.name),null,mstrmojo.desc(7984,"Object Saved"));G.ob.refreshContent();G.close();},failure:function(G){var F=parseInt(G.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,H=this.parent;if(F===2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",H&&H.typeDesc||"Object").replace("'###'",H&&H.name?'"'+H.name+'"':""),{confirmBtn:{fn:function(){H.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:H&&H.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+G.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",showCertify:false,certify:false,displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-certify-checkbox",label:mstrmojo.desc(20041,"Certified Dossier"),alias:"certifyNode",bindings:{visible:"this.parent.showCertify",checked:"this.parent.certify"},},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var G=this.parent.parent,F={zIndex:G.zIndex+10,navigateAfter:false,fId:G.ob.currentFolder.did,okFn:function(H,I){G.ob.refreshContent();if(I){G.ob.browseFolder(H.fid,G.newFolder);}}};if(G.ob.dataProvider){F.dp=G.ob.dataProvider;}G.openPopup("newFolder",F);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder"));}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(F){this.set("name",F.n);},saveAsCallback:function D(){return A;},saveAs:function(I){var G=this.contPanel;this.name=G.name.value;this.desc=G.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var K=this.saveParams||{};K.folderID=this.ob.currentFolder.did;K.description=this.desc||"";K.name=this.name||"";K.saveAsOverwrite=!!I;var F=this.saveAsCallback(),J=this,H={success:function(){J.saveRecentFolders(J.ob.currentFolder.did);},failure:function(L){mstrmojo.alert(L.message||L.getResponseHeader("X-MSTR-TaskFailureMsg"));}};F.parent=this;if(!mstrApp.isSingleTier){F=C.wrapMethods(F,H);}mstrmojo.xhr.request("POST",mstrConfig.taskURL,F,K);},saveRecentFolders:function(J){var H,F,G,I=this;I.ob.getDataProvider().loadRecentSaveAsFolders({success:function(K){F=[];E.forEach(K.objects,function(N){F.push(N.did);});G=mstrmojo.array.indexOf(F,J);if(G!==-1){F.splice(G,1);}F.unshift(J);H=F.slice(0,3).join(",")+",";var L={taskId:"setPreference",prefs:"recentFolders\u001E"+H};var M={success:function(){mstrConfig.recentFolders=H;},failure:function(N){mstrmojo.alert(N.message||N.getResponseHeader("X-MSTR-TaskFailureMsg"));}};I.ob.getDataProvider().serverRequest(L,M);},failure:function(K){mstrmojo.alert(K.message||K.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.FilterExpr","mstrmojo.threshold.AndOrNode","mstrmojo.threshold.ConditionNode","mstrmojo.expr","mstrmojo.hash");var B=mstrmojo.hash,G=mstrmojo.expr,D=G.ET,H=mstrmojo.mstr.EnumNodeProperties;mstrmojo.threshold.ThresholdExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.threshold.ThresholdExprTree",cssClass:"mstrmojo-ThresholdExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,supportRelation:true,nodeClassMap:{14:mstrmojo.threshold.AndOrNode,"*":mstrmojo.threshold.ConditionNode},getItemIdentityProp:function(J){if(J.node&H.CONDITION){return"*";}return this._super(J);},getItemConfig:function(M,J,N){var L=this._super(M,J,N),K=B.walk("tree.editor.controller.dataService.model",N),O=B.walk("tree.editor.controller.data.gsi",N);this.adjustItemName(M,K,O);return L;},onConditionEdit:mstrmojo.emptyFn,editor:undefined,isEditable:function I(J){if(!this.editable){return false;}if(J&&J.et===D.XML){return !J.xml;}return true;},onNew:function C(J){J.data.isNew=true;this.editor.openConditionWalk(J.data,J.widget.ctxtBuilder.itemWidgets[J.index]);},onnodeclick:function A(J){var K=J.part;if(!J||!K){return ;}var M=K==="andor",L=this.tree.editor;if(!((M&&this.prefixedAndOrEditable)||(!M&&this.editable))){return ;}if(!this.editable){return ;}if(M){L.openAndORPopup(this,J.getTarget());return ;}else{if(K==="addCondition"){this.tree.newCondition({et:D.AE});return ;}}L.openConditionWalk(this.data,this);},allowDrop:function F(J){var O=J&&J.src,N=O&&O.data,L=N&&N.et,M=this.tree,K=O&&O.widget&&O.widget.tree;return L&&(this===M?(K!==M):true);},remove:function E(K){var J=this._super(K);if(this.items.length===0&&K.et===D.ANDOR&&K.nds.length===0&&this.parent.removeFromModel){this.parent.removeFromModel();}return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var N=mstrmojo.dom,d=mstrmojo.array,B=mstrmojo.css,j="animate",k="90px",p="70px",F="52px",y=200,Q=700,A=400;function D(){var AG=window.Modernizr,AF="transition";if(AG&&AG.testProp(AF)){return N.transEndEvtNames[AG.prefixed(AF)];}return null;}function AA(AF){return function(){this.menuNode.style.display=AF?"block":"none";};}function P(AF){return Math.min(AF.offsetWidth-AF.firstChild.offsetWidth,0);}function z(AF){return AF.isAlignRight?"right":"left";}function AD(AF,AG){return parseInt(AF.style[z(AG)],10)||0;}function L(){var AJ=this.tabContainerNode,AI=false,AH=false,AK=false,AL=this.leftBtnNode,AF=this.rightBtnNode,AG=this.isValidMode();window.setTimeout(function(){if(P(AJ)<0){var AN=N.position(AJ),AM=N.position(AJ.firstChild);AI=(AM.x<AN.x);AH=(AM.x+AM.w>AN.x+AN.w+1);}AK=AI||AH;B.toggleClass(this.btnBarNode,"highlightBar",AK);AL.style.display=AF.style.display=AK?"block":"none";AL.disabled=!AI;AF.disabled=!AH;B.toggleClass(AL,"disable",!AI);B.toggleClass(AF,"disable",!AH);if(this.domNode&&!this.isCustomAddBtn){this.addBtnNode.style.display=this.tabStripMenuNode.style.display=AG?"block":"none";this.bufferNode.style.display=AG?"none":"block";this.floaterNode.style.display=this.hasFloater&&AI?"block":"none";}this.widgetResized();}.bind(this),y);}function W(AF,AG){AF=(AF||[]);if(!AF.filter){return d.filter(AF,AG);}return AF.filter(AG);}function Z(AF,AG){AF=(AF||[]);if(!AF.map){return d.map(AF,AG);}return AF.map(AG);}function u(AV,AH,AI){var AT=this.tabContainerNode,AM=this.domNode;if(this.isStatic||!AT||!AM||AM.style.display==="none"){return ;}var AO=AT.firstChild,AU=P(AT),AL=AD(AO,this),AF=Math.max(AL,AU),AS=W(this.children,function(AW){return AW.isSelected;})[0],AQ=AI&&AI.domNode||AS&&AS.domNode;if(AV&&AQ){if(AU<0){var AN=N.position(AQ),AJ=N.position(AT),AP=Math.floor(AN.x-AJ.x),AR=Math.floor(AN.x+AN.w-(AJ.x+AJ.w));if(AI){var AG=Math.ceil(AQ.offsetWidth);AP=AP===0?Math.max(AU,-AG):AP;AR=AR===0?Math.min(-AU,AG):AR;}var AK=AP<0?AP:(AR>0?AR:0);AF=this.isAlignRight?AF+AK:AF-AK;}}if(AF!==AL){if(AH){this.setAnimation(AO);}AO.style[z(this)]=Math.max(AU,Math.min(AF,0))+"px";}L.call(this);}function C(AF){return AF.hasOwnProperty("index");}function b(){var AF=this.children,AG=0;(AF||[]).every(function(AI,AH){if(!C(AI)){return false;}AG++;AI.index=AH;return true;});(AF||[]).every(function(AH){if(!C(AH)){return false;}AH.total=AG;return true;});}function i(AL,AH){var AK=AL.ENUM_CORNERS,AM=[AK.TOP_LEFT,AK.BOTTOM_LEFT],AG=this.parent;if(AG.position!=="bottom"){AM.reverse();}AL.setAlignment(AM[0],AM[1]);var AF=N.position(AG.domNode),AJ=AG.menuNode;var AI=AJ.style;AI.top=(AH.y-AF.y)+"px";AI.left=(AH.x-AF.x)+"px";AL.addPopupHandlers(AG.id,AA(true),AA(false));AL.hostId=AG.id;AL.hostElement=AJ;AL.isHostedWithin=false;AG.openPopup(AL.newInstance());}function l(AF){AF.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" mstrAttach:wheel><div class="mstrmojo-VITabStrip-menu" mstrAttach:click><div id="tabCommonIcon" class="mstrmojo-VITabStrip-menuIcon"></div><div id="tabCommonButton" class="mstrmojo-VITabStrip-menuButton"></div><div id="tabCommonMenuHost" class="mstrmojo-VITabStrip-menuButtonHost"></div></div><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-buffer"></div><div class="mstrmojo-VITabStrip-btnBar"><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div class="mstrmojo-VITabStrip-addBtn-Img"></div><div class="mstrmojo-VITabStrip-addBtn-Text"></div></div><div class="mstrmojo-VITabStrip-navBtns"><div id="tabRightButton" class="mstrmojo-VITabStrip-rightBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div><div id="tabLeftButton" class="mstrmojo-VITabStrip-leftBtn" mstrAttach:click,mousedown,mouseup,mouseover,mouseout><div class="navBtnIcon"></div></div></div></div><div class="mstrmojo-VITabStrip-floater"></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabStripMenuNode:function(){return this.domNode.firstChild;},menuImgNode:function(){return this.domNode.firstChild.firstChild;},menuBtnNode:function(){return this.domNode.firstChild.childNodes[1];},menuBtnHostNode:function(){return this.domNode.firstChild.lastChild;},tabContainerNode:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},bufferNode:function(){return this.domNode.childNodes[2];},btnBarNode:function(){return this.domNode.childNodes[3];},addBtnNode:function(){return this.domNode.childNodes[3].firstChild;},addBtnImgNode:function(){return this.domNode.childNodes[3].firstChild.firstChild;},addBtnTxtNode:function(){return this.domNode.childNodes[3].firstChild.lastChild;},navBtnsNode:function(){return this.domNode.childNodes[3].lastChild;},rightBtnNode:function(){return this.domNode.childNodes[3].lastChild.firstChild;},leftBtnNode:function(){return this.domNode.childNodes[3].lastChild.lastChild;},floaterNode:function(){return this.domNode.childNodes[4];},menuNode:function(){return this.domNode.childNodes[5];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isCustomAddBtn:false,isAlignRight:true,tabStripMenuNode:null,menuImgNode:null,menuBtnNode:null,menuBtnHostNode:null,tabContainerNode:null,addBtnNode:null,bufferNode:null,navBtnsNode:null,leftBtnNode:null,rightBtnNode:null,menuNode:null,position:"bottom",selectMovedTab:false,hasFloater:false,tabNavInterval:0,tabObjects:null,layoutConfig:{w:{tabContainerNode:"100%",bufferNode:"6px",addBtnNode:k,navBtnsNode:F,tabStripMenuNode:p},xt:true},onAppStateChange:function s(AM){var AK=mstrmojo.vi.VisualInsightApp.APP_STATES,AL=AK.PRESENTATION,AF=AK.SELECTOR_TARGETING,AG=AM.value,AN=AM.valueWas,AJ=this.isValidMode();if(AG&AL||AN&AL||AG&AF||AN&AF){var AH=this.addBtnNode,AI=this.tabStripMenuNode;if(AH&&AI){AH.style.display=AI.style.display=AJ?"block":"none";this.bufferNode.style.display=AJ?"none":"block";this.doLayout();}}},setStatic:function R(AF,AG){this.isStatic=AF;if(!AF){u.call(this,true,AG);}},setTabs:function q(AI,AF){var AG=[];d.forEach(this.children,function(AK){AG.push(AK);});this.removeChildren();d.forEach(AG,function(AK){if(AK.destroy){AK.destroy();}});this.tabObjects=AI;var AJ=this,AH=(AI&&AI.length)||0;this.addChildren(Z(AI,function(AM,AK){var AL=AM.k;return AJ.getTabCfg(AI,AM,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:AK,total:AH,draggable:!!AH,dropZone:!!AH,k:AL,isSelected:AL===AF,showTabMenu:i,tabMoved:function(AO){var AN=this.index;AJ.moveTab(AN,AN+(AO?-1:1),AN);}});}));u.call(this,true);l(this);},getTabs:function m(){return W(this.children,C);},getTabCfg:function AE(AG,AH,AF){return AF;},deleteTab:function I(AF){var AL=this.id,AK=this.children[AF],AJ=D(),AI=function(){var AM=mstrmojo.all[AL];AM.removeChildren(AK);AK.destroy();b.call(AM);L.call(AM);l(AM);};if(AJ){var AH=AK.domNode.firstChild,AG=AH.style;AG.width=AH.offsetWidth+"px";window.setTimeout(function(){B.addClass(AH,j);N.attachOneTimeEvent(AH,AJ,AI);AG.width=0;},0);}else{AI();}},buildRendering:function e(){this._super();B.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function X(){var AF=this._super();u.call(this,true);return AF;},doLayout:function K(){this._super();u.call(this,true);},isValidMode:function E(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||(mstrApp.allowWebDashboardDesign&&!mstrApp.allowWebDashboardDesign()));},setSelectedTab:function U(AF){var AG,AH;d.forEach(this.children||[],function(AI){AH=AI.k===AF;AI.set("isSelected",AH);if(AH){AG=AI;}});l(this);return AG;},getSelectedTab:function h(){var AH=null,AG=this.children||[],AF;for(AF=0;AF<AG.length;AF++){if(AG[AF].isSelected){AH=AG[AF];break;}}return AH;},onclick:function o(AF){if(mstrApp.hasRequests&&mstrApp.hasRequests()){return false;}if(!this.isValidMode()){return false;}if(AF.getTarget()===this.addBtnImgNode||AF.getTarget()===this.addBtnTxtNode){this.addTab();}return true;},addTab:mstrmojo.emptyFn,clearBtnTooltips:function O(AH){var AF=(AH===this.leftBtnNode),AG=(AH===this.rightBtnNode);if(AF||AG){this.clearTooltips();return true;}return false;},showBtnTooltips:function G(AF){var AH=AF.getTarget().parentNode,AG=this.clearBtnTooltips(AH);if(AG){this.toggleTooltip(AH);}},onmouseout:function w(AF){var AG=AF.getTarget().parentNode;this.clearBtnTooltips(AG);},onmouseover:function H(AF){this.showBtnTooltips(AF);},onwheel:function S(AF){var AG=AF.e.deltaY<0?this.leftBtnNode:this.rightBtnNode;AF.target=AG.firstChild;AG.onmousedown(AF);AG.onmouseup(AF);},onmouseup:function c(AF){if(AF.e.name!=="wheel"){window.setTimeout(function(){this.showBtnTooltips(AF);}.bind(this),y);}var AG=AF.getTarget().parentNode;if(AG===this.leftBtnNode||AG===this.rightBtnNode){window.clearInterval(this.tabNavInterval);B.removeClass(AF.target,"active");L.call(this);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}}},onmousedown:function g(AM){var AJ=AM.getTarget().parentNode,AN=(AJ===this.leftBtnNode),AH=(AJ===this.rightBtnNode);if(AN||AH){var AL=this.tabContainerNode,AI=AL.firstChild,AK=this;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}B.addClass(AJ,"active");var AF=function(){var AQ=P(AL),AT=AD(AI,AK),AU=AT-AQ,AS=0-AT,AV=false;AK.setTabProperties();var AO=AK.getCornerTabs()||[],AR=W(AO,function(AW){if(AN&&AW.isLeftMost||AH&&AW.isRightMost){return AW;}})[0],AP=0;if(AR){AV=AR.isCutoff;AP=AV?(AN?AR.leftEdgeHiddenWidth:AR.rightEdgeHiddenWidth):Math.ceil(AR.domNode.offsetWidth);AP=Math.min(AP,AN?AS:AU);AP=AK.isAlignRight?(AN?-AP:AP):(AN?AP:-AP);}if(!AV&&AM.e.name!=="wheel"){AK.setAnimation(AI);}AI.style[z(AK)]=parseInt(AI.style[z(AK)]||0)+AP+"px";return AV;};var AG=AF();if(AG){AF();}this.tabNavInterval=window.setInterval(function(){AF();},A);}},setTabProperties:function J(){var AF=this.tabContainerNode,AG=N.position(AF);d.forEach(this.children||[],function(AL){var AO=AL.domNode,AJ=N.position(AO),AM=Math.floor(AJ.x-AG.x),AI=Math.floor(AJ.x+AJ.w-(AG.x+AG.w)),AH=Math.ceil(AO.getBoundingClientRect().width),AK=0;AL.isCutoff=AL.isHidden=AL.isLeftMost=AL.isRightMost=false;AL.leftEdgeHiddenWidth=AL.rightEdgeHiddenWidth=0;if(AM<0){var AN=Math.abs(AM);AK=AH-AN;AL.isLeftMost=AK>=0;AL.isCutoff=AL.isLeftMost&&AN>0&&AK>0;AL.isHidden=AK<=0;AL.leftEdgeHiddenWidth=AN;}else{if(AI>0){AK=AH-AI;AL.isRightMost=AK>=0;AL.isCutoff=AL.isRightMost&&AI>0&&AK>0;AL.isHidden=AK<=0;AL.rightEdgeHiddenWidth=AI;}}});},getCornerTabs:function f(){return W(this.children,function(AF){return AF.isLeftMost||AF.isRightMost;});},setAnimation:function a(AF){var AG=D();if(AG){B.addClass(AF,j);N.attachOneTimeEvent(AF,AG,function(){B.removeClass(AF,j);});}},createTooltip:function AB(AJ){var AH=AJ.getAttribute("tooltip"),AL;if(!AH){return null;}AL=document.createElement("div");AL.className="navBtnTooltip";AL.appendChild(document.createTextNode(AH));var AK=document.body.firstChild;AK.parentNode.insertBefore(AL,AK);var AN=5,AG=AL.offsetWidth-25,AM=AJ.getBoundingClientRect(),AF=AL.getBoundingClientRect(),AI=AM.top-(AF.height+AN);AL.style.top=AI+"px";AL.style.left=(AM.left-AG)+"px";return AL;},clearTooltips:function n(){window.clearTimeout(this._tooltipTimeOut);var AF=document.querySelectorAll(".navBtnTooltip");d.forEach(AF||[],function(AG){AG.parentNode.removeChild(AG);});},toggleTooltip:function AC(AF){window.clearTimeout(this._tooltipTimeOut);if(AF.disabled){this._tooltipTimeOut=window.setTimeout(function(){this.createTooltip(AF);}.bind(this),Q);}},moveTab:function M(AF,AN,AL,AK){var AG=this.children,AO=AG.splice(AF,1)[0];AG.splice(AN,0,AO);b.call(this);this.setAnimation(this.tabContainerNode.firstChild);var AH=this.containerNode,AI=AH.childNodes,AM=AH.removeChild(AI[AF]),AJ=AI[AN];if(AJ){AH.insertBefore(AM,AJ);}else{AH.appendChild(AM);}if(this.selectMovedTab||AO.isSelected){u.call(this,true,true,AO);}if(!AK&&AL!==undefined&&AL!==AN){this.commitTabMove(AL,AN);l(this);}},commitTabMove:function x(AF,AG){throw new Error(this.scriptClass+" must implement commitTabMove.");},updateTabTable:function t(AF){if(!this.isStatic){u.call(this,true,AF);}},setLinkIcon:function Y(AF,AI){var AH,AG;if(AF){if(AI){AG="src";d.some(this.getTabs(),function(AJ){if(AJ.k===AI){AH=AJ;}return AH;});if(!AH){return ;}}else{AG="tgt";AH=this.getSelectedTab();}B.addClass(AH.domNode,AG);}else{AG=AI?["src","tgt"]:"tgt";d.forEach(this.children,function(AJ){B.removeClass(AJ.domNode,AG);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var R=mstrmojo.dom,U=mstrmojo.css,AK=mstrmojo.Enum_Keys,H=mstrmojo.range,m=H.EDGE,AC=mstrmojo.ME.MetricToken.isDelimiter,Q=mstrmojo.expr,u=mstrmojo.array,K=mstrmojo.hash;var M=R.isIE||R.isIEW3C;function AS(E){return E.ctrlKey||R.isMetaKey(window,E)||(E.charCode||E.keyCode)===AK.CTRL;}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.ME.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function S(E){var AT=E.ownerDocument,AU=AT.createElement("span");return AU;},_iw2idx:function X(AT,AW,AV){var AU=this.wrapperNodes(AW),E=mstrmojo.array.indexOf(AU,AV);return E===-1?AU.length:E;},itemOffsetLeft:function k(AT,AX,E,AV){if(!AV){var AU=this.wrapperNodes(AX);AV=AU&&AU[E];if(!AV){return 0;}}var AW=AX.firstChild;if(!AW||(AW===AV)){return 0;}return AV.offsetLeft-AW.offsetLeft;},whereDrop:function AR(Ab,E,AV,Aa,AT){var AX=this._nd2iw(Ab,E,AV),Ac,AZ,AW,AY,AU;if(AX){AZ=this._iw2idx(Ab,E,AX);Ac=AZ;AW=this.itemOffsetLeft(Ab,E,null,AX);AY=AX.offsetTop;AU=AX.offsetWidth;if(Aa.x>AT.left+AW+AU/2){Ac++;AW+=AU;}}else{return Ab.dropCuePos;}return{left:AW,top:AY,idx:Ac,idxActual:AZ};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function G(E){var AT=E.src.data;return !!AT;},createToken:function A(E){return{v:mstrmojo.ME.MetricToken.brackets(E.n),oi:K.copyProps(["did","n","t"],E),isNew:true};},ondrop:function(AT){AT.src.data=this.createToken(AT.src.data.item);if(this.prepareDropItem){this.prepareDropItem(AT);}var E=this.insertTokens([AT.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");return E;},ondragenter:function I(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function Y(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function a(AT){var AU=AT.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AU){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"mstrevent = "dragstart contextmenu keydown keypress keyup mouseup paste blur"ondragstart = "return false;" oncontextmenu = "return false;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" onblur = "return mstrmojo.all.{@id}.handleblur(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" mstrevent = "keyup"onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function J(AU,E,AT){return new mstrmojo.ME.MetricToken({data:AU,parent:AT});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function Z(AT,E){if(this._super){this._super(AT,E);}if(this.oi){this.oi.tks.items=this.items;}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:AC,postBuildRendering:function g(){if(this._super){this._super();}this._eros=false;if(R.isFF){document.body.spellCheck=false;}mstrmojo.dom.attachEvent(this.editNode,"compositionstart",function(){this.saveStateForIME();this.composing=true;this.toggleIMEStatusBar(true);}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionupdate",function AT(AU){if(R.isIEW3C){this.lastImeChar=AU.data||(M&&this.lastImeChar);}else{this.lastImeChar=AU.data||this.lastImeChar;}}.bind(this));mstrmojo.dom.attachEvent(this.editNode,"compositionend",function E(AW){this.composing=false;if(R.isIE9||R.isIE10){var AV=H.getRangeInfo();this.imeBuffer=AV.startContainer.data.slice(this.prev_rInfo.startOffset,AV.startOffset).split("");}else{if(R.isIEW3C){var AV=H.getRangeInfo();this.imeBuffer=AV.startContainer.data.slice((this.prev_rInfo.startOffset-1)<0?0:this.prev_rInfo.startOffset,AV.startOffset).split("");}else{if(R.isEdge){var AU=AW.data||"";this.imeBuffer=(this.imeBuffer||[]).concat(AU.split(""));}else{var AU=AW.data||this.lastImeChar||"";this.imeBuffer=(this.imeBuffer||[]).concat(AU.split(""));}}}}.bind(this));},fnContextMenu:function N(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},saveStateForIME:function j(){if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=H.getRangeInfo();this.prev_items=this.items;}},handleblur:function L(){if(this.doubleByte){this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}},processDeleteKeyDown:function D(AT){if(!this.doubleByte){try{this.widgetHandleDelete(AT);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(E){}return true;}},processBackspaceKeyDown:function AQ(AT){if(!this.doubleByte){try{this.widgetHandleBackspace(AT);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}return true;}},handlekeydown:function d(AV){AV=AV||window.event;var E=AV.keyCode||AV.charCode,AT=false,AU=H.getRangeInfo();if((E===AK.LEFT_ARROW||E===AK.RIGHT_ARROW||E===AK.BACKSPACE)&&this.doubleByte){if(this.composing){return ;}this.doubleByte=false;if(E===AK.BACKSPACE){this.imeBuffer.pop();}this.widgetHandleImeInput(this.prev_rInfo);mstrmojo.dom.stopPropogation(window,AV);mstrmojo.dom.preventDefault(window,AV);return false;}switch(E){case AK.DELETE:AT=this.processDeleteKeyDown(AU);break;case AK.BACKSPACE:AT=this.processBackspaceKeyDown(AU);break;case AK.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case AK.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AT=true;break;case AK.ESCAPE:this.endTokenSuggestion();AT=true;break;case 86:if(AS(AV)){this.handlePasteTriggeredDeletion();AT=false;}break;case 88:if(AS(AV)){document.execCommand("copy");this.widgetHandleDelete(AU);AT=true;}break;case 89:if(AS(AV)){this.widgetHandleUndoRedo("redo");AT=true;}break;case 90:if(AS(AV)){this.widgetHandleUndoRedo("undo");AT=true;}break;case 229:this.saveStateForIME();break;default:}if(AT){R.stopPropogation(window,AV);R.preventDefault(window,AV);return false;}return true;},handlePasteTriggeredDeletion:function F(){this.set("_saveRangeInfo",H.getRangeInfo());if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this.set("_saveRangeInfo",H.getRangeInfo());}this.clipboardNode.focus();},getCharacter:function AM(AT){var E=(R.isIE&&!R.isIE9)?AT.keyCode:AT.charCode;return(E>0)?String.fromCharCode(E):null;},handleCharacter:function AD(AV){var AW=this.getCharacter(AV),AT=false;if(AW&&!((AW==="c"||AW==="a")&&AS(AV))){try{this.widgetHandleInput(H.getRangeInfo(),AW);this.raiseChangeEvent({type:"input",character:AW});if(!this.isDelimiter(AW)){if(this.useKeyDelay){var AU=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AU.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AT=true;}return AT;},handlekeypress:function B(E){E=E||window.event;if(this.doubleByte){this.toggleIMEStatusBar(false);this.doubleByte=false;this.widgetHandleImeInput(this.prev_rInfo);window.setTimeout(function(){this.handleCharacter(E);}.bind(this),10);return false;}if(this.handleCharacter(E)){R.stopPropogation(window,E);R.preventDefault(window,E);return false;}return true;},handlekeyup:function i(AU){var E=AU.keyCode||AU.charCode,AT;if(E===AK.LEFT_ARROW||E===AK.RIGHT_ARROW){AT=this.findObjectToken();if(AT&&AT===this._saveActiveToken){this.startTokenSuggestion(AT);}else{this.endTokenSuggestion();}}else{if(E===AK.UP_ARROW){this.preHighlight();}else{if(E===AK.DOWN_ARROW){this.nextHighlight();}else{if(E===AK.BACKSPACE&&this.doubleByte){if(E===AK.BACKSPACE&&!this.composing&&!R.isIE9){this.doubleByte=false;this.imeBuffer.pop();this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;}}}}}this.set("_saveRangeInfo",H.getRangeInfo());},handlemouseup:function s(AV){if(this.dropCuePos){return false;}var AT=this.findObjectToken();if(AT&&AT===this._saveActiveToken){this.startTokenSuggestion(AT);}else{this.endTokenSuggestion();}var AU=H.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var E=this.widgetHandleImeInput(this.prev_rInfo);this.prev_items=this.items;AT=R.findWidget(AU.startContainer);if(AT){this._delaySetTextCaretPos(AT.domNode,AU.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AU.startOffset-1);}this.prev_rInfo=AU;}this.set("_saveRangeInfo",AU);},handlepasteDirect:function AH(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlePasteTriggeredDeletion();this.handlepaste(E);R.stopPropogation(window,E);R.preventDefault(window,E);return false;},handlepaste:function p(AX){var AT=this.clipboardNode.value;this.clipboardNode.value="";var AW=[],E=AT&&AT.length,AV,AU="",AY;if(E>0){for(AV=0;AV<E;AV++){AY=AT.charAt(AV);if(this.isDelimiter(AY)){if(AU.length>0){AW.push({v:AU,isNew:true});AU="";}AW.push({v:AY,isDelimiter:true,isNew:true});}else{AU=AU+AY;}}if(!mstrmojo.string.isEmpty(AU)){AW.push({v:AU,isNew:true});AU="";}this.insertTokens(AW);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AP(){var AT=[],AV=this.items,AU,E;for(AU=0,E=AV.length;AU<E;AU++){AT[AU]=AV[AU].v;}return AT.join("| ");},replaceErrorToken:function t(AV){var AU=this.items||[],AW=mstrmojo.array.find(AU,"sta",-1),AT,AX=function(Ad,Ab,Ae){var Aa=(Ad&&Ad.items)||[],AZ=u.find(Aa,"did",Ab),AY,Ac;if(AZ>-1){AY=Aa[AZ].fs;Ac=u.filterOne(AY,function(Af){return Af.fnm&&Af.fnm.toUpperCase()===Ae.toUpperCase();});}return Ac;},E=function(Ad,Ab,Ac){var AY={v:Ab.n,oi:Ab,isNew:true},Aa=Ad.v&&Ad.v.split("@"),AZ;if(Aa&&Aa.length>1){AZ=AX(Ac,Ab.did,Aa[1]);if(AZ){AY.exv=AZ.fmdid||AZ.fid;AY.extp=8;AY.v=mstrmojo.ME.MetricToken.brackets(Ab.n)+"@"+AZ.fnm;}}return AY;};if(AW>-1){AT=E(AU[AW],AV,this.candidates);this.remove(AW);this.add([AT],AW);}},widgetHandleDelete:function h(AW){if(AW.collapsed){var AV,AU,E,AX=AW.startOffset,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)){H.collapseOnNode(this.editNode,false);return ;}AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);AU=R.findWidget(AW.startContainer);E=this.itemIndex(AU.data);if(AV===m.EDGE_END){E++;AU=AT[E];AX=0;}if(!AU){H.collapseOnNode(this.editNode,false);return ;}if(AU.length()===1){this.remove(E);AU=AT[E];if(AU){H.collapseOnNode(AU.domNode,true);}else{H.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AU.spliceContent(AX,1);H.collapseOnTextNode(AU.domNode,AX);}}else{this.widgetDeleteTokens(AW);}},widgetHandleBackspace:function AB(AW){if(AW.collapsed){var AV,AU,E,AX=AW.startOffset,AT=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)){if(AW.startOffset>0&&R.isFF){AU=AT[this.items.length-1];H.collapseOnNode(AU.domNode,false);AW=H.getRangeInfo();AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);}else{H.collapseOnNode(this.editNode,true);return ;}}AV=H.getEdgeInfo(AW.startContainer,AW.startOffset);AU=R.findWidget(AW.startContainer);E=this.itemIndex(AU.data);if(AV===m.EDGE_BEGIN){E--;AU=AT[E];AX=AU.length();}if(!AU){H.collapseOnNode(this.editNode,true);return ;}if(AU.length()===1){this.remove(E);AU=AT[E-1];if(AU){H.collapseOnNode(AU.domNode,false);this.checkMergeTwoTokens(E-1,E);AU=AT[E-1];}else{H.collapseOnNode(this.editNode,true);}}else{AU.spliceContent(AX-1,1);H.collapseOnTextNode(AU.domNode,AX-1);}}else{this.widgetDeleteTokens(AW);}},widgetHandleInput:function AE(AX,AY){if(!AX.collapsed){this.widgetDeleteTokens(AX);AX=H.getRangeInfo();}var AU,AZ,Aa,Ab,E,AT,AV=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AX.startContainer,false,document.body)){this.add([{v:AY,isDelimiter:this.isDelimiter(AY),isNew:true}],0);AZ=AV[0];H.collapseOnTextNode(AZ.domNode,1);return ;}AU=H.getEdgeInfo(AX.startContainer,AX.startOffset);AZ=R.findWidget(AX.startContainer);Aa=this.itemIndex(AZ.data);if(this.isDelimiter(AY)){Ab={v:AY,isDelimiter:true,isNew:true};if(AU===m.EDGE_MIDDLE){var AW=AZ.split2Tokens(AX.startOffset);this.remove(Aa);this.add([AW[0],Ab,AW[1]],Aa);Aa=Aa+1;}else{Aa=(AU===m.EDGE_BEGIN)?Aa:Aa+1;this.add([Ab],Aa);}AZ=AV[Aa];H.collapseOnTextNode(AZ.domNode,(AZ.domNode.innerText||AZ.domNode.textContent).length);}else{AT=AX.startOffset;if(AZ.isDelimiter()){E=AV[(AU===m.EDGE_BEGIN)?Aa-1:Aa+1];if(E&&!E.isDelimiter()){AZ=E;AT=(AU===m.EDGE_BEGIN)?AZ.length():0;}}if(!AZ.isDelimiter()){AZ.spliceContent(AT,0,AY);H.collapseOnTextNode(AZ.domNode,AT+1);}else{this.add([{v:AY,isNew:true}],(AU===m.EDGE_BEGIN)?Aa:Aa+1);AZ=AV[(AU===m.EDGE_BEGIN)?Aa:Aa+1];H.collapseOnNode(AZ.domNode,false);}}},widgetHandleImeInput:function AE(AW,AX){AX=AX||this.imeBuffer.join("");this.imeBuffer=[];this.lastImeChar=null;if(!AX){return ;}if(!AW.collapsed){this.widgetDeleteTokens(AW);AW=H.getRangeInfo();}var AU,AY,AZ,Aa,E,AT,AV=this.ctxtBuilder.itemWidgets;if(!R.contains(this.editNode,AW.startContainer,false,document.body)||this.items.length==0){this.clearTokens();this.add([{v:AX,isDelimiter:this.isDelimiter(AX),isNew:true}],0);AV=this.ctxtBuilder.itemWidgets;AY=AV[0];H.collapseOnTextNode(AY.domNode,1);this._delaySetCaretPos(AY.domNode,false);return ;}AU=H.getEdgeInfo(AW.startContainer,AW.startOffset);AY=R.findWidget(AW.startContainer);AZ=this.itemIndex(AY.data);AT=AW.startOffset;if(AY.isDelimiter()){this.clearTokens();this.add(this.prev_items);AV=this.ctxtBuilder.itemWidgets;E=AV[(AU===m.EDGE_BEGIN)?AZ-1:AZ+1];if(E&&!E.isDelimiter()){AY=E;AT=(AU===m.EDGE_BEGIN)?AY.length():0;}}if(!AY.isDelimiter()){AY.spliceContent(AT,0,AX);this._delaySetTextCaretPos(AY.domNode,AT+AX.length);}else{this.add([{v:AX,isNew:true}],(AU===m.EDGE_BEGIN)?AZ:AZ+1);AY=AV[(AU===m.EDGE_BEGIN)?AZ:AZ+1];this._delaySetCaretPos(AY.domNode,false);}this.startTokenSuggestion();return AY;},findObjectToken:function C(){var AW=H.getRangeInfo(),AU=R.findWidget(AW.startContainer);if(!R.contains(this.editNode,AW.startContainer,false,document.body)){return null;}if(!AU||AU===this||!AU.isDelimiter){return null;}if(AU&&!AU.isDelimiter()){return AU;}var AV=H.getEdgeInfo(AW.startContainer,AW.startOffset),AT=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AU.data);AU=AT[(AV===m.EDGE_BEGIN)?E-1:E+1];if(AU&&!AU.isDelimiter()){return AU;}return null;},checkMergeTwoTokens:function z(AW,AU){var AV=this.ctxtBuilder.itemWidgets,AT=AV[AW],E=AV[AU];if((AT&&!AT.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AW,AU]);this.add([AT.mergeTo(E)],AW);H.collapseOnTextNode(AV[AW].domNode,AT.length());}},insertTokens:function AG(AX){var Aa=0,AZ=this.editNode;var AU=this._saveRangeInfo||H.getRangeInfo();if(!AU||!R.contains(AZ,AU.startContainer,false,document.body)){this.add(AX);Aa=this.items.length-1;if(Aa===0){this._delaySetTextCaretPos(AZ,(AZ.innerText||AZ.textContent).length);}else{var E=this.ctxtBuilder.itemWidgets[Aa].domNode;this._delaySetTextCaretPos(E,(E.innerText||E.textContent).length);}}else{var AT=H.getEdgeInfo(AU.startContainer,AU.startOffset),AY=R.findWidget(AU.startContainer);Aa=this.itemIndex(AY.data);if(AT===m.EDGE_MIDDLE){var AV=AY.split2Tokens(AU.startOffset);this.remove(Aa);AX.unshift(AV[0]);AX.push(AV[1]);this.add(AX,Aa);}else{Aa=(AT===m.EDGE_BEGIN?Aa:Aa+1);this.add(AX,Aa);}Aa=Aa+AX.length-1;AY=this.ctxtBuilder.itemWidgets[Aa];this._delaySetCaretPos(AY.domNode,false);}this.raiseChangeEvent({type:"insert"});var AW=this;window.setTimeout(function(){AW.set("_saveRangeInfo",H.getRangeInfo());},50);return Aa;},insertParenthesisTokens:function AJ(AT){var E=this;window.setTimeout(function(){var AU=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AU-1],1);},AT||50);},clearTokens:function y(E){this.set("items",E||[]);this.set("_saveRangeInfo",null);this._delaySetCaretPos(this.editNode,false);},focus:function AF(){var AT=this.ctxtBuilder.itemWidgets,E=AT.length;this._delaySetCaretPos(E>0?AT[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AL(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[Q.TP.FOLDER,Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.FILTER,Q.STP.PROMPT_OBJECTS,Q.TP.ATTR,Q.TP.DIM,Q.TP.METRIC,Q.TP.ROLE].join(","),getSearchPattern:function c(){var AT=this._saveActiveToken,AV=AT&&AT.data.v.trim(),E=AV&&AV.length;if(E>2){if(AV.charAt(0)==="["){AV=AV.substring(1);}if(AV.charAt(AV.length-1)==="]"){AV=AV.substring(0,AV.length-1);}}if(AT&&AT.data.ift){var AU=AT.data.v,AW=AU&&AU.indexOf("@");if(AW>=0){AV=AU.substring(AW);}}return AV||"";},getSuggestionPos:function l(){var E=this._saveActiveToken,AT=null,AV,AU;if(E){AV=E.data&&E.data.ift;AU=mstrmojo.dom.position(E.domNode,true);AT={left:Math.round(AU.x+(AV?AU.w:0))+"px",top:Math.round(AU.y+AU.h)+"px",zIndex:100};}return AT;},updateSuggestionListHeightThenNudge:function W(E){if(mstrApp.isWorkstationPlugin){var AU=this._saveActiveToken;if(AU&&E){var AX=AU.data&&AU.data.ift,AT=mstrmojo.dom.position(AU.domNode,true),Ad=Math.round(AT.y+AT.h),AV=Math.round(AT.x+(AX?AT.w:0)),Aa=5,Af=window.innerHeight-Ad-Aa,AY=E.list&&E.list.scrollNode&&(E.list.scrollNode.offsetHeight>Af),Ab=5,Ac=window.innerWidth-Ab,AW=AY?19:0,Ae=((this.suggestionPopup&&this.suggestionPopup.domNode&&this.suggestionPopup.domNode.offsetWidth)+AW)||0,AZ=(AV+Ae)>Ac;if(AY&&E.list&&E.list.scrollNode){E.list.scrollNode.style.maxHeight=Af+"px";E.list.updateScrollbars();}E.set("left",(AZ?(Ac-Ae):AV)+"px");E.set("top",Ad+"px");}}},item2textCss:function O(AT){var E=(this._super&&this._super(AT))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AT.t]||"";E+=AT.da?" da":"";E+=(AT.dm||AT.um)?" dm":"";E+=AT.de?" de":"";E+=AT.fs&&AT.fs.length&&AT.fs.some(function(AU){return AU.fgr>0;})?" g":"";return E;},onBrowserOpen:function AA(){this.editNode.blur();},onSuggestionItemSelect:function AI(AT){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AT.t===21){E.setFormInfo(AT);}else{E.setItemInfo(AT);if(AT.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AN(E,AU){var AT=this.editNode,AV=this,AW=function(){AT.focus();AT.focus();H.collapseOnNode(E,AU);AV.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AW,0);},_delaySetTextCaretPos:function AN(E,AW){var AT=this.editNode,AU=this,AV=function(){AT.focus();AT.focus();H.collapseOnTextNode(E,AW);AU.set("_saveRangeInfo",H.getRangeInfo());};window.setTimeout(AV,0);},getCandidatesThroughTaskCall:function f(AT,E){AT.objectType="11,12,13,43,4";AT.rootFolderType=39;AT.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AT,E);},filterCandidates:function x(AW,AV,E){var AT=this._saveActiveToken,AX=AT&&(AT.data.oi||AT.data.at),AU;if(AX&&AT.data.ift){E=E||this.suggestCount;AV=mstrmojo.string.regEscape(AV);AU=u.filter(AW,function(AY){return AY.t===21&&AY.attid===AX.did&&(new RegExp("^"+AV,"i")).test("@"+AY.n);},{max:E});}else{AU=u.filter(AW,function(AY){return AY.t!==21;});AU=this._super(AU,AV,E);}return AU;},endTokenSuggestion:function AO(AT){var E=this._saveActiveToken;if(E){if(AT){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function q(Ae){var AT=Ae.startOffset,E=Ae.endOffset,Ah=R.findWidget(Ae.startContainer),Af=R.findWidget(Ae.endContainer),AY=this.itemIndex(Ah.data),AW=this.itemIndex(Af.data),Aa=[],Ab=H.getEdgeInfo(Ae.startContainer,AT),Ag=H.getEdgeInfo(Ae.endContainer,E),Ac=(Ab===m.EDGE_BEGIN?AY:AY+1),AV=(Ag===m.EDGE_END?AW:AW-1),AX;if(Ah===Af){if((Ab===m.EDGE_BEGIN)&&(Ag===m.EDGE_END)){if((R.isFF||M)&&window.getSelection()){var AZ=window.getSelection().getRangeAt(0),Ad=AZ.startOffset,AU=AZ.endOffset-Ad;AZ.deleteContents();this.items.splice(Ad,AU);H.collapseOnNode(this.editNode,false);}else{this.remove(AY);Af=this.ctxtBuilder.itemWidgets[AY===0?AY:AY-1];if(Af){H.collapseOnNode(Af.domNode,AY===0);}else{H.collapseOnNode(this.editNode,true);}}}else{Ah.spliceContent(AT,E-AT);H.collapseOnTextNode(Af.domNode,AT);}}else{for(AX=Ac;AX<=AV;AX++){Aa.push(AX);}this.remove(Aa);if(Ab===m.EDGE_MIDDLE){Ah.spliceContent(AT);}if(Ag===m.EDGE_MIDDLE){Af.spliceContent(0,E);}}if(Ab===m.EDGE_BEGIN){Ah=this.ctxtBuilder.itemWidgets[AY===0?AY:AY-1];}if(Ah){H.collapseOnNode(Ah.domNode,AY===0);}else{H.collapseOnNode(this.editNode,false);}AY=(Ab===m.EDGE_BEGIN)?AY-1:AY;this.checkMergeTwoTokens(AY,AY+1);this.editNode.focus();},oncandidatesChange:function w(){var AT=this.candidates,E=(AT&&AT.items)||[];if(!this.noCache&&AT&&AT.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AT=this.getSuggestionPos();if(AT){E.set("left",AT.left);E.set("top",AT.top);}},pretokensModify:function P(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:K.clone(this.items),rInfo:H.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function o(AU){var AV,E,AT=function(AX){if(!AX){return ;}AX=AX||{};this.set("items",K.clone(AX.items));var Aa=this.ctxtBuilder.itemWidgets,AW=Aa[AX.idx],AZ=AW&&AW.domNode||this.editNode,AY=AX.rInfo;this._delaySetTextCaretPos(AZ,AY&&AY.startOffset||0);};switch(AU){case"undo":AV=--this.tokensCachePointer;if(AV>-1){E=this.tokensCache[AV-1];AT.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AV=this.tokensCachePointer++;if(AV>-1&&AV<this.tokensCache.length){E=this.tokensCache[AV];AT.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function b(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;},toggleIMEStatusBar:function e(E){if((R.isIE9||R.isIE10||R.isIEW3C||R.isEdge)&&this.detectKoreanLocale()){if(E){if(!this.elStatus||!this.elStatus.offsetParent){var AT=this.elStatus=document.createElement("div");AT.innerText=mstrmojo.desc(15003,"Please enter space key to finish IME typing");AT.className="mstrmojo-TokenInputBox-status";this.domNode.appendChild(AT);}}else{this.domNode.removeChild(this.elStatus);delete this.elStatus;}}},detectKoreanLocale:function n(){var E=window.navigator;if(window.mstrConfig&&(window.mstrConfig.browserLang||[]).indexOf("ko")>=0){return true;}else{if(E.userLanguage=="ko"||E.userLanguage=="ko-KR"||E.browserLanguage=="ko"||E.browserLanguage=="ko-KR"){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.ToolbarConfig");mstrmojo.vi.ui.toolbars._HasToolbar=mstrmojo.provide("mstrmojo.vi.ui.toolbars._HasToolbar",{_mixinName:"mstrmojo.vi.ui.toolbars._HasToolbar",preBuildRendering:function A(){this.generateToolbar();return this._super();},generateToolbar:function B(){this.passToolbarCfg(this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));},updateToolbar:function D(E){if(this._super){E=this._super(E);}return E;},passToolbarCfg:function C(E){var F=this.toolbar.toolbarCfg;if(F){F.destroy();}this.toolbar.set("toolbarCfg",E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo._TouchGestures","mstrmojo.string","mstrmojo.vi.ui.toolbars.TitleToolbar");var J=mstrmojo.dom,N=mstrmojo.string;mstrmojo.vi.ui.TitleBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TitleBar",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" aria-label="{@en@ariaLabel}" mstrAttach:contextmenu,click,keydown><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',markupSlots:{leftToolNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},rightToolNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode;}},markupMethods:{onhasContextMenuButtonChange:function(){var Q=this.hasContextMenuButton;this.tbToolbar.set("visible",Q);this.tbToolbar.set("enabled",Q);},ontitleChange:function(){this.lblTitle.set("text",this.title||" ");},ontoolbarCfgChange:function(){var Q=this.toolbarCfg;if(!Q){return ;}this.tbToolbar.set("toolbarCfg",Q);this.doLayout();},onariaLabelChange:function(){this.domNode.setAttribute("aria-label",N.encodeHtmlString(this.ariaLabel,true));},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true},lblTitle:null,tbToolbar:null,hasContextMenuButton:true,editTitleOnClick:false,editTitleOnDoubleClick:true,editTitleOnTwoClicks:false,title:"",ariaLabel:"",close:mstrmojo.emptyFn,toolbarCfg:null,beganEditingTitlebar:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,useRichTooltip:true,init:function P(Q){this._super(Q);this.addChildren([].concat(this.getLeftToolbarChildren()).concat(this.getTitleChildren()).concat(this.getRightToolbarChildren()));},shouldShowTooltip:function K(Q,S){var R=Q.target||J.eventTarget(Q.hWin,Q.e);return R===this.textNode.firstChild&&(R.scrollWidth>R.clientWidth);},getTooltipContent:function L(Q){var S=Q.target||J.eventTarget(Q.hWin,Q.e),R=S.innerHTML;return R;},showTooltip:function M(Q,R){if(this.shouldShowTooltip(Q,R)){this._super(Q,R);}},updateTooltipConfig:function I(S){var Y=S.target||J.eventTarget(S.hWin,S.e),Q=J.position(Y);var U=this.getTooltipContent(S),X=Q.y+Q.h+3,W=Q.x+4,R="vi-regular vi-tooltip-A";if(Y.className==="right-toolbar customShapeWarn"){U=mstrmojo.desc(16684,"Add an attribute to enable data labels and enhance the performance of filtering");W=W+24;X=X-30;R="vi-warning vi-tooltip-C";}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:U,top:X,left:W,cssClass:R};},getLabelNode:function C(){return this.lblTitle.domNode;},getMenuConfig:function B(){var Q=this.toolbarCfg;if(Q){if(Q.hasMenuItems()){return Q;}}return null;},setToolbarVisibility:function D(Q){this.tbToolbar.set("visible",Q);},editTitle:function O(){this.lblTitle.set("isEditing",true);},onAppStateChange:function F(Q){var R=this.lblTitle,S=mstrApp.isAppStatePresentation(),U=!!(Q.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION);if(S&&this._confgTitleEditable===undefined){this._confgTitleEditable=this.editTitleOnClick||this.editTitleOnDoubleClick||this.editTitleOnTwoClicks;}R.set("isEditing",false);if(S||U){R.set("editOnDoubleClick",!S&&this._confgTitleEditable);}},getLeftToolbarChildren:function A(){},getTitleChildrenLayoutOffsets:function H(){return{h:2,w:2};},getTitleChildren:function G(){return[{scriptClass:"mstrmojo.EditableLabel",slot:"textNode",alias:"lblTitle",bindings:{editOnClick:"this.parent.editTitleOnClick",editOnDoubleClick:"this.parent.editTitleOnDoubleClick",selectable:"this.isEditing",editOnTwoClicks:"this.parent.editTitleOnTwoClicks"},onTextEditBegin:function(){this.parent.beganEditingTitlebar();},onTextEditComplete:function(S,R){this.parent.titleEdited(this.text,S,R);},getLayoutOffsets:function Q(){return this.parent.getTitleChildrenLayoutOffsets();}}];},getRightToolbarChildren:function E(){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"rightToolNode",alias:"tbToolbar",visible:true,useRichTooltip:true,bindings:{hasContextMenuButton:"this.parent.hasContextMenuButton",}}];}});if(J.isTouchOptimizationEnabled()){mstrmojo.mixin(mstrmojo._TouchGestures,mstrmojo.vi.ui.TitleBar.prototype);mstrmojo.mixin(mstrmojo.mobile.vi.ui.rw._IsInPanelStack,mstrmojo.vi.ui.TitleBar.prototype);mstrmojo.mixin(mstrmojo.mobile.vi.ui._TitleBarSupportsTouches,mstrmojo.vi.ui.TitleBar.prototype);}}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.string","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var S=mstrmojo.array,X=mstrmojo.css,O=mstrmojo.hash,P=mstrmojo.func,D=mstrmojo.string,N=mstrmojo.Button.newWebButton,Q=mstrmojo.dom,W="mstrmojo-link-validation",R="mstrmojo-link-vt",G=function G(Y){if(Y.old){this.removedLinks.push(Y);}this.links.removeChildren(Y);},U=function U(){var y=this.dsMap,t=this.docModel,c=t.datasets,AA=function AA(i,k,a){var j={n:a||"",did:k||null,parent:i||null,lv:(i?i.lv+1:-1),children:[]};if(i){i.children.push(j);}return j;},h=AA(),b,Z,Y,m,d,u,o,z,w,s,q,p,f,e,g,n,l;O.forEach(c,function(a){if(t.isMDXDataset(a)){d=a.tables;for(s=0,e=d.length;s<e;s++){u=d[s];b=AA(h,u.did,u.n);b.isMDX=true;for(q=0,g=u.dimensions.length;q<g;q++){o=u.dimensions[q];Z=AA(b,o.did,o.n);for(p=0,n=o.hierarchies.length;p<n;p++){z=o.hierarchies[p];Y=AA(Z,z.did,z.n);for(f=0,l=z.att.length;f<l;f++){w=z.att[f];m=AA(Y,w.did,w.n);m.att=w;y[u.did+":"+w.did]=m;}}}}}else{b=AA(h,a.did,a.name);b.isMDX=false;S.forEach(a.att,function(i){m=AA(b,i.did,i.n);m.att=i;y[a.did+":"+i.did]=m;});}});return h;},B=function B(e,f){e=S.ensureArray(e);var d=this,c=this.attribute.did,g=this.docModel,a=this.datasetId,Z="\u001F",Y={success:function(i){var k=i.als,h=(g.als&&g.als.links)||{},j=d.dsTree;S.forEach(e,function(t,n){var u={},l={},m=[],o={},s=c+" "+t,p=S.filter(k[n].ats,function(w){return !g.isInDataset(a,w.at,["att"]);}),q=function q(w,x){if(!o[w]){o[w]={};}if(!o[w][x]){o[w][x]=true;}};S.forEach(p,function(y){var w=y.at,x=y.fms;u[w]=true;if(x){S.forEach(x,function(z){q(w,z.fm);});}});O.keyarray(h).forEach(function(w){if(w===s){S.forEach(h[w],function(x){x=x.split(" ");u[x[0]]=true;q(x[0],x[1]);});}});if(O.keyarray(u).length>0){S.forEach(j.children,function(x){var w=function(y){var z;if(!y.att){return ;}y=y.att;if(u[y.did]){if(!l[y.n]){l[y.n]={};}if(!l[y.n][y.did]){l[y.n][y.did]=[];}l[y.n][y.did].push(x.n);z=O.copy(y,z);z.dsId=x.did;m.push(z);}};if(x.isMDX){S.forEach(x.children,function(y){S.forEach(y.children,function(z){S.forEach(z.children,w);});});}else{S.forEach(x.children,w);}});}d.tgtAttrs[t]=m;d.tgtForms[t]=o;d.namesHash[t]=l;});}},b={taskId:"validateDocumentLinks",msgID:g.mid,action:1,attributeList:c,attributeFormList:e.join(Z)};mstrApp.serverRequest(b,P.wrapMethods(Y,f));},F=function(b,d,Z,c){b.richTooltip=null;if(!b.isSearching){var a=d&&d.scrollWidth>d.clientWidth;Z=a?mstrmojo.desc(14648,"## from ###").replace("##",Z):"";if(c){if(!a){Z=mstrmojo.desc(14640,"From ###");}Z=Z.replace("###",c);}var Y=mstrmojo.dom.position(d);b.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:Z,top:Y.y-6,left:Y.x};}},E=function E(f){var g=this,i=function(p){var n=p.fs,q=p.de,o=[];(n||[]).forEach(function(s){if(s.obf&&(!q||s.idf)){o.push({n:s.fnm,v:s.fid,idf:s.idf});}});return o;},j=i(this.attribute),c=function(q,o){var n=i(q);var s=(g.tgtForms[o]&&g.tgtForms[o][q.did])||{};var p=[];S.forEach(n,function(t){if(s[t.v]){p.push(t);}});return p;},e=function e(o){var n=[];S.forEach(g.tgtAttrs[o],function(p){if(c(p,o||g.idFormId).length>0){var s=g.namesHash[o],q=p.n;if(s[p.n]&&O.keyarray(s[p.n]).length>1){q=q+" ("+s[p.n][p.did].join(",")+")";}n.push({n:p.n,v:p,tt:q});}});if(n.length===0){n.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return n;},k=e((f&&f.srcFormId)||this.idFormId),l=function(n,o){return S.find(n,o?"v":"idf",o||true);},m=function(o){var n=-1;k.forEach(function(q,p){if(q.v.did===o){n=p;}});return n;},Z=function(o){var n=k[o];if(!n){return mstrmojo.desc(13397,"Select an attribute");}else{return n.n;}},a=function(o){var p=o.items,n=o.selectedIndex;if(n>=0){if(p[n].idf){return ;}}p.forEach(function(s,q){if(s.idf){o.set("selectedIndex",q);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!f,oldMeta:f,getMeta:function(){var n=this.linkFromForm,p=this.linkToAtt,o=this.linkToForm;return{srcAttrId:g.attribute.did,srcFormId:n.items[n.selectedIndex].v,tgtAttrId:p.items[p.selectedIndex]&&p.items[p.selectedIndex].v.did,tgtFormId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:g.attribute.n,useRichTooltip:true,updateTooltipConfig:function(s){var q=s.target,n=D.encodeHtmlString(this.text),o=g.datasetId,p=o?D.encodeHtmlString(g.docModel.datasets[o].name):"";F(this,q,n,p);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:j,selectedIndex:l(j,f&&f.srcFormId),onitemSelected:function(o){var n=this,p=function(){var s=n.parent.linkToAtt;k=e(o.v);s.set("items",k);s.set("selectedIndex",-1);s.set("text",mstrmojo.desc(13397,"Select an attribute"));X.addClass(s.selectedNode,"nvo");},q={success:p};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!o.idf){a(this.parent.linkToForm);if(!g.tgtForms[o.v]){B.call(g,o.v,q);return ;}}p();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:k,text:Z(m(f&&f.tgtAttrId)),selectedIndex:m(f&&f.tgtAttrId),allowCustomText:true,allowEmptyText:true,allowHTML:false,updateTooltipConfig:function(t){var s=t.target,n=s.getAttribute("tt"),p=this.getSelectedItem(),o=p?p.v.dsId:null,q=o?D.encodeHtmlString(g.docModel.datasets[o].name):"";if(this.selectedNode===s&&p){n=p.tt;}F(this,s,D.encodeHtmlString(n),q);},onitemSelected:function(s){if(!s||s.v.did===null){return ;}var q=this.parent.linkToForm,p=this.parent.linkFromForm,o=c(s.v,p.items[p.selectedIndex].v),t=function t(u,x){var w=S.find(u,x?"v":"idf",x||true);if(w===-1&&u.length>0){w=0;}return w;},n;S.forEach(o,function(u){if(u.idf){n=false;return false;}});if(n){L.call(g,true);}q.set("items",o);q.set("selectedIndex",t(o,!this.hasRendered&&f&&f.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}K.call(g);},onPopupWidgetOpened:function d(){if(this.selectedIndex===-1){this.set("text","");}X.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function h(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));X.addClass(this.selectedNode,"nvo");}else{X.removeClass(this.selectedNode,"nvo");}this.hideTooltip();S.forEach(g.collapseTargets,function(n){n.className="arrow-b";X.removeClass(n.parentNode.parentNode,"collapse");});S.forEach(g.collapseTreeNodes,function(n){delete n.collapse;});S.forEach((this.list.itemsContainerNode||{}).childNodes,function(o){o.style.display="";});},postBuildRendering:function Y(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){X.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function b(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,allowHTML:false,locksHover:true,listHooks:{select:function n(u,w,t){this.parent.set("selectedIndex",t);this.close();}},onclick:function o(AC){try{var u=AC.getTarget(),AD=this.getItemFromTarget(u),z=Q.findAncestorByAttr(u,"idx",true,this.domNode),y=this.items;if(y){this.parent.set("items",y);}if(AD){AC.cancel();if(u.className==="arrow-b"||u.className==="arrow-r"){var t=this.itemsContainerNode.childNodes,x=function x(AF){var AE;while(AF){AE=AF.className||"";if(AE.indexOf("lv")===0){return window.parseInt(AE.substring(2),10);}AF=AF.firstChild;}return null;},AB=function AB(AE,AH){var AG=g.dsMap,AF=AG[AE.dsId+":"+AE.did];while(AF){if(AF.lv===AH){return AF;}AF=AF.parent;}return null;},AA=function AA(){var AN=(u.className==="arrow-b"),AH=u.parentNode.parentNode,AE=x(AH),AI=AD._renderIdx,AF=AB(AD.v,AE),AL=y.length,AK,AG,AJ,AM,AP,AO;u.className=AN?"arrow-r":"arrow-b";if(!g.collapseTargets){g.collapseTargets=[];}g.collapseTargets.push(u);X.toggleClass(AH,"collapse",AN);AF.collapse=AN;if(!g.collapseTreeNodes){g.collapseTreeNodes=[];}g.collapseTreeNodes.push(AF);for(AK=AI+1;AK<AL;AK++){AG=t[AK];AJ=x(AG);if(AJ<=AE){break;}AM=AB(y[AK].v,AJ);AP=AM.parent;AO=true;while(AP){if(AP.collapse){AO=false;break;}AP=AP.parent;}AG.style.display=(AO?"":"none");}};AA();}else{if(z&&z.node.className.indexOf("item")!==-1){this.doItemSelect(AD,AC||{});}}}}catch(w){mstrApp.onerror(w);}},getItemProps:function p(w,t){var u=mstrmojo._IsList.getItemProps.call(this,w,t);var x=w.cls;if(x){u.addCls(x);}return u;},getItemMarkup:function s(AF,AE){if(AF.v.did===null){return'<{@tag} class="item {@cls}" did="'+AF.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AG=[],AC=AF.v.did,x=AF.v.dsId,y=x?g.docModel.datasets[x]:null,w=y?D.encodeHtmlString(y.name):"",AD=AE>0&&this.items[AE-1].v,AA=g.dsMap,z=AA[AF.v.dsId+":"+AC],u=AA[(AD&&(AD.dsId+":"+AD.did))];AG.push("</div>");while(z){if(z.lv===-1){break;}if(z.att){var AB=z.att.da?"derived-attr":"attr";AG.push('<div class="lv'+z.lv+' dim item {@cls}" tt="'+AF.tt+'" did="'+AC+'" dsName="'+w+'" idx="{@idx}" style="{@style}"><div><div class="'+AB+'"></div></div>{@en@n}</div>');}else{if(z!==u){var t=D.encodeHtmlString(z.n);AG.push('<div class="lv'+z.lv+' dim" dtt="'+t+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+t+"</div>");}else{break;}}z=z.parent;u=(u&&u.parent)||null;}AG.push("<div>");return AG.reverse().join("");},updateTooltipConfig:function q(z){var y=z.target,w=y.getAttribute("tt"),u=y.getAttribute("dtt"),x=y.getAttribute("dsName"),t=w||u;if(t){F(this,y,D.encodeHtmlString(t),x);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(n){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){a(this.parent.linkFromForm);}}}},N("",function(){G.call(g,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},L=function(Y){X.toggleClass(this.editorNode,"mstrmojo-advanced",Y);},M=function(b){var Z=this,c=W,Y;try{mstrmojo.all[c].destroy();}catch(a){}Y={scriptClass:"mstrmojo.Editor",id:c,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[N(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[c].destroy();I.call(Z);},true)],children:[{scriptClass:"mstrmojo.Label",text:b}],visible:true,zIndex:1000};mstrmojo.insert(Y).render();},I=function(){var a=this,Z=this.illLinks,Y=this.links.children,b=R;S.forEach(Z,function(c){c=c.al;S.forEach(Y||[],function(e){var g=e.getMeta(),h=e.linkToAtt,d,f;if(g.srcAttrId===c.alaid1&&g.tgtAttrId===c.alaid2){if(!mstrmojo.all[b]){f=new mstrmojo.Tooltip({id:b,cssClass:a.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});Q.attachEvent(a.editorNode,"click",function(){f.close();X.toggleClass(h.selectedNode,"mstrmojo-Warning",false);});}else{f=mstrmojo.all[b];}f.close();d=mstrmojo.dom.position(h.selectedNode);f.set("top",d.y-6);f.set("left",d.x);f.set("content",c.alstmsg);X.toggleClass(h.selectedNode,"mstrmojo-Warning",true);f.open();return false;}});});},A=function(){var Y=mstrmojo.all[R];if(Y){Y.close();}},K=function K(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},H=function H(){var Y=this,Z=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){E.call(Y);A.call(Y);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){L.call(Y,true);A.call(Y);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){L.call(Y,false);A.call(Y);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(Z);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var b=this,Z=this.docModel,a=function(){var c=(Z.als&&Z.als.links)||{},d=[];O.keyarray(c).forEach(function(e){if(e.indexOf(b.attribute.did+" ")===0){c[e].forEach(function(f){d.push({srcAttrId:e.split(" ")[0],srcFormId:e.split(" ")[1],tgtAttrId:f.split(" ")[0],tgtFormId:f.split(" ")[1]});});}});return d;},Y;this.set("buttons",[N(mstrmojo.desc(1442,"OK"),function(){var j=[],d=b.links.children,c=function(){var k=Z.controller,l=Z.controller.getRefreshCallback();if(j.length>0){k.cmdMgr.execute({execute:function(){this.submit(j,l,{style:{params:{treesToRender:3}}});},urInfo:{callback:l}});}b.close();},i=false,f,g;b.removedLinks.forEach(function(k){f=O.copy(k.oldMeta,{act:"applyAttributeLinking",unlink:true});j.push(f);});(d||[]).forEach(function(k){if(k.old&&k.oldUpdated){f=O.copy(k.oldMeta,{act:"applyAttributeLinking",unlink:true});j.push(f);}if(!k.old||(k.old&&k.oldUpdated)){g=k.getMeta();if(!g.tgtAttrId){return ;}f=O.copy(g,{act:"applyAttributeLinking",unlink:false});j.push(f);}});S.forEach(j,function(k){if(!k.unlink){i=true;return false;}});if(!i){c();return ;}var h={taskId:"validateDocumentLinks",msgID:Z.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(j)+"}"},e={success:function(k){if(k.als&&k.als.length>0){var l="";S.forEach(k.als,function(m){l+=m.al.alstmsg+"\n";});b.illLinks=k.als;M.call(b,l);return ;}c();}};mstrApp.serverRequest(h,e);},true,{enabled:false}),N(mstrmojo.desc(221,"Cancel"),function(){b.close();})]);H.call(this);Y=a(this.attribute.did);if(Y.length>0){Y.forEach(function(c){E.call(b,c);});K.call(this);}else{E.call(this);}this._super();},close:function J(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(e){var Z=mstrmojo.insert(O.copy(e,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),c=Z.attribute,f=c.did,Y=Z.docModel,b=(Y.als&&Y.als.links)||{},a=[],d={success:function(){Z.set("visible",true);Z.render();}};S.forEach(c.fs,function(g){if(g.idf){Z.idFormId=g.fid;return false;}});O.keyarray(b).forEach(function(h){var g=h.split(" ");if(g[0]===f){a.push(g[1]);}});if(S.indexOf(a,Z.idFormId)===-1){a.push(Z.idFormId);}Z.dsMap={};Z.dsTree=U.call(Z);B.call(Z,a,d);};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.vi.ui.InlineDialogBase");mstrmojo.requiresDescs(16166,11955,11956);var A=mstrmojo.css,G=mstrmojo.hash,D=mstrmojo.string,H="\u001E";mstrmojo.vi.ui.FilterBoxInlineDialog=mstrmojo.declare(mstrmojo.vi.ui.InlineDialogBase,null,{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",tocEnabled:false,selectFilters:true,init:function F(I){this._super(I);A.addWidgetCssClass(this,"filter-box-dialog");},_setTargetsFunc:function E(){this.vis.setTargets(this.changes.filterKeys);},toggleFields:function B(){if(this.cgbs.length!==0){this.forType.set("visible",true);}},_addChildren:function C(){var P=this,K=P.vis,Q=(K.isAMSelector instanceof Function)&&K.isAMSelector(),J=(K.isPanelSelector instanceof Function)&&K.isPanelSelector(),L=Q?mstrmojo.desc(17614,"Use <span>#</span> to replace objects in"):(J?mstrmojo.desc(19743,"Use <span>#</span> to select panels in"):mstrmojo.desc(16166,"Use <span>#</span> to filter data in")),M=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",cssDisplay:"inline",allowHTML:true,text:L.replace("#",D.encodeHtmlString(K.title)),visible:true},P._createTruncatedList(),{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"inline-block",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(P.cgbs[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(S){P.changes.forAllData=S.v;},onenabledChange:function(){A.toggleClass(this.domNode,"disabled",!this.enabled);}}],I=K.parent.children||[],O,N={};for(O=I.length-1;O>=0;O--){P._addVis(I[O],N);}if(Q||J){var R=K.defn.tks.split(H);G.forEach(N,function(U,S){if(R.indexOf(S)>-1){U.v=true;}});}this.addChildren(M);this.targetKeys=N;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.array","mstrmojo.css","mstrmojo.func","mstrmojo.vi.util.A11yUtility");mstrmojo.requiresDescs(950,954,1035);var l=function(){return mstrmojo.locales.datetime;},AI=mstrmojo.dom,AH=mstrmojo.expr,AM=AH.DTP,AA=mstrmojo.date,L=mstrmojo.publisher,AF=mstrmojo.hash,AN=mstrmojo.array,Z=AN.removeIndices,AK=mstrmojo.css,AT=mstrmojo.vi.util.A11yUtility;var w=0,R=3,u=4,AW=5,S=6;var I=1,d=2;var a="month",A="day",AD="year",G="hour",B="minute",p="second";var Q='<table border="0" cellpadding="0" cellspacing="0">',E="</table>";var k=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];function c(AZ){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AZ+'">';}var y=mstrmojo.desc(13844,"Dynamic Date");function m(Aa,AZ){return Aa+", "+(AZ?mstrmojo.desc(514,"Selected"):mstrmojo.desc(19895,"Unselected"));}function F(Ac,AZ,Aa){var Ab=AA.getFirstDateOfMonth(Ac,AZ);return(Ab.getDay()-Aa+8)%7;}function M(Ac){var Ab=AA.parseDateAndOrTime(Ac),Ad,AZ,Aa;if(Ab){Aa={};Ad=Ab.date;AZ=Ab.time;if(Ad){AF.copy(Ad,Aa);}if(AZ){AF.copy(AZ,Aa);}}return Aa;}function AB(Aa,Ad,Ac,Ab,AZ){var Ae=AA.formatDateInfo({day:Aa,month:Ad,year:Ac},l().DATEOUTPUTFORMAT);return AA.inDateTimeRange(Ae,Ab,AZ)===0;}function U(Ad,Ac,Ab){var Aa=Ad.decreaseButton,AZ=Ad.increaseButton,Ae="mstrmojo-Calendar";Aa.className=(Ae+"-decrease");AZ.className=(Ae+"-increase");}function AE(Ad,Aa,Af,Ac){var Ab=0,AZ=Ad.length,Ae;for(Ab=0;Ab<AZ;Ab++){Ae=Ad[Ab];if(Ae&&Ae.day===Aa&&Ae.month===Af&&Ae.year===Ac){return Ab;}}return -1;}function AJ(AZ,Ab,Aa){var Ac=new Date();return(Ac.getFullYear()===Aa)&&((Ac.getMonth()+1)===Ab)&&(Ac.getDate()===AZ);}function AX(Ag,Ah){var Al=Ag.dayView.getElementsByTagName("div"),Aj=Ag.selectedDates,Ab=Aj[Ah],Ak=Ag.browseYear,Aa=Ag.browseMonth,Ad=AA.getDaysOfMonth(Ak,Aa),Ac=AA.getPreMonth(Ak,Aa),Af=AA.getDaysOfMonth(Ac.y,Ac.m),AZ=F(Ak,Aa,Ag.firstDayOfWeek),Ae=((Ab.month===Aa)?Ab.day+AZ-1:(Ab.month>Aa?Ab.day+AZ+Ad-1:AZ-Af+Ab.day-1)),Ai=Al[Ae];if(Ai){AP(Ai,Ag,false);}Z(Aj,Ah,1);}function AV(AZ){var Aa=AZ.selectedDates;while(Aa.length){AX(AZ,0);}}function AO(Ab,AZ){var Aa=o(Ab,AZ),Ac=Ab.selectedDates;Ac.push({day:Aa.d,month:Aa.m,year:Aa.y});AP(AZ,Ab,true);}function n(Ab,Ac){if(!Ac||!Ac.length){return null;}var Ae=Ab.selectedDates;for(var Aa=0,AZ=Ac.length;Aa<AZ;Aa++){var Ad=Ac[Aa],Af=AR(Ab,Ad);Ae.push({day:Ad.d,month:Ad.m,year:Ad.y});if(Af){AP(Af,Ab,true);}}}function AR(Ah,Aj){var Al=Ah.dayView.getElementsByTagName("div"),Ac=Al.length,Ak=Ah.browseYear,Aa=Ah.browseMonth,Ad=AA.getPreMonth(Ak,Aa),Ae=AA.getDaysOfMonth(Ad.y,Ad.m),Ap=AA.getNextMonth(Ak,Aa),Ab=AA.getDaysOfMonth(Ak,Aa),AZ=F(Ak,Aa,Ah.firstDayOfWeek);var Af=AZ>0?{y:Ad.y,m:Ad.m,d:Al[0].innerHTML}:{y:Ak,m:Aa,d:Al[0].innerHTML},An=(Al.length-Ab-AZ)>0?{y:Ap.y,m:Ap.m,d:Al[Ac-1].innerHTML}:{y:Ak,m:Aa,d:Al[Ac-1].innerHTML},Ao=x(Af,Aj),Ag=x(Aj,An),Ai=null;if(Ao>=0&&Ag>=0){var Am=0;if(Ao<AZ){Am=-1;}if(Ag<(Al.length-AZ-Ab)){Am=1;}Ai=((Am===0)?Aj.d+AZ-1:(Am===1?Aj.d+AZ+Ab-1:AZ-Ae+Aj.d-1));return Al[Ai];}else{return null;}}function W(Ah,AZ){var Aj=Ah.selectedDates,Ab=Aj.length;if(!Ab){return null;}var Aa=Aj[Ab-1],Ac=o(Ah,AZ),Am=x({y:Aa.year,m:Aa.month,d:Aa.day},Ac),An=[],Ae=Am>0,Ak=Math.abs(Am);for(var Ag=0;Ag<=Ak;Ag++){var Af=new Date(Ac.y,Ac.m-1,Ac.d);Af.setDate(Af.getDate()+(Ae?-Ag:Ag));var Al=Af.getFullYear(),Ad=Af.getMonth()+1,Ai=Af.getDate();if(Ah.isDateDisabled(Ai,Ad,Al,Ah.min,Ah.max)&&!Ah.canSelectDisabledDate){continue;}An.push({y:Al,m:Ad,d:Ai});}return An;}function x(Ac,Ab){var AZ=new Date(Ac.y,Ac.m-1,Ac.d),Aa=new Date(Ab.y,Ab.m-1,Ab.d);return(Aa-AZ)/1000/3600/24;}function o(Ab,AZ){var Ac=Ab.browseYear,Ae=Ab.browseMonth,Ad=parseInt(AZ.innerHTML,10),Af=parseInt(AZ.getAttribute("m"),10),Aa=null;Aa=(Af===0)?{y:Ac,m:Ae}:(Af===1?AA.getNextMonth(Ac,Ae):AA.getPreMonth(Ac,Ae));Aa.d=Ad;return Aa;}function K(AZ){var Ab=AZ.selectedDates,Aa=Ab.length;return(Aa===0)?null:Ab[Aa-1];}function AP(Aa,Ab,AZ){var Ac=Ab.selectedColor;AK.toggleClass(Aa,["selected",Ab.selectedCssStyle],AZ);Aa.parentNode.style.backgroundColor=AZ?Ac:"";Aa.style.backgroundColor=AZ?Ac:"";}function f(AZ){return AZ.selectedColor?('style="background-color:'+AZ.selectedColor+';"'):"";}function N(AZ){return(AZ.tagName.toLowerCase()==="td")?AZ.firstChild:AZ;}function h(Aa,Ab){var Ac=AA.getDateJson(Aa),AZ=AA.formatDateInfo(Ac,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(Ab===AM.TIMESTAMP){AZ+=" "+AA.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AZ;}function C(Ae,Ab){var AZ=this.advancedValues,Aa=null;AZ.set(Ae,Ab);switch(AZ.baseDate){case R:Aa=new Date();break;case u:break;case AW:break;case S:break;default:return ;}var Ac=AZ.monthsToAdjust;if(Ac>0){Aa.setMonth(Aa.getMonth()+(AZ.toAddMonths?Ac:-Ac));}var Ad=AZ.daysToAdjust;if(Ad>0){Aa.setDate(Aa.getDate()+(AZ.toAddDays?Ad:-Ad));}this.set("value",h.call(this,Aa,this.dtp));}function X(){var AZ=this.advancedValues,Aa=["isDyn"];if(AZ.baseDate===w){return null;}Aa.push(AZ.baseDate);Aa.push(AZ.toAddDays?AZ.daysToAdjust:-AZ.daysToAdjust);Aa.push(AZ.toAddMonths?AZ.monthsToAdjust:-AZ.monthsToAdjust);Aa.push(0);Aa.push(0);Aa.push(0);Aa.push(0);Aa.push(this.value);Aa.push(this.timeVal.hour);Aa.push(this.timeVal.min);Aa.push(this.timeVal.sec);return Aa.join("::");}function AG(AZ){if(AZ.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function O(Ac,Ab){var Ad=this,Aa=function(Af){return Af[0].toUpperCase()+Af.substring(1);},Ae=Ac==="days",AZ=Ae?mstrmojo.desc(19909,"One Day"):mstrmojo.desc(19911,"One Month");return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:Ac+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",focusOnPopup:true,enableAccessibility:true,selectedIndex:Ab>0?0:1,onitemSelected:function(Ag,Af){C.call(Ad,"toAdd"+Aa(Ac),Af===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,nextAriaLabel:mstrmojo.desc(19910,"Plus ##").replace("##",AZ),prevAriaLabel:mstrmojo.desc(19908,"Minus ##").replace("##",AZ),provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(Ab)},onTraverse:function(){C.call(Ad,Ac+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:Ae?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function AU(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}function J(Ae){var Ai=AF.walk("children.0",Ae),Ac=AF.walk("children.1",Ae),Ab,Ad,AZ;if(Ai){var Aa=Ai.selectedIndex===0,Ag=Ae.alias==="daysAdjustBox",Ah=Ag?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months"),Aj=Aa?mstrmojo.desc(19910,"Plus ##"):mstrmojo.desc(19908,"Minus ##"),Af=Aj.replace("##",Ah);Af+=(", "+mstrmojo.desc(19894,"Calendar Filter Option"));Ai.selectedNode.ariaLabel=Af;}if(Ac){Ab=AF.walk("textInput",Ac);Ad=Ac.nextNode;AZ=Ac.prevNode;}if(Ai&&Ab&&Ad&&AZ){return[Ai,Ab,Ad,AZ];}return[];}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui.rw._SupportTabNav],{scriptClass:"mstrmojo.Calendar",enableAccessibility:false,cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:A,duration:600,timeDelimiter:":",dtp:AM.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AZ){return l().MONTHNAME_SHORT[AZ];},dayNames:function(AZ){return l().dayShortNames[AZ];},min:null,max:null,dayList:[],monthList:[],yearList:[],hourList:[],minuteList:[],secondList:[],supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" tabindex="-1" mstrAttach:mousedown,mouseup,mouseover,mouseout,keydown><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease" role="button" aria-label="'+mstrmojo.desc(19893,"Previous Month")+'"></div><div class="mstrmojo-Calendar-increase" role="button" aria-label="'+mstrmojo.desc(19896,"Next Month")+'"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}" role="button">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}" role="button">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel" role="button">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel" role="button">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel" role="button">00</span><span class="mstrmojo-Calendar-AMPMLabel" role="button">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){var AZ=this.monthNames(this.browseMonth-1);this.monthLabel.innerHTML=AZ;this.monthLabel.ariaLabel=AZ+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(871,"Month"));},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;this.yearLabel.ariaLabel=this.browseYear+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(873,"Year"));},ondtpChange:function(){this.timePart.style.display=(this.dtp===AM.TIMESTAMP||this.dtp===AM.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:AU,onisAdvancedChange:AU},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},titlePart:function(){return this.domNode.firstChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function t(AZ){if(this._super){this._super(AZ);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};var Aa=mstrmojo.locales.location.LOCALE_TO_LANG;switch(Aa[mstrApp.localeId]){case mstrmojo.desc(950,"English (US)"):case mstrmojo.desc(954,"Japanese"):case mstrmojo.desc(1035,"Portugese (Brasil)"):this.firstDayOfWeek=I;break;default:this.firstDayOfWeek=d;}},ondynDateValueChange:function b(AZ){if(AZ.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AG,onmaxChange:AG,buildChildren:function AC(){var Af=this;if(this.showAdvanced){var Ac=this.dynDateValue,Ab=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),Ai=Ac&&Ac.split("::")||[],Ae=Ai[1]||w,Aa=Ai[2]||0,Aj=Ai[3]||0,Ag=function Ag(){if(Af.isAdvanced){Af.wasAdvanced=true;Af.changeValueOnOK=true;}Af.set("isAdvanced",!Af.isAdvanced);mstrmojo.css.toggleClass(Af.markupSlots.dayView.call(Af),["ddSelected"],Af.isAdvanced);C.call(Af,"baseDate",Af.isAdvanced?3:0);if(Af.parent&&Af.parent.nudge&&Af.isAdvanced){Af.parent.nudge();}if(Af.enableAccessibility){Af.buildNavList();if(this.actionByKeyboard){Af.restoreFocus();this.actionByKeyboard=false;}else{this.domNode.loseFocus(true);}}};this.advancedValues=Ab;Ab.baseDate=parseInt(Ae);Ab.toAddDays=Aa>=0;Ab.daysToAdjust=Math.abs(Aa);Ab.toAddMonths=Aj>=0;Ab.monthsToAdjust=Math.abs(Aj);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AZ=M(this.value),Ad=this.timeVal;if(AZ&&AZ.hour!==undefined){Ad.hour=AZ.hour;Ad.min=AZ.min;Ad.sec=AZ.sec;}}C.call(Af,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",cssClass:"dynamicCheckbox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",ariaLabel:y,checked:!!Af.isAdvanced,oncheckedChange:Ag},{scriptClass:"mstrmojo.Label",text:y,onclick:function Ah(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},O.call(this,"days",Aa),O.call(this,"months",Aj)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(Ak){Af.parent.close();Af.hostRestoreFocus(Ak);},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(Ak){if(Af.changeValueOnOK||Af.isAdvanced||Af.wasAdvanced){Af.updateValue(true);}Af.hostRestoreFocus(Ak);},true,{slot:"buttonsNode"})]);},preBuildRendering:function P(){this.buildChildren();return this._super();},getSelectedDatesAsString:function AY(Aa){var AZ=[];AN.forEach(this.selectedDates,function(Ab){AZ.push(AA.formatDateInfo(Ab,Aa||l().DATEOUTPUTFORMAT));});return AZ;},hostRestoreFocus:function AS(AZ){if(AT.isKeyBoardEvent(AZ.e)&&AF.walk("tabParent.grabFocus",this)){this.tabParent.grabFocus(true);}},updateSelectedDate:function j(Ae){var AZ=this.value,Ab=this.timeVal,Ad=this.selectedDates,Ac,Af=function(Ah,Ag){Ah.set("browseYear",Ag.year);Ah.set("browseMonth",Ag.month);Ah.updateTimePart();Ah.updateView(Ah.currentView);if(!Ah.changeValueOnOK&&Ah.hasRendered&&Ah.closeOnValueChange!=true){Ah.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AZ){Ac=M(AZ);if(Ac&&Ac.hour!==undefined){Ab.hour=Ac.hour;Ab.min=Ac.min;Ab.sec=Ac.sec;if(this.dtp===AM.TIME&&(Ac.year===undefined||Ac.month===undefined||Ac.day===undefined)){var Aa=AA.getDateJson(new Date());Ac.year=Aa.year;Ac.month=Aa.month;Ac.day=Aa.day;}}}if((Ac&&!this.isMultiSelect)||Ae){AV(this);}if(Ad.length===0){if(!Ac){if(this.parent.opener&&this.parent.opener.defaultDate){Ac=M(this.parent.opener.defaultDate);}else{Ac=AA.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(Ac.day,Ac.month,Ac.year,this.min,this.max)){if(this.min&&AA.compareDate(Ac,this.min)<0){Ac=M(this.min);}else{if(this.max&&AA.compareDate(Ac,this.max)>0){Ac=M(this.max);}}}Ad.push(Ac);Af(this,Ac);}else{Ac=Ad[0];if(this.value!==null){Af(this,Ac);}}},updateValue:function D(AZ){var Ab=K(this),Aa="";if(Ab){Aa=AA.formatDateInfo(Ab,l().DATEOUTPUTFORMAT);if(this.dtp!==AM.DATE){var Ac=AA.formatTimeInfo(this.timeVal,l().TIMEOUTPUTFORMAT);if(this.dtp===AM.TIME){Aa=Ac;}else{Aa+=" "+Ac;}}}this.lastValue=Aa;this.set("value",Aa);if(this.showAdvanced){this.set("dynDateValue",AZ?X.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function AQ(){var Ac=this.timeVal,Ab=Ac.hour||0,Ae=(Ab%12===0)?12:(Ab%12),Ad=AA.formatInteger(Ac.min||0,2),Aa=AA.formatInteger(Ac.sec||0,2),AZ=Ab<12?" "+l().AM_NAME:" "+l().PM_NAME;this.hourLabel.innerHTML=Ae;this.hourLabel.ariaLabel=Ae+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(10042,"Hour"));this.minuteLabel.innerHTML=Ad;this.minuteLabel.ariaLabel=Ad+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(10043,"Minute"));this.secondLabel.innerHTML=Aa;this.secondLabel.ariaLabel=Aa+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(10044,"Second"));this.AMPMLabel.innerHTML=AZ;this.AMPMLabel.ariaLabel=AZ+", "+mstrmojo.desc(19899,"## Selector").replace("##",mstrmojo.desc(19897,"AM/PM"));},premousedown:function(AZ){var Ab=AZ.e,Aa=AI.eventTarget(AZ.hWin,Ab);if(Aa===this.decreaseButton||Aa===this.increaseButton){if(AI.isFF){AI.stopPropogation(window,Ab);}return true;}else{return this.processEvent(Aa,Ab);}},premouseup:function(AZ){var Ab=AZ.e;if(Ab.ctrlKey||Ab.shiftKey){AI.clearBrowserHighlights();}var Aa=AI.eventTarget(AZ.hWin,Ab);if(Aa===this.decreaseButton&&!Aa.disabled){this.decrease();return true;}if(Aa===this.increaseButton&&!Aa.disabled){this.increase();return true;}},onkeydown:function g(Ag){if(!this.enableAccessibility){return ;}var AZ=Ag.e,Af=AZ&&AZ.key,Ac=this.currentView,Ai=AI.eventTarget(Ag.hWin,AZ);if(this.handleTab(Ag)){return ;}AZ.stopPropagation();if(Af==="Enter"){if(Ai===this.decreaseButton||Ai===this.increaseButton){if(Ai===this.decreaseButton&&!Ai.disabled){this.actionByKeyboard=true;this.shouldRestoreFocus=true;this.decrease();}if(Ai===this.increaseButton&&!Ai.disabled){this.actionByKeyboard=true;this.shouldRestoreFocus=true;this.increase();}}else{if(AI.contains(this.advancedPanel.domNode,Ai)){if(Ai.classList.contains("next")||Ai.classList.contains("prev")){Ai.click();}}else{if(AI.contains(this.bodyContainer,Ai)){this.actionByKeyboard=true;if(Ac!==A){if(Ai.loseFocus){Ai.loseFocus(true);}this.shouldRestoreFocus=true;}else{if(Ai.getAttribute("m")!=="0"&&!Ai.classList.contains("disabled")){this.selectedDayRestoreFocus=true;}}}if(AI.contains(this.titlePart,Ai)||AI.contains(this.timePart,Ai)){if(Ai.loseFocus){Ai.loseFocus(true);}if((Ai===this[Ac+"Label"]||(Ai===this.AMPMLabel&&Ac===G))&&AF.walk(Ac+"List.0.grabFocus",this)){this[Ac+"List"][0].grabFocus(true);}else{this.actionByKeyboard=true;}}this.processEvent(Ai,AZ);}}return ;}if(Af==="Escape"){if(Ai.loseFocus){Ai.loseFocus(true);}if(AI.contains(this.bodyContainer,Ai)&&this.currentView!==A){this.actionByKeyboard=true;this.shouldRestoreFocus=true;this.switchViewTo(A);}else{this.loseFocus(true);if(AF.walk("parent.close",this)){this.parent.close();this.hostRestoreFocus(Ag);}}return ;}if(AN.includes(k,Af)&&AI.contains(this.bodyContainer,Ai)){var Ad=[],Ab;switch(this.currentView){case A:Ad=this.dayList;Ab=7;break;case a:Ad=this.monthList;Ab=3;break;case AD:Ad=this.yearList;Ab=this.yearViewSize;break;case G:Ad=this.hourList;Ab=6;break;case B:Ad=this.minuteList;Ab=10;break;case p:Ad=this.secondList;Ab=10;break;}var Ae=AN.indexOf(Ad,Ai),Ah,Aa;switch(Af){case k[0]:Aa=Ae-Ab;Ah=Aa>=0;break;case k[1]:Aa=Ae+Ab;Ah=Aa<Ad.length;break;case k[2]:Aa=Ae-1;Ah=Aa>=0;break;case k[3]:Aa=Ae+1;Ah=Aa<Ad.length;break;}if(Ah){if(Ai.loseFocus){Ai.loseFocus(true);}if(AF.walk(Aa+".grabFocus",Ad)){Ad[Aa].grabFocus(true);}}}},processEvent:function(Ak,Ar){var Ac=this.currentView,Ad=this.selectedDates,Ah,Am,As,AZ,Aj;if(Ak===this.monthLabel){if(Ac!==a){this.switchViewTo(a);}return true;}if(Ak===this.yearLabel){if(Ac!==AD){this.adjustYearStart();this.switchViewTo(AD);return true;}}if(Ak===this.hourLabel){if(Ac!==G){this.switchViewTo(G);}return true;}if(Ak===this.minuteLabel){if(Ac!==B){this.switchViewTo(B);}return true;}if(Ak===this.secondLabel){if(Ac!==p){this.switchViewTo(p);}return true;}if(Ak===this.AMPMLabel){if(Ac!==G){this.switchViewTo(G);}return true;}if(Ac===G){var Af=Ak.getAttribute("h");Aj=parseInt(Ak.innerHTML,10);if(!isNaN(Af)&&!isNaN(Aj)){Af=parseInt(Af,10);this.timeVal.hour=Aj%12+Af*12;this.updateTimePart();this.switchViewTo(A);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(Ac===B){Aj=parseInt(Ak.innerHTML,10);if(!isNaN(Aj)){this.timeVal.min=Aj;this.updateTimePart();this.switchViewTo(A);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(Ac===p){Aj=parseInt(Ak.innerHTML,10);if(!isNaN(Aj)){this.timeVal.sec=Aj;this.updateTimePart();this.switchViewTo(A);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(Ac===A){var Aq=this.browseYear,Aa=this.browseMonth,Ab;Ak=N(Ak);As=parseInt(Ak.innerHTML,10);AZ=parseInt(Ak.getAttribute("m"),10);if(!isNaN(As)&&!isNaN(AZ)){Ab=(AZ===0)?{y:Aq,m:Aa}:(AZ===1?AA.getNextMonth(Aq,Aa):AA.getPreMonth(Aq,Aa));if((!this.canSelectDisabledDate&&this.isDateDisabled(As,Ab.m,Ab.y,this.min,this.max))||Ar.button===2){return true;}if(this.isAdvanced){return true;}var An=AE(Ad,As,Aa,Aq),Al=Ad.length>1,Ai=this.forceNonEmptySelection,Ao=this.isMultiSelect,Ag=Ao&&Ar.ctrlKey,Ap=Ao&&Ar.shiftKey,Ae=null;if(Ap){Ae=W(this,Ak);AV(this);n(this,Ae);}else{if(Ag){if(An===-1){AO(this,Ak);}else{if(!Ai||Al){AX(this,An);}}}else{AV(this);if(Al||An===-1||Ai){AO(this,Ak);}}}if(this.onselect||L.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AZ===1){this.increase();}else{if(AZ===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);C.call(this,"baseDate",0);}}}return true;}if(Ac===a){Ak=N(Ak);Am=parseInt(Ak.getAttribute("m"),10);if(!isNaN(Am)){this.set("browseMonth",Am+1);this.switchViewTo(A);}return true;}if(Ac===AD){Ak=N(Ak);Ah=parseInt(Ak.innerHTML,10);if(!isNaN(Ah)){this.set("browseYear",Ah);this.switchViewTo(A);}return true;}return true;},decrease:function(){var Ab=this.currentView,Ae=Ab,Ad=this.browseYear,AZ=this.browseMonth,Aa=this.yearRangStart,Ac;switch(Ab){case A:Ac=AA.getPreMonth(Ad,AZ);this.set("browseMonth",Ac.m);this.set("browseYear",Ac.y);break;case a:this.set("browseYear",Ad-1);break;case AD:this.yearRangStart=Aa-this.yearViewSize*this.yearViewSize;break;case G:Ae=p;break;case B:Ae=G;break;case p:Ae=B;break;}this.switchViewTo(Ae,"right");},increase:function(){var Ab=this.currentView,Ae=Ab,Ad=this.browseYear,AZ=this.browseMonth,Aa=this.yearRangStart,Ac;switch(Ab){case A:Ac=AA.getNextMonth(Ad,AZ);this.set("browseMonth",Ac.m);this.set("browseYear",Ac.y);break;case a:this.set("browseYear",Ad+1);break;case AD:this.yearRangStart=Aa+this.yearViewSize*this.yearViewSize;break;case G:Ae=B;break;case B:Ae=p;break;case p:Ae=G;break;}this.switchViewTo(Ae,"left");},updateView:function(AZ){var Aa=this[AZ+"ViewHTML"]();this[AZ+"View"].innerHTML=Aa;if(this.enableAccessibility){this.updateNavListForBodyCell(AZ);this.updateViewList(AZ);}},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(Aa,Ac){var Ag="mstrmojo-Calendar-"+Aa+"View",Af=document.createElement("div"),AZ=this[this.currentView+"View"],Ad=Aa+"ViewHTML",Ae=this[this.currentView+"Label"],Ab=this[Aa+"Label"];if(!this.supportedViews[Aa]){return ;}if(!Ac){Ac=this.sDirMatrix[this.currentView][Aa];}Af.className=Ag;Af.innerHTML=this[Ad]();this.currentView=Aa;this[Aa+"View"]=Af;mstrmojo.css.toggleClass(Af,["ddSelected"],this.isAdvanced);this._slideIntoView(AZ,Af,Ac);},updateViewList:function z(Aa){var Ab=this;this[Aa+"List"]=[];var AZ=AF.walk(Aa+"View.firstChild.lastChild",this);if(!AZ){return ;}if(Aa!==G){AN.forEach(AZ.children,function(Ac){AN.forEach(Ac.cells,function(Ad){Ab[Aa+"List"].push(Ad.firstChild);});});}else{AN.forEach(AZ.children,function(Ad,Ac){if(Ac===0||Ac===3){return true;}AN.forEach(Ad.cells,function(Ae){Ab[Aa+"List"].push(Ae.firstChild);});});}AN.forEach(this[Aa+"List"],function(Ac){AT.enableAccessibility({domNode:Ac});});},_slideIntoView:function(Ad,Ai,Ab){var Ae=this,AZ=this.bodyContainer,Ag=(Ab==="left"||Ab==="right")?Ad.offsetWidth:Ad.offsetHeight,Aa=(Ab==="left"||Ab==="right")?"left":"top",Ah=(Ab==="left"||Ab==="up")?Ag:-Ag,Af=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:Ad,onEnd:function(){AZ.removeChild(Ad);if(Ae.enableAccessibility){var Aj=Ae.currentView;Ae.updateNavListForBodyCell(Aj);Ae.updateViewList(Aj);if(Ae.actionByKeyboard){if(Ae.selectedDayRestoreFocus){if(AF.walk("dayList."+Ae.selectedDayIdx+".grabFocus",Ae)){Ae.dayList[Ae.selectedDayIdx].grabFocus(true);}Ae.selectedDayRestoreFocus=false;return ;}if(Ae.shouldRestoreFocus){Ae.restoreFocus();Ae.shouldRestoreFocus=false;}else{if(AF.walk(Aj+"List.0.grabFocus",Ae)){Ae[Aj+"List"][0].grabFocus(true);}}Ae.actionByKeyboard=false;}}}}),Ac=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:Ai});Ai.style[Aa]=Ah+"px";AZ.appendChild(Ai);Af.props[Aa]={start:0,stop:-Ah,suffix:"px"};Ac.props[Aa]={start:Ah,stop:0,suffix:"px"};Af.play();Ac.play();},dayViewHTML:function(){var Ae=this.browseYear,Ah=this.browseMonth,Am=AA.getDaysOfMonth(Ae,Ah),Ar=AA.getPreMonth(Ae,Ah),Ab=AA.getDaysOfMonth(Ar.y,Ar.m),Aa=AA.getNextMonth(Ae,Ah),Ai=F(Ae,Ah,this.firstDayOfWeek),Af=[],Ac=f(this),At=0,AZ=this.selectedDates,Ak=this.min,Ao=this.max,Au,Al,Ap,An,As=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"",Aq;U(this,{d:Ab,m:Ar.m,y:Ar.y},{d:1,m:Aa.m,y:Aa.y});Af.push(c(this.cssTextDay));Af.push(this._dayViewTHead());Af.push("<tr>");for(Ap=0;Ap<Ai;Ap++){Au=Ab-Ai+Ap+1;Al=this.isDateDisabled(Au,Ar.m,Ar.y,Ak,Ao)?"disabled":"";Aq=m(Au,false);Af.push("<td "+As+'><div class="mstrmojo-Calendar-day-pre '+Al+'" m="-1" aria-label="'+Aq+'">');Af.push(Au);Af.push("</div></td>");At++;}for(Ap=0;Ap<Am;Ap++){Au=Ap+1;Al=this.isDateDisabled(Au,Ah,Ae,Ak,Ao)?" disabled":"";var Ad=AJ(Au,Ah,Ae),Ag=Ad?" today":"",Aj=AE(AZ,Au,Ah,Ae)!==-1;if(Aj){this.selectedDayIdx=At;}Ag=(this.hilightToday&&Ad)?" hilightToday":Ag;Aq=m(Ap+1,Aj);Af.push("<td "+(Ad?('class="'+Ag+'" '):" ")+(Aj?Ac:"")+'><div class="mstrmojo-Calendar-day-cur'+(Aj?(" selected "):"")+Al+'" m="0"'+(Aj?Ac:"")+' aria-label="'+Aq+'">');Af.push(Ap+1);Af.push("</div></td>");if((++At)%7===0){Af.push("</tr><tr>");}}for(An=At;An<42;An++){Au=At-Am-Ai+1;Al=this.isDateDisabled(Au,Aa.m,Aa.y,Ak,Ao)?"disabled":"";Aq=m(Au,false);Af.push("<td "+As+'><div class="mstrmojo-Calendar-day-next '+Al+'" m="1" aria-label="'+Aq+'">');Af.push(Au);Af.push("</div></td>");if((++At)%7===0&&At!==42){Af.push("</tr><tr>");}}Af.push("</tr>");Af.push(E);return Af.join("");},_dayViewTHead:function(){var Ac=[],Ad='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',Ab="</tr></thead>",Aa=this.firstDayOfWeek-1,Ae=this.dayNames,AZ;Ac.push(Ad);for(AZ=Aa;AZ<Aa+7;AZ++){Ac.push("<td>");Ac.push(Ae(AZ%7));Ac.push("</td>");}Ac.push(Ab);return Ac.join("");},monthViewHTML:function(){var Ac=[],Af=this.browseMonth-1,Ad=this.browseYear,Ab,Ae,Aa,AZ;U(this,{d:31,m:12,y:Ad-1},{d:1,m:1,y:Ad+1});Ac.push(c(this.cssTextMonth));Ac.push("<tr>");for(Ab=0;Ab<12;Ab++){Ae=this.monthNames(Ab);Aa=Ab===Af;AZ=m(Ae,Aa);Ac.push("<td "+(Aa?f(this):"")+'><div class="mstrmojo-Calendar-month'+(Aa?" selected":"")+'" m="');Ac.push(String(Ab));Ac.push('" aria-label="'+AZ+'">');Ac.push(Ae);Ac.push("</div></td>");if(Ab%3===2){Ac.push("</tr><tr>");}}Ac.pop();Ac.push("</tr>");Ac.push(E);return Ac.join("");},yearViewHTML:function(){var Ag=this.yearRangStart,Ac=[],Ae=this.browseYear,Af,Ab,Ad=this.yearViewSize,Aa,AZ;U(this,{d:31,m:12,y:Ag-1},{d:1,m:1,y:Ag+Ad*Ad});Ac.push(c(this.cssTextYear));Ac.push("<tr>");for(Ab=0;Ab<Ad*Ad;Ab++){Af=Ag+Ab;Aa=Ae===Af;AZ=m(Af,Aa);Ac.push("<td "+(Aa?f(this):"")+'><div class="mstrmojo-Calendar-year'+(Aa?" selected":"")+'" aria-label="'+AZ+'">');Ac.push(Af);Ac.push("</div></td>");if(Ab%Ad===(Ad-1)){Ac.push("</tr><tr>");}}Ac.pop();Ac.push("</tr>");Ac.push(E);return Ac.join("");},hourViewHTML:function(){var Ad=[],Ac=this.timeVal.hour,Ab,Aa,Ae,AZ;Ad.push(Q);Ad.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');Ad.push(l().AM_NAME);Ad.push("</div></td></tr>");for(Ab=0;Ab<12;Ab++){Ae=(Ab===0)?12:Ab;Aa=Ab===Ac;AZ=m(Ae,Aa);Ad.push('<td><div class="mstrmojo-Calendar-hour'+(Aa?" selected":"")+'" h="0" aria-label="'+AZ+'">');Ad.push(Ae);Ad.push("</div></td>");if(Ab===5){Ad.push("</tr><tr>");}}Ad.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');Ad.push(l().PM_NAME);Ad.push("</div></td></tr>");for(Ab=0;Ab<12;Ab++){Ae=(Ab===0)?12:Ab;Aa=(12+Ab)===Ac;AZ=m(Ae,Aa);Ad.push('<td><div class="mstrmojo-Calendar-hour'+(Aa?" selected":"")+'" h="1" aria-label="'+AZ+'">');Ad.push(Ae);Ad.push("</div></td>");if(Ab===5){Ad.push("</tr><tr>");}}Ad.push("</tr>");Ad.push(E);return Ad.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(Ad,Ae){var Ac=[],Ab,Aa,AZ;Ac.push(Q);Ac.push("<tr>");for(Ab=0;Ab<60;Ab++){Aa=Ab===Ad;AZ=m(Ab,Aa);Ac.push('<td><div class="');Ac.push(Ae);Ac.push(Aa?' selected">':'" aria-label="'+AZ+'">');Ac.push(Ab);Ac.push("</div></td>");if(Ab%10===9){Ac.push("</tr><tr>");}}Ac.pop();Ac.push("</tr>");Ac.push(E);return Ac.join("");},isDateDisabled:function(AZ,Ab,Aa){return !AB(AZ,Ab,Aa,this.min,this.max);},unrender:function i(AZ){delete this.lastValue;this._super(AZ);},grabFocus:function e(AZ){this._super();if(AZ){this.domNode.focus();}},loseFocus:function s(AZ){this._super();if(AZ){this.domNode.blur();}},enterUnit:function Y(AZ){this.resetTabNav();this.grabFocus(true);if(AZ){this.navigateToFirstValidTarget();}},restoreFocus:function q(){if(!this.navList.length){this.buildNavList();this.tabIndex=0;}if(this._super){this._super();}},updateNavListForBodyCell:function H(Aa){var Ab,AZ=AF.walk(Aa+"View.firstChild.lastChild",this);if(!AZ){return ;}Ab=AF.walk("children."+(Aa===G?1:0)+".cells.0.firstChild",AZ);if(Ab){this.navList[4]=Ab;AT.enableAccessibility({domNode:Ab});}},buildNavList:function AL(){if(!this.enableAccessibility){return ;}var Ac=this,AZ=this.currentView;this.navList=[this.decreaseButton,this.monthLabel,this.yearLabel,this.increaseButton];this.updateNavListForBodyCell(AZ);this.updateViewList(AZ);if(this.dtp===AM.TIMESTAMP||this.dtp===AM.TIME){this.navList.push(this.hourLabel,this.minuteLabel,this.secondLabel,this.AMPMLabel);}var Ae=AF.walk("checkLabel.checkbox.domNode",this);if(Ae){this.navList.push(Ae);if(this.checkLabel.checkbox.checked){var Aa=AF.walk("advancedPanel.daysAdjustBox",this),Ad=AF.walk("advancedPanel.monthsAdjustBox",this);this.navList=this.navList.concat(J(Aa),J(Ad));}}if(AF.walk("buttonsNode.style.display",this)!=="none"){var Ab=AF.walk("buttonsNode.children",this);if(Ab){this.navList.push(Ab[1],Ab[0]);}}AN.forEach(this.navList,function(Af){if(Af instanceof HTMLElement){AT.enableAccessibility({domNode:Af});}else{if(Af.scriptClass==="mstrmojo.ui.editors.controls.ValidationTextBox"){AT.enableAccessibility({widget:Af,domNode:Af.inputNode});Af.validate=mstrmojo.func.composite([Af.validate,function(){Ac.restoreFocus();}]);}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.dom","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.vi.util.NumberFormatUtility");var M=mstrmojo.hash,d=mstrmojo.array,G=mstrmojo.num,J=mstrmojo._FormatDefinition,B=mstrmojo.css,b=mstrmojo.mstr.EnumFunction,L=mstrmojo.locales,H=mstrmojo.Button.newIconButton,O=mstrmojo.date,I=mstrmojo.vi.util.NumberFormatUtility,t="1234.12",E=J.NumberFormatCategory,q=J.FixedNegative,F=J.CurrencyNegative,g=J.PercentNegative,K=J.DefaultFormat.FormattingNumber,o="nf-MiddleRow ",Y="nf-MiddleRow nf-HasWidget ",a,U,f=function f(w,u){return{cls:this.value===w.v?"selected":"",v:w.v||"",n:w.n||"",style:w.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===u?"selected":""};},p={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var S=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(J.Category.slice(2)),e=[{n:"$"},{n:""},{n:""},{n:""},{n:"fr."}];function D(x,w){var u=d.find(x,"v",w);return u===-1?"":x[u].f;}function N(u){var x=this.parent.parent.parent.myData,w=u.v;x.set("format",D(this.items,w));x.set("negativeNumbers",w);B.toggleClass(this.selectedNode,"red",u.r);}function Z(x,y,u){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:x,onitemSelected:function w(z){var AA=this.parent;while(AA&&(!AA.data||typeof AA.data[y]==="undefined")){AA=AA.parent;}if(AA){AA.data.set(y,z.v);if(u){AA.children[0].preview.preview_label.set("text",z.n);}}}};}function j(AF,AA,z,AI,AE){var AH=M.clone(AF),w=AA>0?L.number.DECIMALSEPARATOR:"",x=AA>0?".":"",y=J.DefaultFormat.FormattingNumber,AG=new RegExp("\\"+L.number.THOUSANDSEPARATOR,"g"),u=new RegExp("\\"+L.number.DECIMALSEPARATOR+"\\d{2}","g"),AC;for(AC=0;AC<AA;AC++){w+=AC%9;x+="0";}for(AC=0;AC<AH.length;AC++){var AD=AH[AC];AD.n=AD.n.replace(/,/g,"@");AD.n=AD.n.replace(/\./g,L.number.DECIMALSEPARATOR);AD.n=AD.n.replace(/@/g,L.number.THOUSANDSEPARATOR);if(z){AD.n=AD.n.replace(AG,"");AD.f=AD.f.replace(/,/g,"");}if(AI&&AI!==y.CurrencyPosition){switch(AI){case p.RIGHT:AD.n=AD.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12$");AD.f=AD.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case p.LEFT_WITH_SPACE:AD.n=AD.n.replace(/\$/g,"$ ");AD.f=AD.f.replace(/\$/g,"$ ");break;case p.RIGHT_WITH_SPACE:AD.n=AD.n.replace(/\$/g,"").replace(u,L.number.DECIMALSEPARATOR+"12 $");AD.f=AD.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}AD.n=AD.n.replace(u,w);AD.f=AD.f.replace(/\.\d{2}/g,x);if(AE&&AE!==y.CurrencySymbol){var AB=AE.replace(/\$/g,"$$$$");AD.n=AD.n.replace(/\$/g,AB);AD.f=AD.f.replace(/\$/g,AB);}AD.cls=AD.r?"red":null;}return AH;}function W(x){var u="1"+(x>0?".":"").toString(),y="0"+(x>0?".":"").toString(),w;for(w=0;w<x;w++){u+=w%10;y+="0";}return[u+"E+03",y+"E+0#"];}function R(AI,AK){var AC="\u00A4",AG=/"[^"]*"/g,x=AI.match(AG),AL="\u0091",AH=/\[[^\]]*\]/g,u=AI.match(AH),AF,AJ;AF=AI.replace(AG,AC);AF=AF.replace(AH,AL);var z=AI.indexOf("."),AE=G.getDecimalLength(AI),AB=Math.max(0,AE+AK),y=AI.match(/\d(?!((\d)|(,\d)))/g),w=z!==-1?AI.charAt(z-1):y&&y[0],AD=(w||"0")+(AB>0?".":"").toString();for(var AA=0;AA<AB;AA++){AD+="0";}AF=AF.replace(AE===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,AD);AF=AF.split(AC);AJ=AF[0];d.forEach(x,function(AN,AM){AJ+=AN+AF[AM+1];});AF=AJ.split(AL);AJ=AF[0];d.forEach(u,function(AN,AM){AJ+=AN+AF[AM+1];});return AJ;}function P(AC,u,AB,AA,x,w){var z=AC.parent.parent.parent,y=j(u,AB.decimalPlaces,AA,x,w);AB.set("format",D(y,AB.negativeNumbers.toString()));AC.set("items",y);AC.set("selectedIndex",d.find(y,"v",AB.negativeNumbers.toString()));z.preview.preview_label.set("text",I.applyFormatToNumber(z.myData.format,t.replace(/\./g,L.number.DECIMALSEPARATOR)));}function m(){var AD=this.parent.parent,AH=AD.myData,y=AD.formatterContainer,w=S[AD.categoryPicker.selectedIndex].v,AK=this.funcType===b.FunctionLeftStr?1:-1,AA=null,AC=null,z=false,AJ=0,AE=null,x=false,AG;switch(w){case E.Fixed:AA=y.fixed_hBox.negativeDDL;AC=q;z=!AH.thousandSeparator;break;case E.Currency:AA=y.currency_hBox2.negativeDDL;AC=F;AJ=AH.currencyPosition;AE=AH.currencySymbol;break;case E.Percentage:AA=y.percentage_hBox.negativeDDL;AC=g;break;case E.Scientific:x=true;break;case E.Custom:AG=true;break;default:return ;}if(AG){var AI=R(AH.format,AK);AD.preview.preview_label.set("text",I.applyFormatToNumber(AI,t.replace(".",L.number.DECIMALSEPARATOR)));AD.formatterContainer.custom_text.set("value",AI);return ;}var AB=AH.decimalPlaces,u=AB+AK;u=Math.max(0,u);u=Math.min(J.MaxNegativeDidigts,u);AH.set("decimalPlaces",u);if(x){var AF=W(u);AH.set("format",AF[1]);AD.preview.preview_label.set("text",AF[0]);}else{P(AA,AC,AH,z,AJ,AE);}}function s(u,w){return Math.max(d.find(u,"v",w),0);}function C(x){var w=this.parent.parent.categoryPicker,u=S.map(function(y){return y.v;}).indexOf(x);w.set("selectedIndex",u);}function n(u,w,y,x){return H(undefined,u,w,undefined,M.copy(x,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:y,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function c(){var x=mstrApp.isSingleTier&&!mstrmojo.dom.isMac();if(x||mstrApp.isVI){var y=this.formatterContainer,AD=L.datetime,AB={day:16,month:4,year:2020},AA={hour:9,min:41,sec:46},w=AD&&AD.DATEINPUTFORMATS,z=AD&&AD.TIMEINPUTFORMATS,AC={};a=[];U=[];w.forEach(function(AE){AC[AE.toLowerCase()]=1;a.push({v:AE,n:O.formatDateInfo(AB,AE)});});z.forEach(function(AE){U.push({v:AE,n:O.formatTimeInfo(AA,AE)});});if(x){y.date_ddl.set("items",a);y.time_ddl.set("items",U);}else{U=J.Time;var u=J.Date.filter(function(AE){return !AC[AE.v&&AE.v.toLowerCase()];});a=a.concat(u);y.date_ddl.set("items",a);y.time_ddl.set("items",U);}}else{a=J.Date;U=J.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}c.call(this);var u=this.formatterContainer;if(this.formatValue){u.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;u.fixed_btn.checked=!!this.formatValue.thousandSeparator;B.addWidgetCssClass(u.fraction_ddl,g[d.find(g,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function Q(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",s(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[M.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function l(AI){if(!this.hasRendered){return ;}var AD=this,AG=AD.parent,y=AG.formatterContainer,u=AG.shortcutRow,AH=AG.preview.preview_label,AF=AI.v,AA=AF===E.Automatic,x=AF===E.Scientific,w=[],AC=AG.myData;d.forEach(y.children,function(AJ){AJ.set("visible",false);});AG.border.set("visible",!AA);AG.preview.set("visible",!AA);AG.borderBottom.set("visible",!(!mstrApp.isWSStyling||AA||x));["border","moveLeftBtn","moveRightBtn"].forEach(function(AJ){u[AJ].set("visible",!AA);});AC.set("category",AF);AC.set("thousandSeparator",AF?K.ThousandSeparator:AG.formatValue.thousandSeparator);switch(AF){case E.Currency:P(y.currency_hBox2.negativeDDL,F,AC,false,AC.currencyPosition,AC.currencySymbol);y.currency_hBox1.currency_position.set("selectedIndex",s(J.CurrencyPosition,AC.currencyPosition.toString()));w=["currency_hBox1","currency_hBox2"];break;case E.Date:y.date_ddl.set("selectedIndex",s(a,AC.format));w=["date_ddl"];break;case E.Time:y.time_ddl.set("selectedIndex",s(U,AC.format));w=["time_ddl"];break;case E.Percentage:P(y.percentage_hBox.negativeDDL,g,AC,false,0,null);w=["percentage_hBox"];break;case E.Fraction:y.fraction_ddl.set("selectedIndex",s(J.Fraction,AC.format));w=["fraction_ddl"];break;case E.Scientific:var AB=W(AC.decimalPlaces||0);AC.set("format",AB[1]);AH.set("text",AB[0]);break;case E.Custom:var z=AC.customText||AC.format,AE=y.custom_text;AC.set("format",z);AE.value=z;AE.refresh();AH.set("text",I.applyFormatToNumber(z,t.replace(".",L.number.DECIMALSEPARATOR)));w=["custom_condense","custom_text"];break;case E.Fixed:P(y.fixed_hBox.negativeDDL,q,AC,!AC.thousandSeparator,0,null);w=["fixed_hBox","fixed_btn"];break;}d.forEach(w,function(AJ){y[AJ].set("visible",true);});AG.adjustAfterCategoryChange();}},Z(S,"category")),{scriptClass:"mstrmojo.Box",cssClass:o+"nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[n("nf-shortcut-currency",function i(){C.call(this,E.Currency);},mstrmojo.desc(2051,"Currency"),undefined),n("nf-shortcut-percentage",function i(){C.call(this,E.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),n("nf-shortcut-fixed",function i(){C.call(this,E.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},n("nf-MoveDecimalPoint left",function i(){m.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:b.FunctionLeftStr,alias:"moveLeftBtn"}),n("nf-MoveDecimalPoint right",function i(){m.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:b.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function X(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:Y,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:f,onitemSelected:function l(u){N.call(this,u);}},Z([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:o,label:"",onclick:function i(){var u=this.parent.parent;u.myData.set("thousandSeparator",this.checked?-1:0);P(this.parent.fixed_hBox.negativeDDL,q,u.myData,!this.checked,0,null);},preBuildRendering:function A(){this.set("label",mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",L.number.THOUSANDSEPARATOR));}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:Y,visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:e,postselectedValueChange:function k(u){var z=this,y=z.parent.parent.parent,x=u.value,w=y.myData;w.set("currencySymbol",x);P(this.parent.parent.currency_hBox2.negativeDDL,F,w,false,parseInt(w.currencyPosition,10),x);}},M.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function l(u){var y=this,x=y.parent.parent.parent,w=u.v;x.myData.set("currencyPosition",parseInt(w,10));P(this.parent.parent.currency_hBox2.negativeDDL,F,x.myData,false,parseInt(w,10),x.myData.currencySymbol);}},Z(J.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:Y,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:f,onitemSelected:function l(u){N.call(this,u);}},Z([],"format"))]},M.copy({alias:"date_ddl",cssClass:Y},Z(J.Date,"format",true)),M.copy({alias:"time_ddl",cssClass:Y},Z(J.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:Y,negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},M.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:f,onitemSelected:function l(u){N.call(this,u);}},Z([],"format"))]},M.copy({alias:"fraction_ddl",cssClass:Y},Z(J.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0;[<=-1000000]#,##0,,"M";[<=-1000]#,##0,"K"');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function h(){var x=this,w=x.parent.parent,u=x.value;w.myData.set("format",u);w.myData.set("customText",u);x.parent.parent.preview.preview_label.set("text",I.applyFormatToNumber(u,t.replace(".",L.number.DECIMALSEPARATOR)).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.Label",alias:"borderBottom",cssClass:"nf-border"},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:o+"nf-PreviewRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right preview-info-label",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",iconAriaLabel:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" role="button" aria-label="{@en@iconAriaLabel}" aria-haspopup="true" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",enableAccessibility:"this.parent.opener.enableAccessibility",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var G=this._lastOpened,H=this._calendarConfig;if(!H){H={};if(this.calendarToBody){delete this.calendar.slot;H.placeholder=document.body.appendChild(document.createElement("div"));H.nudge=function(){var N=this.opener;if(N){var I=mstrmojo.dom.position(N.popupNode,true),M=this.domNode,Q=M.offsetHeight,J=M.offsetWidth,K=mstrmojo.dom.windowDim(),L=I.x,O=I.y;if(O+Q>=K.h){O=Math.max(O-Q,0);}if(L+J>=K.w){L=Math.max(L-J,0);}var P=M.style;P.top=O+"px";P.left=L+"px";}};}this._calendarConfig=H;}H.lockIW=this;if(G&&G.visible){this.closePopup();}else{this.openPopup("calendar",H);var F=this.calendar.cal;F.updateSelectedDate(true);if(F.enableAccessibility){F.enterUnit(this.actionByKeyboard);F.tabParent=this.iconNode;}}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var G=mstrmojo.css,F=Math.round;function J(O){var P=this.previewNode,N=P.clientWidth,R=P.clientHeight,Q=P.offsetWidth-N,S=Math.sqrt(N*N+R*R)-Q/2,M=Math.atan2(R,N)*(-180)/Math.PI;P.style.backgroundColor="#FFFFFF";O.display="block";O.top=F((P.offsetHeight+Q)/2)+"px";O.left=F((N-S+Q)/2)+P.offsetLeft+"px";O.width=F(S)+"px";O[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+F(M)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function D(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function H(){G.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:false,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function L(N){this._super(N);var M=this.colorPicker;M.showGradient=this.showGradient;if(this.showNoFill!==undefined){M.showNoFill=this.showNoFill;M.showAutomatic=this.showAutomatic;}M.showAutomatic=this.showAutomatic;G.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function K(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function I(N,M){this._super(N,M);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},afterLayout:function C(){var M=this.previewNode,N=M.style,P=N.width,O=M.offsetWidth;if(O>0){N.width=(O-4)+"px";}else{if(P!==""){N.width=(parseInt(P,10)-4)+"px";}}if(N.height===""){N.height=(M.offsetHeight-4)+"px";}},postBuildRendering:function A(){var M=this.noFillNode=document.createElement("div");M.style.display="none";M.className="slash";this.domNode.firstChild.appendChild(M);this._super();},updatePreview:function B(){var Q=this.previewNode;if(Q){var O=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(O){var R=Q.style;if(O.c1){var S=G.buildGradient(O.or,O.c1,O.c2);if(S&&S.n){R[G.convertCssToCamelCase(S.n)]=S.v;}}else{var M=G.buildGradient(0,"0","0");if(M&&M.n){R[G.convertCssToCamelCase(M.n)]=null;}var P="conflict"===O;G.toggleClass(Q,"conflict",P);R.backgroundColor=!P?O:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var N=this.noFillNode.style;if("transparent"===O){J.call(this,N);}else{N.display="none";}}}Q.style.backgroundOrigin="border-box";}},getPopupWidget:function E(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,showNoFill:true,colorChanged:function(M){this.parent.set("selectedValue",M);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.Image","mstrmojo.css");mstrmojo.vi.ui.CollapsibleTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,null,{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",btnCollapse:null,canCollapse:false,isCollapsed:false,collapse:mstrmojo.emptyFn,enableAccessibility:false,onToggleCollapseByUI:mstrmojo.emptyFn,setToolbarVisibility:function D(E){if(!E||!this.isCollapsed){this._super(E);}},onisCollapsedChange:function B(){if(this.canCollapse){var E=this.isCollapsed;this.parent.set("isCollapsed",E);if(this.enableAccessibility){this.domNode.setAttribute("aria-expanded",!E);}}},getLeftToolbarChildren:function A(){var E=this;return[{scriptClass:"mstrmojo.Image",slot:"leftToolNode",alias:"btnCollapse",onclick:function(G){var H=this.parent,F=H.parent;if(H.canCollapse){H.set("isCollapsed",!H.isCollapsed);E.onToggleCollapseByUI();var I=G.e;if(I&&I.stopPropagation){I.stopPropagation();}}if(F&&F.clickToCollapse){F.clickToCollapse();}}}];},onkeydown:function C(E){var G=E.e||E,F=G.key;if(this._super){this._super(E);}if(!this.enableAccessibility){return ;}if(F==="Enter"||F===" "){E.cancel();E.preventDefault();this.btnCollapse.onclick(E);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.CollapsibleTitleBar,{oncanCollapseChange:function(){this.btnCollapse.set("visible",this.canCollapse);},onisCollapsedChange:function(){mstrmojo.css.toggleClass(this.domNode,"collapsed",this.isCollapsed);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.desc","mstrmojo.ME.TokenInputBox","mstrmojo.mstr.EnumDSSXMLTokenTypes","mstrmojo.ME.Enum","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.string");mstrmojo.requiresDescs(221,547,9106,9565,9566,9567,9568,11897,13542,13543,15665);var M=mstrmojo.array,S=mstrmojo.hash,I=mstrmojo.desc,O=mstrmojo.mstr.EnumDSSXMLTokenTypes,N=mstrmojo.ME.Enum.METRIC_EDIT_TYPES,L=mstrmojo.string.escape4HTMLText,E=mstrmojo.dom;var Q={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},R={0:I(9565,"Valid Metric Formula."),1:I(9106,"Require Validation?"),2:I(9566,"Validation in Progress..."),3:I(9567,"Validation Failed with Syntax Error!"),4:I(9568,"Validation Failed with Object Ambiguity!")},U={ERROR:"-2147214845",AMBIGUITY:"-2147214846"},B={};B[U.ERROR]=Q.ERROR;B[U.AMBIGUITY]=Q.AMBIGUITY;function P(b){if(!b){return Q.VALID;}return B[b]||Q.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.MetricEditBox",vStatus:Q.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,validateFunc:null,isObjectVisible:function(b){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;},statusNode:function(){return this.domNode.lastChild;},validateBtn:function(){return this.domNode.lastChild.lastElementChild;}},markupMethods:{onvStatusChange:function(){var c=this.vStatus,b=this.vStatusNode;b.className="mstrmojo-MEBox-vStatus "+G[c];b.innerHTML=(this.getStatusDesc&&this.getStatusDesc(c))||R[c]||"";if(this.vStatus===Q.VALID){this.set("cValid",true);}},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"},editEmbeddedFilterToken:function(b){var c=this.parent;if(c.editEmbeddedFilterToken){c.editEmbeddedFilterToken(b);}}}],init:function W(b){var c=this,d=b.validateFunc||this.validateFunc;if(d){c.children=[{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"statusNode",text:I(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton right hoverLink",cssDisplay:"inline-block",onclick:d}].concat(this.children);}if(this._super){this._super(b);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function a(){return this.inputBox.getSearchPattern();},getHighlightedText:function X(c,b){return this.inputBox.getHighlightedText(c,b);},item2textCss:function K(b){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[b.t]||"";},handleSuggestionItemSelect:function J(b){var c=this.ambiguityDialog;if(b){c.onItemSelect(b);}c.close();},showDesc:true,showPath:true,ambiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",I(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",I(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(b){mstrmojo._IsList.onclick.call(this,b);},getItemMarkup:function(e,b){var d=this.parent.opener,c=mstrmojo.string.escape4HTMLText;var g=(d&&d.item2textCss(e))||"";var f="";if(e.path){f='<div class="mstrmojo-object-additional-info" idx="'+b+'">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(e.path)+"</div>";}else{e.standalone=true;}return'<div class="mstrmojo-object-item" idx="'+b+'"><div class="mstrmojo-object-name '+g+'" idx="'+b+'">'+L(e.n)+"</div>"+f+"</div>";},buildTooltip:function(b,c){if(b.standalone){return L(b.path)+"> "+L(b.n);}else{return L(b.n)+'<div class="mstrmojo-object-additional-info">'+mstrmojo.desc(16154,"From Dataset:")+" "+L(b.path)+"</div>";}}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:I(547,"Select"),onclick:function(){var b=this.parent.parent;b.opener.handleSuggestionItemSelect(b.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:I(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",Q.UNKNOWN);this.set("iStatus","");},postBuildRendering:function Z(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function H(b){this.inputBox.set("items",b.items);},replaceErrorToken:function C(b){this.inputBox.replaceErrorToken(b);},clientSideValidation:function A(h){if(!h){return ;}var d=false,g=false,c=h.items;try{d=mstrApp.rootCtrl.docCtrl.model.isMDXDataset(S.any(this.parent.parent.datasets));g=h.met==N.ADVANCED&&c[0].tp==O.SimpPrefixFun&&c[0].v==="ApplySimple";}catch(i){}if(d&&g){var b=M.filterOne(c,function(e){return e.tp===O.DoubleQString;});var f=/(\'|\/\/|\-\-|\/\*|\*\/)/;if(b&&f.test(b.v)){h.vs=Q.ERROR;h.rjec=U.ERROR;h.rjed=I(15665,"MDX pass-through expression should not contain ', //, --, /*, */.");}}},handleValidation:function F(d){if(!d){this.set("vStatus",Q.ERROR);return ;}d.vs=P(d.rjec);this.set("vStatus",d.vs);this.set("iStatus",mstrmojo.string.encodeHtmlString(d.rjed)||"");this.updateInputBoxItems(d);if(this.iStatusNode||this.vStatusNode){var l=this.iStatusNode&&this.iStatusNode.clientHeight+this.vStatusNode&&this.vStatusNode.clientHeight,p=this.statusNode.clientHeight,o=p>=(l)?p:l;var k=parseFloat(window.getComputedStyle(this.inputBox.domNode).height);this.inputBox.domNode.style.height=k-o+this.validateBtn.clientHeight+"px";}this.inputBox.focus();if(d.vs===Q.AMBIGUITY){var n=this,i=d.items,h=M.find(i,"sta",-1),b=i[h].v,j=function(c){n.replaceErrorToken(c);n.set("iStatus","");n.set("vStatus",Q.UNKNOWN);if(n.continueValidataion){n.continueValidataion();}else{n.set("vStatus",Q.VALID);}};var e=M.filter(d.srfd.items,this.isObjectVisible);var m=this.parent.candidates,g=m&&m.items;if(g){M.forEach(e,function(f){var c=M.find(g,"did",f.did);if(c===-1){if(this.absorbAmbiguity){g.push(f);}}else{f.path=g[c].path;}});}if(e.length===1){j(e[0]);return ;}this.openPopup("ambiguityDialog",{zIndex:100,items:e,ambiguousName:b,onItemSelect:j});}else{if(this.postHandleValidation){this.postHandleValidation();}}},tooltip:"",useRichTooltip:true,updateTooltipConfig:function Y(c){var d=c.target||E.eventTarget(c.hWin,c.e),b=E.position(d);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(c),top:b.y+b.h,left:b.x+10,cssClass:"vi-regular vi-tooltip-A"};},getTooltipContent:function(b){return this.iStatus;},showTooltip:function D(b,c){if(b.target===this.iStatusNode){this._super(b,c);}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=Q;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS=G;mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC=R;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.Label","mstrmojo.Button","mstrmojo.Pulldown","mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.tooltip","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash","mstrmojo.mstr.EnumDSSXMLBaseFormType");var g=mstrmojo.array,N=mstrmojo.hash,M=mstrmojo.ME.MetricToken.brackets,B=mstrmojo.css,S=mstrmojo.vi.ui.tabs.Tab.ACTIONS,n=S.DELETE+S.RENAME,o=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,p=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_CSS,O=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS_DESC,X=mstrmojo.mstr.EnumDSSXMLObjectTypes,D=mstrmojo.string,s="This@ID",Z="45C11FA478E745FEA08D781CEA190FE5",W=mstrmojo.mstr.EnumDSSXMLBaseFormType,u=[{n:mstrmojo.desc(959,"Default"),v:W.DssXmlBaseFormReserved},{n:mstrmojo.desc(12276,"String"),v:W.DssXmlBaseFormText},{n:mstrmojo.desc(2052,"Date"),v:W.DssXmlBaseFormDate},{n:mstrmojo.desc(3434,"Number"),v:W.DssXmlBaseFormNumber}],a=function(){var z="analytical_engine_version.htm",y=mstrApp.showHelpTopic;if(y){y(z,"upgrade");}else{window.open(mstrmojo.upgradeHelpPath()+z,"_blank");}};function H(y){return{n:y,k:y,ftk:[],vs:1,is:"",bft:W.DssXmlBaseFormReserved,bftp:W.DssXmlBaseFormReserved};}function Q(AE,AF,y,AC){var AA=AE.forms[AF]||{},AD=AE.forms[y],z=AE.inputBox,AB=AE.statusBox.pulldownBox.pulldown;if(AF!==y){AA.vs=AE.vStatus;AA.is=AE.iStatus;AA.bft=AE.formType||AB.getSelectedItem().v;AA.bftp=AE.formType||AB.getSelectedItem().v;AA.ftk=z.items;AE.set("vStatus",o.UNKNOWN);}AE.set("vStatus",AD.vs);AE.set("iStatus",AD.is);AE.updateInputBoxItems({items:AD.ftk});if(AE.curFormIdx!==y){AE.curFormIdx=y;AE.tabstrip.setSelectedTab(AD.k);}AB.set("selectedIndex",g.find(AB.items,"v",AD.bft));AE.raiseEvent({name:"tabSwitch",tks:AD.ftk,vs:AD.vs,is:AD.is,bft:AD.bft,bftp:AD.bftp,oidx:AF,nidx:y,toNewTab:AC});}function P(z){var y=z.forms[z.curFormIdx];if(y){y.ftk=z.inputBox.items;y.vs=z.vStatus;y.is=z.iStatus;}}var m=0;function d(y){m=Math.max(y.length-1,m);}function c(){m=0;}function t(y){var z="DESC"+(m?" "+m:"");m++;if(g.find(y,"n",z)>=0){return t(y);}return z;}function J(AB){var AA={v:M(AB.n),oi:AB,isNew:true},z,y;if(AB.t===12){z=g.filter(AB.fs,function(AC){return AC.obf||AB.da;}).length;if(z===1){y=AB.fs[0];AA=N.copy({v:M(AB.n)+"@"+M(y.fnm),ift:true,exv:y.fid,extp:8},AA);}else{AA=N.copy({v:M(AB.n)+"@",ift:true},AA);}}return AA;}function E(z,y){z.set("enabled",!y);var AA="mstrmojo-InlineWaitIcon";if(z.iconClass){z.set("iconClass",z.iconClass.replace(new RegExp(AA),"")+" "+(y?AA:""));}else{mstrmojo.css.toggleClass(z.domNode,AA,y);}}function L(y){return y.tp===33||y.tp===37;}function F(y){return y.tp===-1;}var b=function(AE){var AC=AE.items,z=AC.length,AB,AD,AA=[],y="";AA.push({v:"!",tp:33,lv:4,sta:2});for(AB=0;AB<z;AB++){AD=AC[AB];if((AB===0&&L(AD))||F(AD)){continue;}if(AD.isNew&&!AD.oi){y+=AD.v;}else{if(!D.isEmpty(y)){AA.push({v:y,tp:2,lv:1});y="";}if(AD.v&&AD.v.indexOf(s)>=0){AD.v=AD.v.replace("["+s+"]",s);AD.exv=Z;AD.extp=8;delete AD.oi;}AA.push(AD);}}if(!D.isEmpty(y)){AA.push({v:y,tp:2,lv:1});y="";}AA.push({v:"",tp:-1,lv:4,sta:2});return{items:AA};},h=function(AA){var y=AA.items||[],z=y[y.length-1];if(z&&z.tp===-1){y.pop();}if(y[0]&&L(y[0])){y.splice(0,1);}g.forEach(y,function(AB){if(AB.v&&AB.v.indexOf(s)>=0){N.copy({extp:8,exv:Z,oi:{n:"This",did:"This",t:12}},AB);}});},f=function(y){if(!y){return o.VALID;}return{"-2147214845":o.ERROR,"-2147214846":o.AMBIGUITY}[y]||o.ERROR;},U=function(AA){AA=b(AA);var z={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},y={getArrItemName:function(){return"tkn";},isSerializable:function(AB){return(z[AB])?true:false;}};return D.json2xml("tknstrm",AA,y);},G=function(AA,AD,AC,z){var AB=U(AD),AE=function(AF){if(AF&&AF.tks){var AG=AF.tks;h(AG);AG.vs=f(AG.rjec);AG.tokenXML=AB;if(z){z(AG);}}},y=function(AF){mstrmojo.alert(AF.message||AF.getResponseHeader&&AF.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:AB,localSymbolFolderXML:"",metricXML:"",metricId:AA||"",isNew:true,objectType:12,isIDForm:AC,msgID:mstrApp.getMsgID()},{success:AE,failure:y});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function Y(){if(this._super){this._super();}var y=this,z=y.lbl;z.editOnDoubleClick=this.editable;z.onTextEditComplete=function(AB,AA){if(y.validate(z.text)){y.titleEdited(z.text,AA);}};},onclick:function l(y){var z=mstrmojo.dom.eventTarget(y.hWin,y.e);if(z===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(y){var z=!/[\[\]\"\\]/g.test(y);if(!z){this.lbl.set("isEditing",true);}this.set("valid",z);return z;},showErrTooltip:function x(AC,AA){var y=mstrmojo.dom.position(this.domNode),z=this,AB=z.errTooltip;if(!AB){z.errTooltip=AB=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(AB);}AB.set("top",y.y+y.h+2);AB.set("left",y.x+y.w/2-AA);AB.set("content",'<div class="content"><span>'+AC+"</span></div>");AB.open();window.setTimeout(function(){AB.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function k(AB,AC,AD){var AA=g.find(AC,"k",AD.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:AD.n,draggable:false,editable:AA!==0,cssClass:"mstrmojo-AEB-Tab "+(AA===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return n;},tabSelected:function(){Q(AB,AB.curFormIdx,AA);},titleEdited:function z(AF,AE){if(AF!==AE){if(g.find(AB.forms,"n",AF)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}else{var AG=AB.forms[AA];AG.n=AF;AB.set("dirty",true);}}},tabDeleted:function y(){var AE=AB.forms.length,AH=(AB.curFormIdx===AE-1)?0:AB.curFormIdx,AF=AB.forms.slice(0),AG=AF[AA];if(AG&&AG.did){AB.delForms.push({n:AG.n,did:AG.did});}AF.splice(AA,1);AB.curFormIdx=AH;AB.set("forms",AF);Q(AB,-1,AH);AB.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-AEBox-status {@statusCssClass}"></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;}},markupMethods:{onvStatusChange:function(){var z=this.vStatus,AD=(z===o.VALID),AB=(z===o.UNKNOWN||z===o.VALIDATING),AA=this.statusBox.infoBox;this.validateBtn.set("visible",AB);AA.set("visible",!AB);if(!AB){AA.infoLabel.set("text",AD?mstrmojo.desc(11655,"Valid formula."):mstrmojo.desc(15953,"Validation failed."));var AC=p[z],y=AA.infoIcon.domNode;if(!B.hasClass(AC)){B.removeClass(y,[p[o.VALID],p[o.ERROR],p[o.AMBIGUITY]]);B.addClass(y,AC);}}},oniStatusChange:function(){var AA=this.vStatus,y=(AA===o.ERROR||AA===o.AMBIGUITY),z=this.statusBox.infoBox.infoIcon;z.title=y?(this.getStatusDesc&&this.getStatusDesc(AA))||O[AA]+" "+this.iStatus:"";}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function q(AB){var AC=this,AE=function(){AC.validateCurrentForm();},AA=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function z(AH,AI,AG){return N.copy(k(AC,AH,AI),AG);},addTab:function AF(){var AI=AC.forms,AG=AI.length,AJ=t(AI),AH=AI.slice(0);AH.push(H(AJ));AC.set("forms",AH);Q(AC,AC.curFormIdx,AG,true);AC.set("dirty",true);},clear:function y(){g.forEach(this.children,function(AG){AG.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(2827,"Clear"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll hoverLink",onclick:function(){AC.inputBox.clearTokens([]);AC.inputBox.raiseChangeEvent({type:"clear"});}},{scriptClass:"mstrmojo.Box",alias:"statusBox",slot:"statusNode",cssClass:"statusBox",children:[{scriptClass:"mstrmojo.Box",alias:"pulldownBox",cssClass:"pulldownBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-AEBox-pulldownLabel AEBox-item",text:mstrmojo.desc(9918,"Data Type")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"pulldown",cssClass:"mstrmojo-AEBox-pulldown AEBox-item",selectedIndex:0,items:u,onitemSelected:function(AJ){var AG=AC.curFormIdx,AH=AC.forms,AI=AH&&AH.length>AG&&AH[AG];if(AI){if(AI.bft!==AJ.v){AI.bft=AI.bftp=AJ.v;AC.set("dirty",true);}}}}]},{scriptClass:"mstrmojo.Box",cssClass:"helpIcon",cssDisplay:"inline-block",richTooltip:{cssClass:"vi-regular vi-tooltip-A A-center AE-tooltip",posType:mstrmojo.tooltip.POS_TOPCENTER,enableHover:true},useRichTooltip:true,tooltipCloseDelay:500,updateTooltipConfig:function AD(){var AH=this.richTooltip,AG=mstrmojo.dom.position(this.domNode);AH.left=AG.x+AG.w-8;AH.top=AG.y+28;AH.content=mstrmojo.desc(16313,"Data Type options for derived attribute forms are only available for data engine version 11.1 and later.");AH.content+="<br /><div class='help-link-label' mstrevent='click' onclick='mstrmojo.ME.AttributeEditBox.AEHelpFn()'>"+mstrmojo.desc(9849,"Learn More")+"</div>";}},{scriptClass:"mstrmojo.Box",alias:"infoBox",cssClass:"infoBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Button",alias:"infoIcon",cssClass:"mstrmojo-AEBox-infoIcon AEBox-item",title:"",tooltipOpenDelay:0,useRichTooltip:true,updateTooltipConfig:function(){var AG=mstrmojo.dom.position(this.domNode);this.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",top:Math.max(AG.y+26,0),left:Math.max(AG.x+10,0),posType:mstrmojo.tooltip.POS_TOPCENTER,content:this.title};}},{scriptClass:"mstrmojo.Label",alias:"infoLabel",cssClass:"mstrmojo-AEBox-infoLabel AEBox-item"}]}]}];this.validateFunc=AE;AC.children=AA.concat(this.children);this._super(AB);},item2textCss:function K(y){return this._super(y)||{21:"afm"}[y.t]||"";},onformsChange:function e(){var y=this.forms,z=y[this.curFormIdx].k;g.forEach(y,function(AA){h({items:AA.ftk});});this.tabstrip.setTabs(y,z);d(y);},selectFormTab:function A(y){Q(this,this.curFormIdx,y);},postBuildRendering:function Y(){if(this._super){this._super();}this.clear();var y=this;this.inputBox.ondrop=function(AC){if(!AC.src.data||!AC.src.data.item){return ;}var AB=y.inputBox,AE=AB.ctxtBuilder.itemWidgets,AF=N.copyProps(["did","n","t","fs"],AC.src.data.item),AH=J(AF),z,AG,AA;AC.src.data=AH;mstrmojo.ListBase2.prototype.ondrop.call(this,AC);var AD=function(AI){return AI.t===X.Function&&!(!isNaN(AI.fdid)&&AI.fdid<0);};if(AD(AH.oi)){this.insertParenthesisTokens();}if(y.ontokensModify){y.ontokensModify();}z=this.selectedIndices;if(AF.t===12&&AH.ift&&!AH.exv){for(AG in z){AA=AE[AG];if(AA){AB.startTokenSuggestion(AA);}}}AB.clearSelect(true);B.removeClass(AB.domNode,"unselectable");};},clear:function j(){this.curFormIdx=0;this.delForms=[];this.attrid=null;c();this.set("forms",[H("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",o.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(z){var AA=this,AB=this.validateBtn,y=function(AC){E(AB,false);AA.set("vStatus",AC.vs);AA.set("iStatus",AC.rjed||"");AA.updateInputBoxItems({items:AC.items});AA.statusNode.style.display="block";AA.handleValidation(AC);if(z){z(AC.items,AC.vs===o.VALID);}};AA.set("vStatus",o.VALIDATING);E(AB,true);G(this.attrid,{items:this.inputBox.items},AA.curFormIdx===0,y);},validateAllForms:function w(AA){var AB=this,z=AB.forms,y=0,AC=function(AF){var AE=(y===0);if(AF){var AD=z[y-1];AD.ftk=AF.items;AD.vs=AF.vs;AD.is=AF.rjed||"";AD.tokenXML=U({items:AF.items});if(AF.vs!==o.VALID){AB.selectFormTab(y-1);AB.handleValidation(AF);if(AA){AA(null,false);}return ;}}if(y===z.length){if(AA){AA(z,true);}return ;}G(AB.attrid,{items:z[y++].ftk},AE,AC);};P(AB);AC();},continueValidataion:function R(){this.validateCurrentForm();},getStatusDesc:function i(y){return{0:mstrmojo.desc(11655,"Valid Formula.")}[y];},onObjectInsert:function I(AB){var AC=this.inputBox,AA=J(AB),y=AC.insertTokens([AA]),z;if(AB.t===12&&AA.ift&&!AA.exv){z=AC.ctxtBuilder.itemWidgets[y];if(z){AC.startTokenSuggestion(z);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=h;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=b;mstrmojo.ME.AttributeEditBox.mapErrorCode=f;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=U;mstrmojo.ME.AttributeEditBox.validateSyntax=G;mstrmojo.ME.AttributeEditBox.prepareInsertToken=J;mstrmojo.ME.AttributeEditBox.AEHelpFn=a;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.ui.menus.Menu","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.css,C="visible",G="containerNode";function E(Q){Q.btn.style.display=!!Q.menuCfg?"block":"none";}mstrmojo.vi.ui._IsPanel=mstrmojo.provide("mstrmojo.vi.ui._IsPanel",{_mixinName:"mstrmojo.vi.ui._IsPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-content"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.childNodes[2];},handleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onisCollapsedChange:function L(){if(this.canCollapse){this.containerNode.style.display=this.isCollapsed?"none":"block";if(!this.isCollapsed){this.doLayout();}}}},title:"",titleAriaLabel:"",titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,handleNode:null,bubbleMouseOver:true,canCollapse:false,isCollapsed:false,autoHideToolbar:false,init:function K(Q){this._super(Q);this.addChildren([this.getTitleBarCfg()]);this.menuBtnInfo={};},skipsSlotLayout:function(Q){return Q===G&&this.isCollapsed;},getTitleBarCfg:function P(){return{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",isCollapsed:this.isCollapsed,enableAccessibility:this.enableAccessibility,title:this.title,ariaLabel:this.titleAriaLabel||this.title,close:function(){this.parent.setOpenStatus(false);mstrApp.rootCtrl.generateToolbar();},collapse:function(Q){this.parent.set("isCollapsed",Q);}};},ontitleChange:function H(){this.titleBar.set("title",this.title);},_set_children:function A(U,R,Q){if(R!==this.children){var S=this.titleBar;if(S){R.push(S);}}return this._super(U,R,Q);},preBuildRendering:function I(){this.generateToolbar();this.titleBar.setToolbarVisibility(!this.autoHideToolbar);return this._super();},generateToolbar:function B(){var Q=this.titleBar;Q.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));if(!Q.visible){this.menuBtnInfo.menuCfg=Q.getMenuConfig();}},updateToolbar:function O(Q){return Q;},setOpenStatus:function N(Q){if(this.visible!==Q){this.set("visible",Q);this.parent.doLayout();}},setTitleBarVisibility:function D(Q){var S=this.titleBar;S.set("visible",Q);this.generateToolbar();var U=this.menuBtnInfo,R=U.btn;if(!R){R=U.btn=document.createElement("div");R.className="hover-menu-btn";var W=this.id;mstrmojo.dom.attachEvent(R,"click",function(){var Y=mstrmojo.all[W],X=U.menuCfg;X.hostId=W;X.hostElement=R;Y.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:X}));});this.domNode.appendChild(R);}U.menuCfg=Q?null:S.getMenuConfig();E(U);this.doLayout();},onmouseover:function M(Q){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){Q.cancel();}var S=this._panelTimeout;if(S){window.clearTimeout(S);delete this._panelTimeout;}if(this.autoHideToolbar){this.titleBar.setToolbarVisibility(true);}var R=this.menuBtnInfo;if(!!R.menuCfg){F.addClass(R.btn,C);}},onmouseout:function J(){var Q=this.id;this._panelTimeout=window.setTimeout(function(){var R=mstrmojo.all[Q];if(R){if(R.autoHideToolbar){R.titleBar.setToolbarVisibility(false);}var S=R.menuBtnInfo;if(!!S.menuCfg){F.removeClass(S.btn,C);}}},200);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.dom","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.css");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorBand=mstrmojo.declare(mstrmojo.ui.editors.controls.ColorPickerButton,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorBand",hovered:false,selected:false,index:undefined,showGradient:false,showNoFill:false,markupString:'<div class = "color-band mstrmojo-ui-PreviewButton {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:click,keyup,contextmenu,mouseover,mouseout><div class="host mstrmojo-ui-PreviewButton"></div></div>',markupSlots:{previewNode:function(){return this.domNode;},btnNode:function(){return this.domNode;},clickableNode:function(){return this.domNode;},widgetHostNode:function(){return this.domNode.lastChild;}},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onhoveredChange:function C(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnhovered(this.index);}},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnselected(this.index);}this.parent.onBandUnhovered(this.index);},onmouseover:function H(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},oncontextmenu:function G(I){F.preventDefault(window,I.e);var K=this,J=K.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(I.e,I.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(7604,"Change Color"),"",function(){K.onclick(I);});L.addMenuItem(mstrmojo.desc(13386,"Add Color Band"),"",function(){var N=J.markers;var O=F.position(N.containerNode),M=I.e.clientX-O.x;N.addMarker(M);});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.unselect();J.bands.remove(K.index);J.update();});this.openPopup(L.newInstance());},postselectedValueChange:function(J){var K=this.parent.parent,I=K.parent,M=K.getPalette().concat();if(J){var L=J.value;if(K.getReversedValue()){M.reverse();}this.backgroundColor=M[this.index]=L;I.switchToCustomScheme(undefined,M);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ColorBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onbackgroundColorChange:function A(){this.selectedValue=this.backgroundColor;this.updatePreview();this.colorPicker.set("color",this.selectedValue);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName&&C.walk("parent.parent.raiseFormatValueChange",this)){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,hideDashOptions:false,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}if(this.hideDashOptions){Q.push("no-dash");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var U=this.list.items[Q].v,S=C.walk("parent.parent",this);if(this.propName&&S){S.setChildEnable(J.LINE_COLOR,U!==A.none);S.raiseFormatValueChange(this.propName,U,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.hideDashOptions=this.hideDashOptions;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.color","mstrmojo.expr","mstrmojo.hash","mstrmojo.locales","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.validation","mstrmojo.vi.enums.EnumFeatures");var W=mstrmojo.color,U=1,O=2,F=4,H=8,I=45,a=mstrmojo.models.FormatModel,N=a.ENUM_PROPERTY_NAMES,R=N.BACKGROUND_COLOR,E=N.FILL_OPACITY,G={all:{c:N.BORDER_COLOR,s:N.BORDER_STYLE},top:{c:N.BORDER_TOP_COLOR,s:N.BORDER_TOP_STYLE},right:{c:N.BORDER_RIGHT_COLOR,s:N.BORDER_RIGHT_STYLE},bottom:{c:N.BORDER_BOTTOM_COLOR,s:N.BORDER_BOTTOM_STYLE},left:{c:N.BORDER_LEFT_COLOR,s:N.BORDER_LEFT_STYLE}},M={FILL_COLOR:"fillColor",FILL_APLHA:"fillAlpha",BORDER:"border",SIZE:"size",POSITION:"position",SIZE_HEIGHT:"sizeHeight",SIZE_WIDTH:"sizeWidth",POSITION_LEFT:"positionLeft",POSITION_TOP:"positionTop"},S=mstrmojo.expr.DTP,Y=mstrmojo.locales,J=mstrmojo.vi.enums.EnumFeatures;function Z(d,b,e){b.forEach(function(g,f){g.slot="col"+(f+1)+"Node";});var c=e?0:this.secondColumnWidth;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:d,col1Width:(100-c)+"%",col2Width:e?e:(c+"%"),children:b};}function C(c,b){b.forEach(function(e,d){e.slot="col"+(d+1)+"Node";});return{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",alias:c,col1Width:I+"%",col2Width:100-2*I+"%",col3Width:I+"%",children:b};}function A(b,c){return{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:b,cssClass:"right",constraints:{regExp:Y.number.DECIMALSEPARATOR==="."?/^(?:100(?:\.00?)?|\d?\d(?:\.\d\d?)?)?[\%]?$/:/^(?:100(?:,00?)?|\d?\d(?:,\d\d?)?)?[\%]?$/},onValid:function(){if(this.value){var d=this.parent.parent;if(d.raiseFormatLayoutChange){d.raiseFormatLayoutChange(c,this.value.replace(Y.number.DECIMALSEPARATOR,"."),this.orignText&&this.orignText.replace(Y.number.DECIMALSEPARATOR,"."));}}},onfocus:function(){var d=this.orignText=this.value;this.domNode.setSelectionRange(0,d.length);}};}function D(b){return{scriptClass:"mstrmojo.Label",cssClass:"center",text:b};}function L(b,e,d,c){return C(b,[D.call(this,e),D.call(this,d),D.call(this,c)]);}function X(d,b,c){return mstrmojo.hash.copy(c,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",showGradient:!!b,postselectedValueChange:function(e){this.parent.parent.raiseFormatValueChange(d,e.value,e.valueWas);}});}function K(e){var d="transparent",b="none",c;if(e){c=e.indexOf("#");if(c===-1){c=e.indexOf(d);}}if(!isNaN(c)&&c>-1){b=e.substr(0,c-1);d=W.fixFullHexValue(e.substr(c));}else{b=e;}if(b.indexOf("none")>-1){b="none";}return{s:b,c:d};}mstrmojo.ui.editors.controls.ContainerGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",borderTitle:mstrmojo.desc(13631,"Outer border"),fillColorTitle:mstrmojo.desc(7993,"Fill color"),showThickBorderStyle:true,showBackgroundNoFill:true,showBackgroundGradient:false,showBorderNoFill:true,visibleControls:U+O+H,targetBorder:"all",secondColumnWidth:60,init:function P(e){this._super(e);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var d=[],c=this.visibleControls,b=G[this.targetBorder];if((c&U)>0){if(!(c&H)||!mstrApp.supportFeature(J.FILL_OPACITY)){d.push(Z.call(this,M.FILL_COLOR,[{scriptClass:"mstrmojo.Label",text:this.fillColorTitle},X(R,this.showBackgroundGradient,{showNoFill:this.showBackgroundNoFill})]));}else{d.push({scriptClass:"mstrmojo.Label",text:this.fillColorTitle});d.push(Z.call(this,M.FILL_COLOR,[X(R,this.showBackgroundGradient,{showNoFill:this.showBackgroundNoFill}),Z.call(this,M.FILL_APLHA,[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",value:100,cssClass:"right",dtp:S.INTEGER,required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:0,max:100},onValid:function f(){if(this.value!==this.orignText){var g=this.parent.parent.parent;if(g.raiseFormatValueChange){g.raiseFormatValueChange(E,this.value,this.orignText);}}}},{scriptClass:"mstrmojo.Label",text:"%"}],"10px")]));}}if((c&O)>0){d.push({scriptClass:"mstrmojo.Label",text:this.borderTitle});d.push(Z.call(this,M.BORDER,[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:this.showThickBorderStyle,postselectedValueChange:function(g){var h=this.parent.parent;h.raiseFormatValueChange(b.s,g.value,g.valueWas);h[M.BORDER].getControl(2).set("enabled",g.value!=="none");}},X(b.c,false,{showNoFill:this.showBorderNoFill})]));}if((c&F)>0){d=d.concat([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(16651,"Position and Size")},L.call(this,null,"X"," ","Y"),C(M.POSITION,[A.call(this,M.POSITION_LEFT,"left"),D.call(this,"x"),A.call(this,M.POSITION_TOP,"top")]),L.call(this,null,mstrmojo.desc(2985,"Width")," ",mstrmojo.desc(2983,"Height")),C(M.SIZE,[A.call(this,M.SIZE_WIDTH,"width"),D.call(this,"x"),A.call(this,M.SIZE_HEIGHT,"height")])]);}this.addChildren(d);},setPositionAndSize:function Q(c){var b=this[M.POSITION],f=this[M.SIZE],d=c.prop,e=function(h,j){var g=Math.round(j.split("|")[0]*100)/100,i=h.domNode;h.set("value",g.toString().replace(".",Y.number.DECIMALSEPARATOR)+"%");if(i){i.style.borderColor=(g>=0&&g<=100)?"":"red";}};if(b){e(b[M.POSITION_LEFT],d.left);e(b[M.POSITION_TOP],d.top);}if(f){e(f[M.SIZE_HEIGHT],d.height);e(f[M.SIZE_WIDTH],d.width);}},setFormatSource:function B(c){var b=this[M.FILL_COLOR],g=b&&b[M.FILL_APLHA],f=this[M.BORDER],e=this.targetBorder,d=G[e];if(e==="all"){d=G.top;}this.syncControls(function(){if(b){var q=a.decodeGradientValue(a.getGradientValues(c)),h,o=b.getControl(2);if(!q){if(c[N.FILL_STYLE]===1){h="transparent";}else{var m=c[R];if(typeof m==="undefined"||m===null){m=c["background-color"];}if(typeof m==="undefined"||m===null){m=-1;}h=a.decodeValue(R,m);}}if(!o.colorPicker){o=b.getControl(1);}o.set("selectedValue",q||h);}if(g){var l=c[E],p,i=b.getControl(2).fillAlphaText;if(typeof l==="undefined"||l===null){l=c["background-opacity"];}if(typeof l==="undefined"||l===null||l<0||l>100){l=100;}p=parseInt(l,10);i.set("value",p);}if(f){var n=c.border;if(!n){if(typeof (c.borderStyle)!=="undefined"&&c.borderStyle!==null){n=typeof (c.borderStyle)==="string"?c.borderStyle:a.decodeValue("borderStyle",c.borderStyle);}else{n=a.decodeValue(d.s,c[d.s]);}if(typeof c.borderColor!=="undefined"&&c.borderColor!==null){n+=" "+a.decodeValue("borderColor",c.borderColor);}else{if(typeof c[d.c]!=="undefined"&&c[d.c]!==null){n+=" "+a.decodeValue(d.c,c[d.c]);}else{n+=" "+a.decodeValue(d.c,-1);}}}var k=K(n),j=f.getControl(2);f.getControl(1).set("selectedValue",k.s);j.set("enabled",k.s!=="none");j.set("selectedValue",k.c);}});}});mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS={FILL_COLOR:U,BORDER:O,SIZE_POSITION:F,FILL_ALPHA:H};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.string","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo.ui.editors.controls.Stepper","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var C=mstrmojo.string,H=mstrmojo._FormatDefinition,W=mstrmojo.models.FormatModel,L=W.ENUM_PROPERTY_NAMES,K=1,G=2,P=4,F=8,J=16;var R;var M;var I={bold:L.FONT_WEIGHT,italic:L.FONT_STYLE,underline:L.UNDERLINE,strikeout:L.LINE_THROUGH};function D(X){return(X&J)>0;}function S(Y){var c=L.FONT_FAMILY,X=Y&&(Y[c]||W.getFormatBlockValue(Y,c)),a=this.hcgControls.fontFamily,Z=this.getFontFamilyItems();if(X===-1){var b=a&&a.list;if(!b){return ;}b.clearSelect();delete a.selectedIndex;if(a.hasRendered){a.refresh();}}else{if(Z){a.set("selectedIndex",Math.max(Z.map(function(d){return d.n;}).indexOf(X)));}}}function Q(X){var Y=[],Z=function(c,d,a){var b=X[c];if(b===undefined){b=W.getFormatBlockValue(X,c);}if(b){Y.push(a);}};Z(L.FONT_WEIGHT,"bold",0);Z(L.FONT_STYLE,"italic",1);Z(L.UNDERLINE,"underline",2);Z(L.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(Y);}function N(X){var d=this.hcgControls,a=L.FONT_SIZE,Y=L.COLOR,c=X[a]||W.getFormatBlockValue(X,a),Z=d.fontSize;var b=X[Y];if(typeof b==="undefined"||b===null){b=W.getFormatBlockValue(X,Y);}if(typeof b==="undefined"||b===null){b="";}if(D(this.visibleControls)){if(c.length){Z.provider.set("curValGroup",c);}}else{if(c===-1){Z.list.clearSelect();Z.selectedValue="";Z.updatePreview();}else{Z.set("selectedValue",c?(parseInt(c,10)).toString():Z.items[0].n);}}d.fontColor.set("selectedValue",b===""?"conflict":W.decodeValue(L.COLOR,b));}function O(){if(R&&M){return ;}R=H.SizesInVI.map(function(X){return{idx:parseInt(X.n,10),n:X.n};});M=mstrmojo._FormatDefinition.Families.slice(1).map(function(X){return{n:X.n,id:X.n,preview:!X.symbolic};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:K+G+P,showNoFillInColor:true,hcgControls:null,getFontFamilyItems:function A(){return M;},getFontStyleItems:function U(){return[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}];},getHCGControls:function E(a){O();var Y=this.hcgControls={},X=this.visibleControls;if((X&K)>0){Y.fontFamily=mstrmojo.ui.Pulldown.newPulldown(this.getFontFamilyItems(),function(c,d){a(L.FONT_FAMILY,c.id,d&&d.id);},0,{isHostedWithin:false,scrollNodeMaxHeight:350,getPopupListConfig:function Z(){var c=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);c.getItemProps=function d(g,e){var f=mstrmojo._IsList.getItemProps.call(this,g,e);f.style=g.preview?"font-family:'"+C.encodeHtmlString(g.n,true)+"';":"";return f;};return c;}});}if((X&G)>0||(X&F)>0){var b=Y.fontStyle=new mstrmojo.ui.ButtonBar({hasSpacing:true,multiSelect:true,items:this.getFontStyleItems(),postselectionChange:function(c){var e=c.added,f=this.items[e?e[0]:c.removed[0]],d=!!e;if(f){a(I[f.css],d,!d);}}});if((X&F)>0){b.items.pop();}}if((X&P)>0){Y.fontSize=D(X)?new mstrmojo.ui.editors.controls.Stepper({alias:"fontSizeCtrl",provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,R.map(function(c){return c.idx;})),max:Math.max.apply(Math,R.map(function(c){return c.idx;})),container:this,onTraverse:function(){var c=this.container.fontSize;if(c._sync){return ;}this.container.raiseFormatValueChange(L.FONT_SIZE,c.provider.getValGroup());},oncurValGroupChange:function(){var c=this.container.fontSize;if(c.textNode){c.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({alias:"fontSizeCtrl",selectedValue:"10",items:R,isHostedWithin:false,validateTextInput:function(c){return(/^[0-9]+(pt)?$/.test(c));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(c){a(L.FONT_SIZE,parseInt(c.value,10)+"pt",parseInt(c.valueWas,10)+"pt");}});Y.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(c){a(L.COLOR,c.value,c.valueWas);}});}return Y;},setFormatSource:function B(X){var Y=this;this.syncControls(function(){var Z=this.visibleControls;if((Z&K)>0){S.call(Y,X);}if((Z&G)>0||(Z&F)>0){Q.call(Y,X);}if((Z&P)>0){N.call(Y,X);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:K,FONT_STYLE:G,FONT_SIZE_AND_COLOR:P,FONT_STYLE_NO_STRIKEOUT:F,FONT_SIZE_USE_STEPPER:J};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(U,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:U,showNoFill:S!==false,showAutomatic:!!R,showGradient:false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(W){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,W.value,W.valueWas);}},postclick:function(W){this.parent.parent.postclick(W);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(U){this._super(U);var Q=[],Y="col1Node",R=U&&U.colorPickerHostWithin,P=U&&U.showGradient,X=U&&U.showNoFill,S=U&&U.showAutomaticInColor,W;if((this.visibleControls&C)>0){Q.push(N(Y,R,P,X,S));Y="col2Node";}if((this.visibleControls&J)>0){Q.push(O(Y));}if(Q.length===1){W={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(W,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){var Q=this;P.forEach(function(R){Q.setChildValue(R[0],R[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};mstrmojo.ui.editors.controls.FillConfigGroup.FillCompName=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.Arr","mstrmojo.AjaxCall","mstrmojo.css","mstrmojo.Calendar","mstrmojo.WidgetDial","mstrmojo.Label","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.registry","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSConsolidationType");var t=mstrmojo.array,AH=t.map,J=mstrmojo.Arr,E=mstrmojo.css,W=mstrmojo.dom,X=mstrmojo.hash,AI=mstrmojo.string,A=mstrmojo.registry,U=mstrmojo.expr,O=U.ET,i=mstrmojo.mstr.EnumDataType,l=U.ET2TP,Y=U.ET2TGT,AE=U.DTP,D=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AO=mstrmojo.mstr.EnumDSSXMLObjectTypes,G=mstrmojo.mstr.EnumDSSConsolidationType;var g="dummy",K={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:g,css:"unselectable",cls:"temp"},q={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:g,css:"unselectable",cls:"temp"},C={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:g,css:"unselectable"},AC={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:g,css:"unselectable"},AB={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:g,css:"unselectable"},x={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:g,css:"unselectable"},B={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:g,css:"unselectable"};var AN={};AN[AE.DATE]=1;AN[AE.TIME]=1;AN[AE.TIMESTAMP]=1;var y={};y[O.MQ]={key:"metricFns",def:U.METRIC_FNS};y[O.MC]={key:"metricFns",def:U.METRIC_FNS};y[O.AQ]={key:"formFns",def:U.FORM_FNS};y[O.AL]={key:"formFns",def:U.FORM_FNS};y[O.AC]={key:"formFns",def:U.FORM_FNS};y[O.AE]={key:"elemFns",def:U.ELEM_FNS};var S=[U.STP.PROMPT,U.STP.PROMPT_OBJECTS,U.STP.PROMPT_ELEMENTS,U.STP.PROMPT_EXPRESSION,U.STP.PROMPT_EXPRESSION_DRAFT];function F(AR,AT,AQ){var AS=AR.items,AP=t.indexOf(AS,AT);if((AP===0)&&(AS.length===1)){AQ=mstrmojo.Arr.makeObservable((AQ&&AQ.length)?AQ.concat():[]);AR.set("items",AQ);}else{if(AP>-1){AS.splice(AP,1);}if(AQ&&AQ.length){t.insert(AS,(AP>-1)?AP:AS.length,AQ);}AR.refresh();}}function b(AX,AW){if(this.updating){return ;}var AP=this.multiSelect,AR=this.selectedItem,AU=AX&&AX.added,AT=AX&&AX.removed;AW=AW||this.alias;if(!AP&&AU&&AT&&AU[0]===AT[0]){return ;}if(AR&&AR[D]===g){this.updating=true;if(AP){this.removeSelect([this.selectedIndex]);}else{var AV=AT&&Number(AT[0]);AV=(AV==null)?-1:AV;this.set("selectedIndex",AV);}this.updating=false;}else{var AQ=this.parent.parent.parent.model;if(AP){var AS=this.items;AQ.edit(AW,{added:AU&&t.get(AS,AU),removed:AT&&t.get(AS,AT),itemIdField:this.itemIdField});}else{AQ.edit(AW,AR);}}}function R(AP,AR,AS){if(this.updating){return ;}AS=AS||this.alias;var AQ=AP.model;AQ.edit(AS,AR);}function u(){var AQ=this.parent,AP=((AQ&&AQ.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AP&&AP[0];}function N(AP){return mstrmojo.mixin(AP,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+AP.alias,postCreate:u});}function Z(){var AQ=this.parent,AP=AQ.parent;AP["invalid"+AQ.cstIndex]=false;}function n(AR,AP,AS){var AQ=AR.cfg;if(AQ){AQ.data=AR;AQ.parent=AS;return A.ref(AQ);}AQ=new mstrmojo.Label({text:AR.n||"&nbsp;",cssClass:"dial-item "+(AR.t?("t"+AR.t):"")});AQ.markupMethods.onselectedChange=function(){E.toggleClass(this.domNode,["selected"],this.selected);};AQ.data=AR;AQ.parent=AS;return AQ;}function AA(AP){switch(AP){case i.DataTypeInteger:case i.DataTypeUnsigned:case i.DataTypeDecimal:case i.DataTypeReal:case i.DataTypeDouble:case i.DataTypeFloat:case i.DataTypeCellFormatData:return i.DataTypeNumeric;default:return AP;}}function H(AR,AQ){var AP=AR.model||{},AS=AP.fn;return(AS!=null)&&((AP.et===O.MQ)||(AP.et===O.MC)||(AP.et===O.AQ)||(AP.et===O.AL)||(AP.et===O.AC))&&(U.fnCstCount(AS,AP.fnt)>AQ);}function p(AQ){var AT=AQ&&l[AQ.et],AS=AQ&&AQ.fm&&AQ.fm.dtp,AP=AS&&U.DTP2PROMPT_STP[AS],AR={};AR[AT]=true;if(AP){AR[AP]=true;}return AR;}function AK(AP,AR){var AQ;if(AR){switch(Y[AP.et]){case"a":AQ=AR[O.AC];break;case"m":AQ=AR[O.MC];break;default:AQ=false;break;}}else{AQ=true;}return AQ&&U.fn_AC_MC(AP&&AP.fn);}function k(AP){var AS=AP.model,AW=AS&&AS[Y[AS.et]]&&AS[Y[AS.et]][AP.columnWalk.target.itemIdField||"did"],AR=AS&&AS.fm,AY=AR&&AR.dtp,AQ=AK(AS,AP.ets);if(this.targetsLastMod&&this.targetsLastMod===AP.targetsLastMod&&AW&&AW===this._lastTargetId&&this.lastFmDtp===AY&&this.lastFnTp===AQ){return ;}if(!AQ){this.clearSelect();if(this.items.length!==this.preLen){this.set("items",this.items.slice(0,this.preLen));}}else{var AU=AS.a?[C]:AS.m?[AC]:[],AT=f(AP),AX=AU.concat(AT),AV=this.items.slice(this.preLen);t.forEach(AV.reverse(),function(AZ){this.remove(AZ);},this);this.add(AX,-1);}this._lastTargetId=AW;this.lastFnTp=AQ;this.lastFmDtp=AY;this.targetsLastMod=AP.targetsLastMod;}function f(AP){var AQ=AP.model,AR=p(AQ),AS=AQ[Y[AQ.et]];return U.getSortedObjectsByTypeGroup(t.filter(AP.targets,function(AT){return(AT.t!==4||AT.did!==AS.did)&&(AR[AT[D]]||AR[AT[P]]);}));}function a(AQ,AP){var AR=AQ.model||{},AS=AR.cs,AT=AS&&AS[AP];if(AR.et==O.MC&&AR["c"+(AP+2)]){AT=AR["c"+(AP+2)];}return AT;}function I(AP,AS){var AR=AP.model||{},AQ;switch(AR.et){case O.MC:case O.MQ:AQ=(AS&&AS.dtp)||AA(AR.m.dt)||U.METRIC_DTP;if(AQ===AE.BIGDECIMAL){AQ=U.METRIC_DTP;}break;case O.AQ:case O.AC:case O.AE:case O.AL:AQ=AR.fm&&AR.fm.dtp;break;}return AQ||AE.CHAR;}function AM(AQ,AR){if(!AQ){return AQ;}if(AQ.dtp===AE.BIGDECIMAL&&AR===O.MQ){var AP=String(AQ.v);if(AP&&AP.indexOf("#")===-1){return"#"+AP+"#";}else{return AP;}}else{return AQ.v;}}function z(AQ,AP){var AS=AQ.model||{},AT=AS.cs,AU,AR;if(AS.et===O.AL){AR=[];t.forEach(AT,function(AV){AR.push(AV&&AV.v);});AR=AR.join(mstrConfig.listSep);}else{AU=a(AQ,AP);AR=AM(AU,AS.et);}return AR;}function L(Aj,Ab){Aj.updating=true;var AX=Aj.parent.parent.parent,Ai=H(AX,Ab),Ac,Ad;if(Ai){k.call(Aj,AX);var AS=AX.model||{},Ah=a(AX,Ab),AY=I(AX,Ah),Aa=z(AX,Ab);var AW=AS.fn,AU=U.fn_List(AW,AS.fnt),Ak=AN[AY],Ae=Ak&&!AU;var AQ=Aj.ctxtBuilder,Ag=AQ&&AQ.itemWidgets,AR=Ak?(Ae?Aj.calIndex:Aj.dtxtIndex):Aj.txtIndex,AV;for(Ac=0,Ad=Aj.preLen;Ac<Ad;Ac++){AV=Ag[Ac];if(Ac==AR){AV.set("dtp",AY);AV.set("isList",AU);var AP=AV.value,AT=AI.isEmpty(AP),Af=AI.isEmpty(Aa);if(!(AT&&Af)&&AP!==Aa){AV.set("value",Aa);}AV.set("visible",true);AV.set("hint",AU?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");try{if(Aj.alias!=="c1"||Aj.parent.c1Selected){AV.focus&&AV.focus();}}catch(AZ){}if(AW===1||AW===2){AV.constraints.min=0;}if(AV.clearValidation){AV.clearValidation();}}else{AV.set("visible",false);}}if(AX.hasPrompt&&Aj.selectedItem&&Aj.selectedItem.st===U.STP.PROMPT_STRING){AX.invalid0=false;}switch(AS.et){case O.AQ:case O.AL:case O.MQ:if(Ah&&Ah.p){Aj.set("selectedItem",Ah.p);}else{Aj.set("selectedIndex",AR);}break;case O.MC:case O.AC:Aj.set("selectedItem",AS[Y[AS.et]+(2+Ab)]);break;}}Aj.updating=false;}function AJ(){var AS=this.parent,AQ=AS.parent.parent.parent,AR=(this.isValid&&this.isValid())||(!this.isValid&&!AI.isEmpty(this.value)),AP=AQ.model;AQ["invalid"+AS.cstIndex]=!AR;if(!this.updating&&AR){this.updating=true;if(AP){AP.edit(AS.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AQ.updateOkBtn){AQ.updateOkBtn();}}function j(AQ){var AP=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:AJ,onInvalid:AJ,onClearValidation:Z,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AJ,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL-mstrmojo.validation.TRIGGER.ALL.ONBLUR},onValid:AJ,onInvalid:AJ,onClearValidation:Z,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AR){W.stopPropogation(AR.hWin,AR.e);}},visible:false}}];return N(X.copy(AQ,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:n,selectionPolicy:"reselect",items:AP.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:AP.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){L(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:b}));}function AL(AQ,AP){var AR=AP+U.FN_SEP+AQ;return(AQ!=null)?{did:AR,n:AR}:null;}function Q(AR){var AT=this.selectedItem;AR=t.filter(AR,function(AU){return(!AU.icf);});if(AT){var AQ=t.find(AR,this.itemIdField,AT[this.itemIdField]);if(AQ>-1){AR=AR.concat();AR.splice(AQ,1);}}F(this,q,AR);var AS=this.items,AP=AS.length;if(AP===1){this.singleSelect(0);}this.updateScrollbars&&this.updateScrollbars();this.parent&&this.parent.updateScrollbars&&this.parent.updateScrollbars();}function e(AP,AQ){if(mstrApp&&mstrApp.isWorkstation){mstrApp.serverRequest(AP.params,AQ);}else{if(AP._delayId){window.clearTimeout(AP._delayId);delete AP._delayId;}AP._delayId=window.setTimeout(function(){delete AP._delayId;AP.send();},500);}}function o(AR,AQ,AS,AV){AR.updating=true;if(AQ){if(AS!=null){AR.set("items",[]);AR.clearSelect();AR.set("items",AS);}var AU=AR.itemIdField,AT=AR.selectedItem;if((AT&&AT[AU])!=(AV&&AV[AU])){var AP=Math.max(t.indexOf(AH((AS||[]),function(AW){return AW[AU];}),AV&&AV[AU]),0);AR.set("selectedIndex",AP);}}AR.updating=false;}function M(AR,AQ,AS,AV){AR.updating=true;if(AQ){if(AS!=null){AR.set("items",AS);}var AU=AR.itemIdField,AT=AR.getSelectedItem();if((AT&&AT[AU])!=(AV&&AV[AU])){var AP=Math.max(t.indexOf(AH((AS||[]),function(AW){return AW[AU];}),AV&&AV[AU]),0);AR.set("selectedIndex",AP);}}AR.updating=false;}function h(AP){return N(X.copy(AP,{insertUnlistedValuesAt:-1,hasDummyLabel:true,postCreate:function(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AS=this.parent,AR=this.response;if((AR&&AR.did)!==AS.lastAttrId){return ;}Q.call(this.parent,AR.fms||[]);},onerr:function(){F(this.parent,q,[K]);}});},update:function AQ(){var Af=this.fmPost,AZ=this,AT=this.parent.parent.parent,AW=AT.model,Ad=AW&&AW["a"+Af],Ab=!!Ad,AV,Aa,Ae,AS=AT.disableElementsBrowsing,AR=Ad&&AS&&AS(Ad);if(Ab){switch(AW.et){case O.AQ:case O.AL:Aa=AW.fm;break;case O.AC:Aa=AW["fm"+Af];break;case O.AE:Aa=AL(AW.fn,1);break;}if(this.lastAttrId!==Ad.did){this.lastAttrId=Ad.did;AV=[];if(this.isFirstFm){if(!AR&&(!Ad.ilk&&(!AT.ets||AT.ets[O.AE]))){if(this.hasDummyLabel){AV.push(AB);}var AY=y[O.AE],Ac=AY&&AY.key,AU=AY.def;AV=AV.concat((Ac&&AT[Ac])||AU||[]);t.forEach(AV,function(Ag){Ag.cls="fn";});}if(this.hasDummyLabel){AV.push(mstrApp.isWSStyling?B:x);}}if(Aa&&(AW.et!==O.AE)){AV.push(Aa);}Ae=this.ajx;Ae.params.attributeId=Ad.did;Ae.params.otp=Ad.t||12;AV.push(q);J.makeObservable(AV);}}if(AR&&AW.et===O.AE){Aa=null;}o(this,Ab,AV,Aa);if(Ab&&Ae){var AX;if(AT.getAttributeForms){AX=AT.getAttributeForms(Ad.did);}else{if(Ad.fms){AX=Ad.fms;}}if(AX&&AX.length>0){Q.call(this,AX);}else{if(Ad&&Ad.t===AO.Consolidation){Q.call(this,[]);}else{if(Ae){s.fetchFormList(Ae,{success:function(Ag){if((Ag&&Ag.did)!==AZ.lastAttrId){return ;}Q.call(AZ,Ag.fms||[]);},failure:Ae.onerror});}}}}}}));}function AG(AP){if(AP&&!X.isEmpty(AP)){var AQ=t.hash(S);X.forEach(AP,function(AS,AR){if(AS){AQ[l[AR]]=true;}});return AQ;}return null;}function m(AP,AQ,AS,AR){AP.updating=true;AP.clearSelect();t.forEach(AQ,function(AT){AT.title=AI.encodeHtmlString(AT.title||AT.n||"");});if(AQ){AP.set("items",AQ);}if(AS&&AS.length){AP.setSelectedItems(AS);}else{if(AR&&AR.length){AP.select(AR);}}AP.updating=false;}function d(AQ,AP,AR,AT,AS){if(AP){m(AQ,AR,AT,AS);}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function w(AT,AP){var AS=!!this.selectedIndices[AP],AV=AT.n,AR=false,AU=AT.ndetype===G.DssRecursiveDerivedElement;if(AT.t===12){var AQ=t.filter(AT.fs,function(AW){return AW.fgr>0;});if(AQ.length>0){AR=true;}}return X.copy({cls:(AS?mstrmojo._IsList.SELECTED_CLS:"")+" "+(AT.css||"")+" "+(AT.t?("t"+AT.t+((AT.da||AT.um)?"d":"")+(AR?"g":"")+(AT.st?(" st"+AT.st+(AU?" nde4ra":"")):"")):""),n:AV||"&nbsp;"},this._super(AT,AP));},onselectionChange:function AD(AP){this._super(AP);b.call(this,AP);}});mstrmojo.rw.ConditionWalkProviderBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProviderBase",browseEs:function c(AS,AR,AU){AS.openPopup("eb",{zIndex:AS.parent.zIndex+10,left:Math.round(AU.x)+"px",top:Math.round(AU.y)+"px"});var AQ=AS.eb.browser,AP=AS.model,AT=AP&&AP.a&&AP.a.did;if(!AT){return ;}AQ.set("attributeID",AT);AQ.set("selectedItems",AP.es?X.clone(AP.es):[]);AQ.initBrowser();},browseObjs:function AF(AW,AP,AQ){AW.openPopup("ob",{zIndex:AW.parent.zIndex+10,left:Math.round(AQ.x)+"px",top:Math.round(AQ.y)+"px"});var AR=AW.ob.browser;AR.target=AP;var AS;switch(AP.alias){case"dmy":AS=[U.TP.ATTR,U.TP.DIM];break;case"c0":case"c1":var AU=AW.model,AT=AU&&AU.et,AX=AU&&AU.fm,AV=AX&&AX.dtp||(AU.m?U.DTP.DECIMAL:U.DTP.UNKNOWN);AS=(AT===O.MQ||AT===O.MC)?[U.TP.METRIC,U.DTP2PROMPT_STP[AV]]:[U.TP.ATTR,U.DTP2PROMPT_STP[AV]];break;default:AS=AG(AW.ets);AS=AS?X.keyarray(AS,true):[U.TP.ATTR,U.TP.METRIC,U.STP.REPORT_GRID,U.STP.REPORT_GRAPH,U.STP.REPORT_ENGINE,U.STP.REPORT_TEXT,U.STP.REPORT_DATAMART,U.STP.REPORT_BASE,U.STP.REPORT_GRIDGRAPH,U.STP.REPORT_NONINTERACTIVE,U.STP.FILTER].concat(S);}AS[AS.length]=U.TP.FOLDER;AR.browse({rootFolderType:AU&&(AU.et===O.MQ||AU.et===O.MC)?5:26,folderLinksContextId:33,onSelectCB:[AW,"onOBSelect"],browsableTypes:AS.join(",")});},});var s=mstrmojo.rw.ConditionWalkProviderBase;s.fetchFormList=e;s.onWalkChange=b;s.replaceItem=F;s.getChildJSON=N;s.walkChildPostCreateFn=u;s.cstJson=j;s.isComparisonAllowed=AK;s.clearInvalid=Z;s.updateCst=L;s.widgetItemFn=n;s.shouldShowCst=H;s.getConstant=a;s.getConstantDataType=I;s.getConstantValue=z;s.isDATE=AN;s.getCstListCompareTgts=f;s.fmJson=h;s.fnItem=AL;s.updateList=o;s.allowedTargetTypes=AG;s.updatePulldown=M;s.onWalkChangeThroughPulldown=R;s.updateListMultiData=m;s.updateListMulti=d;})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.Label","mstrmojo.ListBase","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.elementHelper");var G=mstrmojo.css,Y=mstrmojo.hash,t=mstrmojo.array,X=mstrmojo.expr,M=X.ET,a=X.ET2TGT,Z=X.FN,S=X.FN_MRP,n=X.DTP2FN_DTP,E=mstrmojo.meta.TP,AB=X.TP,J=X.STP,l=mstrmojo.elementHelper,q=mstrmojo.rw.ConditionWalkProviderBase;var P={};P[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};P[M.AL]={target:1,fm:1,fn:1,c0:1};P[M.AE]={target:1,fm:1,es:1};P[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};P[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};P[M.MC]=P[M.MQ];P["*"]={target:1};var x={};x[M.MQ]={key:"metricFns",def:X.METRIC_FNS};x[M.MC]={key:"metricFns",def:X.METRIC_FNS};x[M.AQ]={key:"formFns",def:X.FORM_FNS};x[M.AL]={key:"formFns",def:X.FORM_FNS};x[M.AC]={key:"formFns",def:X.FORM_FNS};x[M.AE]={key:"elemFns",def:X.ELEM_FNS};var AG=mstrmojo.desc(14084,"Select a filter option or a qualification."),AF=mstrmojo.desc(15007,"Choose to select in list or qualify on an attribute form."),AE=mstrmojo.desc(14085,"Select one or more elements."),N=mstrmojo.desc(15009,"Select element(s)."),AD=mstrmojo.desc(14086,"Select an operator."),AC=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),C=mstrmojo.desc(15010,"Enter a specific value or select an attribute form as variable."),AA=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'""'),z=mstrmojo.desc(14089,"Select a condition."),AI=mstrmojo.desc(15011,"Select an operator."),y=mstrmojo.desc(14090,"Enter a value or select a metric from the list."),R=mstrmojo.desc(15012,"Enter a specific value or select a metric as variable.");var k=0,s=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var f="dummy",I={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:f,css:"unselectable"},p={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:f,css:"unselectable"},AH={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:f,css:"unselectable"},w={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:f,css:"unselectable"},D={did:"idWait",v:"idQualification",n:mstrmojo.desc(15008,"Qualify on"),t:f,css:"unselectable"};var c=q.onWalkChange,F=q.replaceItem,L=q.getChildJSON,u=q.walkChildPostCreateFn,o=q.updateList,AM=q.fnItem,AL=q.isComparisonAllowed,i=q.cstJson,g=q.fmJson,e=q.updateListMulti,m=q.updateListMultiData;function j(AN){return AN.targets?t.filter(AN.targets,function(AO){return AO[E]===X.TP.ATTR;}):[];}function K(AN){this.tip.set("text",AN);}var W=[X.STP.PROMPT,X.STP.PROMPT_OBJECTS,X.STP.PROMPT_ELEMENTS,X.STP.PROMPT_EXPRESSION,X.STP.PROMPT_EXPRESSION_DRAFT];var AK=q.allowedTargetTypes;mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function d(AQ,AP,AS){AQ.openPopup("eb",{zIndex:AQ.parent.zIndex+10,left:Math.round(AS.x)+"px",top:Math.round(AS.y)+"px"});var AO=AQ.eb.browser,AN=AQ.model,AR=AN&&AN.a&&AN.a.did;if(!AR){return ;}AO.set("attributeID",AR);AO.set("selectedItems",AN.es?Y.clone(AN.es):[]);AO.initBrowser();},browseObjs:function AJ(AU,AN,AO){AU.openPopup("ob",{zIndex:AU.parent.zIndex+10,left:Math.round(AO.x)+"px",top:Math.round(AO.y)+"px"});var AP=AU.ob.browser;AP.target=AN;var AQ;switch(AN.alias){case"dmy":AQ=[X.TP.ATTR,X.TP.DIM];break;case"c0":case"c1":var AS=AU.model,AR=AS&&AS.et,AV=AS&&AS.fm,AT=AV&&AV.dtp||(AS.m?X.DTP.DECIMAL:X.DTP.UNKNOWN);AQ=(AR===M.MQ||AR===M.MC)?[X.TP.METRIC,X.DTP2PROMPT_STP[AT]]:[X.TP.ATTR,X.DTP2PROMPT_STP[AT]];break;default:AQ=AK(AU.ets);AQ=AQ?Y.keyarray(AQ,true):[X.TP.ATTR,X.TP.METRIC,X.STP.REPORT_GRID,X.STP.REPORT_GRAPH,X.STP.REPORT_ENGINE,X.STP.REPORT_TEXT,X.STP.REPORT_DATAMART,X.STP.REPORT_BASE,X.STP.REPORT_GRIDGRAPH,X.STP.REPORT_NONINTERACTIVE,X.STP.FILTER].concat(W);}AQ[AQ.length]=X.TP.FOLDER;AP.browse({rootFolderType:AS&&(AS.et===M.MQ||AS.et===M.MC)?5:26,folderLinksContextId:33,onSelectCB:[AU,"onOBSelect"],browsableTypes:AQ.join(",")});},getFm2NodeProps:function U(){return{alias:"fm2",children:[g({alias:"fm2",fmPost:2})],updateColumnContainer:function AN(){var AO=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.fm2.update();K.call(AO,AA);H.call(this);}};},getC0NodeProps:function Q(){var AN=this;return{alias:"c0",c1Selected:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},i({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},i({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function AO(){this.c0.update();var AY=this.parent,AU=AY.parent,AT=AY.parent.model,AW=AT&&AT.fn,AQ=AW===Z.BETWEEN||AW===Z.NOT_BETWEEN||AW===S.BETWEEN||AW===S.BETWEEN_DESCENDING,AV=AW===Z.EQUAL||AW===Z.NOT_EQUAL||AW===Z.GREATER||AW===Z.GREATER_EQUAL||AW===Z.LESS||AW===Z.LESS_EQUAL,AX=this.idx,AS=this.next;this.browseLink.set("visible",AU.objectBrowsingEnabled&&AL(AT,AU.ets));this.btwn.set("visible",AQ);this.c1.set("visible",AQ);if(AQ){this.c1.update();}else{AT.edit("c1",{v:null,dtp:null,skipET:true},true);}if(AT.a2&&AV){if(!(AS&&AS.fm2)){AY.insertAndRemoveTrailing(AX,AN.getFm2NodeProps());}}else{AY.removeTrailingContainer(AX);}var AR=mstrApp.isWSStyling?C:AC,AP=mstrApp.isWSStyling?R:y;K.call(AU,AT.a?AR:AT.m?AP:"");if((!AT.a)&&AT.m&&this.domNode){G.addClass(this.domNode,"lastStage");}H.call(this);}};},getFnNodeProps:function b(){var AN=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},g({alias:"fn",allowUnlistedValues:false,update:function(){var AU=this.parent.parent.parent,AQ=AU.model||{},AV=AQ.et,AT,AW=false,AX,AP;switch(AV){case M.AE:AW=!!AQ.a;break;case M.AQ:case M.AC:case M.AL:AW=!!(AQ.fm&&AQ.fm.did);AT=AW?AQ.fm.dtp:null;break;case M.MQ:case M.MC:AW=!!AQ.m;AT=AW?X.METRIC_DTP:null;break;}if(AW){var AY=n[AT];if((this.lastEt!==AV)||(this.lastFnDtp!==AY)){this.lastEt=AV;this.lastFnDtp=AY;var AS=AV?x[AV]:null,AR=AS&&AS.key;AX=(AR&&AU[AR])||AS.def||[];if(typeof (AX)==="object"){AX=AX[AY]||AX["*"];}}AP=AM(AQ.fn,AQ.fnt||1);}o(this,AW,AX,AP);this.parent.updateScrollbars();}})],updateColumnContainer:function AO(){this.fn.update();var AP=this.parent,AQ=AP.parent,AR=AQ.model,AT=AR&&AR.fn,AS=this.next,AV=AT===Z.IS_NULL||AT===Z.IS_NOT_NULL;if(AT&&AV){AP.removeTrailingContainer(this.idx);}else{if(AT&&!(AS&&AS.c0)){AP.insertAndRemoveTrailing(this.idx,AN.getC0NodeProps());}}var AU=mstrApp.isWSStyling?AI:z;K.call(AQ,AR.a?AD:AR.m?AU:"");AS=this.next;if(AS){AS.updateColumnContainer();}}};},getEsNodeProps:function B(){var AP=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function AO(){u.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Aa=this.parent,AU=this.response;if((AU&&AU.did)!==Aa.lastAttrId){return ;}var AW=(AU&&AU.es)?t.filter(AU.es,function(Ab){return !l.isNullElem(Ab.v);}):[],AZ=Aa.parent.parent.parent.model&&Aa.parent.parent.parent.model.es,AX=function(Ah,Ac){var Ag=Ah&&Ah.length||0,Af=Ac&&Ac.length||0,Ab=[],Ae,Ad;for(Ae=0;Ae<Af;Ae++){for(Ad=0;Ad<Ag;Ad++){if(Ac[Ae].n===Ah[Ad].n){break;}}if(Ad===Ag){Ab.push(Ac[Ae]);}}return Ab;},AY=function(Ab,Ac,Af){var Ae=[],Ad;t.forEach(Ab,function(Ag){Ad=t.filterOne(Ac,function(Ah){return Ag[Af]&&Ah[Af]&&Ag[Af]===Ah[Af];});if(Ad){Ae.push(Ad);}});return Ae.length===Ab.length?Ae:Ab;};AZ=AZ&&AY(AZ,AW,"v");if(Aa.allowUnlistedValues){var AV=AX(AW,AZ);AW=(Aa.insertUnlistedValuesAt===0)?AV.concat(AW):AW.concat(AV);}m(Aa,AW,AZ,null);Aa.parent.updateScrollbars();},onerr:function(){F(this.parent,p,[I]);}});},onselectionChange:function AS(AU){mstrmojo.ListBase.prototype.onselectionChange.call(this,AU);c.call(this,AU);},update:function AR(){var AX=this.parent.parent.parent,AW=AX.model,Ab=AW&&AW.a,Ac=!!Ab&&!Ab.ilk,Ad,AU,Aa,AY,AV,Ae;if(Ac){if(this.lastAttrId!==Ab.did){this.lastAttrId=Ab.did;Ad=AW.es;AY=Ad&&Ad.length;Ad=AY?Ad.concat():[];Ad.push(p);if(AY){Aa=[];for(AV=1;AV<=AY;AV++){Aa[AV]=AV;}}Ae=this.ajx;AX.updateBrowseElementsParams(Ae.params,Ab);}else{AU=AW.es;}}e(this,Ac,Ad,AU,Aa);if(Ac&&Ae){if(AX.getElements){var AZ=this;AX.getElements(Ab,{success:function(Af){m(AZ,Af.es||[],AX.model&&AX.model.es,null);AZ.parent.updateScrollbars();},failure:function(){F(AZ,p,[I]);}});}else{Ae.send();}}},setupScrollNodes:function AQ(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){AP.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function AN(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:AP,updateList:function(AU){e(this.es,true,AU,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function AT(){var AU=this.parent.parent;if(this.domNode){G.addClass(this.domNode,"lastStage");}this.es.update();K.call(AU,mstrApp.isWSStyling?N:AE);}};},getFmNodeProps:function O(){var AN=this;return{alias:"fm",children:[g({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function AO(){this.fm.update();var AY=this.parent,AT=AY.parent,AS=AT.model,AV=AS&&AS.fm,AX=this.idx,AW=AS&&AS.a,AQ=AT.disableElementsBrowsing,AP=AW&&AQ&&AQ(AW);var AU=(AS.etWas&&AS.etWas===M.AE)?s:k,AR=k;if(AS.et===M.AE&&!AP){AR=s;}if(AU!==AR||AR===k){AY.removeTrailingContainer(AX);if(AR===k&&AV){AY.addNextColumn(AN.getFnNodeProps());}else{if(AR===s){AY.addNextColumn(AN.getEsNodeProps());}}}K.call(AT,mstrApp.isWSStyling?AF:AG);H.call(this);}};},getTargetNodeProps:function h(){var AN=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(AQ){if(AQ.st===J.FILTER||AQ.t===AB.REPORT||AQ.t===AB.PROMPT){this.parent.parent.parent.onOK();}},update:function AP(){var AR=this.parent.parent.parent,AS=AR.model,AV=AR.targetsLastMod,AW=AS&&AS.et;if(this.lastModel!==AS||this.targetsLastMod!==AV){this.lastModel=AS;this.targetsLastMod=AV;var AQ=AR.targets,AX=AR.ets;if(AX&&AQ&&AQ.length){var AU=AK(AR.ets);AQ=t.filter(AQ,function(AY){return AU[AY[E]];});}var AT=AS&&AS[a[AW]];o(this,true,X.getSortedObjectsByTypeGroup(AQ),AT);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function AO(){this.target.update();var AR=this.parent,AS=AR.parent,AT=AS.model,AV=AT&&AT.et,AQ=this.idx,AU=this.next;this.browseLink.set("visible",AS.objectBrowsingEnabled);if(AV){switch(AV){case M.AQ:case M.AL:case M.AC:case M.AE:if(AT.a&&!(AU&&AU.fm)){this.parent.insertAndRemoveTrailing(AQ,AN.getFmNodeProps());}break;case M.MQ:case M.MC:if(AT.m&&!(AU&&AU.fn)){this.parent.insertAndRemoveTrailing(AQ,AN.getFnNodeProps());}break;case M.R:case M.F:case M.XML:this.parent.removeTrailingContainer(AQ);break;}}AU=this.next;if(AU){AU.updateColumnContainer();}}};}});var A=mstrmojo.rw.ConditionWalkProvider;A.setTip=K;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.Box","mstrmojo.Label");var F=mstrmojo.hash,H=mstrmojo.array;var D="white-space: nowrap; margin-right:9px;";mstrmojo.ui.editors.controls.PopupControlUtils=mstrmojo.provide("mstrmojo.ui.editors.controls.PopupControlUtils",{getRowContainer:function C(J,I,K){J=J||[];I=I||"";K=K||"";H.forEach(J,function(L){L.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:I,cssText:K,children:J};},getLabelBox:function G(I,J){return new mstrmojo.Box({children:I||[],cssText:J});},getLabelAndControlBox:function A(N,O,P,I,J){var K=new mstrmojo.Label({text:N}),M=this.getLabelBox(K,J||D);var L=P?[O,M]:[M,O];return this.getRowContainer(L,I);},getFillConfigComp:function E(K,L,I,J){F.copy({cssClass:"mstrmojo-ui-ToolBarFillGroup",height:null,colorPickerHostWithin:true},L);var M=new mstrmojo.ui.editors.controls.FillConfigGroup(L);if(I){I(M);}if(typeof K==="string"){return this.getLabelAndControlBox(K,M,false,(L||[]).rowContainerCSSClass,J);}return M;},getLineConfigComp:function B(K,L,I,J){F.copy({cssClass:"mstrmojo-ui-ToolBarLineGroup",layoutConfig:null,height:null,width:L.width,showNoFillInColor:!!L.showNoFill},L);var M=new mstrmojo.ui.editors.controls.LineConfigGroup(L);if(I){I(M);}if(typeof K==="string"){return this.getLabelAndControlBox(K,M,false,(L||[]).rowContainerCSSClass,J);}return M;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.ToolbarPopup","mstrmojo.ui.editors._HostsControls","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.models.FormatModel","mstrmojo.css");var B=mstrmojo.models.FormatModel;mstrmojo.ui.editors.CharacterToolbarPopup=mstrmojo.declare(mstrmojo.ui.editors.ToolbarPopup,[mstrmojo.ui.editors._HostsControls,mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.CharacterToolbarPopup",textAlignJustify:true,textAlignValueMap:null,textAlignFmtName:mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.TEXT_ALIGN,btnTextAlign:null,init:function D(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var K=this.textAlignJustify,H=this,F=function(P,Q,O){H.raiseFormatValueChange(P,Q,O);},L=this.getHCGControls(F),J=L.fontFamily,N=L.fontSize,G=L.fontColor,M={alias:"btnTextAlign",includeJustify:K,onValueChange:function(P,O){F(H.textAlignFmtName,P,O);}};J.width="125px";N.width="50px";G.width="50px";this.width=K?"505px":"476px";var E=this.textAlignValueMap;if(E){M.itemsValueMap=E;}this.addChildren([J,L.fontStyle,N,G,new mstrmojo.vi.ui.TextAlignButtonBar(M)]);},shouldPropagateLockHover:function C(){return false;},setFormatSource:function A(E){this._super(E);this.syncControls(function(){if(this.textAlignFmtName in E){this.btnTextAlign.singleSelectByField(E[this.textAlignFmtName],"v");}else{this.btnTextAlign.singleSelectByField(B.getFormatBlockValue(E,B.ENUM_PROPERTY_NAMES.TEXT_ALIGN),"id");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fontSizeColorRow",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.func","mstrmojo.locales","mstrmojo.num","mstrmojo.string","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo._FormatDefinition","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.enums.EnumFeatures","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.MetricToken","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var N=mstrmojo.array,AX=mstrmojo.css,AE=mstrmojo.dom,S=mstrmojo.hash,c=mstrmojo.string,f=mstrmojo.mstr.EnumFunction,C=mstrmojo.Button.newWebButton,w=mstrmojo.ME.MetricToken.brackets,n=mstrmojo.ME.MetricToken.argDelimiter,M=mstrmojo._FormatDefinition,Z=mstrmojo.models.datasets.DataInterface,W=mstrmojo.vi.models.VIComponentMap.TYPES,AB=mstrmojo.chart.model.enums.EnumDSSObjectType,AN=mstrmojo.mstr.EnumDSSXMLBaseFormType,e=mstrmojo.mstr.EnumDSSXMLObjectTypes,AI=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,F=mstrmojo.mstr.EnumDSSConsolidationType;var a={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},d={SUM:{n:a.SUM,t:f.FunctionSum},ADD:{n:a.ADD,t:f.FunctionPlus},AVG:{n:a.AVG,t:f.FunctionAvg},MAX:{n:a.MAX,t:f.FunctionMax},GST:{n:a.GST,t:f.FunctionGreatest},MIN:{n:a.MIN,t:f.FunctionMin},LST:{n:a.LST,t:f.FunctionLeast},TMS:{n:a.MTP,t:f.FunctionTimes},CNT:{n:a.CNT,t:f.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:f.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:f.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:f.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:f.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:f.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:f.FunctionVar}},l=[{n:a.SUM,t:f.FunctionOLAPSum},{n:a.AVG,t:f.FunctionOLAPAvg},{n:a.MIN,t:f.FunctionOLAPMin},{n:a.MAX,t:f.FunctionOLAPMax},{n:a.CNT,t:f.FunctionOLAPCount}],AD=[{n:a.SUM,t:f.FunctionOLAPSum},{n:a.AVG,t:f.FunctionOLAPAvg},{n:a.MIN,t:f.FunctionOLAPMin},{n:a.MAX,t:f.FunctionOLAPMax},{n:a.CNT,t:f.FunctionOLAPCount}],AS=[{n:mstrmojo.desc(1058,"Previous"),t:f.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:f.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:f.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:f.FunctionLast}];var t={YEAR:"Year",QUARTER:"Quarter",CONCAT:"Concat",QUARTERSTARTDATE:"QuarterStartDate",MONTH:"Month",TOSTRING:"ToString",MONTHSTARTDATE:"MonthStartDate",WEEK:"Week",WEEKSTARTDATE:"WeekStartDate",DAYOFMONTH:"DayOfMonth",DAYOFWEEK:"DayOfWeek",DAYOFYEAR:"DayOfYear"};var AQ={};AQ[t.YEAR]="6F7DF5F8449111D5BEA300B0D01A55EF";AQ[t.QUARTER]="6F7DF5F7449111D5BEA300B0D01A55EF";AQ[t.CONCAT]="6F7DF5FF449111D5BEA300B0D01A55EF";AQ[t.QUARTERSTARTDATE]="59E10CE2ADDD4A6DAC2416A72999A9ED";AQ[t.MONTH]="6F7DF5F6449111D5BEA300B0D01A55EF";AQ[t.TOSTRING]="D1ED29645DEC4DBF99E8E09ED939074B";AQ[t.MONTHSTARTDATE]="7C63D4E70B2741C3A5B54A2EFD40961B";AQ[t.WEEK]="6F7DF5F5449111D5BEA300B0D01A55EF";AQ[t.WEEKSTARTDATE]="44681336D0DB4E43AC333FFB3CC4400D";AQ[t.DAYOFMONTH]="6F7DF5F2449111D5BEA300B0D01A55EF";AQ[t.DAYOFWEEK]="6F7DF5F3449111D5BEA300B0D01A55EF";AQ[t.DAYOFYEAR]="6F7DF5F4449111D5BEA300B0D01A55EF";var AM="@form";function H(Ac){var Ae=8,Af=1,Ab=N.find(Ac.fs,"idf",true);if(Ab===-1){return null;}var Ad=Ac.fs[Ab];return((Ac.da||Ad.obf)&&(Ad.bftp===Ae||Ad.bftp===Af))?Ad:null;}var AZ={Year:{ID:[t.YEAR,"(",AM,")"]},Quarter:{ID:[t.YEAR,"(",AM,") * 10 + ",t.QUARTER,"(",AM,")"],DESC:[t.CONCAT,'("Q"',n,t.QUARTER,"(",AM,")",n,' ", "',n,t.YEAR,"(",AM,"))"],DATE:[t.QUARTERSTARTDATE,"(",AM,")"]},QuarterOfYear:{ID:[t.QUARTER,"(",AM,")"],DESC:[t.CONCAT,'("Q"',n,"This@ID)"]},Month:{ID:[t.YEAR,"(",AM,") * 100 + ",t.MONTH,"(",AM,")"],DESC:[t.TOSTRING,'<Pattern="mmm yyyy">(',AM,")"],DATE:[t.MONTHSTARTDATE,"(",AM,")"]},MonthOfYear:{ID:[t.MONTH,"(",AM,")"],DESC:[t.TOSTRING,'<Pattern="mmmm">(',AM,")"]},Week:{ID:[t.YEAR,"(",AM,") * 100 + ",t.WEEK,"(",AM,")"],DESC:[t.CONCAT,'("W"',n,t.WEEK,"(",AM,")",n,' ", "',n,t.YEAR,"(",AM,"))"],DATE:[t.WEEKSTARTDATE,"(",AM,")"]},WeekOfYear:{ID:[t.WEEK,"(",AM,")"]},DayOfMonth:{ID:[t.DAYOFMONTH,"(",AM,")"]},DayOfWeek:{ID:[t.DAYOFWEEK,"(",AM,")"],DESC:[t.TOSTRING,'<Pattern="ddd">(',AM,")"]},DayOfYear:{ID:[t.DAYOFYEAR,"(",AM,")"]}};function AA(Ad,Af,Ae,Ab){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:Ad,selectedIndex:Af,onitemSelected:function Ac(Ag){var Ah=this.parent;while(!Ah.data||!Ah.data[Ae]){Ah=Ah.parent;}Ah.data.set(Ae,Ab?Ab(Ag):Ag.v);}};}function Aa(Ad,Ac,Ab){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:"),cssClass:"menu-info-text"},S.copy(Ab,AA(Ad,Ac,"breakBy",function(Ae){return{id:Ae.did,type:Ae.t,dmy:Ae.dmy};}))]};}function O(Ae){var Af=Ae.metrics,Ag=Ae.propName,Ad=Ae.optionValueField||"id",Ab=N.find(Af,Ad,Ae.value),Ah=function Ah(Aj){var Ai=this.parent;while(!Ai.data||!Ai.data.hasOwnProperty(Ag)){Ai=Ai.parent;}Ai.data.set(Ag,Aj?{id:Aj[Ad],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,cssClass:"Calculation-PullDown",items:Af,selectedIndex:Ab,useRichTooltip:true,bindings:Ae.bindings,valid:true,allowCustomText:true,allowEmptyText:true,allowHTML:false,onvalidChange:function Ac(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:Ah,onTextEditComplete:function(){Ah.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:Ae.postkeyup};}function p(Ae,Ad,Ac){if(Ae&&Ae.datap){var Ab=N.filterOne(Ae.datap,function(Ag){return Ag.tbid===Ad;}),Af=Ab&&Ab.maps.amps;return N.filterOne(Af,function(Ag){return Ac===Ag.aimp.atid;});}return null;}function y(Ab,Af){var Ad=N.filterOne(Ab&&Ab.afmps,function(Ag){return Ag.fmid===Af;}),Ae=Ad&&(Ad.sqc?Ad:Ad.col.oi),Ac;if(Ae&&Ae.sqc){Ac={did:Ae.sqc.id,n:c.decodeHtmlString(Ae.cln),coldtp:Ae.sqc.dt.tp,georole:Ae.geo,timerole:Ae.tim,der:Ae.sqc.der};}else{if(Ae){Ac={did:Ae.did,n:c.decodeHtmlString(Ae.def.cln),coldtp:Ae.def.dt.tp,georole:Ad.geo,timerole:Ae.def.dicl.time,der:Ae.def.dicl.der};}}return Ac;}function AP(Ad,Ac,Af){var Ae={success:function(Ag){if(Ag&&Ag.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:Ag.msgid,bindingflag:2,previewflag:261,browsetype:5},Af);}},failure:function(Ag){mstrApp.onerror(Ag);}};var Ab=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:Ac,messageID:Ad,skipRebuild:Ab},Ae);}function U(Ag,Ah,Ae){var Ac=Ag.srcTableId,Aj=Ag.tgtTableId,Ab,Af,Ad=function(An,Am){var Ap="<mpcs><mpc ",Al,Ao;for(Al in Am){Ao=Am[Al];Ap+='$ACT="$VAL" '.replace("$ACT",Al).replace("$VAL",Ao);}Ap+="/></mpcs>";return{act:"changeEMMAMapping",tbid:An,dsid:Ag.dsid,mapping:Ap};},Ai=function(){var Al=[],Ao={},Am,An;if(!Ab||!Af){return ;}Ao[Ac]={};Ao[Aj]={};N.forEach(Ab.afmps,function(As){var Aq=N.find(Af.afmps,"fmid",As.fmid),At,Ar,Ap;if(Aq>=0){Am=y(Ab,As.fmid);An=y(Af,As.fmid);if(Am.georole!==An.georole){Ap=(Am.georole===0)?Ac:Aj;At=(Am.georole===0)?Am.did:An.did;Ar=Am.georole||An.georole;Ao[Ap][At]=S.copy({did:At,georole:Ar},Ao[Ap][At]);}if(Am.timerole!==An.timerole){Ap=(Am.timerole===0)?Ac:Aj;At=(Am.timerole===0)?Am.did:An.did;Ar=Am.timerole||An.timerole;Ao[Ap][At]=S.copy({did:At,timerole:Ar},Ao[Ap][At]);}if(Am.der!==An.der){Ar=Am.der|An.der;Ao[Ac][Am.did]=S.copy({did:Am.did,drvflg:Ar},Ao[Ac][Am.did]);Ao[Aj][An.did]=S.copy({did:An.did,drvflg:Ar},Ao[Aj][An.did]);}}});S.forEach(Ao,function(Ap,Aq){S.forEach(Ap,function(Ar){Al.push(Ad(Aq,Ar));});});Am=y(Ab,Ab.afmps[0].fmid);Al.push(Ad(Ac,{did:Am.did,oid:Af.aimp.atid}));if(Ae){Ae(Al);}},Ak=function(An){var Ao={success:function(){Ai();}},Am,Al;Ab=p(An,Ac,Ag.srcId);Af=p(An,Aj,Ag.tgtId);Am=y(Ab,Ab.afmps[0].fmid);Al=[Ad(Ac,{did:Am.did,oid:Af.aimp.atid,fg:1})];Ah.getDataService().submitUpdates(Al,Ao);};AP(Ah.mid,Ag.dsid,{success:Ak});}function AO(Ag,Ad,Ac,Ah){var Ab=0,Af=[],Ae=function(Ai){var Aj=Ac[Ab-1];if(Ai&&Ai.tks&&Aj){Af.push({fid:Aj.fid,fnm:Aj.fnm,ftk:Ai.tks.items});}if(Ab===Ac.length){Ah(Af);return ;}Aj=Ac[Ab++];mstrmojo.ME.MetricDataService.validateMetric({metricId:Ad,formID:Aj.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:Ag},{success:Ae});};Ae();}function AV(Ab,Ac){return{v:w(Ab.n)+"@"+w(Ac.fnm),tp:275,lv:1,exv:Ac.fid,extp:8,oi:{did:Ab.did,t:Ab.t,n:Ab.n}};}function X(Ac){var Ae=(Ac.t===e.Filter||Ac.t===e.Consolidation),Ad=(Ac.t===e.Attribute&&Ac.de),Ab=(Ac.t===e.Consolidation&&Ac.st===AI.ConsolidationManaged);return !!(Ae&&!Ab||Ad);}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function K(Ab){return{"12":[[d.AVG,d.CNT,d.MAX,d.MIN,d.STD,d.SUM,d.VAR]],"4":[[d.SUM,d.AVG,d.MIN,d.MAX,d.CNT],[d.GEM,d.MED,d.MOD,d.PDT,d.STD,d.VAR]]}[Ab.t];},isAmongFunctions:function q(Ac,Ab){return Ab.some(function(Ad){return Ad.some(function(Ae){return Ae.t===Ac;});});},getMultiSelectionShortcutMetricFunctions:function m(Ab){var Ac=true;N.forEach(Ab,function(Ad){if(4!==Ad.t){Ac=false;return false;}return true;});return Ac?[d.ADD,d.AVG,d.GST,d.LST,d.TMS]:[];},getRelativeReferenceMenu:function R(Af,Ad,Ai,Ab){var Ae=0,Ac=AS[Ae],Ah=0,Ag=Ai&&Ai[Ah];return new mstrmojo.ui.menus.EditorConfig({data:{item:Af,relativeRef:Ac,breakBy:Ag},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:Ad&&Ad.length,text:Ad,cssClass:"menu-info-text"},S.copy({cssClass:"RelativeReferencePullDown"},AA(AS,Ae,"relativeRef",function(Aj){return Aj.t;}))]},Aa(Ai,Ah,{cssClass:"RelativeReferencePullDown"})],fnOk:function(Aj){return Ab(Aj.item,Aj.relativeRef,[Aj.breakBy]);}});},getMovingTotalMenu:function AR(Al,Af,Ah){var Am=1,Ae=AD[Am].t,Ag=1,Ac=mstrmojo.desc(13289,"Starting previous##rows").split("##"),Ak=0,Ad=Af&&Af[Ak];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:Al,funcType:Ae,windowSize:Ag,breakBy:Ad},contents:[S.copy({cssClass:"MovingTotalPullDown"},AA(AD,Am,"funcType",function(An){return An.t;})),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix menu-info-text",text:Ac[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function Aj(){this.set("value",Ag);},_ontooltipover:function(){var An=mstrmojo.all[this.id];An._hovered=true;An.showTooltip();},_ontooltipout:function(){var An=mstrmojo.all[this.id];An._hovered=false;An.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var An=this.validationStatus.msg,Ao=!(this.richTooltip&&An===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:An};if(this._hovered&&Ao){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function Ai(){var An=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",An?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix menu-info-text",text:Ac[1]}]},Aa(Af,Ak,{cssClass:"MovingTotalPullDown BreakByBox"})],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function Ab(An){if(Ah){Ah(Al,An.funcType,An.windowSize,[An.breakBy]);}}});},getRunningTotalMenu:function x(Ae,Ah,Ac){var Ad=0,Ab=l[Ad].t,Ag=0,Af=Ah&&Ah[Ag];return new mstrmojo.ui.menus.EditorConfig({data:{item:Ae,func:Ab,breakBy:Af},cssClass:"RunningTotal-MenuEditor",contents:[S.copy({cssClass:"RunningTotalPullDown"},AA(l,Ad,"func",function(Ai){return Ai.t;})),Aa(Ah,Ag,{cssClass:"RunningTotalPullDown BreakByBox"})],fnOk:function(Ai){return Ac(Ai.item,Ai.func,[Ai.breakBy]);}});},getRankMetricEditor:function Q(Af,Ai,Ad){var Ab=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],Ac=0,Ae=Ab[Ac].v,Ah=0,Ag=Ai&&Ai[Ah];return new mstrmojo.ui.menus.EditorConfig({data:{item:Af,order:Ae,breakBy:Ag},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:"),cssClass:"menu-info-text"},S.copy({cssClass:"NewRankMetricPullDown"},AA(Ab,Ac,"order"))]},Aa(Ai,Ah,{cssClass:"NewRankMetricPullDown"})],fnOk:function(Aj){return Ad(Aj.item,Aj.order,[Aj.breakBy]);}});},insertAddUnitToFilterMenu:function AU(Ag,Ac,Ab){var Ae=this,Ad=mstrmojo.desc(2022,"Add to Filter"),Af=N.ensureArray(Ab).filter(function(Ah){return Ae.isValidAddToFP(Ac,Ah);});if(Af.length>0){Ag.addMenuItem(Ad,"",function(){Ac.addFilterStackSelectors(Af);});}else{Ag.addDisabledMenuItem(Ad,"");}},isValidAddToFP:function AY(Ac,Ah,Aj){var Ad=Ac.controller.view.builder,Af=Ad.getLayoutVIMap(Ac.getCurrentLayoutKey()),Ag=Af.getComponent(W.FILTER_STACK),Ai=true;if(!Aj){Ai=(!Ag||N.find(Ag.getFilterDefinitions(),"srcid",Ah.did)===-1);}if(Ai&&Ah.lock){var Ae=Ah.fs||[],Ab;Ai=false;for(Ab=0;Ab<Ae.length;Ab++){if(Ae[Ab].iidx){Ai=true;break;}}}return Ai;},renameItem:function AW(Ag,Aj,Ac,Ae){var Af=Ag.mstrmojoId,Ai=mstrmojo.dom.findWidget(Ag);Ae=Ae||{};if(!Af){var Ah=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,editOnTwoClicks:true,text:Aj.n,title:Aj.dsc||"",allowEmptyText:Ae.allowEmptyText,allowTrimming:Ae.allowTrimming||false,cssClass:Ae.cssClass||"",placeholder:Ag,onTextEditComplete:function Ab(Ak){if(Ak){return Ac(this);}},onmousedown:function Ad(Ak){if(this.isEditing){Ak.cancel();}}});if(Ai&&Ai.draggable){Ah.parent=Ai;}Ah.render();Af=Ah.id;}mstrmojo.all[Af].set("isEditing",true);return mstrmojo.all[Af];},getMultipleMetricsCalculationMenus:function AT(Ai,Ab,Al){var Ah=new mstrmojo.ui.menus.MenuConfig(),An=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(Ai),Af=function(Ap,Aq,Ao){return{dsid:Ab,funcType:Aq,funcType2:Ao,items:Ap};};Ah.useTooltip=true;An.forEach(function(Ao){Ah.addMenuItem(Ao.n,"",function(){Al(Af(Ai,Ao.t));});});if(Ai.length===2){var Ag=mstrmojo.mstr.EnumFunction,Ae=Ag.FunctionDivide,Ac=Ag.FunctionMinus,Ak=Ai[0],Aj=Ai[1],Am=function(As,Aq,Ao,Ar,Ap){Ah.addMenuItem(As,"",function(){Al(Af([Aq,Ao],Ar,Ap));});},Ad=[{n:function(Ap,Ao){return Ap.n+"/"+Ao.n;},fn:Ae},{n:function(Ap,Ao){return Ap.n+"-"+Ao.n;},fn:Ac},{n:function(Ap,Ao){return"("+Ap.n+"-"+Ao.n+")/"+Ao.n;},fn:Ac,fn2:Ae}];Ad.forEach(function(Ao){Ah.addSeparator();Am(Ao.n(Ak,Aj),Ak,Aj,Ao.fn,Ao.fn2);Am(Ao.n(Aj,Ak),Aj,Ak,Ao.fn,Ao.fn2);});}return Ah;},getCalculationMetricEditor:function j(Aj,Ak,Ai){var Ad=[{n:"",css:"operator-plus",funcType:f.FunctionPlus},{n:"",css:"operator-minus",funcType:f.FunctionMinus},{n:"",css:"operator-multiply",funcType:f.FunctionTimes},{n:"",css:"operator-divide",funcType:f.FunctionDivide},{n:!mstrApp.isWSStyling?"%":"",css:"operator-percent-diff",funcType:f.FunctionMinus,funcType2:f.FunctionDivide}],Ae={m1:Ak.did,m2:Aj[0].did,operator:f.FunctionPlus,u1:{id:Ak.did,type:4},u2:null},Ac=function(Al){return{}.hasOwnProperty.call(Al,"cst");},Ah=function(Al){return typeof Al==="string"&&!!Al.length&&!isNaN(Number(Al));};var Ab="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",Ag=function Ag(){var Al=this.parent.popupConfig;if(Al){Al.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[O({metrics:Aj,value:Ae.m1,propName:"u1",optionValueField:"did",bindings:{valid:Ab},postkeyup:Ag}),{scriptClass:"mstrmojo.ButtonListHoriz",items:Ad,selectedIndex:0,postselectionChange:function Af(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},O({metrics:Aj,value:null,propName:"u2",optionValueField:"did",bindings:{valid:Ab},postkeyup:Ag})],data:Ae,okEnabled:false,bindings:{valid:function(){var An=this.data.u1,Am=this.data.u2,Ao=this.data.operator;if(!An||!Am||!Ao){return false;}var Al=!(Ac(An)&&Ac(Am))&&(!Ac(An)||Ah(An.cst))&&(!Ac(Am)||Ah(Am.cst));this.set("okEnabled",Al);return Al;}},fnOk:function(Al){return Ai(Al.u1,Al.u2,Al.operator,Al.operator2);}});},getCfgForAddUnitFromAllObject:function(Ab,Ac){var Ad=null,Ae=null,Af=[],Ag=function(Ah,Ai){if(!Ai){return false;}return N.find((Ai.att||[]).concat(Ai.mx||[]),"did",Ah.did)>-1;};S.forEach(Ac,function(Ai,Ah){if(Ai.idd){Ad=Ah;Ae=Ai;return false;}return true;});if(!Ad){Ad="$GUID_141";Af.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[Ad]});}N.forEach(Ab,function(Ah){if(!Ag(Ah,Ae)){Af.push({act:"addUnitToDataset",dsid:Ad,unitId:Ah.did,unitType:Ah.t});}});return{actions:Af,dsid:Ad};},getAggregateByMenu:function h(Ag,Ae){var Ac=new mstrmojo.ui.menus.MenuConfig(),Ad=function(Ak,Aj){var Am,Al;if(Aj){var Ai=Ak.mexp.args[0];Am=Ai.did;Al=Ai.t;}else{Am=Ak.did;Al=Ak.t;}return{did:Am,t:Al};},Ab=this.getAvailableShortcutMetricFunctionsGroup(Ag),Ah=Ag.mexp?Ag.mexp.ft:null,Af=Ag.mexp&&this.isAmongFunctions(Ah,Ab);Ab.forEach(function(Ai,Aj){if(Aj!==0){Ac.addSeparator();}Ai.forEach(function(Ak){Ac.addMenuItem(Ak.n,"",function(){Ae(Ad(Ag,Af),Ak.t);});});});return Ac;},showObjectPicker:function A(Ag,Ac,Ae,Ad,Ab,Af,Ai){var Ah="object_picker";return function(){var Aj=mstrmojo.all[Ah];if(Aj){Aj.destroy();}Aj=new mstrmojo.vi.ui.editors.ObjectPicker({id:Ah,searchVisible:Af});if(Ac){Aj.supportedTypes=N.hash(Ac);Aj.ob.browsableTypes="8,"+Ac.join(",");}if(Ab){Aj.ob.rootFolderID=Ab;}if(!Ai){Aj.ob.folderLinksContextId=Ae;}Aj.ob.browsableViewMedias=Ad;Aj.render();Aj.OKFn=Ag||mstrmojo.emptyFn;Aj.open();};},getObjectPicker:function G(){var Ab="object_picker";return mstrmojo.all[Ab];},generateNumberFormat:function Y(Ag){var Ab=M.DefaultFormat.FormattingNumber,Ac=M.NumberFormatCategory,Ae=Ag||{},Ad=Ae.nct,Af=Ad===Ac.General&&Ae.nfs==="General";return{category:(Ad===undefined||Af)?Ac.Automatic:Ad,decimalPlaces:Ae.ndp===undefined?2:Ae.ndp,thousandSeparator:Ae.nth===undefined?parseInt(Ab.ThousandSeparator,10):(Ae.nth?-1:0),currencySymbol:Ae.ncs||Ab.CurrencySymbol,currencyPosition:Ae.ncp||Ab.CurrencyPosition,format:Ae.nfs||"",negativeNumbers:Ae.nnn||Ab.NegativeNumbers};},getNumberFormatEditor:function s(Ae,Ad,Ac){var Ab=this.generateNumberFormat(Ad),Af=S.clone(Ab),Ah=S.clone(Ab);return new mstrmojo.ui.menus.EditorConfig({data:Af,bindings:{okEnabled:function(){return !(this.data.category===Ah.category&&this.data.format===Ah.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:Ab,myData:Af,oldData:Ah,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function Ag(Ai){if(!(Ai.category===Ah.category&&Ai.format===Ah.format)){return Ac(Ai,Ah);}}});},getHighlightElementHandler:function(Ad,Ac,Ab){return function(){AX.toggleClass(Ac,Ab||"open",Ad);};},getConfDataTypeMenuCfg:function o(Ab,Aw,Ao,BA){var A5="ToString",Av="ToNumber",At="ToDateTime",An="keepOriginal",Ae="Default",A6={ToString:AN.DssXmlBaseFormText,ToNumber:AN.DssXmlBaseFormNumber,ToDateTime:AN.DssXmlBaseFormDate},Aj={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},Ah="_pattern",A8="_func",Ar="_bft",BD="_state",BB={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},Ag={n:"Default",v:"Default"},A3=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},Ag],Ad=[{n:mstrmojo.desc(13772,"Keep Original"),v:An},{n:mstrmojo.desc(12276,"String"),v:A5},{n:mstrmojo.desc(2052,"Date"),v:At},{n:mstrmojo.desc(3434,"Number"),v:Av}];if(mstrApp&&mstrApp.showMultiDataType){Ad=[{n:mstrmojo.desc(13772,"Keep Original"),v:An},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3434,"Number"),v:Av,bft:AN.DssXmlBaseFormNumber},{n:mstrmojo.desc(9920,"Big Decimal"),v:Av,bft:AN.DssXmlBaseFormBigDecimal},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(2052,"Date"),v:At,bft:AN.DssXmlBaseFormDate},{n:mstrmojo.desc(9919,"DateTime"),v:At,bft:AN.DssXmlBaseFormDateTime},{n:mstrmojo.desc(2170,"Time"),v:At,bft:AN.DssXmlBaseFormTime},{isSeparator:true,cls:"separator"},{n:mstrmojo.desc(3544,"Text"),v:A5,bft:AN.DssXmlBaseFormText},{n:mstrmojo.desc(9921,"HTML Tag"),v:A5,bft:AN.DssXmlBaseFormHTMLTag},{n:mstrmojo.desc(8984,"Phone Number"),v:A5,bft:AN.DssXmlBaseFormPhoneNumber},{n:mstrmojo.desc(4530,"Symbol"),v:A5,bft:AN.DssXmlBaseFormSymbol},{n:mstrmojo.desc(9922,"URL"),v:A5,bft:AN.DssXmlBaseFormUrl},{n:mstrmojo.desc(4699,"Email"),v:A5,bft:AN.DssXmlBaseFormEmail}];}var Am=S.clone(Ad).slice(1),Au=Aw.fs.filter(function(BF){return Aw.da||BF.obf;}),BE=Au.length>1,Aq=Au.length>5,Ai=false,A4=false,Ax=[],A2=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:"),cssClass:"menu-info-text menu-header-text"}],BC={okEnabled:false},A7=function(){var BF=false;Au.forEach(function(BG){BF=BF||(BC[BG.fnm+A8+BD]!==BB.UNCHANGED)||(BC[BG.fnm+Ah+BD]!==BB.UNCHANGED);});return BF;},Ay=function(BH,BG){var BF=0;if(BH.da){N.forEach([A5,At,Av],function(BK,BI){var BJ=new RegExp("^\\s*"+BK+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(BG.f);if(BJ&&BJ[2]){BF=BI+1;return false;}});}return BF;},A1=function(BH,BG){var BF=0;if(BH.da){var BI=BG&&BG.bftp;N.forEach(Ad,function(BK,BJ){if(BK.bft===BI){BF=BJ;return false;}});}return BF;},A0=function(BH,BG){var BI=Ae;if(Aw.da){var BF=new RegExp("^\\s*"+BG+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(BH.f);if(!c.isEmpty(BF&&BF[1])){BI=BF[1];}}return BI;},Az=function(){return Aq?this.parent.parent.parent:(BE?this.parent.parent:this.parent);},As=function(BF){if(Aq){BF.formList.updateScrollbars();}},Af=function(BM,BN,BL){var BF=BN.fnm,BI=Aq?BM.formList[BN.fnm+Ah]:BM[BN.fnm+Ah],BJ=BE?BI.children[1]:BI,BK=BC[BF+A8],BH=Ai&&(BK===At||BK===A5),BG=BI.visible!==BH;if(BG){BI.set("visible",BH);if(BH){As(BM);}else{BJ.hideTooltip();}}if(BL){BJ.set("text",A0(BN,BK));BJ.set("items",BK===At?A3:[Ag]);}},Ap=function(BF){var BG=false;Au.forEach(function(BH){if(BC[BH.fnm+A8]===At||BC[BH.fnm+A8]===A5){BG=true;return false;}});BF.advancedLabel.set("visible",BG);},Ac=function(BH,BF,BI){return{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,items:BH,alias:BI.fnm+A8,selectedIndex:BF,onPopupWidgetOpened:function(){As(Az.call(this));},onitemSelected:function BG(BN,BL){var BM=Az.call(this),BO=BM.data,BP=BI.fnm,BK=BN.v,BJ=function(BQ){if(BQ){return(BH.length===3?BB.TO_UPDATE:BB.TO_CREATE);}return BB.UNCHANGED;};BO.set(BP+A8,BK);BO.set(BP+Ah,A0(BI,BK));BO.set(BP+Ar,BK===An?BI.bftp:(BN.bft?BN.bft:A6[BK]));BO.set(BP+A8+BD,BJ(BL!==BF));BO.set("okEnabled",A7());Af(BM,BI,true);Ap(BM);}};},Al=function(BH,BI,BF){return{scriptClass:"mstrmojo.ui.SearchablePulldown",isHostedWithin:false,alias:BH.fnm+Ah,useRichTooltip:true,visible:BF,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){As(Az.call(this));},customizeSearchResult:function(BJ){if(N.find(BJ,"v","Default")===-1&&this.items.length>0){BJ.push(Ag);}},onclick:function(BJ){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,BJ);this.set("isEditing",true);},updateData:function(BL){var BJ=Az.call(this),BK=BJ.data,BM=BH.fnm;BK.set(BM+Ah,BL);BK.set(BM+Ah+BD,BI!==BL?BB.TO_UPDATE:BB.UNCHANGED);BK.set("okEnabled",A7());},onitemSelected:function BG(BJ){if(BJ){this.updateData(BJ.v);}},onkeyup:function(BJ){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,BJ);var BK=this[this.editableSlot],BL=BK.innerText||BK.textContent;this.updateData(BL);},updateTooltipConfig:function(BK){this.tooltipOpenDelay=BK?500:0;var BJ=AE.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:BJ.y-2,left:BJ.x+BJ.w+10};}};},A9=function(BN,BM,BF,BG,BL){var BI=mstrApp&&mstrApp.showMultiDataType?A1(BN,BM):Ay(BN,BM),BK=A0(BM,Ad[BI].v),BH=BM.fnm,BJ=Ad;if(BI>0){BJ=Am;BI--;}BG[BH+Ah]="";BG[BH+A8]="";BG[BH+Ar]="";BG[BH+A8+BD]=BG[BH+Ah+BD]=BB.UNCHANGED;if(BL){BF.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:BH+A8,children:[{scriptClass:"mstrmojo.Label",text:BH,useRichTooltip:true,updateTooltipConfig:function(BQ){this.tooltipOpenDelay=BQ?500:0;var BP=this.domNode;var BO=AE.position(BP);if(BP.scrollWidth>BP.offsetWidth){this.richTooltip={content:c.encodeHtmlString(BP.innerText),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:BO.y-BO.h-10,left:BO.x-10};}}},S.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},Ac(BJ,BI,BM,true))]});BF.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:BH+Ah,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern"),cssClass:"menu-info-text"},S.copy({cssClass:"ConfDataTypePullDown MeContentPullDown HBOXPullDown"},Al(BM,BK,true))]});}else{BF.push(S.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},Ac(BJ,BI,BM,false)));BF.push(S.copy({cssClass:"ConfDataTypePullDown MeContentPullDown"},Al(BM,BK,false)));}};N.forEach(Aw.fs,function(BF){if(Ab.als&&Ab.als.links[Aw.did+" "+BF.fid]){A4=true;return false;}});if(BE){Au.forEach(function(BF){A9(Aw,BF,Aq?Ax:A2,BC,true);});}else{A9(Aw,Au[0],A2,BC,false);}if(Aq){A2.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Ax});}A2.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var BG=this.parent,BH,BF,BI=true;Ai=!Ai;AX.toggleClass(this.domNode,"expanded",Ai);Au.forEach(function(BJ){Af(BG,BJ,false);BH=Aq?BG.formList[BJ.fnm+Ah]:BG[BJ.fnm+Ah];BF=BE?BH.children[1]:BH;if(BH.visible&&BI&&!Aq){BI=false;BF.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:BC,cssClass:"ConfDataType-MenuEditor",contents:A2,onOpen:function(){As(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function Ak(BH){var BF=[],BJ=[],BG=false,BI=function(BM,BN,BL){var BP=[],BO=function(BQ){var BR=BQ.ftk&&BQ.ftk.slice(2,-2);if(!BR){return null;}while((BR.shift()).v!=="("){}return BR;},BK=BO(BL)||[AV(Aw,BL)];BP.push({v:"!",tp:33,lv:4});if(BM!==An){BP.push({v:BM,oi:{did:Aj[BM],t:11,st:2816,n:BM}});if(!c.isEmpty(BN)&&BN!==Ae&&(BM===At||BM===A5)){BP.push({v:'<Pattern="'+BN+'">(',tp:"2",lv:1});}else{BP.push({v:"(",tp:"2",lv:1});}BP=BP.concat(BK);BP.push({v:")",tp:"2",lv:1});}else{BP=BP.concat(BK);}BP.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:BP});};if(A4){BG=true;}else{Au.forEach(function(BK){if(BH[BK.fnm+A8+BD]===BB.TO_CREATE){BG=true;return false;}else{if(BH[BK.fnm+A8+BD]===BB.TO_UPDATE||(BH[BK.fnm+Ah+BD]===BB.TO_UPDATE&&(BH[BK.fnm+A8]===At||BH[BK.fnm+A8]===A5))){BJ.push(BK);}}});}if(BG){Au.forEach(function(BK){BF.push({n:BK.fnm,formula:BI(BH[BK.fnm+A8],BH[BK.fnm+Ah],BK),bft:BH[BK.fnm+Ar]});});BA(BG,BF);}else{if(Aw.da){AO(Ab.mid,Aw.did,BJ,function(BK){BK.forEach(function(BL){BF.push({did:BL.fid,formula:BI(BH[BL.fnm+A8],BH[BL.fnm+Ah],BL),bft:BH[BL.fnm+Ar]});});BA(BG,BF);});}}}});},getCreateTimeDAEditorCfg:function B(Ae,Ad){var Ab=H(Ae);if(!Ab){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function Ac(){var Ag=false;S.forEach(this.selectedIndices,function(Ah){if(Ah){Ag=true;return false;}});this.parent.data.set("okEnabled",Ag);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function Af(Ak,Ai){var Aj=Ai.time_type,An=Aj.selectedIndices,Ah=Aj.items,Am=[],Ag=[],Al=function(Ao,Aq,As){var Ar=[{v:"!",tp:33,lv:4}],Ap;As.forEach(function(At){if(At===AM){Ar.push(AV(Ao,Aq));}else{Ap=AQ[At];if(Ap){Ar.push({v:Ap,oi:{did:Ap,t:11,st:2816,n:Ap}});}else{Ar.push({v:At,tp:"2",lv:1});}}});Ar.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ar});};S.forEach(An,function(Ao,Ap){if(Ao){Ag=[];S.forEach(AZ[Ah[Ap].v],function(Aq,Ar){Ag.push({n:Ar,formula:Al(Ae,Ab,Aq),bft:(Ar==="DATE"?8:0)});});Am.push({isTokenStream:true,forms:Ag,name:Ae.n+" ("+Ah[Ap].n+")"});}});return Ad(Am);}});},RefreshAndCloseAllObjectBrowserCallback:function(Ac,Ab){return mstrmojo.func.wrapMethods(Ab.getDatasetsUpdateCallback(),{success:function(){if(N.find(Ac,"act","createDataset")!==-1){Ab.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function AG(Ac,Ae,Ab){var Ad=null;S.forEach(Ac,function(Ag){var Af=Ag.att||[];if(Ab===4){Af=Ag.mx||[];}N.forEach(Af,function(Ah){if(Ah.did===Ae){Ad=Ah;return false;}});if(Ad){return false;}});return Ad;},getDatasetFromId:function b(Ab,Ac){var Ad=null;S.forEach(Ab,function(Ae){if(Ae.did===Ac){Ad=Ae;return false;}});return Ad;},getDatasetFromAttributeId:function b(Ab,Ac){var Ad=null;S.forEach(Ab,function(Ae){if(N.find(Ae.att,"did",Ac)>=0){Ad=Ae;return false;}});return Ad;},getSortedDatasetUnits:function AC(Ab,Ad){var Ac=function Ac(Ae){return Ae.t===AB.DssTypeMetric?2:1;};Ab=Ab.concat();Ab.sort(function(Ah,Af){if(!Ah||!Af){return true;}if(Ad){var Ai=Ah;Ah=Af;Af=Ai;}var Aj=Ac(Ah)-Ac(Af),Ag=Ah.n.toUpperCase(),Ae=Af.n.toUpperCase();return Aj!==0?Aj:(Ag!==Ae?Ag.localeCompare(Ae):Ah.n.localeCompare(Af.n));});return Ab;},isDerivedMetric:function z(Ab){return Ab.dm||Ab.um;},isGeoAttr:function AL(Ab,Ac){return !!(Ab.fs&&(Ab.fs instanceof Array)&&Ab.fs.length&&Ab.fs.some(function(Ad){return Ad.fgr>0&&(!Ac||(Ac&&Ad.obf));}));},isTimeAttr:function u(Ab){return !!(Ab.fs&&H(Ab));},isLngOrLatAttr:function AF(Ab){return !!(Ab.fs&&(Ab.fs instanceof Array)&&Ab.fs.length===1&&Ab.fs.some(function(Ac){return Ac.fgr===5||Ac.fgr===6;}));},isNewDE:function E(Ab){return Ab.t===e.Consolidation&&Ab.st===AI.ConsolidationManaged;},isRecursiveAttr:function AJ(Ab){return Ab.t===e.Attribute&&Ab.st&&Ab.st===AI.AttributeRecursive;},isRecursiveNDE:function i(Ab){return this.isNewDE(Ab)&&Ab.ndetype===F.DssRecursiveDerivedElement;},getUnitCssClass:function(Ac){var Ab=Ac.t;if(Ac.mt){Ab=Ac.mt;}else{if(this.isGeoAttr(Ac,Ac.useAvailGeoFmsOnly)){Ab+="g";}else{if(this.isDerivedMetric(Ac)||Ac.da){Ab+="d";}else{if(Ac.de){Ab+="de";}else{if(this.isTimeAttr(Ac)){Ab+="t";}}}}}if(this.isNewDE(Ac)||this.isRecursiveAttr(Ac)){Ab+=(" st"+Ac.st);}if(this.isRecursiveNDE(Ac)){Ab+=" nde4ra";}return"ic"+Ab;},hasMultiForms:function L(Ac,Ab){return Z.getFormsByAttrId(Ac,Ab).length>1;},getDisplayFormsMenu:function J(As,Ak,Ah,Au,Ae,Ac){var Ad=[],Aq=[],Ai=[],Ao=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}],At=Ak.model.data,Ab=At.gts,Al=Ak.hasArrayGSI,Am=As.setIdx,Ar=Ab.col,Ag;if(Al&&Am!==undefined){Ar=Ak.getColSetColumnTitles(Math.max(Am,0));}N.forEach((Ab.row||[]).concat(Ar||[]),function(Av){if(Av.id===As.did){Aq=Aq.concat(Av.fs);}});Ag=Z.getFormsByAttrId(As.attId||As.did,Ah);N.forEach(Ag||[],function(Aw){var Ax=Aw.fid;if(N.find(Ad,"id",Ax)<0){Ad.push({id:Ax,n:Aw.fnm});var Av=N.find(Aq,"id",Ax);if(Av>-1&&(!Ac||Ac(Aw))){Ai[Ad.length-1]=true;}}});var Ap=[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:Ad,selectedIndices:Ai},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:"),cssClass:"menu-info-text"},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:Ao,isHostedWithin:false,selectedIndex:N.find(Ao,"v",At.lnm||0),onitemSelected:function Aj(Av){this.v=String(Av.v);}}];if(this.isNewDE(As)||(Ak.getChartStyle&&Ak.getChartStyle()==="NewGraphMatrixVisualizationStyle")){Ap.splice(-2,2);}return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{item:As,oldSelected:S.copy(Ai,{})},contents:Ap,okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function An(BE,Ay){var A4=Ay.fs,A7=A4.selectedIndices,Az=A4.items,A5=[],Ax=[],A8=[];if(!A4.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var BB=BE.oldSelected,A6=A7,A9,BA={},A0={};for(A9=0;A9<Az.length;A9++){if(BB[A9]&&!A6[A9]){BA[A9]=true;}else{if(!BB[A9]&&A6[A9]){A0[A9]=true;}}}if(!Ae){S.forEach(BA,function(BF,BG){if(BF){Ax.push({act:"removeForm",unitId:As.did,unitType:As.t,attFormId:Az[BG].id});}});}var Av=Ak.model.data.gts;(Av.row||[]).concat(Ar||[]).forEach(function(BF){if(BF.id===As.did){(BF.fs||[]).forEach(function(BG){if(N.find(Ad,"id",BG.id)<0){Ax.push({act:"removeForm",unitId:As.did,unitType:As.t,attFormId:BG.id});}});}});S.forEach(A0,function(BF,BG){if(BF){A5.push({act:"addForm",unitId:As.did,unitType:As.t,attFormId:Az[BG].id,unitPos:0});}});A8.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Ay.longNames?Ay.longNames.v:0});var A1=[],A2=Ax.concat(A5),BC=Ak.controller.dataService(),Aw=Ak.k;if(Al){var BD=Ak.gridData.gsi,A3=As.setIdx;if(A3!==undefined&&A3>-1){A1.push(BC.getUpdateTemplateAction(mstrmojo.models.template.DataInterface.getGSI(BD,A3).k,A2,null,Aw));}else{mstrmojo.models.template.DataInterface.forEachGSI(BD,function(BG,BF){A1.push(BC.getUpdateTemplateAction(BF,A2,null,Aw));},Aw);}mstrmojo.models.template.DataInterface.forEachGSI(BD,function(BG,BF){A1.push(BC.getUpdateTemplateAction(BF,A8,null,Aw));},Aw);}else{A1.push(BC.getUpdateTemplateAction(Aw,A2.concat(A8)));}if(Au){Au(A1,A0,BA);}},onOpen:function Af(){this.fs.updateScrollbars();}});},getAttributeLinkMenu:function I(An,Aq,Al,Ap,Ag){var Ar=-2147483648,Ai=Ap.datasets,Aj=Ai[Al],Ao=Aj.tables||[],Ab={},Ak=[],Ae=(Aq.fs&&Aq.fs[0])||{},Am=[],Ah=779,Ad=Aq.art>1,Ac=!Ad&&S.keyarray(Ai).length>1,Af=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:Aq,docModel:Ap,datasetId:Al});};if((Aj.st!==Ah)||Ao.length<=1||Aq.da){if(Ac){An.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",Af);}return ;}N.forEach(Aj.att,function(Au){var Av=true,At=null,As=(Au.fs&&Au.fs[0])||{};if(Au.da){return ;}if(Ae.der===Ar||As.der===Ar||Ae.fgr===-1||As.fgr===-1||Ae.ftr===-1||As.ftr===-1){return ;}if(Ae.fgr&&As.fgr&&Ae.fgr!==As.fgr){return ;}if(Ae.ftr&&As.ftr&&Ae.ftr!==As.ftr){return ;}N.forEach(Ao,function(Aw){var Ax=N.find(Aw.attRefs,"did",Aq.did),Ay=N.find(Aw.attRefs,"did",Au.did);if(Ax>=0&&N.indexOf(Ak,Aw.did)<0){Ak.push(Aw.did);}if(Ay>=0){At=Aw.did;}if(Ax>=0&&Ay>=0){Av=false;}});if(Av&&!Au.hide){Ab[Au.did]=At;Am.push(Au);}});if(Am.length>0&&Aj.hcs!==true&&!Ap.isSparkDataset(Aj)){An.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Am,listHooks:{select:function As(At,Au){Ap.warnForEditStandaloneDS(Aj,function(){N.forEach(Ak,function(Av){U({dsid:Al,srcId:Aq.did,srcTableId:Av,tgtId:Au.did,tgtTableId:Ab[Au.did]},Ap,Ag);});});}}}]}]});});}if(Ac){An.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",Af);}},isDocumentLevelItem:function AH(Ab){return Ab&&(Ab.um||Ab.da||this.isNewDE(Ab));},isLegalObjectName:function g(Ab){var Ac=/["\[\]\\]/g;if(Ab.match(Ac)){return false;}return true;},validateName:function D(Ac,Ad,Ab){if(this.isLegalObjectName(Ac)){Ad();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),Ab,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AK(Ab){return Ab.att.some(function(Ac){return X(Ac);});},isCGorCon:function k(Ab,Ad){var Ac=N.filterOne(Ad&&Ad.att,function(Ae){return Ae.did===Ab.did;});return X(Ac||Ab);},hasOldDEOverDatasets:function(Ae,Ad){var Ac=false,Ab;S.forEach(Ad,function(Af){Ab=N.find((Af.att||[]),"did",Ae);if(Ab!==-1&&Af.att[Ab].de){Ac=true;return false;}});return Ac;},getMarkGeoRoleEditorCfg:function P(Ab,BG,Ax,At,BP,BR){var Ar=268435456,BM=536870912,Ag=1073741824,A7=268435456,BJ=805306368,BE=805306368,A1=1879048192,BQ=-2147483648,BH=0,BI=1,Ai=2,Aq=3,Av=4,Ao=5,BO=6,Al=7,Az=8,Ay=9,A9=10,As=11,Ae=2,A6=3,BF={v:BH,n:mstrmojo.desc(2057,"None")},BS={v:Aq,n:mstrmojo.desc(7674,"Country"),der:Ar},BD={v:Ai,n:mstrmojo.desc(7676,"State"),parents:[BS],der:BM},Am={v:Ay,n:mstrmojo.desc(12919,"County"),parents:[BS,BD]},BK={v:BI,n:mstrmojo.desc(7675,"City"),parents:[BS,BD],der:Ag},A2={v:Az,n:mstrmojo.desc(7677,"Zip Code"),parents:[BS,BD,BK]},Au={v:Ao,n:mstrmojo.desc(7696,"Latitude")},BA={v:BO,n:mstrmojo.desc(7697,"Longitude")},Ap={v:Av,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},A5={v:A9,n:mstrmojo.desc(12973,"Area Code")},BC={v:As,n:mstrmojo.desc(16630,"Geometry")},A8={v:Al,n:mstrmojo.desc(2056,"Custom")},Aw=mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.M2020_VERSION),An={ID:[BF,BS,BD,Am,BK,A2,Au,BA,Ap,A5].concat(Aw?[BC,A8]:[A8]),ID_NUMERIC:[BF,A2,A5,Au,BA],NON_ID:[BF,BS,BD,Am,BK,A2,Ap,A5].concat(Aw?[BC,A8]:[A8]),NON_ID_NUMERIC:[BF,A2,A5]},A3=N.filter(BG.fs,function(BT){return(BT.bftp===Ae||BT.bftp===A6)&&BT.der!==BQ;});var BB=(A3.length>1),Ad=N.find(A3,"idf",true),Af=(Ad===-1?0:Ad),A4=A3[Af],Ak,Ac,A0,Ah=[],Aj=function(BT){var BU=(BT.idf?"ID":"NON_ID")+(BT.bftp===Ae?"_NUMERIC":"");return An[BU];},BN=function(BU,BT){return N.find(Aj(BT),"v",BU);};if(A3.length===0||N.find(BG.fs,"fgr",-1)!==-1||A4.der===BQ){return null;}N.forEach(A3,function(BV,BT){var BU=S.clone(BV);BU.n=BU.fnm;Ah.push(BU);if(BV.fgr){A4=BU;Af=BT;}});Ak=A4.fid;A0=A4.fgr||0;Ac=BN(A0,A4);return new mstrmojo.ui.menus.EditorConfig({data:{item:BG,geoForm:A4,geoRole:A0},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:BB},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Ah,selectedIndex:Af,alias:"formList",visible:BB,onitemSelected:function BL(BV){var BT=this.parent.data,BU=this.parent.geoRoleList;if(BT.geoForm.fid!==BV.fid){BT.set("geoForm",BV);BT.set("geoRole",BV.fgr);BU.set("items",Aj(BV));BU.set("selectedIndex",BN(BV.fgr,BV));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:BB,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:"),cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.Pulldown",isHostedWithin:false,cssClass:"MarkGeoRolePullDown",items:Aj(A4),selectedIndex:Ac,alias:"geoRoleList",onitemSelected:function BL(BZ){var BY=this.parent,BT=BY.data,Ba=BY.geoDrvList;var BV=[],BX=[],BU=A4.der,BW;BT.set("geoRole",BZ.v);N.forEach(BZ.parents,function(Bb,Bc){BW=Bb;BV.push({n:BW.n,der:BW.der});if((BU&BW.der)!==0){BX[Bc]=true;}});Ba.set("items",BV);Ba.set("selectedIndices",BX);N.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(Bb){BY[Bb].set("visible",BV.length>0);});if(BY.adjustCornersForPopupOverflow){BY.adjustCornersForPopupOverflow();}}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel",cssClass:"menu-info-text"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(BY,BX){var BU=function(Bi){var Bh=function(Bn){var Bo="<mpcs>";N.forEach(Bn,function(Bp){Bo+='<mpc did="'+Bp.did+'" n="'+Bp.n+'" georole="'+Bp.georole+'" drvflg="'+Bp.drvflg+'" />';});Bo+="</mpcs>";return Bo;},Ba=function(Bn,Bp,Br,Bo){var Bq=function(Bv,Bs,Bu){var Bt=p(Bi,Bv,Bs),Bw=y(Bt,Bu);return Bw&&Bw.did;};BP.forEach(function(Bs,Bt){var Bu=Bq(Bs.did,BG.did,Bp.fid);if(Bu){Bn[Bt]=Bn[Bt]||[];Bn[Bt].push({did:Bu,n:Bp.fnm,georole:Br,drvflg:Bo});}});},Be=[],Bm=[],Bj=BX.geoDrvList,Bk=0,Bc=false,Bg=false,Bl={2:A7,1:BJ,9:BE,8:A1}[BY.geoRole]||0,Bb=A4.fgr!==BY.geoRole,Bf=A4.fid!==BY.geoForm.fid,Bd;S.forEach(Bj.selectedIndices,function(Bo,Bn){if(Bo){Bk|=Bj.items[Bn].der;}});Bk&=Bl;Bd=A4.der!==Bk;if(Bb||Bf||Bd){if(BB&&Bf){if(A4.fgr!==BH){Ba(Bm,A4,BH,0);if(A4.der>0){Bc=true;}}}if(BY.geoForm.fgr!==BY.geoRole||BY.geoForm.der!==Bk){Ba(Bm,BY.geoForm,BY.geoRole,Bk);if((Bk&BY.geoForm.der)!==BY.geoForm.der){Bc=true;}}if(Bb){Bg=true;}if(Bm.length>0){Bm.forEach(function(Bo,Bn){Be.push({act:"changeEMMAMapping",dsid:Ax,tbid:BP[Bn].did,mapping:Bh(Bo)});});BR(Be,Bc||Bg);}}},BV=function(){AP(Ab.mid,Ax,{success:BU});};var BW=mstrApp.isAppStatePause();if(!At||BW){var BZ,BT=BW?mstrmojo.desc(212,"Continue"):mstrmojo.desc(219,"Yes");if(At){BZ=mstrmojo.desc(16237,"The operation requires the dataset to be unloaded from memory. It will be automatically reloaded when you resume data retrieval. Do you want to continue?");}else{BZ=BW?mstrmojo.desc(16236,"The operation requires modifying the dataset and unloading it from memory. It will be automatically reloaded when you resume data retrieval, however the change will also affect other reports, documents, and dossiers that share the dataset. Do you want to continue?"):mstrmojo.desc(15493,"Modifications to this dataset will affect other reports, documents, and dossiers that share the dataset. Do you want to continue?");}mstrmojo.warn(BZ,{},{buttons:[C(BT,function(){BV();},true,{cssText:"min-Width: 60px"}),C(mstrmojo.desc(221,"Cancel"),function(){})]});}else{BV();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.string","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.vi.ui.rw.FreezingImageContainer","mstrmojo.gm.GMEnums");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var P=document.getElementById("vis-measure-canvas"),t=[],F=document.getElementById("vis-measure-span"),o={},Y={},Au={},O={},AB={},AN=mstrmojo.dom,j=mstrmojo.elementHelper,Ag=mstrmojo.vi.ui.DatasetUnitMenuUtils,Z=mstrmojo.VisEnum.EnumColorRankMode,AA=mstrmojo.chart.model.enums.EnumDSSObjectType,Aq=mstrmojo.chart.model.enums.EnumDSSBaseFormType,Ac=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,Ai=mstrmojo.chart.enums.EnumFontStyle,b=mstrmojo.hash,h=mstrmojo.string,As=mstrmojo.func.wrapMethods,d=mstrmojo.VisEnum,S=mstrmojo._FormatDefinition,Ay=d.SERVER_JSON_ERROR_TYPE,AG=mstrmojo.vi.viz.EnumVizStyles,AW=mstrmojo.vi.enums.EnumFeatures,E=mstrmojo.vi.ui.rw.FreezingImageContainer,Ap=mstrmojo.vi.ui.rw.GhostImageContainer,Aw=mstrmojo.gm.EnumDefaultProperty,Ae=mstrmojo.gm.WidgetPropertyTag,l=mstrmojo.gm.FormatingPropertyTag,k=mstrmojo.num;var AE=64,AP=128,C=4,AJ=5,g=6,G=7,m=mstrmojo,W=m.array,At=mstrmojo.array,B=m.desc,s=m.mstr.EnumFunction,X=mstrmojo.vi.enums.EnumDerivedElementType,An=m._HasMarkup,Ar=m.css,n=/img.*?src.*=/g;var R;var i=NaN;var e=false;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869,11819,11827);function Ax(A3,A2){var A1=mstrmojo.VisUtility;var A4=A1.pluck(A2,"tid"),A5=A1.pluck(A2,"eid"),A0=(A3.getDocModel&&A3.getDocModel())||A1.getPropertyByPath(A3,"model.docModel");if(A1.getPropertyByPath(A0,"getColorBy") instanceof Function){return A0.getColorBy(A4,A5);}}function Ao(A0,A2,A4){var A3=A2.id,A1=A2.getHost();if(A1&&A1.observableModel){A0.forEach(function(A6){var A5=A1.observableModel[A6];if(A5){A5.attachEventListener("valueChanged",A3,A4);}});}}function Az(A1){var A0={SINGLE:[{text:B(358,"Absolute"),value:s.FunctionAbs,n:B(358,"Absolute"),v:s.FunctionAbs}],PAIR:[{text:B(6017,"Add"),value:s.FunctionAdd,n:B(6017,"Add"),v:s.FunctionAdd},{text:B(2122,"Average"),value:s.FunctionAverage,n:B(2122,"Average"),v:s.FunctionAverage},{text:B(5868,"Least"),value:s.FunctionLeast,n:B(5868,"Least"),v:s.FunctionLeast},{text:B(5869,"Greatest"),value:s.FunctionGreatest,n:B(5869,"Greatest"),v:s.FunctionGreatest},{text:"A-B",value:s.FunctionMinus+";0",n:"A-B",v:s.FunctionMinus+";0"},{text:"B-A",value:s.FunctionMinus+";1",n:"B-A",v:s.FunctionMinus+";1"},{text:"A/B",value:s.FunctionDivide+";0",n:"A/B",v:s.FunctionDivide+";0"},{text:"B/A",value:s.FunctionDivide+";1",n:"B/A",v:s.FunctionDivide+";1"}],MORE:[{text:B(6017,"Add"),value:s.FunctionAdd,n:B(6017,"Add"),v:s.FunctionAdd},{text:B(2122,"Average"),value:s.FunctionAverage,n:B(2122,"Average"),v:s.FunctionAverage},{text:B(5868,"Least"),value:s.FunctionLeast,n:B(5868,"Least"),v:s.FunctionLeast},{text:B(5869,"Greatest"),value:s.FunctionGreatest,n:B(5869,"Greatest"),v:s.FunctionGreatest}]};return A0[A1];}function Ab(A1,A0){return !!(((A1&&A1.at)||0)&A0);}function c(A0){return !A0.cmSelCells.some(function(A1){var A2=A0.getCellForNode(A1);return j.isNonGroupNull(A2)||!Ab(A2,AE)||A2.dei!==undefined||A0.model.isRecursiveAttribute(A2.tid);});}function w(A1){var A0;return !A1.cmSelCells.some(function(A2){A0=A1.getCellForNode(A2);return(j.isNonGroupNull(A0)||!Ab(A0,AP))||A1.model.isRecursiveAttribute(A0.tid);});}function Av(A3,A0){var A2=A3&&A0&&A3.getCellForNode(A0),A1=A2&&A3.getDEInfo(A2);return A1&&A1.de;}function a(A4,A3,A6,A2){if(A2){var A1=A3&&A4.getDEInfo(A3),A5=A1&&A1.de,A0=A5&&A5.func;if((A0===A6)||(typeof A6==="string"&&A6.indexOf(A0)===0&&A6.indexOf(";0")>0)){return ;}A4.editDECalculation(A3,A6);}else{A4.derivedElementCalculation(A3,A6);}}function x(BC,BA,A8){var BB=BA&&BA.es,A0=(BB&&BB.length)||BC.cmSelCells.length,A3=(A0===1)?"SINGLE":((A0===2)?"PAIR":"MORE"),A9=Az(A3),A2=(BA&&BA.func),A4,BD=BC.cmSelCells,A1,A7,A6,A5;if(A3==="PAIR"){if(BA){A5=BB[0].v>BB[1].v;if(A5){A6=BB[0].n;A7=BB[1].n;A9[4]={value:s.FunctionMinus+";1",v:s.FunctionMinus+";1"};A9[5]={value:s.FunctionMinus+";0",v:s.FunctionMinus+";0"};A9[6]={value:s.FunctionDivide+";1",v:s.FunctionDivide+";1"};A9[7]={value:s.FunctionDivide+";0",v:s.FunctionDivide+";0"};}else{A7=BB[0].n;A6=BB[1].n;}}else{A7=A8(BD[0]);A6=A8(BD[1]);}A9[C].text=A7+" - "+A6;A9[AJ].text=A6+" - "+A7;A9[g].text=A7+" / "+A6;A9[G].text=A6+" / "+A7;A9[C].n=A7+" - "+A6;A9[AJ].n=A6+" - "+A7;A9[g].n=A7+" / "+A6;A9[G].n=A6+" / "+A7;}for(A4 in A9){if(typeof A9[A4].value==="string"&&A9[A4].value.indexOf(A2)===0&&A9[A4].value.indexOf(";0")>0){A1=A9[A4];break;}if(A9[A4].value===A2){A1=A9[A4];break;}}return{items:A9,selectedItem:A1};}function AF(A0,A3){if(!A0){return A0;}if(A3.length===1){return A0[A3[0]];}var A2=(A3&&A3.length)||0,A1;for(A1=0;A1<A2;A1++){A0=A0[A3[A1]];if(!A0){break;}}return A0;}function Ad(A2,A1,A0){return A2.every(function(A3){return A3.ttp===A1||A3.ttp===A0;});}function H(A1,A4,A5){var A3=(A4&&A4.length)||0,A2,A0,A6=A1;for(A2=0;A2<A3-1;A2++){A0=A4[A2];if(!A6[A0]){A6[A0]={};}A6=A6[A0];}A6[A4[A3-1]]=A5;}function AM(A8){var A9,A7,A3,A5,A0,A6=this.model.docModel.datasets,A1=false,A4=false,A2={isDM:false};for(A9 in A6){if(A6.hasOwnProperty(A9)){A7=A6[A9].mx;W.forEach((A7||[]),function(BA){if(BA.did===A8){if(BA.um||BA.rdm){A4=true;}A1=true;return false;}});if(A1){break;}}}if(A4){A0=this.model.data.gts.col;A3=(A0&&A0[A0.length-1]);if(A3&&A3.otp===-1){A5=A3.es;}W.forEach((A5||[]),function(BA){if(BA.oid===A8){A2={isDM:true,id:BA.id};return false;}});}return A2;}function M(A0,A3){var A6=[],A2={act:"updateElementsPropertiesMap",epm:A6},A4=[],A1={},A8=[A1],A7=this;A6.push({epmk:A4,epmv:A8});A0.forEach(function(BA){var BB=BA.tid,BD=BA.tp,A9=BB===-1,BC={ob:{did:A9?"":BB,tp:BD}};A4.push(BC);});if(A3&&A3.indexOf("default")<0){A1.v={vv:A3};}var A5=[];A1.k={chn:A5};A0.forEach(function(BB){var BC=BB.tid,A9=BC===-1,BA;if(A9){BA=AM.call(A7,BB.eid);if(BA.isDM){A5.push({emt:2,ei:BA.id});}else{A5.push({emt:2,mt:{did:BB.eid,tp:4,ql:0}});}}else{A5.push({emt:1,ei:BB.eid,at:{did:BC,tp:BB.tp,ql:0}});}});return A2;}function AX(A4,A2){var A3="00000000000000000000000000000000",A1=A4&&A4.dropZones,A0=W.find(A1,"id",A2);return A0===-1?[]:W.filter(A1[A0].items,function(A5){return A5.t===4&&A5.id!==A3;});}function AT(A5,A2,A4,A1,A0){var A6=A1?A5:A5&&A5.parentNode;while(A6&&(A6!==A0)){var A3=A6.getAttribute&&A6.getAttribute(A2);if(A3!==null&&A3.indexOf(A4)>=0){return true;}A6=A6.parentNode;}return false;}function AK(A1,A2){var A0=b.walk("rootCtrl.docCtrl",mstrApp);if(A0&&(typeof A0.selectViPanel==="function")){A0.selectViPanel(A2);}A1.getDocModel().selectVIUnit(A1.parent.id,true);}var I={sessions:{},instances:[],init:function AU(){this.supportedEventTypes=[];if(window.TouchEvent){this.supportedEventTypes.push("TouchEvent");}else{if(window.PointerEvent){this.supportedEventTypes.push("PointerEvent");}}if(window.MouseEvent){this.supportedEventTypes.push("MouseEvent");}return this;},startNewSessions:function AQ(A0){var A4=this;var A2=this;var A1=document;var A3=function(BE){var A9=A0.callbacks.start.bind(A0.callbackThis),BA=A0.callbacks.change.bind(A0.callbackThis),BB=A0.callbacks.end.bind(A0.callbackThis),BD=A0.callbacks.context;var A6={};A6.identifier=BE.identifier;A6.context=b.clone(BD);A6.clientX=BE.clientX;A6.clientY=BE.clientY;var A8=function A8(BF){var BG=this.context;return A9({api:A2,event:BF,session:this,context:BG});};var BC=function BC(BG,BF){var BH=this.context,BJ=0,BI=0;BJ=BF.clientX-this.clientX;BI=BF.clientY-this.clientY;this.clientX=BF.clientX;this.clientY=BF.clientY;var BK={api:A2,event:BG,deltaX:BJ,deltaY:BI,session:this,context:BH};return BA(BK);};var A7=function A7(BF){var BG=this.context;return BB({api:A2,event:BF,session:this,context:BG});};A6.onStart=A8;A6.onChange=BC;A6.onEnd=A7;return A6;};var A5=function(A7,A6){A7.listeners={};A7.listeners.change=function(A8){var A9=A4.getChangedSessions(A8);for(var BA=0;BA<A9.length;BA++){if(A7.identifier===A9[BA].identifier){return A4.sessions[A7.identifier].onChange(A8,A9[BA]);}}};A7.listeners.end=function(A9){var BA=A4.getChangedSessions(A9);for(var BB=0;BB<BA.length;BB++){if(A7.identifier===BA[BB].identifier){if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(A6)){A1.removeEventListener("touchmove",A7.listeners.change);A1.removeEventListener("touchend",A7.listeners.end);A1.removeEventListener("touchcancel",A7.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(A6)&&(A6.pointerType&&A6.pointerType!=="mouse")){A1.removeEventListener("pointermove",A7.listeners.change);A1.removeEventListener("pointerleave",A7.listeners.end);A1.removeEventListener("pointerup",A7.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(A6)&&!A6.pointerType){A1.removeEventListener("mousemove",A7.listeners.change);A1.removeEventListener("mouseup",A7.listeners.end);}}}var A8=A4.sessions[A7.identifier].onEnd(A9);delete A4.sessions[A7.identifier];return A8;}}};if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(A6)){A1.addEventListener("touchmove",A7.listeners.change);A1.addEventListener("touchend",A7.listeners.end);A1.addEventListener("touchcancel",A7.listeners.end);}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(A6)&&(A6.pointerType&&A6.pointerType!=="mouse")){A1.addEventListener("pointermove",A7.listeners.change);A1.addEventListener("pointerleave",A7.listeners.end);A1.addEventListener("pointerup",A7.listeners.end);}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(A6)&&!A6.pointerType){A1.addEventListener("mousemove",A7.listeners.change);A1.addEventListener("mouseup",A7.listeners.end);}}}};return function(A8){var A9=A4.getChangedSessions(A8),A7=A4.sessions,BA=A9.filter(function(BB){if(A7[BB.identifier]){return false;}else{return true;}});BA.forEach(function(BB){A4.sessions[BB.identifier]=A3(BB);A5(A4.sessions[BB.identifier],A8);});var A6=[];BA.forEach(function(BB){A6.push(A4.sessions[BB.identifier].onStart(A8));});return A6;};},newInstance:function AV(A3,A6,A5){var A2,A1,A0=this.getInstanceIndex(A3);if(A0!==-1){for(A2=0;A2<this.supportedEventTypes.length;A2++){A1=this.supportedEventTypes[A2];if(A1==="TouchEvent"){A3.removeEventListener("touchstart",this.instances[A0].starter);}else{if(A1==="PointerEvent"){A3.removeEventListener("pointerdown",this.instances[A0].starter);}else{if(A1==="MouseEvent"){A3.removeEventListener("mousedown",this.instances[A0].starter);}}}}delete this.instances[A0];}var A4={domNode:A3,callbacks:A6,callbackThis:A5};A4.starter=this.startNewSessions(A4);if(A0!==-1){this.instances[A0]=A4;}else{this.instances.push(A4);}for(A2=0;A2<this.supportedEventTypes.length;A2++){A1=this.supportedEventTypes[A2];if(A1==="TouchEvent"){A3.addEventListener("touchstart",A4.starter);}else{if(A1==="PointerEvent"){A3.addEventListener("pointerdown",A4.starter);}else{if(A1==="MouseEvent"){A3.addEventListener("mousedown",A4.starter);}}}}return this;},getInstanceIndex:function K(A0){return W.find(this.instances,"domNode",A0);},getInstance:function z(A1){var A0=this.getInstanceIndex(A1);return this.instances[A0];},getChangedSessions:function AO(A0){var A1=[];if(window.TouchEvent&&window.TouchEvent.prototype.isPrototypeOf(A0)){var A4=A0.changedTouches;for(var A2=0;A2<A4.length;A2++){var A3={};A3.identifier=A4[A2].identifier;A3.clientX=A4[A2].clientX;A3.clientY=A4[A2].clientY;A1.push(A3);}}else{if(window.PointerEvent&&window.PointerEvent.prototype.isPrototypeOf(A0)&&(A0.pointerType&&A0.pointerType!=="mouse")){A1.push({identifier:A0.pointerId,clientX:A0.clientX,clientY:A0.clientY,});}else{if(window.MouseEvent&&window.MouseEvent.prototype.isPrototypeOf(A0)&&!A0.pointerType){A1.push({identifier:"mouse",clientX:A0.clientX,clientY:A0.clientY,});}}}return A1;}};var AD=I.init();mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{setMeasuringOptFlag:function(A0){e=A0;},detectMinimumFontSize:function(){if(AN.isChrome){var A2="I am a sample string, I am a sample string, I am a sample string.",A4,A0={fontFamily:"Open Sans",fontSize:"1pt",fontStyle:"normal",fontWeight:"normal",textDecoration:"none"},A3=this.measureTextWidthWithSpan(A2,A0,0,undefined,true,true,true);for(var A1=2;A1<72;++A1){A0.fontSize=A1+"pt";A4=this.measureTextWidthWithSpan(A2,A0,0,undefined,true,true,true);if(A4>A3){i=A1;break;}}}},getCache:function(){return JSON.stringify(AB);},getUpdateColorMapAction:function(A1,A0){return M.call(this,A1,A0);},measureTextSize:function(A1,A0,A2){return{width:this.measureTextWidth(A1,A0,A2),height:this.measureTextHeight(A1,A0,A2)};},measureTextSizeOpt:function(A1,A0,A2){return{width:this.measureTextWidth(A1,A0,A2),height:this.measureTextHeight("H",A0,A2)};},measureTextWidth:function(A4,A3,A5,A2,A0,A1){if(AN.isIE||AN.isIEW3C){return this.measureTextWidthWithSpan(A4,A3,A5,A2,A0);}else{if(AN.isChrome){if(isNaN(i)){this.detectMinimumFontSize();}if(parseInt(A3.fontSize)>=i){return e?this.measureTextWidthWithCanvasOpt(A4,A3,A5):this.measureTextWidthWithCanvas(A4,A3,A5);}else{return this.measureTextWidthWithSpan(A4,A3,A5,A2,A0,false,A1);}}}return this.measureTextWidthWithCanvas(A4,A3,A5);},measureTextWidthWithCanvas:function(A2,A3,A6,A4){A4=A4||false;if(A2===""){return 0;}if(A2===" "){A2="\u00A0";}var A5=A3.fontFamily,A8=A3.fontSize,A1=A3.fontStyle,A7=A3.fontWeight;if(typeof A8==="number"){A8+="pt";}A1=A1||"normal";A7=A7||"normal";A6=A6||0;var A0=A4?undefined:AF(o,[A5,A8,A1,A7,A2]);if(!A0){A0=Math.ceil(this.measureOnCanvas(A2,A5,A8,A1,A7).width);H(o,[A5,A8,A1,A7,A2],A0);}return A0+A6;},getHundredCharSet:function(A0){var A2="";for(var A1=0;A1<100;++A1){A2+=A0;}return A2;},measureOnCanvas:function(A2,A0,A4,A5,A1){if(!P){P=document.createElement("canvas");P.width=0;P.height=0;P.id="vis-measure-canvas";P.style.position="absolute";P.style.top="0";P.style.fontSize="medium";document.body.appendChild(P);}var A3=P.getContext("2d");A3.font=A5+" "+A1+" "+A4+" "+this.surroundWithQuotes(A0);return A3.measureText(A2);},measureTextWidthWithCanvasOpt:function(A3,A4,A8,A6){A6=A6||false;if(A3===""||typeof (A3)!=="string"){return 0;}if(A3===" "){A3="\u00A0";}var A7=A4.fontFamily,BB=A4.fontSize,A2=A4.fontStyle,A9=A4.fontWeight;if(typeof BB==="number"){BB+="pt";}A2=A2||"normal";A9=A9||"normal";A8=A8||0;var A1=A6?undefined:AF(Y,[A7,BB,A2,A9,A3]);if(!A1){var A5,BA,A0;A1=0;for(A5=0;A5<A3.length;++A5){BA=A3[A5];A0=A6?undefined:Au[A7+BB+A2+A9+":"+BA];if(!A0){A0=this.measureOnCanvas(this.getHundredCharSet(BA),A7,BB,A2,A9).width/100;Au[A7+BB+A2+A9+":"+BA]=A0;}A1+=A0;}A1=Math.ceil(A1);H(Y,[A7,BB,A2,A9,A3],A1);}return A1+A8;},measureTextWidthQuick:function(A2,A3,A6,A4){A4=A4||false;if(A2===""){return 0;}if(A2===" "){A2="\u00A0";}var A5=A3.fontFamily,A8=A3.fontSize,A1=A3.fontStyle,A7=A3.fontWeight;if(typeof A8==="number"){A8+="pt";}A1=A1||"normal";A7=A7||"normal";A6=A6||0;var A0=A4?undefined:AF(o,[A5,A8,A1,A7,A2]);if(!A0){A0=Math.ceil(this.measureOnCanvas(A2,A5,A8,A1,A7).width);H(o,[A5,A8,A1,A7,A2],A0);}return A0+A6;},measureTextWidthWithSpan:function(A4,A5,A9,BB,A6,A0,A2){if(A4===""){return 0;}if(A4===" "){A4="\u00A0";}var A7=A5.fontFamily,BC=A5.fontSize,A3=A5.fontStyle,A8=A5.fontWeight;if(typeof BC==="number"){BC+="px";}A3=A3||"normal";A8=A8||"normal";BB=BB||"auto";A9=A9||0;A6=!!A6;if(typeof BB==="number"){BB+="px";}var A1=AF(O,[A7,BC,A3,A8,BB,A4]);if(!A1||A0){var BA;if(!F){F=document.createElement("span");BA=F.style;F.id="vis-measure-span";BA.position="absolute";BA.top="0";BA.visibility="hidden";BA.width="auto";BA.height="auto";if(A6){BA.whiteSpace="nowrap";}else{BA.whiteSpace="normal";}document.body.appendChild(F);}BA=F.style;if(A6){BA.whiteSpace="nowrap";}else{BA.whiteSpace="normal";}BA.width="auto";BA.height=BB;BA.fontFamily=this.surroundWithQuotes(A7);BA.fontSize=BC;BA.fontStyle=A3;BA.fontWeight=A8;F.innerHTML=h.encodeHtmlString(A4,A2);A1=Math.floor(F.clientWidth)+1;H(O,[A7,BC,A3,A8,BB,A4],A1);}return A1+A9;},measureTextHeight:function(A2,A3,A8,BB,A0,A5,A4){if(A2===""){return 0;}if(A2===" "){A2="\u00A0";}var A6=A3.fontFamily,BD=A3.fontSize,A1=A3.fontStyle,A7=A3.fontWeight,BA=A3.lineHeight||"1";A0=A0||"normal";A4=!!A4;if(typeof BD==="number"){BD+="px";}A1=A1||"normal";A7=A7||"normal";BB=BB||"auto";A8=A8||0;if(typeof BB==="number"){BB+="px";}var BC=A5?undefined:AF(AB,[A6,BD,A1,A7,BB,A2]);if(!BC){var A9;if(!F){F=document.createElement("span");A9=F.style;F.id="vis-measure-span";A9.position="absolute";A9.top="0";A9.visibility="hidden";A9.width="auto";A9.height="auto";if(A4){A9.whiteSpace="nowrap";}else{A9.whiteSpace="normal";}document.body.appendChild(F);}A9=F.style;if(A4){A9.whiteSpace="nowrap";}else{A9.whiteSpace="normal";}A9.heigth="auto";A9.width=BB;A9.lineHeight=BA;A9.fontFamily=this.surroundWithQuotes(A6);A9.fontSize=BD;A9.fontStyle=A1;A9.fontWeight=A7;A9.wordBreak=A0;F.textContent=A2;BC=F.clientHeight;if(!A5){H(AB,[A6,BD,A1,A7,BB,A2],BC);}}return BC+A8;},getVisEmptyMsg:function(A0,A1){var A2="";switch(A0){case"AE_ERROR":A2='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+(h.encodeHtmlString(A1||this.errorMsg,true)||"")+"</div><div></div></div></div></div></div>";break;case"NODATA_OTHERERROR":A2='<div class="error-msg"><div class="error-content"><div class="text" style="visibility: visible;padding-top:0px;"><div>'+(h.encodeHtmlString(this.errorMsg,true)||mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data."))+"</div></div></div></div>";break;default:A2='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return A2;},getVisEmptyMsgControls:function A(){var A2=this.error,A9,A6=this.errorType,A1,A4=mstrConfig&&mstrConfig.pluginsVisList,A8;var A3=mstrmojo.VisUtility;if(this.excludeData){A9=A3.getVisStyle.call(this);var A5=A3.getAttMetricCount.call(this);return[{scriptClass:"mstrmojo.vi.ui.rw.FreezingImageContainer",cssClass:A9,visName:mstrConfig.pluginsVisList[A9]&&mstrConfig.pluginsVisList[A9].d,visDropzoneMsg:E.getVisDropzoneMsg(A5.attCount,A5.metricCount)}];}if(!this.hasError()){return ;}switch(A6){case Ay.NO_DATASET:case Ay.NO_TEMPLATE_UNIT:if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(AW.SUPPORT_GHOST_IMG)){A9=A3.getVisStyle.call(this);var BA="",A7="",A0="";if(A9===AG.HEAT_MAP){BA="heatmap";A7=mstrmojo.desc(11819,"Heat Map");A0=Ap.getVisDesc("heatmap");}else{if(A9===AG.NETWORK){BA="network";A7=mstrmojo.desc(11827,"Network");A0=Ap.getVisDesc("network");}else{if(A9===AG.KPICARD){BA="kpicard";A7=mstrmojo.desc(15800,"KPI");A0=Ap.getVisDesc("kpicard");}else{if(this.isCustomVis){BA=A9||"";A8=(A4&&A4[A9]&&A4[A9].d)||A9;A7=A8||mstrmojo.desc(14402,"CUSTOM VISUALIZATION");A0=this.errorDetails;}}}}A1=[{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:BA,visName:A7,visDesc:A0}];}else{A1=[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:A2}];}break;case Ay.AE_ERROR:A1=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:A3.getVisEmptyMsg("AE_ERROR",A2),markupSlots:{containerNode:function(){return this.domNode;}}}];break;default:A1=[{scriptClass:"mstrmojo.Container",cssClass:"error-msg",markupString:'<div class="{@cssClass}"><div class="error-content" style="visibility: visible">'+A2+"</div></div>",markupSlots:{containerNode:function(){return this.domNode;}}}];break;}return A1;},applyStyles2DomNode:function(A5,A8){var A0,A6=A5.style;if(Object.prototype.hasOwnProperty.call(A8,"backgroundColor")&&A8.backgroundColor!==""&&A8.backgroundColor!=="transparent"){var A4=1;if(Object.prototype.hasOwnProperty.call(A8,"opacity")&&A8.opacity!==""){A4=A8.opacity;}var A1=A8.backgroundColor,A7=function A7(A9){if(isNaN(A9)){A9=0;}A9%=16777216;return{b:A9%256,g:(A9>>8)%256,r:(A9>>16)%256};},A3="";if(A1){var A2=function A2(BA,BB){if(BA==="transparent"){return"rgba(0,0,0,0)";}BA=this.parseCSSColor(BA,false);var A9=A7(BA);return"rgba("+A9.r+" ,"+A9.g+" ,"+A9.b+" ,"+BB+" )";}.bind(this);if(A1.c1!==undefined&&A1.c2!==undefined&&A1.or!==undefined){A3=(Ar.buildGradient(A1.or,A2(A1.c1,A4),A2(A1.c2,A4))).v;}else{A3=A2(A1,A4);}A6.background=A3;}}else{A6.backgroundColor="rgba(0,0,0,0)";}for(A0 in A8){if(A0!=="backgroundColor"&&A0!=="opacity"&&Object.prototype.hasOwnProperty.call(A8,A0)&&A8[A0]&&A8[A0]!==""){A6[A0]=A8[A0];if(A0==="fontFamily"){A6[A0]="'"+A8[A0]+"'";}}}},parseCSSColor:function(A4,A1){var A0,A2;if(A4.length===7){if(A1===true){A0=A4[5]+A4[6]+A4[3]+A4[4]+A4[1]+A4[2];}else{A0=A4.slice(1);}}else{A0=[];var A3=A4.slice(1);if(A1===true){for(A2=2;A2>=0;A2--){A0.push(A3[A2]);A0.push(A3[A2]);}}else{for(A2=0;A2<3;A2++){A0.push(A3[A2]);A0.push(A3[A2]);}}A0=A0.join("");}return parseInt(A0,16);},positionDomNode:function(A2,A4){var A1,A7,A5,A3=["width","height","top","left","right","bottom"],A6=A3.length,A0=A2.style;for(A1=0;A1<A6;A1++){A7=A3[A1];A5=A4[A7];if(A5!==undefined){if((typeof A5)==="number"){A5+="px";}A0[A7]=A5;}}},getComputedFontStyle:function L(A2){var A0=mstrmojo.css.getComputedStyle(A2);var A3={};A3.fontFamily=A0.fontFamily;A3.fontSize=A0.fontSize;A3.fontStyle=A0.fontStyle;A3.fontWeight=A0.fontWeight;A3.fontVariant=A0.fontVariant;var A1=parseInt(A0.paddingLeft)||0,A4=parseInt(A0.paddingLeft)||0;A3.bonus=A1+A4;return A3;},splitWordIfTooLong:function(BA,A8,A3){var A6=[];var A7=BA.length;var A4;for(A4=0;A4<A7;A4++){var A1=BA[A4];while(true){var BB=this.measureTextWidth(A1,A3);if(BB>A8){var A9=(A8/BB)*A1.length;var A0=Math.max(Math.round(A9),1);while(A0>0){var A5=A1.substr(0,A0);var A2=Math.round(this.measureTextWidth(A5,A3));if(A2<=A8||A0===1){A6.push(A5);break;}else{A0--;}}A1=A1.substr(A0,A1.length-A0);}else{A6.push(A1);break;}}}return A6;},measureTotalTextSizeSplitting:function AI(A5,A4,A8,A7){A5=(A5!==undefined&&A5!==null)?A5.trim():A5;if(!A5||A5.length===0){return{width:0,height:0};}var A9=A5.split(" "),A3=0,A6=A9.length,A2,A0=[],A1=this.measureTextWidth(" ",A4,A8);for(A2=0;A2<A6;++A2){A0.push(this.measureTextWidth(A9[A2],A4,A8));}A3=this.getTextWidthSplitting(A0,A1,A7);if(A7){return{width:A3,height:this.measureTextHeight("H",A4,A8)*(A6===1?1:2)};}else{return{width:A3,height:this.measureTextHeight("H",A4,A8)};}},getTextWidthSplitting:function AS(A1,A2,BA){var A8=0,A9=A1.length,A6,A5;if(BA){var A7,A4,BB=0,A0=Infinity,A3=Infinity;for(A6=1;A6<A9;++A6){A7=0;A4=0;for(A5=0;A5<A6;++A5){if(A5!==0){A7+=A2;}A7+=A1[A5];}for(A5=A6;A5<A9;++A5){A4+=A1[A5];if(A5!==A9-1){A4+=A2;}}A3=Math.max(A7,A4);if(A3<A0){A0=A3;BB=A6;}if(A7>=A4){break;}}return A9===1?A1[0]:A0;}else{for(A6=0;A6<A9;++A6){A8+=A1[A6];}A8+=(A9-1)*A2;return A8;}},truncateTextToLineWithWordWrap:function u(BQ,BJ,BH,A6,BI,BA){var BE=BQ.split(" "),BK=BE.length;if(!BA){BE=this.splitWordIfTooLong(BE,BH,BJ);}var BX,BC=[],BS=[],A0=0,A4=BE.length,BZ=this.measureTextWidth(" ",BJ),A3=0,A9=false,BG=(BK===BE.length);BS.push(0);for(BX=0;BX<A4;BX++){var BO=this.measureTextWidth(BE[BX],BJ);if(!BA&&BO>BH){var A1=BE[BX];var BV=(BH/BO)*A1.length;BE[BX]=A1.substr(0,parseInt(BV,10));BO=BH;}BC.push(BO);A0+=BO;BS.push(A0);if(BX!==A4-1){A0+=BZ;}}var BU,BW,BM=A6;for(BU=0,BW=0;BW<BS.length;){var A8=BS[BW]-BS[BU];if(BU>0&&BW!==BU){A8-=BZ;}var A7=BS[BW+1]-BS[BU];if(BU>0&&BW+1!==BU){A7-=BZ;}if(A8<=BH&&((BW+1===BS.length)||(A7>BH))){A3=Math.max(A3,A8);BM--;if(BM===0||BW===A4){break;}else{BU=BW;BW++;}}else{BW++;}}if(BW>A4){BW=A4;}var BB=BS[BW]-BS[BU];if(BU>0&&BW!==BU){BB-=BZ;}var BP;if(BW>=A4&&BB<BH){BP=BE.join(" ");}else{A9=true;A3=BH;BP=BE.slice(0,BW).join(" ");var BD=this.measureTextWidth("...",BJ);if(BB+BD<=BH){if(BB+BZ+BD>BH){BP+="...";}else{var BY=BE[BW],BF;for(var BL=1;BL<BY.length;BL++){BF=this.measureTextWidth(BY.substr(0,BL),BJ);if(BB+BZ+BF+BD>BH){break;}}BP+=" "+BY.substr(0,BL-1)+"...";}}else{if(BP.charAt(BP.length-1)===" "){BP=BP.substr(0,BP.length-1);}var BN=BP.lastIndexOf(" ");var A2=BP.length-1-BN;if(A2===3){BP=BP.substr(0,BP.length-3)+" ...";}else{var BR=0,A5="",BT=0;while(BR<BD&&BP.length>BT){BT++;A5=BP.substr(BP.length-BT,BP.length);BR=this.measureTextWidth(A5,BJ);}BP=BP.substr(0,BP.length-BT)+"...";}}}if(BI){return{text:BP,truncated:A9,maxLineLen:A3,canWordWrap:BG};}return BP;},measureSuperTextWidth:function AH(A1,A2,A0,A3){return A1?this.measureTextWidth("<sup>"+A2+"</sup>",A0,A3):this.measureTextWidth(A2,A0,A3);},splitTokenIfTooLong:function q(BB,A9,A3){var A7=[];var A8=BB.length;var A4,A1,BC,A6,BD;for(A4=0;A4<A8;A4++){A1=BB[A4];A6=A1.isSuper;while(true){BC=A1.v;if(A1.textWidth!==undefined){BD=A1.textWidth;}else{BD=A1.textWidth=this.measureSuperTextWidth(A6,BC,A3);}if(BD>A9){var BA=(A9/BD)*BC.length;var A0=Math.max(Math.round(BA),1);while(A0>0){var A5=BC.substr(0,A0);var A2=Math.round(this.measureSuperTextWidth(A6,A5,A3));if(A2<=A9||A0===1){A7.push({v:A5,isSuper:A6,textWidth:A2});break;}else{A0--;}}A1={v:BC.substr(A0,BC.length-A0),isSuper:A6};}else{A7.push(A1);break;}}}return A7;},truncateTextToLineWithWordWrapForTokens:function Ak(BA,A4,BT,BL,BU,BG){var BO=BA.length;BA=this.splitTokenIfTooLong(BA,BT,A4);var BS,BF=[],A0=0,BJ=BA.length,A1=0,BK=false,A6=(BO===BA.length),A8,BD,BM,A2,BQ,A9,BE;if(BG&&!A6){return{canWordWrap:A6};}BF.push(0);for(BS=0;BS<BJ;BS++){A8=BA[BS];BM=A8.v;BD=A8.isSuper;if(A8.textWidth!==undefined){A2=A8.textWidth;}else{A2=A8.textWidth=this.measureSuperTextWidth(BD,BM,A4);}if(A2>BT){var BR=(BT/A2)*BM.length;A8.v=BM.substr(0,parseInt(BR,10));A2=A8.textWidth=BT;}A0+=A2;BF.push(A0);}var BC,BN,BB=BL;for(BC=0,BN=0;BN<BF.length;){var A7=BF[BN]-BF[BC];var A5=BF[BN+1]-BF[BC];if(A7<=BT&&((BN+1===BF.length)||(A5>BT))){A1=Math.max(A1,A7);BB--;if(BB===0||BN===BJ){break;}else{BC=BN;BN++;}}else{BN++;}}if(BN>BJ){BN=BJ;}var BI=BF[BN]-BF[BC];var BV;if(BN>=BJ&&BI<BT){BV=BA;}else{BK=true;A1=BT;BV=BA.slice(0,BN);var A3=this.measureTextWidth("...",A4);if(BI+A3<=BT){A9=BA[BN];BM=A9.v;BD=A9.isSuper;for(BQ=1;BQ<BM.length;BQ++){BE=this.measureSuperTextWidth(BD,BM.substr(0,BQ),A4);if(BI+A3+BE>BT){break;}}if(BQ>1){A8={v:BM.substr(0,BQ-1),isSuper:BD};A8.textWidth=this.measureSuperTextWidth(BD,A8.v,A4);BV.push(A8);BV.push({v:"...",textWidth:A3});}}else{var BH=0,BP;for(BS=BV.length-1;BS>=0;BS--){A8=BV[BS];BM=A8.v;BD=A8.isSuper;BP=0;for(BQ=BM.length-1;BQ>=0;BQ--){BP=this.measureSuperTextWidth(BD,BM.substr(BQ),A4);if(BH+BP>=A3){break;}}if(BQ>=0){break;}else{BH+=BP;}}if(BS>=0){if(BQ>0){A8.v=BM.substr(0,BQ);A8.textWidth=this.measureSuperTextWidth(BD,A8.v,A4);BV=BV.slice(0,BS+1);}else{if(BQ===0){BV=BV.slice(0,BS);}}BV.push({v:"...",textWidth:A3});}else{BV=[{v:"...",textWidth:A3}];}}}if(BU){return{text:BV,truncated:BK,maxLineLen:A1,canWordWrap:A6};}return BV;},getRankMode:function Q(A6){var A8=1,A7=2,A5=3,A1=4,A3=5,A0=6,A4=7,A2=Z.INVALID;if(A6){if(Ad(A6,A5,A7)){A2=Z.TOP_PERCENT;}else{if(Ad(A6,A5,A8)){A2=Z.BOTTOM_PERCENT;}else{if(Ad(A6,A0,A1)){A2=Z.BOTTOM;}else{if(Ad(A6,A0,A3)){A2=Z.TOP;}else{if(Ad(A6,A4)){A2=Z.VALUE;}}}}}}return A2;},getColorByTitle:function f(A1,A0){if(A0===Z.BOTTOM_PERCENT||A0===Z.TOP_PERCENT){A1=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",A1);}else{if(A0===Z.BOTTOM||A0===Z.TOP){A1=mstrmojo.desc(2788,"Rank of ##").replace("'##'",A1);}}return A1;},getAbsoluteSizeByTitle:function AL(A0){return mstrmojo.desc(16781,"Absolute value of ##").replace("##",A0);},getColorByFormatStr:function p(A1,A0){if(A0===Z.BOTTOM_PERCENT||A0===Z.TOP_PERCENT){A1="0%;(0%)";}else{if(A0===Z.BOTTOM||A0===Z.TOP){A1="";}}return A1;},getColorByItems:function Al(A0,BA,BH,BD,A8,A6,BE){var BC=[],BI,A2,A7=mstrmojo.num,A5,A9;if(A0===undefined||A0.length===0){return BC;}var BK=true;if(A0.length>1){if(A0[0].ceil===A0[1].flr){BK=false;}else{BK=true;}}for(BI=0;BI<A0.length;BI++){var BJ=A0[BI],A4={},A1=BJ.ceil,BG=BJ.flr;if((BI===0&&BK)||(BI===A0.length-1&&!BK)){if(BA===Z.BOTTOM_PERCENT||BA===Z.TOP_PERCENT){A4.flr=BG/100;A4.ceil=1;}else{if(BA===Z.TOP||BA===Z.BOTTOM){BG+=1;A4.flr=Math.floor(BG);A4.ceil=A8;}else{A4.flr=BG;A4.ceil=BH;}}A9=A4.ceil;}else{if((BI===0&&!BK)||(BI===A0.length-1&&BK)){if(BA===Z.BOTTOM_PERCENT||BA===Z.TOP_PERCENT){A4.flr=0;A4.ceil=A1/100;}else{if(BA===Z.TOP||BA===Z.BOTTOM){A4.flr=0;A4.ceil=Math.floor(A1);}else{A4.flr=BD;A4.ceil=A1;}}A5=A4.flr;}else{if(BA===Z.BOTTOM_PERCENT||BA===Z.TOP_PERCENT){BG=BG/100;A1=A1/100;}else{if(BA===Z.TOP||BA===Z.BOTTOM){BG+=1;BG=Math.floor(BG);A1=Math.floor(A1);}}A4.flr=BG;A4.ceil=A1;}}if(BA===Z.TOP||BA===Z.BOTTOM){A4.ceil=A4.ceil>A8?A8:A4.ceil;}if(A6){A4.label=A7.formatByMask(A6,A4.flr);if(A4.flr!==A4.ceil){A4.label+=" - "+A7.formatByMask(A6,A4.ceil);}}else{A4.label=A4.flr;if(A4.flr!==A4.ceil){A4.label+=" - "+A4.ceil;}}if(BJ.fmt&&BJ.fmt.bc){A4.color=BJ.fmt.bc;}else{A4.color=BE;}BC.push(A4);}BC=BC.filter(function(BL){return BL.flr<=BL.ceil&&!(BL.flr>A9||BL.ceil<A5);});if(BA!==Z.VALUE){if(BC[0]&&(BC[0].label===0)){BC.shift();}}if(BA===Z.TOP||BA===Z.BOTTOM){A2=A8;}else{if(BC.length>0){if(BK){A2=BC[0].ceil-BC[(BC.length-1)].flr;}else{A2=BC[(BC.length-1)].ceil-BC[0].flr;}}}var BF=0,BB,A3;for(BI=0;BI<BC.length;BI++){if(BI===BC.length-1){BC[BI].scopePercent=1-BF;}else{if(BA===Z.TOP||BA===Z.BOTTOM){A3=BC[BI].ceil-BC[BI].flr+1;}else{A3=BC[BI].ceil-BC[BI].flr;}BB=A3/A2;BC[BI].scopePercent=BB;BF+=BB;}}return BC;},getDefaultColorByItems:function(A3,A1,A2){var A0={};A0.label=A2+" - "+A1;A0.flr=A2;A0.ceil=A1;A0.color=A3;A0.scopePercent=1;return[A0];},getNumberFormat:function(A3,A1){var A4=A3.nf,A2=A3.gvs;function A0(){var A7=(A2&&A2.items&&A2.items[0]&&A2.items[0].items)||[],A6=A7[A1]||{},A5=A6.nfs;return typeof A5==="string"?A5:"";}if(A4&&A4[A1]&&typeof A4[A1].nfs!=="string"){A4[A1].nfs=A0();}return A4&&A4[A1]&&A4[A1].nfs;},hasOnlyMetricsOnColumn:function(A1){var A0=(A1&&A1.gts&&A1.gts.col)||[];return A0.every(function(A2){return A2.otp===AA.DssTypeUnknown&&(A2.es||[]).every(function(A3){return A3.otp===AA.DssTypeMetric;});});},hasNoMetricOnRow:function(A1){var A2=(A1&&A1.gts&&A1.gts.row)||[],A0=function(A3){return A3.otp!==AA.DssTypeMetric;};return A2.every(A0);},getAttMetricCount:function(){var A3=(this.getEditingGridData&&this.getEditingGridData())||(this.model&&this.model.data),A6=A3&&A3.gsi,A5=(A6&&mstrmojo.models.template.DataInterface.getGSI(A6).rows)||[],A2=[],A1=[],A0=0,A4=0;mstrmojo.models.template.DataInterface.forEachGSI(A6,function(A7){A4+=A7.mx.length||0;A2=A2.concat(A7.cols||[]);});A1=A1.concat(A5).concat(A2);At.forEach(A1,function(A7){if(A7.t!==AA.DssTypeMetric){A0++;}});return{attCount:A0,metricCount:A4};},isOnExpressMode:function(){return mstrApp.isExpress;},isConsolidation:function(A0){return A0.t===47&&A0.st===12033;},getItemValue:function(A3,A5,A2){var A0=j.getIdPresentation(A3),A1=this.isConsolidation(A2);A3=A3.replace(/\*:/g,"\\:");switch(A5){case"old":case"oldLong":switch(A0){case"old":case"oldLong":return A3;case"terse":case"terseLong":switch(A3[0]){case"V":return A3.substring(1).split(";")[0];case"n":return"HF:"+ +j.terseLong2OldShort(A3)+":47";default:return j.terseLong2OldShort(A3);}}break;case"terse":case"terseLong":switch(A0){case"old":return A1?("V"+A3+";"+A2.did):j.oldShort2terseLong(A3,"h");case"oldLong":switch(A3.substring(0,2)){case"HF":var A4=A3.substr(3).split(":");if(A4.length>3){A4.pop();}return j.oldShort2terseLong(A4.join(":"),"n");default:return A3;}case"terse":case"terseLong":return A3;}break;default:return A3;}},getNormalizedFormElementId:function(A2,A4,A1){var A0=j.getIdPresentation(A4),A3=A1&&this.isConsolidation(A1);if(A3&&(A0==="old"||A0==="oldLong"||A0==="terseLong")){return this.getItemValue(A4,"terseLong",A1);}else{return A2.getNormalizedFormElementId(A4);}},modifyScExp:function(A6,A0,BC,A5){if(!A6||!A0){return ;}var A1,A9,BB,BA,A4,A3,A2,A8=this,A7=function A7(BD){if(BD.nds){At.forEach(At.ensureArray(BD.nds),function(BE){A7(BE);});}else{A1=BD.es;At.forEach(At.ensureArray(A1),function(BE){BB=BE.v;A4=A5[BB];if(!A4){A4=A8.getNormalizedFormElementId(BC,BB,BD.a);A5[BB]=A4;}At.forEach(At.ensureArray(A0),function(BF){A9=BF.es;At.forEach(A9||[],function(BG){A2=false;BA=BG.id;if(BA===BB){A2=true;}else{A3=A5[BA];if(!A3){A3=A8.getNormalizedFormElementId(BC,BA,BD.a);A5[BA]=A3;}if(A4===A3){A2=true;}}if(A2){BE.v=BG.id;BE.n=BG.n;return false;}});if(A2){return false;}});});}};A7(A6);},modifyScExpDeprecated:function(A6,A7,A4,A2){if(!A6||!A7){return ;}var A3=A6.nds,A1,A0,A5;At.forEach(A3||[],function(A8){A1=A8.nds;At.forEach(A1||[],function(A9){A0=A9.es;At.forEach(A0||[],function(BA){At.forEach(A7||[],function(BB){At.forEach(BB||[],function(BC){A5=BC.es;At.forEach(A5||[],function(BD){if(A4.call(A2,BD.id,BA.v)){BA.v=BD.id;BA.n=BD.n;}});});});});});});},getMouseOffset:function(A1){var A0=(A1.offsetX!==undefined)?A1.offsetX:(A1.layerX),A2=(A1.offsetY!==undefined)?A1.offsetY:(A1.layerY);return{x:A0,y:A2};},translateLineStyle:function(A0){var A2=["none","solid","solid","dashed","dotted"],A1=["1px","1px","2px","1px","1px"];return{width:A1[A0]||"0px",style:A2[A0]||"none"};},getVisStyle:function(){var A0=mstrmojo.VisUtility;return A0.getPropertyByPath(this,"model.data.visName")||A0.getPropertyByPath(this,"model.data.vis.vn");},getGroupAndCalculationContextMenuForDataPoints:function(BC,BR){var BE,BG=[],A2=[],BO=[],A7=BR.fnCellName,BI=BR.fnUnique,A6=BR.fnMakeNode,BM=BC.getCellForNode.bind(BC),BT=BR.selection,BL=BR.hideGroupMenu,BB=BR.hideCalculationMenu;var A5=new m.ui.menus.MenuConfig(),A1=new m.ui.menus.MenuConfig(),BK=new m.ui.menus.MenuConfig(),BQ=new m.ui.menus.MenuConfig();function BS(BU){BC.cmSelCells=BG[BU].cmSelCells;BC.derivedElementGroup(BM(BC.cmSelCells[0]));}function A8(BU){BC.cmSelCells=A2[BU].cmSelCells;BC.derivedElementsEdit(BM(BC.cmSelCells[0]));}function BH(BU){BC.cmSelCells=A2[BU].cmSelCells;BC.removeQuickDE(BM(BC.cmSelCells[0]));}function BF(BU){BC.cmSelCells=A2[BU].cmSelCells;BC.renameDEList(BM(BC.cmSelCells[0]));}function BJ(BU){a(BC,BM(BC.cmSelCells[0]),BU,false);}function A0(BU){a(BC,BM(BC.cmSelCells[0]),BU,true);}function A4(BV){var BU=BM(A2[BV].cmSelCells[0]);BC.removeQuickDE(BU);}function BP(BV){var BU=BM(A2[BV].cmSelCells[0]);BC.editDECalculation(BU);}function A9(BV,BU){return function(){var BW=new m.ui.menus.MenuConfig();BW.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);BW.addRadioMenuGroup(null,BV,BU,"checkMark",undefined,true);return BW;};}function BD(BU){BU=BU||[];function BV(BZ){var BW=BZ.extra||{},Ba=BZ.setup||mstrmojo.emptyFn,BX=BZ.action||mstrmojo.emptyFn,BY=[];Ba(BY,BW);BX(BY,BW);}BU.forEach(BV);}var A3=[{name:"group",setup:function(BU){BG.forEach(function(BV){BC.cmSelCells=BG[BV.v].cmSelCells;if(!Object.prototype.hasOwnProperty.call(A2,BV.v)&&c(BC)){BU.push(BV);}});},action:function(BV){var BU;if(BV.length===1){BU=BV[0].v;A5.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){BC.cmSelCells=BG[BU].cmSelCells;BC.derivedElementGroup(BM(BC.cmSelCells[0]));});}if(BV.length>1){A5.addPopupMenuItem(mstrmojo.desc(1911,"Group"),BC.id,A9(BS,BV),"xt");}}},{name:"edit-group",setup:function(BU){A2.forEach(function(BW){var BV=Av(BC,A2[BW.v].cmSelCells[0]);if(BV&&BV.t===X.LIST){BU.push(BW);}});},action:function(BV){if(BV.length===1){var BU=A2[BV[0].v].cmSelCells,BW=BM(BU[0]);A1.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){BC.cmSelCells=BU;BC.derivedElementsEdit(BW);});A1.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){BC.cmSelCells=BU;BC.removeQuickDE(BW);});BQ.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){BC.cmSelCells=BU;BC.renameDEList(BW);});}if(BV.length>1){A1.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),BC.id,A9(A8,BV),"xt");A1.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),BC.id,A9(BH,BV),"xt");BQ.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),BC.id,A9(BF,BV),"xt");}}},{name:"calculation",setup:function(BU){BO.forEach(function(BX,BW,BV){BC.cmSelCells=BV[BX.v].cmSelCells;var BY=Av(BC,BC.cmSelCells[0]);if(!(BY&&BY.t===X.RESIDUE)&&w(BC)){BU.push(BX);}});},action:function(BU){if(BU.length===1){A5.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),BC.id,function(){var BV=BU[0].v,BW=new m.ui.menus.MenuConfig();BC.cmSelCells=BO[BV].cmSelCells;BW.addRadioMenuGroup(null,BJ,x(BC,null,A7).items,"checkMark",undefined,true);return BW;},"xt");}if(BU.length>1){A5.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),BC.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BU,selectedIndex:0,onitemSelected:function(BV){var BW=BV.v;BC.cmSelCells=BO[BW].cmSelCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",x(BC,null,A7).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BW,BV){a(BC,BM(BC.cmSelCells[0]),BV.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(BU){A2.forEach(function(BW){var BV=Av(BC,A2[BW.v].cmSelCells[0]);if(BV&&BV.t===X.CALCULATION&&w(BC)){BU.push(BW);}});},action:function(BU){function BV(){var BW=BU[0].v;BC.cmSelCells=A2[BW].cmSelCells;var BZ=Av(BC,BC.cmSelCells[0]),BY=x(BC,BZ,A7),BX=new m.ui.menus.MenuConfig();BX.addRadioMenuGroup(BY.selectedItem.value,A0,BY.items,"checkMark",undefined,true);return BX;}if(BU.length===1){BK.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),BC.id,BV,"xt");BK.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var BW=BU[0].v;BC.cmSelCells=A2[BW].cmSelCells;var BX=BM(BC.cmSelCells[0]);BC.removeQuickDE(BX);});BQ.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var BW=BU[0].v;BC.cmSelCells=A2[BW].cmSelCells;var BX=BM(BC.cmSelCells[0]);BC.editDECalculation(BX);});}if(BU.length>1){BK.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),BC.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},hasToggleItem:true,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:BU,selectedIndex:0,onitemSelected:function(BX){var BY=BX.v;BC.cmSelCells=A2[BY].cmSelCells;var BZ=Av(BC,BC.cmSelCells[0]);var BW=x(BC,BZ,A7);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",BW.items);this.parent.checkList.set("selectedItem",BW.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(BX,BW){a(BC,BM(BC.cmSelCells[0]),BW.checkList.selectedItem.v,true);}});});BK.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),BC.id,A9(A4,BU),"xt");BQ.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),BC.id,A9(BP,BU),"xt");}}}];BE=BI(BT);BE.forEach(function(BV){var BX=A6(BV),BU=BM(BX),BW,BY,BZ;if(!BC.model.supportsViewFilterActions(BU.tid)){return ;}BW=BU.dei===undefined?BG:A2;BY=BU.tid;BZ=BC.model.getObjectInfo(BY).n;if(BW[BY]===undefined){BW[BY]={};BW[BY].cmSelCells=[];BW.push({n:BZ,v:BY,text:BZ,value:BY});}BW[BY].cmSelCells.push(BX);if(BO[BY]===undefined){BO[BY]={};BO[BY].cmSelCells=[];BO.push({n:BZ,v:BY,text:BZ,value:BY});}BO[BY].cmSelCells.push(BX);});var BA=mstrmojo.VisUtility;var BN=BA.getVisStyle.call(BC);if(BN===AG.HEAT_MAP){A3.splice(2,2);}if(BL){A3.splice(0,2);}if(BB){A3.splice(2,2);}BD(A3);return{createDe:A5,editGroup:A1,editCalculation:BK,renameDe:BQ};},getGroupAndCalculationContextMenu:function(A9,BO,BL){var BN=A9,BG=BL.skipSingleAttrCheck||BN.isSingleAttrSelection(),A3=false,A5=BN.isSingleContextMenuSelection(),BA=BN.getDEInfo(BO),A4=BA&&BA.deObject,BK=BA&&BA.de,BE=A4&&BN.getOthersDEInfo(A4),BC=BN.getContextMenuSelections(),BJ=true,A7=BL.fnCellName,BM=this.getPropertyByPath(BN,"model.data.visName")||this.getPropertyByPath(BN,"model.data.vis.vn"),BH=BL.hideGroupMenu,A8=BL.hideCalculationMenu;var A6=new m.ui.menus.MenuConfig(),A1=new m.ui.menus.MenuConfig(),BD=new m.ui.menus.MenuConfig(),BI=new m.ui.menus.MenuConfig();BN.cmSelCells=BL.selection;if(A9.model.supportsViewFilterActions(BO.tid)){if(!BH){if((A3||BG)&&Ab(BO,AE)&&c(BN)){A6.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){A9.derivedElementGroup(BO);});}if(A5&&BK&&BK.t===X.LIST){A1.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){A9.derivedElementsEdit(BO,BA);});A1.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){A9.removeQuickDE(BO);});BI.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){A9.renameDEList(BO);});}}if(!A8){var BB=function(BP){a(BN,BO,BP,false);},BF=function(BP){a(BN,BO,BP,true);};if(BE&&!A5&&BG){W.forEach(BC,function(BP){if(BP[0]&&BP[0].eid.indexOf(BE.id)>-1){BJ=false;return false;}});}if(BM!=="VIHeatMapVisualizationStyle"&&!(A5&&BK&&BK.t===X.RESIDUE)&&(A3||BG)&&Ab(BO,AP)&&w(BN)){var A0=function(){var BP=new m.ui.menus.MenuConfig(),BQ=x(BN,null,A7);BP.addRadioMenuGroup(null,BB,BQ.items,"checkMark",undefined,true);return BP;};A6.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,A0,"xt");}if(A5&&BK&&BK.t===X.CALCULATION&&w(BN)){var A2=function(){var BP=new m.ui.menus.MenuConfig(),BQ=x(BN,BK,A7);BP.addRadioMenuGroup(BQ.selectedItem.value,BF,BQ.items,"checkMark",undefined,true);return BP;};BD.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,A2,"xt");BD.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){A9.removeQuickDE(BO);});BI.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){A9.editDECalculation(BO);});}}}return{createDe:A6,editGroup:A1,editCalculation:BD,renameDe:BI};},isHostedPopupNode:function(A3,A2,A1,A0){return AT(A3,A2,"mstrmojo-popup-widget-hosted",A1,A0);},isMojoEditorNode:function(A3,A2,A1,A0){return AT(A3,A2,"mstrmojo-Editor",A1,A0);},applyStyle2Legend:function(A3,A2,A1){var A0,A5={},A4={};for(A0 in A3){if(A0.indexOf("font")>=0||A0.indexOf("color")>=0||A0.indexOf("textDecoration")>=0){A5[A0]=A3[A0];}else{A4[A0]=A3[A0];}}if(A2){A2.style.background="";this.applyStyles2DomNode(A2,A4);}if(A1){this.applyStyles2DomNode(A1,A5);}},mergeMenuConfigs:function AR(A1,A0){function A2(A4,A5,A3){if(!A5){return ;}if(!A3&&A4.hasMenuItems()&&A5.hasMenuItems()){A4.addSeparator();}if(A5.hasMenuItems()){A4.absorbMenuItems(A5);if("function"===typeof A5.destroy){A5.destroy();}}}return A0.reduce(function(A3,A4){A2(A3,A1[A4.name],A4.noSeparator);return A3;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(A1,A0,A2){A1.addDisposable(A0);A1.absorbMenuItems(A0);if(A2&&A0.menus.length>0){A1.addSeparator();}},addWheelListener:(function(){var A3=mstrmojo.dom,A2=A3.attachEvent,A1=A3.preventDefault,A4;function A0(A8,A7,A9,A6){var A5=(A4==="wheel")?A9:function(BA){if(!BA){BA=window.event;}var BC={originalEvent:BA,target:BA.target||BA.srcElement,type:"wheel",deltaMode:(BA.deltaMode!==undefined?BA.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){A1(window,BA);}},BB=this;if(A4==="mousewheel"){BC.deltaY=-BA.wheelDelta;if(BA.wheelDeltaX!==undefined){BC.deltaX=-BA.wheelDeltaX;}}else{BC.deltaY=BA.detail;}return A9.call(BB,BC);};return A2(A8,A7,A5,A6);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){A4="wheel";}else{A4=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(A6,A7,A5){return A0(A6,A4,A7,A5);};}()),isNearZero:function(A1,A0){A0=A0||5;var A2=1/Math.pow(10,A0);return(Math.abs(A1)<A2);},hasMergedRowCells:function(A0){return false;},getMockUpThresholds:function(A2,A3){var A0=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];W.forEach(A0,function(A5){var A4=A5.expr.nds[0].m;A4.did=A2;A4.n=A3;});var A1={};A1[A2]=A0;return A1;},generateThresholdsInfo:function(A2,A7,A0,A4){var A6=A0.length,A1=[],BA,A3,BB=0,A9=0;for(var A5=0;A5<A6;A5++){A3=Math.round(A4[A5]*100);A9=BB;BB=A3||100;BA={tid:A5+1,n:"threshold "+A5,scope:1,rtp:2,rtxt:"",fmt:{bc:A0[A5],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:A2,n:A7},cs:[{v:A3+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:BB,flr:A9};A1.push(BA);}var A8={};A8[A2]=A1;return A8;},psPt2CssPt:function(A2,A1){var A0=parseInt(A2,10)*0.75;if(A1 instanceof Function){A0=A1(A0);}return A0+"pt";},captureEventOnce:function(A5,A4,A0,A3,A2){function A1(A6){A4.call(A0,An.newDomEvent(A5,window,A6||window.event),A2);AN.detachEvent(A3,A5,A1);}A2=A2||{};A3=A3||document;AN.attachEvent(A3,A5,A1);},getPropertyByPath:function(A4,A3,A0){var A1,A2;if(typeof A3!=="string"){return A0;}A1=A3.split(".");A2=A1.every(function(A6){var A5=A4[A6];if(A5!==undefined){A4=A5;return true;}return false;});return A2?A4:A0;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(A0,A1){if(A1){Object.keys(A1).forEach(function(A2){A0[A2]=A1[A2];});}return A0;},{});},toggleControlEnabled:function(A0,A1){[].concat(A0).forEach(function(A2){A2.set("enabled",!!A1);});},findInArray:function(A3,A2,A1){var A5=-1,A4,A0;if(!Array.isArray(A3)){return A5;}for(A4=A1===undefined?0:A1,A0=A3.length;A4<A0;A4+=1){if(A2(A3[A4])){return A4;}}return A5;},arrayUnique:function(A0,A2){if(!Array.isArray(A0)){return A0;}var A1=mstrmojo.VisUtility;return A0.filter(function(A3,A4){return A1.findInArray(A0,function(A5){return A2(A3,A5);},A4+1)===-1;});},range:function(A0,A4,A3){A3=A3||1;var A2,A1=[];for(A2=A0;A2!==A4;A2+=A3){A1.push(A2);}return A1;},containsImg:function(A0,A1){return A0===Aq.DssBaseFormPicture||(A0===Aq.DssBaseFormHTMLTag&&(A1||"").toLowerCase().match(n));},drawDashLine:function J(A8,A2,A6,A1,A4,A0,A7){var A5=(A2===A1),A3;A8.beginPath();A8.moveTo(A2,A6);if(A5){A3=0;A6+=A0;while(A6<=A4){if(A3%2===0){A8.lineTo(A2,A6);A6+=A7;}else{A8.moveTo(A2,A6);A6+=A0;}A3++;}if(A3%2===0){A8.lineTo(A1,A4);}}else{A3=0;A2+=A0;while(A2<=A1){if(A3%2===0){A8.lineTo(A2,A6);A2+=A7;}else{A8.moveTo(A2,A6);A2+=A0;}A3++;}if(A3%2===0){A8.lineTo(A1,A4);}}A8.stroke();},repeat:function(A2,A3){var A0=[],A1;A3=Math.max(0,A3);for(A1=0;A1<A3;A1+=1){A0[A1]=A2;}return A0;},isHierarchyObject:function(A0){return(A0&&A0.t)===AA.DssTypeDimension;},selectDropZonePanel:function(A0){AK(A0,"editPanel");},selectPropertyPanel:function(A1,A2){AK(A1,"propertiesPanel");var A0=A1.edtModel;if(A0){A0.selectTargetByValue(A2);}},pluck:function(A1,A0){if(!W.isArray(A1)){return A1;}return A1.map(function(A2){return A2&&A2[A0];});},pick:function(A1,A0){return A0.reduce(function(A3,A2){A3[A2]=A1[A2];return A3;},{});},isColorManuallySet:function(A2,A1){var A0=Ax(A2,A1);if(A0){return A0.isManual;}},getCombColor:function(A2,A1){var A0=Ax(A2,A1);if(A0){return A0.color;}},setColorPickerShowAutomatic:function(A1,A0){A1.children[0].fillColor.colorPicker.showAutomatic=A0;},setColorPickerShowGradient:function(A2,A1){var A0=b.walk("fillColorAndTrans.fillColor.colorPicker",A2);if(A0){A0.showGradient=A1;}},getCharGroupValueChangeCb:function(A0){var A1=(function(){var A2={};A2[Ac.FONT_WEIGHT]=Ai.FS_BOLD;A2[Ac.FONT_STYLE]=Ai.FS_ITALIC;A2[Ac.UNDERLINE]=Ai.FS_UNDERLINE;A2[Ac.LINE_THROUGH]=Ai.FS_STRIKETHROUGH;return function(A3,A4){return A3^A2[A4];};}());return function(A3,A2){if(A0 instanceof Function){A0=A0();}if(!A0){return ;}switch(A3){case Ac.COLOR:A0.fontColor.fill.value.setValue(A2);break;case Ac.FONT_SIZE:A0.fontSize.setValue(A2);break;case Ac.FONT_FAMILY:A0.fontFamily.setValue(A2);break;case Ac.FONT_WEIGHT:case Ac.FONT_STYLE:case Ac.UNDERLINE:case Ac.LINE_THROUGH:A0.fontStyle.setValue(A1(A0.fontStyle.getValue(),A3));break;}};},getMetricsInDropZone:AX,addLegendFontChangeListeners:function(A1,A2){var A0=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];Ao(A0,A1,A2);},addLegendBackgroundChangeListeners:function(A1,A2){var A0=["lgdBgFillClr","lgdBgFillTrans"];Ao(A0,A1,A2);},isValidDropZone:function(A0){if(A0===undefined){return false;}var A2=Object.keys(A0).filter(function(A3){return A3!=="visProp";});var A1=b.copyProps(A2,A0);return A0&&!b.equals(A1,{});},unitExistInTemplate:function(A3,A0){var A2,A5,A4=A0.row,A1=A0.col;for(A2=0,A5=A4.length;A2<A5;A2++){if(A4[A2].id===A3){return true;}}for(A2=0,A5=A1.length;A2<A5;A2++){if(A1[A2].id===A3){return true;}}return false;},findDisabledUnits:function(A9,BA){var A5,A1,A3=BA.docModel.datasets,A0=A9.gts,A7=A9.datasetId,A4=A3[A7]||{},A6=A4.att||[],A8=[];var A2=mstrmojo.VisUtility;if(A6){for(A5=0,A1=A6.length;A5<A1;A5++){if(!A2.unitExistInTemplate(A6[A5].did,A0)){A8.push(A6[A5]);}}}return A8;},getDrillCandidates:function(A5,A6){var A8=A5.modelData,BA=A5.model,A4=BA.docModel.datasets,A0=A8.gts,A2=mstrmojo.VisUtility,BB=A2.findDisabledUnits(A8,BA),A1=[],A3=(function(){var BC;if(A6){W.forEach(A0.row.concat(A0.col),function(BD){if(BD.id&&BD.id===A6){BC=BD.dp;}});}return BC;}()),A7=function(BC,BF){var BD=W.find(BC,"did",BF.id),BE=BC[BD];if(BE&&!BE.hide){BF.n=BE.n;return true;}return false;},A9=W.filter(A3,function(BE){var BC;for(BC in A4){var BD=A4[BC];if(A7(BD.att,BE)){return true;}}return false;});if(A9){A1=W.filter(BB,function(BD){for(var BC in A9){if(A9[BC].n===BD.n){return true;}}return false;});}return A1;},getDrillSubMenu:function(A0){if(!A0||!A0.items||!A0.drillAction){return{};}var A4=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),A1=A0.items,A3=A0.drillAction,A2=[];if(mstrmojo.resolveFeature("sort-drill-paths")){A1.sort(function(A6,A5){if(A6.n>A5.n){return 1;}if(A6.n<A5.n){return -1;}return 0;});}A1.forEach(function(A7,A5){if(A2.indexOf(A7.did)===-1){A2.push(A7.did);if(A7.att){var A6=mstrmojo.VisUtility;var A8={};b.copy(A0,A8);A8.items=A1[A5].att;A4.addPopupMenuItem(A7.n,this.id,A6.getDrillSubMenu,"xt",A8);}else{A4.addMenuItem(A7.n,"xt",A3,b.copy(A0,{drillUnit:A7}));}}});return A4;},getDrillMenu:function(A6,A7,BC,A0){var A8=A6.model,A3=mstrmojo.VisUtility,A9=A3.getDrillCandidates(A6,A7),BA=A9.length,A5=A8.docModel,A2=A5.datasets[A6.modelData.datasetId],BG,BB=[],BE=-1,BD,BF,A4,A1;if(A2&&A5.isMDXDataset(A2)&&!A5.isRADataset(A2)){A3.sortMdxDrillCandidates(A9);BG=A2.tables[0];BG.dimensions.forEach(function(BH){A4=true;BD=-1;BH.hierarchies.forEach(function(BI){A1=true;BI.att.forEach(function(BJ){BF=At.findBin(A9,BJ,"did",BA);if(BF!==-1){if(A4){BB.push({id:BH.did,did:BH.did,n:BH.n,att:[]});BE++;A4=false;}if(A1){BB[BE].att.push({id:BI.did,did:BI.did,n:BI.n,att:[]});BD++;A1=false;}BB[BE].att[BD].att.push(A9[BF]);}});});});}else{BB=A9;}return A3.getDrillSubMenu(b.copy(A0,{items:BB,drillAction:BC}));},sortMdxDrillCandidates:function(A0){A0.sort(function(A2,A1){if(A2.did<A1.did){return -1;}if(A2.did>A1.did){return 1;}return 0;});return A0;},getDrillMenuItemsCallback:function(A2,A3,A0,A1){return function(){var A5=mstrmojo.VisUtility;var A6=A5.getDrillCandidates(A2,A1),A4=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});A6.forEach(function(A7){A4.addMenuItem(A7.n,"xt",A3,b.copy(A0,{drillUnit:A7}));});return A4;};},doDrill:function(A2,BG,BB,BH){var BI=A2;function A8(BK){return BK.model.controller.cmdMgr;}function BE(){return{success:function BK(){var BL=mstrmojo.VisUtility;BL.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var A1=BI.model,BF=(BI.getDocModel&&BI.getDocModel())||BI.model.docModel,BD=BF.getDataService(),A5=BD.newUpdate();var A7=true;if(BF.prefs&&BF.prefs.rtprnt){A7=parseInt(BF.prefs.rtprnt,10)===1;}else{if(A1.xtab.defn.tkp!==undefined){A7=parseInt(A1.xtab.defn.tkp,10)===-1;}}BH=BH||{};BH.keepParent=A7;var A6=BB.call(A2,BG,BH);var A9=BI.zonesModel,BJ=A9.getUpdateCallback(),BA=BI.model.controller||BF.controller,A3=BA._getXtabCallback(BI);A5.add(A6,As(BJ,A3));var A0=A1.getSelectorDataFromTemplateLimit(BI.model.data.tpl).concat({keepOnly:true,data:BI.getContextMenuSelections()}),BC=BF.getKeepOnlyOrExcludeAction(BI.k,A0);A5.add(BC,BE.call(BI));A8(BI).execute({execute:function A4(){this.submitUpdate(A5);},urInfo:{callback:A5.callback}});},strStartsWith:function(A2,A1,A0){A0=A0||0;return A2.lastIndexOf(A1,A0)===A0;},changeWidgetBackground:function(A2,A3,A1){var A0=A2.parent;if(A0&&A3!==A1){A0.changeUnitFormats(false,1,A2.getFormats(),Ac.BACKGROUND_COLOR,A3,A1);A0.raiseEvent({name:"BEMFormatChange",propertyName:Ac.BACKGROUND_COLOR,value:A3,isTitle:false});}},translateGridError:function(A1,A0){if(A0===undefined){A0=Ay.AE_ERROR;}if(A0===Ay.EMPTY_DATA){A1=mstrmojo.desc(2388,"No data returned for this view. This might be because the applied filter excludes all data.");}if(A0===Ay.NO_DATASET||A0===Ay.NO_TEMPLATE_UNIT){A1=mstrmojo.desc(11668,"Drag objects here.");}if(!A1){A1=mstrmojo.desc(13687,"Unknown error");}return{msg:A1,type:A0};},hasValidValueInMetric:function(A3,A1){var A0=mstrmojo.VisUtility;var A2=A0.getPropertyByPath(A3,"model.data.gsi.mx");if(A2===undefined||A2.length<=A1||A1<0){return false;}var A4=A2[A1];return["min","max"].every(function(A5){var A6=A4[A5];return A6!==undefined&&A6!==null&&A6!=="";});},renderWidgetErrorRSD:function(A3,A5,A1){var A7=document.createElement("div");var A6='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+h.encodeHtmlString(A5,true)+"</div></div>";A7.innerHTML=A6;A7=A7.firstChild;var A0=A3.width,A2=A3.height;if(A0!==undefined){A7.style.width=A0+"px";}if(A2!==undefined){A7.style.height=A2+"px";}var A4=A3.domNode;if(A4){A1.forEach(function(A8){A4["on"+A8]=undefined;});while(A4.firstChild){A4.removeChild(A4.firstChild);}A4.appendChild(A7);}else{A3.parent.domNode.appendChild(A7);}},visPrint:function(){var A0=mstrmojo.VisUtility.enableInVis;if(A0&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(A3,A0){var A2=A0&&A0.did,A1=A3.model.data.datasetId||"",A4=null;if(A2){A4=Ag.getDatasetFromAttributeId(A3.model.docModel.datasets,A2);}else{if(A1){A4=Ag.getDatasetFromId(A3.model.docModel.datasets,A1);}}return A4&&Ag.hasCGorCon(A4);},isCGorCon:function y(A3,A0){var A2=A0&&A0.did,A1=A3.model.data.datasetId||"",A4=null;if(A2){A4=Ag.getDatasetFromAttributeId(A3.model.docModel.datasets,A2);}else{if(A1){A4=Ag.getDatasetFromId(A3.model.docModel.datasets,A1);}}return A4&&Ag.isCGorCon(A0,A4);},findElementsByAttribute:function U(A2,A4,A3,A0){A0=!!A0;var A5=[];if(A3.constructor!==Array){A3=[A3];}var A6=function(A7){if(A0){return A7.identity&&A7.identity.tlOpt&&A7.identity.tlOpt[A4];}else{return A7.getAttribute(A4);}};function A1(A9){var A7=A6(A9),A8;if(A9.hasChildNodes()){A8=A9.firstChild;while(A8){if(A8.nodeType===1){A7=A6(A8);if(A3.indexOf(A7)!==-1){A5.push(A8);}else{A1(A8);}}A8=A8.nextSibling;}}}A1(A2);return A5;},getTextFromHTMLTag:function(A0){var A1=document.createElement("div");A1.innerHTML=A0;return A1.innerText;},getHTMLAnchorFromHTMLTag:function(A0){var A2=document.createElement("div"),A1;A2.innerHTML=A0;A1=A2.firstChild;if(A1 instanceof HTMLAnchorElement){return A1;}return A0;},restoreEsForUnit:function AZ(A4){if(!A4){return ;}var A5=A4.es,A1=A4.fs,A2=A4.otp,A0=A1&&A1.length||0,A3=this;if(A5){W.forEach(A5,function(A7,A6){A7.n=h.decodeHtmlString(A7.n);if(A2===AA.DssTypeAttribute&&A0){switch(A1[A6%A0].bftp){case Aq.DssBaseFormHTMLTag:A7.n=A3.getTextFromHTMLTag(A7.n);break;default:}}});}},isTrue:function Ah(A0){return A0==="true"||A0===true;},getFontFamilyItems:function AC(){if(R){return R;}else{R=[];W.forEach(S.Families.slice(1),function(A0){R.push({n:A0.n,id:A0.n,did:A0.n,preview:!A0.symbolic});});return R;}},surroundWithQuotes:function AY(A0){if(!A0){return"";}return"'"+A0.replace(/^['|"]+/,"").replace(/['|"]+$/,"")+"'";},sendToMobileDevice:function D(A0){var A1=b.walk("webkit.messageHandlers.selectionDataJSONString",window);if(mstrApp.isDisplayOnMobile&&A1){A1.postMessage(A0);return true;}return false;},createMouseEvent:function(A1,A2){var A0=function(A3,A5){A5=A5||{bubbles:false,cancelable:false};var A4=document.createEvent("MouseEvent");A4.initMouseEvent(A3,A5.bubbles,A5.cancelable,window,0,A5.screenX||0,A5.screenY||0,A5.clientX||0,A5.clientY||0,A5.ctrlKey||false,A5.altKey||false,A5.shiftKey||false,A5.metaKey||false,A5.button||0,A5.relatedTarget||null);return A4;};A0.prototype=Event.prototype;return new A0(A1,A2);},filterTrendlineMXByDZ:function Am(A2,A0){var A1=[];b.forEach(A0,function(A3){A1=A1.concat((A3.TemplateMetric||[]).map(function(A4){return A4.id;}));});return A2.filter(function(A3){return W.includes(A1,A3.did);});},addVisFeatureFlags:function N(A1,A0){A0=A0||{};b.forEach(A1,function(A3,A4){var A2=0;b.forEach(A3,function(A5){A2|=A5;});A0[A4]=A2;});return A0;},changeVisFeatureFlag:function Aa(A5,A4,A6,A1,A0){A1=A1||{};var A2=A5[A4],A3=(A2&&A2[A6])||0;A1[A4]=A0?A1[A4]|A3:A1[A4]&(~A3);},addDefaultProps:function Aj(A0){var A1;b.forEach(Aw,function(A3,A2){A1=Ae[A2]||l[A2];if(A0[A1]===undefined){A0[A1]=A3;}});},addChangeVizContextMenu:function Af(A3,A0){var A2=!this.isOnExpressMode()&&!mstrApp.isDossier&&!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())&&(!mstrApp.allowWebDashboardDesign||mstrApp.allowWebDashboardDesign())&&!mstrApp.isInVFInteractMode;if(A2&&A0){var A1=(A0.getDocModel&&A0.getDocModel())||(A0.model&&A0.model.docModel);if(A3.hasMenuItems()){A3.addSeparator();}A3.addMenuItem(mstrmojo.desc(13165,"Change Visualization"),"",function(){var A4=b.walk("mstrApp.rootCtrl.newVizGallery");if(A4&&A1){A1.selectVIUnit(b.walk("parent.id",A0));A4.setupConfig({modal:true,popupConfig:undefined,selectedViz:A1.getVizOfSelectedViUnit(),galleryConfig:{source:2,title:mstrApp.isInVFConfigMode?mstrmojo.desc(18406,"Visualization Filter"):mstrmojo.desc(13165,"Change Visualization")}});A0.openPopup(A4);}});}return A3;}});mstrmojo.VisUtility.enableInVis=true;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui.UnitList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.UnitList",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIUnitList");},getItemProps:function A(F,D){var E=this._super(F,D);E.addCls("unit "+B.getUnitCssClass(F));return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper","mstrmojo.string","mstrmojo.vi.ui.DatasetUnitMenuUtils");var G="mstrmojo-VIUnitList",I="icn clsx_sub",D=mstrmojo.vi.viz.DropZoneHelper.isMetricNames,C=mstrmojo.vi.ui.DatasetUnitMenuUtils,J=mstrmojo.string;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function F(K){return K.n;},getUnitAvatar:function A(N,Q){var M=document.createElement("div"),P=N.getCtxtDragData(),K=P.items,L=['<div class="',[G,mstrApp.getThemeClassName()].join(" "),'">'],O=this;K.forEach(function(S){var U=O.getItemDisplayName(S),R="item unit isAvatar "+C.getUnitCssClass(S);if(D(S)){U=mstrmojo.desc(3582,"Metrics");R+=" is-mh";}L.push('<div class="'+R+'"><span class="txt" unselectable="on">'+(Q?J.encodeHtmlString(U):U)+"</span></div>");});L.push("</div>");M.innerHTML=L.join("");return M.removeChild(M.firstChild);},getUnitDragData:function B(M,K){var L=this.setAvatarClass.bind(this);return{items:K,item:K[0],setAvatarClass:function N(P){L(M,P);},setInvalidAvatarClass:function O(){L(M,I);}};},getDragUnitOffsets:function E(){return{x:21,y:16};},setAvatarClass:function H(N,K){var L=N.avatar;if(L){var M=[G,"hasOwnAvatar",mstrApp.getThemeClassName(),K||""];L.className=M.join(" ");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var S=mstrmojo.Widget,J=mstrmojo.array,F=mstrmojo.dom,O=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,K=mstrmojo.rw.ConditionWalkProvider.setTip,Q=mstrmojo.expr,I=Q.ET;var C=mstrmojo.desc(11899,"Select a dataset object.");var M=J.hash([A.NodeDimtyOutputLevel]);function E(){var Y=this.model;if(Y){if(!Y.attachEventListener){O.make(Y,mstrmojo.ConditionModel,{});}Y.attachEventListener("edit",this.id,"onmodeledit");}}function N(Z,Y){if(Y&&Y.detachEventListener){Y.detachEventListener("edit",Z.id,"onmodeledit");}}function P(d,Y){var b=Y,c=[],a=[],Z=[],e=false;O.forEach(b,function(f){c=c.concat(f.att.filter(function(g){return g.did===d;}));});e=c[0]&&c[0].da;c.forEach(function(f){a=a.concat(f.fs||[]);});a.forEach(function(f){if((f.obf||e)&&Z.filter(function(g){return g.did===f.fid;}).length===0){Z.push({did:f.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(f.bftp),n:f.fnm,t:f.t,isbf:f.isbf});}});return Z;}function D(d,Y){var Z,b=Y,c,a=false;if(typeof microstrategy!=="undefined"){b=b||microstrategy.bones.rwb_viewer.datasetInfos;}O.forEach(b,function(e){Z=e.mx;O.forEach(Z,function(f){if(f.did===d){c=e;a=f.um||f.rdm;return false;}});return !c;});return a&&c&&c.isMDX;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function L(){S.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:S.heightMarkupMethod,onwidthChange:S.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function R(){var Y=this.columnWalk,Z=this.walkProvider;K.call(this,C);Y.removeTrailingContainer(-1);Y.addNextColumn(Z.getTargetNodeProps());Y.target.updateColumnContainer();this.updateOkBtn();},updateBrowseElementsParams:function(b,a){b.attributeID=a.did;b.otp=a.t||12;var Z=this.editor,Y=Z&&Z.onUpdateBrowseElementsParams;if(Y){Y.call(Z,b,a);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var Y=this.parent;if(Y.close){Y.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var Y=this.parent;if(Y.onOK){Y.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:F.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(Z){var Y=this.parent.opener;Y.updateBrowseElementsParams(Z,Y.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var Y=this.parent.parent,Z=Y&&Y.opener;if(Z){Z.onEBSelect();Z.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var Y=this.parent.parent,Z=Y&&Y.opener;if(Z){Z.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Editor-ObjectSelector",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function W(b,Y){var Z=this.model,a=(Y!==Z);if(a){N.call(this,Z);Y.dimtyTypes=this.dimtyTypes||M;this.model=Y;E.call(this,Y);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return a;},onmodeledit:function H(Z){var Y=Z.prop,b=Y==="c0"||Y==="c1",a=this.columnWalk[b?"c0":Y];if(b){a.c1Selected=Y==="c1";}a.updateColumnContainer();a.c1Selected=false;this.updateOkBtn();},browse:function G(a){var c=this.parent.editorNode,b=function(e,g){var d=mstrmojo.dom.position(e,true),f=mstrmojo.dom.position(g,true);return{x:d.x+d.w,y:f.y};},Y=this.columnWalk,Z=this.walkProvider;switch(a&&a.alias){case"target":case"dmy":Z.browseObjs(this,a,b(a.alias==="target"?Y.target.domNode:this.dmyNode,c));break;case"c0":case"c1":Z.browseObjs(this,a,b(Y.c0.domNode,c));break;case"es":Z.browseEs(this,a,b(Y.es.domNode,c));break;}},onOBSelect:function(c){var a=this.ob.browser,e=a.target;this.closePopup();var Z=this.targets,d=e.itemIdField,b=Z||[],Y=J.find(Z,d,c[d]);if(Y===-1){b.push(c);this.targets=b;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}e.setSelectedItems([c],e.multiSelect);if(e.onObjBrowsed){e.onObjBrowsed(c);}},onEBSelect:function(){var Z=this.eb.browser,b=this.columnWalk.es.es;b.set("selectedIndices",{});var Y=b.items,a=[];J.forEach(Z.selectedItems||[],function(d){if(J.find(b.items,"v",d.v)<0){a.push(d);}});var c=b.insertUnlistedValuesAt||0;if(c<0){c=Y.length;}b.set("items",Y.slice(0,c).concat(a).concat(Y.slice(c)));b.setSelectedItems(Z.selectedItems,false);},destroy:function U(Z){var Y=this.walkProvider;if(Y&&Y.destroy){this.walkProvider.destroy();}this._super(Z);},updateOkBtn:function X(){var b=true,Y=this.model,Z,a=Y&&Q.fnCstCount(Y.fn,Y.fnt);if(!Y){return ;}switch(Y.et){case I.AQ:case I.AL:case I.MQ:for(Z=0;Z<a;Z++){b=b&&!this["invalid"+Z];}break;}b=b&&!!Y.completed;this.okBtn.set("visible",b);this.raiseEvent({name:"conditionWalkUpdateOkBtn",valid:b});}});mstrmojo.rw.ConditionWalk.getAttForms=P;mstrmojo.rw.ConditionWalk.isMdxDM=D;}());(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var E=mstrmojo.array,G=mstrmojo.css,C=mstrmojo.mstr.EnumNodeDimty,K=E.hash([C.NodeDimtyUnspecified,C.NodeDimtyNone]);function H(){var L=this.thresholdRow,M=this.editor;if(L){this.removeChildren(L);}G.toggleClass(M.content.domNode,"no-overflow",false);this.set("visible",false);M.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:K,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function B(){var L=this.editor;L.model.setConditionData(this.condition,this.model.get());H.call(this);L.toggleButtonStatus(true);},close:function I(){var O=this.editor;var Q=this.condition,M=Q.tree.parent,L=M.exprTree;if(Q.isEmpty()){Q.del();}var N=L&&L.items,P=N&&N.length;if(!P||P===0){O.model.deleteThreshold(M.threshold);}H.call(this);O.toggleButtonStatus(true);},browse:function F(L){this._super(L);if(L.alias==="es"){G.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function J(L){return mstrmojo.rw.ConditionWalk.getAttForms(L,this.editor.controller.datasets);},getElements:function D(O,R){var Q={},M=R.complete,N=this;this.scrollNode=this.columnWalk.es.scrollNode;var L=this.scrollNode&&this.scrollNode.style;if(L){L.height="100%";}if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{var P=this.ifDataHelper;P.set("items",null);P.set("blockBegin",1);P.set("blockCount",0);P.set("totalSize",0);P.browseConfig.attributeID=O.did;}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(Q,O);this.ifDataHelper.browseConfig=Q;R=mstrmojo.func.wrapMethods(R,{complete:function(S){N.initScroll();N.set("isFetching",false);}});this.ifDataHelper.getItems(1,R);},postNext:function A(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.theme","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui.VIDragUnit","mstrmojo.hash");var G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.vi.ui.theme,F=mstrmojo.array,C=mstrmojo.hash;function D(P,Q,O){var N=false;F.forEach(this.getSelectedItems(),function(R){if(R.itemNode===Q||R===P){N=true;}});if(P&&!N){this.doItemSelect(P,O||{});}}var M={avatarCssClass:"mstrmojo-VIUnitList",encodeUnitAvatar:true,getDragData:function L(N){var O=N.src.node,Q=E.findAncestorByAttr(O,"idx",true,this.domNode);N.src.node=Q?Q.node:O;var P=(N.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(N,this.getSelectedItems());if(this.getItemDisplayName){mstrmojo.func.override({getItemDisplayName:this.getItemDisplayName},N.dragUnitHelper);}P.srcId=this.id;return P;},createAvatar:function A(O,N){if(N.dragUnitHelper){return N.dragUnitHelper.getUnitAvatar(N,this.encodeUnitAvatar);}},selectDragNode:function K(N){var O=N.src;D.call(this,this.getItemFromTarget(O.node),this.getItemNodeFromTarget(O.node),O);},onItemContextMenu:function J(O,N){D.call(this,O,this.getItemNodeFromTarget(N.getTarget()),N);if(this._super){return this._super(O,N);}},positionAvatar:function H(O,N){N.dragOffsets=N.dragUnitHelper.getDragUnitOffsets();if(this._super){this._super(O,N);}}},I=C.copy(M);I._mixinName="mstrmojo.vi.ui._HasUnitListAvatar2";I.getDragData=function(N){if(this.isDraggingItem&&!this.isDraggingItem(N)){if(this._super){return this._super(N);}}else{return M.getDragData.call(this,N);}};mstrmojo.vi.ui._HasUnitListAvatar2=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar2",I);mstrmojo.vi.ui._HasUnitListAvatar=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar",mstrmojo.mixin(M,mstrmojo.mixin(mstrmojo._HasOwnAvatar)));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.elementHelper","mstrmojo.mstr.EnumNodeProperties","mstrmojo.EnumSelectionType","mstrmojo.VisUtility");var t=mstrmojo.array,Z=mstrmojo.hash,W=mstrmojo.expr,o=mstrmojo.elementHelper,f=W.ET,G=W.FN,w=W.DTP,E=mstrmojo.mstr.EnumNodeProperties,j=mstrmojo.EnumSelectionType,n=mstrmojo.VisUtility;var AQ=0,H=1,Q=2,O=3,k=4,AH=5;var x=0,AR="u;",d="LEVEL_NUMBER",c=false,N=7;function AP(AT){return AT.t===47&&AT.st===12033;}function Y(AT,AU){if(AT&&AU&&AU.t===N){return AT.parent===AU&&AT.lv===AU.lv;}return false;}function u(AT){if(AT&&AT.t===N){return t.filter(AT.children,function(AU){return AU.lv===AT.lv;});}return[];}function AO(AT){return !!AT.not||AT.fn===G.NOT_IN_LIST||AT.fn===G.NOT_EQUAL;}function AK(AT){return Z.copyProps(["did","n","t","st","ndetype"],AT);}function U(AW,AT){var AV=AP(AT),AX=AV?AW.v:o.terseLong2OldShort(AW.v),AU={v:AX.replace(/\\:/g,"*:"),n:AW.n};if(AV){AU.t=AW.t;AU.conid=AT.did;}return AU;}function X(AY,AV){if(parseInt(AY,10)>=0){var AX=AV.lvfs||[],AT=t.find(AX,"lv",AY),AW=(AT!==-1?AT:AY),AU=AX[AW]&&AX[AW].lvfn||"";return{v:AU?AY+";"+AU:AY,dtp:AU?w.CHAR:w.INTEGER};}return null;}function AE(AT){if(isNaN(AT)&&typeof AT==="string"){return parseInt(AT.split(";")[0],10);}return parseInt(AT,10);}function y(AT,AU){return !AT||(AT.lv>(AU||0))&&!AT.parent;}function g(AT,Ac,Ab){var AY=Ab.item,AV=Ab.ancestorMap,Aa=Ab.descendantMap,AU=this.getItemByValue(AT.itemValue),AX=this.getItemByValue(Ac.itemValue),AZ=this.updateIdxBase(),AW=function(Ad,Ae){if(AY&&AY===Ad&&Aa){return Aa[Ae.v];}if(AY&&AY===Ae&&AV){return AV[Ad.v];}while(Ae){if(Ad===Ae){return true;}Ae=Ae.parent;}return false;};switch(AT.func){case j.ALL:return Ac.func===j.ALL?AQ:O;case j.ELEMENT:switch(Ac.func){case j.ALL:return Q;case j.ELEMENT:return AU===AX?AQ:Y(AU,AX)?Q:Y(AX,AU)?O:AH;case j.BRANCH:return AW(AX,AU)?Q:Y(AX,AU)?k:y(AU,AZ)?H:AH;case j.LEVEL:return AU.lv===Ac.level?Q:AH;case j.BRANCH_LEVEL:return AU.lv!==Ac.level?AH:y(AU,AZ)?H:AW(AX,AU)?Q:AH;}break;case j.BRANCH:switch(Ac.func){case j.ALL:return Q;case j.ELEMENT:if(this.isInFilterPanel&&AU===AX&&AU.ln){if(AT.isNot!==Ac.isNot){AU.isBranchSelected=!AU.isBranchSelected;}return AQ;}return AW(AU,AX)?O:Y(AU,AX)?k:y(AX,AZ)?H:AH;case j.BRANCH:return AU===AX?AQ:(y(AU,AZ)||y(AX,AZ))?H:AW(AX,AU)?Q:AW(AU,AX)?O:AH;case j.LEVEL:return AU.lv<=Ac.level?k:AH;case j.BRANCH_LEVEL:return AU===AX?O:(y(AU,AZ)||y(AX,AZ))?H:AW(AU,AX)?O:(AW(AX,AU)&&Ac.level>=AU.lv)?k:AH;}break;case j.LEVEL:switch(Ac.func){case j.ALL:return Q;case j.ELEMENT:return AX.lv===AT.level?O:AH;case j.BRANCH:return AX.lv<=AT.level?k:AH;case j.LEVEL:return AT.level===Ac.level?AQ:AH;case j.BRANCH_LEVEL:return AT.level===Ac.level?O:AH;}break;case j.BRANCH_LEVEL:switch(Ac.func){case j.ALL:return Q;case j.ELEMENT:return AX.lv!==AT.level?AH:y(AX,AZ)?H:AW(AU,AX)?O:AH;case j.BRANCH:return AU===AX?Q:(y(AU,AZ)||y(AX,AZ))?H:AW(AX,AU)?Q:(AW(AU,AX)&&AT.level>=AX.lv)?k:AH;case j.LEVEL:return AT.level===Ac.level?Q:AH;case j.BRANCH_LEVEL:return AT.level!==Ac.level?AH:AU===AX?AQ:(y(AU,AZ)||y(AX,AZ))?H:AW(AX,AU)?Q:AW(AU,AX)?O:AH;}break;}return H;}function F(AU,AY,AV,AZ,AT){var AX=(AU.fs||[]).filter(function(Aa){return(Aa.n||Aa.fnm)===d;})[0],AW=t.ensureArray(AV).map(function(Aa){return U(Aa,AU);});switch(AY){case j.ELEMENT:if(AW.length>0){return{et:f.AE,fn:AT?G.NOT_IN_LIST:G.IN_LIST,a:AK(AU),es:AW};}break;case j.BRANCH:if(AW.length>0){return{et:f.AE,fn:G.DESCENDANT,not:AT,a:AK(AU),es:AW};}break;case j.LEVEL:if(AX&&parseInt(AZ,10)>=0){return{et:f.AQ,fn:G.EQUAL,not:AT,a:AK(AU),fm:{did:AX.did||AX.fid,n:d,dtp:W.mapBaseFormTypeToDataType(AX.bftp)},cs:[X(AZ,AU)]};}break;case j.BRANCH_LEVEL:if(AW.length>0&&parseInt(AZ,10)>=0){return{et:f.AE,fn:G.DESCENDANT,not:AT,a:AK(AU),es:AW,cs:[X(AZ,AU),{v:18,dtp:w.INTEGER}]};}break;}return null;}function D(){var AT={};this.selectionList.forEach(function(AV,AU){if(AV.func===j.ELEMENT){AT[AV.itemValue]=AU;var AW=this.getItemByValue(AV.itemValue);t.forEach(u(AW),function(AX){AT[AX.v]=AU;});}},this);return AT;}function AI(){var AT={};this.selectionList.forEach(function(AV,AU){if(AV.func===j.BRANCH){AT[AV.itemValue]=AU;}});return AT;}function A(){var AT={};this.selectionList.forEach(function(AV,AU){if(AV.func===j.LEVEL){AT[AV.level]=AU;}});return AT;}function s(){var AT={};this.selectionList.forEach(function(AW,AU){if(AW.func===j.BRANCH_LEVEL){var AX=AW.itemValue,AY=AW.level,AV=AT[AX];if(!AV){AV=AT[AX]={};}AV[AY]=AU;}});return AT;}function b(AV){var AU=AI.call(this),AT=x;while(AV&&AV.v){AT=Math.max(AT,AU[AV.v]||x);AV=AV.parent;}return AT;}function AC(AV,AX){var AT=s.call(this),AW=A.call(this),AU=AX?x:b.call(this,AV),AZ=AV&&AV.lv||0,AY={};if(!AX){Z.forEach(AW,function(Ab,Aa){if(Aa>=AZ&&Ab>AU){AY[Aa]=Ab;}});}while(AV&&AV.v){Z.forEach(AT[AV.v],function(Ab,Aa){if(Aa>=AZ&&Ab>AU){AY[Aa]=Math.max(Ab,AY[Aa]||AU);}});AV=AV.parent;}return AY;}mstrmojo.ui._HierarchyListSelection=mstrmojo.provide("mstrmojo.ui._HierarchyListSelection",{_mixinName:"mstrmojo.ui._HierarchyListSelection",init:function AJ(AT){this._super(AT);this.clearSelections();},getAllSelection:function M(){return !this.selectionList[x].isNot;},setAllSelection:function p(AT){this.selectionList[x].isNot=!AT;},clearSelections:function q(){this.selectionList=[{func:j.ALL,isNot:!c}];return this.selectionList;},addSelection:function a(AT){var AX=this.selectionList,AV=this.getItemByValue(AT.itemValue),AU={item:AV,ancestorMap:AV&&this.getItemAncestorMap(AV),descendantMap:AV&&this.getItemDescendantMap(AV)},AW=true;if(!AV&&(AT.func===j.ELEMENT||AT.func===j.BRANCH||AT.func===j.BRANCH_LEVEL)){return ;}AX=this.selectionList=AX.filter(function(AY){var Aa=g.call(this,AY,AT,AU),AZ=AY.isNot===AT.isNot;if(Aa===O||Aa===k&&!AZ){AW=!AZ;}return !(Aa===AQ||Aa===Q);},this);if(AW){AX.push(AT);}},updateSiblingItemSelection:function AA(AU){var AW=this.selectionList,AT=D.call(this),AV=AI.call(this);t.forEach(AU,function(Ab){var AY=Ab.parent,AX=AY?b.call(this,AY):x,AZ=AY?AC.call(this,AY):A.call(this),Aa=Math.max(AV[Ab.v]||x,AX),Ac=Math.max(AT[Ab.v]||x,Aa,AZ[Ab.lv]||x);Ab.isSelected=!AW[Ac].isNot;Ab.isBranchSelected=!AW[Aa].isNot;},this);},updateItemSelection:function R(AU,Ae){var Ad=this.selectionList,AV=D.call(this),Af=AI.call(this),AZ=A.call(this),Aa=s.call(this),AX=AU?[AU]:this.getRootItems(),AW=AX.length&&AX[0].lv||0,AY,AT=AU?b.call(this,AU):x,Ac=AU?AC.call(this,AU,true):{};this.idxBase=AW;AY=AU?[]:this.getItems().filter(function(Ag){return Ag&&y(Ag,AW);});(AX.concat(AY)).forEach(function Ab(Ak){var Ai=AT,Ah=Z.copy(Ac);AT=Math.max(AT,Af[Ak.v]||x);Z.forEach(Aa[Ak.v],function(An,Am){Ac[Am]=Math.max(An,Ac[Am]||x);});var Al=Math.max(AV[Ak.v]||x,AZ[Ak.lv]||x,AT,Ac[Ak.lv]||x);Ak.isSelected=!Ad[Al].isNot;Ak.isBranchSelected=!Ad[AT].isNot;this.updateBtnSelectionStatus(Ak);t.forEach(Ak.children,function(Am){Ab.call(this,Am);},this);var Aj=u(Ak);if(Aj.length>0){var Ag=t.find(Aj,"isSelected",true)>=0;if(Ak.isSelected!==Ag){this.addSelection({func:j.ELEMENT,itemValue:Ak.v,isNot:!Ag});Ak.isSelected=Ag;}}AT=Ai;Ac=Ah;},this);if(!Ae){this.updateDescStatusForAddedItems();}},updateDescStatusForAddedItems:function B(){var AX=this.selectionList,AV=AI.call(this),AU=this.getDescSelectionMap(),AT=x;this.getRootItems().forEach(function AW(Aa){var AZ=Aa.children||[],AY=AT;AT=Math.max(AT,AV[Aa.v]||x);Aa.hcsd=AU.hasOwnProperty(Aa.v)?AU[Aa.v]:(!AX[AT].isNot&&Aa.hcd);AU[Aa.v]=Aa.hcsd;t.forEach(AZ,function(Ab){AW.call(this,Ab);},this);AT=AY;},this);},initDescStatusForNonIncFetch:function AB(){var AU=this.getRootItems(),AV=this.clearDescSelection(),AT=function(AW){AW.hcsd=false;t.forEach(AW.children,function(AX){if(AT.call(this,AX)||AX.isSelected&&!Y.call(this,AX,AX.parent)){AW.hcsd=true;}},this);AV[AW.v]=AW.hcsd;return AW.hcsd;};AU.forEach(function(AW){AT.call(this,AW);},this);},updateIdxBase:function z(){var AT=this.getRootItems();this.idxBase=AT.length&&AT[0].lv||0;return this.idxBase;},updateDescendantsStatus:function AS(){var AY=this.selectionList,AT=this.getMaxLevel(),AW=AI.call(this),AU=s.call(this),AV=x,AZ=A.call(this);this.getRootItems().forEach(function AX(Aj){var Ab=Aj.children||[],Af=Aj.displayChildren||[],Ah=AV,Ai=Z.copy(AZ),Ac=false;AV=Math.max(AV,AW[Aj.v]||x);Z.forEach(AU[Aj.v],function(Al,Ak){AZ[Ak]=Math.max(Al,AZ[Ak]||x);});Ab.forEach(function(Ak){if(AX(Ak)||!Ak.hid&&Ak.isSelected){Ac=true;}});if(Aj.hcd&&Af.length===0){var Ad=!AY[AV].isNot,Ag,Aa;for(var Ae=Aj.lv+1;Ae<=AT;Ae++){Ag=AZ[Ae]||x;Aa=Ag>AV&&!AY[Ag].isNot;if(Aa||Ad&&Ag<=AV){Ac=true;break;}}}Aj.hasDsctSelected=Ac;AV=Ah;AZ=Ai;return Ac;});},getMaxLevel:function i(){var AT=0;this.getItems().forEach(function(AU){var AV=AU.lv;if(AV>AT&&!AU.hid){AT=AV;}});this.selectionList.forEach(function(AU){if(AU.func===j.LEVEL||AU.func===j.BRANCH_LEVEL){AT=Math.max(AT,AU.level);}});return AT;},getLevelSelection:function I(AT){var AX=this.selectionList,AV=AT?AC.call(this,AT):A.call(this),AU=AT?AT.isBranchSelected:this.getAllSelection(),AW={};Z.forEach(AV,function(Aa,AZ){var AY=!AX[Aa].isNot;if(AY!==AU){AW[AZ]=AY;}});return Z.copy({allLevel:AU,isLevelSelected:function(AY){return this[AY]||this.allLevel&&this[AY]!==false;}},AW);},buildSelectionExprJSON:function l(AV){var AX=this.getAllSelection(),AU=[],AY=null,AZ=this.updateIdxBase(),AW={selected:[],unselected:[]},AT=function(Aa,Ab){if(!Z.isEmpty(Ab)&&(Aa.length>0||AX===AO(Ab))){Aa.push(Ab);}};this.selectionList.forEach(function(Ab){var Ad=Ab.func,Aa=Ab.isNot,Af=Ab.level,Ae=Ab.itemValue,Ac=Ae?this.getItemByValue(Ae):null;if((Ac||{}).fetcher){return ;}if(Ab.func===j.ELEMENT&&!y(Ac,AZ)){AW[Aa?"unselected":"selected"].push(Ac);}else{if(Ab.func!==j.ALL){AT(AU,F(AV,Ad,Ac,Af,Aa));}}},this);AT(AU,F(AV,j.ELEMENT,AW.selected));AT(AU,F(AV,j.ELEMENT,AW.unselected,null,true));if(AU.length>0){AY=AU[0];AU.forEach(function(Ad,Aa,Ac){var Ab=AO(Ad);if(Aa>0){if(Ab===AO(Ac[Aa-1])&&AY.nds){AY.nds.push(Ad);}else{AY={et:f.ANDOR,fn:Ab?G.AND:G.OR,nds:[AY,Ad]};}}});}if(AY){if(AY.et===f.ANDOR){AY.node=E.CONDITION;}else{AY={et:f.ANDOR,fn:G.AND,nds:[AY],node:E.CONDITION};}}return AY;},setSelectionByExprJSON:function AD(AV,AX,Aa){var AW=this.clearSelections(),AU=false,AT=this.getItems(),AZ=o.getIdPresentation(AT[0]&&AT[0].v),AY=function(Ac,Ad){if(Z.isEmpty(Ac)){return ;}if(Ac.et===f.ANDOR){(Ac.nds||[]).forEach(function(Ae){AY.call(this,Ae,Ad);},this);}else{var Ab=AO(Ac);if(!AU){AU=true;this.setAllSelection(Ab);}if(Ac.et===f.AQ&&Ac.fm&&Ac.fm.n===d){(Ac.cs||[]).forEach(function(Af){var Ae=AE(Af.v);if(Ae>=0){Ad.push({func:j.LEVEL,level:Ae,isNot:Ab});}});}if(Ac.et===f.AE){(Ac.es||[]).forEach(function(Ae){var Af=n.getItemValue(Ae.v,AZ,Ac.a),Ag=AE(Ac.cs&&Ac.cs[0].v);if(!this.getItemByValue(Af)){this.addItems([Z.copy({v:Af,dhid:true},Z.clone(Ae))],true);}if(Ac.fn===G.DESCENDANT){if(Ag>=0){Ad.push({func:j.BRANCH_LEVEL,itemValue:Af,level:Ag,isNot:Ab});}else{Ad.push({func:j.BRANCH,itemValue:Af,isNot:Ab});}}else{Ad.push({func:j.ELEMENT,itemValue:Af,isNot:Ab});}},this);}}};AY.call(this,AV,AW);this.updateItemSelection(undefined,Aa&&!AX);},updateDescSelectionMap:function h(AT){var AU=this.getItemByValue(AT.itemValue);if(!AU||(AT.func===j.LEVEL||AT.func===j.BRANCH_LEVEL)){return ;}this.updateDescendantsDescSelectionStatus(AT);if(!this.isHiearachyDisplay()&&AT.isNot&&!(this.docSelector&&!this.docSelector.incFetch)){return ;}this.updateAncestorDescSelectionStatus(AT);},updateDescendantsDescSelectionStatus:function e(AT){var AV=this.getItemByValue(AT.itemValue);var AU=this.getDescSelectionMap();var AW=function(AY,AX){if(AX||!AY.ln){AY.hcsd=!AX;AU[AY.v]=!AX;(AY.children||[]).forEach(function(AZ){AW(AZ,AX);});}};if(AT.func===j.BRANCH){AW(AV,AT.isNot);}},updateAncestorDescSelectionStatus:function J(AT){var AV=this.getItemByValue(AT.itemValue);var AU=this.getDescSelectionMap();var AW=function(AX){return(AX.children||[]).some(function(AY){return(AY.isSelected||AY.hcsd);});};while(AV&&AV.parent){AV=AV.parent;AV.hcsd=AT.isNot?AW(AV):true;AU[AV.v]=AV.hcsd;}},setDescSelectionByItemInfo:function AM(AT){var AV=this.clearDescSelection(),AU=this.itemMap;t.forEach(AT,function(AW){AV[AW.v]=AW.hcsd;AU[AW.v].hcsd=AW.hcsd;});},setDescSelectionByMap:function K(){var AT=this.getDescSelectionMap();t.forEach(this.items,function(AU){AU.hcsd=!!AT[AU.v];});},clearDescSelection:function m(){this.descSelMap={};return this.descSelMap;},setAllDescSelection:function AF(AU){var AT=this.getDescSelectionMap();this.getRootItems().forEach(function AV(AW){AW.hcsd=AU?AW.hcd:false;AT[AW.v]=AW.hcsd;t.forEach(AW.children,function(AX){AV.call(this,AX);});},this);},getDescSelectionMap:function C(){return this.descSelMap||{};},setAllLevelSelection:function AG(AT){t.forEach(this.items,function(AU){AU.hasLevelSelected=AT&&AU.hcd;});},setSelectionByList:function P(AU,AT){var AV=[],AW=false;t.forEach(AU,function(AX){var AY=AX.v;if(AY===AR){AW=true;return false;}if(!this.getItemByValue(AY)){this.addItems([AX],true);}AV.push({func:j.ELEMENT,itemValue:AY,isNot:!AT});},this);this.clearSelections();if(!AW){this.setAllSelection(!AT);this.selectionList=this.selectionList.concat(AV);}this.updateItemSelection();},onSelectionChange:function S(AV,AU,AW,AX){if(AV===j.ALL){this.clearSelections();this.clearDescSelection();this.setAllSelection(AU);this.setAllDescSelection(AU);}else{var AT={func:AV,itemValue:AW&&AW.v,level:AX,isNot:!AU};this.addSelection(AT);this.updateDescSelectionMap(AT);}if(this.postSelectionChange){this.postSelectionChange();}},postAddItems:function L(AT){this.updateItemSelection();},postAddSiblingItems:function AN(AU,AT){this.updateSiblingItemSelection(AU);},postAddBranchItems:function AL(AU,AT){this.updateItemSelection(AT);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.customviz._HasExtraSelectionInfo","mstrmojo.customviz.GraphicModel","mstrmojo.CustomVisUtility","mstrmojo.VisUtility");var F=mstrmojo.array,D=mstrmojo.hash,M=mstrmojo.vi.ui.rw.SelectionType,L=mstrmojo.CustomVisUtility.log,I=mstrmojo.customviz.PICKED_TYPE,B=mstrmojo.customviz.PICKED_CRITERIA,O=mstrmojo.VisUtility,G=2;function P(S,R,W){var U={};U[S]=[{id:R,n:W}];return U;}mstrmojo.customviz._SupportCustomVizBrushesAndHighlights=mstrmojo.provide("mstrmojo.customviz._SupportCustomVizBrushesAndHighlights",{_mixinName:"mstrmojo.kpicard._SupportKPICardBrushesAndHighlights",isHighlightedAsTarget:false,selectionInfoFromMobile:{},srcSelectionForBrushing:[],canPickGraphicModel:function Q(h,X,i,Y){if(!h||!i||i.scriptClass!=="mstrmojo.customviz.GraphicModel"){return false;}var e=[I.ATTR,I.METRIC,I.BOTH],j,f,Z,d=this.isHighlightedAsTarget,R=0;if(!d){j=I.ATTR;f=I.METRIC;Z=B.SUBSET;}else{j=e.indexOf(Y&&Y.attribute)===-1?I.ATTR:Y.attribute;f=e.indexOf(Y&&Y.metric)===-1?I.METRIC:Y.metric;Z=(Y&&(Y.criteria===B.SUBSET||Y.criteria===B.INTERSECTION))?Y.criteria:B.INTERSECTION;}var U=X?j:f;if((U===I.ATTR&&!i.isAttributeSelector())||(U===I.METRIC&&i.isAttributeSelector())){return false;}var W={},g=h,k,S=0;if(i.isAttributeSelector()){F.forEach(F.ensureArray(i.getSelector()),function(l){if(l.tid){W[l.tid]=[{id:l.eid}];}});}else{W=i.getSelector();}for(k in g){++R;if(!W.hasOwnProperty(k)){if(Z===B.SUBSET){return false;}continue;}if(g.hasOwnProperty(k)){var c=F.ensureArray(W[k]),b=F.ensureArray(g[k]),a=(c.length===b.length)&&(F.difference(c,b,"id").length===0);if(!a){return false;}}++S;}return d?S!==0:R===Object.keys(W).length;},addGraphicSelection:function N(W,Y,U){var R=this,X,S;R.isHighlightedAsTarget=U;for(X in W){if(W.hasOwnProperty(X)){S=W[X];R.addSelectionBySingleSelector(S,Y,true,false);}}},highlight:function E(U,X,R){if(this._super){this._super.apply(this,arguments);}if(this.noHighlightAfterKeepOnlyExcludeDrill||this.isEmpty()||this.excludeData){return ;}var W=this,S=!R;this.clearCxtMnuSelection(true);this.clearSelections(false,true);if(U===M.ATTS){W.addGraphicSelection(X,true,S);}else{if(U===M.METRICS){W.addGraphicSelection(X,false,S);}}if(this.plotted){this.updateHighlight();}},updateHighlight:function H(){},clearSelections:function(R,S){this.clearSelectionsFlag=true;if(this._super){this._super(S);}if(R&&this.plotted){this.updateHighlight();}},addNormalizedSelection:function K(Z,Y,U,S){var R=this,X,W;for(W=0;W<Z.length;++W){X=Z[W];if(Y){X=P(X.tid,X.eid,X.n);}R.addSelectionBySingleSelector(X,Y,U,S);}},highlightElements:function C(R){this.selectionInfoFromMobile=D.copy(R,{});this.clearSelections(false,false);this.clearCxtMnuSelection(false);this.generateSelectionFromMobileBrushing(this.srcSelectionForBrushing);this.generateSelectionFromMobile(R);if(this.plotted){this.updateHighlight();}},handleBrushHighlightMobile:function J(R){this.srcSelectionForBrushing=D.copy(R,[]);this.clearSelections(false,false);this.clearCxtMnuSelection(false);this.generateSelectionFromMobile(this.selectionInfoFromMobile);this.generateSelectionFromMobileBrushing(R);if(this.plotted){this.updateHighlight();}},generateSelectionFromMobile:function(U){var W=F.ensureArray(U.selection),Z=F.ensureArray(U.contextMenu),Y=W[0]&&W[0].isSelectAttr,X=Z[0]&&Z[0].isSelectAttr,S,R=this;S=R.isHighlightedAsTarget;R.isHighlightedAsTarget=false;R.addNormalizedSelection(W,Y,false,false);R.addNormalizedSelection(Z,X,false,true);R.isHighlightedAsTarget=S;},generateSelectionFromMobileBrushing:function(U){var R=this,S,W=U[0]&&U[0].isSelectAttr;S=R.isHighlightedAsTarget;R.isHighlightedAsTarget=true;R.addNormalizedSelection(U,W,true,false);R.isHighlightedAsTarget=S;},singleUnitSelect:function A(){var W=this.getSelections().length>0||this.clearSelectionsFlag;if(this.clearSelectionsFlag){delete this.clearSelectionsFlag;}if(W){var S=function(){var Z=this.model.scm,b=Object.keys(Z||{}),d=(b&&b[0])||"",Y=this.model.data.gts,c=Y.row,a=Y.col;F.forEach(c.concat(a),function(e){if(b.indexOf(e.id)!==-1){d=e.id;return false;}});return d;};var U=function(){var Z=this.model.scm,b=Object.keys(Z||{}),d=[],Y=this.model.data.gts,c=Y.row,a=Y.col;F.forEach(c.concat(a),function(e){if(b.indexOf(e.id)!==-1){d.push(e.id);}});return d;};var X=function(){var Y={};Y.tid=S.call(this);Y.tids=U.call(this);Y.eid="";Y.isClearAll=false;Y.anchor=this.domNode;Y.at=G;Y.selections=this.getSelections();Y.selectionType=this.getSelectionType();return Y;};var R=X.call(this);this.performAction([R]);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.css","mstrmojo.VisUtility","mstrmojo.hash","mstrmojo.dom");var K=mstrmojo.dom,E=mstrmojo.css,S="srchBoxState",C=mstrmojo.Enum_Keys,W=mstrmojo.VisUtility,k=mstrmojo.Enum_Keys,M=200,i,H=24,R={fontFamily:"Arial",fontSize:"11px"};var g={2147762262:mstrmojo.desc(16256,"Please enter a numeric value"),2147762227:mstrmojo.desc(16257,"Unable to perform search with the operators provided")};var Q={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var n="mstrmojo-SimpleObjectInputBox-del";function F(){var t=this.inputBox,u=t&&t.value;if(u!==""&&(u!==this._lastPattern||!this.suggestionShown)){this.showSuggestion(u);this._isSearching=true;if(this.hitEnterToTest){this.inputBox.blur();}}this._lastPattern=u;delete this._timerHandle;}function D(){var t=this._timerHandle;if(t){window.clearTimeout(t);delete this._timerHandle;}}function A(){if(this.richTooltip){if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}this.hideTooltip();}}function d(t){var w=this._inputPos,u=!mstrApp.isAppStatePresentation||mstrApp.isAppStatePresentation(),x=this,y;if(this.richTooltip){y=this.richTooltip;if(!this.hasOpenTooltip&&!this.suggestionShown){y.top=(w.h+w.y)+"px";y.left=w.x+"px";if(!this.hitEnterToTest&&!u){window.setTimeout(function(){var AB=x.tooltip,AA=AB&&AB.contentNode,AC,z;AC=AA?AA.childNodes:null;if(AC&&AC.length>1){z=AC[1];AC=z.childNodes;if(AC&&AC.length>1){z=AC[1];}else{z=null;}}if(x.hasOpenTooltip&&z&&!E.hasClass(AA,"lng")){if(y.onclick){x.tooltip.onclick=y.onclick;K.attachMarkupEvent(x.tooltip.id,z,"click");}E.addClass(AA,"lng");}},3000);}this.showTooltip(t.e,t.hWin);this.set("allowOtherTooltips",!this.hitEnterToTest);}}}function G(){if(window.mstrLocalStorage===undefined){return{};}var t=(mstrLocalStorage.getLocalStorage()||{})[S];return(t&&JSON.parse(t))||{};}function a(t){if(window.mstrLocalStorage!==undefined){mstrLocalStorage.setItem(S,JSON.stringify(t));}}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click,keydown><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur,focus style="display: none;" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" /><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@en@emptyText}</div></div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},emptyTextNode:function(){return this.domNode.firstChild.lastChild;},inputBox:function(){var t=this.domNode.firstChild.children;return t[t.length-2];},scrollboxNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function f(){var t=this.maxItemWidth;if(!isNaN(t)&&t>0){this.emptyTextNode.style.maxWidth=t+"px";}}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,hitEnterToTest:false,maxObjectCount:null,useRichTooltip:true,init:function o(t){this._super(t);if(mstrApp.isWorkstation){R.fontFamily="Helvetica";}},showTooltip:function s(u,y){var x=u.target||K.eventTarget(u.hWin,u.e),w=this.getItemFromTarget(x);if(w&&w.n){var z=this.getItemNodeFromTarget(x).firstChild,t=K.position(z);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,cssClass:"vi-regular vi-tooltip-A A-center",refNode:z,content:mstrmojo.string.encodeHtmlString(w.n),top:t.h+11,left:t.w/2};this._super(u,y);}},getItemMarkup:function(t){if(!i){var u=this.itemField;i=this._super(t).replace(">{@en@n}<",'><div class="elem">{@en@'+u+'}<div class="'+n+'"></div></div><');}return i;},getItemProps:function e(y,t){var w=this._super(y,t),z=this.itemField;var x=this.maxItemWidth;if(!isNaN(x)&&x>0){x=(x-H);}if(!mstrmojo.string.isEmpty(y[z])){var u=y[z];w[z]=u;if(x<W.measureTextWidth(u,R)){w.title=u;}}w.addStyle("max-width:"+x+"px");return w;},getSuggestionPos:function X(){var t=this._inputPos;return{target:this.inputBox,left:t.x+"px",top:t.y+t.h+"px",zIndex:100};},updateSuggestion:function b(t){var u=G();if(!u.srch){if(this._super){this._super(t);}}this.inputBox.focus();A.call(this);},failMessage:function B(u){var w=g[u.errCode]||u.msg,t=w?[{n:w,t:-101,cls:"nomatch"}]:[];this.updateSuggestion(t);},getSearchPattern:function N(){return this.inputBox?this.inputBox.value:"";},showInfoTooltip:function Z(x){var y=G(),t=this.parent.parent,z=K.position(t.domNode),u=this.richTooltip,w=this;if(!y.hasShownInfo&&!mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO){mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=true;y.hasShownInfo=true;this.set("richTooltip",{posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V vi-tooltip-leftcenter",contentNodeCssClass:"srch info",top:z.y+"px",left:z.x+z.w+8+"px",content:mstrmojo.desc(15909,'You can re-enable "Instant Search" from the menu.'),onClose:function(){w.set("richTooltip",u);}});this.showTooltip(window.event,window);if(this.tooltip){this.tooltip.set("allowOtherTooltips",false);}else{this.set("allowOtherTooltips",false);}}y.srch=x;a(y);},onIncrementalFetch:function J(){this.inputBox.blur();},onSuggestionItemSelect:function l(t){D.call(this);this.set("items",this.items.concat(t));this._super();var u=this.id;window.setTimeout(function(){var w=mstrmojo.all[u];if(parseInt(w.state,10)!==Q.FULL){w.set("state",Q.ADDING);}},0);},onstateChange:function Y(u){var w=u.value;if(this.parent.defn.multi){this.emptyTextNode.style.display=(w===Q.ADDING)?"none":"block";}else{this.emptyTextNode.style.display=(w===Q.EMPTY)?"block":"none";}var t=this.inputBox,x=t.style;if(w===Q.ADDING){x.display="";this.updateScrollbars();t.focus();this._inputPos=K.position(t,true);}else{D.call(this);x.display="none";t.value="";this._lastPattern="";this.updateScrollbars();if(this.parent.getFormats&&!this.parent.getFormats().height&&this.parent.parent.performCanGrowCanShrink){this.parent.parent.performCanGrowCanShrink(this.parent.parent.children);}}},postBuildRendering:function P(){var t,u=G();M=(mstrApp.getSearchAutoCompleteDelay&&mstrApp.getSearchAutoCompleteDelay())||M;this.state=0;this.setDefaultState();if(u.srch){this.inputBox.value=u.srch;this.set("state",Q.ADDING);delete u.srch;a(u);}t=this._super();return t;},preitemsChange:function L(){this.setDefaultState();},onkeydown:function O(u){var x=this.parent,AB=x&&x.tabParent,AA=u.e||u,z=u.getTarget(),t=E.hasClass(z,n),w=z===this.inputBox||z===this.emptyTextNode,y=AA.keyCode;if(x.canTab&&x.handleTab(u)){return ;}AA.stopPropagation();if(y===k.SPACE&&w){return ;}else{if((y===k.ENTER||y===k.SPACE)&&(t||w)){this.onclick(u);if(t&&AB&&AB.grabFocus){AB.grabFocus(true);}else{if(w&&x.canTab){x.toggleSearchFocus(true);}}}else{if(y===k.ESCAPE){if(z.tagName==="INPUT"){this.setDefaultState();if(x.canTab){x.toggleSearchFocus(false);}}else{if(z.loseFocus){z.loseFocus(true);}if(AB&&AB.grabFocus){AB.grabFocus(true);}}}}}},onclick:function h(u){var y=K.eventTarget(u.hWin,u.e);if(y&&E.hasClass(y,n)){var x=K.findAncestorByAttr(y,"idx",true,this.domNode),t=x&&parseInt(x.value,10);this.hideTooltip();if(t!==null&&!isNaN(t)){var w=this.items.concat();w.splice(t,1);this.set("items",w);}return ;}if(parseInt(this.state,10)!==Q.FULL){this.set("state",Q.ADDING);}},onblur:function U(){if(this._isSearching||this.tooltip){return ;}D.call(this);A.call(this);if(!this.suggestionShown){this.setDefaultState();}},onfocus:function m(){this._isSearching=false;if(this.suggestionShown){A.call(this);}},prekeydown:function I(u){var y=u.e;switch(parseInt(y.keyCode||y.charCode,10)){case C.DOWN_ARROW:this.nextHighlight();break;case C.UP_ARROW:this.preHighlight();break;case C.TAB:case C.ENTER:K.preventDefault(u.hWin,y);if(this.suggestionShown){var x=this.getSelected();if(x){this.handleSuggestionItemSelect(x);}else{this.hideSuggestion();}}else{if(this.hitEnterToTest){A.call(this);F.call(this);}}break;case C.ESCAPE:D.call(this);if(this.suggestionShown){this.hideSuggestion();}else{this.setDefaultState();}break;case C.BACKSPACE:if(!this.getSearchPattern()&&!mstrApp.hasRequests()){K.preventDefault(u.hWin,y);var w=this.items&&this.items.concat();if(w&&w.length){w.splice(w.length-1,1);mstrApp.ignoreBackSpace=true;this.set("items",w);var AA=this.id;window.setTimeout(function(){mstrmojo.all[AA].set("state",Q.ADDING);mstrApp.ignoreBackSpace=false;},0);}}break;}var t=this.richTooltip,z=(t&&t.contentNodeCssClass)||"";if(z.indexOf("srch info")>-1){A.call(this);}},prekeyup:function q(t){var x=t.e,u=parseInt(x.keyCode||x.charCode,10),w=this.getSearchPattern();if(!w||w!==this._lastPattern){K.preventDefault(t.hWin,t.e);this.hideSuggestion();}if(this.inputBox.value.length&&u!==C.ENTER&&u!==C.TAB&&!this.suggestionShown){d.call(this,t);}else{A.call(this);}if(this.hitEnterToTest){return ;}if(this.useKeyDelay){var y=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){F.call(mstrmojo.all[y]);},M);}}else{F.call(this);}},widgetResized:function p(){if(this.hasRendered){var x=parseInt(this.width,10),z=this.items.length,AA=this.itemsContainerNode.childNodes;if(z<=(AA&&AA.length)){var y=x-H;for(var w=0;w<z;w++){var t=AA[w],u=t.textContent;t.style.maxWidth=y+"px";if(u&&y<W.measureTextWidth(u,R)){t.title=u;}else{t.title="";}}}if(this.emptyTextNode){this.emptyTextNode.style.maxWidth=x+"px";}this.updateScrollbars();}},setupScrollNodes:function j(){this.scrollNode=this.scrollboxNode;},setDefaultState:function c(){var w=this.maxObjectCount,t=(this.items&&this.items.length)||0,u=(w!==null&&w!==undefined&&t>=w);this.set("state",!t?Q.EMPTY:(u?Q.FULL:Q.DEFAULT));}});mstrmojo.SimpleObjectInputBox.HAS_SHOWN_INFO=false;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.num","mstrmojo.VisUtility","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.models.FormatModel","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var H=mstrmojo.array,K=mstrmojo.hash,R=mstrmojo.string,W=mstrmojo.num,AF=W.UNIT,AH=mstrmojo.VisUtility,L=mstrmojo.models.datasets.DataInterface,P=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,Q=mstrmojo.vi.viz.EnumDSSDropZones,O=R.decodeHtmlString;var AA=-1,x=1,AE=2,U=3;var B=1,C=2,I=3;var AS="0";var AL="root";var t=6;var AB={HR:0,CT:1,FT:2};var p=0,AU=2,N=3;var X=1,AQ=2,z=3;function M(AZ){var Aa={};K.forEach(AZ,function(Ad,Ac){var Ab=[];H.forEach(Ad,function(Ae){Ab.push({fillColor:Ae.fillclr,text:Ae.n});});Aa[Ac]=Ab;});return Aa;}function n(Ac){var Am=this.getTotalRows(),Ae=this.data,Ah=[],Aj=Ae.gts.col[0],Ab=Aj?Aj.es:[],Al=Ab.length,Af=0;Ac=K.copy(Ac,{minAttribute:1,minMetric:1});if(Am<Ac.minAttribute||Al<Ac.minMetric){throw"Error";}do{var Aa=this.getRowHeaders(Af),Ad,AZ={},Ai=Aa.size();for(Ad=0;Ad<Ai;Ad++){while(Ad<Ai&&Aa.getHeader(Ad).getFormIndex()!==undefined){Ad++;}if(Ad<Ai){var Ag=Aa.getHeader(Ad);AZ[Ag.t.n]=Ag.getName();}}for(Ad=0;Ad<Ab.length;Ad++){var Ak=this.getMetricValue(Af,Ad).value;AZ[Ab[Ad].n]={v:Ak.v,rv:Ak.rv};}Ah.push(AZ);Af++;}while(Af<Am);return Ah;}function AM(Aa){var AZ=[],Ab=this.data.gts.row;H.forEach(Ab,function(Ad,Ac){H.forEach(Aa,function(Ae){if(Ad.id===Ae.id){AZ[Ac]=true;}});});return AZ;}function AG(Aa){var AZ=Number(Aa);return isNaN(AZ)?0:AZ;}function s(Ad,Ao,Ai,Af,Ah,An,Aa,Ac,AZ,Am){var Ak=Ah.getName(),Ae=Ac?O(Ak):Ak,Ab=An&&(Ac?O(An.n):An.n),Ag=Ah.getElementId(),Al=Ah.getFormIndex()!==undefined;var Aj={name:Ae};if(AZ){Aj.tname=Ab;}if(Am){Aj.headerObj=Ah;Aj.attributeSelector={n:Ak,tid:Aa,eid:Ag,isSelectAttr:true};if(!Al){if(!Ad.metricSelector){Ad.metricSelector={};}Ad.metricSelector[Aa]=[{n:Ak,id:Ag}];}}if(Ao&&Ai[Af]===true){Ad.colorInfo.push(Ag);}Ad.headers.push(Aj);if(Ad.idValueMapping[Aa]){Ad.idValueMapping[Aa]+=(" "+Ak);}else{Ad.idValueMapping[Aa]=Ak;}}function AK(Aa,Ap,Ac,Ak,AZ,Ao,Aq,Al,An){var Af;if(Aa.additional){Af=Aa.additional[Aa.additional.length-1];}for(var Aj=0;Aj<Ac.length;Aj++){var Ae=Ac[Aj].oid,Ah=this.getColTitles().titles[0].es[Aj].n,Ag=AZ?O(Ah):Ah,Ai=this.getMetricValue(Ak,Aj).value,Am={v:Ai.v,rv:Ai.rv,id:Ae};if(Aq){var Ad=Ao[Aj];var Ab=Ad&&Ad[Ai.ti];if(Ab){Am.threshold=Ab;}}if(Al){Am.name=Ag;}if(Af){Af.values.push(K.copy(Am));Af.idValueMapping[Ae]=Ai.v;}if(!An){Aa.values.push(Am);Aa.idValueMapping[Ae]=Ai.v;}else{Aa.values[Aj].rv=AG(Aa.values[Aj].rv)+AG(Am.rv);}}}function Y(Az){var Ai=this.getTotalRows(),A2=this.data,Af=[],Ak=A2.gts.col[0],Ad=Ak?Ak.es:[],Ao=Ad.length,Ae,Au=0;Az=K.copy(Az,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(Ai<Az.minAttribute||Ao<Az.minMetric){throw"Error";}var AZ=Az.needDecode,Aw=Az.hasTitleName,Av=Az.hasSelection,A3=Az.hasThreshold,An=Az.colorByInfo,Ah=Az.additionalAttrIds||[];var Ax=An.length;var A0=A3?M(A2.th):undefined;Ae=AM.call(this,An);var At={};do{var Ab=this.getRowHeaders(Au),Ac=Ab.size(),A1="",Ay,As,A4,Am,Aj,Aa={headers:[],values:[],colorInfo:[],idValueMapping:{}},Al,Aq;if(Ah.length){Al={headers:[],values:[],colorInfo:[],idValueMapping:{}};for(Aq=0;Aq<Ac;Aq++){As=Ab.getHeader(Aq);A4=As.t;Am=A4&&A4.id;Aj=As.getElementId();if(Ah.indexOf(Am)===-1){A1+=Aj;}}Ay=!!At[A1];}else{Ay=false;}for(Aq=0;Aq<Ac;Aq++){As=Ab.getHeader(Aq);A4=As.t;Am=A4&&A4.id;if(Ah.indexOf(Am)>-1){s.call(this,Al,Ax,Ae,Aq,As,A4,Am,AZ,Aw,Av);}else{if(!Ay){s.call(this,Aa,Ax,Ae,Aq,As,A4,Am,AZ,Aw,Av);}}}if(Ay){Aa=At[A1];}else{if(Ah.length){Aa.additional=[];At[A1]=Aa;}Af.push(Aa);}if(Ah.length){if(Av){Al.metricSelector=K.copy(Aa.metricSelector,Al.metricSelector);}Aa.additional.push(Al);}AK.call(this,Aa,A2,Ad,Au,AZ,A0,A3,Aw,Ay);Au++;}while(Au<Ai);if(Ah.length){for(var Ap=0;Ap<Ad.length;Ap++){var Ag=Ad[Ap].oid,Ar=AH.getNumberFormat(A2,Ap);H.forEach(Af,function(A5){A5.idValueMapping[Ag]=A5.values[Ap].v=W.formatByMask(Ar,A5.values[Ap].rv);});}}return Af;}function i(Ac,AZ){for(var Aa=0;Aa<AZ.length;Aa++){var Ab=AZ[Aa];Ac.idValueMapping[Ab.cid]=Ac.values[Aa].v=W.formatByMask(Ab.mask,Ac.values[Aa].rv);}}function AD(Ab,AZ){var Aa;if(Ab.children){H.forEach(Ab.children,function(Ad){AD.call(this,Ad,AZ);if(Ab._eid!==AL){if(!Ab.values){Ab.values=[];}for(Aa=0;Aa<AZ.length;Aa++){var Ac=Ad.values[Aa];if(!Ab.values[Aa]){Ab.values[Aa]=K.copy(Ac);}else{Ab.values[Aa].rv=AG(Ab.values[Aa].rv)+AG(Ac.rv);}}}});if(Ab._eid!==AL){i.call(this,Ab,AZ);}}else{if(Ab.additional){i.call(this,Ab,AZ);Ab.formattedValue=Ab.values[0].v;Ab.value=Ab.values[0].rv;}}}function AV(A1){var A4=this.data,Aj=this.getTotalRows(),Ak=A4.gts.col[0],Ae=Ak?Ak.es:[],Aq=Ae.length,Ar={},At=[],Av,Aw=0,Au;A1=K.copy(A1,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(Aj<A1.minAttribute||Aq<A1.minMetric){throw"Error";}var Ah=A1.descKey,Ao=A1.childrenKey,AZ=A1.needDecode,Ay=A1.hasTitleName,Ax=A1.hasSelection,Ac=A1.nestedLevel||0,A3=A1.hasThreshold,Ap=A1.colorByInfo,Az=Ap.length,Ai=A1.additionalAttrIds||[];var A2=A3?M(A4.th):undefined;Ar[Ah]="root";Ar._eid=AL;Av=AM.call(this,Ap);var Am={},Ad,An,Ab,Al;var A0=function(BS,A7,BG,BK,BA,BL,BN){var BT=A7.getHeader(BG),BY=BT&&BT.t,BQ=BY&&BY.id,BO=(BT&&BT.getName())||"",BH=A7&&A7.headers&&A7.headers.length||0,BM=BT&&BT.getElementId(),BV=H.some(Av,function(Ba,BZ){return Ba&&((BG-BZ)%BH===0);});if(Ai.indexOf(BQ)===-1){if(!BS[Ao]){BS[Ao]=[];Am[BS._eid]={};}Ad=BS[Ao];An=Am[BS._eid];Ab=An[BM];}var BW=BG+1,BC=[BO];while(BW<A7.size()){var BB=A7.getHeader(BW),A6=BB&&BB.t,BD=A6&&A6.id;if(BD===BQ){BG++;if(BB&&BB.getName()){BC.push(BB.getName());}}else{break;}BW++;}BO=BC.join(" ");if(Az&&BV){At.push(BM);}var BF=(BT!==undefined);var BU={headerObj:BT,attributeSelector:{n:BO,tid:BQ,eid:BM,isSelectAttr:true}};var A5=[{n:BO,id:BM}];if(Ai.indexOf(BQ)>-1){BN.idValueMapping[BQ]=BO;if(Ax&&BF){BN.headers.push(BU);BN.metricSelector[BQ]=A5;}}else{if(!Ab||(BG===Ac-1)){Ab={_eid:BM,idValueMapping:{}};if(BS.idValueMapping){Ab.idValueMapping=K.copy(BS.idValueMapping);}Ab.idValueMapping[BQ]=BO;if(BF){Ab[Ah]=AZ?O(BO):BO;if(Ay){var BX=BY&&BY.n;Ab.tname=AZ?O(BX):BX;}if(Ax){Ab=K.copy(BU,Ab);}}Ad.push(Ab);An[BM]=Ab;}if(Ax&&BF){BL.push(BU);BA[BQ]=A5;if(BN){BN.metricSelector[BQ]=A5;}}}if(BG<A7.size()-1&&(!Ac||(BG<Ac-1))){A0.call(this,!Ab?BS:Ab,A7,BG+1,BK,BA,BL,BN);}else{var BJ=this.getMetricValue(BK,0).value;if(BJ){Ab.value=BJ.rv;Ab.formattedValue=BJ.v;}if(Az){Ab.colorInfo=At;At=[];}if(Ai.length){if(!Ab.additional){Ab.additional=[];}Ab.additional.push(BN);}if(!Ab.values){Ab.values=[];}for(Au=0;Au<Ae.length;Au++){var BI=Ae[Au].oid,BR=this.getMetricValue(BK,Au).value,A8={v:BR.v,rv:BR.rv,id:BI};if(A3){var BE=A2[Au],A9=BE&&BE[BR.ti];if(A9){A8.threshold=A9;}}if(Ay){var BP=this.getColTitles().titles[0].es[Au].n;A8[Ah]=AZ?O(BP):BP;}if(BN){BN.values.push(K.copy(A8));BN.idValueMapping[BI]=BR.v;if(!Ab.values[Au]){Ab.idValueMapping[BI]=BR.v;Ab.values.push(A8);}else{Ab.values[Au].rv=AG(Ab.values[Au].rv)+AG(BR.rv);}}else{Ab.idValueMapping[BI]=BR.v;Ab.values.push(A8);}}if(Ax){Ab.headers=BL;Ab.metricSelector=BA;}}};do{var Aa=this.getRowHeaders(Aw);if(Ai.length){Al={metricSelector:{},idValueMapping:{},values:[],headers:[]};}Ab=undefined;A0.call(this,Ar,Aa,0,Aw,{},[],Al);Aw++;}while(Aw<Aj);var Af=[];for(var As=0;As<Ae.length;As++){var Ag=Ae[As].oid;Af.push({cid:Ag,mask:AH.getNumberFormat(A4,As)});}if(Af.length){AD.call(this,Ar,Af);}return Ar;}function A(AZ,Aa){var Ab=[];H.forEach((AZ.row||[]).concat(AZ.col||[]),function(Ac){if((Ac.id===Aa)&&(Ac.fs)){Ab=Ab.concat(Ac.fs);}});return Ab;}function AN(AZ){return H.isArray(AZ);}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(AZ){this.data=AZ;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function AT(){if(this.data.eg){return 0;}var Ab=this.data,Aa=Ab&&Ab.ghs,AZ=Aa&&Aa.rhs,Ac=AZ&&AZ.items;return(Ac&&Ac.length)||0;},getTotalColHeaderRows:function G(){var AZ=this.data.ghs.chs.items;return(AZ&&AZ.length)||0;},getTotalCols:function S(){return this.getColHeaders(0).size();},getRowHeaders:function j(AZ){return new mstrmojo.models.template.Headers({data:this.data,i:AZ,isRow:true});},getColHeaders:function b(AZ){return new mstrmojo.models.template.Headers({data:this.data,i:AZ,isRow:false});},getMetricValue:function AR(Ab,AZ){var Aa=this.data;return new mstrmojo.models.template.MetricValue({data:Aa,value:Aa.gvs.items&&Aa.gvs.items[Ab].items[AZ]});},getColumnHeaderCount:function l(){var AZ=this.data.gvs.items;return AZ?AZ[0].items.length:0;},getCSSString:function u(){return this.data.cssString;},isEmpty:function D(){var Aa=this.data.gsi,Ab=function(Ac){return !!Ac.rows.length||!!Ac.cols.length||!!Ac.mx.length;};if(!Aa){return true;}else{if(AN(Aa)){var AZ=false;H.forEach(Aa,function(Ac){AZ=K.isEmpty(Ac)||!Ab(Ac);return AZ;});return AZ;}}return !Ab(Aa);},getAggregatePadding:function AW(Ad){var Aa=this.data.gsi&&(H.isArray(this.data.gsi)?this.data.gsi[0]:this.data.gsi).fmts,Ac=function(Af,Ae){return Af+Ae;},AZ=function(Af){var Ae=0;return["ch","rh","va"].map(function(Ag){var Ah=false;return Af.map(function(Ai){if(Aa[Ag]&&Aa[Ag].hasOwnProperty(Ai)){if(!Ah){Ah=true;Ae++;}return Aa[Ag][Ai];}return 0;}).reduce(Ac)/Af.length;}).reduce(Ac)/(Ae||1);},Ab;if(!Aa){return null;}Ab={v:AZ(["tp","bp"]),h:AZ(["rp","lp"])};if(Ad){Ab.v=parseFloat(W.convertUnits(AF.PT,AF.PX,Ab.v));Ab.h=parseFloat(W.convertUnits(AF.PT,AF.PX,Ab.h));}return Ab;},getColResizeScenario:function f(){var AZ=this.data;if(AZ.afw){return x;}else{if(AZ.afc===false){return U;}else{return AE;}}},getColResizeInfo:function AI(Ae){var Ag=this,Af=Ag.data,Ac={v:Ag.getColResizeScenario(),widths:null};var Ai=Af.gsi,Aa=Af.gts||{},Ak=[],Ad=Af.twm||{},Ah=Ad.top||[],Aj=Ad.bottom||[],Ab=0,AZ=function(Ao,Al){var An=function(Aq){var Ar=Aq.did,As=A(Aa,Ar),Ap=L.getFormsByAttrId(Ar,Ae);(As.length?As:[]).forEach(function(Av,Au){var Aw=Ap[H.find(Ap,"fid",Av.id)],At=(Aj&&Aj[Ab])||{};Ak.push({n:Aq.n+(Ap.length?(" - "+Aw.fnm):""),did:Ar,depth:Au+1,t:Aq.t||4,width:parseInt(At.w||0,10),widthModel:{top:(Ah&&Ah[Ab])||{},bottom:At}});Ab++;});return !Al;};if(Ai){var Am=mstrmojo.models.template.DataInterface.getGSI(Ai,Af.sortIndex);if(Am){Am[Ao].every(An);}}};AZ("rows",false);if(Ak.length===0){AZ("cols",false);}AZ("mx",Ai.tma===1);Ac.widths=Ak;return Ac;},getRowResizeScenario:function y(){return !!this.data.rh?U:AE;},getRowResizeInfo:function c(){var Aa=this.data,AZ=Aa.rh;return{v:this.getRowResizeScenario(),height:(AZ===undefined||AZ==="")?Aa.xrh:AZ};},getCellItemNumber:function Z(Ak){if(!Ak||Ak.axis===Q.Rows||Ak.tui===undefined){return -1;}var Ad=0,Ae=1,Ac=this.data,Ah=Ac.gsi,Aa=0,Aj=Ah[Aa],Ag=Ac.gts.col,Ab=Ag[0],Al=Ak.tui,Ai,AZ,Af;while(Ad<Al){Ai=Ab.id;if(Ai.length>0){if(!(Ai===AZ&&Af!==undefined&&Ab.cni===Af)){AZ=Ai;Af=Ab.cni;Ae+=1;}}else{while(Aj&&!Aj.mx.length){Aj=Ah[++Aa];}if(Aj){Ae+=Aj.mx.length;Aj=Ah[++Aa];}}Ad+=1;Ab=Ag[Ad];}if(Ab.id.length===0&&!!Ak.idx){Ae+=Ak.idx;}return Ae;},getLengthOfColumnSet:function AP(Ab,AZ){if(!!AZ){return Ab.cols.length;}var Aa=Ab.mx.length;return Ab.cols.length+(Aa&&Ab.tma===Q.Columns?Aa-1:0);},getColumnSetIndexCellBelongsTo:function E(AZ){var Ad=this.getCellItemNumber(AZ),Ac;if(Ad===-1){return -1;}var Ab=this.data.gsi,Aa=0;while(Aa<Ab.length){Ac=Ab[Aa];Ad-=this.getLengthOfColumnSet(Ac);if(Ad<=0){return Aa;}Aa+=1;}return -1;},_getColumnHeaderDataFromColumnSet:function AO(Ae){var Af=this,Ab=this.data.ghs,Ac=Ab.chs,Ad=Ac.items,AZ=[];Ad.forEach(function(Ag){(Ag.items||[]).forEach(function(Ah){if("mix" in Ah){AZ.push(Ah);}});});AZ.sort(function(Ah,Ag){return Ah.o-Ag.o;});var Aa=Ae.length;H.forEach(AZ,function(Ah){Ah.setIdx=Af.getColumnSetIndexCellBelongsTo(Ah);var Ag=Ah._ridx=[];H.forEach(AZ,function(Ai,Aj){if(Ah.setIdx===Ai.setIdx&&Ai.mix===Ah.mix){Ag.push(Aa+Aj);}});Ae.push(K.copyProps(["_ridx","setIdx"],Ah,K.copy(Ah._e,{})));});return Ae;},getColumnHeaderData:function o(Al){var Ah=this.data,Ao=Ah.gts,Am=Ah.gts.rec,Ap=[],Ab=[],Aj=Ao.row,An=mstrmojo.models.template.DataInterface.getGSI(Ah.gsi),Ag=An.prop.rows.shw===AS&&Al;H.forEach(Aj,function(Ar){var Aq=Ar.fs,As=Ar.otp===AA;if(!Ag){if(Aq&&Aq.length>1){H.forEach(Aq,function(){Ap.push(Ar);});}else{Ap.push(Ar);}}if(As){Ab=Ar.es;}});var Af=Ao.col;if(Af&&Af.length>0){if(AN(Ah.gsi)){Ap=this._getColumnHeaderDataFromColumnSet(Ap);}else{var Ae=Ah.ghs,Ac=Ae.chs,AZ=Ac.items,Aa=[],Ak=AZ.length>0?AZ[AZ.length-1].items:[],Ad=function Ad(Aq){if(!Aq||!Aq.pi){return ;}var Ar=Aq.pi,As=Ar&&Ar.ci,At=Ar&&Ar.ri;if(Aq.mix!==undefined){return Aq;}if(At===undefined||As===undefined){return ;}return Ad(AZ[At].items[As]);};H.forEach(Af,function(Aq){var Ar=Aq.otp===AA;if(!Ag&&(Ar&&(!Am||Aj.length===0))){Ap.push(Aq);}if(Ar){Aa=Aa.concat(Aq.es);}});var Ai=Ap.length;H.forEach(Ak,function(Aq){delete Aq._ridx;});if(Aa.length){H.forEach(Ak,function(At){var Aq=Ad(At);var Au=Aq?Aq.idx:(At.pi?0:At.idx),As=Aa[Au]||Aa[0];var Ar=As._ridx=As._ridx||[];if(Ar.length===0){H.forEach(Ak,function(Aw,Ax){var Av=Ad(Aw);if(!Aq||(Av&&Av.mix===Au)){Ar.push(Ai+Ax);}});}Ap.push(As);});}}}else{if(Ab.length>0){Ap.push(Ab[0]);}}return Ap;},getUnitById:function w(Aa){var AZ=null;mstrmojo.models.template.DataInterface.forEachGSI(this.data.gsi,function(Ac,Ab){[Ac.rows,Ac.cols,Ac.mx].some(function(Ad,Ae){if(Ae===2){Ae=-2;}Ad.some(function(Af,Ag){if(Af.did===Aa){AZ={axis:Ae+1,depth:Ag+1,unit:Af,csKey:Ab};}return !!AZ;});return !!AZ;});return !AZ;});return AZ;},getRawData:function h(AZ,Aa){switch(AZ){case C:return n.call(this,Aa);case I:return Y.call(this,Aa);}return AV.call(this,Aa);}});var g=mstrmojo.models.template.DataInterface;mstrmojo.models.template.DataInterface.getGSI=function AX(Ab,Aa){if(!H.isArray(Ab)){return Ab;}if(typeof Aa==="undefined"||Aa===null){return Ab[0];}if(typeof Aa==="number"){return Ab[Math.min(Math.max(Aa,0),Ab.length-1)];}var AZ=H.filterOne(Ab,function(Ac){return Ac.k===Aa;});return AZ||Ab[0];};mstrmojo.models.template.DataInterface.forEachGSI=function AY(Af,Ae,Ad,Ab){if(K.isEmpty(Af)){return ;}if(!H.isArray(Af)){if(Ab){Ae.call(Ab,Af,Ad);}else{Ae(Af,Ad);}}var AZ=(Af&&Af.length)||0,Aa;for(Aa=0;Aa<AZ;Aa++){var Ac=Aa===(AZ-1);if(Ab){if(Ae.call(Ab,Af[Aa],Af[Aa].k,Aa,Af,Ac)===false){break;}}else{if(Ae(Af[Aa],Af[Aa].k,Aa,Af,Ac)===false){break;}}}};mstrmojo.models.template.DataInterface.inflateGridData=function(Ab){var Ac=Ab.gvs,Aa=Ab.ghs,Ae=Ab.isv;if(Ab.egt===undefined&&(Ab.eg===undefined||Ab.eg===null)&&!!Ac&&K.isEmpty(Ac)){var AZ={v:"",rv:""},Ad={items:(Aa.chs.cws||[0]).map(function(){return AZ;})};Ac.items=Aa.rhs.items?Aa.rhs.items.map(function(){return Ad;}):[];Ac.show=true;if(Ae){Ac.ignoreCells=true;}}};mstrmojo.models.template.DataInterface.modifyGridData=function a(Aa,Ab,Ac){var AZ=false;if(Aa&&Ab){Aa[Ab]=Ac;AZ=true;}return AZ;};mstrmojo.models.template.DataInterface.ENUM_ROW_ARRANGEMENT=AB;mstrmojo.models.template.DataInterface.getRowArrangement=function m(Aa){var Ac=g.getGSI(Aa.gsi),AZ=K.walk("prop.rows.mg",Ac)==="-1",Ab;if(AZ){Ab=AB.HR;}else{if(K.walk("fmts.rh.atw",Ac)){Ab=AB.CT;}else{Ab=AB.FT;}}return Ab;};mstrmojo.models.template.DataInterface.getFormatsIntersection=function(Ai,Ah,Ad){var Ak=Ai&&g.getGSI(Ai.gsi),Aj=Ak&&Ak.fmts;var Ac={},AZ=Ai.gsi,Aa,Al,Ag=function(Am){var An=Aj[Am],Ao=Al[Am];if(!An||!Ao){return ;}K.forEach(Ao,function(Ap,Aq){var Ar=Am+"."+Aq;if(Ar in Ac){return true;}else{if(Aq in An&&An[Aq]!==Ap){An[Aq]=-1;Ac[Ar]=true;}}});},Af=[P.FMT_COL_HEADER,P.FMT_ROW_HEADER,P.FMT_VALUES];if(Af.indexOf(Ah)>-1){Af=[Ah];}Aj=K.clone(Aj);if(Ad){Aj=Aj[P.SUBTOTAL];}var Ae=AZ.length||0;for(var Ab=1;Ab<Ae;Ab++){Aa=AZ[Ab];Al=Aa.fmts;if(Ad){Al=Al[P.SUBTOTAL];}Af.forEach(Ag);}return Aj||{};};mstrmojo.models.template.DataInterface.getShowBanding=function J(AZ,Ab){var Aa=AZ&&mstrmojo.models.template.DataInterface.getGSI(AZ.gsi,Ab);return !!K.walk("prop.sb",Aa);};mstrmojo.models.template.DataInterface.findSelectorControl=function d(Aa){var AZ=Aa&&Aa.sc;if(AZ&&parseInt(AZ.ct,10)===t){return AZ;}return undefined;};mstrmojo.models.template.DataInterface.deleteSelectorControl=function AC(AZ){var Aa=AZ&&AZ.sc;if(Aa&&parseInt(Aa.ct,10)===t){delete AZ.sc;}};mstrmojo.models.template.DataInterface.isSubtotalOnTop=function F(AZ){return K.walk("gts.rowSubPos",AZ)===AU;};mstrmojo.models.template.DataInterface.isSubtotalOnBottom=function e(AZ){return K.walk("gts.rowSubPos",AZ)===N;};mstrmojo.models.template.DataInterface.getSubtotalPos=function AJ(AZ){return K.walk("gts.rowSubPos",AZ)||p;};mstrmojo.models.template.DataInterface.isLockRowHeader=function q(AZ){var Aa=AZ.lhv;return(Aa===X||Aa===z);};mstrmojo.models.template.DataInterface.isLockColHeader=function k(AZ){var Aa=AZ.lhv;return(Aa===AQ||Aa===z);};mstrmojo.models.template.DataInterface.ENUM_LOCKED_HEADERS={OFF:0,ROW:X,COL:AQ,BOTH:z};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:x,FIT_TO_CONTENTS:AE,FIXED:U};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:B,ROWS:C,ROWS_ADV:I};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.color","mstrmojo.string","mstrmojo.vi.enums.EnumFeatures","mstrmojo.VisUtility");var d=mstrmojo,t=d.dom,AT=d.css,N=d.array,l=d.color,W=d.string,J=mstrmojo.VisUtility,O=90,AQ=-90,u=180,e=-180,g=true,AA=d.vi.enums.EnumFeatures,AU="http://www.w3.org/2000/svg";var p;function AS(){var AY=navigator.userAgent.toLowerCase();return t.isIE||(AY&&AY.match(/rv:([\d.]+)\) like gecko/));}mstrmojo.gmaps.MapUtils=mstrmojo.provide("mstrmojo.gmaps.MapUtils",{_mixinName:"mstrmojo.gmaps.MapUtils",checkVal:function q(AY){return this.checkDefined(AY)&&!(isNaN(parseInt(AY)));},checkVals:function S(AZ){var AY=true;N.forEach(AZ,function(Aa){if(!this.checkVal(Aa)){AY=false;return false;}});return AY;},checkHasFunction:function f(AZ,AY){return AZ&&AZ[AY]&&AZ[AY] instanceof Function;},checkDefined:function Y(AY){return(AY!==undefined)&&(AY!==null);},parseBoolean:function c(AY){return AY===true||AY==="true";},isAsp:function AR(){return(window.location.pathname.indexOf("/asp/")>0);},trimString:function AH(AY){return mstrmojo.string.trim(AY);},log:function D(AY){if(console&&console.log){console.log(AY);}},replaceSpace:function AW(Aa,AZ){if(!this.checkDefined(Aa)){return ;}var AY=(this.checkDefined(AZ))?AZ:"_";return Aa.replace(/ /g,AY);},getProtocol:function F(){return"https:";},createMouseEvt:function M(AZ){var AY;if(AS()||t.isFF){AY=document.createEvent("MouseEvents");AY.initEvent(AZ,true,false);}else{if(window.MouseEvent){AY=new MouseEvent(AZ);}}return AY;},isRMClick:function w(AY){var AZ=false;if(AY){if(AY.which){AZ=AY.which===3;}else{if(AY.button){AZ=AY.button===2;}}}return AZ;},createNormalNode:function P(AY){if(!!AY){return document.createElement(AY);}},createSvgNode:function AM(AY){if(!!AY){return document.createElementNS(AU,AY);}},appendNode:function E(AY,AZ){if(this.checkHasFunction(AY,"appendChild")&&AZ){AY.appendChild(AZ);}},appendSvgNode:function AC(AY){if(!AY){return ;}var AZ=this.createSvgNode("svg");this.setCssStyles(AZ,{position:"absolute",width:AY.style.width,height:AY.style.height,top:"0px",left:"0px"});AY.appendChild(AZ);return AZ;},appendGNode:function n(AZ){if(!this.checkHasFunction(AZ,"appendChild")){return ;}var AY=this.createSvgNode("g");AZ.appendChild(AY);return AY;},setNodeAttributes:function X(AZ,AY){if(!this.checkHasFunction(AZ,"setAttribute")||!AY){return ;}for(var Aa in AY){if(this.checkDefined(AY[Aa])){AZ.setAttribute(Aa,AY[Aa]);}}},setCssStyles:function K(Aa,AZ){var AY=Aa&&Aa.style,Ab;if(!AY||!AZ){return ;}for(Ab in AZ){if(this.checkDefined(AZ[Ab])){AY[Ab]=AZ[Ab];}}},setCssTransform:function AX(AY,AZ){if(!AZ||!this.checkVal(AZ.x)||!this.checkVal(AZ.y)){return ;}N.forEach(N.ensureArray(AY),function(Aa){this.setNodeAttributes(Aa,{transform:"translate("+AZ.x+" "+AZ.y+")"});},this);},emptyDomElement:function AE(AY){if(!this.checkHasFunction(AY,"removeChild")){return ;}while(AY.firstChild){AY.removeChild(AY.firstChild);}},insertAfter:function U(Aa,AZ){var AY=AZ&&AZ.parentNode;if(Aa&&this.checkHasFunction(AY,"insertBefore")){if(AZ.nextSibling){AY.insertBefore(Aa,AZ.nextSibling);}else{AY.appendChild(Aa);}}},insertAsFirstChild:function AO(AY,AZ){if(AY&&AZ){if(AY.firstChild){AY.insertBefore(AZ,AY.firstChild);}else{AY.appendChild(AZ);}}},getEvtCoordInsideNode:function b(AZ,AY){var Aa=this.getBoundingRect(AY);if(!AZ||!this.checkVal(AZ.clientX)||!this.checkVal(AZ.clientY)||!Aa||!this.checkVal(Aa.left)||!this.checkVal(Aa.top)){this.log("getEvtCoordInsideNode(): Invalid clientRect.");return ;}return{x:AZ.clientX-Aa.left,y:AZ.clientY-Aa.top};},getBoundingRect:function AG(AY){if(this.checkHasFunction(AY,"getBoundingClientRect")){return AY.getBoundingClientRect();}},showWait:function x(){if(this.checkHasFunction(mstrApp,"showWait")){mstrApp.showWait();}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(true);}}},hideWait:function AP(AY){if(this.checkHasFunction(mstrApp,"hideWait")){mstrApp.hideWait(AY);}else{if(this.checkHasFunction(microstrategy,"showWait")){microstrategy.showWait(false);}}},isValidLatLng:function AJ(AZ,AY){if(!this.checkVal(AZ)||!this.checkVal(AY)){return false;}return parseInt(AZ)>=AQ&&parseInt(AZ)<=O&&parseInt(AY)>=e&&parseInt(AY)<=u;},isExpress:function AB(){return !!(mstrApp&&mstrApp.isExpress);},isVI:function AI(){return mstrApp&&mstrApp.isVI;},isOIVM:function H(){return mstrApp&&(mstrApp.isExpress||mstrApp.isVI);},isSingleTier:function Z(){return !!(mstrApp&&mstrApp.isSingleTier);},isWorkstation:function AK(){return mstrApp&&mstrApp.isWorkstation;},isWSLiveMode:function o(){return mstrApp&&mstrApp.supportFeature(AA.SUPPORT_LIVEMODE)&&(typeof mstrApp.getWSLiveMode==="function")&&mstrApp.getWSLiveMode();},isWSLocalMode:function m(){return this.isSingleTier()&&!this.isWSLiveMode();},getEvent:function z(AY){if(!t.supportsTouches){return AY;}else{return t.firstChangedTouch(window,AY);}},enableZoomLevelAndPosSaving:function Q(){return !this.isWorkstation()||g;},isCanvasSupported:function AL(){var AY=document.createElement("canvas");return !!(AY.getContext&&AY.getContext("2d"));},convertImageUrl:function i(AY){if(mstrApp.isDossier&&AY&&AY.indexOf("../")===0){return d.getStyleRoot()+"/../"+AY.substr(3);}return AY;},encode:function h(Aa,AZ){var Ac=Aa;if(!this.checkDefined(AZ)){AZ=false;}if(Aa&&Aa.length>0){Ac="";for(var Ab=0,AY=Aa.length;Ab<AY;Ab++){switch(Aa.charAt(Ab)){case"&":if((Aa.length!==(Ab+1))&&(Aa.charAt(Ab+1)==="#")){Ac+="&";}else{Ac+="&amp;";}break;case"<":Ac+="&lt;";break;case">":Ac+="&gt;";break;case"'":Ac+="&#039;";break;case"\n":if(!AZ){Ac+="<br />";}else{Ac+=Aa.charAt(Ab);}break;case'"':Ac+="&quot;";break;case" ":if(Ab===0||(Ab<Aa.length-1&&Aa.charAt(Ab+1)===" ")){Ac+="&nbsp;";}else{Ac+=Aa.charAt(Ab);}break;default:Ac+=Aa.charAt(Ab);break;}}}return Ac;},loadCss:function AV(AY,Ad){var Ac=document.styleSheets;if(Ac){var Aa,Ab;for(Aa=0;Aa<Ac.length;Aa++){Ab=Ac[Aa];if(Ab.id===AY){return ;}}}var AZ=document.createElement("link");AZ.setAttribute("rel","stylesheet");AZ.setAttribute("type","text/css");AZ.setAttribute("href",Ad);AZ.setAttribute("id",AY);document.getElementsByTagName("head")[0].appendChild(AZ);},getGraphicLayerById:function B(AY){var AZ=mstrmojo.all[AY];if(!AZ){this.hideWait();}return AZ;},isEmbedded:function C(){return mstrApp&&mstrApp.isEmbedded;},_verifyProtocol:function j(AY){if("https:"===window.location.protocol&&(-1!==AY.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==AY.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==AY.search(/^http\:\/\/.+\.arcgis\.com/i))){AY=AY.replace(/http:/i,"https:");}return AY;},loadExternalScript:function L(AZ,Ac,Aa){if(!AZ){return ;}var AY=document.createElement("script");AY.type="text/javascript";AY.src=AZ;if(Aa){AY.onerror=Aa;}if(AY.addEventListener){AY.addEventListener("load",function Ab(){AY.removeEventListener("load",Ab);AY.onerror=null;if(Ac){Ac();}},false);}else{if(AY.readyState){AY.onreadystatechange=function(){if(AY.readyState==="loaded"||AY.readyState==="complete"){AY.onreadystatechange=null;AY.onerror=null;if(Ac){Ac();}}};}}document.getElementsByTagName("head")[0].appendChild(AY);},getNoInternetMessage:function y(){var AZ,AY;if(mstrApp.isSingleTier){AZ="Unable to create the map. Please check your connection. You can configure an Internet proxy through your computer's #";AY='<a href="" style="color:#7CC5EC" onclick="window.FormWrapper.showProxyEditor(); return false;">'+mstrmojo.desc(7831,"Settings")+"</a>.";AZ=AZ.replace("#",AY);}else{AZ="Unable to download the requested map. Please contact your administrator to resolve this issue.";}return AZ;},getThemeClass:function A(){if(mstrApp&&mstrApp.getThemeClassName){return" "+mstrApp.getThemeClassName();}},adjustHSV:function AD(Ai,Aa,Ac,Ah){if(!Ai||!this.checkVal(Aa)||!this.checkVal(Ac)||!this.checkVal(Ah)){return Ai;}var Af,Aj,AZ,AY,Ad,Ae,Ab,Ag;if(!Ai){return Ai;}if(Ai.length===7){Af=parseInt(Ai.substring(1,3),16);Aj=parseInt(Ai.substring(3,5),16);AZ=parseInt(Ai.substring(5,7),16);}else{if(Ai.length===4){Af=parseInt(Ai.substring(1,2)+Ai.substring(1,2),16);Aj=parseInt(Ai.substring(2,3)+Ai.substring(2,3),16);AZ=parseInt(Ai.substring(3,4)+Ai.substring(3,4),16);}else{return Ai;}}AY=l.rgb2hsv(Af,Aj,AZ);AY[0]=AY[0]*Aa;AY[1]=AY[1]*Ac;AY[2]=parseInt(AY[2]*Ah>100?100:AY[2]*Ah,10);Ad=l.hsv2rgb(AY[0],AY[1],AY[2]);Af=parseInt(Ad[0],10);Aj=parseInt(Ad[1],10);AZ=parseInt(Ad[2],10);Ae=Af<16?"0"+Af.toString(16):Af.toString(16);Ab=Aj<16?"0"+Aj.toString(16):Aj.toString(16);Ag=AZ<16?"0"+AZ.toString(16):AZ.toString(16);Ai="#"+Ae+Ab+Ag;return Ai;},fillColorAjustForCMSelection:function R(AY){return this.adjustHSV(AY,1,0.5,1.2);},fillColorAjustForHover:function AF(AY){return this.adjustHSV(AY,1,0.6,1.15);},setLayerNodeProps:function I(Ab,Ac,Aa,AZ,AY){this.setNodeAttributes(Ab,{id:Ac,"class":Aa});this.setCssStyles(Ab,{position:"absolute",top:"0px",left:"0px"});if(this.checkVal(AZ)&&this.checkVal(AY)){AZ=parseInt(AZ);AY=parseInt(AY);this.setCssStyles(Ab,{width:AZ+"px",height:AY+"px"});}},destroyNode:function AN(AY){if(!AY){return ;}try{if(AY.parentNode){AY.parentNode.removeChild(AY);}}catch(AZ){}},destroyObj:function a(AY){if(AY&&AY.destroy instanceof Function){AY.destroy();}},removeHTMLTagsAndProps:function G(AZ,Ab,AY){try{(AZ.match(/<[^>]+>/g)||[]).forEach(function(Ag){var Aj,Ae,Ad,Af,Ak,Ac,Ah,Al,Ai=Ag;Ae=Ai.match(/<\/?([a-z]+\b)/i);if(Ae&&Ae.length===2){Ad=Ae[1];if(Ab.indexOf(Ad.toLowerCase())<0){AZ=AZ.replace(Ag,"");return ;}if(Ai.charAt(1)==="/"){Ai=Ai.substring(2);Ah="</";}else{Ai=Ai.substring(1);Ah="<";}Aj=Ai.length-2;if(Ai.charAt(Aj)==="/"){Ai=Ai.substring(0,Aj);Al="/>";}else{Ai=Ai.substring(0,Ai.length-1);Al=">";}Ai=Ai.replace(Ad,"");Ac="";Ak="";while(Ai!=Ac){Ac=Ai;Ai=W.trim(Ai);Ae=Ai.match(/([^=]+)=\s*('[^']*'|"[^"]*")/);if(Ae&&Ae.length===3){Af=W.trim(Ae[1]).split(/\s+/);if(Af&&Af.length>0){Af=Af[Af.length-1];if(AY.indexOf(Af.toLowerCase())>=0){Ak+=" "+Af+"="+Ae[2];}}Ai=Ai.substring(Ae[0].length);}}AZ=AZ.replace(Ag,Ah+Ad+Ak+Al);}});}catch(Aa){console.log("HTML Parse Error: "+Aa);}finally{return AZ;}},addArrowNode:function s(AZ){if(AZ){var AY=this.createNormalNode("div");AT.addClass(AY,"mstrmojo-Tooltip-arrow");this.appendNode(AZ,AY);}},getFontFamilyItems:function k(AY){if(p){return p;}else{p=N.filter(J.getFontFamilyItems(),function(AZ){return N.indexOf(AY,AZ.n)===-1;});return p;}},unserializeTooltipForms:function(AZ){if(!AZ){return{};}try{return JSON.parse(AZ);}catch(AY){return{};}},serializeTooltipForms:function(AY){return JSON.stringify(AY);},decodeWebJson:function(Aa,AZ){var AY=Aa;if(AZ){AY=W.decodeXMLAttribute(AY);AY=W.decodeHtmlString(AY,true);}AY=AY.replace(/&nbsp;/g," ");return AY;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.requiresCls("mstrmojo.num");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var k=mstrmojo.chart,g=k.model,t=mstrmojo.VisUtility,X=mstrmojo.dom,R=k.enums,E=R.EnumFontStyle,U=g.enums,AD=U.EnumDSSGraphProperty,b=U.EnumDSSGraphDataTextShowType,AE=U.EnumDSSGraphObject,M=mstrmojo.num;var F=mstrmojo.gm.EnumDataLabels;var Z=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var u=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var c=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function Y(AO){switch(AO){case AD.DssGraphFontColor:return 0;case AD.DssGraphFontName:return 1;case AD.DssGraphFontSize:return 2;case AD.DssGraphFontStyle:return 3;case AD.DssGraphFontSize100:return 4;default:return -1;}}function z(AO){switch(AO){case AD.DssGraphAreaColor:return 0;case AD.DssGraphFillEffect:return 1;case AD.DssGraphAreaAlpha:return 2;}return -1;}function AB(AO){var AP;switch(AO){case AE.DssGraphX1Body:case AE.DssGraphX1Label:case AE.DssGraphX1Major:case AE.DssGraphX1Minor:case AE.DssGraphUserLabel3:case AE.DssGraphUserLine3:AP="X1";break;case AE.DssGraphX2Body:case AE.DssGraphX2Label:case AE.DssGraphX2Major:case AE.DssGraphX2Minor:case AE.DssGraphUserLabel4:case AE.DssGraphUserLine4:AP="X2";break;case AE.DssGraphY1Body:case AE.DssGraphY1Label:case AE.DssGraphY1Major:case AE.DssGraphY1Minor:case AE.DssGraphUserLabel1:case AE.DssGraphUserLine1:AP="Y1";break;case AE.DssGraphY2Body:case AE.DssGraphY2Label:case AE.DssGraphY2Major:case AE.DssGraphY2Minor:case AE.DssGraphUserLabel2:case AE.DssGraphUserLine2:AP="Y2";break;case AE.DssGraphZBody:AP="Z";break;case AE.DssGraphO1Body:case AE.DssGraph2DO1Label:case AE.DssGraphO1Major:case AE.DssGraphO1Minor:AP="O1";break;case AE.DssGraphO2Body:case AE.DssGraph2DO2Label:case AE.DssGraphO2Major:case AE.DssGraphO2Minor:AP="O2";break;default:AP="No_Axis";break;}return AP;}function h(AO,AP){if(!!AO===false){return undefined;}return undefined;}function a(AT,AO){if(!!AT===false){return undefined;}var AY,AW,AV=AO.isVertical!==undefined?AO.isVertical:true,AQ=AO.isGridChart||false,AZ=AO.isPieShape||false,AU={Name:0,Value:0},AR=AT.gaid,AS=AT.goid,AP=AT.gsid,AX=AT.v;if(!!AR===false){return undefined;}switch(AR){case AD.DssGraphShowLBLFeeler:if(AZ){AU.Name="DataLabel";if((AX&b.DssGraphDataTextValue)!==0){AU.Value=F.SHOW_VALUE_ONLY;}else{if((AX&b.DssGraphDataTextLabel)!==0){AU.Value=F.SHOW_TEXT_ONLY;}else{AU.Value=F.HIDE;}}}break;case AD.DssGraphAreaColor:case AD.DssGraphFillEffect:case AD.DssGraphAreaAlpha:AW=z.call(this,AR);if(AW<0){return undefined;}if(AS===AE.DssGraphBackground){AU.Name=c[AW][0];if(AU.Name.search("Trans")!==-1){AU.Value=AX/255*100;}else{AU.Value=AX;}}break;case AD.DssGraphShowLegendText:AU.Name="LegendVisibleness";AU.Value=AX===0?false:true;break;case AD.DssGraphSDShowDataText:AU.Name="ShowSeriesDataLabel";AU.Value=AX!==0;break;case AD.DssGraphShowDataText:if(AZ===false){AU.Name="DataLabel";AU.Value=F.HIDE;if(AX&b.DssGraphDataTextValue){AU.Value=F.SHOW_VALUE_ONLY;}else{if(AX&b.DssGraphDataTextLabel){AU.Value=F.SHOW_TEXT_ONLY;}}}break;case AD.DssGraphFontColor:case AD.DssGraphFontName:case AD.DssGraphFontSize100:case AD.DssGraphFontSize:case AD.DssGraphFontStyle:AU.Value=AX;AY=AB.call(this,AS);AW=Y.call(this,AR);if(AW<0){return undefined;}if(AW===4){AW=3;AU.Value/=100;}if(AY==="No_Axis"){if(AS===AE.DssGraphDataText){if(AZ){return undefined;}AU.Name=Z[AW][2];}else{if(AS===AE.DssGraphPieFeelerLabel||AS===AE.DssGraphPieFeelerLabel){if(AZ===false){return undefined;}AU.Name=Z[AW][2];}else{if(AS===AE.DssGraphLegendText){AU.Name=Z[AW][3];}else{return undefined;}}}}else{if(AY[0]==="X"){AU.Name=Z[AW][0];}else{if(AY[0]==="Y"){AU.Name=Z[AW][1];}else{if(AY[0]==="O"){AU.Name=AV?Z[AW][0]:Z[AW][1];}else{return undefined;}}}}break;}return AU;}var W,m=String.fromCharCode,AH=mstrmojo.locales.datetime,AN=0,L=document.getElementById("measureText"),B={},l={};var q=0.03,K=0,S=0,H=0.2;function s(AP){var AO,AQ=[],AR;for(AO=0;AO<=AP;AO++){AR=AO.toString(16);if(AR.length===1){AR="0"+AR;}AQ[AO]=AR;}W=AQ;return AQ;}function AK(AO){var AP=parseFloat(AO);if(isNaN(AP)===false&&AP!==undefined&&AP!==null){return AP;}return 0;}function D(AO){AO=AO.replace(/ddd/g,"EEE");AO=AO.replace(/AM\/PM/g,"a");AO=AO.replace(/tt/g,"a");AO=AO.replace(/:'/g,":");AO=AO.replace(/'\/'/g,"/");AO=AO.replace(/\\/g,"");var AP,AR=true,AQ=AO.length;for(AP=0;AP<AQ;AP++){if(AO[AP]==="h"||AO[AP]==="H"||AO[AP]===":"){AR=true;}else{if(AO[AP]===" "&&AR){AR=true;}}if(AO[AP]==="m"&&AR){AO=AO.substring(0,AP)+"M"+AO.substring(AP+1);}}return AO;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{FIX_FRACTION_CONDENSED:2,point2D:{},rect2D:{},tripleId:{create:function N(AP,AT,AR,AQ,AS){if(AP===null||AP===undefined){AP=-3;}if(AT===null||AT===undefined){AT=-3;}if(AR===null||AR===undefined){AR=-3;}var AO={mObjectId:AP,mSeriesId:AT,mGroupId:AR};if(AQ!==undefined&&AQ!==null){AO.angleByIndex=AQ;}if(AS!==undefined&&AS!==null){AO.sliceById=AS;}return AO;},walks:function o(AS,AQ){if(!!AS===false||!!AQ===false){return null;}if(AS.length===1){return AQ[AS[0]];}var AR=(AS&&AS.length)||0,AP,AO=AS[AP];for(AP=0;AP<AR;AP++){if(AQ[AO]===undefined){AQ[AO]={};}AQ=AQ[AO];}return AQ;},equal:function e(AO,AP){return(AO.mObjectId===AP.mObjectId&&AO.mSeriesId===AP.mSeriesId&&AO.mGroupId===AP.mGroupId);},reset:function w(AQ,AS,AR,AP,AO,AT){AQ.mObjectId=AS!==undefined?AS:-3;AQ.mSeriesId=AR!==undefined?AR:-3;AQ.mGroupId=AP!==undefined?AP:-3;if(AO!==undefined&&AO!==null){AQ.angleByIndex=AO;}if(AT!==undefined&&AT!==null){AQ.sliceById=AT;}return AQ;}},transformProperty:function A(AO,AQ,AP){if(AQ===0){return a.call(this,AO,AP);}return h.call(this,AO,AP);},abbreviateNumber:function f(AY,AO){var AZ,AP,Aa="",AR=(AY<0),Ab=(this.isIntegar(AY)===false);if(Ab){AO++;}if(AY<0){AO++;}var AU=AR?-AY:AY;var AV=0;if(AU>=1e+27){AU=999;Aa="Y";}else{if(AU>=1e+24){AU/=1e+24;Aa="Y";}else{if(AU>=1e+21){AU/=1e+21;Aa="Z";}else{if(AU>=1000000000000000000){AU/=1000000000000000000;Aa="E";}else{if(AU>=1000000000000000){AU/=1000000000000000;Aa="P";}else{if(AU>=1000000000000){AU/=1000000000000;Aa="T";}else{if(AU>=1000000000){AU/=1000000000;Aa="B";}else{if(AU>=1000000){AU/=1000000;Aa="M";}else{if(AU>=1000){AU/=1000;Aa="K";}else{if(AU>=1){AV++;}else{if(AU>=0.001){AV++;}else{if(AU>=0.000001){AV++;}else{if(AU>=1e-9){AV++;}else{if(AU>=1e-12){AV++;}else{AR=false;}}}}}}}}}}}}}}if(this.isIntegar(AU)===false){AZ=M.toLocaleString(AU.toString());var AQ=5,AT=this.FIX_FRACTION_CONDENSED,Ac;AP=AZ.indexOf(M.getDecimal());Ac=AZ.length-AP-1;if(Ac>AQ||(Ac>AT&&Ac>AP)){if(Ac>AQ&&AO-Ac<0){AT=Math.max(AT,Math.min(AT,AO-Ac));}else{AT=Math.max(1,Math.min(AT,AO-Ac));}AU=AU.toFixed(AT);}}AZ=M.toLocaleString(AU.toString());if(this.isIntegar(AU)===false){var AX=AZ.length-1;AP=AZ.indexOf(M.getDecimal());if(AP!==-1){if(AP>=AX){AZ=AZ.substring(0,AP);}else{var AW,AS=true;for(AW=AX;AW>AP&&AS;--AW){if(AZ[AW]!=="0"){AS=false;}}if(AS){AZ=AZ.substring(0,AP);}}}}if(AR){AZ="-"+AZ;}AZ+=Aa;return AZ;},getScalePlate:function AJ(AO){AO=AO||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AO){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AG(AQ,AP,AR){var AO={mUseLogarithmicScale:AQ,mAlwaysIncludeZero:!AQ&&(AP||!!(AR&1)||!!(AR&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AO;},evaluateTextMargin:function Q(AO){this.mTextMargins=this.mTextMargins||{};var AP=this.mTextMargins;if(AP[AO]){return AP[AO];}var AQ=[];AQ[0]=Math.floor(AO*q+0.5);AQ[1]=Math.floor(AO*K+0.5);AQ[2]=Math.max(Math.floor(AO*S+0.5),1);AP[AO]=AQ;return AQ;},AlmostZero:function AC(AO){return(Math.abs(AO)<0.000001);},isValidNumber:function J(AO){if(typeof AO==="number"){if(AO===0){return true;}return !!AO;}return false;},isIntegar:function n(AO){return AO===+AO&&AO===(AO|0);},HasArrayIntersection:function P(AP,AO){var AQ;for(AQ=0;AQ<AP.length;AQ++){if(AO.indexOf(AP[AQ])!==-1){return true;}}return false;},EscapeString:function C(AO){var AQ='"',AP='\\"',AR=new RegExp(AQ,"g");return String(AO).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AR,AP).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function O(AO){var AQ='"',AP='\\"',AR=new RegExp(AQ,"g");return String(AO).replace(/\\/g,"\\\\").replace(AR,AP).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AI(AP){var AO;if(!AP.buf||AP.len===-1){return ;}AO=AP.len;var AQ=String(AP.buf[AO]);if(AQ&&AQ[AQ.length-1]===","){AP.buf[AO]=AQ.slice(0,-1);}},decodeUTF8:function j(AO){var AP="",AR=0,AT=0,AS=0,AQ=0;while(AR<AO.length){AT=AO.charCodeAt(AR);if(AT<128){AP+=m(AT);AR++;}else{if((AT>191)&&(AT<224)){AS=AO.charCodeAt(AR+1);AP+=m(((AT&31)<<6)|(AS&63));AR+=2;}else{AS=AO.charCodeAt(AR+1);AQ=AO.charCodeAt(AR+2);AP+=m(((AT&15)<<12)|((AS&63)<<6)|(AQ&63));AR+=3;}}}return AP;},formatDateTimeValue:function i(AP,AU){var AS=new mstrmojo.chart.common.DSSDateTime({ifTime:AU});var AO="";var AR="";var AV=0;while(AV<AP.length){var AQ=1;switch(AP.charAt(AV)){case"[":AV++;while(AV<AP.length&&AP.charAt(AV)!=="]"){AR+=AP.charAt(AV);AV++;}if(AR.length>0&&(AR[0]===">"||AR[0]==="<"||AR[0]==="=")){AR="";}AV++;break;case"y":AV++;while(AV<AP.length&&AP.charAt(AV)==="y"){AQ++;AV++;if(AQ===4){break;}}if(AQ===1||AQ===2){AO+=this.fillZeroToWidth(AS.mnYear%100,2);}else{if(AQ===3){AO+=this.fillZeroToWidth(AS.mnYear%100,2);AV--;}else{if(AQ===4){AO+=AS.mnYear;}}}break;case"M":AV++;while(AV<AP.length&&AP.charAt(AV)==="M"){AQ++;AV++;}if(AQ<3){AO+=this.fillZeroToWidth(AS.mnMonth,AQ);}else{if(AQ===3){AO+=AH.MONTHNAME_SHORT[AS.mnMonth];}else{AO+=AH.MONTHNAME_FULL[AS.mnMonth];}}break;case"d":AV++;while(AV<AP.length&&AP.charAt(AV)==="d"){AQ++;AV++;}if(AQ<3){AO+=this.fillZeroToWidth(AS.mnDay,AQ);}else{if(AQ===3){AO+=AH.dayShortNames[AS.mnDay];}else{AO+=AH.dayNames[AS.mnDay];}}break;case"h":AV++;while(AV<AP.length&&AP.charAt(AV)==="h"){AQ++;AV++;}var AT=AS.mnHour;if(AT===0){AT=12;}if(AT>12){AT-=12;}AO+=this.fillZeroToWidth(AT,AQ);break;case"H":AV++;while(AV<AP.length&&AP.charAt(AV)==="H"){AQ++;AV++;}AO+=this.fillZeroToWidth(AS.mnHour,AQ);break;case"m":AV++;while(AV<AP.length&&AP.charAt(AV)==="m"){AQ++;AV++;}AO+=this.fillZeroToWidth(AS.mnMinute,AQ);break;case"s":AV++;while(AV<AP.length&&AP.charAt(AV)==="s"){AQ++;AV++;}AO+=this.fillZeroToWidth(AS.mnSecond,AQ);break;case"S":AV++;while(AV<AP.length&&AP.charAt(AV)==="S"){AQ++;AV++;}AO+=this.fillZeroToWidth(AS.mnMillisecond,AQ);break;case"a":AT=AS.mnHour;if(AT<12){AO+=AH.AM_NAME;}else{AO+=AH.PM_NAME;}AV++;break;default:AO+=AP.charAt(AV++);break;}}if(AR.length!==0){AO='<SPAN STYLE="COLOR: '+AR+'" >'+AO+"</SPAN>";}return AO;},fillZeroToWidth:function p(AS,AQ){var AP="",AR=AP+AS;var AO=AR.length;while(AO<AQ){AR="0"+AR;AO++;}return AR;},fillZeroRightToWidth:function AM(AT,AR){var AQ="",AS=AQ+AT;var AP=AS.indexOf(".");if(AP!==-1){AS=AS.slice(0,AP)+AS.slice(AP+1);}var AO=AS.length;while(AO<AR){AS=AS+"0";AO++;}return AS;},updateCache:function AL(AP,AS,AT){var AR=(AS&&AS.length)||0,AQ,AO,AU=AP;for(AQ=0;AQ<AR-1;AQ++){AO=AS[AQ];if(!AU[AO]){AU[AO]={};}AU=AU[AO];}AU[AS[AR-1]]=AT;},measureTextHeight:function(AT,AQ,AX,AU,AO){var AW,AS=AT;if(AS===" "){AS="\u00A0";}AO=AO||"pt";if(typeof AX==="number"){AX=AX+AO;}var AP="none",AV="normal";if(AU&E.FS_ITALIC){AP="italic";}if(AU&E.FS_BOLD){AV="bold";}var AR={fontFamily:AQ,fontSize:AX,fontStyle:AP,fontWeight:AV};if(l&&l.H&&l.H[AQ]&&l.H[AQ][AX]&&l.H[AQ][AX][AU]){AW=l.H[AQ][AX][AU];}else{AW=t.measureTextHeight("H",AR,1);this.updateCache(l,["H",AQ,AX,AU],AW);}return AW;},measureText:function AA(AW,AT,Ae,AX,AQ,AY,Aa){var AP=true,AO,Ac=Ae+1,AS=false;var AV=AW;if(AV===" "){AV="\u00A0";AS=true;}AQ=AQ||"pt";if(typeof Ae==="number"){Ae=Ae+AQ;}if(!AY&&!Aa&&B&&B[AV]&&B[AV][AT]&&B[AV][AT][Ae]&&B[AV][AT][Ae][AX]){return B[AV][AT][Ae][AX];}if(AP){var AR="normal",AZ="normal";if(AX&E.FS_ITALIC){AR="italic";}if(AX&E.FS_BOLD){AZ="bold";}var AU={fontFamily:AT,fontSize:Ae,fontStyle:AR,fontWeight:AZ};if(l&&l.H&&l.H[AT]&&l.H[AT][Ae]&&l.H[AT][Ae][AX]){Ac=l.H[AT][Ae][AX];}else{Ac=t.measureTextHeight("H",AU,true);this.updateCache(l,["H",AT,Ae,AX],Ac);}if(AY&&!Aa&&!AS){AO=t.measureTotalTextSizeSplitting(AW,AU,0).width;}else{if(Aa&&!AS){AO=t.measureTotalTextSizeSplitting(AW,AU,0,true).width;Ac*=2;}else{AO=t.measureTextWidth(AW,AU,0);}}}else{if(!L){var Ab=document.createElement("div");Ab.id="measureText";Ab.style.position="absolute";Ab.style.top="0";Ab.style.visibility="hidden";Ab.style.height="auto";Ab.style.width="auto";document.body.appendChild(Ab);L=Ab;}X.emptyNode(L);L.appendChild(document.createTextNode(AV));L.style.fontFamily=AT;L.style.fontSize=Ae;L.style.fontWeight="normal";L.style.fontStyle="none";if(AX&E.FS_ITALIC){L.style.fontStyle="italic";}if(AX&E.FS_BOLD){L.style.fontWeight="bold";}AO=L.scrollWidth+1;Ac=L.scrollHeight+1;}var Ad={Width:AO,Height:Ac};this.updateCache(B,[AV,AT,Ae,AX],Ad);return Ad;},ReplaceDecimalPoint:function AF(AP,AO){return AP.replace(".",AO);},ReplaceMinusSign:function y(AO,AP){return AO.replace("-",AP);},insert:function G(AP,AO,AQ){if(typeof AP==="string"&&typeof AO==="string"&&AQ<=AP.length){return AP.substr(0,AQ)+AO+AP.substr(AQ);}return AP;},InsertThousandSeparator:function x(AQ,AR,AV){var AO=AV.mstrDecimalPoint;var AP=AQ.indexOf(AO);if(AP===-1){AP=AQ.length;}var AS=0;while(AS<AP&&!this.chk_val(AQ.charAt(AS))){AS++;}var AU=AQ;var AT;for(AT=AP-3;AT>AS;AT-=3){AU=this.insert(AU,AR,AT);}return AU;},chk_val:function I(AO){return/^\d+$/.test(AO);},hFormatValue:function d(Ab,AS,Am,BA){var AZ=0;var At=0;var Ai=Ab.length;var BI=false;if(!BA){BA={};var Ar=window.navigator.userLanguage||window.navigator.language;var BT=Ar.split("-");this.mstrLanguageCode=BT[0];this.mstrCountryCode=BT[1]||BT[0];BA.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";BA.mstrCurrencySymbol="$";BA.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";BA.mstrPercentSign="%";BA.mstrMinusSign="-";}while(AZ<Ai){if(Ab.charAt(AZ)==='"'){AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=='"'){AZ++;}AZ++;}else{if(Ab.charAt(AZ)==="["){AZ++;var As="";while(AZ<Ai&&Ab.charAt(AZ)!=="]"){As+=Ab.charAt(AZ);AZ++;}if(As.length>1&&(As.charAt(0)===">"||As.charAt(0)==="<"||As.charAt(0)==="=")){var AP=-1;var BC=0;switch(As.charAt(0)){case">":if(As.charAt(1)>="0"&&As.charAt(1)<="9"){AP=1;BC=1;}else{if(As.charAt(1)==="="&&As.length>2&&As.charAt(2)>="0"&&As.charAt(2)<="9"){AP=2;BC=2;}}break;case"=":if(As.charAt(1)>="0"&&As.charAt(1)<="9"){AP=3;BC=1;}else{if(As.charAt(1)==="="&&As.length>2&&As.charAt(2)>="0"&&As.charAt(2)<="9"){AP=3;BC=2;}}break;case"<":if(As.charAt(1)>="0"&&As.charAt(1)<="9"){AP=5;BC=1;}else{if(As.charAt(1)==="="&&As.length>2&&As.charAt(2)>="0"&&As.charAt(2)<="9"){AP=4;BC=2;}}break;}if(AP>0){var Ad=As.substr(BC);var BL=parseFloat(Ad);if((AP===1&&AS>BL)||(AP===2&&AS>=BL)||(AP===3&&AS===BL)||(AP===4&&AS<=BL)||(AP===5&&AS<BL)){BI=true;}return mstrmojo.num.formatByMask(Ab,AS);}}}else{if(Ab.charAt(AZ)===";"){if(BI){Ai=AZ;break;}else{At=AZ+1;AZ++;}}else{AZ++;}}}}if(!BI){At=0;}AZ=At;var Ay=false;while(AZ<Ai){if(Ab.charAt(AZ)==='"'){AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=='"'){AZ++;}}else{if(Ab.charAt(AZ)==="["){AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=="]"){AZ++;}}else{if(Ab.charAt(AZ)==="y"||Ab.charAt(AZ)==="M"||Ab.charAt(AZ)==="d"||Ab.charAt(AZ)==="h"||Ab.charAt(AZ)==="H"||Ab.charAt(AZ)==="m"||Ab.charAt(AZ)==="s"||Ab.charAt(AZ)==="S"){Ay=true;break;}else{AZ++;}}}}if(Ay){var BG="";if(BI){BG=Ab.substr(At,Ai-At);}else{BG=Ab;}return mstrmojo.num.formatByMask(BG,AS);}var BK;var Aq;var Av=false;var AV=false;var BF=false;var Ah=false;var BQ=[];var Al="";var Ae=0;var BB=false;var Ac=0;var BR="";var AW="";var Ap="";var A9="";var Aa=0;var BN=0;var BM=false;var BD=BA.mstrCurrencySymbol;var A4=BA.mstrThousandSeparator;var A0=BA.mstrDecimalPoint;var BE=BA.mstrPercentSign;var A8=BA.mstrMinusSign;AZ=At;var Ao="";if(AS<0&&!BI){while(AZ<Ai&&Ab.charAt(AZ)!==";"){if(Ab.charAt(AZ)==='"'){AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=='"'){AZ++;}}AZ++;}AZ++;if(AZ>=Ai){if(AS<0){BR+="-";}AZ=At;}}var BS=false;while(AZ<Ai){var Au=false;switch(Ab.charAt(AZ)){case"[":AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=="]"){Ap+=Ab.charAt(AZ);AZ++;}if(Ap.length>0&&(Ap.charAt(0)===">"||Ap.charAt(0)==="<"||Ap.charAt(0)==="=")){Ap="";}AZ++;break;case'"':AZ++;while(AZ<Ai&&Ab.charAt(AZ)!=='"'){if(BS){AW+=Ab.charAt(AZ);}else{BR+=Ab.charAt(AZ);}AZ++;}AZ++;break;case"#":case"0":var Ag=Ab.charAt(AZ);BS=true;var Ak=1;AZ++;while(AZ<Ai&&Ab.charAt(AZ)===Ag){Ak++;AZ++;}if(AZ+1<Ai&&Ab.charAt(AZ)==="-"&&Ab.charAt(AZ+1)===Ag){Ah=true;BQ.push(Ak);AZ++;while(true){Ak=0;while(AZ<Ai&&Ab.charAt(AZ)===Ag){Ak++;AZ++;}BQ.push(Ak);if(AZ>=Ai||Ab.charAt(AZ)!=="-"){break;}AZ++;}}while(AZ<Ai){if(Ab.charAt(AZ)===","){if(AZ+1<Ai&&Ab.charAt(AZ+1)===Ag){Av=true;}else{break;}}else{if(Ab.charAt(AZ)!==Ag){break;}}AZ++;}break;case".":BS=true;AZ++;Ae=0;while(AZ<Ai&&Ab.charAt(AZ)==="0"){Ae++;AZ++;}if(Ae===0){while(AZ<Ai&&Ab.charAt(AZ)==="#"){Ae++;AZ++;}}break;case"E":BN=6;while(AZ<Ai&&Ab.charAt(AZ)!=="0"){if(Ab.charAt(AZ)==="+"&&AZ<Ai&&Ab.charAt(AZ+1)==="0"){AV=true;}else{A9+=Ab.charAt(AZ);}AZ++;}Aa=0;while(AZ<Ai&&Ab.charAt(AZ)==="0"){Aa++;AZ++;}break;case"%":BN=4;AZ++;break;case"(":AZ++;BR+="(";break;case")":AZ++;AW+=")";break;case"-":AZ++;if(AS<0){BR+=A8;}break;case"?":AZ++;break;case"/":if(AZ>At&&Ab.charAt(AZ-1)==="?"&&AZ+1<Ai&&Ab.charAt(AZ+1)==="?"){BN=5;BB=false;Aq=AZ-1;while(Aq>At&&Ab.charAt(Aq)==="?"){Aq--;}while(Aq>At&&Ab.charAt(Aq)===" "){Aq--;}if(Aq>=At&&(Ab.charAt(Aq)==="#"||Ab.charAt(Aq)==="0")){BB=true;}Ac=0;AZ++;while(AZ<Ai&&Ab.charAt(AZ)==="?"){Ac++;AZ++;}}else{AZ++;}break;case",":if(AZ>At&&(Ab.charAt(AZ-1)==="0"||Ab.charAt(AZ-1)==="#")){BF=true;}Aq=AZ+1;while(Aq<Ai){if(Ab.charAt(Aq)===","){Aq++;continue;}else{break;}}if(Aq===Ai||Ab.charAt(Aq)==="."){BM=true;}if(BM||(!BM&&AZ+1<Ai&&Ab.charAt(AZ+1)===",")){while(AZ<Ai&&Ab.charAt(AZ)===","){AS/=1000;AZ++;}AZ--;}AZ++;break;case";":Au=true;break;case"$":if(BS){AW+=BD;}else{BR+=BD;}AZ++;break;case"_":if(BS){AW+=" ";}else{BR+=" ";}AZ++;AZ++;break;default:if(BS){AW+=Ab.charAt(AZ);}else{BR+=Ab.charAt(AZ);}AZ++;}if(Au){break;}}if(AS<0){AS=-AS;if(BR.length===0){BR=A8;}}var A2="";if(Ah){var Ax=0;for(BK=0;BK<BQ.length;BK++){Ax+=BQ[BK];}A2=Ao=this.fillZeroToWidth(Ax,AS.toFixed());for(BK=0;BK<BQ.length-1;BK++){Ax-=BQ[BK];var Aw=A2.length-Ax;A2=A2.slice(0,Aw)+"-"+A2.slice(Aw);}}else{switch(BN){case 0:if(BF){AS/=1000;}var A6=AS;if(A6<0){A6=-A6;}var AO=0;while(A6>=10){A6/=10;AO++;}if(AO>=15){A2=Ao=this.fillZeroRightToWidth((A6<0?-A6:A6),15);A2=A2.substr(0,16);if(A2.charAt(15)>="5"){var AY=14;while(AY>=0&&A2.charAt(AY)==="9"){A2=A2.slice(0,AY)+"0"+A2.slice(AY+1);AY--;}var AT=A2.charAt(AY);AT++;if(AY>=0){A2=A2.slice(0,AY)+AT+A2.slice(AY+1);}else{A2="1"+A2;}}A2=A2.substr(0,15);var BJ;for(BJ=AO-14;BJ>0;BJ--){A2+="0";}if(AS<0){A2=A8+A2;}}else{Ao+=String((+(Math.round(+(String(AS).indexOf("e")>0?String(parseFloat(String(AS)).toFixed(Math.min(Ae+2,20))):String(AS)+"e"+Math.min(Ae,20)))+"e"+-Math.min(Ae,20))).toFixed(Math.min(Ae,20)));A2=Ao;A2=this.ReplaceDecimalPoint(A2,A0);if(AS<0){A2=this.ReplaceMinusSign(A2,A8);}}if(Av){A2=this.InsertThousandSeparator(A2,A4,BA);}if(BF){A2+=Al;}break;case 5:if(BF){AS/=1000;}var An=10;for(BK=1;BK<Ac;BK++){An*=10;}var AQ={numerator:0,denominator:1};var AX={numerator:1,denominator:1};var AU={numerator:1,denominator:2};var A1={numerator:0,denominator:1};var Aj=AS>=0;var A7=Math.abs(AS);var A5=parseInt(A7,10);A7-=A5;while(AU.denominator<An){if(Math.abs(AK.call(AU)-A7)<1e-15){A1=AU;break;}if(AK.call(AU)>A7){AX=AU;}else{AQ=AU;}AU.denominator=AQ.denominator+AX.denominator;AU.numerator=AQ.numerator+AX.numerator;}if(AU.denominator>=An){if(A7-AK.call(AQ)<AK.call(AX)-A7){A1=AQ;}else{A1=AX;}}if(A5>0){A1.numerator+=A5*A1.denominator;}if(A1.denominator===0){BB=false;}var BH=false;var A3=false;var BP=A1.numerator;if(BB){A5=Math.floor(A1.numerator/A1.denominator);BP=A1.numerator%A1.denominator;A3=A3||(BP!==0);if(A5>0){BH=true;Ao+=A5;if(A3){Ao+=" ";}}}if(!A3&&!BH&&BP===0){Ao+="0";}else{if(!A3&&BH&&BP===0){AN++;}else{Ao+=BP;Ao+="/";Ao+=A1.denominator;}}A2=Ao;if(!Aj){A2=A8+A2;}if(Av){A2=this.InsertThousandSeparator(A2,A4,BA);}if(BF){A2+=Al;}break;case 4:AS*=100;Ao+=(AS+Math.pow(0.1,Ae+6)).toFixed(Ae);A2=Ao;A2=this.ReplaceDecimalPoint(A2,A0);if(AS<0){A2=this.ReplaceMinusSign(A2,A8);}if(Av){A2=this.InsertThousandSeparator(A2,A4,BA);}A2+=BE;break;case 6:var Az=AS;var BO=0;if(Az>1){while(Az>=10){Az/=10;BO++;}}else{if(Az!==0){while(Az<1){Az*=10;BO--;}}}Ao+=(Az+Math.pow(0.1,Ae+6)).toFixed(Ae);Ao+=A9;if(AV&&BO>=0){Ao<<"+";}if(BO<0){Ao<<"-";BO=-BO;}Ao+=this.fillZeroToWidth(BO,Aa);A2=Ao;A2=this.ReplaceDecimalPoint(A2,A0);if(AS<0){A2=this.ReplaceMinusSign(A2,A8);}break;}}var AR=BR+A2+AW;var Af=false;if(Ap.length!==0&&Af){AR='<SPAN STYLE="COLOR: '+Ap+'" >'+AR+"</SPAN>";}return AR;}});}());(function(){mstrmojo.requiresCls("mstrmojo.desc","mstrmojo.Container","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo","array","hash","Button","Box","Label","ui.Pulldown");var E=mstrmojo.hash,K=mstrmojo.array,A=mstrmojo.vi.ui.DatasetUnitMenuUtils,L=mstrmojo.VisUtility,D=4,M={fontSize:"12px",fontFamily:"Arial"},J=80,P=mstrmojo.desc(17384,"Select an Attribute"),G=mstrmojo.desc(17383,"Select a Metric"),H=mstrmojo.desc(16896,"Use objects to replace"),I=L.measureTextWidth(H,M);mstrmojo.vi.ui.AMSelectorCandidatePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.vi.ui.AMSelectorCandidatePicker",markupString:'<div class="candidate-picker-curtain"><div class="candidate-picker"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},selector:null,rplObj:null,viUnit:null,maxSizeFromText:null,init:function O(Q){this._super(Q);this.initCandidateList();},getCandidateData:function F(){var R=E.walk("viUnit.boxContent.model.data",this),W=R&&R.gsi,Q=this.selector.isAttrSelector,S,U=[];if(!W){return U;}S=K.ensureArray(W);K.forEach(S,function(X){U=U.concat(Q?(X.rows||[]).concat(X.cols||[]):X.mx);});if(!Q&&R.trendref){U=L.filterTrendlineMXByDZ(U,R.dz);}return U;},calculatePulldownWidth:function N(){var Q,R=this.viUnit.width,S=parseInt(R)-80;if((S<=this.maxSizeFromText)||(this.maxSizeFromText>=I)||(S<=J)){Q=Math.max(Math.min(this.maxSizeFromText,S),J);}return Q;},initCandidateList:function B(){var U=this.getCandidateData(),Y=this;E.forEach(this.selector.replaceRelation,function(c,b){if(b===Y.viUnit.k){Y.rplObj=c;return false;}});var Q=[];var W=[];var R=-1;K.forEach(U,function(b){if(b.did!=="-1"){if(b.ru){var c=b.ru.did;if(!K.includes(Q,c)){Q.push(c);W.push({n:b.ru.n,did:b.ru.did,unit:b.ru});if(Y.rplObj&&Y.rplObj.id===c){R=W.length-1;}}}else{if(!b.is_pushdown&&!K.includes(Q,b.did)){Q.push(b.did);W.push({n:b.n,did:b.did,unit:b});if(Y.rplObj&&Y.rplObj.id===b.did){R=W.length-1;}}}}});var S=E.walk("selector.model.datasets",Y),a=[],X;E.forEach(S,function(b){X=Y.selector.isAttrSelector?b.att:b.mx;a=a.concat(X);});K.forEach(W,function(b){K.forEach(a,function(c){if(c.did===b.did){b.unit=c;return false;}});});if(R===-1){R=0;if(Y.rplObj){K.forEach(a,function(b){if(Y.rplObj.id===b.did){W.unshift({n:b.n,did:b.did,unit:b,hid:true});return false;}});}else{if(W.length>1){W.unshift({n:Y.selector.isAttrSelector?P:G,hid:true});}}}var Z;if(W.length){this.maxSizeFromText=W.map(function(b){if(!b.unit){return L.measureTextWidth(b.n,M)+32;}return L.measureTextWidth(b.n,M)+50;}).reduce(function(d,c){return Math.max(d,c);});Z=this.calculatePulldownWidth();}this.addChildren({scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:click></div>',alias:"pickerInnerBox",slot:"containerNode",onclick:function(b){b.cancel();},children:[{scriptClass:"mstrmojo.Label",text:H},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"candiPickerPulldown",cssText:Z?("width: "+Z+"px;"):"",alias:"candiPulldown",selectedIndex:R,isHostedWithin:false,items:W.map(function(b){if(b.unit){if(!b.unit.t){b.unit.t=D;}b.cls=A.getUnitCssClass(b.unit);}else{b.cls="default";}return b;}),onitemSelected:function(d,b){if(d.unit){if(!Y.rplObj||d.unit.did!==Y.rplObj.id){Y.rplObj={id:d.unit.did,tp:d.unit.t||D};Y.selector.tmp_replaceRelation[Y.viUnit.k]=E.clone(Y.rplObj);var c=E.walk("viUnit.parent._tgtSelections.notify",Y);if(c instanceof Function){c();}}else{if(Y.rplObj&&d.unit.did===Y.rplObj.id){Y.selector.tmp_replaceRelation[Y.viUnit.k]=E.clone(Y.rplObj);}}}this.selectedNode.className="mstrmojo-ui-Pulldown-text "+d.cls;}}]});if(W.length===1&&!W[0].did){this.pickerInnerBox.candiPulldown.set("enabled",false);}},resize:function C(){if(this.maxSizeFromText){var R=this.calculatePulldownWidth(),Q=E.walk("pickerInnerBox.candiPulldown.domNode.style",this);if(Q){Q.width=R?(R+"px"):"";}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.Container","mstrmojo.Button","mstrmojo.VisUtility","mstrmojo.hash");var E=mstrmojo.dom,W=mstrmojo.css,K=mstrmojo.hash,B=mstrmojo.VisUtility,M="mobile-dossier-contextmenu-menu",S="mobile-dossier-contextmenu-button-group";mstrmojo.mobile.MobileDossierContextMenu=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.mobile.MobileDossierContextMenu",markupString:'<div id="{@id}-mobileDossierContextmenuwrapper" class="mstrMobileDossierContextMenu"><div class="dossier-contextmenu-title"></div><div class="dossier-contextmenu-back-button"></div><div class="dossier-contextmenu-separator"></div><div class="dossier-contextmenu-container"></div></div>',markupSlots:{contextmenuTitle:function(){return this.domNode.firstChild;},contextmenuBackBtn:function(){return this.domNode.childNodes[1];},titlemenuSeparator:function(){return this.domNode.childNodes[2];},menusContainer:function(){return this.domNode.childNodes[3];}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},parent:null,parentMenu:null,isShow:false,registerEventHandler:function I(){this.oncontextmenu=function(a){if(a.stopPropagation){a.stopPropagation();}if(a.preventDefault){a.preventDefault();}a.cancelBubble=true;};this.domNode.addEventListener("contextmenu",this.oncontextmenu);var Z=this;var Y=function X(){Z.onBackClicked();};this.contextmenuBackBtn.addEventListener("click",Y);},onBackClicked:function F(){if(this.parentMenu){this.parentMenu.setVisibility(true);}this.setVisibility(false);},addMenuFeedback:function G(X){X.addEventListener("touchstart",function(){W.toggleClass(X,"selected",true);});X.addEventListener("touchend",function(){W.toggleClass(X,"selected",false);});X.addEventListener("touchcacel",function(){W.toggleClass(X,"selected",false);});},init:function Q(X){this._super(X);},hideMenus:function D(){this.setVisibility(false);if(this.drillSubMenu){this.drillSubMenu.setVisibility(false);}},setVisibility:function N(X){var Y=K.walk("domNode.style",this);if(Y){Y.display=(!!X)?"block":"none";}this.isShow=X;},getVisibility:function A(){return this.isShow;},postBuildRendering:function R(){this._super();this.registerEventHandler();this.setVisibility(false);},updateMenus:function H(X){if(X.menus.length>0){E.emptyNode(this.menusContainer);this.setVisibility(true);}else{this.setVisibility(false);return ;}var Y=X.title;if(Y){this.contextmenuTitle.innerText=X.title;}W.toggleClass(this.contextmenuTitle,"no-title",!Y);W.toggleClass(this.contextmenuBackBtn,"no-back",!X.hasBack);W.toggleClass(this.titlemenuSeparator,"no-separator",!(Y||X.hasBack));this.addMenuNodes(X.menus);},triggermenu:function U(){this.setVisibility(false);if(this.parent&&this.parent.hideContextMenu){this.parent.hideContextMenu();}},addMenuNodes:function C(a){var f=this.addMenuTableNode();var Y=f.childNodes[0];var b,Z,c;var e=133;var X=0;var d=this;a.forEach(function(i){var m=f.insertRow(-1),l=m.insertCell(-1);m.className=M;l.className=M;var j=i.n;var n=i.cls;var k=i.fn;var p=i.ctxt;l.innerText=j;if(j===mstrmojo.desc(145,"Drill")){var g=k(p);if(g&&g.menus&&g.menus.length>0){var h=function(){d.setVisibility(false);d.displayDrillSubMenu(g);};l.addEventListener("click",h);}else{W.toggleClass(l,"disabled",true);}}else{if(n==="count"||n==="separator"){m.classList.add(n);l.classList.add(n);}else{if(n===S){d.addSortButton(f,i);}else{l.addEventListener("click",function(){k(i);d.triggermenu();});}}}if(n!==S){d.addMenuFeedback(l);}b=B.getComputedFontStyle(l);Z=Math.ceil(B.measureTextWidth(l.innerText,b,b.bonus));X=Math.max(X,Z);X=Math.max(X,e);var o=parseInt(W.getComputedStyle(l).paddingRight);Y.style.width=(X+o+1)+"px";c=X+o;f.style.width=(c+2)+"px";});},addMenuTableNode:function L(){var Z=document.createElement("table");Z.className="dossier-contextmenu-table";Z.appendChild(document.createElement("COL"));var X=350;var Y=this.contextmenuTitle.offsetHeight+1+20*2;var a=document.body.offsetHeight-Y;if(a<X){Z.style.maxHeight=a+"px";}this.menusContainer.appendChild(Z);return Z;},displayDrillSubMenu:function O(X){this.createDrillSubMenu(X);this.drillSubMenu.domNode.style.top=this.domNode.style.top;this.drillSubMenu.domNode.style.left=this.domNode.style.left;this.setVisibility(false);this.drillSubMenu.setVisibility(true);},createDrillSubMenu:function P(X){if(!X){return ;}if(!this.drillSubMenu){this.drillSubMenu=new mstrmojo.mobile.MobileDossierContextMenu({parent:this.parent,parentMenu:this});this.drillSubMenu.render();document.body.appendChild(this.drillSubMenu.domNode);}X.title="Drill";X.hasBack=true;this.drillSubMenu.updateMenus(X);},addSortButton:function J(Y,b){this.contextmenuTitle.style.cssText="line-height:32px; font-size:16px; text-transform: uppercase;";var Z=Y.rows.item(Y.rows.length-1);W.toggleClass(Z.firstChild,"mobile-dossier-contextmenu-button-header",true);var a=Y.insertRow(-1);a.className=S;var X=b.ctxt.status;b.ctxt.buttons.forEach(function(f){var d=a.insertCell(-1);d.className="mobile-dossier-contextmenu-button-container";d.style.left=f.left;var e=X===f.value;W.toggleClass(d,"selected",e);var g=document.createElement("div");g.className="mobile-dossier-contextmenu-button "+f.cls;var c=document.createElement("div");c.className="mobile-dossier-contextmenu-button sort-clear";d.appendChild(g);d.appendChild(c);d.addEventListener("click",function(){b.fn(f);});});}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.mobile.MobileDossierContextMenu","mstrmojo.VisUtility","mstrmojo.VisEnum");var Y=mstrmojo.css,H=mstrmojo.dom,P=mstrmojo.hash,C=mstrmojo.VisUtility,N="vis-tooltip",U=20,M="px",K=mstrmojo.VisEnum.TOOLTIP_STATE;function W(){return this.scriptClass==="mstrmojo.NewVisTooltip";}function I(){if(this.menuNodes){this.menuNodes.forEach(function(Z){H.emptyNode(Z);if(Z&&Z.parentNode){Z.parentNode.removeChild(Z);}});this.menuNodes=[];Y.toggleClass(this.domNode,"menu-only",false);}}function E(){if(W.call(this)&&this.linkNode&&this.linkNode.parentNode){this.linkNode.parentNode.removeChild(this.linkNode);}}function A(d,e,b,a){var h=document.createElement("div");h.className=N+"-menu-row-container";this.domNode.appendChild(h);this.menuNodes.push(h);Y.toggleClass(h,N+"-menu-row-container-only",!b);var g=64;var Z=0;var f=this;d.forEach(function(k){var m=k.n;var n=k.fn;var s=k.ctxt;var p=document.createElement("div");p.className=N+"-menu";h.appendChild(p);if(m===mstrmojo.desc(145,"Drill")){var l=function(){var t=n(s);f.displayDrillSubMenu(t);};H.attachEvent(p,"click",l);}else{if(m.indexOf(mstrmojo.desc(183,"Drill to"))>-1){p.addEventListener("click",function(){n(k);f.domNode.style.display="none";});}else{p.addEventListener("click",function(){n(s);f.domNode.style.display="none";});}}f.addMenuFeedback(p);var j=C.getComputedFontStyle(p);var q=Math.max(Math.ceil(C.measureTextWidth(m,j,j.bonus)),g);Z=Math.max(q,Z);var i=100/d.length;p.style.width=i+"%";p.innerText=m;var o={node:p,handler:n};f.menuInfo.push(o);});if(a){this.domNode.style.paddingBottom="0px";}var c=Z*d.length;return Math.max(c,e);}function D(e,a,b){if(this.menuInfo){this.menuInfo.forEach(function(g){H.detachEvent(g.node,"click",g.handler);});this.menuInfo=[];}var d=this;if(e){var f=[];var c=a;var Z=b;if(e.menus.length>0){Y.toggleClass(this.domNode,"menu-only",!Z);}else{Y.toggleClass(this.domNode,"menu-only",false);}e.menus.forEach(function(g){if(g.cls==="separator"){if(f.length>0){c=A.call(d,f,c,Z,false);Z=true;}f=[];}else{f.push(g);}});if(f.length>0){c=A.call(d,f,c,Z,true);}return c;}return a;}mstrmojo.mobile._MobileVisTooltip=mstrmojo.provide("mstrmojo.mobile._MobileVisTooltip",{menuInfo:[],menuNodes:[],submenuInfo:[],state:K.STATE_DEFAULT,isShow:false,touchPoint:{x:0,y:0},postBuildRendering:function X(){this._super();Y.addClass(document.body,"touch-device");},addMenuFeedback:function L(Z){Z.addEventListener("touchstart",function(){Y.toggleClass(Z,"selected",true);});Z.addEventListener("touchend",function(){Y.toggleClass(Z,"selected",false);});Z.addEventListener("touchcacel",function(){Y.toggleClass(Z,"selected",false);});},setVisibility:function Q(Z){var a=P.walk("domNode.style",this);if(a){a.display=(!!Z)?"block":"none";}this.isShow=Z;},getVisibility:function B(){return this.isShow;},displayMobileEmptyContentInfo:function O(){if(!W.call(this)){return null;}Y.addClass(this.tableNode,"new-vis-tooltip-empty-content");E.call(this);if(!this.domNode.parentNode){document.body.appendChild(this.domNode);}this.clearTooltipHandler();this.infoObj=null;this.link=null;this.toggle(true);this.tableNode.innerText=mstrmojo.desc(18285,"No tooltip information.");return this.tableNode;},displayMobileInfo:function J(Z,f,e,b){this.touchPoint=f;this.state=e;if(e===undefined){this.state=K.STATE_DEFAULT;}this.domNode.style.userSelect="none";this.domNode.style.paddingBottom="10px";var d;if(this.state===K.STATE_EMPTY_CONTENT){d=this.displayMobileEmptyContentInfo();var a=d&&d.parentNode;if(a){a.style.height="auto";}}else{d=this.displayInfo(Z,f,undefined,undefined,null,false);if(W.call(this)){Y.removeClass(this.tableNode,"new-vis-tooltip-empty-content");}}I.call(this);E.call(this);if(this.state===K.STATE_COMBINED||this.state===K.STATE_EMPTY_CONTENT){var c=D.call(this,b,d.offsetWidth,Z.length>0);this.adjustContentTableWidth(d,c);if((Z.length>0||this.state===K.STATE_EMPTY_CONTENT)&&b&&b.menus.length>0&&d.parentNode){d.parentNode.style.paddingBottom="10px";}}else{if(this.state===K.STATE_SUMMARY){d.parentNode.style.paddingBottom="0";}}if(f){this.moveTo(f.x,f.y);}},adjustContentTableWidth:function F(b,c){b.style.width=c+"px";if(W.call(this)){this.moveTo(this.touchPoint);}var Z=b.parentNode;if(Z){Z.style.width="100%";}if(Y.hasClass(Z,"new-vis-tooltip-container")){var a=Z&&Z.parentNode;if(a){a.style.width="100%";}}},moveDomTo:function(e,i){var g=mstrmojo.dom.position(document.body),k=i.x,j=i.y,l=e.offsetWidth,f=e.offsetHeight,d=g.x+g.w,m=g.y+g.h,b=k,Z=j-f-U,a=5;if(Z<=0){Z=j+U;b+=2*U;}if(b>d-l-a||Z>m-f-a){if(b<=d-l-a){Z=m-f-a;}else{if(Z<=m-f-a){b=d-l-a;}else{b=d-l-a;Z=j-U-f;}}}if(b<0){b=U;}if(Z<0){Z=U;}var c=e.style;c.left=b+M;c.top=Z+M;},moveTo:function(Z,a){if(this.exitFixMode){return ;}if(Z&&Z.x&&Z.y){this._super(Z,a);return ;}this.moveDomTo(this.domNode,{x:Z,y:a});},displayDrillSubMenu:function R(Z){this.createDrillSubMenu(Z);this.drillSubMenu.domNode.style.top=this.domNode.style.top;this.drillSubMenu.domNode.style.left=this.domNode.style.left;this.moveDomTo(this.drillSubMenu.domNode,this.touchPoint);this.setVisibility(false);this.drillSubMenu.setVisibility(true);},createDrillSubMenu:function S(Z){if(!this.drillSubMenu){this.drillSubMenu=new mstrmojo.mobile.MobileDossierContextMenu({parent:this.parent,parentMenu:this});this.drillSubMenu.render();document.body.appendChild(this.drillSubMenu.domNode);}else{if(!this.drillSubMenu.domNode.parentNode){document.body.appendChild(this.drillSubMenu.domNode);}}Z.title=mstrmojo.desc(145,"Drill");Z.hasBack=true;this.drillSubMenu.updateMenus(Z);},onBackClicked:function G(){if(this.parentMenu){this.parentMenu.setVisibility(true);}this.setVisibility(false);},});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.desc","mstrmojo.Container","mstrmojo.vi.ui.AMSelectorCandidatePicker");var D=mstrmojo.css,H=mstrmojo.hash,E=mstrmojo.dom;var C={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A tgt-tt",topOffset:15,leftOffset:-15};mstrmojo.vi.ui.TargetMask=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.vi.ui.TargetMask",markupString:'<div class="mstrmojo-hasTgt" mstrAttach:contextmenu><div class="tgt"><div></div>'+mstrmojo.desc(4787,"Target")+'</div><div class="src"><div></div>'+mstrmojo.desc(4283,"Source")+"</div></div>",useRichTooltip:true,isDynamicTooltip:true,tooltipContent:mstrmojo.desc(15275,"This container cannot be selected as target"),allowFilters:false,init:function G(I){if(this._super){this._super(I);}},setMaskClass:function(O,N){var K=this.parent,I=K instanceof mstrmojo.vi.ui.rw.PanelStackBox,M=K instanceof mstrmojo.vi.ui.rw.VizBox,J=K instanceof mstrmojo.vi.ui.rw.FilterBox,L=H.walk("mstrmojo.vi.ui.rw.SurveyBox")&&(K instanceof mstrmojo.vi.ui.rw.SurveyBox);if(this.domNode){if(K.id===O){D.addClass(this.domNode,"sourced");}else{if(!I&&!M&&!(J&&this.allowFilters)&&!L){D.addClass(this.domNode,"disabled");}else{if(N){D.addClass(this.domNode,N);}else{D.addClass(K.domNode,"targeted");}}}this.domNode.style.display="block";return true;}return false;},clearMaskClass:function(){var I=this.parent;D.removeClass(this.domNode,"sourced");D.removeClass(this.domNode,"disabled");D.removeClass(I.domNode,"targeted");this.domNode.style.display="none";},moveTooltip:function F(J,M){var L=this,I={x:J.clientX-10,y:J.y},K=L.AMSelectorSpecificTooltipConfig;this.richTooltip={posType:C.posType,cssClass:C.cssClass,content:this.tooltipContent,top:J.clientY+C.topOffset,left:J.clientX+C.leftOffset};if(K){this.richTooltip.cssClass=K.cssClass;this.richTooltip.content=K.tooltipContent;this.richTooltip.top=J.clientY+K.topOffset;this.richTooltip.left=J.clientX+K.leftOffset;this.richTooltip.updatePosition=function(){K.updatePosition.call(this,I,I,K.cssClassPrefix);};this.tooltipOpenDelay=K.tooltipOpenDelay;}this._super(J,M);},oncontextmenu:function(J,I){E.preventDefault(I,J);},addCandidatePicker:function B(J,I){this.addChildren([{scriptClass:"mstrmojo.vi.ui.AMSelectorCandidatePicker",alias:"candidatePicker",slot:"domNode",selector:J,viUnit:I}]);},removeCandidatePicker:function A(){if(this.candidatePicker){this.removeChildren(this.candidatePicker);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var p=mstrmojo,B=p.css,q=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.num,H=mstrmojo.VisUtility,d=mstrmojo.chart,L=d.enums,e=L.EnumGraphMajorType,K=d.common.Utility,W=d.model,N=W.enums,z=N.EnumDSSGraphObject,AD=mstrmojo.VisEnum.ControlType,AA=p.gm,X=mstrmojo.gm.EnumTextAlignH,t=mstrmojo.gm.EnumTextAlignV,y=";",l=",",A="_tmsp",M=" ",b=-20,m=mstrmojo.gm.EnumSelectionOptionLevel,AF=mstrmojo.gm.EnumShape,i=mstrmojo.color,J=mstrmojo.gm.EnumIdentityType,S=0.00001,E,c=Math.pow(2,30),f=Math.pow(2,60);var h=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(17529,"First"),mstrmojo.desc(17530,"Last"),mstrmojo.desc(7194,"Constant")];function n(AL,AK){var AM,AJ=AL.length;if(AJ!==AK.length){return false;}for(AM=0;AM<AJ;AM++){if(AL[AM]!==AK[AM]){return false;}}return true;}function AE(AM,AK,AN){var AL=false,AO=AN+A,AJ=AM[AO],AP=AK[AO];if(AK[AN]===undefined){AL=true;}else{if((AP===undefined&&AJ!==undefined)||(AP!==undefined&&AJ!==undefined&&AP<AJ)){AL=true;}}if(AL){AK[AN]=AM[AN];if(AP!==undefined){AK[AO]=AJ;}}}function AI(AK,AJ){var AL;for(AL in AK){if(AK.hasOwnProperty(AL)){AE(AK,AJ,AL);}}return AJ;}function Z(AN){var AM={},AL,AK=[],AJ;q.forEach(AN,function(AO){if(AO!==undefined){AK.push(AO);}});AJ=AK.length;if(AJ===1){return AK[0];}for(AL=0;AL<AJ;AL++){AI(AK[AL],AM);}return AM;}function AC(AJ){return{n:AJ,s:AJ.toString(),on:AJ};}function a(AL,AJ,AN){if(AJ===AL){return 0;}var AK=AJ-AL,AM=1;while(AK<1){AK*=10;AM/=10;}while(AK>=10){AK/=10;AM*=10;}if(AK<1.8){AM*=0.2;}else{if(AK<3.1){AM*=0.4;}else{if(AK<4.6){AM*=0.5;}else{if(AK>=8.1){AM*=2;}}}}if(AN){AM=Math.round(AM);if(AM<1){AM=1;}}return AM;}function C(AM,AQ,AS,AK){var AO=[];if(AM===AQ){if(AM<0){AO.push(mstrmojo.gm.GMUtility.formatNumber(AM,"nearest"));}AO.push({n:0,s:"0",on:0});if(AM>0){AO.push(mstrmojo.gm.GMUtility.formatNumber(AM,"nearest"));}return AO;}var AJ=AK>0?AK:a(AM,AQ,AS);var AL=Math.ceil(AQ/AJ)*AJ;if(AL-AQ>=AJ*0.9){AL=Math.floor(AQ/AJ)*AJ;}var AP=Math.floor(AM/AJ)*AJ;if(AM-AP>=AJ*0.9){AP=Math.ceil(AM/AJ)*AJ;}var AR=Math.floor((AL-AP+AJ/100)/AJ)+1,AN;for(AN=0;AN<AR;++AN){AO.push(mstrmojo.gm.GMUtility.formatNumber(AP+AN*AJ,"nearest"));}return AO;}function U(AJ,AM){var AL;AJ.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AJ.mStep=this.mMinimum<0?0.2:0.1;if(AM.mUseCustomMinMax){var AK=AM;AJ.mMaxTick=AK.mAxisMaxValue;AJ.mMinTick=AK.mAxisMinValue;AJ.mMaxTick=Math.min(1,AJ.mMaxTick);AJ.mMinTick=Math.max(-1,AJ.mMinTick);AJ.mStep=0.1;}else{if(this.mMaximum>=0.5){AJ.mMaxTick=1;AJ.mMinTick=Math.floor(this.mMinimum/AJ.mStep)*AJ.mStep;AJ.mMinTick=(AJ.mMinTick*this.mMinimum<0)?0:(AJ.mMinTick>0?0:AJ.mMinTick);if(this.mMinimum<-0.5){AJ.mMinTick=-1;}}else{if(this.mMaximum>0){AJ.mMaxTick=Math.ceil(this.mMaximum/AJ.mStep)*AJ.mStep;AJ.mMinTick=-1;}else{AJ.mStep=0.1;AJ.mMaxTick=0;AJ.mMinTick=-1;}}}}else{AJ.mMinTick=(this.mMinimum<0)?-1:0;if(x.call(this,AJ)){return ;}AJ.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AJ.mMaxTick-AJ.mMinTick)/10;}for(AL=AJ.mMinTick+AJ.mStep;AL+d.gModuleMain.mTolerance<AJ.mMaxTick;AL+=AJ.mStep){AJ.mTicks.push(Math.round(AL*100)/100);}}function P(AJ,AO){var AN,AK,AQ=AO,AP=AQ.mDrawCustomLine,AL=AQ.mAxisCustomValue,AM;AJ.mStep=1;if(this.mMaximum<=0){AJ.mMinTick=1;AJ.mMaxTick=10;if(AP&&AL<=1){AQ.mAxisCustomValue=AJ.mMinTick;}return ;}if(this.mMinimum<=0){AK=this.mMaximum>1?0:-1;AJ.mMinTick=Math.pow(10,AK);if(AQ.mUseCustomMinMax){AJ.mMaxTick=this.mMaximum;AN=Math.floor(j.call(this,this.mMaximum));if(j.call(this,this.mMaximum)===AN){AN--;}}else{AN=Math.ceil(j.call(this,this.mMaximum));AJ.mMaxTick=Math.pow(10,AN);}for(AM=AK+1;AM<AN;++AM){AJ.mTicks.push(Math.pow(10,Math.floor(AM)));}if(AP&&AL<=0){AQ.mAxisCustomValue=Math.max(AJ.mMinTick,AQ.mAxisCustomValue);}return ;}if(AQ.mUseCustomMinMax){AN=j.call(this,this.mMaximum);AK=j.call(this,this.mMinimum);AJ.mMaxTick=this.mMaximum;AJ.mMinTick=this.mMinimum;}else{AN=Math.ceil(j.call(this,this.mMaximum));AK=Math.floor(j.call(this,this.mMinimum));AJ.mMaxTick=Math.pow(10,AN);AJ.mMinTick=Math.pow(10,AK);}for(AM=AK+1;AM<AN;++AM){AJ.mTicks.push(Math.pow(10,Math.floor(AM)));}if(AP&&AL<=0){AQ.mAxisCustomValue=AJ.mMinTick;}}function u(AT,AO){var AL=AO,AJ,AM;AT.mStep=g.call(this,this.mMaximum,this.mMinimum,AL.mAlwaysIncludeZero);AT.mMaxTick=Math.ceil(this.mMaximum/AT.mStep)*AT.mStep;AT.mMinTick=Math.floor(this.mMinimum/AT.mStep)*AT.mStep;AT.mMaxTick=AT.mMaxTick<this.mMaximum?this.mMaximum:AT.mMaxTick;AT.mMinTick=AT.mMinTick>this.mMinimum?this.mMinimum:AT.mMinTick;AT.mMinTick=(AT.mMinTick*this.mMinimum<0)?0:AT.mMinTick;if(AL.mAlwaysIncludeZero){AT.mMaxTick=(this.mMaximum<0)?0:AT.mMaxTick;AT.mMinTick=(this.mMinimum>0)?0:AT.mMinTick;}var AN=AT.mMaxTick-AT.mMinTick;if(AT.mStep>=AN){return ;}if(x.call(this,AT)){return ;}AJ=Math.floor((AT.mMaxTick-AT.mMinTick+AT.mStep/100)/AT.mStep)+1;var AP=this.mNumberFormat;for(AM=1;AM<AJ-1;++AM){var AR=AT.mMinTick+AM*AT.mStep,AS,AK,AQ;if(AT.mStep<1&&AP.mFormatType===4&&AP.mCustomFormat.indexOf("%")!==-1){AS=AR*100;if(!K.isIntegar(AS)){AK=Math.round(AS);AQ=Math.abs(AS-AK);if(AQ<S){AR=AK/100;}}}AT.mTicks.push(AR);}}function D(AT,AN){var AS=AN,AM,AJ,AQ,AL,AP,AO,AK,AR;AT.mMaxTick=AS.mAxisMaxValue;AT.mMinTick=AS.mAxisMinValue;if(x.call(this,AT)){return ;}if(!Y.call(this)||this.mMajorGrid.mUseManualGrid){AT.mStep=g.call(this,AT.mMaxTick,AT.mMinTick,false);AM=AT.mMaxTick-AT.mMinTick;if(AT.mStep>=AM){return ;}AJ=Math.floor(AM/AT.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AM===AJ*AT.mStep){for(AL=1;AL<AJ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}else{AM=AT.mMaxTick-AT.mMinTick;AQ=10;AP=false;for(AL=3;AL<AJ;++AL){AO=AM/AL;while(AO<1){AO*=10;}while(AO>=10){AO/=10;}if(AO===Math.floor(AO)){AQ=AL;AP=true;break;}}if(AP){AT.mStep=AM/AQ;for(AL=1;AL<AQ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}else{AK=Math.ceil((AT.mMinTick+AT.mStep/100)/AT.mStep)*AT.mStep;AR=Math.floor((AT.mMaxTick-AT.mStep/100-AK)/AT.mStep)+3;for(AL=0;AL<AR-2;++AL){AT.mTicks.push(AK+AL*AT.mStep);}}}}else{AM=AT.mMaxTick-AT.mMinTick;AQ=10;for(AL=6;AL<=9;++AL){AO=AM/AL;while(AO<10){AO*=10;}while(AO>=100){AO/=10;}if(AO===Math.floor(AO)){AQ=AL;break;}}AT.mStep=AM/AQ;for(AL=1;AL<AQ;++AL){AT.mTicks.push(AT.mMinTick+AL*AT.mStep);}}}function F(AJ,AN){var AM,AK,AL;AJ.mMaxTick=AN.mAxisMaxValue;if(AJ.mMaxTick<=this.mMinimum){this.mMinimum=AJ.mMaxTick-1;}AJ.mStep=g.call(this,AJ.mMaxTick,this.mMinimum,AN.mAlwaysIncludeZero&&(AJ.mMaxTick>0));AM=(AN.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(Y.call(this)){AJ.mMinTick=AJ.mMaxTick-Math.ceil((AJ.mMaxTick-AM)/AJ.mStep)*AJ.mStep;}else{AJ.mMinTick=Math.floor(AM/AJ.mStep)*AJ.mStep;}if(x.call(this,AJ)){return ;}AK=Math.floor((AJ.mMaxTick-AJ.mStep/100-AJ.mMinTick)/AJ.mStep)+2;for(AL=1;AL<AK-1;++AL){AJ.mTicks.push(AJ.mMinTick+AL*AJ.mStep);}}function k(AJ,AO){var AK,AN,AL,AM;AJ.mMinTick=AO.mAxisMinValue;if(AJ.mMinTick>=this.mMaximum){this.mMaximum=AJ.mMinTick+1;}AJ.mStep=g.call(this,this.mMaximum,AJ.mMinTick,AO.mAlwaysIncludeZero&&(AJ.mMinTick<0));AK=(AO.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(Y.call(this)){AJ.mMaxTick=AJ.mMinTick+Math.ceil((AK-AJ.mMinTick)/AJ.mStep)*AJ.mStep;}else{AJ.mMaxTick=Math.ceil(AK/AJ.mStep)*AJ.mStep;}if(x.call(this,AJ)){return ;}AN=Math.ceil((AJ.mMinTick+AJ.mStep/100)/AJ.mStep)*AJ.mStep;AL=Math.floor((AJ.mMaxTick-AN+AJ.mStep/100)/AJ.mStep)+2;for(AM=0;AM<AL-2;++AM){AJ.mTicks.push(AN+AM*AJ.mStep);}}function g(AZ,AT,AL){var AS,AN;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AS=0;if(AL){AS=Math.max(AZ,AZ-AT);AS=Math.max(AS,-AT);}else{AS=AZ-AT;}if(AS===0){this.mIsShown=false;return 1;}if(AS>1&&AS<=4&&parseInt(AS)===AS){var Aa=this.PrimaryMetricIndex,AO=Aa.length;for(var AV=0;AV<AO;AV++){var AR=this.mChartContextPtr.mDatasetPtr,AU=AR.dataProvider,AM=AU.getSeriesCount(),AQ=AU.getGroupCount(),AK=Aa[AV],AP,AX;for(var AY=0;AY<AM;AY++){AP=AU.getMetricIndexForSeries(AY);if(AP===AK){AX=true;for(var AW=0;AW<AQ;AW++){var Ab=AR.GetData(AY,AW);if(parseInt(Ab)!==Ab){AX=false;break;}}}if(AX){return 1;}}}}var AJ=AS;AN=1;while(AS<1){AS*=10;AN/=10;}while(AS>=10){AS/=10;AN*=10;}if(AS<1.8){AN*=2;AN/=10;}else{if(AS<3.1){AN*=4;AN/=10;}else{if(AS<4.6){AN*=5;AN/=10;}else{if(AS>=8.1){AN*=2;}}}}AN=this.postProcessStep(AN,AJ);return AN;}function x(AJ){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AK=this.mMajorGrid;return AK.mUseManualGrid&&(AK.mGridInterval<(AJ.mMaxTick-AJ.mMinTick)/30);}function j(AJ){return Math.log(AJ)/Math.log(10);}function Y(){return(this.mGraphMajorType===e.GMT_HISTOGRAM||this.mGraphMajorType===e.GMT_POLAR)&&this.mTripleId.mObjectId===z.DssGraphX1Body;}function AB(AM){var AN=this,AJ=AN.id,AL=AM.metricId,AK=new p.ui.menus.MenuConfig();(AM.options).forEach(function(AO){if(AO!==AA.EnumRefLineModelType.CONST){AK.addMenuItem(h[AO],"xt",function(){AN.toggleRefLineEnabled(AL,AO,true);});}else{AK.addEditorMenuItem(h[AA.EnumRefLineModelType.CONST],AJ,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,required:true,valueChangeDelay:1000,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();},onvalueChange:function(){this.validate();},onValid:function(){this.parent.data.set("constantValid",true);},onInvalid:function(){this.parent.data.set("constantValid",false);}}],bindings:{okEnabled:"this.data.constantValid"},fnOk:function(AQ,AP){var AR=AP.constVal;if(AR.isValid()){AN.toggleRefLineEnabled(AL,AO,true,AR.value);}}});});}});return AK;}function w(AL){var AM=this,AK=AL.metricId,AJ=new p.ui.menus.MenuConfig();(AL.options).forEach(function(AP){var AN=AP.refType,AO=h[AN]+((AN===AA.EnumRefLineModelType.CONST)?("-["+I.toLocaleString(AP.c)+"]"):"");AJ.addMenuItem(AO,"xt",function(){AM.toggleRefLineEnabled(AK,AN,false,0,AP.modix);});});return AJ;}function AG(AN,AJ){var AM=AN.GMController,AK=AM.getForbiddenShapeForMetric(AJ),AL=[];[{text:mstrmojo.desc(12097,"Bar"),value:AF.BAR},{text:mstrmojo.desc(2059,"Line"),value:AF.LINE},{text:mstrmojo.desc(9738,"Area"),value:AF.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AF.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AF.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AF.TICK}].forEach(function(AO){if(AK.indexOf(AO.value)<0){AL.push(AO);}});if(AM.chartType===mstrmojo.gm.EnumGraphType.BAR||AM.chartType===mstrmojo.gm.EnumGraphType.LINE){AL=AL.filter(function(AO){return AO.value!==AF.AREA;});}return AL;}function s(AK,AJ){return function(AM,AL){if(AM!==AL){AJ({ctxt:{sp:AM,mid:AK}});}};}function AH(AM){var AK=AM.options,AJ=this.getMenuHandler("changeShape"),AL=new mstrmojo.ui.menus.MenuConfig();AL.addRadioMenuGroup(AM.currValue,s(AM.metricId,AJ),AK,"checkMark",undefined,true);return AL;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,timerHistory:[],timerHistoryMax:50,startTimer:function R(AK){if(this.mUseTimer){var AJ=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AJ,desc:AK.functionName+": "+AK.purpose});return AJ;}},endTimer:function G(AN,AP){if(this.mUseTimer){var AK,AL=this.mTimers,AQ=0;if(AN===undefined){AK=AL.pop();}else{var AO,AR;for(AO=0;AO<AL.length;AO++){AR=AL[AO];if(AR.timerId===AN){AK=AR;AL.splice(AO,1);AO--;}}}if(AK){var AJ=new Date();var AM=(AJ-AK.timeStamp);if(AP){this.timerHistory[this.timerId%this.timerHistoryMax]={desc:AK.desc,duration:AM,start:AK.timeStamp.getTime(),end:AJ.getTime()};}H.visPrint("%c"+AK.desc+": "+AM+"ms","color: blue");AQ=new Date()-AK.timeStamp;}return AQ;}},computeTicksForPercentchart:function(AK,AJ,AL){return C(AK,AJ,false,AL);},computeTicksForFlexMinMax:function(AK,AJ,AL,AM){return C(AK,AJ,AL,AM);},formatNumber:function(AL,AK,AJ){return AC(AL,AK,AJ===undefined?3:AJ);},sizeCalculator:{sum:function(AJ,AN,AO){var AL,AK=0,AM=0;if(AO===undefined){AO=AJ.length;}AN=AN||1;for(AL=0;AL<AO;AL++){if(AJ[AL]>0){AM+=AJ[AL];AK+=1;}}if(AK>1){AM+=(AK-1)*AN;}return AM;},add:function(AL,AJ,AK){AK=AK||1;if(AJ>0){AL+=(AJ+AK);}return AL;},minus:function(AL,AJ,AK){if(AJ>0){AL-=(AJ+AK);}return AL;}},replaceSpecialChars:function(AJ){return AJ.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");},restoreSpecialChars:function(AJ){if(typeof AJ!=="string"){return AJ;}return AJ.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&amp;/g,"&");},removeExtraSpace:function(AJ){return AJ.replace(/ {2,}/g," ");},stringToJSON:function(AJ){if(AJ===undefined){return undefined;}if(typeof AJ==="string"){AJ=AJ.replace(/'/g,'"');try{return JSON.parse(AJ);}catch(AK){return AJ;}}return AJ;},everythingToString:function(AK){if(AK===undefined){return undefined;}var AJ;if(typeof AK==="object"){AJ=JSON.stringify(AK.jsonObj||AK);}else{AJ=AK.toString();}AJ=AJ.replace(/"/g,"'");return AJ;},compareElementObj:function(AN,AK){var AM=AN.tid.toString(),AJ=AK.tid.toString(),AO=AN.eid,AL=AK.eid;if(AM!==AJ){return AM>AJ?1:-1;}if(AO===AL){return 0;}return AO>AL?1:-1;},isEqualComb:function(AK,AJ){var AO=true,AN,AM=AK.length,AL=AJ.length;if(AM!==AL){return false;}if(AK.length>1){AK.sort(this.compareElementObj);}if(AJ.length>1){AJ.sort(this.compareElementObj);}for(AN=0;AN<AM;AN++){if(this.compareElementObj(AK[AN],AJ[AN])!==0){AO=false;break;}}return AO;},serializeCombination:function(AK){var AJ="";if(AK.length>1){AK.sort(this.compareElementObj);}q.forEach(AK,function(AL){if(AJ!==""){AJ+=y;}AJ+=(AL.tid+l+AL.eid);});return AJ;},deserializeCombination:function(AK){var AL=AK.split(y),AJ=[];q.forEach(AL,function(AP){var AM=AP.split(l);var AO=AM[0];var AN=AM[1];AJ.push({tid:AO,eid:AN});});return AJ;},getElementCombinationForMetric:function(AJ){var AK=[];AK.push({tid:-1,eid:AJ});return AK;},getResolvedFormatsObject:function(AJ){return Z(AJ);},isDigitalArrayEqual:function(AK,AJ){return n.call(this,AK,AJ);},indexOf:function(AK,AM){var AL,AJ=AK.length;for(AL=0;AL<AJ;AL++){if(n(AK[AL],AM)){return AL;}}return -1;},parseAxisScaleData:function(AN){var AL,AO,AK,AJ=AN.split(","),AM=[];for(AL=0,AO=AJ.length;AL<AO;AL++){AK=AJ[AL].split(":");AM.push(AK);}return AM;},parseCSSColor:function(AN,AK){var AM=AN.slice(1),AJ=[],AL;if(AM.length===6){if(AK===true){AJ[0]=AM[4];AJ[1]=AM[5];AJ[2]=AM[2];AJ[3]=AM[3];AJ[4]=AM[0];AJ[5]=AM[1];}else{for(AL=0;AL<6;AL++){AJ[AL]=AM[AL];}}}else{if(AK===true){for(AL=2;AL>=0;AL--){AJ.push(AM[AL]);AJ.push(AM[AL]);}}else{for(AL=0;AL<3;AL++){AJ.push(AM[AL]);AJ.push(AM[AL]);}}}return parseInt("0x"+AJ.join(""),16);},RGB_BRG_Switch:function(AK){var AM=(AK>>16)&255,AL=(AK>>8)&255,AJ=(AK>>0)&255;return(AJ<<16)|(AL<<8)|(AM<<0);},encodeColor:function(AK){if(AK===undefined||AK===null||AK==="transparent"||AK==="default"){return AK;}var AL=false,AJ={};if(AL){if(typeof AK==="object"){AJ.c1=this.RGB_BRG_Switch(i.encodeColor(AK.c1));AJ.c2=this.RGB_BRG_Switch(i.encodeColor(AK.c2));AJ.or=AK.or;return AJ;}return this.RGB_BRG_Switch(i.encodeColor(AK));}if(typeof AK==="object"){AJ.c1=i.encodeColor(AK.c1);AJ.c2=i.encodeColor(AK.c2);AJ.or=AK.or;return AJ;}return i.encodeColor(AK);},checkEquality:function(AK,AJ){if(typeof AK==="object"&&AK.c1!==undefined&&AJ!=undefined){if(AK.c1!==AJ.c1){return false;}if(AK.c2!==AJ.c2){return false;}if(AK.or!==AJ.or){return false;}return true;}return AK===AJ;},ptToPx:function(AJ){return AJ&&Math.ceil(parseInt(AJ,10)/72*96);},decodeColor:function(AK){if(AK===undefined||AK===null||AK==="transparent"||AK==="default"){return AK;}var AL=false,AJ={};if(AL){if(typeof AK==="object"){AJ.c1=i.decodeColor(this.RGB_BRG_Switch(AK.c1));AJ.c2=i.decodeColor(this.RGB_BRG_Switch(AK.c2));AJ.or=AK.or;return AJ;}return i.decodeColor(this.RGB_BRG_Switch(AK));}if(typeof AK==="object"){AJ.c1=i.decodeColor(AK.c1);AJ.c2=i.decodeColor(AK.c2);AJ.or=AK.or;return AJ;}return i.decodeColor(AK);},getTrendLineToggleHandler:function(AJ,AL,AK){return function(){AJ.switchOnOffTrendLineForMetric(AL,AK);};},getTrendLineToggleState:function(AJ,AK){return AJ.queryTrendLineStatusForMetric(AK);},getEditTrendLineHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.TREND_LINE,AK);};},getEditRefLineHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.REF_LINE,AK);};},getEditAxisScaleHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.AXIS_SCALE,AK);};},getEditAxisOriginHandler:function(AJ,AK){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.AXIS_ORIGIN_DEFINE,AK);};},getEditLogScaleHandler:function(AJ,AK,AL){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AJ.raiseEventCMSelection(J.LOG_SCALE,AK);AJ.edtModel.broker.setFormatPropertyValue("AxisScale:logScale",AL);};},getEditSyncAxisScaleHandler:function(AJ,AK){return function(){var AL=Q.walk("rootCtrl.docCtrl",mstrApp);if(AL&&AL.selectViPanel){AL.selectViPanel("propertiesPanel");}AJ.raiseEventCMSelection(J.SYNC_AXIS_SCALE,"AllMetrics");AJ.toggleSyncAxisScale(AK);};},getOptionObjArr:function(AJ,AL,AN){if(!E){E=mstrmojo.gm.GMUtility;}var AK={},AM;if(AL!==undefined){AL=AL.toLowerCase();if(AL==="x1"){AL="x";}else{if(AL==="y1"){AL="y";}}}if(AJ.length>1||(AN&&AJ.length===1)){if(AL==="x"){AK.opt=mstrmojo.desc(11712,"Bottom Axis");AK.key="XAxis";}else{if(AL==="x2"){AK.opt=mstrmojo.desc(11710,"Top Axis");AK.key="X2Axis";}else{if(AL==="y"){AK.opt=mstrmojo.desc(11715,"Left Axis");AK.key="YAxis";}else{if(AL==="y2"){AK.opt=mstrmojo.desc(11713,"Right Axis");AK.key="Y2Axis";}else{if(AL==="z"){AK.opt=mstrmojo.desc(12090,"SizeBy");AK.key="SizeBy";}}}}}AK.optLvl=m.AXIS;AK.mos=this.getMetricFormatFromIndexArray(AJ);}else{if(AJ.length===1){AM=this.getMetricFormat(AJ[0]);AK.opt=AM.n;AK.mos=[AM];AK.key=AM.mId;AK.comb=E.getElementCombinationForMetric(AM.mId);AK.optLvl=m.METRIC;if(AL==="z"){AK.sizeBy=true;}}}return AK;},filterInValidMetricIndex:function(AK){var AJ=[];q.forEach(AK,function(AL){if(AL!==b){AJ.push(AL);}});return AJ;},fillBackgroundDiv:function(AK){var AJ=document.createElement("div");AJ.setAttribute("class","gm-bk-div");AJ.style.backgroundColor="rgba(0,0,0,0)";AK.appendChild(AJ);},getSubMenu:function(AO,AP,AN,AM){var AL=AG(AO,AM),AJ=AO.getMenuHandler("changeShape"),AK=AO.GMController.getOnTheFlyShapeForMetric(AM);if(AL.length>1){AP.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AO.id,AH,{currValue:AK,options:AL,metricId:AN});}else{AP.addRadioMenuGroup(AK,s(AN,AJ),AL,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AK,AO,AP,AJ){var AQ=mstrmojo.gm.EnumSubtype,AN=AK.GMController.chartSubType;if(AP&&AN===AQ.PERCENT){return ;}var AR=AK.id,AL=AK.getAvailableRefLineTypes(AJ)||[];if(AL.length>0){AO.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AR,AB,{metricId:AJ,options:AL});}var AM=AK.getExistingRefLineOptions(AJ)||[];if(AM.length>0){AO.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",E.getEditRefLineHandler(AK,AJ));AO.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AR,w,{metricId:AJ,options:AM});}},reverseMapping:function o(AK){var AM={},AL,AJ=AK.length;for(AL=0;AL<AJ;AL++){AM[AK[AL]]=AL;}return AM;},longIntAnd:function(AK,AJ){var AL;if(AK===AJ){return AK;}if(AK>f||AJ>f){throw new Error("Operand exceeds valid data range.");}if(AK<c&&AJ<c){return AK&AJ;}if(AK>=c||AJ>=c){if(AK<AJ){AL=AK;AK=AJ;AJ=AL;}}var AN=Math.floor(AK/c),AM=Math.floor(AJ/c),AP=AK-AN*c,AO=AJ-AM*c;return(AP&AO)+(AN&AM)*c;},longIntOr:function(AK,AJ){var AL;if(AK===AJ){return AK;}if(AK<c&&AJ<c){return AK|AJ;}if(AK<AJ){AL=AK;AK=AJ;AJ=AL;}AL=this.longIntAnd(AK,AJ);return AJ-AL+AK;},parseNumeric:function(AJ){return +AJ||parseFloat(AJ);},fillImageInDiv:function(AN,AL,AK,AJ){AJ=AJ||"gm-img";AN.innerType=AL;if(AL===4){var AM=document.createElement("img");AM.className=AJ;AM.src=AK;AN.appendChild(AM);}else{if(AL===7){AN.innerHTML=AK;B.addClass(AN.firstChild,AJ);}}},fillTextInDiv:function(AJ,AS,AU,AK,AV,AL,AX,AN,AQ){if(AK===undefined){AK=AJ.offsetWidth;}if(AV===undefined){AV=AJ.offsetHeight;}if(AN===undefined){AN=X.MIDDLE;}if(AQ===undefined){AQ=t.MIDDLE;}if(AL===undefined){AL=false;}var AR,AT,AP,AW=AL?"gm-text-body":"gm-text-body-nowrap",AM=false,AO;AR=H.measureTextWidth(AU,AX,6);AO=H.measureTextWidth("...",AX,6);if(AR>AK&&AO>AK){return ;}AP=document.createElement("div");AP.setAttribute("class",AW);AP.setAttribute("type",AD.GM_TEXT_BODY);AP.identity=AS;H.applyStyles2DomNode(AP,AX);AP.textContent=AU;AJ.appendChild(AP);if(AL){if(AR>AK){AT=AP.offsetHeight;}else{AT=H.measureTextHeight(AU,AX,4);}}else{AT=H.measureTextHeight(AU,AX,4);AM=AR>AK;}AR=Math.min(AR,AK);AP.style.width=AR+"px";if(AL){AM=AP.scrollWidth>AR||AP.scrollHeight>AT;}if(AM){AP.setAttribute("title",AU);}else{AP.setAttribute("title","");}switch(AN){case X.LEFT:AP.style.left="0px";AP.style.textAlign="left";break;case X.MIDDLE:AP.style.left=((AK-AR)>>1)+"px";break;case X.RIGHT:AP.style.right="0px";AP.style.textAlign="right";break;}switch(AQ){case t.TOP:AP.style.top="0px";break;case t.MIDDLE:AP.style.top=((AV-AT)>>1)+"px";break;case t.BOTTOM:AP.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AJ,AL,AM){var AN=AJ.firstChild,AO=AN.style,AK=AJ.clientWidth,AP=AN.clientWidth,AR=AJ.clientHeight,AQ=AN.clientHeight;AO.left="auto";AO.right="auto";switch(AL){case X.LEFT:AO.left="0px";break;case X.MIDDLE:AO.left=((AK-AP)>>1)+"px";break;case X.RIGHT:AO.right="0px";break;}AO.top="auto";AO.bottom="auto";switch(AM){case t.TOP:AO.top="0px";break;case t.MIDDLE:AO.top=((AR-AQ)>>1)+"px";break;case t.BOTTOM:AO.bottom="0px";break;}},toggleDisplay:function(AK,AJ){if(!AK){return ;}if(AJ){AK.style.display="block";}else{AK.style.display="none";}},isTrendLineAvailableForMetric:function(AN,AO,AR){var AY=AN&&AN.excludeData,AV=mstrmojo.gm.EnumSubtype,AQ=p.gm.EnumShape,AW=AN.GMController,AS=AW.chartSubType,AX=AN.model.data.dz,AL=AX.XAxis,AJ=AX.YAxis,AM=AX.BreakBy,AP=AX.SliceBy,AT=AR,AK=AW.getChartInfo(),AU=AW.getBreakByAttrsID().length>0||(AK.isABL&&((AL.MetricNames!==undefined)||(AJ.MetricNames!==undefined)||(AM.MetricNames!==undefined)||(AP.MetricNames!==undefined)));if(AT===undefined){AT=AW.getOnTheFlyShapeForMetric(AO);}if(AK.isABL&&AS===AV.PERCENT){AY=true;}if(AU&&!AK.isBubbleOrScatter&&(AT===AQ.BAR||AS===AV.STACKED||(AS===AV.AUTO&&AT===AQ.AREA))){AY=true;}if(AK.isABL){if(AL.TemplateUnit&&AL.TemplateUnit.length>1){AY=true;}if(AJ.TemplateUnit&&AJ.TemplateUnit.length>1){AY=true;}if(AL.TemplateUnit===undefined&&AJ.TemplateUnit===undefined){AY=true;}}AY=AY||this.isIgnoredMetric(AN,AO);return !AY;},isTrendLineAvailableForAnyMetric:function(AL){var AK=AL.model.data.gsi.mx,AJ;for(AJ in AK){if(this.isTrendLineAvailableForMetric(AL,AJ)){return true;}}return false;},isIgnoredMetric:function(AM,AK){var AL=AM.GMController,AN,AJ;if(AL.bubbleSeriesNum!==undefined){AN=AL.getMetricsOnYAxis();AJ=AN.indexOf(AK);if(AJ>=AL.bubbleSeriesNum){return true;}AN=AL.getMetricsOnXAxis();AJ=AN.indexOf(AK);if(AJ>=AL.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AO){var AJ=AO.model.data.dz,AP=AO.model.data.gsi.mx,AK,AL,AN=[];if(!AJ||!AJ.ColorBy||!AP){return AP;}var AM=function(AQ){return(AQ&&AQ.TemplateMetric)||[];};AK=AM(AJ.YAxis).concat(AM(AJ.XAxis));q.forEach(AP,function(AQ){AL=false;q.forEach(AK,function(AR){if(AQ.did===AR.id){AL=true;return false;}});if(AL){AN.push(AQ);}});return AN;},isInvalidTemplate:function O(AM){if(AM.eg){return false;}var AK=AM.gts;var AJ=AK.row.length===0&&AK.col.length===0;q.forEach(AK.row,function(AP){if(AP.otp===-1){AJ=true;}});var AO=AK.col;if(AO.length>0){var AL,AN=AO.length-1;for(AL=0;AL<AN;AL++){if(AO[AL].otp===-1){AJ=true;}}}return AJ;},isNoData:function(AJ){return AJ.eg!==undefined;},getInvalidTemplateErrMsg:function(AJ){return AJ||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AK,AL){mstrmojo.func.override({showPickerForCurrentMode:function AJ(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AM=this.gradientOrientation,AN=AL.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AM.set("selectedIndex",q.find(AM.items,"id",AN?0:1));}}},AK.colorPicker);},generateToolTipContent:function(AS,AN,AJ,AO,AQ,AP,AV){var AM,AK,AL,AR,AT,AU;for(AM=AS;AM<AN;AM++){AK=AO[AM];AR=AQ[AM];if(AM>AS){AL=AO[AM-1];AT=AQ[AM-1];if(AK.id===AL.id){if(AR===""){continue;}if(AK.fid===AL.fid&&AR.idx===AT.idx){continue;}if(AK.n===""){AP[AP.length-1].v+=M+AR.n;continue;}}}if(AV){AP.push({n:AK.n,tid:AK.id,v:AR.n,bftp:AR.bftp});}else{AU=AJ===undefined?AK.isRowAttribute:AJ;AP.push({n:AK.n,tid:AK.id,v:AR.n,eid:AR.id,tp:AK.otp,axis:AU?1:2,tui:AK.tui,ui:AK.tui,dpt:AK.tui+1,at:AR.at,isRowAttribute:AU,dei:AR.dei,o:AR.o,bftp:AR.bftp});}}},getAttributeFormCnt:function(AJ){var AK;if((AJ.fcnt===undefined||AJ.fcnt===null)&&AJ.fs){AJ.fcnt=AJ.fs.length||1;}if(AJ.fcnt!==undefined&&AJ.fcnt!==null){AK=AJ.fcnt;}else{if(AJ.t===47){AK=1;}else{AK=AJ.cs!==undefined?AJ.cs:AJ.rs;}}return AK;},isTrueForBoolValue:function(AJ){return AJ===true||AJ==="true";},computeTicksForAxis:function(AM,AK){var AL=AM.mOptions,AN,AJ={mTicks:[]};if(AK){AN=Q.copy(AL);Q.copy(AK,AN);}else{AN=AL;}if(AM.mIsPercent){U.call(AM,AJ,AN);return AJ;}if(AN.mUseLogarithmicScale){P.call(AM,AJ,AN);return AJ;}if(AM.mGraphMajorType===e.GMT_BUBBLE&&AM.mTripleId.mObjectId===z.DssGraphZBody){AJ.mMinTick=AN.mUseMinValue?AN.mAxisMinValue:AM.mMinimum;AJ.mMaxTick=AN.mUseMaxValue?AN.mAxisMaxValue:AM.mMaximum;if(AM.mMinTick>=AM.mMaxTick){AJ.mMaxTick=AJ.mMinTick+1;}return AJ;}if(!AN.mUseMaxValue&&!AN.mUseMinValue){u.call(AM,AJ,AN);}else{if(AN.mUseMaxValue&&AN.mUseMinValue){D.call(AM,AJ,AN);}else{if(AN.mUseMaxValue){F.call(AM,AJ,AN);}else{k.call(AM,AJ,AN);}}}return AJ;},computeTicksForLogScale:function(AL){var AK=AL.mOptions,AJ={mTicks:[]};P.call(AL,AJ,AK);return AJ;},destroyDisposable:function(AJ,AK){if(AK){q.removeItem(AJ.disposables,AK);AK.destroy();}},handleDestroy:function(AN,AM,AK){if(!AN){return ;}var AO,AL=0,AJ=AN.disposables,AP=(AJ&&AJ.length)||0;while(AL<AP){AO=AJ[AL];if((!AO.scriptClass||AM.indexOf(AO.scriptClass)<0)&&q.indexOf(AK,AO.id)===-1){this.destroyDisposable(AN,AO);}if(AJ.length<AP){AP=AJ.length;}else{AL++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.gmaps.MapEnums","mstrmojo.gm.GMEnums","mstrmojo.VisEnum","mstrmojo.gmaps.MapUtils");var n=mstrmojo,o=n.array,q=n.vi.viz.EnumDSSDropZones,X=n.hash,R=n.gmaps,y=mstrmojo.VisEnum,AF=y.LegendPropertyTag,u=y.MAPS_PROPERTIES,M=R.EnumPropertyType,g=R.EnumZoomBehavior,t=R.EnumGraphicType,f=R.EnumClusterMode,x=R.EnumGeographicRole,H=R.EnumBaseMapType,d=R.EnumLanguageType,F=R.EnumDefaultShapeFormatStyle,w=R.MapboxKeyStyles,O=y.EnumLegendMode,G=mstrmojo.gm.EnumLegendSlot,AB=y.EnumSingleLegendMode,j=new RegExp(".{32}","g"),AD,K=R.CustomShapeId,E=mstrmojo.gmaps.MapUtils;var C={ga:"geoAttribute",lat:"latitude",lng:"longitude",slc:"sliceBy",amt:"angle",cmt:"colorBy",smt:"sizeBy",gmt:"geometry",tooltip:"tooltips",pmbo:1,ttpmf:1};var s="@pLd",e=new RegExp(s,"g");mstrmojo.vi.viz.MapHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.MapHelper",widget:null,data:null,vp:null,geoAttribute:null,latitude:null,longitude:null,geometry:null,slice:[],angle:null,colorBy:null,sizeBy:null,tooltip:null,markerType:null,useAttributeForm:null,defaultView:null,init:function AC(AI){this._super(AI);this.tooltip=[];this.data=this.data||{};this.vp=this.data.vp||{};},setWidget:function U(AI){if(!AI){return ;}var AL=AI.fnGetWidget(),AK=AI.k,AJ=AI.node&&AI.node.data&&AI.node.data.vp;this.widget=AI;this.geoAttribute=P(AI,q.GeoAttribute);this.latitude=P(AI,q.Latitude);this.longitude=P(AI,q.Longitude);this.geometry=P(AI,q.Geometry);this.angle=P(AI,q.Angle);this.colorBy=P(AI,q.ColorBy);this.sizeBy=P(AI,q.SizeBy);this.tooltip=AL.getDropZoneItems(q.AdditionalMetrics,AK).map(function(AM){return AM.id;});this.slice=AL.getDropZoneItems(q.SliceBy,AK).map(function(AM){return AM.id;});if(AJ){this.markerType=AJ.mtp;this.useAttributeForm=AJ[M.useAttributeForm];this.defaultView=AJ.dv;}},getGeoUnit:function J(){return z(this.widget,q.GeoAttribute);},getLatitudeUnit:function L(){return z(this.widget,q.Latitude);},getLongitudeUnit:function l(){return z(this.widget,q.Longitude);},getGeometryUnit:function Z(){return z(this.widget,q.Geometry);},getAngleUnit:function A(){return z(this.widget,q.Angle);},getColorByUnit:function W(){return z(this.widget,q.ColorBy);},getSizeByUnit:function p(){return z(this.widget,q.SizeBy);},getSliceByUnits:function D(){var AI=this.widget.fnGetWidget();return AI.getDropZoneItems(q.SliceBy,this.widget.k);},getTooltipUnits:function i(){var AI=this.widget.fnGetWidget();return AI.getDropZoneItems(q.AdditionalMetrics,this.widget.k);},setMapType:function(AI){this.vp.gtp=AI;},setBorderStyle:function(AI){this.vp.shapeLineStyle=AI;this.vp.shapeLineClr=F.BORDER_COLOR;},getMapType:function(){return this.vp.gtp;},getLayerName:function(){return this.vp.ln;},setShapeFile:function(AI){this.vp.lid=AI;},setUseAttributeForm:function h(AI){this.useAttributeForm=AI?AD.USE_ATTRIBUTE_FORM:AD.USE_ATTRIBUTE;},getXml:function Q(){var AI=this.vp,AK=this.tooltip,AJ=this.useAttributeForm;AI[AF.LEGEND_MODE]=AI[AF.LEGEND_MODE]||O.RESTORED.toString();AI[AF.LEGEND_POSITION]=AI[AF.LEGEND_POSITION]||G.RIGHT_MIDDLE.toString();AI[u.SHOW_LEGEND]=AI[u.SHOW_LEGEND]||"false";AI[M.collapseLegend]=AI[M.collapseLegend]||AB.RESTORE.toString();AI[M.legendSwitch]=AI[M.legendSwitch]||"false";AI[M.baseMapType]=AI[M.baseMapType]||H.Reserved;AI[M.layerIdx]=AI[M.layerIdx]||0;AI[M.layerName]=AI[M.layerName]||mstrmojo.desc(14750,"Layer")+" 1";AI[M.isHidden]=AI[M.isHidden]||"0";AI[M.zoomSetting]=AI[M.zoomSetting]||g.Automatic;AI[M.clusterRadius]=AI[M.clusterRadius]||50;AI[M.clusterMaxZoom]=AI[M.clusterMaxZoom]||22;AI[M.languageType]=AI[M.languageType]||d.English;AI[M.tooltipSwitch]=AI[M.tooltipSwitch]||"true";if(this.isMapbox){AI[M.mapStyle]=w.V8_DEFAULT;}AI.ga=this.geoAttribute||"";AI.gmt=this.geometry||"";AI.lat=this.latitude||"";AI.lng=this.longitude||"";AI.cmt=this.colorBy||"";AI.smt=this.sizeBy||"";AI.slc=(this.slice||[]).join("");AI.amt=this.angle||"";if(AJ){AI[M.useAttributeForm]=AJ;}AI.tooltip="";if(AK){AK.forEach(function(AL){AI.tooltip+=AL;});}return AD.getXmlFromJson(this.vp);},showColorByZone:function(AI){return AD.canShowColorByZone(AI);},showSizeByZone:function(AI){return !!AI&&AI[M.graphicType]===t.Bubble;},showSliceZone:function(AI){return !!AI&&AI[M.graphicType]===t.Bubble;},showAngleZone:function(AI){return !!AI&&AI[M.graphicType]===t.Bubble||((AI[M.graphicType]===t.Marker)&&AI[M.clusterMode]===f.PIE);}});AD=mstrmojo.vi.viz.MapHelper;AD.zonesCfg=[{n:mstrmojo.desc(11661,"Geo Attribute"),id:q.GeoAttribute,prm:true,allowSingle:true,show:function(){return true;},v:function(AI){return B(AI,M.geoAttribute);},onDel:function(AI,AJ){if(!!AI){AI[M.geoAttribute]=(AJ&&X.walk("zone.items.1.id",AJ))||"";if(AI[M.shapeFile]!==K){AI[M.shapeFile]="";}}},onAdd:function(AI,AJ){if(!!AI){AI[M.geoAttribute]=AJ.item.did;AI[M.useAttributeForm]=AD.USE_ATTRIBUTE_FORM;if(AI[M.shapeFile]!==K){AI[M.shapeFile]="";}else{AI[M.useAttributeForm]=AD.USE_ATTRIBUTE;}}}},{n:mstrmojo.desc(7696,"Latitude"),id:q.Latitude,prm:true,allowSingle:true,show:function(AI){if(!!AI){return(AI[M.graphicType]!==t.Area);}},v:function(AI){return B(AI,M.latitude);},onDel:function(AI){if(!!AI){AI[M.latitude]="";}},onAdd:function(AI,AJ){var AK=AJ.item;if(!!AI){AI[M.latitude]=AK.did;AI[M.useAttributeForm]=AK.t===21?AD.USE_ATTRIBUTE_FORM:AD.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(7697,"Longitude"),id:q.Longitude,prm:true,allowSingle:true,show:function(AI){if(!!AI){return(AI[M.graphicType]!==t.Area);}},v:function(AI){return B(AI,M.longitute);},onDel:function(AI){if(!!AI){AI[M.longitute]="";}},onAdd:function(AI,AJ){var AK=AJ.item;if(!!AI&&!!AK){AI[M.longitute]=AK.did;AI[M.useAttributeForm]=AK.t===21?AD.USE_ATTRIBUTE_FORM:AD.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(16630,"Geometry"),id:q.Geometry,prm:true,allowSingle:true,show:function(AI){if(!!AI){return(AI[M.graphicType]===t.Area&&AI[M.shapeFile]===K);}return false;},v:function(AI){return B(AI,M.geometry);},onDel:function(AI){if(!!AI){AI[M.geometry]="";}},onAdd:function(AI,AJ){var AK=AJ.item;if(!!AI){AI[M.geometry]=AK.did;AI[M.useAttributeForm]=AK.t===21?AD.USE_ATTRIBUTE_FORM:AD.USE_ATTRIBUTE;}}},{n:mstrmojo.desc(6188,"Slice"),id:q.SliceBy,prm:true,allowSingle:false,show:function(AI){if(!!AI){return AD.showSliceZone(AI);}},v:function(AI){if(!!AI){var AJ=AI[M.slice];return AJ&&AJ.match(j);}},onDel:function(AI,AJ){var AK=AJ&&AJ.item;if(!!AI&&AK&&AK.id&&AI[M.slice]){AI[M.slice]=AI[M.slice].replace(AK.did,"");}},onAdd:function(AI,AJ){var AM=M.slice,AL=AJ&&AJ.item;if(!!AI&&AL){var AK=AI[AM]?AI[AM].match(j):[];AK.splice(AJ.idx,0,AL.did);AI[AM]=AK.join("");}}},{n:mstrmojo.desc(14294,"Angle"),id:q.Angle,prm:true,allowSingle:true,show:function(AI){if(!!AI){return AD.showAngleZone(AI);}},v:function(AI){return B(AI,M.angle);},onDel:function(AI){if(!!AI){AI[M.angle]="";}},onAdd:function(AI,AJ){I(AI,AJ,M.angle);}},{n:mstrmojo.desc(11662,"Color By"),id:q.ColorBy,prm:true,allowSingle:true,show:function(AI){return AD.canShowColorByZone(AI);},v:function(AI){return B(AI,M.colorby);},onDel:function(AI){if(!!AI){AI[M.colorby]="";}},onAdd:function(AI,AJ){I(AI,AJ,M.colorby);}},{n:mstrmojo.desc(11663,"Size By"),id:q.SizeBy,prm:true,allowSingle:true,show:function(AI){if(!!AI){return AD.canShowSizeByZone(AI);}},v:function(AI){return B(AI,M.sizeby);},onDel:function(AI){if(!!AI){AI[M.sizeby]="";}},onAdd:function(AI,AJ){I(AI,AJ,M.sizeby);}},{n:mstrmojo.desc(2962,"Tooltip"),id:q.AdditionalMetrics,prm:false,allowSingle:false,show:function(){return true;},v:function(AI){if(!!AI){var AJ=AI[M.tooltip];return AJ&&AJ.match(j);}},onDel:function(AI,AJ){if(AI&&AI[M.tooltip]){AI[M.tooltip]=AI[M.tooltip].replace(AJ.item.did,"");}},onAdd:function(AI,AJ){var AL=M.tooltip;if(!!AI){var AK=AI[AL]?AI[AL].match(j):[];AK.splice(AJ.idx,0,AJ.item.did);AI[AL]=AK.join("");}}}];AD.USE_ATTRIBUTE="0";AD.USE_ATTRIBUTE_FORM="1";AD.canShowColorByZone=function(AI){return !!AI&&(AI[M.graphicType]!==undefined)&&AI[M.graphicType]!==t.Density;};AD.canShowSizeByZone=function(AI){return !!AI&&AI[M.graphicType]===t.Bubble;};AD.showAngleZone=function(AI){if(!AI){return false;}return AI[M.graphicType]===t.Bubble||((AI[M.graphicType]===t.Marker)&&AI[M.clusterMode]===f.PIE);};AD.showSliceZone=function(AI){return !!AI&&AI[M.graphicType]===t.Bubble;};AD.supportImageThreshold=function(AI){return !!AI&&AI[M.graphicType]===t.Marker;};AD.isLatitude=function c(AJ,AI){return AI===5||(AJ&&AJ.toLowerCase().indexOf("latitude")>-1);};AD.isLongitude=function AA(AJ,AI){return AI===6||(AJ&&AJ.toLowerCase().indexOf("longitude")>-1);};AD.isGeometry=function m(AI){return AI===11;};AD.isAxisAttribute=function AH(AJ){var AI=AJ&&AJ.fs,AK;if(AI&&AI.length===1){AK=AI[0];return !!AK&&(AK.fgr===5||AK.fgr===6||AK.fgr===11);}return false;};AD.convertToReferenceFormat=function a(AJ,AL){if(!!AJ&&C[AL]){if(AL==="tooltip"||AL==="slc"){return AJ.replace(/(.{32})/g,s+"$1");}else{if(AL==="ttpmf"){var AK=E.unserializeTooltipForms(AJ);var AI={};X.forEach(AK,function(AM,AN){var AO=s+AN;AI[AO]={};X.forEach(AM,function(AP,AQ){AI[AO][s+AQ]=1;});});return E.serializeTooltipForms(AI);}else{return s+AJ;}}}else{return AJ;}};AD.convertFromReferenceFormat=function(AJ,AI){if(!AI||!C[AJ]){return AI;}return AI.replace(e,"");};AD.getXmlFromJson=function Y(AI){var AJ=new mstrmojo.XMLBuilder();AJ.addChild("widgetProps");AJ.addChild("fmt");X.forEach(AI,function(AK,AL){AJ.addChild(AL);AJ.addAttribute("value",AD.convertToReferenceFormat(AK,AL));AJ.closeElement();});AJ.closeElement();AJ.closeElement();return AJ.toString();};AD.isGeoRoleSupportArea=function N(AI){AI=AI&&AI.toString();return AI===x.EnumGeographicRoleCity||AI===x.EnumGeographicRoleState||AI===x.EnumGeographicRoleCountry||AI===x.EnumGeographicRoleOther||AI===x.EnumGeographicRoleZipCode||AI===x.EnumGeographicRoleCounty;};AD.getGeoForm=function AE(AL,AJ){var AI=AL&&AL.fs,AK=null;if(!AJ){AJ=function(){return true;};}if((AL.otp===12||AL.t===12)&&AI){o.forEach(AI,function(AM){if(AJ(AM)){AK=AM;return false;}});}return AK;};AD.getLatitudeForm=function AG(AI){return AD.getGeoForm(AI,function(AJ){return AD.isLatitude(AJ.fnm,AJ.fgr)&&AJ.obf;});};AD.getLongitudeForm=function b(AI){return AD.getGeoForm(AI,function(AJ){return AD.isLongitude(AJ.fnm,AJ.fgr)&&AJ.obf;});};AD.getGeometryForm=function S(AI){return AD.getGeoForm(AI,function(AJ){return AD.isGeometry(AJ.fgr)&&AJ.obf;});};AD.zonesNeedSyncToTooltipZone=[q.GeoAttribute,q.SliceBy,q.Angle,q.SizeBy,q.ColorBy];AD.xmlNodeToConvert=C;AD.shouldSyncItemToTooltipZone=function k(AK,AI,AJ){AJ=o.ensureArray(AJ);return AD.zonesNeedSyncToTooltipZone.indexOf(AI)>-1&&AJ.indexOf(AK)<0;};function z(AJ,AI){var AM=AJ.fnGetWidget(),AL=AJ.k,AK=AM.getDropZoneItems(AI,AL);return AK[0];}function P(AJ,AI,AK){var AL=z(AJ,AI,AK);return AL?AL.id:"";}function B(AJ,AI){if(!!AJ){return AJ[AI]?[AJ[AI]]:[];}}function I(AJ,AK,AI){var AL=AK.item;if(!!AJ||!!AL){AJ[AI]=AL.did;}return AJ;}}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapUtils","mstrmojo.gmaps.MapEnums","mstrmojo.vi.enums.EnumFeatures");var R=mstrmojo.gmaps,J=R.MapUtils,N=R.EnumGeographicRole,F=R.EnumBaseMapType,L=R.EnumPolygonSource,I=R.EnumThresholdType,Q="4-s",G=R.CustomShapeId;function D(S){return !!(S&&S.custom&&(S.custom==="true"||S.custom===true));}mstrmojo.gmaps._AreaMapHelper=mstrmojo.provide("mstrmojo.gmaps._AreaMapHelper",{_mixinName:"mstrmojo.gmaps._AreaMapHelper",getAvailableShapes:function C(S,b,Z,a){var X=[],W,Y,U;if(!S||Z==undefined){return X;}if(a===F.Mapbox){return this.getShapesForMapbox(S,b);}for(Y=0,U=S.length;Y<U;Y++){W=S[Y];if(J.isWSLocalMode()&&D(W)){continue;}if(a!==F.Esri&&!D(W)){continue;}if(this.isMapBoxShapeConfig(W,b)){continue;}if(Z===N.EnumGeographicRoleNone||Z===N.EnumGeographicRoleGeometry||Z===N.EnumGeographicRoleOther&&D(W)||Z==W.roleId){X.push(W);}}return X;},getShapesForMapbox:function E(S,Z){var X=[],W,Y,U,a=mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.M2020_VERSION);for(Y=0,U=S.length;Y<U;Y++){W=S[Y];if(W.id===G&&!a){continue;}if(this.isMapBoxShapeConfig(W,Z)){W.supportedGeoRoles=[W.roleId];if(W.roleId===N.EnumGeographicRoleCity){W.supportedGeoRoles.push(N.EnumGeographicRoleCounty);}X.push(W);}}return X;},getPolygonSource:function B(S,U,W,Z){var X=S&&S.data,a=X&&X.vp,b=a&&a.lid,Y,c;if(!a){return L.Cloud;}if(!!b){Y=this.getMatchingShape(U,b,null);}else{c=this.getShapeAttributeGeoRole(X,S.dropZones.geoAttribute);U=this.getAvailableShapes(U,W,c,Z);Y=this.getMatchingShape(U,null,c);}if(!!Y){if(!b){a.lid=Y.id;}if(D(Y)){if(this.isMapBoxShapeConfig(Y,W)){if(Y.id===G){return L.MapboxCustomShape;}return L.MapBoxPolygon;}return L.Custom;}}return L.Cloud;},isMapBoxShapeConfig:function P(S,Y){var W,U,X=(Y&&Y.length)||0;for(W=0;W<X;W++){U=Y[W];if(S.layerId===U.id){return parseInt(U.scope)===parseInt(F.Mapbox);}}return false;},isMapboxStatisticalShape:function O(S,Y){var W,U,X=(Y&&Y.length)||0;for(W=0;W<X;W++){U=Y[W];if(S&&S.layerId===U.id){return U.scope===Q;}}return false;},getShapeAttributeGeoRole:function H(Y,a){var U=Y.gts,f=U&&U.row,S,e,d,Z,c,W,X,b=false;if(!f||!f.length){return ;}c=f.length;if(!!a){for(Z=0;Z<c;Z++){d=f[Z];if(d.id!==a){continue;}S=d.fs||[];for(W=0,X=S.length;W<X;W++){e=S[W].fgr;if(e==undefined){continue;}e=e.toString();if(e!==N.EnumGeographicRoleNone&&e!==N.EnumGeographicRoleLatitiude&&e!==N.EnumGeographicRoleLongitude){b=true;break;}}if(b){break;}}}else{for(Z=0;Z<c;Z++){d=f[Z];S=d.fs||[];for(W=0,X=S.length;W<X;W++){e=S[W].fgr;if(e!==N.EnumGeographicRoleNone&&e!==N.EnumGeographicRoleLatitiude&&e!==N.EnumGeographicRoleLongitude){break;}}}}return e;},getMatchingShape:function K(U,Z,c){var X,Y,b,S,W,a;if(!U){return null;}if(c===N.EnumGeographicRoleNone){c=null;}if(!!Z){for(W=0,a=U.length;W<a;W++){if(U[W].id==Z){X=U[W];break;}}}else{if(!!c){for(W=0,a=U.length;W<a;W++){S=U[W];if(D(S)&&(S.roleId==c||(S.supportedGeoRoles&&S.supportedGeoRoles.indexOf(c)>-1))){if(!Y){Y=S;}if(!!S["default"]&&(S["default"]+"").toLowerCase()==="true"){X=S;break;}}else{if(!b&&S.roleId==c&&!!S["default"]&&(S["default"]+"").toLowerCase()==="true"){b=S;}}}if(!X){if(!!Y){X=Y;}else{if(!!b){X=b;}}}}}return X;},getShape4MapboxSecondGeoAttr:function A(U,W,a,d){var S,Y,X,b,c,Z;U=this.getAvailableShapes(U,W,N.EnumGeographicRoleOther,F.Mapbox);b=(U&&U.length)||0;Y=this.getMatchingShape(U,a,null);for(X=0;X<b;X++){S=U[X];if(S.roleId==d||(S.supportedGeoRoles&&S.supportedGeoRoles.indexOf(d)>-1)){if(d==N.EnumGeographicRoleCountry){return S;}c=this.isMapboxStatisticalShape(Y,W);Z=this.isMapboxStatisticalShape(S,W);if(c===Z){return S;}}}return null;},populateColorBy:function M(a,S,c,W){if(!!S&&S.length===1&&S[0].otp===-1){var Z=a[c].items,U=S[0].es;for(var X=0,e=Z.length;X<e;X++){var b=Z[X],f=U[X].n,g=b.v,d=b.ty;if(!d||d===I.Number){W[J.replaceSpace(f)]=g;}else{W[J.replaceSpace(f)]=Z[X].rv;}}}if(this.isColorByAttr===true){this.populateColorInfo(W);}var Y=this.getThresholdInfo(c,this.colorMetricIdx);if(!!Y){W.threshold=Y;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Button","mstrmojo.EnumRWUnitType","mstrmojo.vi.models.VIComponentMap","mstrmojo.VisEnum","mstrmojo.gmaps.MapEnums","mstrmojo.models.template.DataInterface");mstrmojo.requiresDescs(15518,15519,15526);var G=mstrmojo.array,E=mstrmojo.hash,C=12,B=4,D="-1",I=1,H=2,J=-1,F=mstrmojo.Button.newWebButton,K=mstrmojo.vi.models.VIComponentMap.TYPES,A=mstrmojo.models.template.DataInterface;mstrmojo.vi.models._CheckDataCards=mstrmojo.provide("mstrmojo.vi.models._CheckDataCards",{_mixinName:"mstrmojo.vi.models._CheckDataCards",CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID,isUnitRestrictedInViz:function(){var Q=this.getHost&&this.getHost(),P=Q&&Q.defn,M=!!(P&&P.iifp);if(M){return false;}var L=this.docModel,N=[],O=L.getVIComponent(K.FILTER_PANEL),R=O&&O.parent;N=N.concat((R&&R.getFilterDefinitions())||[]);return N.length;},_addInLargeItems:[],_columnCardinalityCount:1,_totalRow:0,clearCardinalityFlags:function(){this._addInLargeItems=[];this._columnCardinalityCount=1;this._totalRow=0;},existLargeOrManyItems:function(){return(!!this._addInLargeItems.length||this._columnCardinalityCount>this.CARDLIMIT);},existLargeRowCount:function(){return(this._totalRow>mstrmojo.vi.models.editors.XtabEditorModel.ENUM_MAX_ROWS_OUTLINE);},findTotalColumnCount:function(S,U,a,L){var W=this,b,N=1,R=0,X=this.getHost().gridData,Z;W._columnCardinalityCount=1;if(X){if(U&&U.id===I){var M=X.rw,c=M&&M.row;W._columnCardinalityCount=(c&&c.tc)||1;return ;}if(typeof L==="number"&&L>=0){var Q=E.walk("gts.col",X),O,Y;Z=E.walk("items."+L+".cols",U);G.forEach(Z,function(d){if(d.t===C){O=G.filterOne(Q,function(e){return e.id===d.did;});Y=E.walk("es.length",O)||1;N=N*Y;}});}else{Z=U&&U.items;var P=E.walk("ghs.chs",X);if(P&&P.cws){N=P.cws.length;}}}G.forEach(a,function(d){if(d.t===C&&d.card){N=N/d.card;}});G.forEach(S,function(d){if(U&&U.id===H){G.forEach(Z,function(e){if(e.t===C&&e.did===d.did&&e.card){R++;N=N/e.card;}});}b=d.cardg>0?d.cardg:d.card;if(!b&&d.otp===C&&d.es){b=d.es.length+1;}if(b){N=N*b;}});W._columnCardinalityCount=(R===S.length)?1:N;},findEstimatedTotalRow:function(R,N,M){var U=this,c,Y=1,O=0,b=this.getHost&&this.getHost(),W=b.gridData,a=this.docModel,S=a&&a.datasets;M=M||[];U._totalRow=1;function Q(f){var e=0;Object.keys(S).every(function(g){return S[g].att&&S[g].att.every(function(h){if(h.did===f){e=h.card;return false;}return true;});});return e;}function P(e){return R.some(function(f){return e.did===f.did;})||M.some(function(f){return e.did===f.did;});}if(W){var L=parseInt(E.walk("rhsCP.rc",b)||0,10);if(L>0){Y=L;}else{var X=W.gsi||{},d=X.rows,Z=X.mx;G.forEach(d,function(e){if(P(e)){return ;}if(e.t===C){Y*=Q(e.did)||1;}else{if(e.t===B){if(e.did===D&&Z){O=Z.length;G.forEach(Z,function(f){if(P(f)){O--;}});}}}});}}G.forEach(R,function(e){if(e.t===B){if(N===I||N===J){if(e.did===D&&W&&W.gsi.mx){O=W.gsi.mx.length;}else{O++;}}}c=e.cardg>0?e.cardg:e.card;if(!c&&e.otp===C&&e.es){c=e.es.length+1;}if(c){if(N===I){Y=Y*c;}}});Y=Y+Y*O;U._totalRow=Y;return Y;},addAttributeNameAndTargetVisForAddUnits:function(S,Q,R,P,N){if(!S){return ;}var O={data:S},L=S&&S.vp,M;R=R||S&&S.vis&&S.vis.vn;P=P||L&&L.gtp;N=N||L&&L.ln;M=R===mstrmojo.vi.viz.EnumVizStyles.GOOGLE_MAP||R===mstrmojo.vi.viz.EnumVizStyles.ESRI_MAP||R===mstrmojo.vi.viz.EnumVizStyles.MAPBOX;G.forEach(Q,function(U){var X=U.id,W;if(X&&!U.attributeName){W=A.prototype.getUnitById.call(O,X);U.attributeName=W&&W.unit&&W.unit.n;}if(P===mstrmojo.gmaps.EnumGraphicType.Area&&M){if(!U.targetVis){U.targetVis={};}U.targetVis.vis=R;U.targetVis.gtp=P;U.targetVis.ln=N;}else{if(U.targetVis){U.targetVis=undefined;}}});},findLargeItemsForAddUnits:function(L,M,P){var O=this,Q,N={};if((!M&&!O.isUnitRestrictedInViz())||M){L.forEach(function(U){var R=U.cardg>0?U.cardg:U.card;Q=!!P?P:O.CARDLIMIT;if(U.targetVis&&U.targetVis.gtp===mstrmojo.gmaps.EnumGraphicType.Area){Q=mstrmojo.VisEnum.VIS_CARDLIMIT.AREA_MAP;}if(R&&R>Q){var W=U.attributeName||U.n;if(!N[W]){N[W]=true;var S=U.targetVis&&U.targetVis.ln?(W+"("+U.targetVis.ln+") ("+R+")"):W+" ("+R+")";O._addInLargeItems.push(S);}}});}},warnAndExecCallBackForOutlineAddUnits:function(N,M){var L=this,M=M||mstrmojo.emptyFn;if(this.existLargeRowCount()){mstrmojo.confirm(mstrmojo.desc(15792,"The dossier will attempt to display more than 5000 rows in outline mode. This may affect performance and stability. Do you want to continue?"),null,{id:"OutlineModeWarningDialog",title:mstrmojo.desc(11812,"Notification"),allowHTML:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(212,"Continue"),N),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),M)],onPreClose:function(){M();return true;}});}else{N();}},checkAndWarnForOutlineAddUnits:function(L,N,P,O,M){if(this.getHost().isOutlineMode){this.findEstimatedTotalRow(L,N,M);this.warnAndExecCallBackForOutlineAddUnits(P,O);}else{P();}},warnAndExecCallBackForAddUnits:function(S,Q,N,R){if(this.existLargeOrManyItems()&&!mstrApp.isAppStatePresentation()){var O=this._addInLargeItems,P=O.length,M;if(P>1){M=mstrmojo.desc(15518,"The following attributes contain a large number of elements: ##. This action may impact dossier performance.").replace("##",O);}else{if(P===1){M=mstrmojo.desc(15519,"The attribute ## has too many elements. This action may impact dossier performance.").replace("##",O);}else{M=mstrmojo.desc(15526,"The dossier will attempt to display more than ### columns. This can affect performance and stability.").replace("###",this.CARDLIMIT);}}var L=[];if(P&&Q){L.push(F(mstrmojo.desc(7977,"Move to Rows"),function(){Q();},true));}L.push(F(mstrmojo.desc(212,"Continue"),function(){S();}));L.push(F(mstrmojo.desc(2140,"Cancel"),function(){if(N){if(R){R();}else{if(mstrApp.isWorkstation&&mstrApp.isSingleTier){window.FormWrapper.closeWindow("{}");}else{mstrmojo._DocToolbarActions.close.call({model:{isnew:false}});}}}}));mstrmojo.warn(M,{},{buttons:L});O.splice(0,O.length);return ;}S();},checkAndWarnLargeItemsForAddUnits:function(Q,S,W,N,R,M,P,O,U,L){this.clearCardinalityFlags();if(!R||R.id===H){this.findLargeItemsForAddUnits(Q,M,P);}if(N){this.findTotalColumnCount(Q,R,U,L);}this.warnAndExecCallBackForAddUnits(S,W,M,O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.Pulldown","mstrmojo.hash","mstrmojo.models.template.DataInterface");mstrmojo.requiresDescs(2429);var B=mstrmojo.models.template.DataInterface,G=mstrmojo.hash,F=-1,E=[{n:mstrmojo.desc(2429,"All Columns"),id:F,key:null}];function C(N,J,I,H){var K=H?[].concat(E):[],M=0,L;B.forEachGSI(N,function(S,Q,P){L=L||J.getLayoutKeyByUnitKey(Q);var R=J.getLayoutUnitDefn(Q,L),O=(R&&R.ttl)||"";K.push({n:O,id:P,key:Q});if(I===Q){M=K.length-1;}});return{items:K,idx:M};}mstrmojo.ui.editors.controls.ColumnSetGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ColumnSetGroup",includeAll:true,pulldown:null,init:function D(J){this._super(J);var L=J.callback||mstrmojo.emptyFn,H=C(J.gsi,J.docModel,J.value,this.includeAll),K={},I;G.copyProps(["focusOnPopup","onitemSelected","enableAccessibility"],J,K);I=mstrmojo.ui.Pulldown.newPulldown(H.items,function(M,N){L(M.key,M.id);},H.idx,K);this.addChildren(I);this.pulldown=I;},updatePulldownItems:function A(M,J,L,I){var H=C(M,J),K=this.pulldown;if(K){K.set("items",H.items);if(typeof L==="number"){K.set("selectedIndex",L);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.array","mstrmojo.date");mstrmojo.requiresClsP("mstrmojo.mstr");mstrmojo.requiresClsP("mstrmojo.models.template","DataInterface");var k=1,i=2,q=3,I=4,b=5,l=6,j=7,A=-1,J=-2,G=mstrmojo.color,M=mstrmojo.hash,e=mstrmojo.array,F=mstrmojo.num,O=mstrmojo.date,s=mstrmojo.models.template.DataInterface,K,a,u=mstrmojo.mstr.EnumDSSXMLObjectTypes;function p(AD,AC){return AD.every(function(AE){return AC(AE);});}function g(AE,AD,AC){return p(AE,function(AF){return AF.ttp===AD||AF.ttp===AC;});}function d(AD){var AC=AD.toFixed(2);return parseFloat(AC);}function o(AC){this.raiseEvent(M.copy(AC,{name:"modelEdit"}));}function w(AC){this.raiseEvent(M.copy(AC,{name:"selectedThresholdsChange"}));}function S(){var AC=this.basedOnId||this.metricId;return(e.filterOne(this.gsi.mx,function(AD){return AD.did===AC;})||{});}function m(AF){var AC=AF.expr.nds,AD=AC.length;if(AD!==1){return false;}var AE=AC[0],AO=AE.cs;if(!AE.m||!AO){return false;}var AN=AE.fnt,AI=AE.fn,AM=AO[0],AK=AO[1],AH=AM&&AM.v,AG=AK&&AK.v,AL=F.parseNumeric(AH)||parseFloat(AH),AJ=F.parseNumeric(AG)||parseFloat(AG);switch(AN){case 2:case 3:switch(AI){case 1:case 2:AF.flr=AN===2?-Infinity:0;AF.ceil=AL;AF.ttp=AN===2?(AI===1?b:I):(AI===1?i:k);break;case 3:case 4:case 5:case 13:AF.flr=AL;AF.ceil=isNaN(AJ)?(AN===2?Infinity:100):AJ;AF.ttp=AN===2?(AI===4?b:(AI===5?I:l)):(AI===4?i:(AI===5?k:q));break;default:return false;}break;default:switch(AI){case 11:AF.flr=-Infinity;AF.ceil=AL;AF.ttp=j;break;case 17:case 10:AF.flr=AL;AF.ceil=isNaN(AJ)?Infinity:AJ;AF.ttp=j;break;default:return false;}}return true;}mstrmojo.threshold.MetricThresholdData=null;mstrmojo.threshold.ThresholdModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdModel",data:undefined,gsi:undefined,setIdx:undefined,thresholds:undefined,orgThresholds:undefined,selectedThresholds:[],metricId:undefined,basedOnId:undefined,basedOnName:undefined,editorMode:0,init:function t(AD){this._super(AD);var AC=mstrApp.customization.getCustomThresholds();K=K||AC.color;a=a||AC.image;},ondataChange:function n(){var AC=this.data;this.gsi=s.getGSI(AC.gsi,this.setIdx);this.thresholds=this.gsi.thresholds;this.saveOriginalData();},onsetIdxChange:function x(){var AC=this.data;this.gsi=s.getGSI(AC.gsi,this.setIdx);this.thresholds=this.gsi.thresholds;this.saveOriginalData();},isMetricAvailable:function(AC){return e.find(this.gsi.mx,"did",AC)!==-1;},thresholdMetricNotAvailable:function(AC){if(AC){mstrmojo.alert(mstrmojo.desc(16555,'This threshold is based on the metric "#####" which has been removed from the visualization. Please re-add this metric and try again.').replace("#####",AC));}else{mstrmojo.alert(mstrmojo.desc(16556,"This threshold is based on a metric which has been removed from the visualization. Please re-add this metric and try again."));}},isAdvanced:function E(AG){var AD=this.thresholds;if(AD){var AJ=AD[AG]||[],AZ=false,AY,AU,AT,AQ,AW="The expression is not supported by the Simple Threshold Exception Parser.";if(AJ.length===0){return false;}if(AJ.some(function(Af){if(Af.ttp===A){return true;}try{if(!m(Af)){throw AW;}AT=Af.expr.nds[0].m;}catch(Ae){return true;}if(AY&&AY!==AT.did){return true;}AY=AT.did;AU=AT.n;var Ad=Af.rtp;if(Ad===3||Ad===10){return true;}var Aa=Af.scope;if(Aa&&Aa!==1){return true;}var Ac=Af.fmt||{};for(var Ab in Ac){if(Ab!=="bc"&&Ab!=="bgs"){return true;}else{AZ=true;}}return false;})){return true;}if(AZ&&!p(AJ,function(Aa){return Aa.fmt&&(Aa.fmt.bc||Aa.fmt.bgs);})){return true;}this.basedOnId=AY;this.basedOnName=AU;var AS=false,AP=this.getSimpleThresholdType(AG),AI=AJ.length;if(AI>0&&AP!==J){var AV,AL,AN;for(AV=0;AV<AI-1;AV++){AL=AJ[AV];AN=AJ[AV+1];if(AL.ceil!==AN.flr&&AL.flr!==AN.ceil){AS=true;break;}}if(!AS){var AC=AJ[0],AE=AJ[AI-1],AM=AC.flr,AR=AE.ceil,AF=AC.ceil,AH=AE.flr,AK=this.getMetricsCount(),AO=this.getMetricsMinValue(),AX=this.getMetricsMaxValue();switch(AP){case b:case I:AS=!(((AM===0||AM===-Infinity)&&(AR===AK||AR===Infinity))||((AF===AK||AF===Infinity)&&(AH===0||AH===-Infinity)));break;case i:case k:AS=!((parseInt(AM,10)===0&&parseInt(AR,10)===100)||(parseInt(AF,10)===100&&parseInt(AH,10)===0));break;case j:AS=!(((AM===AO||AM===-Infinity)&&(AR===AX||AR===Infinity))||((AF===AX||AF===Infinity)&&(AH===AO||AH===-Infinity)));break;}}return AS;}else{return true;}}return false;},getSimpleThresholdType:function(AD){var AE=this.thresholds&&this.thresholds[AD],AC=J;if(AE){if(g(AE,q,i)){AC=i;}else{if(g(AE,q,k)){AC=k;}else{if(g(AE,l,I)){AC=I;}else{if(g(AE,l,b)){AC=b;}else{if(g(AE,j)){AC=j;}}}}}}return AC;},isImageBasedType:function N(AC){var AD=this.thresholds&&this.thresholds[AC];return AD&&!AD.some(function(AE){return AE.rtp!==4;});},getMetricsMaxValue:function(){var AC=S.call(this).max;return(AC===undefined)?3000000:AC;},getMetricsMinValue:function(){var AC=S.call(this).min;return(AC===undefined)?-3000000:AC;},getMetricsCount:function(){var AC=S.call(this).cnt;return AC===undefined?100:AC;},getServerThresholdValues:function B(){var AC=this.basedOnId||this.metricId,AD=this.thresholds&&AC in this.thresholds&&this.thresholds[AC];if(e.isArray(AD)&&AD.length>0&&AD[0].ttp===j){AD.sort(function(AF,AE){return AF.flr-AE.flr;});return{min:AD[0].ceil,max:AD[AD.length-1].flr};}return{min:undefined,max:undefined};},getFormatString:function(){var AE=this.data.nf,AD=this,AC=e.filterOne(AE,function(AF){return AF.id===AD.basedOnId;})||{};return AC.nfs||"";},getDefaultColors:function AA(){return K;},getDefaultImages:function L(){return a;},getNormalizedValue:function(AH,AF,AE,AJ){var AD=null;if(AF===q||AF===i||AF===k){AD=AH/100;}else{if(AF===l||AF===b||AF===I){AD=AH/(this.getMetricsCount());}else{if(AF===j){var AG=this.globalMinMax(AE,AJ),AC=AG.min,AI=AG.max;if(AJ!==undefined&&AJ<AI){AI=Math.max(AJ,this.getMetricsMaxValue());}if(AE!==undefined&&AE>AC){AC=Math.min(AE,this.getMetricsMinValue());}if(AI===AC){return 1;}AD=(AH-AC)/(AI-AC);}}}if(AD<0){AD=0;}if(AD>1){AD=1;}return AD;},getRealValue:function(AG,AE,AD,AI){if(AE===q||AE===i||AE===k){return d(AG*100);}if(AE===l||AE===b||AE===I){return d(AG*this.getMetricsCount());}if(AE===j){var AF=this.globalMinMax(AD,AI),AC=AF.min,AH=AF.max;if(AI!==undefined&&AI<AH){AH=Math.max(AI,this.getMetricsMaxValue());}if(AD!==undefined&&AD>AC){AC=Math.min(AD,this.getMetricsMinValue());}return AC+AG*(AH-AC);}return null;},globalMinMax:function f(AD,AH){var AC=(AD!==undefined&&AD!==-Infinity)?AD:Infinity,AG=(AH!==undefined&&AH!==Infinity)?AH:-Infinity,AE=this.getServerThresholdValues(),AF=AE.min,AI=AE.max;AF=(AF===undefined)?Infinity:AF;AI=(AI===undefined)?-Infinity:AI;return{min:Math.min(AC,this.getMetricsMinValue(),AF),max:Math.max(AG,this.getMetricsMaxValue(),AI)};},getColorScheme:function(AD){var AC="custom",AE,AF,AG;K.forEach(function(AH){AG=AH.bands;AF=AD.length;if(AF!==AG.length){return ;}for(var AI=0;AI<AF;AI++){AE=mstrmojo.color.fixFullHexValue(AD[AI]);if(AG[AI].bc!==AE&&AG[AF-AI-1].bc!==AE){return ;}}AC=AH.id;});return AC;},getImageSetName:function Z(AG){var AF=a[0].id,AC,AE=function(AH){return AH===AC.bands[0].url;};for(var AD=0;AD<a.length;AD++){AC=a[AD];if(AG.some(AE)){AF=AC.id;break;}}return AF;},getGridValueFormat:function P(){return this.gsi.fmts.va;},isMapReversed:function Q(AE,AC,AG){var AF=(AG?a:K).filter(function(AH){return AH.id===AE;})[0],AD=AC[0];if(!AG){AD=G.fixFullHexValue(AD);}return AF&&AF.bands[0][AG?"url":"bc"]!==AD;},setConditionData:function U(AF,AD){var AE=AF.data,AC=AE.isNew;M.copy(AD,M.clear(AE));delete AE.isNew;AF.paint();AF.tree.onConditionEdit(AF,AC);},hasSelectedThresholds:function z(){return this.selectedThresholds.length>0;},isThresholdSelected:function h(AC){return this.selectedThresholds.indexOf(AC)!==-1;},toggleThresholdSelected:function c(AC,AE){var AI=this.selectedThresholds,AH=AI.indexOf(AC),AD=AH!==-1,AG=this.thresholds[this.metricId],AF=AG.indexOf(AC)!==-1;if(AF){if(AE&&!AD){AI.push(AC);}else{if(!AE&&AD){AI.splice(AH,1);}}w.call(this);}},addThresholds:function Y(AC){var AD=this.thresholds[this.metricId];this.thresholds[this.metricId]=(AD||[]).concat(AC);o.call(this);},duplicateThreshold:function y(AD){var AF=this.thresholds[this.metricId],AC=AF[AD],AE=M.clone(AC);AF.push(AE);if(this.isThresholdSelected(AC)){this.toggleThresholdSelected(AE,true);}o.call(this);},deleteThreshold:function AB(AC){var AE=this.thresholds[this.metricId];var AD=AE.indexOf(AC);if(AD!==-1){this.toggleThresholdSelected(AC,false);AE.splice(AD,1);}o.call(this);},moveThreshold:function D(AD,AF){var AE=this.thresholds[this.metricId],AC=AE.splice(AD,1);this.thresholds[this.metricId]=AE.slice(0,AF).concat(AC,AE.slice(AF,AE.length));o.call(this);},cleanUp:function R(){this.selectedThresholds=[];this.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.AUTO;},clearData:function X(){var AC=this.thresholds;if(AC){AC[this.metricId]=undefined;}},saveOriginalData:function W(){this.orgThresholds=M.clone(this.thresholds);},setAttIdToNDE:function C(AE){if(!(AE instanceof Array)){AE=[AE];}var AD,AJ,AF,AC,AI,AG=function(AK){AK.att.forEach(function(AL){if(AL.did===AI.did){AI.attId=AL.attId;}});},AH=function(AK){AK.conid=AI.did;};for(AD=0;AD<AE.length;AD++){AC=AE[AD];for(AJ in AC){AI=AC[AJ];if(typeof AI==="function"||!(AI instanceof Object)){continue;}else{if(AJ==="a"){if(AI.t===47&&AI.st===12033){M.forEach(this.controller.datasets,AG);AF=AC.fn;if(AF===22||AF===57){(AC.es||[]).forEach(AH);}}}else{this.setAttIdToNDE(AC[AJ]);}}}}},showNumberFormat:function H(){var AD=S.call(this),AE=AD&&AD.min,AC=AD&&AD.max;return(typeof (AE)==="number"||typeof (AC)==="number")||(O.isDate(AE)||O.isDate(AC));}});mstrmojo.threshold.ThresholdModel.SLIDER_MODE={COLOR_BASED:0,IMAGE_BASED:1,COLOR_TREND:1};mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL=[{n:"&#9679;",v:"1"},{n:"&#9632;",v:"2"},{n:"&#9830;",v:"3"},{n:"&#9670;",v:"4"},{n:"&#10070;",v:"5"},{n:"&#9784;",v:"6"},{n:"&#10047;",v:"7"},{n:"&#8984;",v:"8"},{n:"&#8680;",v:"29"},{n:"&#8679;",v:"30"},{n:"&#8681;",v:"31"}];mstrmojo.threshold.ThresholdModel.FEATURES={SHOW_ADVANCED_EDITOR:1,SHOW_BASED_ON:2,SHOW_IMAGE:3,SHOW_VALUE_ITEM:4,SHOW_COLOR_TREND:5,SHOW_MC_ADVANCED_EDITOR:6};mstrmojo.threshold.ThresholdModel.EDITOR_TYPES={AUTO:0,ADVANCED_EDITOR:1,SIMPLE_EDITOR:2};mstrmojo.threshold.ThresholdModel.BASED_ON_TYPES={LOWEST_PERCENT:k,HIGHEST_PERCENT:i,BETWEEN_PERCENT:q,LOWEST:I,HIGHEST:b,BETWEEN:l,VALUE:j,COMPLEX:A,NONE:J};}());(function(){mstrmojo.requiresCls("mstrmojo._DocXtabModelShared","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.expr","mstrmojo.elementHelper","mstrmojo.vi.models.EnumDragSources","mstrmojo.fe.FilterUtils","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.enums.EnumFeatures","mstrmojo.models.template.DataInterface","mstrmojo.models.FormatModel","mstrmojo.vi.enums.EnumVisFilterType");var O=mstrmojo.hash,f=mstrmojo.array,R=mstrmojo.string,I=mstrmojo.expr,K=I.FN,M=I.ET,Z=mstrmojo.elementHelper,k=mstrmojo.vi.models.EnumDragSources,t=mstrmojo.fe.FilterUtils.getExprXml,C=mstrmojo.fe.FilterUtils.isExprEmpty,p=mstrmojo.vi.ui.DatasetUnitMenuUtils,Y=mstrmojo.vi.enums.EnumFeatures,q=mstrmojo.models.template.DataInterface,u=mstrmojo.models.FormatModel,m=mstrmojo.vi.enums.EnumVisFilterType,s=mstrmojo._DocXtabModelShared;var H=4,X=12,n="-1";var B=3;function F(w){return w.docModel.controller.cmdMgr;}function h(z){var w=[],AA="The expression is not supported by the View Filter Exception Parser.",x=function x(AE){if(Z.isNullElem(AE.id)&&R.isEmpty(AE.v)){throw AA;}},AD=function AD(AG){var AF=null;if([M.AE,M.ANDOR].indexOf(AG.et)>-1||(AG.et===M.AQ&&AG.fn===K.IS_NULL)){if(!AG){return true;}var AE=AG.nds;AF=!(AG.not||AG.fn===K.NOT||AG.fn===K.NOT_IN_LIST);if(AE){AE.every(function(AH){AF=AF&&AD(AH);});}}else{throw AA;}return AF;},AC=function AC(AG){var AF=false;if([M.AE,M.ANDOR].indexOf(AG.et)>-1||(AG.et===M.AQ&&AG.fn===K.IS_NULL)){AF=(AG.fn===K.DESCENDANT);var AE=AG.nds;if(AE){AE.every(function(AH){AF=AF||AC(AH);});}}else{throw AA;}return AF;},y=function y(AG,AI,AK){var AM=AG&&AG.nds,AF=AG.fn===K.OR;AK=AK||AI;if(AM&&AM.length){var AH=AI;AM.forEach(function(AN){if(AF){AH=[];}y(AN,AH,AK);if(AF&&AH.length>0){AI.push(AH);}});}else{if(AG.fn===K.IS_NULL){var AL=AG.a=AG.a||{n:"Null Attribute",did:""};AI.push({tn:AL.n,tid:AL.did,eid:null,v:""});}else{if(AG.et===M.AE){var AE=AG.es||[];var AJ=AE.length;if(AJ===1){x(AE[0]);AI.push({tn:AG.a.n,tid:AG.a.did,eid:AE[0].v,v:AE[0].n});}else{if(AK){AE.forEach(function(AN){x(AN);AK.push([{tn:AG.a.n,tid:AG.a.did,eid:AN.v,v:AN.n}]);});}}}}}return AI;};try{if(z){(z.nds||[]).forEach(function(AE){var AF=y(AE,[]);if(AF.length>0){w.push({keepOnly:AD(AE),isBranch:AC(AE),data:AF});}});}}catch(AB){if(AB!==AA){console.error("vi.models.DocXtabModel: Encountered a problem parsing the view filter expression ("+AB+")");}else{return[];}}return w;}mstrmojo.vi.models._DocXtabModelShared=mstrmojo.provide("mstrmojo.vi.models._DocXtabModelShared",O.copy({mixinName:"mstrmojo.vi.models._DocXtabModelShared",addEditNodeForDatasetAction:function W(y,x){this.augmentDropContextForSchema(y,this.docModel);var AC=y.getCtxtDragData(),AB=AC.src;if(AB===k.DATASETS||AB===k.ALL_OBJECT_LIST){var AA=AC.dsid,z=O.walk("xtab.gridData.datasetId",this),w=O.walk("xtab.gridData.dataSourceState",this),AD=y.actions||[];if(AA&&!w&&!z){AD.push({act:"editNode",nodeKey:x,datasetId:AA});}y.actions=AD;}},getSaveViewFilterAction:function N(w,x){return{act:"saveViewFilter",nodeKey:w||this.xtab.k,expr:C(x)?'<exp><nd et="14" fn="19"></nd></exp>':t(x)};},_clearDrillingActionsHelper:function P(AA,z){var w=this.docModel,y=AA.model,x;return function(AC,AB){x=w.getVfNdFromExpr(AC)||{et:14,nds:[]};z.actions.push(y.getSaveViewFilterAction(AB,x));};},getClearFiltersForVisActions:function c(y,z,w,AA){var x={actions:[],callback:AA};w=[].concat(w);if(f.includes(w,m.KEEP_ONLY)){x=this.addClearKeepOnlyActions(y,z,x);}if(f.includes(w,m.ADV_QUALIFICATION)){x=this.addClearAdvQualActions(y,z,x,w);}if(f.includes(w,m.DOSSIER_LINKING)){x=this.addClearDossierLinkingActions(y,z,x);}if(f.includes(w,m.DRILLING)){x=this.addClearDrillingActions(y,z,x);}if(f.includes(w,m.LINKING)){x=this.addClearLinkingActions(y,z,x);}return x;},getClearLinkViewFilterAction:function G(y){var w=this.docModel,x=(y&&y.k)||this.xtab.k;return{act:"clearLinkViewFilter",nodeKey:x,partialRetrieval:{nodes:[x].concat(w.getSourceFilterKeys(x))}};},getClearLinkingAction:function e(x){var w=this.docModel,y=x.k;return w.getClearLinkingActionByUnitKey(y);},getPivotFormAction:function U(AF,x,AB){var y=this.getCellTitleInfo(AF),AC=y.title,z=AC.id,AA=this.getAttributeFormsInTemplate(z),AE=(AC.fix&&AC.fix-1)||(AF.fi||0),w=AA[AE],AD;if(x==="l"){AD=AE-1;}else{if(x==="r"){AD=AE+1;}}return{act:"pivot",unitPos:AD+1,attFormId:w.id,unitId:z,unitType:AB||"",originUnitPos:AE+1};},addClearKeepOnlyActions:function a(y,z,x){var w=y.model;return w.getKeepOnlyActionsForAssociatedNodes([],x.callback,z);},_clearAdvQualActionsHelper:function j(AB,AC,AA,z){var w=this.docModel,AD=w.getDataService(),y=AB.model,x=(AC&&AC.k)||this.xtab.k;return function(AF,AG,AE){if(AF){AA.actions.push(AD.getUpdateTemplateAction(AE,y.getRemoveMetricLimitsAction(AF),null,x));}if(AG){if(z>-1){AA.actions.push(y.getSaveViewFilterAction(AE));return true;}else{AA.actions.push(y.getSaveViewFilterAction(AE,w.getVfexprWithUpdatedVf(x)));}}return false;};},addClearDossierLinkingActions:function S(y,z,x){var w=y.model;x.actions.push(w.getClearLinkViewFilterAction(z));return x;},addClearLinkingActions:function E(y,z,x){var w=y.model;x.actions=x.actions.concat(w.getClearLinkingAction(y));x.extras={style:{params:{treesToRender:3}}};return x;},showNumberFormat:function(AF){var AG=[1,2,8,9,11],AD;var AC;if(AF.t===X){var x=this.xtab.node.data,w=x&&x.gts,y=new mstrmojo.models.template.DataInterface(x),AB=w&&(y.getRowTitles().titles||[]).concat(y.getColTitles().titles||[]),AE=f.filterOne(AB,function(AH){return AF.did===AH.id;}),AA=((AE&&AE.fs)||[]).map(function(AH){return AH.id;});AD=(AF.fs||[]).some(function(AH){return AG.indexOf(AH.bftp)!==-1&&AA.indexOf(AH.fid||AH.id)!==-1&&!AH.fgr;});}else{if(AF.t===H){AC=mstrmojo.NumberFormat.isNumberFormatDT(AF.dt);}}var z=mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(Y.NUMBER_FORMATTING);return(AF.t===H&&AC&&AF.did!==n&&z)||!!AD;},getNumberFormatEditorCfg:function b(y){var x=y.item,z=this.getNumberFormatData(x),w=f.find(z,"id",x.did),AA=w===-1?{}:z[w];return p.getNumberFormatEditor(y.item,AA,this.getNumberFormatEditorAcceptCallback(x));},hasDerivedElements:function A(w){var x=this.getObjectInfo(w);return !!(x&&x.de);},getTemplateLimit:function l(){return this.data.tpl;},getSelectorDataFromViewFilter:function o(w){return h(w);},getSelectorDataFromTemplateLimit:function J(w){return this.getSelectorDataFromViewFilter(w);},isRecursiveAttribute:function g(w){var y=this.docModel.getDEObject(w),x=this.getFullObjectInfo(y?y.attId:w)||this.getObjectInfo(y?y.attId:w);return x&&x.t===12&&x.st===3076;},isSubtotalValue:function D(w){var x=this.getCellDataUnion(w);return !w.stt&&x.some(function(y){return !!y.isSubtotal;});},supportsDSLKViewFilter:function i(w){var x=this.getObjectInfo(w);return x&&!x.de&&(x.t!==1)&&(x.t!==47);},getDossierInfo:function(x,w){return mstrmojo.ui.editors.controls.ContextualLink.genDLAction(this.data.doslinkinfo,this.docModel,x,w);},getUnitNameInDataSet:function(w){return this.docModel.findUnitNameInDataSetFromUnit(w);},getAdvancedPropertiesAction:function d(w){return{act:"advancedProperties",props:w};},moveSubTotals:function Q(x,y){var AA=this,AB=AA.xtab,AC=AB.gridData.gsi,w=[],z=AA.docModel.getDataService(),AD;q.forEachGSI(AC,function(AF,AE){AD=AA.getMoveSubTotalAction(x.data,y,AE);w.push(z.getUpdateTemplateAction(AE,AD,null,AB.k));},AB.k);AB.submitUndoRedoActionsWithCallback(w);},getApplyGridCellFormatToSubtotalAction:function L(AD){var AH=[],AG=this.xtab,AA=AG.model,AB=AG.controller,y=AB.dataService(),AC=AG.gridInfo,w,x,z,AF,AE=function(AK,AJ){O.forEach(AK,function(AM,AL){AF=u.getFormatPropertyInfo(AL);if(AF&&AF.ps!==u.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){x=O.mergeHashes(x,u.getFormatUpdate(AL,(AF.pt===B)?AM:u.decodeValue(AL,AM)));}});var AI=AA.getZoneFormatAction.call(AA,AD,x,AJ,{isSubtotalFormat:true});AH.push(y.getUpdateTemplateAction(AJ,AI,null,AG.k));};q.forEachGSI(AC,function(AJ,AI){x={};w=AJ.fmts;z=w[AD];AE(z,AI);},AG.k);return AH;},},O.copy(s)));mstrmojo.vi.models._DocXtabModelShared.fnGetSelectorDataFromViewFilterExpr=h;})();(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.fe.FilterUtils","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig","mstrmojo.models.template.DataInterface","mstrmojo.mstr.EnumDSSXMLObjectTypes");var Ag=mstrmojo.hash,AX=Ag.copy,BS=mstrmojo.array,Ar=mstrmojo.dom,o=mstrmojo.func,a=[mstrmojo.desc(8445,"Loading")],AJ=mstrmojo.fe.FilterUtils.getExprXml,w="$GUID_135",Bi=mstrmojo.array.ensureArray,l=0,Bh=mstrmojo.models.template.DataInterface,BL=mstrmojo.mstr.EnumWebAPIErrorCodes,B=mstrmojo.mstr.EnumDSSXMLObjectTypes;function Ak(Bk){Bk=Bk||{};Bk.preserveUndo=true;return Bk;}function An(Bo,Bp,Bk){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var Bl=l++,Bn=this.getTxUpdates(Bl);Bk=Bk||{};Bk.src=An.caller.name;if(!mstrmojo.string.isEmpty(Bn)){Bo.updateChanges=Bn;}Bo.zoomFactor=this.model.getZoomFactor();var Bm=this.cmdMgr;if(!Bk.preserveUndo&&Bm){Bm.onSubmitUpdates();}mstrApp.serverRequest(Bo,this.wrapCallback(Bp,Bl,Bk.preserveStid),Bk);}function A9(Bo,Bm,Bk){var Bn=Bm&&Bm.boxContent,Bl=!!Bn?Bn.getNodeKey():Bm.k;Ag.copy({unitType:Bm.defn&&Bm.defn.t,unitKey:Bl},Bo);if(Bk.layoutKey){Ag.copy({toKey:Bk.layoutKey,analysisSectionType:Bk.analysisSectionType},Bo);}else{Ag.copy({toKey:Bk.parentKey},Bo);}return Bo;}function j(Bm,Bn,Bl,Bk){Ag.copy({unitType:Bn.defn.t,treeType:1,nodeKey:Bn.nk,fieldKey:Bn.k,destTreeType:1,destNodeKey:Bl},Bm);if(Bk){Ag.copy({createNode:true,newNodeKey:Bk.newNodeKey,newNodeKeyParent:Bk.newNodeKeyParent},Bm);}return Bm;}function Aj(Bl){Bl=Bl||{};if(mstrApp.optimizeFitToPage){var Bk=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(Bk){Bl.styleName="RWDocumentMobileStyle";Bl.availableWidth=Bk.w;Bl.availableHeight=Bk.h;}else{Bl.innerWidth=mstrmojo.dom.windowDim().w;Bl.innerHeight=mstrmojo.dom.windowDim().h;}}return Bl;}function BP(Bo){var Bn=this.updatingDocZoom,Bm=this.sendBrowserInfo;Bo=Bo||{};delete this.updatingDocZoom;delete this.sendBrowserInfo;if(mstrApp.optimizeFitToPage&&!Bn&&mstrApp.isExpress&&(this.model.zt===1||this.model.zt===2)){if(Bm){Bo=Aj.call(this,Bo);}else{Bo.clientZoomFactor=this.model.getZoomFactor();var Bk=this.model.getCurrentLayoutDef(),Bl=(Bk&&Bk.dzf)||1;Bo.clientDesiredZoomFactor=Bl;}}return Bo;}function BY(Bl){var Bk=Bl&&Bl.style,Bm=Bk&&Bk.params;return Bm&&Bm.treesToRender;}function A6(Bk,Bl,Bm){return{act:"moveUnit",toKey:Bk,unitType:Bl,srd:Bm};}function Bd(Bk){return Bk.split("\u001E")[2];}function AL(Bl,Bp){if(Bl!==mstrmojo.DocDataService.UNDO_KEY){return Bl;}if(!this.undoSectionKey){var Bo=this.undoSectionKey=this.model.getNextKey(),Bm=this.undoFGKey=this.model.getNextKey();Bp.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:Bo,fgKey:Bm});var Bn=this;Bp.addCallbacks({failure:function Bk(){delete Bn.undoSectionKey;}});}return this.undoSectionKey;}function A3(Bm,Bl){var Bk={dsid:Bm.dsid,formula:Bm.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(Bm.tokenStreamXML),name:Bm.alias,dsc:Bm.dsc,afb:Bm.afb,sfb:Bm.sfb};if(Bl){Bk.Ids=[w];}return this.getAddDerivedMetricToDatasetAction(Bk);}function AK(Bl){var Bk="USE_DEFAULT_INDICATOR";Bl=Bl||{};Bl.mptso=Bl.mptso||{pru:true};Bl.mptsim=Bl.mptsim||{pru:true};Bl.mptfms=Bl.mptfms||"";return{MDXPassThrough:{SolveOrder:Bl.mptso.pru?Bk:Bl.mptso.v,ScopeIsolationMode:Bl.mptsim.pru?Bk:Bl.mptsim.v,FormatString:Bl.mptfms}};}function At(Bk,Bl){return{act:"formatDerivedMetric",dsid:Bk.dsid||"",mid:(Bl||!Bk.did)?w:Bk.did,format:AK(Bk.mptf)};}function K(Bn,Bq,Bl,Br,Bk,Bm){var Bo=[this.getNodeKeyFromKeyContext(Bq)];if(!Bm){Bo=Bi(Br).concat(Bo);}var Bp={act:Bn,keyContext:Bq,tgtKey:Bl,partialRetrieval:{nodes:Bo}};if(!Bk){Bp.partialUpdate={selectors:[Bd(Bq)]};}return Bp;}function BI(Bm){var Bo=false;if(Bm===1||Bm===2){var Bl=this.model,Bk=Bl.controller,Bp=Bk.getRequiredZoomFactor&&Bk.getRequiredZoomFactor(Bm),Bn=Bl.getZoomFactor();if(isNaN(Bp)||parseInt(Math.abs((Bp-Bn)*100),10)<=2){Bo=false;}else{Bo=true;}}return Bo;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,clientAuto:false,init:function Bf(Bk){this._super(Bk);this.cmdMgr=this.model.controller&&this.model.controller.cmdMgr;},wrapCallback:function N(Bp,Bm,Bl){var Bn=this;return o.wrapMethods({success:function Bo(Bq){if(Bq){Bn.model.bs=Bn.rwb=Bq.bs||Bn.rwb;Bn.msgId=Bq.mid||Bn.msgId;Bn.cbKey=Bq.cbKey||Bn.cbKey;if(Bq.stid!==undefined&&!Bl){Bn.stid=Bq.stid;}if(Bq.clientAuto!==undefined){Bn.clientAuto=Bq.clientAuto;}if(mstrApp.parseSecondaryDataProviders){mstrApp.parseSecondaryDataProviders(Bq);}}Bn.clearTxUpdates(Bm);},failure:function Bk(){Bn.resetTxUpdates(Bm);}},Bp);},getNodeKeyFromKeyContext:function BQ(Bk){return Bk.split("\u001E")[1];},refresh:function AO(Bm,Bn){var Bl=!!Bm.useRefreshProgress,Bk=Bl?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:a;delete Bm.useRefreshProgress;Bm=Aj.call(this,Bm);An.call(this,AX(Bm,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false,displayNoResErr:true,compress:1}),Bn,{showProgress:true,hideProgress:true,progressStateText:Bk,useRefreshProgress:Bl});},saveRW:function Ao(Bk,Bl){An.call(this,AX(Bk,{taskId:"saveRW",msgID:this.msgId}),Bl);},saveThresholds:function BW(Bl,Bm,Bk){An.call(this,AX(Bl,{taskId:"saveThresholds"}),Bm,Bk);},getThresholds:function Av(Bl,Bm,Bk){An.call(this,AX(Bl,{taskId:"getThresholds"}),Bm,Bk);},browseElements:function s(Bl,Bm,Bk){An.call(this,AX(Bl,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),Bm,Bk);},removeUnit:function F(Bl,Bm){var Bk=AX(Bl,{act:"removeUnit"});this.submitTemplateUpdates(Bk.nodeKey,Bk,Bm);},removeLayout:function AW(Bl,Bk,Bm){this.submitUpdates({act:"removeLayout",unitKey:Bl,isCurrent:Bk},Bm);},moveLayout:function AD(Bm,Bk,Bl){this.submitUpdates(this.getMoveNodeAction(Bm,Bk,Bl),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function AB(Bl,Bk,Bn){var Bm={act:"macroCopyUnit",newKey:Bn,partialRetrieval:this.newRetrievalKeysConfig().addNode(Bn)};A9(Bm,Bl,Bk);return Bm;},getMacroMoveNodeAction:function Ad(Bl,Bk,Bo){var Bn=this.newRetrievalKeysConfig();Bn.addNode(Bl.k);Bo&&Bo.forEach(function(Bp){Bn.addNode(Bp);});var Bm={act:"macroMoveUnit",partialRetrieval:Bn};A9(Bm,Bl,Bk);return Bm;},getCopyFieldAction:function O(Bo,Bl,Bn,Bk){var Bm={act:"copyField",destFieldKey:Bn,fieldName:Bo.title+" copy",partialRetrieval:this.newRetrievalKeysConfig().addNode(Bl)};j(Bm,Bo,Bl,Bk);return Bm;},getMoveFieldAction:function AA(Bn,Bl,Bk){var Bm={act:"moveField",partialRetrieval:this.newRetrievalKeysConfig().addNode(Bl)};j(Bm,Bn,Bl,Bk);return Bm;},getMoveNodeAction:function A8(Bp,Bk,Bm,Br){var Bo=Bp.defn,Bn=Bo?Bo.t:mstrmojo.EnumRWUnitType.LAYOUT,Bq=Bp&&Bp.boxContent,Bl=!!Bq?Bq.getNodeKey():Bp.k;return this.getMoveNodeActionUsingKey(Bl,Bn,Bk,Bm,Br);},getMoveNodeActionUsingKey:function Bg(Bo,Bm,Bk,Bl,Bp){var Bn=A6(Bk,Bm,Bp);Bn.unitKey=Bo;if(Bl!==undefined){Bn.index=Bl;}return Bn;},getMoveControlAction:function S(Bn,Bl,Bk){var Bm=A6(Bl,mstrmojo.EnumRWUnitType.SELECTOR);Bm.keyContext=Bn;if(Bk){Bm.partialRetrieval={nodes:Bi(Bk)};}return Bm;},addMoveControlAction:function BE(Bn,Bm,Bl,Bk){Bn.addActions(this.getMoveControlAction(Bm,AL.call(this,Bl,Bn),Bk));},getSetCtrlSourceAction:function BT(Bl,Bn,Bk,Bm){return{act:"setControlSource",keyContext:Bl,unitId:Bn,unitType:Bk,removeCGB:Bm||[],partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bl)),partialUpdate:{selectors:[Bd(Bl)]}};},getSetCandidateObjectsAction:function Aw(Bl,Bk){return{act:"setCandidateObjects",keyContext:Bl,ctlType:8,units:Bk,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bl)),partialUpdate:{selectors:[Bd(Bl)]}};},getRemoveCtrlTargetAction:function g(Bm,Bl,Bn,Bk){return K.call(this,"removeControlTarget",Bm,Bl,Bn,Bk);},getClearCtrlTargetAction:function BN(Bk){return{act:"clearControlTarget",keyContext:Bk};},getAddCtrlTargetAction:function A1(Bo,Bl,Bp,Bq,Bk,Bm){var Bn=K.call(this,"addControlTarget",Bo,Bl,Bp,Bk,Bm);Bn.isUC=!Bq;return Bn;},appendRepObjParams:function AR(Bo,Bm,Bn,Bl){var Bk=Bm.getCGBMap();if(!Bk||!Bn){return ;}Ag.forEach(Bn.cgb,function(Bp){if(Bk[Bp]===Bl){var Bq=Bm.getTargetDefn(Bp)[Bp];if(Bq){Bo.rplObjId=Bq.replace_object;Bo.rplObjTp=Bq.replace_object_type;}}});},getReplaceCtrlTargetAction:function A0(Bn,Bm,Bl,Bk){return{act:"replaceControlTarget",ctlType:8,rplObjId:Bl,rplObjTp:Bk,nodeKey:Bm,partialUpdate:{selectors:[Bd(Bn)]}};},getAddCtrlTargetDatasetAction:function Ab(Bl,Bk){return{act:"addControlTargetDataset",keyContext:Bl,tgtDid:Bk};},getRemoveCtrlTargetDatasetAction:function Am(Bl,Bk){return{act:"removeControlTargetDataset",keyContext:Bl,tgtDid:Bk};},getClearCtrlTargetDatasetAction:function Q(Bk){return{act:"clearControlTargetDataset",keyContext:Bk};},getChangeControlElementSource:function q(Bl,Bk){return{act:"changeControlElementSource",keyContext:Bl,ctlElementSrc:Bk};},getSetVLDBPropAction:function BX(Bn,Bl,Bk,Bm,Bp,Bo){return Ag.copy({act:"setVLDBProperty",prop:Bn,handler:Bl,nodeKey:Bk,value:Bm,partialRetrieval:this.newRetrievalKeysConfig().addNode(Bp||Bk)},Bo);},getTxUpdates:function BZ(Bl){var Bk=this.model;return Bk&&Bk.getTransactionUpdates&&Bk.getTransactionUpdates(Bl);},clearTxUpdates:function L(Bl){var Bk=this.model;if(Bk&&Bk.clearTransactionUpdates){Bk.clearTransactionUpdates(Bl);}},resetTxUpdates:function AV(Bl){var Bk=this.model;if(Bk&&Bk.resetTransactionUpdates){Bk.resetTransactionUpdates(Bl);}},loadDocLayout:function BM(Bo,Bq,Bp){var Bn={act:"setCurrentLayout",unitKey:Bo.layoutKey,disablePU:true,panelUnitKey:Bo.panelKey},Bm={style:{params:{treesToRender:3}}},Bk=this.model,Bl=!!Bp;if(mstrApp.isVI){Bq=o.wrapMethods(this.model.getUpdateLayoutDefaultPanelCallback(),Bq);}if(!Bp){Bp=Bk.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){Bk.applyBufferedSelections(Bp);}this.sendBrowserInfo=true;Bp.add(Bn,Bq,Bm);if(!Bl){this.submitUpdates(Bn,Bq,Bm);}},checkMissingCredentials:function W(Bk,Bl){An.call(this,AX(Bk,{taskId:"checkMissingCredentials"}),Bl);},setCurrentDocLayout:function BD(Bm,Bq,Bp){var Bo={act:"setCurrentLayout",unitKey:Bm},Bn={config:{silent:(Bq===null)&&(!!Bp&&Object.keys(Bp.callback||{}).length===0)}},Bk=this.model,Bl=!!Bp;Bq=Bq||null;if(mstrApp.isVI){Bq=o.wrapMethods(this.model.getUpdateLayoutDefaultPanelCallback(),Bq);}if(!Bp){Bp=Bk.getDataService().newUpdateWithoutCmd();}if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){Bk.applyBufferedSelections(Bp);}Bp.add(Bo,Bq,Bn);if(!Bl){Bp.submit();}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function BV(Bk,Bl){An.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:Bk},Bl);},requestPanelChangeDeferred:function Ai(Bq,Bp,Bk,Bl,Bn,Bo){var Bm={act:"setCurrentPanel",unitKey:Bp};if(Bk){Bm.partialRetrieval={nodes:Bk.split(",")};}if(Bl){this.sendBrowserInfo=true;}Bq.add(Bm,Bo,{config:{showProgress:Bn,hideProgress:Bn,progressStateText:a},style:{params:{treesToRender:Bl?3:0}}});},getGraphSelectionAction:function AP(Bp,Bk,Bm,Bt,Bs,Bl,Bu,Bo){var Bq=this.model.getCurrentLayoutDef(),Bv=(Bq&&Bq.dzf)||1,Br=!mstrApp.optimizeFitToPage||mstrApp.optimizeFitToPage===2,Bn={act:"graphSelector",nodeKey:Bp,sliceID:Bm,x:Br?Math.round(Bt/Bv):Bt,y:Br?Math.round(Bs/Bv):Bs};if(Bl){Bn.usePartialUpdate="0";}else{Bn.partialUpdate={selectors:Bk.split("\u001E")};}if(Bu&&Bo){Bn.w=Bu;Bn.h=Bo;}return Bn;},getSelectorElementsAction:function Af(Bm){var Bl={act:"setSelectorElements",keyContext:Bm.ck,ctlKey:Bm.ctlKey,elemList:mstrmojo.string.decodeHtmlString(Bm.eid),isVisualization:!!Bm.isDocVis},Bk=Bm.include;if(Bk!==undefined){Bl.include=!!Bk;}if(Bm.tks){Bl.tks=Bm.tks;}if(Bm.disablePU){Bl.usePartialUpdate="0";}else{if(Bm.ignoreTargetData){Bl.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bm.ck));}else{Bl.partialUpdate={selectors:Bm.ctlKey.split("\u001F")};}}return Bl;},getUpdateTransactionAction:function BC(Bl){var Bk={act:"updateTransaction"};if(Bl){if(Bl.ctlKey){Bk.partialUpdate={selectors:[Bl.ctlKey]};}}return Bk;},getSelectorFromGMAction:function AH(Bl){var Bk={act:"setSelectorFromGM",keyContext:Bl.ck,ctlKey:Bl.ctlKey,keepOnly:!!Bl.keepOnly,selectorObjects:Bl.selectorObjects,isVisualization:!!Bl.isDocVis,include:!!Bl.include};if(Bl.tks){Bk.tks=Bl.tks;}if(Bl.disablePU){Bk.usePartialUpdate="0";}else{Bk.partialUpdate={selectors:[Bl.ctlKey]};}return Bk;},getGMViewFilterAction:function Ba(Bl){var Bk={act:"keepOnlyGM",selectorObjects:Bl.selectorObjects,isVisualization:!!Bl.isDocVis,keepOnly:!!Bl.keepOnly};if(Bl.tks){Bk.tks=Bl.tks;}if(Bl.disablePU){Bk.usePartialUpdate="0";}else{Bk.partialUpdate={selectors:[Bl.ctlKey]};}return Bk;},browseControlElements:function AS(Bo,Bx,Bl){var Bn=Bo.searchPattern,Bu=Bo.attributeId,Bq=this.model;if(!Bn||Bn===""){return ;}var Br={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Bu,expressionXML:Bo.expressionXML||"",dataSourcesXML:Bo.dataSourcesXML||"",blockBegin:Bo.blockBegin,blockCount:Bo.blockCount,searchPattern:Bn,rawInput:Bn,browseFlags:Bo.browseFlags||0,otp:Bo.objectType};if(Bo.datasetId){AX({datasetID:Bo.datasetId,messageID:Bq.mid,ctlKey:Bo.controlKey},Br);}var Bw=Bo.searchForms;if(Bw){var Bm="",Bp="";BS.forEach(Bw,function(By){Bm+=Bp+By.did;Bp=";";});Br.searchForms=Bm;if(Bq.isnew||Bo.useClientForm){var Bk="",Bt="",Bs=BS.filterOne(Bq.getDatasetUnits(["att"]),function(By){return By.did===Bu;}),Bv=Bs.fs||[];BS.forEach(Bw,function(By){var Bz=BS.filterOne(Bv,function(B0){return B0.fid===By.did;});Bk+=Bt+By.did+":"+(Bz&&Bz.bftp||0);Bt=";";});Br.clientFormPatterns=Bk;}}An.call(this,Br,Bx,Bl);},setMultiDocSelectorElements:function X(Bk,Bl,Bn){var Bm={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:Bl,selectorObjects:Bk};An.call(this,Bm,Bn,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function Az(Bp,Br,Bt,Bq,Bs,Bl,Bk,Bm,Bo){var Bn={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:Bp,ctlTexts:Br,ctlKey:Bt,zoomFactor:Bl};if(Ar.isAndroid||Bk){Bn.taskId="androidSetDocSelectorElements";}if(Bq!==null&&Bq!==undefined){Bn.include=Bq;}if(Bm!==null&&Bm!==undefined){Bn.usePartDisplay=Bm;}if(Bo!==null&&Bo!==undefined){Bn.treesToRender=Bo;}An.call(this,Bn,Bs);},getSelectorExpressionAction:function D(Bm){var Bl={act:"setSelectorExpression",keyContext:Bm.ck,ctlType:Bm.type,objId:Bm.srcid,objType:Bm.srct,expFunction:Bm.f,expFunctionType:Bm.ft,include:!!Bm.include,qt:Bm.qt,unset:!!Bm.unset};if(Bm.disablePU){Bl.usePartialUpdate="0";}else{Bl.partialUpdate={selectors:[Bm.ckey]};if(Bm.retrieveCtrlKey){Bl.partialRetrieval=this.newRetrievalKeysConfig().addNode(Bm.ctlKey);}}if(Bm.changeQual){Bl.changeQual=Bm.changeQual;}var Bk=Bm.cs;if(Bk!==null&&Bk!==undefined){Bl.expConstants=Bk;Bl.dataType=Bm.dtp;}if(Bm.fid){Bl.fid=Bm.fid;}return Bl;},getAttributeSelectorExpressionAction:function I(Bl){var Bk={act:"setAttributeSelectorExpression",keyContext:Bl.ck,ctlKey:Bl.ctlKey,ctlType:Bl.type,expr:Bl.expr,partialUpdate:{selectors:[Bl.ctlKey]}};if(Bl.tks){Bk.tks=Bl.tks;}if(Bl.incFetch&&!Bl.autoApply){Bk.partialRetrieval={nodes:[Bl.ctlKey]};}return Bk;},getMultiUnitSelectorAction:function AN(Bk){return{act:"multiUnitSelection",keyContext:Bk.ck,include:Bk.include!==false,sels:Bk.selections,isBranch:Bk.isBranch,partialUpdate:{selectors:[Bk.ctlKey]}};},getCompoundGridMultiUnitSelectorAction:function Ax(Bn){var Bm=[],Bk,Bl;for(Bk=0;Bk<Bn.ck.length;Bk++){Bl=this.getMultiUnitSelectorAction(Bn);Bl.keyContext=Bn.ck[Bk];Bl.partialUpdate.selectors=[Bn.ctlKey[Bk]];Bm.push(Bl);}return Bm;},getRemoveCtrlAction:function k(Bl,Bk){return{act:"removeControl",key:Bl,partialUpdate:{selectors:[Bl]},partialRetrieval:{nodes:Bi(Bk)}};},getAddCtrlAction:function BA(Bs,Bq,Bl,Br,Bm,Bt,Bk,Bo,Bu,Bn){if(isNaN(Bu)){Bu=1;}var Bp={act:"addControl",parentKey:Bs,nodeKey:Bq,ctlKey:Bl,isUC:!!Bm,unitType:Bt||-1,unitId:Bk||"",targetKeys:Bi(Bo),ctlType:Bu,gpType:Bu===8?3:Bu,partialRetrieval:{nodes:Bi(Br)}};if(!Bp.isUC||Bn){Bp.partialUpdate={selectors:[Bl]};}return Bp;},getReplaceCtrlAction:function AY(Bm,Bp,Bk,Bo,Bl,Bn){return{act:"replaceControl",nodeKey:this.getNodeKeyFromKeyContext(Bm),ctlKey:Bp,ctlType:Bk,unitId:Bo,unitType:Bl,partialUpdate:{selectors:[Bp]},partialRetrieval:{nodes:Bi(Bn)}};},getUseAlternateFilterTechniqueAction:function AQ(Bm,Bo,Bl,Bn,Bk){return{act:"useAlternateFilterTechnique",nodeKey:this.getNodeKeyFromKeyContext(Bm),ctlKey:Bo,ctlType:Bl,pdf:Bk?1:0,partialUpdate:{selectors:[Bo]},partialRetrieval:{nodes:Bi(Bn)}};},getSaveGraphPropertiesAction:function Ac(Bk,Bl){return{act:"saveGraphProperties",nodeKey:Bk,properties:Bl};},getSelectorIncludeAction:function A(Bl){var Bk=Bl.ckey;return{act:"setSelectorInclude",keyContext:Bl.ck,ctlKey:Bk,ctlType:Bl.type,include:Bl.include,partialUpdate:{selectors:[Bk]}};},getSelectorShowAllAction:function Be(Bk){return{act:"setSelectorShowAll",keyContext:Bk.ck,ctlKey:Bk.ckey,ctlType:Bk.type,showAll:Bk.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bk.ck))};},getUnsetSelectorAction:function Bb(Bn){var Bm=Bn.ckey,Bk=Bn.ck,Bl={act:"unsetSelector",keyContext:Bk,ctlKey:Bm};if(Bn.ignoreTargetData){Bl.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bk));}else{Bl.partialUpdate={selectors:[Bm]};}if(Bn.resetSuc){Bl.resetSuc=true;}if(Bn.retrieveCtrlKey){Bl.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bk));Bl.partialRetrieval=Bl.partialRetrieval.addNode(Bm);}return Bl;},getDynamicSelectionAction:function A7(Bp){var Bl=Bp.ck,Bo=Bp.ctlKey,Bm=this.getNodeKeyFromKeyContext(Bl),Bk=Bp.updateKeys||[],Bn={act:"dynamicSelection",keyContext:Bl,ctlKey:Bo,nodeKey:Bm,sus:Bp.sus,suc:Bp.suc};if(Bp.ignoreTargetData){Bn.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bl));}else{Bn.partialUpdate={selectors:[Bo].concat(Bk)};}if(mstrApp.isDossier){Bn.partialRetrieval={nodes:[Bo]};}return Bn;},getRASelectorExpandAction:function u(Bl){var Bk=Bl.ckey;return{act:"raSelectorExpandCollapse",keyContext:Bl.ck,ctlKey:Bk,ctlType:Bl.type,elementId:Bl.elementId,isExpand:Bl.isExpand,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(Bl.ck))};},getChangeFilteringAction:function BG(Bk,Bn,Bm,Bl){return{act:"changeFiltering",nodeKey:Bk,filterMode:Bn,isUC:Bm,partialRetrieval:{nodes:(Bl?Bi(Bl):[])}};},getAddDerivedMetricToDatasetAction:function d(Bk){return{act:"addDerivedMetricToDataset",dsid:Bk.dsid,formula:Bk.formula,isTokenStream:Bk.isTokenStream,name:Bk.name,dsc:Bk.dsc,newObjectIds:Bk.Ids,afb:Bk.afb,sfb:Bk.sfb};},getSetMDXPassThroughOptionsForCMAction:function y(Bk){var Bl={act:"formatDerivedElement",format:AK(Bk.mptf)};if(Bk.cid){Bl.cid=Bk.cid;}if(Bk.ceid){Bl.ceid=Bk.ceid;}return Bl;},getEditDocUnitPropAction:function i(Bk){return{act:"editDocUnitProp",dsid:Bk.dsid,formId:Bk.formId,unitId:Bk.unitId,unitType:Bk.unitType,prop:Bk.prop,value:Bk.value};},getRWGraphImage:function AI(Bp,Bt){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&BI.call(this,this.model.zt)){return ;}var Bo=mstrApp,Bk=this.id,Bl={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:Bp.k,sliceID:parseInt(Bp.sid,10),width:parseInt(Bp.w,10),height:parseInt(Bp.h,10)};var Bm=function(Bv){if(Bv&&Bv.code==BL.MSI_GRAPH_NO_DATA&&Bp.withinInfoWin){return true;}return false;};if(Bp.needCoordinate){Bl.needCoordinate=1;}if(Bo.onMobileDevice()&&Bo.useBinaryFormat){window.setTimeout(function(){An.call(mstrmojo.all[Bk],Bl,Bt,Ak());},0);}else{if(Bp.encodeImage){Bl.taskContentEncoding="base64";delete Bl.taskEnv;An.call(this,Bl,{success:function Bu(Bv){Bt.success(Bv);},failure:function Bn(Bv){(Bt.failure||Bo.onerror)(Bv);}},Ak({skipIServerError:Bm}));}else{var Br=Bo.getConfiguration(),Bq=Bo.getCurrentProjectId(),Bs=new mstrmojo.StringBuffer();Bl.__ts__=new Date().getTime();Bl.sessionState=Bo.getSessionState(Bq);Ag.forEach(Bl,function(Bv,Bw){Bs.append(Bw+"="+encodeURIComponent(Bv));});Bt.success(Br.getTaskUrlByProject(Bq)+"?"+Bs.toString("&"));}}},getImage:function A4(Bl){var Bm=mstrApp,Bk=Bm.getConfiguration();if(Bk&&Bl&&Bl.indexOf("://")===-1){Bl=Bk.getHostUrlByProject(Bm.getCurrentProjectId())+Bl;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(Bl)):Bl;},setGridDisplayMode:function Ae(Bm,Bl,Bn,Bk){Ag.copy(mstrmojo.DocDataService.RAPID_EXEC,Bk);this.submitUpdates({act:"setGridDisplayMode",unitKey:Bm,displayMode:Bl},Bn,Bk);},setDocZoom:function M(Bk,Bl){this.updatingDocZoom=true;this.submitUpdates(AX(Bk,{act:"setDocZoom",disablePU:true}),Bl,{style:{params:{treesToRender:3}}});},sortGrid:function AG(Bk,Bl){this.submitTemplateUpdates(Bk.nodeKey,AX({act:"sort"},Bk),Bl);},getAdvSortData:function n(Bk,Bl){this.rwExecute(AX(Bk,{styleName:"RWGridStyle"}),Bl);},getFilterExpression:function R(Bm,Bl){var Bn=Bm&&Bm.expr,Bk=this.model;if(Bn&&Bk&&Bk.getVfexprWithUpdatedVf){Bn=Bk.getVfexprWithUpdatedVf(Bl,Bn);}return AJ(Bn);},saveViewFilter:function AE(Bp,Bq){var Bo=this.msgId,Bk=Bp&&Bp.nodeKeys,Bn=this,Bm=BS.map(Bk,function(Br){return{act:"saveViewFilter",messageID:Bo,nodeKey:Br,expr:Bn.getFilterExpression(Bp.filterModel,Br),partialUpdate:{nodes:[Br]}};}),Bl=BS.map(Bk,function(Br){return{act:"saveViewFilterLimit",messageID:Bo,nodeKey:Br,limitExp:Bp.limitExp,limitToRemove:Bp.limitMdxToRemove||[]};});this.submitUpdates(Bm.concat(Bl),Bq);},getViewFilter:function f(Bl,Bm){var Bk=this.model;if(Bk.getViewFilter){Bk.getViewFilter(Bl,Bm);}else{An.call(this,{taskId:Bl.taskId,rwb:Bl.rwb,msgID:Bl.msgID,nodeKey:Bl.nodeKey},Bm);}},createEmbeddedFilter:function H(Bm,Bp){var Bk=Bm.filterId,Bn=Bm.expJson,Bo={act:"createEmbeddedFilter",messageID:this.msgId,expr:Bm.expr,filterId:Bk,filterName:Bm.filterName};var Bl=this.model;o.wrapMethods({success:function(){var Bq=Bl.defn.efs||[];Bq.push({did:Bk,exp:Bn});Bl.defn.efs=Bq;}},Bp);this.submitUpdates([Bo],Bp,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.NONE}},params:{suppressData:true}});},rwExecute:function P(Bk,Bl){An.call(this,AX(Bk,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),Bl);},pivot:function BH(Bk,Bl){this.submitTemplateUpdates(Bk.nodeKey,{act:"pivot",unitId:Bk.unitId,unitType:Bk.unitType,attFormId:Bk.attFormId,axis:Bk.axis,unitPos:Bk.unitPos},Bl);},resizeXtabColumn:function Au(Bk,Bl){this.submitUpdates([this.getUpdateTemplateAction(Bk.nodeKey,Bk),{act:"format",unitType:52,unitKey:Bk.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],Bl);},showTotals:function J(Bk,Bl){this.submitTemplateUpdates(Bk.nodeKey,{act:"showTotals",unitId:Bk.unitId,unitType:Bk.unitType,subtotalType:Bk.subtotalType,clearSubtotalType:Bk.clearSubtotalType},Bl);},drillGrid:function AZ(Bk,Bl){this.submitUpdates(this.getDrillGridAction(Bk),Bl,{config:{showProgress:true,hideProgress:true,progressStateText:a,delay:true}});},getDrillGridAction:function x(Bl){var Bk={act:"gridDrillWithin",messageID:this.msgId,nodeKey:Bl.nodeKey,sliceId:Bl.sliceId,drillPathIndex:Bl.drillPathIndex,drillPathKey:Bl.drillPathKey,elementList:Bl.drillElements,retainParent:Bl.retainParent,partialUpdate:{nodes:Bi(Bl.updateNodeKey||Bl.nodeKey)}};if(Bl.x){Bk.x=Bl.x;Bk.y=Bl.y;Bk.graphHeight=Bl.graphHeight;Bk.graphWidth=Bl.graphWidth;}return Bk;},getShowBandingAction:function Ah(Bk){return{act:"showBanding",show:!!Bk};},changeDocGroupBy:function U(Bm,Bn,Bk){var Bl={act:"changeDocGroupBy",disablePU:true};if(Bm.flags){Bl.flags=Bm.flags;}if(Bm.groupbyKey){Bl.gbKey=Bm.groupbyKey;Bl.elemId=Bm.elementId;}else{Bl.gbUnits=Bm.gbUnits;}this.sendBrowserInfo=true;this.submitUpdates(Bl,Bn,{config:Bk,style:{params:{treesToRender:3}}});},setOutlineExpanding:function Y(Bo,Bp){var Bm=[],Bn=Bo.xtab,Bl=Bn.node,Bk=function(Bq){return{act:"updateTemplate",keyContext:Bq,actions:[{act:"setOutlineExpanding",prs:"Template Formatting",pr:"OutlineLevelExpanding",v:Bo.outlineLevel}]};};Bh.forEachGSI(Bn.gridInfo,function(Bq,Br){Bm=Bm.concat(Bk(Br));},Bl.k||Bl.data.k);this.submitUpdates(Bm,Bp,Ag.copy(mstrmojo.DocDataService.RAPID_EXEC,{config:{silent:true},style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}}));},retrieveServerJson:function AM(Bm,Bu,Bn){if(mstrApp.isExpress&&!mstrApp.optimizeFitToPage&&BI.call(this,this.model.zt)){return ;}var Bs={},Bk,Bl,Bq;var Br=Bm.nodes;if(Br){Bs.partialRetrieval=Br;}var Bt=Bm.slices;if(Bt){Bs.slices=Bt;}if(Bn){Bk=Bn.style;Bl=Bn.config;Bq=Bn.params;}if(!Bl){Bl={showProgress:true,hideProgress:true,progressStateText:a};}var Bv=Bm.style=Ag.clone(this.defaultStyle),Bp=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();AX(Bk.params,Bv.params);var Bo={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,excludeData:!!(Bp||mstrConfig.resolveOnly),params:JSON.stringify(Bs),treesToRender:Bv.params.treesToRender};AX(Bq,Bo);Bl.preserveUndo=(Bn&&Bn.preserveUndo)||false;An.call(this,Bo,Bu,Bl);},downloadGridData:function BK(Bn,Bo){var Bm={act:"gridIncrementalFetch",nodeKey:Bn.nodeKey,rowPosition:Bn.rowPosition,maxRows:Bn.maxRows,colPosition:Bn.colPosition,sliceId:Bn.sliceId,maxColumns:Bn.maxColumns,rowMode:Bn.rowMode||1,partialRetrieval:this.newRetrievalKeysConfig().addNode(Bn.nodeKey)};if(Bn.partialUpdate){Bm.partialUpdate=Bn.partialUpdate;}var Bl=mstrmojo.all[Bn.xtabId],Bk=Bl&&Bl.isCustomSort;this.submitUpdates(Bm,Bo,Ag.copy(Ak(),{noUpdate:true,preserveStid:Bk,config:{silent:true}}));},txMarkRows:function Z(Bk,Bl){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionMarkRow(Bk.nodeKey,Bk.sliceId,Bk.rowOrdinal,Bk.actionType);}else{An.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:Bk.nodeKey,sliceId:Bk.sliceId,rowOrdinal:Bk.rowOrdinal,actionType:Bk.actionType},Bl);}},txChangeData:function z(Bk,Bl){if(mstrApp&&mstrApp.isNativeAndroid){mstrMobileTransport.applyTransactionDataChange(Bk.nodeKey,Bk.sliceId,JSON.stringify(Bk.cells),Bk.autoRefresh);}else{An.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:Bk.nodeKey,sliceId:Bk.sliceId,cells:Bk.cells,autoRefresh:Bk.autoRefresh},Bl);}},sendTransactionActions:function BF(Bl,Bm){var Bk={taskId:"DocTransaction",rwb:this.rwb,keyContext:Bl.keyContext,actions:Bl.actions,messageID:this.msgId};if(Bl.txrcd){Bk.isPending=Bl.txrcd.pending;Bk.timestamp=Bl.txrcd.timestamp;}if(mstrApp.isExpress&&(this.model.zt===1||this.model.zt===2)){BP.call(this,Bk);}An.call(this,Bk,Bm,{silent:!!Bm});},newUpdate:function Al(Bm,Bl){var Bk=new mstrmojo.DocDataService.Update(Bl);Bk.ds=this;Bk.cmd=Bm;return Bk;},newUpdateWithoutCmd:function Aa(Bl){var Bk=new mstrmojo.DocDataService.Update(Bl);Bk.ds=this;return Bk;},newRetrievalKeysConfig:function b(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function BJ(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function BR(Bl,Bk){this.newUpdate(Bl,Bk).submit();},submitUpdates:function e(Bt,Bz,Bq){Bt=Bi(Bt);if(mstrApp.isVI&&!mstrApp.isDossier&&this.model.controller.isDatasetPanelRefreshAction(Bt)){Bz=o.wrapMethods(this.model.getDatasetsUpdateCallback(),Bz);}this.cleanFormatLayoutXML(Bt);var Bp={actions:Bt},Bk,Bn,Bw,Bm=false;BS.forEach(Bt,function Bs(B1){if(B1.disablePU){Bm=true;delete B1.disablePU;}BS.forEach(B1.actions,Bs);return !Bm;});if(!Bm){var Bl=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(Bt),By=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(Bt);if(!Ag.isEmpty(Bl)){Bp.partialRetrieval=Bl;}if(!Ag.isEmpty(By)){Bp.partialUpdate=By;}}if(Bq){Bk=Bq.style;Bn=Bq.config;Bw=Bq.params;}if(!Bn){Bn={showProgress:true,hideProgress:true,progressStateText:a};}if(!Bk){Bp.style=this.defaultStyle;}else{var B0=Bp.style=Ag.clone(this.defaultStyle);AX(Bk.params,B0.params);}Bp.style.name=(Bk&&Bk.name)||mstrApp.styleName;var Br={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(Bp)};Bw=BP.call(this,Bw);AX(Bw,Br);Bn.preserveUndo=(Bq&&Bq.noUpdate)||false;Bn.preserveStid=(Bq&&Bq.preserveStid)||false;var Bv=this,Bx=true,Bo=o.override({success:function(B1,B2){if(B1.status===2){Bx=false;Bv.submitUpdates([],Bz,Bq);}else{Bx=true;return this._super(B1,B2);}},complete:function(){if(this._super&&Bx){this._super();}}},AX(Bz));if(!(Bq&&Bq.hideCancel)){Bn.waitBoxCfg=Ag.copy({showCancel:true},Bn.waitBoxCfg);}if(Bq&&Bq.message){Bn.waitBoxCfg=Ag.copy({message:Bq.message},Bn.waitBoxCfg);}var Bu=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(Bq&&Bq.resolveOnly!==undefined){Br.resolveOnly=Bq.resolveOnly;}else{if(Bu){Br.resolveOnly=true;}}if(Bq&&Bq.excludeData!==undefined){Br.excludeData=Bq.excludeData;}else{if(Bu){Br.excludeData=true;}}if(Bq&&Bq.noDeltaXML!==undefined){Br.noDeltaXML=Bq.noDeltaXML;}if(Br.resolveOnly&&Br.excludeData){mstrApp.enableUpdate=true;}An.call(this,Br,Bo,Bn);},submitTemplateUpdates:function C(Bk,Bm,Bn,Bl){this.submitUpdates(this.getUpdateTemplateAction(Bk,Bm),Bn,Bl);},getUpdateTemplateAction:function Bc(Bk,Bn,Bl,Bm){return{act:"updateTemplate",keyContext:Bk,partialRetrieval:this.newRetrievalKeysConfig().addNode(Bm||Bk,Bl),partialUpdate:{selectors:Bn.selectors},actions:Bi(Bn)};},addUpdateTemplateAction:function t(Bm,Bk,Bl){Bm.addActions(this.getUpdateTemplateAction(Bk,Bl));},applySegment:function Bj(Bl,Bk,Bm){An.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:Bl,nodeKey:Bk},Bm);},getPageByTree:function m(Bk){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},Bk);},getUserDICubeInfo:function BB(Bk,Bl){An.call(this,{taskId:"getUserDICubeInfo",cubeIds:Bk.join(",")},Bl);},applySorts:function AT(Bl,Bm,Bk,Bn){An.call(this,{taskId:"applySorts",key:Bl,sortType:Bm,sortList:Bk},Bn,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function AU(Bl){var Bk=this;return function(Bo){var Bp=Bk.model,Bn=Bp.controller,Bm=Ag.copy(Bo,Bl),Bq=[A3.call(Bk,Bm,true)],Br=Bp.getDatasetsUpdateCallback();if((Bm.mptf||{}).dirty||this.enablePTO){Bq.push(At(Bm));}Bn.submitUndoRedoUpdates(Bq,null,Br,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function BU(Bl){var Bk=this;return function(Bp){var Br=Bk.model,Bt=Br.controller,Bu=Ag.copy(Bp,Bl),Bs=Bu.nodeKey,Bx=Bu.host.model,Bv=Bu.idx,Bo=[],Bw=o.wrapMethods(Br.getDatasetsUpdateCallback(),Bt._getXtabCallback(Bu.host)),Bq,Bn=function(By){Bo.push(Bk.getUpdateTemplateAction(By,[Bx.getRemoveTemplateUnitAction({did:Bu.replace.did,t:Bu.replace.t})]));},Bm=function(By){var Bz=Bk.getUpdateTemplateAction(By,[Bx.getAddTemplateUnitAction({did:w,t:4},Bu.dsid,Bu.zoneid,Bv,Bu.setIdx)],null,Bu.retrieveKey);Bz.actions.push(Bx.getValuesDefaultFormatGridZoneAction([{did:w}],true));Bo.push(Bz);};Bo.push(A3.call(Bk,Bu,true));if((Bu.mptf||{}).dirty||this.enablePTO){Bo.push(At(Bu,true));}if(Bu.replace){if(BS.isArray(Bs)){for(Bq=0;Bq<Bs.length;Bq++){Bn(Bs[Bq]);}}else{Bn(Bs);}}else{Bv++;}if(BS.isArray(Bs)){for(Bq=0;Bq<Bs.length;Bq++){Bm(Bs[Bq]);}}else{Bm(Bs);}Bt.submitUndoRedoUpdates(Bo,null,Bw);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function c(Bl){var Bk=this;return function(Br){var Bs=Bk.model,Bt=Bs.controller,Bv=Ag.copy(Br,Bl),Bx=Bv.host.zonesModel,By=Bv.idx,Bq=[],Bp,Bm=[],Bw={id:Bv.zoneid},Bu={did:w,t:4},Bz=o.wrapMethods(Bs.getDatasetsUpdateCallback(),Bt._getXtabCallback(Bv.host));Bq.push(A3.call(Bk,Bv,true));if((Bv.mptf||{}).dirty||this.enablePTO){Bq.push(At(Bv));}if(Bv.replace){var Bo={did:Bv.replace.did,t:Bv.replace.t};Array.prototype.push.apply(Bm,Bx.getRemoveDropZoneUnitActions(Bw,Bo));}else{By++;}Bm.push(Bx.getAddDropZoneUnitAction(Bw,Bu,By,{datasetId:Bv.dsid}));if(Bv.extraZone){Bm.push(Bx.getAddDropZoneUnitAction({id:Bv.extraZone.id},Bu,Bv.extraZone.idx,{datasetId:Bv.dsid}));}if(!Bv.replace){var Bn=(Bl.zoneid===4)?1:2;Bp=Bx.getAddMetricNameAction(Bl.host,Bn);if(Bp){Bq.push(Bp);}}if(!Bv.replace&&Bx.gmZones){Bp=Bx.gmZones.getUpdateGroupInfoActionForNewMetric(Bl.zoneid,By,true);if(Bp){Bq.push(Bp);}}Bx.checkAndAddThresholdAction(Bv.zoneid,Bu,Bm);Bq.push(Bk.getUpdateTemplateAction(Bv.nodeKey,Bm));Bt.submitUndoRedoUpdates(Bq,null,Bz);};},getEditDerivedMetricSubmitFunc:function h(Bl){var Bk=this;return function(Bn){var Bo=Bk.model,Bq=Bo.controller,Bs=Ag.copy(Bn,Bl),Bp=Bl.nodeKey,Bu=Bl.retrieveKey,Bt={act:"editDM",formula:Bs.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(Bs.tokenStreamXML),afb:Bl.afb,sfb:Bl.sfb,dsid:Bs.dsid||"",did:Bs.did,dsc:Bs.dsc},Bm=[Bo.addUpdateObjects(Bt,{id:Bs.did,type:B.Metric,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],Bv=o.wrapMethods(Bo.getDatasetsUpdateCallback(),Bq.getPartialUpdateCallback()),Br=function(Bw){Bm.push(Bk.getUpdateTemplateAction(Bw,[{act:"renameUnit",id:Bs.did,type:B.Metric,name:Bs.alias,isDynamicAlias:false}],null,Bu));};if(mstrApp.isSingleTier&&Bl.originTokenStream){Bt.originFormula=Bl.originTokenStream;Bt.originAfb=Bl.originAfb;Bt.originSfb=Bl.originSfb;}if((Bs.mptf||{}).dirty){Bm.push(At(Bs));}if(Bp){if(BS.isArray(Bp)){BS.forEach(Bp,Br);}else{Br(Bp);}}else{Bt.name=Bs.alias;}Bq.submitUndoRedoUpdates(Bm,null,Bv,{style:{params:{treesToRender:mstrmojo.DocDataService.EnumTreesToRender.BOTH}}});};},resetSelections:function G(Bl,Bk,Bm){An.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:Bl||"",usePartDisplay:Bk?"0":"1",treesToRender:Bk?3:2},Bm);},setPreference:function A5(Bk,Bl){An.call(this,{taskId:"setPreference",prefs:Bk},Bl);},getObjectInfo:function BO(Bk,Bl){An.call(this,AX(Bk,{taskId:"getObjectInfo"}),Bl,Ak());},addSuppressData:function Ap(Bk){if(BY(Bk)===mstrmojo.DocDataService.EnumTreesToRender.NONE){Ag.copy({params:{suppressData:true}},Bk);}},uploadImageToServer:function(Bm,Bn){var Bl={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:Bm.fieldKey,fieldName:Bm.fieldName,imageName:encodeURIComponent(Bm.imageName),imageSize:Bm.imageSize,nodeKey:Bm.nodeKey,sectionKey:Bm.sectionKey,msgID:this.msgId||""};if(mstrApp.isSingleTier){var Bk=";base64,";Bl.rwNodeKey=Bm.fieldGroupKey;Bl.imageData=Bm.base64Str.split(Bk)[1]||Bm.base64Str;mstrApp.serverRequest(Bl,Bn);}else{Bl.imageData=Bm.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,Bn,Bl);}},cleanFormatLayoutXML:function Ay(Bk){BS.forEach(Bk,function(Bn){if(Bn.act==="format"){var Bm=Ag.walk("format.FormattingSize.LayoutXML",Bn),Bl=function(Bo){BS.forEach(Bo,function(Bp){Bl(Bp.children||[]);Bl(Bp.floatChildren||[]);delete Bp.id;});return Bo;};Bl(Bm&&Bm.children||[]);Bl(Bm&&Bm.floatChildren||[]);}});}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Bf(Bk){AX(Bk,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function A2(Bk){this.actions=this.actions.concat(Bi(Bk));},addCallbacks:function Aq(Bk){this.callback=o.wrapMethods(this.callback,Bk);},addExtras:function AF(Bl){var Bk=BY(Bl),Bm=BY(this.extras);this.extras=AX(Bl,this.extras);if(Bk!==undefined&&Bm!==undefined){this.extras.style.params.treesToRender|=Bm;}},addUpdate:function AC(Bk){this.add(Bk.actions,Bk.callback,Bk.extras);},setTreesToRender:function E(Bk){if(Bk){this.addExtras({style:{params:{treesToRender:Bk}}});}return this.extras.style.params.treesToRender;},add:function p(Bl,Bm,Bk){if(Bl){this.addActions(Bl);}if(Bm){this.addCallbacks(Bm);}if(Bk){this.addExtras(Bk);}},submit:function As(){var Bl=this.actions,Bm=this.callback,Bk=this.extras;if(this.cmd){this.cmd.submit(Bl,Bm,Bk);}else{this.ds.submitUpdates(Bl,Bm,Bk);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:a,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.RAPID_EXEC={params:{suppressData:true,rapidExec:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSBaseFormType");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone {@cssClass}" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}},init:function(A){if(mstrmojo.dom.isIE||mstrmojo.dom.isIEW3C){A.cssClass=mstrmojo.string.trim(A.cssClass||" ie");}this._super(A);}});}());(function(){var Q=mstrmojo.models.template.DataInterface,P=mstrmojo.chart.model.enums.EnumDSSBaseFormType,G=mstrmojo.mstr.EnumDSSXMLObjectTypes,L=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,H=1,B=2;mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function O(R){mstrmojo.hash.copy(R,this);},initContent:function F(W){this.startIndexInContainer=W||this.startIndexInContainer||0;var U=this.base||[],R=U.show||this.needRC,S=U.items;this.rc=R&&S?S.length:0;this.colWidths=(R&&U.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function C(S,R){return !this.invalidData;},download:function A(U,S,R){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,R);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function D(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function N(){return this.rc;},getUpdatedRows:function K(){return this.updatedRows;},getRowCells:function(n,S){var c=this.base||[],AB=c.items||[],u=AB[n]||[],d=u.items,p=this.lookupBase,Y=this.interactiveCellsArray,AF=this.gridData,b=AF.css,f=Q.getGSI(AF.gsi),x=!!AF.stitchSectionKey,AA=f&&f.prop&&f.prop.cols&&f.prop.cols.mg,AD=null,AC,s,t,Z,z,i,w,U,l,m,q="-1";if(this.oldGridData){AC=this.oldBase;s=AC&&AC.items;t=s[n]&&s[n].items;}for(z=0,Z=(d&&d.length)||0;z<Z;z++){i=d[z];if(i){i.v=i.v||i.n;if(p&&!i._e){w=p[i.tui];U=i.fi;l=(w&&w.fs)||[];m=l[U]||l[0];i.ts=i.ts||m&&m.bftp;if((m&&m.n==="DYNAMICLINK")||(i.ts===P.DssBaseFormHTMLTag&&w&&w.ost===L.DerivedAttribute)){i.isDynamicLink=true;}else{if(w&&w.otp===G.Consolidation&&w.ost===L.ConsolidationManaged){i.id=w.id;i.isNDE=true;}}AD=w&&w.es[i.idx];if(AD){i.v=i.v||AD.n;if(AD.rv){i.rv=AD.rv;}if(AD.isObjHeader){i.isObjHeader=AD.isObjHeader;}i._e=AD;}}if(!i.css){var g=i.cni;if(g!==undefined){i.css=b[g].n;}else{i.css="";}}if(!i._d&&t&&this.preServeUpdatedRows){var W=t[z];if(!W||(W.rs!==i.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((W.v&&i.v!==W.v)){var AE={};if(i.v!==W.v){AE.v=W.v;}if(i.css!==W.css){AE.css=W.css;}i._d=AE;this.updatedRows[this.startIndexInContainer+n]=true;}}}i._gd=this.gridData._bidx||0;if(Y){if(!S&&(i._ei===undefined||Y[i._ei]!==i)){i._ei=Y.push(i)-1;}}if(this.axis){i.axis=this.axis;}var h=i.pi,o=function o(AI,AG,e){var AH=AI&&AI[AG];return AH&&AH.es[e];},y=function y(AK,AH,AL,AG,AJ){var AI=AK.items[AH],e=AI&&AI.items[AL];if(e){e.axis=e.axis||AG;if(e._e===undefined){e._e=o(AK.show?p:AJ,e.tui,e.idx);}}return e;};if(h){if(h.ri!==undefined&&h.ci!==undefined){if(i.axis===2&&AA!==q&&!x){i._p=AB[h.ri].items[z];}else{i._p=AB[h.ri].items[h.ci];}}else{var k=this.gridData.ghs.rhs,a=this instanceof mstrmojo.XtabOnDemandCP?this.dataSource.gridData.ghs.chs:this.gridData.ghs.chs,R=this.gridData.gts,X=h.left,j=h.top;if(X){i._lp=y(k,X.ri,X.ci,H,R.row);}if(j){i._tp=y(a,j.ri,j.ci,B,R.col);}}}}}return d;},getUnmergedCells:function I(Y){var a=[],b=(this.base&&this.base.items)||[];if(Y>b.length-1||Y<0){return a;}var U=this.gridData.css,Z=b[Y].items[0],S=Z&&Z.pi,R=S&&S.ri,X=S&&S.ci;while(S&&R>-1&&X>-1){Z=Z._p||b[R].items[X];var W={};mstrmojo.hash.copy(Z,W);if(!W.css){W.css=U[W.cni].n;}W.rs=Z.rs-Y+R;a.splice(0,0,W);S=Z&&Z.pi;R=S&&S.ri;X=S&&S.ci;}return a;},getIndentPadding:function M(R){return R*14;},getCell:function J(R,S){var U=this.base.items;return U[R].items[S];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var K=0,L=this.cps[K],M;while(J>=L.rc){J-=L.rc;L=this.cps[++K];}if(this.renderingNewPage){L.updateCounter=0;this.renderingNewPage=false;}M=L.getRowCells(J,I);this.updateCounter=L.updateCounter;return M;},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(J,I){var N=this.cps,K=[],H=N.length,M;for(M=0;M<H;M++){if(N[M].getAvailableRowsCount()>0&&N[M].rc>J){var L=N[M].getRowCells(J,I);if(L){K=K.concat(L);}}}return K;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){var D=4,A=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.XtabLevelHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.XtabLevelHACP",allCells:[],updateCounter:0,pageNum:0,getEmptyCell:function C(E,F,H){var G={css:E.css.replace(" hl",""),v:"",fillerCell:true};if(F){G.cs=this.headerCells[H].cs||1;}return G;},getCellDepth:function B(E){var G=E.dpt||1,F=E.ui;if(!E.dpt){E=E._p;while(E){if(E.dpt){G+=E.dpt;break;}if(E.ui!==F||this.origHeaderCells[E.tui].otp===A.Filter){F=E.ui;G++;}E=E._p;}}return G;},getUnmergedCells:function(E){return ;},getRowCells:function(X){var P=this.cps,J=[],h=P.length,M=false,n=this.gridData,Q=(n&&n.lvlepd)||-1,U=this.outlineState,I=this.allCells,f,e,d,G,F,o,c=0,L=-10;o=this.updateCounter;X-=o;if(I.length>0){return I.splice(0,1)[0];}var S=function(t){var u=t.gridData||(t.cps[0]&&t.cps[0].gridData),x=(u&&u.gts.row),k=(x&&x.length)||0,j=[],s=0,y="",q=0,w,p;j[0]=0;for(p=0;p<k;p++){w=x[p];if(y!==w.id){j[q]=s;q++;y=w.id;s+=w.cs||1;}else{s++;}}this.columnAdjuster=j;this.unmergedHeaderCellCount=s;};var Z=function(t){var u=t.gridData||(t.cps[0]&&t.cps[0].gridData),x=(u&&u.gts.row),p=(x&&x.length)||0,w,j,s,k=false,q;this.headerCells=w=mstrmojo.hash.clone(x);this.origHeaderCells=x;for(q=0;q<w.length;q++){s=w[q];if(s.cs>1&&s.otp===A.Filter){for(e=1;e<s.cs;e++){j=this.getEmptyCell(s,false);j.otp=s.otp;w.splice(q+1,0,j);}s.cs=1;}if(s.cs>1){k=true;}}for(q=w.length-1;q>0;q--){if(w[q].id&&w[q].id===w[q-1].id){w.splice(q,1);}}p=w.length;this.maxLevel=u.maxLevel=p;this.gridData=u;return k;};var H=function(s){var j,q,k,p;for(p=s.length-1;p>0;p--){q=s[p-1];j=s[p];if(j.ui===q.ui&&this.origHeaderCells[j.tui].otp!==A.Filter){if(j.v&&j.v!==""){if(j.ts===D){if(j.v.indexOf("#srcstart")===0){k=j.v;}else{k="#srcstart"+j.v+"#srcend";}if(q.ts!==D){k=q.v+" "+k;}else{k="#srcstart"+q.v+"#srcend "+k;}q.v=k;}else{if(q.ts===D){q.v="#srcstart"+q.v+"#srcend "+j.v;}else{q.v+=" "+j.v;}}j.v="";}s.splice(p,1);}}return s;};var m=function(p){var k=this.headerCells,s=k.length,j=k[p].cs?(k[p].cs-1):0;var q=0;for(q=p+1;q<k.length;q++){j+=k[q].cs?(k[q].cs-1):0;}return j;};var E=function(p){var k=p.gridData||(p.cps[0]&&p.cps[0].gridData),i=k.gts,j=false;if(i.col.length===0){j=true;}else{j=i.rec;}return j?0:1;};for(f=0;f<h;f++){if(P[f].getAvailableRowsCount()>0&&P[f].rc>X){var K=P[f].getRowCells(X),N=mstrmojo.hash.clone(K.slice(0));if(P[f].type===4){if(X===0){this.hasMultiFormAttributes=Z.call(this,P[f]);this.metricAdjuster=E(P[f]);S.call(this,P[f]);if(Q===-1){Q=this.gridData&&this.gridData.lvlepd;}}if(this.hasMultiFormAttributes){N=H.call(this,N);}var l,g=0;if(mstrApp.isVI){for(e=0;e<K.length;e++){l=K[e];if(l.stt&&(l.idx<0||(!l._e||l._e.n))){continue;}g=this.getCellDepth(K[e])-1;l.colIx=this.columnAdjuster[g];}}var R=N.length;for(d=R-1;d>=0;d--){G=N[d];var b=this.getCellDepth(G);if(d===0){for(e=1;e<b;e++){N.splice(e-1,0,this.getEmptyCell(G,this.hasMultiFormAttributes,e-1));}}else{if(G.stt&&G.idx<0){N.splice(d,1);continue;}else{if(G.stt===1&&(!G._e||G._e.n)){N.splice(d,1);F=N[d-1];if(G._e&&G.hst&&G.hst!==L&&F&&F._e&&F.v===F._e.n){F.v+=" ("+G._e.n+")";}continue;}else{var W=[];N.splice(d,1);for(e=1;e<b;e++){W.push(this.getEmptyCell(G,this.hasMultiFormAttributes,e-1));}W.push(G);I.splice(0,0,W);M=true;o++;this.rc++;}}}G.rs=1;G.outLvl=b;if(U&&U.collapseToLevel){if(b<=U.collapseToLevel){if(b<U.collapseToLevel||!U.isExpanding){delete U.collapseToLevel;I.forEach(function(i){i.forEach(function(j){if(!j.fillerCell&&j._ei){delete U[j._ei];j.epd=false;j.hidden=false;}});});}else{if(U.isExpanding){U.hasTBodyElementsToExpand=true;}U[G._ei]={expanded:false,hidden:true};}}else{U[G._ei]={expanded:false,hidden:true};}}if(U&&U[G._ei]!==undefined){G.epd=!(U[G._ei].expanded);G.hidden=U[G._ei].hidden;}else{G.epd=Q>0&&Q<=b;G.hidden=false;}if(this.hasMultiFormAttributes){c=m.call(this,b-1);}if((c||this.metricAdjuster)&&b===this.maxLevel){G.isLeaf=true;}G.cs=R>1?(R-d+c+this.metricAdjuster):(R+c+this.metricAdjuster);}this.updateCounter=o;}else{if(mstrApp.isVI){for(e=0;e<K.length;e++){K[e].colIx=this.unmergedHeaderCellCount+e;}}if(M){var Y=I.length-1,O=I[Y],a;I[Y]=O.concat(N);for(e=0;e<Y;e++){O=I[e];a=O[0];for(d=0;d<N.length;d++){O.push(this.getEmptyCell(a||N[d]));}}a=J[J.length-1];for(d=0;d<N.length;d++){J.push(this.getEmptyCell(a||N[d]));}continue;}}if(N){J=J.concat(N);}}}return J;}});}());(function(){var I=-1,K=mstrmojo.mstr.EnumDSSXMLObjectTypes;function G(Q){var P=0;for(P=0;P<Q.length;P++){if(Q[P].otp===-1){return true;}}return false;}function H(P){var Q=[],U,S,R;for(R=P.length-1;R>0;R--){U=P[R];S=P[R-1];if(U.id===S.id){P.splice(R,1);if(S.v===S.n){S.v+=" | "+U.v;S.cs=(S.cs||1)+(U.cs||1);}}}return P;}function C(P){return P.gts.col.length>0&&P.gts.rec===false;}mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function O(P){this._super(P);},download:function A(R,Q,P){},shouldClonedLastTitleCell:function N(){return(this.gridData.lhv!==0);},updateMetricsLabel:function D(P){if(mstrApp.isVI&&P.otp===I){var Q=this.showMetricsLabel?mstrmojo.desc(3582,"Metrics"):"";P.n=Q;if(P.v){P.v=Q;}}},initContent:function J(Z){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var Q=this.gridData.gts,S=Q.row||[],P=Q.col||[],b=Q.show,Y=Q.rec,h=this.cts||[],g=S.length,a=h.length,e=this.gridData.css;this.base={items:[]};this.rc=(b&&h.length)||0;if(this.rc===0&&b){this.rc=g>0?1:0;}this.colWidths=(b&&Q.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var W={items:[]},c=0,R=1,d,f,k=this,U=k.base.items,j=function(i,l){if(k.shouldClonedLastTitleCell()&&l>1){i.rs=1;d=mstrmojo.hash.clone(i,{});d.n="&nbsp;";i.cni=e.push({n:(e[i.cni].n||"")+" fsbp_1"})-1;}},X=function(m){var i=m;while(i-->1){if(k.shouldClonedLastTitleCell()){var l=mstrmojo.hash.clone(d,{});l.cni=e.push({n:(e[l.cni].n||"")+" fsbp_"+((i==1)?"3":"2")})-1;U.push({items:[l]});}else{U.push({items:[]});}}};for(f=0;f<g;++f){this.updateMetricsLabel(S[f]);S[f].axis=1;S[f].ui=f;c+=S[f].cs||1;W.items.push(S[f]);}if(a>0){this.updateMetricsLabel(h[0]);h[0].axis=2;h[0].ui=0;P[0].axis=2;P[0].ui=0;R=h[0].rs||1;j(h[0],R);c+=h[0].cs||1;W.items.push(h[0]);}U.push(W);for(f=1;f<a;++f){this.updateMetricsLabel(h[f]);if(R>1){X(R);}h[f].axis=2;h[f].ui=f;P[f].axis=2;P[f].ui=f;R=h[f].rs||1;j(h[f],R);U.push({items:[h[f]]});}this.rc=U.length;this.nRowSpan=this.rc+R-1;this.nColSpan=c;if(Y){this._removeExtraColumn(S,h);}},getAvailableRowsCount:function L(){return this.rc;},getSpanDimension:function M(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function B(Q,P){return true;},getRowCells:function F(X){var a=this._super(X),W=this.gridData;if(W.olm&&!(W.rw&&W.rw.row.bc>0)&&!(this.dataSource&&this.dataSource.defn.txi)){a=H(a);var R=0,Q=0,P,Z,S=1;a=mstrmojo.hash.clone(a);for(R=0;R<a.length;R++){Z=a[R];if(Z.axis===1&&Z.cs>1&&Z.otp===K.Filter&&((Z.rs||1)>=S)){S=Z.rs||1;for(Q=1;Q<Z.cs;Q++){P={};P.css=Z.css.replace(" hl","");P.v="&nbsp;";if(Z.rs){P.rs=Z.rs;}a.splice(R+1,0,P);}Z.cs=1;}}var Y=C(W),U=Y?a.length-1:a.length;for(R=0;R<U-1;R++){a[R].expandLevel=R+1;}}return a;},_removeExtraColumn:function E(S,m){var k=S&&S.length,Z=m&&m.length,P=this.gridData.gts,c=P.row||[],X=P.col||[],Q=c.length,g=X.length;if(!k||!Z){if(Z===1){var n=m[Z-1];if(n.otp==-1){if(g>0){X[g-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var R=S[k-1],d=this.rc,U=this.base.items;if(R){if(R.otp==-1){if(Q>0){c[Q-1]._hid=true;}if(this.nColSpan){this.nColSpan-=R.cs||1;}U[0].items.splice(k-1,1);}else{var a=d>1?d-1:0,b=U[a],l=b.items.length;if(l>0&&g>0){X[g-1]._hid=true;}var W=R.fix;if(W){var h;for(h=0;h<W;h++){b.items[l-1+h]=S[k-W+h];}}else{b.items[l-1]=R;}for(var f=0,e=Z-1;f<e;f++){m[f].cs=W?W:R.cs;}var Y=W?W:1;U[0].items.splice(k-Y,Y);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.MultiXtabTitlesCP=mstrmojo.declare(mstrmojo.XtabTitlesCP,null,{scriptClass:"mstrmojo.MultiXtabTitlesCP",initContent:function A(C){this.startIndexInContainer=0;var J=this.gridData,B=J.gts,H=B.row||[],K=H.length,D=J.ghs,I=B.show||(this.needRC&&D.rhs.show),L=D.chs.items.length;this.base={items:[]};this.rc=(I&&L)||0;if(this.rc===0&&I){this.rc=K>0?1:0;}this.colWidths=(I&&B.cws)||[];if(this.needRC&&this.colWidths.length===1&&!H.length){this.colWidths=[];}if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var M={items:[]},E=0,G,F=this.base.items;for(G=0;G<K;++G){this.updateMetricsLabel(H[G]);H[G].axis=1;H[G].ui=G;H[G].rs=this.rc;E+=H[G].cs||1;M.items.push(H[G]);}F.push(M);this.rc=F.length;this.nRowSpan=Math.max(this.rc,L);this.nColSpan=E;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var c=1,g=2,o=4,Y=8,i=1,j=2,G=3,e=4,n=5,W=6,M=7,l=8,Z=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},U=mstrmojo.hash,X=mstrmojo.array;function b(u,s){var t=u[0],p=s.gts,q=p.cws.length;return(s.vp.gr==="1"&&(q>1));}function k(q,x){var u=function(y,z){if(z&&y&&y.css&&y.css.indexOf(z)<0){y.css+=" "+z;}};var t=x.type,s=x.col,w=(s&&s.cl)||0,p=(t===g||t===c);if(t===g||t===Y){u(q,J.RIGHT_ALIGN);}else{if(t===c||t===o){u(q,J.LEFT_ALIGN);}}if(p){if(s&&s.tg&&w>1){if(!q._v){q._v=q.v;q.v="<span class='toggleHeader'>"+q.v+"</span>";}}u(q,J.TITLE);}X.forEach(x.extraCss,function(y){u(q,y);});}function A(p){return 0;}function m(u){var s,t=u.cg,p=t&&t.cgc,q=1;for(s=0;s<p;s++){if(t&&t[s]&&!t[s].tg&&t[s].cl>q){q=t[s].cl;}}return q;}function N(q,p){var s=n;if(p===2){if(q===0){s=i;}else{if(q===1){s=e;}}}else{if(p>2){if(q===0){s=i;}else{if(q===1){s=j;}else{if(q===p-1){s=e;}else{if(q<p-1&&q>1){s=G;}}}}}}return s;}function L(p,u,s,q){var x=q&&q.cols&&q.cols.cg,t,y=0,w=0;if(x){for(t=0;t<u;t++){if(p[t]){y+=p[t].length;}}y+=(s+1);for(t=0;t<x.cgc;t++){w+=x[t].cl;if(w>=y){return t;}}}return -1;}function P(y,t,q,p){var x=[],w,s,u,z;for(s=0,u=y.length;s<u;s++){if(y[s].length===1){w=y[s][0];w.rowType=(w.rowType!==l)?N(t,q):l;w.singleStack=(q>1);w=U.copy(w);if(w.ts===I){if(q===1){w.rowType=n;w.colIdx=L(y,s,t,p);}else{if(!t){w.colIdx=L(y,s,t,p);}else{delete w.ts;w.v="";}}}else{if(t){w.v="";}}}else{w=y[s][t];if(!w){z=y[s].length;w=U.copy(y[s][z-1],{});w.v="";if(w.hasOwnProperty("ts")){delete w.ts;}}else{if(w.ts===I){w.colIdx=L(y,s,t,p);}}w.rowType=(w.rowType!==l)?N(t,q):l;}x.push(w);}return x;}function Q(p){if(p===0){return 0;}var q=this.sectionMap[p-1]||0;return Math.floor((p-q)/this.stackLevels);}function D(y){var w,x,u=this.sectionInfo,p=u.length,t=this.srh,q=this.lastSectionIndex;x=u[q];if(y>=x.rs&&y<(x.rs+t)){return x;}if(y<x.rs){w=q-1;if(w<=0){this.lastSectionIndex=0;return null;}do{x=u[w];if(y>x.rs&&y<=(x.rs+t)){this.lastSectionIndex=w;return x;}}while(y<x.rs&&--w>0);this.lastSectionIndex=w;return x;}else{w=q+1;if(w>=p){this.lastSectionIndex=p-1;return null;}do{x=u[w];if(y>x.rs&&y<=(x.rs+t)){this.lastSectionIndex=w;return x;}}while(y>(x.rs+t)&&++w<p);this.lastSectionIndex=w-1;return null;}}function f(z,s,p,y){var x=z[0],u,w=z.length,q=x&&x.rowType,t={v:"",css:"empty-igcell",rowType:q};if(p!==undefined&&x&&(q===i||q===n||q===W)){t={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+y+"px;top:-"+(0.5*F[q])+'px;"></div></div>',css:"IG-ActionArrow",_ei:p};}for(u=w-1;u>=w-s;u--){x=z&&z[u];if(x){x.css+=" IG-lastdatacolumn";}}z.push(t);}function S(AM,AH,s){var AD=AM.cols,AE=AD.cg,p=[{w:"0px"}];if(AD&&AH){var AN=AD.cws,q=[],AL=AN.length,AP=0,z=(parseInt(AM.ar,10)===1)?(AH/AL):-1,AC,t,AB=false,u=0,AF=AH,AG=0,AK;for(AK=0;AK<AL;AK++){t=q[AK]=AN[AK];AC=t.w;if(AC===""){AB=true;}else{if(t.xc){AP+=parseInt(AC);AF-=AP;u++;}else{AG+=parseFloat(AC,10);}}}if(AB||AG<100){z=AF/(AL-u);}for(AK=0;AK<AL;AK++){t=AN[AK];if(t.xc){continue;}else{if(z===-1){AC=parseInt(t.w,10)*AF/100;if(!AC&&AC!==0){AC=parseInt(AF/AE.cgc,10);}}else{AC=(parseInt(t.w,10)<0)?0:z;}}q[AK]={w:AC+"px"};}if(s){return q;}var AA=[],AJ=0;for(AK=0;AK<AL;AK++){var AO=AE[AK],y=AO.tg?AO.cl:1,AI=0;for(AI=0;AI<y;AI++){var x="0px";if(AI===AO.cc){x=q[AK].w;}AA[AJ+AI]={w:x};}AJ+=y;}return AA.concat(p);}else{if(s){return null;}else{return cp.cws.concat(p);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var AA=this.cps,z=this.cps[0],AF=Math.max(AA[0].rc,AA[1].rc);if(z.type!==c){var AK=this.gridData,AE=function(AN,AQ){var AM=AN.base.items,AO=AN.lookupBase[0].es,AP=AM[AQ].items[0],AL=AO&&AO[AP.idx];return(AL&&AL.n)||((AP.pi&&AO[AP.pi.ri||0])||"");},AI,AH,p=1,x,q,AC,t=0,s=-1,AD,AJ,AG=0,AB=this.groupEnabled;for(AD=0,AI=0,AJ=z.cps?z.cps.length:1;AD<AJ;AD++){var w=z.cps?z.cps[AD]:z,y=w.rc;t=s+1;s=t+y-1;if(w.isDataAvailable(t,s)){if(w.lastRow){AG=w.lastRow;q=w.lastSection;}else{AI=AG||0;for(AH=0,p=this.sectionMap[AI-1]||0;AH<y;AH++){var u=this.stackLevels;AC=AE(w,AH);if(AB&&AC!==q){q=AC;this.sectionInfo.push({sn:AC,rs:this.srh*p+this.stackedRh*Math.floor((AI-p)/this.stackLevels)});this.sectionMap[AI]=++p;AI++;}while(u){this.sectionMap[AI]=p;u--;AI++;}}AG=w.lastRow=AI;w.lastSection=AC;}}else{break;}}this.rc=(this.stackLevels>1?AF*this.stackLevels:AF)+(AB?p:0);}},onDemandDataReady:function d(){this.adjustCPMaps();},initContent:function a(AA){var z=this.cps,AL=this.gridData=z[0].gridData||z[0].cps[0].gridData,AH=AL.vp=this.gridVp=this.gridVp||AL.vp,s=AH.daf&&AH.daf.split(":"),AB=AH.cols,AC=AB.cg,AI=AB.cws,y=z[A(AC)],AF=AL.gts.row,q=AL.gts,AJ=b(z,AL),x=y.type!==c,AE,AG,u,p,AD,w,AK,t=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(t===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(t===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(t===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(t===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(x){if(AH.dafIdx===undefined&&s){for(AE=0;AE<AF.length;AE++){if(AF[AE].id===s[0]&&AF[AE].fid===s[1]){AH.dafIdx=AE;break;}}}}for(AE=0;AE<AC.cgc;AE++){if(AC[AE]&&AC[AE].tg){break;}}if(AE===AC.cgc){AL.gts.show=false;AL.ghs.chs.show=false;}this._super(AA);this.colWidths=S(AH,this.gridWidth);this.tdWidths=S(AH,this.gridWidth,true);if(x){this.stackLevels=m(AB);if(this.stackLevels>1){this.srh=F[M];this.rh=F[n];this.mrh=F[G];this.stackedRh=F[i]+(this.stackLevels-2)*F[j]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[n];}if(AJ||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AJ;this.adjustCPMaps();p=this.cps[0].cps;if(p){AK=this;for(AE=0,AG=p.length;AE<AG;AE++){w=p[AE];if(w&&w.addCPListener){w.addCPListener(AK);}}}}}},getUnmergedCells:function(p){return ;},getResolvedGroupHeader:function(s,u){var q=this.gridData,t=q.gts.row[u].es,p=q.ghs.rhs.items[s].items[u];if(p){if(!p.css){p.css=q.css[p.cni].n+" iggroup";p.n=t[p.idx].n;}}else{return{css:" iggroup",n:""};}return p;},getRowCells:function(AJ){var AE=this.cps,x=[],AX=this.gridData,AT=AX.vp,AH=AT.cols.cg,AC=AE[A(AH)],AG=this.groupEnabled,s=AT.bn==="1",AU=[],AI=Q.call(this,AJ),y,t,AK=1,AD,q,AA,AQ,AP,AS,AW,AB;if(AG&&(this.sectionMap[AJ]!==this.sectionMap[AJ-1])){var u=U.copy(AC.getRowCells(AI)[0],{});u.cs=this.colWidths.length;u.rowType=M;k(u,{col:null,type:AC.type,extraCss:[J.GROUPING]});return[u];}if(!AJ){C.call(this);}this.lastAttRow=this.lastAttRow||(AE[0].rc?AE[0].getRowCells(AI):[]);this.lastMtxRow=this.lastMtxRow||(AE[1].rc?AE[1].getRowCells(AI):[]);AA=this.lastAttRow;AS=AA.length;if(AS>0&&AA[0].stt){AD=true;for(AQ=0;AQ<AS;AQ++){AW=AA[AQ];if(AW.stt===R){q=AW;break;}}}if(!this.lastStackCols){X.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AQ=0;AQ<p.length;AQ++){if(p[AQ]._ei!==undefined){if(AT.dafIdx>=0){AB=AC.getRowCells(AI)[AT.dafIdx];}y=(AT.dafIdx>=0)?(AB&&AB._ei):"";return false;}}},this);var AO=function(p,AY){if(p&&(AY.type===c||AY.type===g)){if(AM.tg===false){p.n=p.v="";}p.rowType=l;}k(p,{col:AM,type:AY.type,extraCss:[((AY.type===Y||AY.type===o)&&s&&(AI%2===1))?J.BANDING:null,AD?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AT.dafIdx!==undefined){p._ei=y;}}};this.lastRowIndex=0;for(AP=0;AP<AH.cgc;AP++){var AM=AH[AP],AR=AM["mix"+AM.cc],w=AR!==undefined,z=AE[w?1:0],AN,AL,AF,AV={n:"",stt:R,css:"xtab-td"};arr=[];if(AM.tg){for(var AQ=0;AQ<AM.cl;AQ++){arr=[];AF=w?AM["mix"+AQ]:AM.attForms[AQ].idx;var AA=w?this.lastMtxRow:this.lastAttRow;AW=AA[AF];if(AD){if(!AW){AW=AV;}else{if(AW&&AW.stt===R){AW=U.copy(q,AV);}else{AW=U.copy(AW,{});}}}else{AW=U.copy(AW,{});}AO(AW,z);arr.push(AW);AU.push(arr);}if(AP+1===AH.cgc){AK=AM.cl;}}else{for(AN=0,AS=AM.cl;AN<AS;AN++){if(w){AL=AM["mix"+AN];if(AL!==undefined){AW=this.lastMtxRow[AL];}}else{AL=AM.attForms[AN];if(AL){AW=this.lastAttRow[AL.idx];}if(AD&&!AW){AW=AV;}}AO(AW,z);arr.push(AW);}AU.push(arr);}}this.lastStackCols=AU;}x=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AT);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return x;},getRowHeight:function E(q){var p=F[n];return F[q]||p;},getPadding:function K(p){return B[p]||B[Z];},isDataAvailable:function h(q,p){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var u=this.sectionMap.length,t;if(!u){return this.cps[1].isDataAvailable(q,p);}if(p>u){if(q<u){t=Q.call(this,q);return this.cps[1].isDataAvailable(t,t+(p-q));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,q),Q.call(this,p));}}},download:function H(x,t,y){var s=Q.call(this,x),p=s+Math.ceil((t-x)/this.stackLevels),u=this.cps[0],q,z,w=!u.cps?[u]:this.cps[0]._getCPs(s,p);for(q=0;q<w.length;++q){z=w[q];z.download(s,p,y);}},getRowCellInfo:function(t){var s=D.call(this,t+this.srh),p,q=this.lastSectionIndex;if(s){p=this.sectionInfo[q-1];return{rowStart:s.rs,isNextRowNewSection:true,sectionName:p&&p.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[q].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder","mstrmojo.models.template.DataInterface","mstrmojo.num","mstrmojo.util.XtabHelper","mstrmojo.EnumSubtotals");var o=mstrmojo.string,Y=mstrmojo.array,N=mstrmojo.hash,W=mstrmojo.expr.TP,k=mstrmojo.models.template.DataInterface,C=mstrmojo.util.XtabHelper,t=k.ENUM_ROW_ARRANGEMENT,E=k.ENUM_GRID_RESIZE,Z=mstrmojo.vi.viz.EnumDSSDropZones,D=mstrmojo.num,J=D.UNIT,d=k.ENUM_LOCKED_HEADERS,f=mstrmojo.EnumSubtotals.TYPES,L=f[0].v;var K=1;var a="%2E";var j=12;var P=function P(){return 1;};var M="@pLd",c={chartCfg:"chartCfg",colorTrend:"clr_trd"};function F(AZ,Ag,Af,Ai){var AB=this,AH=AB.agColumnDefs,AR=Ai.headerRowSpan,Ab=Ai.cellsToMerge,Aa=Ai.columnRowOffset,AY=AB.headers,w=AB.headerObjects,AD=AB.treeMap,AA=AB.titleZone,AC=Ai.isColumnsOnly,AW=Ag.v,AN=Ag.rv,Ad=Ag.isObjHeader,AK=Ag.axis,AM=Ag.cs,AI=Ag.hasOwnProperty("fi"),Ac=AK===Z.Columns,AS=AI&&Ac,Ae=AB.data.eg;var AE=o.decodeHtmlString(AW,true);if(Ad||Ac||Ag.otp===-1||AS){var AV=Ai.cellOffset,AJ=AB.getNewHeader(Ag,AE,Ai,AV,Ae),AF,AT,Ah,AX=function(Ak,Al){return Y.find(Ak,"field",Al.field)>-1||Y.some(Ak,function(Am){return Am.allFields&&Am.allFields[Al.field];});},AQ=AX(AH,AJ);if(Ag.pi){Ag.dpt=Ag.dpt||((Ag._p&&Ag._p.dpt||0)+1);Ag.colIx=AV;AT=Ai.curRow;Ah=AT;if(Ag.isNDE){if(AI){Aa[Ag.oi]=Ag.fi;}else{if(Ag.rs>1){Ah+=Ag.rs-1;Aa[Ag.oi]=Ag.rs-1;}}}AD[Ah]=AD[Ah]||{};AD[Ah][Ag.oi]=AD[Ah][Ag.oi]||AJ;if(Ag.pi.hasOwnProperty("ri")&&Ag.pi.hasOwnProperty("ci")){if(Ag.isNDE&&!AI){var z=Aa.hasOwnProperty(Ag.oi)?Aa[Ag.oi]:0;AF=AD[Ag.pi.ri+z][Ag.oi]||AD[Ag.pi.ri+z][Ag._p.o];delete Aa[Ag.oi];}else{AF=AD[Ag.pi.ri][Ag.oi]||AD[Ag.pi.ri][Ag._p.o];}}else{if(AT>0){AF=AD[AT-1][Ag.oi]||AD[AT-1][Ag._p.o];}}if(AF){AB.addToHeaderGroup(AF,AJ);}else{if(!AQ){AH.push(AJ);}}Ai.cellOffset=Ai.cellOffsetBase+Ag.oi;}else{AF=AA.length?AA[AA.length-1]:null;if(Ai.curRow&&AF){AB.addToHeaderGroup(AF,AJ);}else{if(!AQ){AH.push(AJ);if(AM>1){var AG,AU;for(var AP=1;AP<AM;AP++){AU=N.copy(Ag);AG=AB.getNewHeader(AU,AE,Ai,AV+AP,Ae);AG.headerName="";AG.field+="_"+AP;AG.headerComponentParams.fi=AP;AH.push(AG);AY[AV+AP]=AG.field;if(!w.hasOwnProperty(AG.field)){w[AG.field]=AG;}}}}}if(!AX(AA,AJ)){AA.push(AJ);}Ai.cellOffset=Ai.cellOffsetBase;Ai.cellOffsetBase+=AM||1;}if(!w.hasOwnProperty(AJ.field)){w[AJ.field]=AJ;}AY[Ai.cellOffset]=AJ.field;}else{if(AC){return false;}var y=AN!==undefined?AN:(AW!==undefined?AW:"");var u=!!Y.filterOne(Ab,function(Ak){if(!Ag._e||!Ak._e){return false;}return Ag._e.id===Ak._e.id;});if(u){y=" ";}var AL=AY[Ai.cellOffset],x=w[AL];if(AL&&x){AZ[AL]=y;if(Ai.isOutlineMode){if(!AZ.stt){if(Ag.stt){AZ.stt=AL;AZ.sttName=y;if(Ag.ui!==Ai.rowHeaderUnits-1){AZ[AL]=null;}}}else{if(Ag.axis===K){if(Ag.ui===Ai.rowHeaderUnits-1){AZ[AL]=AZ.sttName;}else{AZ[AL]=null;}}}}var AO=x.headerComponentParams;var Aj=AO.cellIndexMap;if(Aj){Aj[Ai.curRow-AR]=Af;}Ag.colIx=AO.colIdx;}else{Ag.colIx=Ai.cellOffset;}Ai.isHeaderRow=false;}if(Ag.rs>1||(x&&x.colSpan({data:AZ})>1)){Ai.rowsToRedraw[Ai.curRow]=true;}Ai.cellOffset+=AM||1;}function S(x,u,w){if("o" in x){x.oi=x.o;if(u&&x.o===w[u-1].o){x.oi=w[u-1].oi+1;}}}function i(w){var u={};Y.ensureArray(w).reduce(function(y,z,x){u[x]=y;return y+z.cols.length;},0);return u;}function p(z,y,AA){var x=k.getGSI(z,y),u=Y.hash(AA.attrId),w=-1;Y.forEach(x.cols,function(AC,AB){if(u[AC.did]||AC.t===W.METRIC){return false;}w=AB;});return w;}function A(w,u){return w.ui+(w.ui<=u?(";"+w.idx):"");}function h(AD,AI,w){var x=w.col,AF=[],AE={},AK=[],y="",u={};function AC(AM){if(!AM.children){var AN=AM.headerComponentParams,AL=AN.ui+w.attrFormsOffset;AF.push(AM.field);AK.push(AM.headerName);y=x[AL]&&x[AL].n;AE[AM.field]=AN.cellIndexMap;u[AM.field]=AN;return ;}Y.forEach(AM.children,function(AO){AC(AO);});}AC(AD);var AA=AD.headerComponentParams||AD.headerGroupComponentParams,AB=w.aggGroupHeader,AJ=AI||AD,AG=AA.ui+w.attrFormsOffset,AH=x[AG]||{},z=AH.es&&AH.es[AA.idx];AB.allFields=N.copy(AD.allFields,AB.allFields)||{};AB.allFields[AD.field]=true;AJ.chartCfg=w.setCfg;AJ.xaxisLabel=(AJ.xaxisLabel||[]).concat(AK);AJ.xaxisTitle=y;AJ.yaxisTitle=z&&z.n;AJ.xaxis=(AJ.xaxis||[]).concat(AF);AJ.cellIndexMap=N.copy(AE,(AJ.cellIndexMap||{}));AJ.aggHeaderComponentParams=N.copy(u,(AJ.aggHeaderComponentParams||{}));(AJ.headerComponentParams||AJ.headerGroupComponentParams).format=w.chartFormat||{};AD.headerName=AI.headerName;AD.cellRenderer=w.chartRenderer;AD.headerComponentParams=AD.headerComponentParams||AD.headerGroupComponentParams;delete AD.children;delete AD.headerGroupComponentParams;}function Q(x,w,AB,u){var AA=x.headerComponentParams||x.headerGroupComponentParams,y=A(AA,w);if(!AB.chdGroup){AB.chdGroup={};Y.forEach(AB.children,function(AG){var AF=AG.headerComponentParams||AG.headerGroupComponentParams,AE=A(AF,w);AB.chdGroup[AE]=AG;});}var AD=AB.chdGroup[y],z;if(!AD){AB.children.push(x);AB.chdGroup[y]=x;z=x;}else{var AC=AD.headerComponentParams||AD.headerGroupComponentParams;AC.format=u.chartFormat||{};z=AD;}if(AA.ui<=w){Y.forEach(x.children,function(AE){Q(AE,w,z,u);});}else{x.colSpan=P;h(x,z,u);}u.aggGroupHeader.allFields[x.field]=true;}function X(y,x,w){if(!y){return ;}Y.forEach(y.children,function(z){X(z,y,w);});if(!y.children&&!w.params){w.params=y.headerComponentParams;}if(x){y.headerName=x.headerName;if(x.headerGroupComponentParams||x.headerComponentParams){var u=(x.headerGroupComponentParams||x.headerComponentParams);if(y.hasOwnProperty("headerGroupComponentParams")){y.headerGroupComponentParams=u;}else{y.headerComponentParams=u;}}}}function B(u){Y.forEach(u,function(x,w){if(!x||x.startsWith(M)){u[w]=x;}else{u[w]=M+x;}});}function n(w,AA,y){var u=false;for(var x=0;x<w.length;x++){var AB=w[x];if(AB.stt){if(y){if(x>0&&AB.pi&&(AB.pi.hasOwnProperty("ri")||AB.pi.hasOwnProperty("ci"))){u=true;var z=w[x-1];if(AB._e&&AB.hst&&AB.hst!==L&&z&&z._e&&z.v===z._e.n){z.v+=" ("+AB._e.n+")";}}}break;}}AA.exclude=u;return AA;}mstrmojo.ag.models.template.AgDataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.ag.models.template.AgDataInterface",data:null,cp:null,agColumnDefs:[],agRows:[],headers:[],headerObjects:{},treeMap:{},titleZone:[],dataCache:{},init:function m(u){this.data=u.data;this.defn=u.defn;this.cp=u.cp;},nameToField:function s(u){if(!u){return u;}var x=u.split(/\s+/);var w=x.map(function(z,y){if(y===0){return z.toLowerCase();}else{return z.substr(0,1).toUpperCase()+z.substr(1).toLowerCase();}}).join("");w=encodeURIComponent(w).replace(".",a);return w;},addToHeaderGroup:function g(y,AA){var x=AA.field,u=!y.allFields||!y.allFields[x],w=y.field!==AA.field,z;AA.field=(y.field||"")+AA.field;if(u&&w){if("headerComponentParams" in y){y.headerGroupComponentParams=y.headerComponentParams;delete y.headerComponentParams;}if(!y.children){y.children=[];}y.children.push(AA);y.allFields=(y.allFields||{});y.allFields[x]=true;z=y.headerGroupComponentParams.colIdx;AA.headerComponentParams.colIdx=z;AA.headerComponentParams.mergedColIdx=z+y.children.length-1;}},getNewHeader:function b(AD,AC,x,AB,AL){var AF=this.data,AH=AF.gsi,u=x.dataInterface.getColumnSetIndexCellBelongsTo(AD),w=x.colWidths[AB],AK=k.getGSI(AH,u),AJ=AD.hasOwnProperty("mix"),AI,AG,z={rowArrangement:x.rowArrangement},AA=AD.axis===Z.Rows,y=AF.gts.row,AE=1;if(AJ){AI=AD.mix;AG=AK.mx[AI];z.mix=AI;z.min=AG.min;z.max=AG.max;}if(AA&&(AD.hasOwnProperty("ast")||x.hasSubtotalsInRows)){x.hasSubtotalsInRows=true;if(AD.hasOwnProperty("fix")&&y.length>1){AE=Y.filter(y,function(AM){return AM.id===AD.id;}).length;}else{if((AD.hasOwnProperty("fs")&&AD.fs.length>1)){AE=AD.cs||1;}}}w=w&&parseInt(w.w,10);return{headerName:AC,field:this.nameToField(AC+AD._ei),chartDataType:AJ?"series":"category",minWidth:x.colScenario===E.FIXED?0:this.getMinWidth(),width:isNaN(w)?null:w,autoHeight:x.doAutoHeight,columnSpan:AD.cs||1,attrForms:AE,colSpan:function(AN){var AM=AN.data&&AN.data[this.field];if(this.attrForms>1&&(AM===""||Y.find(f,"n",AM)>-1)){return this.attrForms;}return 1;},hide:AL,cellRendererParams:z,headerComponentParams:{ei:AD._ei,css:AD.css,cs:AD.cs||1,rs:AD.rs,fi:AD.fi,setIdx:u,ui:AD.ui,idx:AD.idx,headerRowSpan:x.headerRowSpan,cellIndexMap:[],cellsToMerge:x.cellsToMerge,did:AD.id?AD.id:AD._e.id,t:AD.otp?AD.otp:AD._e.otp,colIdx:AB,rowIdx:x.curRow}};},isMicroChart:function U(){return false;},reset:function e(){this.agColumnDefs=[];this.agRows=[];this.headers=[];this.headerObjects={};this.treeMap={};this.titleZone=[];},convertData:function R(u,AL,w){var AI=this,AQ=AI.data,AA=AI.dataCache,AK=AQ?(AQ.ghs.chs.items.length||(AQ.ghs.rhs.items&&AQ.ghs.rhs.items.length?1:0)):0,AN=k.getGSI(AQ.gsi),AB=AN.rows.length,AE=N.walk("rw.row.tc",AQ),AC=AI.cp,AP=N.walk("data.twm.bottom",AI)||AC.colWidths,AJ=AP&&AP.length,AF=k.getRowArrangement(AQ),AG=AF===t.CT,AR=new mstrmojo.models.template.DataInterface(AQ);AL=Math.min(AL,u+AE+AK-1,AC.rc-1);var x={isColumnsOnly:w,hasMicroChart:false,isHeaderRow:true,hasSubtotalsInRows:false,headerRowSpan:AK,cellOffsetBase:0,cellOffset:0,columnRowOffset:{},rowHeaderUnits:AB,isLockRowHeader:AQ.lhv===d.ROW||AQ.lhv===d.BOTH,cellsToMerge:AC.getUnmergedCells(u-1),headers:[],headerObjects:{},treeMap:{},titleZone:[],dataInterface:AR,colScenario:AR.getColResizeScenario(),colWidths:AP,rowsToRedraw:{},isOutlineMode:C.isDisplayOutline(AI.data,AI.defn),doAutoHeight:AG&&!AQ.rh,rowArrangement:AF},AH,AD,z=function(AS){x.cellOffset-=AS.cs||1;},AM=k.isSubtotalOnTop(AQ);AI.agRows=[];function AO(AT,AS){F.call(AI,AD,AT,AS,x);}for(AH=u;AH<=AL;AH++){var y=AC.getRowCells(AH);AA[AH]=y;if(x.isOutlineMode){AD=N.copy(AD,{});AD.stt=false;AD=n(y,AD,AM);}else{AD={};}x.curRow=AH;x.isHeaderRow=true;if(w){x.cellOffset=0;}else{x.cellOffset=AJ;Y.forEach(y,z);}Y.forEach(y,S);Y.forEach(y,AO);if(!x.isHeaderRow){AI.agRows.push(AD);}}return N.keyarray(x.rowsToRedraw,true);},aggregateHeadersForMicroChart:function O(AB,AC){if(!N.isEmpty(AB)){var AD=this.data,AE=AD.gsi,x=this.agColumnDefs,AF={},AA={},y=[],z={},w=AD.gts.col,u=0;if(!N.isEmpty(AB)){AF=i(AE);}Y.forEach(AE,function(AJ,AI){var AG=0;if(AJ.cols.length!==0){var AH=AF[AI]+u;Y.forEach(w.slice(AH),function(AL,AK){if(AL.otp===-1){return false;}if(AL.fix>1){AG++;}});}u+=AG;AA[AI]=u;});Y.forEach(x,function(AJ){var AM=AJ.headerComponentParams||AJ.headerGroupComponentParams||{},AI,AL=AM.setIdx,AH,AN,AK;if(!AJ.aggregated&&AL in AB){AN=AB[AL];AK=AC[AN.type].name;if(!z[AL]){z[AL]=z[AL]||{};}AH=p(AE,AL,AN)+(AF[AL]||0);AI=A(AM,AH);if(!z[AL][AI]){z[AL][AI]=AJ;y.push(AJ);}var AG=z[AL][AI];if(AG.allFields&&AG.allFields[AJ.field]){return true;}Q(AJ,AH,{children:[AG],headerName:AN.name},{col:w,attrFormsOffset:AA[AL],aggGroupHeader:AG,chartRenderer:AK,chartFormat:AN.format,setCfg:AN});}else{if(AJ.headerComponentParams){AJ.headerComponentParams.rs=1;}y.push(AJ);}});Y.forEach(y,function(AI){if(AI.aggregated){return false;}if(AI.hasOwnProperty("headerGroupComponentParams")||AI.hasOwnProperty("headerComponentParams")){var AL=AI.headerGroupComponentParams||AI.headerComponentParams,AK=AL.setIdx;if(AK in AB){var AM=AB[AK],AH=AM.name,AG={};X(AI,null,AG);var AJ=AG.params||{};AJ.rs=1;AJ.isChartHeader=true;if(AI.hasOwnProperty("headerGroupComponentParams")){AI.headerGroupComponentParams=AJ;}else{if(AI.hasOwnProperty("headerComponentParams")){AI.headerComponentParams=AJ;}}AI.headerName=AH;AI.aggregated=true;}}});this.agColumnDefs=y;}},getAggregatePadding:function H(u){return mstrmojo.models.template.DataInterface.prototype.getAggregatePadding.call(this,u);},getMinWidth:function G(){var w=parseInt(D.convertUnits(J.PT,J.PX,j),10),u=parseInt(D.convertUnits(J.PT,J.PX,this.getAggregatePadding().h),10);return(u*2)+w;}});mstrmojo.ag.models.template.AgDataInterface.hasMicrocharts=function I(u){return !N.isEmpty(N.walk("vp.chartCfg",u));};mstrmojo.ag.models.template.AgDataInterface.widgetPropsToJson=function l(AA,y){var w=AA.vp,x=w&&w[y],u={};if(y){return x?JSON.parse(o.decodeXMLAttribute(x)):undefined;}for(var z in w){u[z]=JSON.parse(o.decodeXMLAttribute(w[z]));}return u;};mstrmojo.ag.models.template.AgDataInterface.widgetPropsToXml=function q(w){Y.forEach(w[c.chartCfg],function(x){B(x.mid);B(x.aid);});var u=new mstrmojo.XMLBuilder();u.addChild("props");u.addChild("widgetProps");u.addChild("fmt");N.forEach(w,function(x,y){u.addChild(y);u.addAttribute("value",mstrmojo.string.encodeXMLAttribute(JSON.stringify(x)));u.closeElement();});u.closeElement();u.closeElement();u.closeElement();return u.toString();};mstrmojo.ag.models.template.AgDataInterface.WIDGET_PROPS_ENUM=c;mstrmojo.ag.models.template.AgDataInterface.microchartColSpanFn=P;mstrmojo.ag.models.template.AgDataInterface.__UNIT_TEST__={filterTotal:n};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.RaErrorHandler","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox","mstrmojo._HasTooltip","mstrmojo.mstr.EnumDSSXMLObjectTypes");var Q=mstrmojo.array,f=mstrmojo.css,N=mstrmojo.RaErrorHandler,H=mstrmojo.dom,C=mstrmojo.Enum_Keys,U=mstrmojo.hash,i=mstrmojo.mstr.EnumDSSXMLObjectTypes,W=mstrConfig.thousandsSep;if(W===undefined){W=",";}var L=2147762227,c=2147762262,I=2147762269,S=2147754499,O=140,R=118,d=350,K=-100,b=-101,B=64;var a;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{postBuildRendering:function Z(){var l=this._super(),j=this.parent,n=j.id;if(!this.onScroll){this.onScroll=function k(){var o=mstrmojo.all[n],p=o.domNode;if(!o.isFetching&&Math.ceil(p.offsetHeight+p.scrollTop)>=p.scrollHeight){o.isFetching=true;o.opener.getCandidatesThroughTaskCall({isIncFetch:true},{});}};}var m=j.domNode;if(j.supportsIncFetch){H.attachEvent(m,"scroll",this.onScroll);}else{H.detachEvent(m,"scroll",this.onScroll);}return l;},getItemMarkup:function(k,j){if(!a){a=this._super(k,j).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return a;},getItemProps:function h(l,j){var k=this._super(l,j),m=l.wt;k.weight=m?"<em>("+mstrmojo.num.addSeparators(m,W)+" "+this.parent.opener.wtStr+")</em>":"";return k;},onmouseover:function(k,l){var j=k.e.srcElement;if(j.scrollWidth<=j.offsetWidth){j.title="";}},onclick:function(k){var n=this.parent.opener.suggestionItems,j=n.length;this._super(k);if(j<=1){return ;}var l=Q.find(n,"t",K),m=this.getItemFromTarget(k.getTarget());if(m&&m.t&&m.t===K){Q.forEach(n,function(o,p){if(!this.selectedIndices[p]){this.doItemSelect(o,{});}},this);}else{if(this.selectedIndices[l]){this.doItemSelect(n[l],{});}}}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.SearchBoxSelector",cssClass:"mstrmojo-SearchBoxSelector",srcid:null,srct:i.Attribute,dataSourcesXML:null,useClientForm:false,maxItemWidth:"",wtStr:"likes",suggestionListClass:"mstrmojo.SearchBoxSelectorList",useRichTooltip:false,postCreate:function A(){var j=U.clone(this.suggestionPopup);j.cssClass="mstrmojo-SearchBoxSelector-suggest";j.nudge=function(){var w=this.domNode,n=this.containerNode;if(!w){return ;}var s=Math.min(n&&n.offsetHeight||O,(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||O),k=w.offsetWidth,l=H.windowDim(),m=parseInt(this.left,10),p=parseInt(this.top,10);if(p+s>=l.h){p=Math.max(p-s-(this.target?this.target.offsetHeight:0),0);if(p+s>=l.h){p=5;s=H.getMaxScrollHeight();}}if(m+k>=l.w){m=Math.max(m-k,0);}var u=w.style;u.top=p+"px";u.left=m+"px";u.maxHeight=s+"px";if(u.maxWidth===""){u.maxWidth=f.getComputedStyle(w).maxWidth;}var q=this.opener,t=q&&q.width,o=H.position(w).w;if(t!==undefined&&o<parseInt(t,10)&&parseInt(u.maxWidth,10)<parseInt(t,10)){u.maxWidth=t;this.nudge();}};this.suggestionPopup=j;},preBuildRendering:function D(){var j=this.parent.contentNode.offsetWidth||this.parent.width;this.set("maxItemWidth",parseInt(j,10));this._super();},postBuildRendering:function Z(){var j=this.parent.defn.fmts;if(!j.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function g(k,n,j){var o=k,l=this.suggestCount;if(!this.noCache){j=j||l;if(n==="*"){n="";}else{n=mstrmojo.string.regEscape(n);}var p=this.itemField,m=new RegExp(n,"i");o=Q.filter(k,function(q){return m.test(q[p]);},{max:j});}if(o.length){Q.forEach(this.items,function(s){var q=Q.find(o,"v",s.v);if(q>-1){o.splice(q,1);}});}return o;},getCandidatesThroughTaskCall:function G(AE,AI){var y=this.id,p=this.getSuggestionTarget(),u=AE.pattern||"",t=u,q=this.parent,AA=this.srcid,w=AE.isIncFetch,s=this._last_hit,AG=this,AC=false,o;if(w){u=AE.pattern=s.pattern;}if(u===""||u.trim()==="%"){return ;}if(AA){var AH={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:AA,dataSourcesXML:this.dsrc||"",blockBegin:w?s.loadedCount:1,blockCount:this.items.length+this.suggestCount,searchPattern:u,rawInput:t,browseFlags:1,otp:this.srct},x=null;var l=q.defn;if(l.dsid){x={};x.datasetID=l.dsid;x.messageID=q.model.mid;x.ctlKey=q.ckey;}if(this.srct===i.Consolidation){AH.browseFlags=B;}var AD=l.fs||l.sfs;if(AD){var AB="",n="";Q.forEach(AD,function(AJ){AB+=n+AJ.did;n=";";});AH.searchForms=AB;if(q.model.isnew||this.useClientForm){var AF="",j="",m=q.model,z=Q.filterOne(m.getDatasetUnits(["att"]),function(AJ){return AJ.did===AA;}),k=z.fs||[];Q.forEach(AD,function(AJ){var AK=Q.filterOne(k,function(AL){return AL.fid===AJ.did;});AF+=j+AJ.did+":"+(AK&&AK.bftp||0);j=";";});AH.clientFormPatterns=AF;}}AI.success=function(AR){var AN=mstrmojo.all[y],AL=AN&&AN.suggestionPopup,AQ,AP,AT,AS,AK=AE.pattern,AJ=AN&&AN._searchQueue,AM=!AJ||AJ.length<=(w?0:1)||!AN.stifleIntermediateSearch;if(AN){if(AR&&AR.es){AQ=AN.getSuggestionTarget();AP=AR.es.length;if(!AR||!AQ||(p!==AQ)){return ;}AT=AQ.getSearchPattern();AS=AR.es;if(AA){AS=mstrmojo.elementHelper.buildElemsTerseID(AS,AA,true);}AN._last_hit={items:AS,pattern:AK,loadedCount:AR.bb+AP};AL.isFetching=false;if(AM){AL.supportsIncFetch=(AR.bb+AR.bc)<AR.sz;if(AT&&AT.indexOf(AK)>-1){var AO=AN.filterCandidates(AS,AT);if(AN.parent){AN.parent.checkAndParseHTMLTags(AO);}AN.updateSuggestion(w?AN.suggestionItems.concat(AO):AO);}if(AN.inputBox){AN.inputBox.focus();}if(!AN._ListenerProc){AN._ListenerProc=function(){var AU=AN.suggestionPopup;if(AU.visibile){AU.nudge();}};H.attachEvent(window,"resize",AN._ListenerProc);}}}else{if(AM){AN.updateSuggestion([]);}}}};AI.failure=function(AL){var AN=mstrmojo.all[y],AK=parseInt(AL.code,10)+4294967296,AM=(AK===L||AK===c||AK===I),AJ=(AK===S);if(AJ){AN.hideTooltip();return ;}N.handleRAPopUpError(AL);if(AN&&AN.failMessage){AN.failMessage(AM?{errCode:AK,msg:AL.message}:{});}};AI.complete=function(){var AK=AG._searchQueue,AJ=AK&&AK.pop();mstrApp.hideWait();if(AK&&AK.length&&AG.showSuggestion){AG._searchQueue=[];AG.showSuggestion(AJ);}};if(this.hitEnterToTest){if(w&&this.onIncrementalFetch){this.onIncrementalFetch();}mstrApp.showWait({message:mstrmojo.desc(15823,'Searching "#"...').replace("#",u)});}else{if(!w){o=this._searchQueue;AC=o&&o.length;if(!o){this._searchQueue=[];}this._searchQueue.push(u);}}if(!AC){mstrmojo.elementHelper.browseElements(AI,AH,x);}}},destroy:function e(j){if(this._ListenerProc){H.detachEvent(window,"resize",this._ListenerProc);delete this._ListenerProc;}this._super(j);},onsuggestionItemsChange:function F(){var n=this.suggestionItems,k=this.suggestionPopup,m=k.editorNode,s=n&&(n.length>8),q="",o="";if(s){q=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||O;o="px";}if(m){m.style.maxHeight=q+o;}else{if(s){o+=";";k.cssText=(k.cssText||"")+"max-height:"+q+o;}}if(mstrApp.isExpress){var l=this.parent.contentNode.offsetWidth,j=(l===null||R<l)?R:l,p=(l===null||d>l)?d:l;k.cssText=(k.cssText||"")+"min-width:"+j+"px; max-width:"+p+"px;";}},getSuggestionPos:function X(){var j=this._super();if(j){j.lockIW=this;}return j;},updateSuggestion:function Y(k){var j=k&&k.length;this.autoSelect=true;this.set("disableClick",false);if(this.parent.defn.multi&&j&&j>1){k=Q.filter(k,function(m){return(m.v!=="u;"&&m.t!==14)&&(m.t!==K);});k.unshift({n:mstrmojo.desc(13976,"(All search results)"),t:K});this.autoSelect=false;}if(!j){k=[{n:mstrmojo.desc(13779,"No elements match your search"),t:b,cls:"nomatch"}];}if(k.length===1&&k[0].t===b){this.autoSelect=false;this.set("disableClick",true);}this._super(k);var l=this;l.mw=l.mw||function(p){var m=l._lastOpened;if(!m||!m.visible){H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",l.mw);return ;}var o=H.eventTarget(self,p);var n=m.domNode;if(!H.contains(n,o,true,document.body)){m.close();H.detachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",l.mw);}};H.attachEvent(document,H.isFF?"DOMMouseScroll":"mousewheel",l.mw);},onSuggestionItemSelect:function J(j){var k=this.parent,l=k&&k.tabParent;this._super(j);if(k&&k.canTab){if(k.multi){k.buildNavList();k.tabIndex=k.navList.length-2;}else{k.resetTabNav();if(l&&l.grabFocus){l.grabFocus(true);}}}},handleSuggestionItemSelect:function P(k,l){if(Q.isArray(k)||k.t===K){k=Q.ensureArray(k);var j=Q.filter(k,function(m){return m.t!==K;});if(j.length<k.length){j=Q.filter(this.suggestionItems,function(m){return m.t!==K;});}this.onSuggestionItemSelect(j);}else{this._super(k,l);}},prekeydown:function E(s){if(!this.srcid){return ;}this._super(s);var o=s.e,t=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||O,m=8,k=t/m;var l=this.getSelected();if(l){var n=l._renderIdx,j=(n-m+1)*k,q=(n-1)*k,p=this.suggestionPopup.domNode.scrollTop;switch(parseInt(o.keyCode||o.charCode,10)){case C.DOWN_ARROW:if(p<=j){this.suggestionPopup.domNode.scrollTop=j;}else{if(p>q){this.suggestionPopup.domNode.scrollTop=q;}}break;case C.UP_ARROW:if(p<=j||p>q){this.suggestionPopup.domNode.scrollTop=q;}break;}}},prekeyup:function M(j){if(!this.srcid){return ;}this._super(j);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.dom","mstrmojo.SimpleObjectInputBox");var D=mstrmojo.array,B=mstrmojo.dom,E=mstrmojo.Enum_Keys,A=mstrConfig.thousandsSep;var H={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(A===undefined){A=",";}var I;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function G(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function C(J){var L=J.e;switch(parseInt(L.keyCode||L.charCode,10)){case E.TAB:case E.ENTER:B.preventDefault(J.hWin,L);var M=this.inputBox.value;if(M){if(D.find(this.items,"v",M)===-1){this.onSuggestionItemSelect({n:M,v:M});}else{this.setDefaultState();}}break;case E.ESCAPE:this.setDefaultState();break;case E.BACKSPACE:if(!this.getSearchPattern()){B.preventDefault(J.hWin,L);var K=this.items&&this.items.concat();if(K&&K.length){K.splice(K.length-1,1);this.set("items",K);var N=this.id;window.setTimeout(function(){mstrmojo.all[N].set("state",H.ADDING);},0);}}break;}},prekeyup:function F(J){}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.HierarchyCheckList","mstrmojo.ui._HierarchyListSelection","mstrmojo.EnumSelectionType","mstrmojo.hash","mstrmojo.array","mstrmojo._HasTooltip","mstrmojo.dom","mstrmojo.css");var P=mstrmojo.hash,b=mstrmojo.css,J=mstrmojo.array,G=mstrmojo.dom,W=mstrmojo._HasTooltip,A=mstrmojo.EnumSelectionType;var a="dynamic",X="hasLevelSelected",U="vi-regular vi-tooltip-A hierarchyTooltip",L="fullSelected",N="hcsd";var f=7;function c(i){var g=false;if((i.hcsd)&&i.isSelected&&i.isBranchSelected){var h=this;g=J.some(this.selectionList,function(k){if(k.isNot===true){var j=h.getItemByValue(k.itemValue);while(j){if(j===i){return true;}j=j.parent;}}});}return g;}function I(k,g,i){var l=[],j=0,h={};J.forEach(k,function(n){var m=n.v;if(m>=i){l.push(n);if(g.isLevelSelected(m)){h[l.length-1]=true;j++;}}});return{items:l,selectedIndices:h,count:j};}mstrmojo.vi.ui.HierarchyCheckList=mstrmojo.declare(mstrmojo.ui.HierarchyCheckList,[mstrmojo.ui._HierarchyListSelection],{scriptClass:"mstrmojo.vi.ui.HierarchyCheckList",getItemMarkup:function E(h,g){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@tt}"><div class="right"><span class="refresh"></span><span class="branch"></span><span class="level"></span></div><div class="content"><span class="indent" style="padding-left: {@indent}px;"></span><span class="triangle"></span><span class="checkbox"></span><span class="text">{@en@n}</span></div></{@tag}>';},useRichTooltip:true,getItemProps:function d(i,g){var h=this._super(i,g);if(i.isBranchSelected){h.addCls(a);}if(this.isInFilterPanel){if(i.hasLevelSelected){h.addCls(X);}if(i.hcsd){h.addCls(N);}var j=c.call(this,i);if((i.hcsd||i.ln)&&i.isSelected&&i.isBranchSelected&&!j){h.addCls(L);}}return h;},onclick:function e(g){var i=g.getTarget(),j=this.getItemNodeFromTarget(i),h=this.getItemFromTarget(i);if(h){if(b.hasClass(i,"triangle")){if(h.hcd){this.doExpandCollapse(j,h);}}else{if(b.hasClass(i,"branch")){this.doElementSelect(j,h,!h.isSelected);}else{if(b.hasClass(i,"level")){this.openLevelPopup(j,h,i);}else{if(!b.hasClass(i,"indent")&&!b.hasClass(i,"refresh")){this.doBranchSelect(j,h,!h.isSelected);}}}}g.cancel();}},showTooltip:function D(g,l){var k=g.target||G.eventTarget(g.hWin,g.e),i=this.getItemFromTarget(k);if(i){var j=G.position(k),h="";this.tooltipOpenDelay=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;if(b.hasClass(k,"branch")||b.hasClass(k,"level")||b.hasClass(k,"refresh")){if(b.hasClass(k,"branch")){h=i.isSelected?mstrmojo.desc(16756,"The element is single selected. Click to deselect"):mstrmojo.desc(16757,"Click to single select the element");}else{if(b.hasClass(k,"level")){h=mstrmojo.desc(15919,"Level Select");}else{h=mstrmojo.desc(15251,"Dynamic");}}this.richTooltip={cssClass:U,content:h,refNode:k,top:j.h+6,left:-j.w/2};this._super(g,l);return true;}}},onSelectionChange:function K(i,g,j,k){if(i===A.ALL){this.setAllLevelSelection(g);var h=this.levelBtn;if(h){b.toggleClass(h.domNode,X,false);}}if(i===A.ALL&&g){this.clearSelections();this.clearDescSelection();(this.raad?this.getInitialDisplayRoots():this.getRootItems()).forEach(function(l){if(l.v){this.selectionList.push({func:A.BRANCH,itemValue:l.v,isNot:false});}},this);if(this.postSelectionChange){this.postSelectionChange();}}else{this._super(i,g,j,k);}},updateItemNodesStatus:function Q(){var g=this.itemsContainerNode&&this.itemsContainerNode.childNodes;this._super();if(!this.isInFilterPanel){return ;}J.forEach(g,function(j){var h=this.getItemFromTarget(j);if(h){b.toggleClass(j,N,h.hcsd);b.toggleClass(j,X,h.hasLevelSelected);var i=c.call(this,h);b.toggleClass(j,L,(h.hcsd||h.ln)&&h.isSelected&&h.isBranchSelected&&!i);}},this);},getSummaryText:function M(){return"";},getLevels:function F(){return[];},getLevelItems:function B(h){var k=this.getLevels(),l=h?[{v:-1,n:mstrmojo.desc(15824,"All Levels")}]:[];if(k.length>0){return l.concat(k);}var g=this.getMaxLevel();for(var j=0;j<=g;j++){l.push({v:j,n:mstrmojo.desc(493,"Level")+" "+(j+1)});}return l;},postBuildRendering:function Z(){var i=this.levelPopup,h=this.domNode;if(!i){var g=this.getLevelPopupConfig(),j=P.walk(g.scriptClass,window);delete g.scriptClass;i=this.levelPopup=new j(g);this.addDisposable(i);}i.placeholder=h.insertBefore(document.createElement("div"),h.firstChild);i.render();return this._super();},unrender:function Y(g){var h=this.levelPopup;if(h){h.unrender(g);}return this._super(g);},onScrollEnd:function C(){var h=this.levelPopup,g=h&&h.getPopupWidget();if(g&&g.visible){h.closePopup();}this.hideTooltip();},openLevelPopup:function S(n,j,i){var l=this.levelPopup,h=l.getPopupWidget();if(l&&j.hcd&&this.isHiearachyDisplay()){l.openPopup(h,{branch:j,branchNode:n});if(i){var g=h.domNode;var m=G.position(g);var k=G.windowDim();g.style.left=Math.min(i.offsetLeft,k.w-m.w-G.position(g.offsetParent).x-10)+"px";g.style.top=i.offsetTop+i.offsetHeight-this.scrollNode.scrollTop+"px";}}},getLevelPopupConfig:function R(g){return P.copy(g,{scriptClass:"mstrmojo.ui.PopupButton",markupString:'<div id="{@id}" class="level-popup-btn" mstrAttach:click></div>',isHostedWithin:false,useRichTooltip:true,parent:this,widget:this,richTooltip:null,children:{scriptClass:"mstrmojo.ui.PopupWidget",alias:"levelPopup",visible:false,children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"checklist",doItemSelect:function k(t,q){var p=this.parent,u=p.opener.widget,s=!this.selectedIndices[t._renderIdx];if(p.branch&&p.branchNode){u.doBranchLevelSelect(p.branchNode,p.branch,t.v,s);}else{u.doLevelSelect(t.v,s);}mstrmojo._IsList.doItemSelect.call(this,t,q);},onclick:function o(p){if(!b.hasClass(p.getTarget(),"refresh")){mstrmojo._IsList.onclick.call(this,p);}},getItemMarkup:function n(p){return mstrmojo.ui.CheckList.prototype.getItemMarkup.call(this,p).replace('<span class="text">{@en@n}</span>','<span class="refresh"></span><span class="text">{@en@n}</span>');}}],onOpen:function h(){var s=this.opener.widget,p=this.branch,q=I(s.getLevelItems(),s.getLevelSelection(p),p&&p.lv+1||0);this.checklist.set("items",q.items);this.checklist.set("selectedIndices",q.selectedIndices);}},getPopupWidget:function i(){return this.levelPopup;},onPopupWidgetOpened:function j(){b.addClass(this.levelPopup.branchNode,"level-popup-open");},onPopupWidgetClosed:function l(){b.removeClass(this.levelPopup.branchNode,"level-popup-open");},showTooltip:function m(p,u){var t=p.target||G.eventTarget(p.hWin,p.e),s=G.position(t),q=mstrmojo.desc(16758,"Select elements by level");this.tooltipOpenDelay=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY;this.richTooltip={cssClass:U,content:q,refNode:t,top:s.h,left:-s.w/2};W.showTooltip.call(this,p,u);}});},updateBtnSelectionStatus:function O(i){if(i){if(i.hcd){var j=I(this.getLevelItems(),this.getLevelSelection(i),i.lv+1);i.hasLevelSelected=j.count>0;}}else{var j=I(this.getLevelItems(),this.getLevelSelection(),0),g=this.items,h=this.levelBtn;if(h){b.toggleClass(h.domNode,X,j.count>0);}J.forEach(g,function(k){this.updateBtnSelectionStatus(k);},this);}},getAllButtonConfig:function H(h,g){return P.copy(g,h?{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(3474,"Select All"),alias:"selectAllBtn",cssClass:"selectAll",widget:this,onclick:function(){this.widget.doAllSelect(true);}}:{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1763,"Clear All"),alias:"clearAllBtn",cssClass:"clearAll",widget:this,onclick:function(){this.widget.doAllSelect(false);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.vi.ui.HierarchyCheckList","mstrmojo.ui._IsIncFetchHierarchyList");var A=mstrmojo.css;mstrmojo.vi.ui.IncHierarchyCheckList=mstrmojo.declare(mstrmojo.vi.ui.HierarchyCheckList,[mstrmojo.ui._IsIncFetchHierarchyList],{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",cssClass:"elementsList"});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.TextBoxSelector","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.array","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.func","mstrmojo.string","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper","mstrmojo.MetricSelectorUtility","mstrmojo.RaErrorHandler","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi._MonitorsAppState","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.EnumRWUnitType","mstrmojo.mstr.EnumDSSConsolidationType","mstrmojo.vi.models.VIComponentMap.TYPES","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.ui.rw._SupportTabNav","mstrmojo.mstr.EnumWebAPIErrorCodes");mstrmojo.requiresDescs(4729,4730,4732,4733,4734,4735,5225,5443,6738,8967,12297);var BW=mstrmojo.array,AT=mstrmojo.hash,Ao=mstrmojo.dom,t=mstrmojo.expr,Av=mstrmojo.RaErrorHandler.embeddedErrStr,A0=t.TP,Ae=t.STP,BF=mstrmojo.css,k=mstrmojo.func,BN=mstrmojo.EnumRWUnitType,BO=mstrmojo.mstr.EnumWebAPIErrorCodes,BY=mstrmojo.MetricSelectorUtility,AY=mstrmojo.vi.ui.DatasetUnitMenuUtils,Ah=mstrmojo.vi.models.VIComponentMap.TYPES,BE=mstrmojo.DocDataService,Bo=BE.REQUEST_DEFN_DATA,i=mstrmojo.vi.enums.EnumFeatures,BV=0,L=1,D=2,BJ=3,BB=4,Ai=5,AS=6,R=7,Bm=8,Az=9,x=10,e=11,E=12,BA=mstrmojo.elementHelper,BH=BA.ELEM_ALL_ID,AV=k.wrapMethods,s=mstrmojo.string.escapeIllegalXML,m=mstrmojo.mstr,A2=m.EnumDSSXMLBaseFormType.DssXmlBaseFormHTMLTag,Ap=m.EnumDSSConsolidationType,At=m.EnumDSSXMLObjectTypes,Ay=A0.FILTER,N=A0.METRIC,Y=A0.ATTR,AA=A0.CONS,A9=0,AH="u;",AR=Ae.NDE,BS=3076,Aw=3077,BK=Ae.CUSTOMGROUP,Bb=BA.ELEM_ALL,AI=338,Ag="RA_LIMIT_ERR",P="\u001E";mstrmojo.DocSelectorEvtType=null;var Bp={};Bp[R]="MetricSlider";Bp[Bm]="MetricQualification";Bp[Az]="SearchBoxSelector";Bp[x]="TextBoxSelector";var BP=2;var Ba=[{n:mstrmojo.desc(4735,"Link Bar"),v:AS},{n:mstrmojo.desc(4734,"Button Bar"),v:Ai},{n:mstrmojo.desc(6738,"List Box"),v:D},{n:mstrmojo.desc(4732,"Radio Buttons"),v:BJ},{n:mstrmojo.desc(4729,"Drop-down"),v:BV}];var An=[{n:mstrmojo.desc(4735,"Link Bar"),v:AS},{n:mstrmojo.desc(4729,"Drop-down"),v:BV}];var X=function X(){var Bq={type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,isUConDS:!!this.defn.dsTks};if(this.style===Bm||this.style===R){mstrmojo.hash.copy(Bq,{srcid:this.srcid,srct:this.type,f:this.f,ft:this.ft,qt:this.qt,unset:!!this.unset,cs:this.cs});}return Bq;},AX=function AX(){var Br=this.node,Bt=Br&&Br.data,Bq=Br&&Br.defn,Bs=Bq&&Bq.srct;return((mstrApp.isAppStatePause&&mstrApp.isAppStatePause())||mstrConfig.resolveOnly)&&this.style!==Az&&Bs&&this.hasAttrData()&&!Bt[w.ELMSREADY]&&!Bt[w.ELMSREQUEST]&&parseInt(Bq.ds,10)===A9&&!Bt[w.DISABLED];},M=function M(Bs,By){var Bv=this.node.defn,Br=this.node.data,Bx=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,Bt={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Bv.srcid||"",dataSourcesXML:Bv.dsrc||"",browseFlags:1},Bq=Bx||By;if(!Bv.srcid){return ;}var Bz=function(B3){var B0=this.model,B2=B0.datasets,B1=Object.keys(B2),B5=[],B4;BW.forEach(B1,function(B6){B5=B2[B6].att;BW.forEach(B5,function(B7){if(B7&&B7.did===B3){B4=B6;return false;}});if(!!B4){return false;}});return B4;};if(!Bs){Bt.datasetID=Bv.dsid||Bz.call(this,Bv.srcid);Bt.messageID=this.model.mid;if(!Bt.datasetID){return ;}}var Bw=this,Bu={success:function(B0){Bw.bGetElems=true;Bw.set("wait",false);if(B0&&B0.es){Br.elms=(Bv.srcid)?BA.buildElemsTerseID(B0.es,Bv.srcid,true):B0.es;if(Bx){Bw.toggleDisplayAll(Bv.showall);}var B1=Bw.parent,B2=B1&&B1.parent;if(Bv.sec&&Br.ces&&Br.elms&&Br.elms.length>0&&B1){B1.set("count",BA.buildElemsCountStr(Br.ces,Br.elms,Bw.isSelectionExcluded()));}if(Bw.isInvalid){Bw.isInvalid=false;}if(Bw.hasRendered){if(By&&By.onSuccess){By.onSuccess();}else{Bw.refresh();if(Bx&&B1){BF.toggleClass(B1&&B1.domNode,"invalid",false);if(B2){B2.rebuildChild(B1);}}if(Bw.isInFilterPanel()){if(B1&&B1.defn&&B1.defn.ttl){B1.updateContentHeight();}if(B2&&B2.refreshFP){B2.refreshFP();}}}}}},failure:function(B0){if(Bq){Bw.model.setDataReady(Bw.k,Bw.id,w.DISABLED,true);var B1=Bw.parent;Bw.isInvalid=true;BF.toggleClass(B1&&B1.domNode,"invalid",true);if(Bw.isInFilterPanel()){if(B1){B1.canCollapse=false;if(B1.titleBar){B1.titleBar.canCollapse=false;}B1.generateToolbar();}}else{if(B1.hasRendered&&B1.showInvalidMessage){B1.showInvalidMessage();}}return ;}mstrmojo.alert(B0.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){if(Bq){Bw.node.data[w.ELMSREQUEST]=false;Bw.model.setDataReady(Bw.k,Bw.id,w.ELMSREQUEST,false);if(!mstrApp.isSingleTier){mstrApp.hideWait();}}}};this.set("wait",true);if(Bq){Br[w.ELMSREQUEST]=true;this.model.setDataReady(this.k,this.id,w.ELMSREQUEST,true);}if(mstrApp.isSingleTier&&Bq){mstrApp.serverRequest(Bt,Bu,{hideFailureErr:true});}else{if(Bx){mstrApp.showWait();}mstrmojo.xhr.request("POST",mstrConfig.taskURL,Bu,Bt,false,null,true);}},l={getWidgetClass:function Bf(Bt,Bs,Br){var Bq=Bp[Bs];if(Bq&&Bq.constructor===Array){Bq=Bq[Br?0:1];}return Bq;},allowHTML:function Q(){return false;},getWidgetConfig:function AE(Bw,Bs,Bu,Bq){var Bx=Bs===2?false:Bu.horiz,Bv=Bw.getFormats(),By=Bv&&Bv.height,Bt={scriptClass:this.getWidgetClass(Bw,Bs,Bx),docSelector:Bw,enabled:this.enabled,multiSelect:Bu.multi,isHoriz:Bx,include:Bu.include,itemWidthMode:Bu.iwm,allIdx:BW.find(Bq,"v",mstrmojo.elementHelper.ELEM_ALL_ID),noneIdx:Bu.include?-1:BW.find(Bq,"v",mstrmojo.elementHelper.ELEM_ALL_ID),renderAllItems:!By,allowHTML:this.allowHTML(),allowHTMLOnSelector:this.allowHTML(),onchange:function Br(){if(!Bw._inSyncPhase){Bw.selectorControlChange(this);}}};if(Bt.noneIdx!==-1){Bt.allIdx=-1;}if(Bv&&Bs===mstrmojo.DocSelector.STYLES.PULLDOWN){if(Bv.color){Bt.itemCssText="color: "+Bv.color+";";}if(Bv.font){Bt.itemCssText=(Bt.itemCssText||" ")+"font:"+Bv.font;}if(mstrApp.isExpress){Bt.cssTextClass="express";}}return Bt;},expandOrEditToFetchElements:function Bj(){var Bq=this.node&&this.node.data;if(Bq&&Bq[w.DISABLED]){Bq[w.DISABLED]=false;}this.model.setDataReady(this.k,this.id,w.disabled,false);this.checkAndFetchAllElemsForDelayed();},checkAndFetchAllElemsForDelayed:function AP(Bq){if(Bq||AX.call(this)){M.call(this);}},newSelectorWidget:function W(B1){var Bx=B1.style,Bs=B1.node,B0=Bs.defn,Bv=Bs.data,Bq=Bv.elms||[],Bw=B1.isInFilterPanel(),Br,Bz=this.getWidgetConfig(B1,Bx,B0,Bq),Bu=Bz.scriptClass,By=function(B4){var B2=this.getPopupList(),B3=this.items;if(B2.items.length!==B3.length){this.selectedIndex=BW.find(B3,"v",B4.v);}if(B4){this.set("text",B4.n||mstrmojo.desc(14561,"(null)"));}else{this.set("text","");}};if(!Bu){Br=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{if(Bx===BV){if(mstrApp&&mstrApp.isVI){Bz.useDarkTheme=!Bw&&mstrApp.getRootController().isDarkThemeSelected();Bz.scrollNodeMaxHeight=AI;Bz.focusOnPopup=true;Bz.allowCustomText=true;Bz.allowEmptyText=true;Bz.onitemSelected=Bz.onitemSelected?mstrmojo.func.composite([By,Bz.onitemSelected]):By;Bz.customizeSearchResult=function(B4){var B7,B5=this.allIdx,B3=this.multiSelect,B2=B4.length,B6={v:AH,n:mstrmojo.desc(13976,"(All search results)"),t:At.Dimension,_renderIdx:B5};if(B2!==this.items.length){if(B5>=0){B7=BW.find(B4,"v",AH);if(B7>-1){if(B3&&B2>1){B4.splice(B7,1,B6);}else{B4.splice(B7,1);}}else{if(B3&&B2>0){B4.splice(B5,0,B6);}}}}};Bz.setDefaultListAndIndex=function(B3){var B2=this.getPopupList();B2.set("items",B3);if(!this.multiSelect){B2.set("selectedIndex",this.selectedIndex);this.set("text",B3[this.selectedIndex].n||mstrmojo.desc(14561,"(null)"));}else{this.set("selectedIndices",this.selectedIndices);}};Bz.onclearSelection=function(){var B3=this.getSelectedItem(),B2=this.getPopupList();if(B3){B2.set("selectedIndex",BW.find(B2.items,"v",B3.v));}};}}delete Bz.scriptClass;var Bt=AT.walk(Bu,mstrmojo);Br=new Bt(Bz);}return Br;},getCekEvtListener:function BZ(Br,Bq){return function(Bs){var Bv=[],Bt=this.node.data.elms,Bu={};BW.forEach(Bt,function(Bx,Bw){Bu[Bx.v]=Bw;});BW.forEach(Bs.value,function(Bx){var Bw=Bu[Bx];if(Bw>-1){Bv.push(Bw);}});this.handleActionInSyncPhase(function(){if(Bq&&Bq.select){Bq.select(Bv);}});};},newAndInitWidget:function I(Bu){var Bw,Bs=Bu._cekEvtListener,Br=Bu.node,Bq=Br.defn,Bt=Bu.id,Bv;if(Bs){Bq.detachEventListener(Bs);delete Bu._cekEvtListener;}Bw=this.newSelectorWidget(Bu);if(Bw){Bv=this.getCekEvtListener(Bu,Bw);}Bt=Bv.cekContextId||Bt;Bv=Bv.cekEvtListener||Bv;if(Bv){Bu._cekEvtListener=Bq.attachEventListener("cekChange",Bt,Bv);}Bu.addChildren(Bw);if(this.isRecursiveAttributeSelector()){Bu.addChildren({scriptClass:"mstrmojo.Box",cssClass:Ag,alias:"ctrlOverlay",slot:"containerNode",visible:false,markupString:Av,});}return Bw;},updateWidget:function BR(Br){var Bq=Br.children,Bs=Bq&&Bq[0];if(!Bs){Bs=this.newAndInitWidget(Br);}else{Bs.set("enabled",this.enabled);}return Bs;}};function Al(Bq){return Bq.some(function(Br){return this.style===Br;},this);}function F(){var Bq=this;return Bq.model.getDatasetUnits(["mx"],function(Br){return Br.did===Bq.defn.srcid;})[0]||{};}function Au(Bq,Bu,Bv,Bx,B0,Bt,Br){if(!Bq){return[];}var Bz=0,Bw,By=Bq.length-(Bt?1:0)-(Bu?1:0),Bs=[];if(Br){if(Bv&&Bu){Bz++;}else{if(Bx){Bz=(Bq.length-1);if(Bt){Bz--;}}}for(Bw=0;Bw<B0;Bw++){if(Bv){if(Bz<=By&&Bq[Bz]){Bs.push(Bq[Bz++]);}}else{if(Bx){if(Bz>=(Bu?1:0)){Bs.push(Bq[Bz--]);}}}}}else{if(Bv){Bz=B0;if(Bt){Bz--;}}else{if(Bx){Bz=0;if(Bu){Bz++;}}}for(Bw=B0+1;Bw<=By;Bw++){if(Bz<=By){Bs.push(Bq[Bz++]);}}}return Bs;}function AW(Bq,Bt,By){Bq=BW.filter(Bq,function(Bz){return Bz.v!==AH;});var Bw=Bt===Aa.FIRST,Bs=Bq.length,Br=Bw?0:Math.max(Bs-By,0),Bv=Bw?Math.min(By,Bs):Bs,Bx=[],Bu=[];Bq=Bq.splice(Br,Bv);BW.forEach(Bq,function(Bz){Bx.push(Bz.v);Bu.push({n:Bz.n,t:Bz.t,v:Bz.v});});return{ces:Bu,cek:Bx};}function BC(Bq){if(BW.find(Bq.ces,"v",AH)>-1){Bq.ces=[];return ;}Bq.ces=BW.difference(Bq.elms,Bq.ces,function(Bs,Br){return Bs.v===Br.v;});Bq.ces=BW.filter(Bq.ces,function(Br){return Br.v!==AH;});}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,l,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui.rw._SupportTabNav],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSelector {@cssClass} {@extCls}" nm="{@en@n}" title="{@tooltip}" style="{@domNodeCssText}"  mstrAttach:keydown><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100;position:absolute;top:0;left:0;width:100%;height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:k.composite([function(){var Bq=this.children,Br=Bq&&Bq[0];if(Br&&Br.updateScrollbars&&this.visible){setTimeout(function(){Br.updateScrollbars();},25);}},mstrmojo.Widget.visibleMarkupMethod]),onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenableChange:mstrmojo.Widget.enabledMarkupMethod,onincludeChange:function(){BF.toggleClass(this.domNode,"strikeout",!this.include);},onwaitChange:function(){BF.toggleClass(this.domNode,"wait",!!this.wait);this.wIconNode.style.display=((this.wait)?"block":"none");}},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",min:-1,max:-1,bGetElems:false,n:"",_inSyncPhase:false,ctrlOverlay:null,toggleDisplayAll:function Bd(Bq){var Bu=this.node,Bv=Bu.data,Bt=Bu.defn,Bs=BW.filterOne(Bv.elms,function(Bw){return Bw.t===14;});if(Bq&&!Bs){Bs=Bb;Bv.elms=BW.insert(Bv.elms,0,[Bs]);}if(!Bq&&Bs){Bv.elms=BW.filter(Bv.elms,function(Bw){return Bw.t!==14;});}if(this.children&&this.children[0]){var Br=BW.find(Bv.elms,"v",mstrmojo.elementHelper.ELEM_ALL_ID);this.children[0].items=Bv.elms;this.children[0].allIdx=Br;this.children[0].noneIdx=Bt.include?-1:Br;}Bv[w.ELMSREADY]=true;this.model.setDataReady(this.k,this.id,w.ELMSREADY,true,"elms",Bv.elms);},init:function Bi(Bs){this._super(Bs);if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}var Br=Bs.node.defn,Bt=Bs.node.data,Bq=Br.style;if(Bt.iin!==undefined&&Bt.iin!==Br.include){BC(Bt);}this.n=Br.n;this.showBFAMenu=AT.walk("model.prefs.pdfbfa",Bs);if(mstrApp.showSelectAllMenuOptionForSelector===1&&Br.multi){switch(Bq){case D:case BB:case Ai:case AS:this.spm=true;break;}}},_fetchOnInit4UCOnDS:function G(Bs){var Bq=!this.bGetElems&&parseInt(this.node.defn.subTp,10)===BP,Br=this.node.data;if(Bq||AX.call(this)){M.call(this,Bq);Bs=Br.elms;}return Bs;},initControlInfo:function AJ(){var B5=this.node,CA=B5.data,Bs=B5.defn,B3=CA.elms,B9=CA.ces;var Bx=["include","ckey","ck","tks","style","multi","iase","showall"];B3=this._fetchOnInit4UCOnDS(B3,CA);this.type=Bs.ct;var B2=Bs.fmts;if(B2){var B0=B2.width;if(!B0||parseInt(B0,10)<=0){B2.width="95px";}}AT.copyProps(Bx,Bs,this);var Bw=this.selIdx={},Bu=false,B4=Bs.multi;if((Bs.style===L)||B4){if(!this.oces&&(B9!==undefined)){this.oces=AT.cloneArray(B9);Bu=true;}var Br=Bs.showall,B8=(BW.find(B9,"v",mstrmojo.elementHelper.ELEM_ALL_ID)>-1),B7=(parseInt(Bs.dfm,10)===1),Bt=(CA.unset===true),B6=(!B7&&Bt&&(B9&&B9.length===0)),Bq=(Br&&B8)||(B8&&!B7&&Bt)||(Br&&B7&&Bt&&B9&&B9.length===0);if(Bq){B9=B3;}else{if(B6){if(!Bu&&(Bs.sus!==1)){var B1=Bs.htot,By=(Bs.sus===2),Bz=(Bs.sus===4),CB=Bs.suc||1;B9=Au(B3,Br,By,Bz,CB,B1,this.include);}else{if(this.oces){B9=this.oces;}}}}}if(B9){var Bv={};BW.forEach(B9,function(CC){Bv[s(CC.v)]=true;});BW.forEach(B3,function(CD,CC){if(Bv[s(CD.v)]){Bw[CC]=true;}});}if(Bs.min>=0){this.min=Bs.min;}if(Bs.max>=0){this.max=Bs.max;}if(this.isRecursiveAttributeSelector()){this.levelForms=CA.lvfs||[];}},resetFormatHandlers:function K(){this.formatHandlers={contentNode:["RW"]};},_getSelectionCount:function BD(Bq){return AT.keyarray(Bq.selectedIndices).length;},getDynamicSelectionItemsString:function BG(){var Bu=this.defn,Br=Bu.sus,Bv=Bu.suc,Bt=Bu.include,Bq=Bt?mstrmojo.desc(17758,"First ##"):mstrmojo.desc(18429,"Not First ##"),Bw=Bt?mstrmojo.desc(17760,"Last ##"):mstrmojo.desc(18430,"Not Last ##"),Bs=(Br===Aa.FIRST?Bq:Bw).replace("##",Bv);return Bs;},canApply:function BU(Bu){var Bt=this.defn,Bv=Bt.multi,Bs=this.min,Bq=Bv?this.max:1,Br=this._getSelectionCount(Bu||this.content);return(Bs>=0&&Bq>=0&&Bs>Bq)||((Bs<0||Bs<=Br)&&(Bq<0||Bq>=Br));},_buildEvent:mstrmojo.emptyFn,buildPromptAnswerInfo:mstrmojo.emptyFn,selectorControlChange:function AD(B0){var Bw=this.node,Bt=Bw.data,Bx=Bw.defn,Bs=this.hasDynamicSelection(true),B3=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(B3&&Bt[w.DISABLED]&&Bs&&!Bt[w.ELMSREQUEST]){M.call(this,undefined,{onSuccess:function(){this.configDynamicSelection(Bx.sus,Bx.suc,true);this.selectorControlChange(B0);}.bind(this)});return ;}var Bu=X.call(this),B5=this.isInFilterPanel()&&this.getFilterPanel(),B1=(B5&&B5.isAutoApply()),Bv=mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation(),Br=Bx.style;this._buildEvent(Bu,B0);if(!this.canApply(B0)){var Bq=this.getPanelContainer();if(this.isInSearchBoxPanel(Bq)){Bq.set("canApplySbp",false);}if(B1){this.set("err",true);mstrmojo.alert(mstrmojo.desc(12297,"One or more selectors are incorrectly set. Please review the selector(s) and try again."));}if(B5){B5.set("applyEnabled",false);}return ;}if(B1){this.set("err",false);}if(mstrApp.isExpress&&Br===BV){this.handleExpressPulldown();}if(Bs){Bu.updateDSIcon=true;}if(Bu.requireToggle){this.deferredEvt=Bu;this.set("include",Bu.include);this.deferredEvt=undefined;}else{this.slice(Bu);}if(Bt.unset===true){Bt.unset=null;}if(Bx.unset){Bx.unset=null;}if(Bs||(Bv&&Br===Az)){this.refresh();}var Bz=this.model,By=Bz&&Bz.controller,B4=By&&By.view,B2=this.k,B6=this.defn&&this.defn._lkz;BW.forEach(B4&&B4.children,function(CB){var CA=CB.defn,B8=CA&&CA.loaded,B7=CA&&CA.units;if(B8&&CB.k!==B6){for(var B9 in B7){if(B9===B2){if(B7[B9].tsk!==""){CA.loaded=false;}break;}}}});},showInfoWin:function J(Bv){var By=this.node&&this.node.defn,Bs=By&&By.ifw,Br=this.model,Bt=[].concat(Br.getTargetInfoWin(Bs)).concat(Br.getTargetInfoWin(this.tks));if(Bt&&Bt.length){var B0=this.defn.horiz,Bq=Bv||this.contentNode,Bx=Ao.position(Bq),Bz=Ao.position(this.contentNode),Bw=(B0||parseInt(this.defn.style,10)===L)?null:{x:Bz.x,y:Bx.y,w:Bz.w,h:Bx.h},Bu;for(Bu=0;Bu<Bt.length;Bu++){Br.showInfoWin(Bt[Bu],Bq,B0?"v":"h",false,AT.copy(Bw));}}},unrender:function U(Bq){delete this.formatHandlers;this._super(Bq);},postBuildRendering:function AZ(){if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}var Bs=this.node.defn.style,Bu=this.filterNode.style,Bq=this.contentNode,Br=this.node.defn;if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(Br.ds,10)===A9);}this.handleActionInSyncPhase(this._super,this);if(mstrApp.isExpress&&Bs===BV){this.handleExpressPulldown();}if(this.isInFilterPanel()&&this.parent.adjustFP){this.parent.adjustFP();}if(this.formatHandlers.filterNode){var Bt=this.getFormats();if(!Bt.width){Bu.width=Bq.clientWidth+"px";}if(!Bt.height){Bu.height=Bq.clientHeight+"px";}}else{Bu.display="none";}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");if(Ao.isAndroid&&Bs===L){Bq.style.overflow="visible";}BF.toggleClass(this.parent.domNode,"invalid",this.isInvalid);this.updateAriaLabel();return true;},getSelectedItemAria:function BQ(){return"";},getStyleSpecificAria:function AC(){return"";},updateAriaLabel:function BI(){if(this.isPanelSelector()){return ;}var Bt=this.parent,Br=Bt.domNode,Bq=Br.getAttribute("aria-live"),Bs;if(Bt){if(Bq!=="polite"){Br.setAttribute("aria-live","assertive");Br.setAttribute("aria-relevant","text");}Bs=Bt.title+", "+this.getSelectedItemAria()+this.getStyleSpecificAria();if(Bs!==Bt.ariaLabel){Bt.set("ariaLabel",Bs);}}},updateHeight:function Bh(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var Bq=this.parent;if(Bq&&(Bq.defn.ttl!==undefined)&&Bq.updateContentHeight){Bq.updateContentHeight();}},handleExpressPulldown:function A1(){var Bu=this.contentNode.firstChild.firstChild;if(this.defn.optStyle){Bu.style.paddingTop="0";Bu.style.paddingBottom="0";Bu.style.overflowY="auto";Bu.style.height="auto";Bu.style.lineHeight="normal";var Bw=Bu.innerHTML;if(Bw===""){Bu.innerHTML="a";}var Bv=parseInt(window.getComputedStyle(Bu).height,10)||0;var Bt=parseInt(window.getComputedStyle(this.contentNode).height,10)||0;if(Bw===""){Bu.innerHTML=Bw;}Bu.style.height=Bu.style.lineHeight=(Bv===0?Bt:Math.min(Bt,Bv)+2)+"px";}else{var Bs=this.model.getZoomFactor();if(Bs!==1){var Bv=parseInt(window.getComputedStyle(Bu).height,10),Bq=Bv*Bs+"px";Bu.style.height=Bq;Bu.style.lineHeight=Bq;}}var Br=document.createElement("DIV");Br.setAttribute("class","mstrmojo-ui-Pulldown-arrow");Br.setAttribute("src","#");this.content.selectedNode.appendChild(Br);},handleActionInSyncPhase:function Bn(Bs,Br){var Bq=this._inSyncPhase;this._inSyncPhase=true;try{if(Br){Bs.call(Br);}else{Bs();}}catch(Bt){throw ("There was an error handling the selector action in sync phase.");}this._inSyncPhase=Bq;},onCGBMapChange:function Bk(Br){var Bq=Br.cgbMap;if(!Bq){return ;}var Bs=this.tks;AT.forEach(this.defn.cgb,function(Bu){var Bt=Bq[Bu];if(Bt&&Bs.indexOf(Bt)<0){Bs+=P+Bt;}});this.tks=Bs;},onAppStateChange:function AU(Bz){var By=mstrmojo.vi.VisualInsightApp.APP_STATES,B6=By.PAUSE,Bv=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),Bt=this.model,B1=this.node,B8=B1&&B1.data,Bs=B1.defn,Bx=Bt.updateCSKeysforPause,B2=this.k,B0=this.id;var B3=Bz.valueWas&B6,Bq=By.PRESENTATION,Bw=Bz.value&Bq,B7=(Bz.valueWas&Bq),Bu=mstrApp&&mstrApp.supportFeature(i.DYNAMIC_SEL_AND_SORT);if(B8){if(Bv&&!B3){if(this.hasAttrData()){var B4=(BW.indexOf(Bx,this.ckey)===-1)&&B8.elms&&(B8.elms.length>0),Br=this.style===Az,B5=B4&&!Br;B8[w.ELMSREADY]=B5;B8[w.CESREADY]=B4;B8[w.DISABLED]=!B4&&!Br;Bt.setDataReady(B2,B0,w.ELMSREADY,B5);Bt.setDataReady(B2,B0,w.CESREADY,B4);Bt.setDataReady(B2,B0,w.DISABLED,!B4&&!Br);if(!B5&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){B8[w.METRICVALUES]=!mstrConfig.resolveOnly;Bt.setDataReady(B2,B0,w.METRICVALUES,!mstrConfig.resolveOnly);B8[w.CSREADY]=true;if(this.isAttrQualSelector()&&this.children&&this.children.length){Bt.setDataReady(B2,B0,w.CSREADY,true,"cs",this.children[0].cs);}else{Bt.setDataReady(B2,B0,w.CSREADY,true);}}}}if(!Bv&&B3){if(this.hasAttrData()){B8[w.ELMSREADY]=B8[w.CESREADY]=B8[w.ELMSREQUEST]=B8[w.DISABLED]=false;Bt.setDataReady(B2,B0,w.DISABLED,false);Bt.setDataReady(B2,B0,w.ELMSREADY,false);Bt.setDataReady(B2,B0,w.CESREADY,false);Bt.setDataReady(B2,B0,w.ELMSREQUEST,false);}else{if(this.hasQualData()){B8[w.METRICVALUES]=B8[w.CSREADY]=false;Bt.setDataReady(B2,B0,w.METRICVALUES,false);Bt.setDataReady(B2,B0,w.CSREADY,false);}}}if(Bu){if(Bw){if(this.hasDynamicSelection(true)){this._dynamicSelDefn={sus:Bs.sus,suc:Bs.suc};}}else{if(B7){delete this._dynamicSelDefn;}}}}},update:function h(B9){this._super(B9);var B2=mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly,Bq=this.node&&this.node.data,Bv=B9.defn,Bw=this.model,Br=this.hasDynamicSelection(true);if(Bq){if(Bq.em&&Bq.pfec===BO.XJOIN_ERROR){mstrmojo.error({shortDesc:Bq.em.replace("%1","")});}else{if(B2){if(!B9.data){B9.data={};}var CA=B9.data,CE=Bq.ces||[],Bt=CE.length,Bz=Bq[w.ELMSREADY];if(Br&&Bz&&(Bt===0||Bt!==Bv.suc)){Bq.ces=AW(Bq.elms,Bv.sus,Bv.suc).ces;Bq[w.CESREADY]=true;}if(Bq[w.CESREADY]){CA.ces=Bq.ces;CA[w.CESREADY]=Bq[w.CESREADY];}else{if(!this.hasQualData()){CA.ces=B9.defn&&B9.defn.ces;CA[w.CESREADY]=true;Bw.setDataReady(this.k,this.id,w.CESREADY,true,"ces",CA.ces);}}if(Bz){CA[w.ELMSREADY]=Bz;CA.elms=Bq.elms;}if(Bq[w.DISABLED]){CA[w.DISABLED]=Bq[w.DISABLED];}if(Bq[w.METRICVALUES]){CA[w.METRICVALUES]=Bq[w.METRICVALUES];BY.restoreMetricSelectorProps(CA,Bq);}if(Bq[w.CSREADY]){CA[w.CSREADY]=Bq[w.CSREADY];BY.restoreMetricSelectorSelections(CA,Bq);}}}}this.node=B9;var CJ=this.node.data,CD=Bv.style,B6=CJ.elms,B4=this.parent,B7=(CD===L),Bu=(CD===Az),B8=this.isDynamicAttributeSelector();if(B2){if(CJ&&Bv){if(this.hasAttrData()){Bw.setDataReady(this.k,this.id,w.CESREADY,true);if(Bu){CJ.elms=CJ.ces;CJ[w.ELMSREADY]=false;CJ[w.DISABLED]=(Br&&!Bz)?true:false;Bw.setDataReady(this.k,this.id,w.ELMSREADY,CJ[w.ELMSREADY]);Bw.setDataReady(this.k,this.id,w.DISABLED,CJ[w.DISABLED]);}else{Bw.setDataReady(this.k,this.id,w.DISABLED,!Bq[w.ELMSREADY]);}if(!CJ[w.ELMSREADY]&&this.shouldDisableGdde()){this.isInvalid=true;}}else{if(this.hasQualData()){Bw.setDataReady(this.k,this.id,w.CSREADY,true);}}}}this.checkAndParseHTMLTags(B6);if(B7&&Bv.multi){var B3=BW.find(B6,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(B3>-1){CJ.del={idx:B3,elem:B6[B3]};BW.removeIndices(B6,B3,1);}}var CC=[].concat(B9.data.ces||[]),CH=this.defn.cek,CK=Bv.include,By=this.isUnset(),CB=this.getFilterPanel(),CG=CB&&!CB.isAutoApply(),B5=this.lockSelection&&CG&&!B2;if(Bv.sec&&!B5){if(B4&&(B4.count!==null&&B4.count!==undefined)){if((B7&&!Br)||B8){B4.set("count","");}else{if((CC&&B6&&B6.length)||Bv.sos){if(!CK){var CI=BW.find(CC,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(CI>=0){BW.removeIndices(CC,CI,1);}}var B0={};BW.forEach(B6,function(CL){B0[CL.v]=true;});CC=BW.filter(CC,function(CL){return B0[CL.v];});var Bs=CC,B1;if(!Bu){if(!Bv.multi){Bs=B6;}B1=B6;}if(By){if(Br){B4.set("count",this.getDynamicSelectionItemsString());}else{B4.set("count",BA.buildElemsCountStr(B1,B1));}}else{B4.set("count",BA.buildElemsCountStr(Bs,B1,this.isSelectionExcluded()));}}}}}if(this.content){this.content.allIdx=BW.find(this.node.data.elms,"v",BH);}this.initControlInfo();var Bx=this.content=this.updateWidget(this);if(Bu&&mstrApp&&mstrApp.isVI&&!Bw.findDatasetIdFromUnit(Bx.srcid)){Bx.srcid=null;Bx.richTooltip=null;}if(!Bx){this.set("visible",false);}else{if(B5){if(!B8){var CF=this._prevSelection;if(CF){if(CF.unset){this.clearSelector(!CG);}else{this.configDynamicSelection(CF.sus,CF.suc);}delete this._prevSelection;}else{if(CH){this.updateSelectionsByStyle(CH);}}}this.lockSelection=false;}}this.toggleControlOverlay(CJ);this.clearCache();if(parseInt(AT.walk("defn.t",B4),10)===BN.SELECTOR){B4.defn=this.node.defn;}this.defn=this.node.defn;},updateSelectionsByStyle:function B(Br){var Bu=mstrmojo.DocSelector.STYLES,Bt=this.content,Bq=this.style,Bs=this.node.data.elms,Bv={};if(Bq===Bu.SEARCH_BOX){Bt.set("items",Br);}else{BW.forEach(Br,function(Bx){var Bw=BW.find(Bs,"v",Bx.v||Bx);if(Bw>-1){Bv[Bw]=true;}});if(Bq===Bu.PULLDOWN||Bq===Bu.SCROLLER){if(Br.length===1&&!Br[0].v&&Br[0]===BH){Bt.selectedIndex=-1;}Bt.selectedIndices=AT.clone(Bv);Bt.onchange();}else{Bt.set("selectedIndices",Bv);}}},checkAndParseHTMLTags:function d(Bu){var Bs=this.defn,Bv=Bs.srcid,Br=this.model;if(Bs.srct===Y&&Bv&&Br.getBrowseFormTypes&&Br.getBrowseFormTypes(Bv).indexOf(A2)>-1){var Bq=document.implementation.createHTMLDocument("New"),Bw=Bq.body,Bt;BW.forEach(Bu,function(Bx){Bw.innerHTML=Bx.n;Bt=Bw.firstChild;Bx.n=Bt&&(Bt.text||Bt.alt)||Bx.n||"";});Bt=null;Bw=null;Bq=null;return true;}return false;},toggleControlOverlay:function BL(Br){var Bq=this.ctrlOverlay;if(!Bq){return ;}Bq.set("visible",!!(Br.em&&Br.pfec===BO.MDX_LIMIT_ERROR));},refresh:function AK(){var Bt=this.parent,Bs=this.node&&this.node.defn,Bu=Bt&&Bt.dynamicSelIcon,Bq=Bt&&Bt.dossierLevelIcon,Br=mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation();if(Bt&&Bt.generateToolbar){Bt.set((this.isInFilterPanel()?"baseTitle":"title"),Bs.ttl);Bt.generateToolbar();}if(Bt&&Bt.refreshFilterSummaryBar){Bt.refreshFilterSummaryBar();}if(Bu&&!Br){Bu.set("visible",this.isDsIconVisible(true));Bu.set("mode",this.isUnset());}if(Bq&&!Br){Bq.set("visible",Bs.sync);}this._super();if(Bt&&Bt.fc&&Bt.updateContentHeight){Bt.updateContentHeight();}this.checkWhetherRestoreFocus();},checkWhetherRestoreFocus:function A4(){var Bt=false;if(this.isPanelSelector()){var Bq=AT.walk("parent.parent",this);if(Bq){if(this.tks){var Br=Bq.getUnitByKey(this.tks),Bs=Br&&Br.boxContent;if(Bs&&Bs.selectedPanelKey===this.k){Bt=true;}}}}if(this.isAMSelector()&&this.selectByKey){Bt=true;this.selectByKey=false;}if(Bt){this.buildNavList();this.restoreFocus();}},onselectAllChange:function Bg(Bz){var Br=this.children&&this.children[0],Bx=Br.items,Bq=Br.allIdx,Bt=Br.selectedIndices,By,Bw=[];if(Bz.value){if(Bt[Bq]){Br.removeSelect(Bq,true);var Bv=Br.itemRenderer,Bu=Bv&&Bv.unselect;if(Bu){var Bs=Br._getItemNode(Bq);if(Bs){Bu(Bs,Bx[Bq],Bq,Br);}}}for(By=0;By<Bx.length;By++){if(By!==Bq&&!Bt[By]){Bw.push(By);}}Br.addSelect(Bw);}else{for(By in Bt){Bw.push(parseInt(By,10));}Br.removeSelect(Bw);}},changeFilterTechnique:function n(){var By=this.node.defn,Bz=this.k,Bq=By.pdf=!By.pdf,Bw=this.model,Br=this.isInFilterPanel()&&this.getFilterPanel(),Bu=By.tks?By.tks.split(P):[],Bt=[Bz].concat(Bu),Bs=Bw.getDataService(),Bv=Bs.getUseAlternateFilterTechniqueAction(By.ck,By.ckey,By.ct,Bt,Bq),Bx=Bs.newUpdate(Br);if(Br&&Br._bufferedSlices){Br.applyBufferedSlices(true,Bx);}this.model.controller.submitUndoRedoUpdates((Bx.actions||[]).concat(Bv),null,{success:function(B1){var B0=Bt.join(P);Bw.partialUpdate(B1.data,Bw.getTargetDefn(B0),B1.defn,[Bz]);}},Bo);},onincludeChange:function Bl(B0){var Bs=this.node.defn,Bq=B0.value,Bt=this.model,Br=this.isInFilterPanel()&&this.getFilterPanel(),Bx=Bt.getDataService().newUpdate(Br),B5=Br&&Br._bufferedSlices;Bs.include=this.include=Bq;if(B5){Br.applyBufferedSlices(true,Bx);}if(this.style!==R&&this.style!==e){var B6=X.call(this),B4=this.ckey;B6.ckey=B4;B6.changeInclude=true;if(Bs.srct===Y||Bs.srct===AA){var B7=this,B2=this.model,B3=this.node.k,B1=B2.getDataService(),Bz=B2.getSliceCallback(B6),Bv=this.isDynamicAttributeSelector(),By=[B1.getSelectorShowAllAction({ck:Bs.ck,ckey:Bs.ckey,type:Bs.type,showAll:Bq}),B1.getSelectorIncludeAction({ck:Bs.ck,ckey:Bs.ckey,type:Bs.type,include:Bq})],Bu=AV(Bz,{success:function(B9){B7.set("wait",false);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()){B7.toggleDisplayAll(Bq);}if(!Bv){var CA=B2.getTargetDefn(B3),B8=CA[B3];B8.include=Bq;B8.showall=Bq;B2.partialUpdate(B9.data,CA);}if(!B7.isInFilterPanel()&&B7.parent){B7.parent.selectVIUnit(true);}}});this.showall=this.defn.showall=Bq;var Bw=this.deferredEvt;if(!!Bw){B2.sliceDeferred(Bx,Bw);}By=!!Bw?By.concat(Bx.actions):(Bx.actions||[]).concat(By);this.set("wait",true);B2.controller.cmdMgr.execute({execute:function(){this.submit(By,Bu);},urInfo:{extraPuKeys:Bs.ck.split(P).slice(1),treesToRender:3}});}else{this.slice(B6);}}},getSelectorStyleList:function f(){var Bs=[],Bv=this.defn.srct,Br=this.node,Bq=Br&&Br.defn,Bu=Br&&Br.data;if(Bq.ct==="8"){return Ba;}if(mstrApp.isVI&&Bq.ct==="3"){return An;}if(this.useAttrStyle()){var Bw=!this.isInFilterPanel();if(this.isRecursiveAttributeSelector()){return[{n:mstrmojo.desc(4733,"Check Boxes"),v:BB},{n:mstrmojo.desc(8967,"Search Box"),v:Az},{n:mstrmojo.desc(4729,"Drop-down"),v:BV}];}Bs=[{n:mstrmojo.desc(4733,"Check Boxes"),v:BB},{n:mstrmojo.desc(4730,"Slider"),v:L}];if(Bv===Y){Bs.push({n:mstrmojo.desc(8967,"Search Box"),v:Az});}if(Bw){Bs=Bs.concat([{n:mstrmojo.desc(4735,"Link Bar"),v:AS},{n:mstrmojo.desc(4734,"Button Bar"),v:Ai}]);}Bs=Bs.concat([{n:mstrmojo.desc(4732,"Radio Buttons"),v:BJ},{n:mstrmojo.desc(4729,"Drop-down"),v:BV}]);if(Bw){Bs=Bs.concat([{n:mstrmojo.desc(6738,"List Box"),v:D}]);}var Bt=AY.getUnitFromDataset(this.model.datasets,this.defn.srcid,12);if(Bu.fid&&(Bt&&!Bt.de)){Bs.push({n:mstrmojo.desc(5443,"Calendar"),v:e});}}else{if(Bv===N){if((mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig.resolveOnly)&&Bq&&Bq.style!==R&&!(Bu&&Bu.max&&Bu.min)){Bs=[{n:mstrmojo.desc(5225,"Qualification"),v:Bm}];}else{Bs=[{n:mstrmojo.desc(4730,"Slider"),v:R},{n:mstrmojo.desc(5225,"Qualification"),v:Bm}];}}}return Bs;},supportsInclude:function H(){var Bq=this.defn;if(this.isRecursiveAttributeSelector()){return !this.isDynamicAttributeSelector();}return((Bq.srct===Y&&!this.hasDE)||(Bq.srct===N&&Bq.style===R))&&!this.isSolrSelector()&&!mstrApp.isInVFConfigMode;},isSelectionExcluded:function z(){return this.isDynamicAttributeSelector()&&!this.defn.include;},isSolrSelector:function A8(){return this.model.isFromSolrCube(this.defn.srcid);},isMetricSelector:function S(){return this.defn.srct===N;},isRankMetricSelector:function C(){var Bq=F.call(this).f;return Bq&&typeof Bq==="string"&&Bq.search(/rank/i)===0;},isNumericMetricSelector:function Ak(){var Bq=F.call(this).dt;return this.model.isNumericDataType(Bq);},isAttributeSelector:function Aj(){return this.defn.srct===Y;},supportsShowAllToggle:function g(){return this.defn.srct===Y||this.defn.srct===AA||(this.defn.srct===Ay&&this.defn.srcst===BK);},useAttrStyle:function u(){var Bq=this.defn.srct;return Bq===Ay||Bq===Y||Bq===AA;},hasAttrData:function Ad(){return this.useAttrStyle()&&!this.isAttrQualSelector();},hasQualData:function b(){return this.isAttrQualSelector()||this.isMetricSelector();},isDerivedAttributeSelector:function a(){return this.defn.srct===Y&&this.defn.srcst===Aw;},isNewDerivedElementSelector:function Z(){return this.isConsolidationSelector()&&this.defn.srcst===AR;},isNewDerivedRecursiveElementSelector:function A6(){return this.isNewDerivedElementSelector()&&this.defn.ndetype===Ap.DssRecursiveDerivedElement;},isAttrQualSelector:function p(){return this.defn.srct===Y&&this.defn.style===e;},isRecursiveAttributeSelector:function As(){var Bq=this.defn;return Bq.srct===Y&&Bq.srcst===BS||this.isNewDerivedRecursiveElementSelector();},isDynamicAttributeSelector:function BM(){return this.isRecursiveAttributeSelector()&&this.isInFilterPanel()&&this.defn.style===BB;},allowsOrientationChange:function Ax(){return !this.isAttrQualSelector()&&!Al.call(this,[Az,D,BV,L,R,Bm]);},isSearchBox:function BX(){return Al.call(this,[Az]);},isVisFilter:function Be(){return Al.call(this,[E]);},isAttrElemListSelector:function Ar(){return this.defn.srct===Y&&this.defn.style!==e;},isCGSelector:function Ab(){return this.defn.srcst===BK;},isConsolidationSelector:function Bc(){return this.defn.srct===AA;},isSlicingSelector:function A(){return this.isCGSelector()||this.isConsolidationSelector();},isGeoSelector:function AG(){var Bq=AY.getUnitFromDataset(this.model.datasets,this.defn.srcid,12);return !!Bq&&AY.isGeoAttr(Bq);},isUnset:function c(){return !!(this.node.data.unset||this.defn.unset);},hasDynamicSelection:function AO(Bq){return(this.defn.sus>Aa.UNSET)&&(!Bq||this.isUnset());},shouldDisableGdde:function AL(){return this.isCGSelector()||this.isGeoSelector();},getInvalidTooltip:function y(){var Br=mstrmojo.desc(15787,"Unable to retrieve the list of elements for this filter")+mstrmojo.desc(1006,"."),Bq=" "+mstrmojo.desc(15931,"Please resume data retrieval to use this filter.");if(this.isCGSelector()){Br=mstrmojo.desc(15924,"This Filter is based on a Custom Group, which is not supported when data retrieval is paused.")+Bq;}else{if(this.isGeoSelector()){Br=mstrmojo.desc(15932,"This filter is based on a Geo Attribute, which is not supported when data retrieval is paused.")+Bq;}}return Br;},slice:function j(Bt){var Bq=this.model;if(Bt&&Bt.eid){Bt.eid=s(Bt.eid);}if(Bq.closeSelWarnFlag){Bq.closeSelWarnFlag(this.k);}if(this.isInFilterPanel()){var Br=this.getFilterPanel();if(Br&&!Br.isAutoApply()){Br.bufferSlice(Bt);return ;}}var Bu=this.getPanelContainer();if(this.isInSearchBoxPanel(Bu)){Bu.parent.bufferSlice(Bt);Bu.set("canApplySbp",Bu.canApplySearchBoxPanel());return ;}var Bs=Bu&&Bu.parent;if(Bs&&Bs.bufferSlice&&Bs.hasDisabledSelectionApply&&Bs.hasDisabledSelectionApply()&&Bt&&!Bt.forceApply){Bs.bufferSlice(Bt);return ;}Bq.slice(Bt);},isInFilterPanel:function A5(){var Bq=this.parent;return(Bq&&Bq.isInFilterPanel&&Bq.isInFilterPanel())||false;},isHorizFP:function AF(){var Bq=this.parent;return(Bq&&Bq.isHorizFP&&Bq.isHorizFP())||false;},getFilterPanel:function O(){var Bq=this.parent;return(Bq&&Bq.getFilterPanel&&Bq.getFilterPanel())||null;},isInSearchBoxPanel:function(Bq){var Br=Bq||this.getPanelContainer();return Br&&(Br.isSbp||(Br._isSearchBoxPanel&&Br._isSearchBoxPanel()));},getPanelContainer:function(){var Bq=BN,Br;for(Br=this.parent;Br&&Br.defn;Br=Br.parent){if(parseInt(Br.defn.t,10)===Bq.PANEL){return Br;}}return null;},clearSelector:function A7(Bq){var B3=X.call(this),By=[BH],B2=this.node.data.elms||[],B7=this.style,Br=this.defn.include,Bt=this.isFilterNothing&&this.isFilterNothing(),Bv=this.node.defn,B9=Bv.srcst===257||(Bv.srct===47&&Bv.srcst!==12033),CC=mstrApp&&mstrApp.getSelectAllForUnsetForVI&&mstrApp.getSelectAllForUnsetForVI(),B6=[Bb],Bu=w.CESREADY,Bw="ces",B4=[],B0=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),B1=this.parent;if(B7===Az){if(CC){B3.eid=By.join(P);B4=B6;}else{B3.ckey=this.ckey;B3.unset=true;}this.defn.set("cek",[]);}else{if(B7===R||B7===Bm){B3.cs="";B3.ckey=this.ckey;B3.unset=true;Bv.set("cek",{cs:null,qua:this.qua,include:Br,f:null,ft:null});Bu=w.CSREADY;Bw=["f","ft","cs"];B4=[null,null,""];}else{if(B7===e){B3.unset=true;B3.ckey=this.ckey;var Bz=[{v:""},{v:""}];Bv.set("cek",{cs:Bz});Bu=w.CSREADY;Bw="cs";B4=Bz;}else{if(CC){B3.eid=By.join(P);B4=B6;}else{B3.ckey=this.ckey;B3.unset=true;}var CB;if((Br||B7===L)&&this.multi){BW.forEach(B2,function(CE){var CD=CE.v;if(By[0]!==CD){By.push(CD);if(!CB){CB=[CE];}}});}var Bx=Br||B7===L;if(!B9){Bv.set("cek",Bx?By:[]);B4=Bx?B6:[];if(!Bx&&this.content&&this.content.text){this.content.text="";}}else{if(B0){Bv.set("cek",(Bx&&By.length>1)?[By[1]]:[]);}B4=CB||[];}Bw="ces";}}}if(Bv.sec){B1.set("count",(B7===Az||B7===L)?"":BA.buildElemsCountStr(By,B2,this.isSelectionExcluded()));}B3[Bq?"forceApply":"forceBuffer"]=true;if((Bt&&!B9)||B0){B3.ignoreTargetData=true;}B3.retrieveCtrlKey=B9;if(B0){var B8=this.model,CA=B8.getCurrentLayoutDef(),B5=CA&&CA.units,Bs=this.k;if(B5&&B5[Bs]){B5[Bs].cesChange=false;}B8.setDataReady(Bs,this.id,Bu,true,Bw,B4);}if(this.hasDynamicSelection()){delete Bv.sus;delete Bv.suc;this.node.data.unset=true;B3.resetSuc=true;B3.updateDSIcon=true;if(!Bq||B0){this.refresh();}}this.slice(B3);},configDynamicSelection:function AM(B8,Bs,Br){var Bu=this.defn,CA=this.node.data,By=CA.elms||[],Bz=X.call(this),B3=this.isInFilterPanel()&&this.getFilterPanel(),Bw=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),Bv=B3&&!B3.isAutoApply(),Bt=this.style===mstrmojo.DocSelector.STYLES.SEARCH_BOX,Bx=this.parent,B7=this.model,B6=[],B5={};Bz.dynamicSelection=true;Bz.sus=B8;Bz.suc=Bs;Bz.refreshDefn=true;Bz.updateDSIcon=true;if(Bv||Bw){Bu.sus=B8;Bu.suc=Bs;CA.unset=true;if(((Bt&&!this.lockSelection)||(Bw&&!CA[w.ELMSREADY]))&&!CA[w.ELMSREQUEST]){M.call(this,undefined,Bt&&!Bw?{onSuccess:this.configDynamicSelection.bind(this,B8,Bs,true)}:undefined);}else{B5=AW(By,B8,Bs);Bu.set("cek",Bt?B5.ces:B5.cek);this.selIdx=this.content.selectedIndices;if(Bu.sec){Bx.set("count",this.getDynamicSelectionItemsString());}this.refresh();}if(Bw){var B9=B7.getCurrentLayoutDef(),B4=B9&&B9.units,Bq=this.k,B2=B3?B3:B7.getVIComponent(Ah.VIZ_CONTENT);if(B4&&B4[Bq]){Bz.forceApply=true;B4[Bq].cesChange=false;B2.clearSingleBuffSlice(Bq);}B7.setDataReady(Bq,this.id,w.CESREADY,true,"ces",B5.ces);Bz.ignoreTargetData=true;}}if(!Bw){var CB=B7.getCurrentLayoutSelectorDefn(),B1=B3?CB.filterPanelSelectors:CB.canvasSelectors,B0=function(CD){var CC=CD?CD.split(P):[];BW.forEach(CC,function(CE){var CF=B1[CE],CG;if(CF&&CF.sus){CG=B7.getDataNode(CE);if(CG&&CG.unset&&(B6.indexOf(CE)===-1)){B6.push(CE);B0(CF.tks);}}});};if(Object.keys(B1).length>2){B0(Bu.tks);}Bz.updateKeys=B6;}if(!Br){this.slice(Bz);}},isDsIconVisible:function BT(Bq){return this.hasDynamicSelection()&&!this.hasQualData()&&(Bq?this.isInFilterPanel():true);},createDynamicSelectionIcon:function AB(){var Br=this,Bq=this.defn,Bs=this.isUnset();var Bt=new mstrmojo.Widget({visible:this.isDsIconVisible(true),mode:Bs,markupString:'<div class="'+(Bs?"on":"off")+'" mstrAttach:click></div>',useRichTooltip:true,tooltipOpenDelay:100,updateTooltipConfig:function(){var Bu=this.mode?mstrmojo.desc(17767,"Dynamic Filter On"):mstrmojo.desc(17759,"Dynamic Filter Off");this.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:Bu,refNode:this.domNode,top:30,left:10,posType:mstrmojo.tooltip.POS_TOPCENTER,};},onclick:function(){if(BF.hasClass(this.domNode,"off")){var Bu=Bq.multi?Bq.suc:1;Br.configDynamicSelection(Bq.sus,Bu);}else{Br.selectorControlChange(Br.content);}},markupMethods:{onvisibleChange:function(){BF.toggleClass(this.domNode,"dynamicSelection",this.visible);},onmodeChange:function(){BF.toggleClass(this.domNode,"off",!this.mode);BF.toggleClass(this.domNode,"on",this.mode);}}});return Bt;},enterUnit:function(){this.resetTabNav();this.grabFocus();this.navigateToFirstValidTarget();},allowsTogglingMultiSelect:function Am(){return !this.isPanelSelector()&&Al.call(this,[BV,Ai,AS,Az,L,D]);},allowsTogglingAutoSearch:function AN(){return !this.isRecursiveAttributeSelector()&&Al.call(this,[Az]);},allowsSameSizeItems:function Ac(){return !this.isPanelSelector()&&Al.call(this,[BB,BJ,Ai,AS])&&!this.isRecursiveAttributeSelector();},supportsSetTarget:function o(){var Bq=this.defn;return this.isAttrElemListSelector()||this.isSlicingSelector();},supportSelectionColor:function AQ(){return Al.call(this,[D,AS]);},isAMSelector:function q(){return !(mstrApp&&mstrApp.isExpress)&&this.defn.ct==="8";},isPanelSelector:function Af(){return !(mstrApp&&mstrApp.isExpress)&&this.defn.ct==="3";},isLinkBar:function Aq(){return this.style===AS;},hideTitleCtrl:function A3(){return this.isPanelSelector();},});mstrmojo.DocSelector.UC_ON_DS=BP;mstrmojo.DocSelector.STYLES={PULLDOWN:BV,SCROLLER:L,LIST:D,RADIO:BJ,CHECKBOX:BB,BUTTON:Ai,LINK:AS,METRIC_SLIDER:R,METRIC_QUAL:Bm,SEARCH_BOX:Az,TEXT_BOX:x,ATTR_QUAL:e,VISUALIZATION:E};mstrmojo.DocSelector.DATAPARAMS={CESREADY:"cesReady",ELMSREADY:"elmsReady",ELMSREQUEST:"elemsRequest",METRICVALUES:"metricValues",CSREADY:"csReady",DISABLED:"disabled"};mstrmojo.DocSelector.UNSET_STATUS={UNSET:1,FIRST:2,LAST:4};mstrmojo.DocSelector.SYNC_STATUS={UNSYNC:0,SYNC:1};var w=mstrmojo.DocSelector.DATAPARAMS,Aa=mstrmojo.DocSelector.UNSET_STATUS;mstrmojo.DocSelector.UnitTest_API={getDynamicSelSelectedItems:AW};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.XtabZone","mstrmojo.css","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var g=0,A=1,AF=2,K=3,o={1:"_BL",2:"_TR",3:"_TL"},AN=1,AB=2,u={position:"absolute",overflow:"hidden",width:"auto"},y={position:"absolute",top:0,left:0},F=mstrmojo.css,i=mstrmojo.hash,m=mstrmojo.dom,p=mstrmojo.array;function M(AR,AQ,AO,AP){if(AP){AR.replaceChild(AQ,AR.tBodies[AO]);}else{AR.appendChild(AQ);}}function J(AO){AO.offsetCellNode=null;AO.fstValueCellValidation=null;}function W(){var AU={x:0,y:0};if(this.lockHeadersCase&&!this.offsetCellNode&&!this.fstValueCellValidation){var AV=this.titlesCP.getSpanDimension(),AO=AV.nRow,AS=AV.nCol,Ad=this.scrollboxNode.firstChild.firstChild,AZ=Ad&&Ad.rows[AO];if(AO===0||AS===0){this.lockHeadersCase=g;return null;}if(!Ad.rows.length){return null;}if(!AZ){this.fstValueCellValidation|=AN;this.lockHeadersCase&=AN;AZ=Ad.rows[0];}var Ac=AZ&&AZ.cells,AY=(Ac&&Ac.length)||0,AQ,AW,AX;for(AW=AX=0;AW<AY&&AX<AS;AW++){AX+=Ac[AW].colSpan||1;}AQ=Ac&&Ac[AW];if(!AQ){this.fstValueCellValidation|=AB;this.lockHeadersCase&=AB;this.offsetCellNode=Ac&&Ac[0];}else{this.offsetCellNode=AQ;}var Ab=this;var AR=function(){Ab._adjustClipSize();};var AT=function(Ai,Al){var Ag,Af,Ae,Aj,Ah,Ak;Al=Math.min(Ai.rows.length,Al);for(Ag=0;Ag<Al;Ag++){Ae=Ai.rows[Ag].getElementsByTagName("img");for(Af=0;Af<Ae.length;Af++){Aj=Ae[Af];Ah=Aj.onload;Ak=Ah?function(){Ah.call(this);AR();}:AR;Aj.onload=Ak;Aj.onerror=Ak;}}};AT(Ad,AO||0);}if(this.lockHeadersCase){var Aa=m.position(this.offsetCellNode),AP=m.position(this.scrollboxNode.firstChild);AU.x=Aa.x-AP.x;AU.y=Aa.y-AP.y;}return AU;}function P(AQ,AO,AP,AU){if(this.parent.isAutoTableLayout()&&this.isRendered()){if(!this.fragment){this.fragment=document.createDocumentFragment();}if(AU){var AR=AQ.cloneNode(true);if(!this.renderedPages){x.call(this);}if(AP&&this.renderedPages[AO]){var AT=this.renderedPages[AO],AS=this.getTableNode();if(AT.parentNode===AS){AS.replaceChild(AR,AT);}else{this.fragment.replaceChild(AR,AT);}}else{this.fragment.appendChild(AR);}this.renderedPages[AO]=AR;}}}function AI(AP,AO){for(var AQ in AP){if(AP[AQ]!=AO[AQ]){return false;}}return true;}function z(){var AP=this.fragment,AO,AS,AQ;if(AP&&AP.childNodes.length>0&&this.isRendered()){var AR=this.getTableNode();if(this.parent.isOutlineMode){while(AP.childNodes.length>0){AO=AP.childNodes[0];AS=parseInt(AO.getAttribute("n"),10);if(AR.tBodies[AS]){AR.replaceChild(AO,AR.tBodies[AS]);}else{AR.appendChild(AO);}}}else{AR.appendChild(AP);}}}function w(){var AP=this.xtabClonedNodes,AT=this.cellHoverMgr,AR,AS,AO,AQ;if(!AT){return ;}for(AO in AP){AR=AP[AO];AQ=AR.getID();AS=AR.isRendered();if(!this.zones[AQ]&&AS){this.zones[AQ]={tableNode:AR.getTableNode()};if(typeof (AT)!="string"){AT.addMgrElement(AQ);}}}}function O(AP,AO){var AQ=this.parent,AR=AQ&&AQ.zone;if(AO&&AR&&AR.addCoverTable){AR.addCoverTable(AP,AO);}if(AQ.hasAccessibility){F.addClass(AO.parentElement,"gridAccessible");AO.tabIndex="-1";}}function s(AP,AO,AQ){AP.width=((AQ&&AQ.width<AO.right)?AQ.width:AO.right)+"px";AP.height=((AQ&&AQ.height<AO.bottom)?AQ.height:AO.bottom)+"px";}function x(){this.renderedPages={};var AT=this.getTableNode(),AP=AT.tBodies,AQ=this.fragment,AV=AQ&&AQ.children,AS=this.renderedPages,AO,AR,AU=function(AW){var AX=AW.getAttribute("n")||0;AS[AX]=AW;};for(AR=0,AO=AP.length;AR<AO;++AR){AU(AP[AR]);}for(AR=0,AO=(AV&&AV.length)||0;AR<AO;++AR){AU(AV[AR]);}}function L(AS,AO,AP){var AQ=AO&&AO.rows[AS.row],AR=AQ&&AQ.cells[AS.cell];if(AR&&AP!==AR){AQ.replaceChild(AP.cloneNode(true),AR);}}function S(AP,AO){if(this.isRendered()){if(!this.renderedPages){x.call(this);}L(AP,this.renderedPages[AP.page||0],AO);}}function D(AP,AR){var AO=AP&&AP.tBodies[AR.page||0],AQ=AO&&AO.rows[AR.row];return AQ&&AQ.cells[AR.cell];}mstrmojo.XtabZoneWithClonedCover=mstrmojo.declare(mstrmojo.XtabZone,null,{scriptClass:"mstrmojo.XtabZoneWithClonedCover",isAutoTBLayout:null,addCoverTable:function N(AO,AP){if(!this.coverTableNodes){this.coverTableNodes={};}this.coverTableNodes[o[AO]]=AP;},getClonedNodesByPositions:function R(AV){var AU=this.coverTableNodes,AP=AU&&AU[o[K]],AX=AU&&AU[o[AF]],AR=AU&&AU[o[A]],AQ=[AP,AX,AR],AO,AY,AT=[];for(var AS in AV){AO=AV[AS];if(AO.page&&AR){AY=D(AR,AO);if(AY){AT.push(AY);}}else{for(var AW in AQ){if(AQ[AW]){AY=D(AQ[AW],AO);if(AY){AT.push(AY);}}}}}return AT;},getSpecClonedNodesByPositions:function b(AT){var AO,AV=[],AQ,AS,AR=this,AW=this.coverTableNodes&&this.coverTableNodes[o[A]],AU=this.coverTableNodes&&this.coverTableNodes[o[AF]],AP=function(AX,AY){p.forEach(AY,function(AZ){AO=D(AX,AZ);if(AO){AV.push(AO);}});};p.forEach(AT,function(AX){AQ=AX._ei;AS=AR.eiMap[AQ]||(AR.posMap[AQ]&&[AR.posMap[AQ]])||[];if(AX.axis===1){AP(AW,AS);}else{AP(AU,AS);}});return AV;},setHilites:function X(AY,AS){var AT=AS.getAttribute("ei"),AX=this.eiMap[AT]||(this.posMap[AT]&&[this.posMap[AT]])||[],AV=this.hiliteCellsMap,AR=this.parent,AP=this.getNodesByPositions(AX),AO=function(AZ){F.addClass(AZ,"sc_"+AR.k);};if(!AV[AY]){AV[AY]={pos:[],nodes:[]};}if(!AP.length){AO(AS);AV[AY].nodes.push(AS);}else{if(AX.length!==0){var AQ=this.getClonedNodesByPositions(AX),AW=AV[AY].pos;AP=AQ.concat(AP);for(var AU in AP){AO(AP[AU]);}AV[AY].pos=AW.concat(AX);}}},clearHilites:function C(AP){var AS=this.hiliteCellsMap[AP],AQ=AS&&AS.nodes,AT=(AQ&&AQ.length===0&&AS.pos)||[],AR=this.parent;if(AT.length!==0){AQ=this.getNodesByPositions(AT);AQ=AQ.concat(this.getClonedNodesByPositions(AT));}for(var AO in AQ){F.removeClass(AQ[AO],"sc_"+AR.k);}this.hiliteCellsMap[AP]={nodes:[],pos:[]};},isAutoTableLayout:function AG(){if(this.isAutoTBLayout===null&&this.tableNode){this.isAutoTBLayout=(this.tableNode.style.tableLayout!=="fixed");}return this.isAutoTBLayout;},unrender:function B(AO){this.coverTableNodes={};this.isAutoTBLayout=null;this._super(AO);}});mstrmojo.XtabClonedNode=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabClonedNode",domNode:null,left:0,top:0,lockType:g,scrollDM:mstrmojo.emptyFn,refreshNode:mstrmojo.emptyFn,createDomNode:function f(){var AO=this._getClonedFragment();this.containerNode.appendChild(AO);O.call(this,this.lockType,this.getTableNode());},getID:function Y(){return this.id;},getTableSize:function d(){var AP=this.parent.zone.tableNode,AO=this.parent.hasCustomScrollbar?"offset":"client";return{width:AP[AO+"Width"],height:AP[AO+"Height"]};},isRendered:function I(){return !!this.domNode;},getTableNode:function AL(){return this.isRendered()?this.domNode.firstChild.firstChild:null;},destroy:function AC(AO){if(this.isRendered()){this.unrender(true);}this._super(AO);},unrender:function B(AO){this.domNode=null;this.lastClipRect=null;this._super&&this._super(AO);},insertPage:function AM(AQ,AO,AP,AR){if(this.isRendered()){M(this.getTableNode(),AQ.cloneNode(true),AO,AP);}},_getClipStr:function e(AO){this.lastClipRect=AO;return"rect("+AO.top+"px, "+AO.right+"px, "+AO.bottom+"px, "+AO.left+"px)";},adjustClip:function h(AQ){var AO=this._getClipRect&&this._getClipRect(AQ);if(this.isRendered()){if(this.getTableNode().offsetHeight>this.domNode.offsetHeight){this.domNode.style.height=this.getTableNode().offsetHeight+"px";}if(AO&&!(this.lastClipRect&&AI(AO,this.lastClipRect))){this.domNode.style.clip=this._getClipStr(AO);var AP={};s(AP,AO,this.getTableSize());i.copy(AP,this.curtainNode.style);}}this.offset=AQ;}});mstrmojo.XtabClonedRowHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedRowHeader",lockType:A,interactiveCellsArray:[],interactivePosArray:[],dicGroupKey:[],init:function AJ(AO){this._super(AO);if((this.lockHeadersCase&A)&&this.left){this.createDomNode();}},_getClipRect:function E(AP){var AO=this.parent.hasCustomScrollbar?"offset":"client";AP=AP||this.offset;return{top:0,right:AP.x||0,bottom:this.toCloneNode[AO+"Height"],left:0};},_clearLocalData:function H(){this.interactiveCellsArray=[];this.interactivePosArray=[];this.dicGroupKey=[];},_getClonedFragment:function c(){var AU=document.createDocumentFragment(),AP=this.toCloneNode.cloneNode(true),AT=document.createElement("div"),AV=i.clone(u),AO=i.clone(y),AS=this._getClipRect();AV.clip=this._getClipStr(AS);AV.zIndex=2;if(this.parent.zone&&this.parent.zone.autoFitWindow){AV.width="100%";}AV.overflowY="hidden";AP.id=this.getID();i.copy(AV,AP.style);i.copy({top:-this.top+"px"},AP.firstChild.style);this.domNode=AP;s(AO,AS,this.getTableSize());AO.zIndex=1;i.copy(AO,AT.style);this.curtainNode=AT;AU.appendChild(AP);AU.appendChild(AT);var AR=this.parent.scrollboxNode,AW=mstrmojo.dom.isFF?"DOMMouseScroll":"wheel",AQ=function(AX){var Aa=AR.scrollTop,AY=Math.floor((AR.scrollHeight-AR.clientHeight)-Aa),AZ=Math.max(-1,Math.min(1,(AX.wheelDelta||-AX.detail||-AX.deltaY)))*60;if(Aa===0&&AZ>0){return ;}else{if(AZ<0&&AY===0){return ;}}AX.preventDefault();AX.stopPropagation();AR.scrollTop-=AZ;};AP.addEventListener(AW,AQ,false);return AU;},scrollDM:function k(AP,AV,AX){var AQ=this.parent.shouldClipLockableXtab,AR;if(this.lockHeadersCase&A){if(!this.isRendered()){this.top=AV;this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";var AU=this;setTimeout(function(){AU._updateDICGroup();if(AU.parent){AU.parent.updateSelectionsForCopy(AU.getTableNode());}},10);}else{var AW=this.domNode.firstChild,AO=AW.style;AO.top=-AV+"px";this.top=AV;if(AQ){if(AO.position!=="absolute"){AO.position="absolute";AO.width="100%";}if(this.lockHeadersCase&AF){AR={top:this.offset.y+AV,right:this.offset.x,bottom:AW.offsetHeight,left:0};AO.clip=this._getClipStr(AR);}}}if(AQ&&this.isRendered()){var AZ=this.getTableNode();AR={top:0,right:Math.max(AZ.offsetWidth,AX.offsetWidth),bottom:Math.max(AZ.offsetHeight,AX.offsetHeight),left:this.offset.x+AP};var AT=AX.style,AS=AX.parentNode,AY=AS.style;if(AT.position!=="absolute"){if(isNaN(parseInt(AY.width,10))){AY.width=AS.offsetWidth+"px";}if(isNaN(parseInt(AY.height,10))){AY.height=AS.offsetHeight+"px";}AT.position="absolute";AT.width="100%";if(isNaN(parseInt(AY.width,10))){AY.width=AR.right+"px";}}AT.clip=this._getClipStr(AR);}}},_updateDICGroup:function n(){var AO=this.parent;if(this.interactivePosArray.length&&this.interactiveCellsArray.length){AO.destroyDICGroup(this.dicGroupKey);AO.configureCellsAction(this.interactiveCellsArray,0,this.interactivePosArray,true);}this._clearLocalData();},addTempDICInfo:function AH(AO,AP){if(!this.isRendered()){this.interactiveCellsArray.push(AO);this.interactivePosArray.push(AP);}},addGroupKey:function AK(AO){if(!this.isRendered()){this.dicGroupKey.push(AO);}},onCellUpdated:function AA(AT,AQ){if(this.isRendered()){var AO=this.getTableNode(),AP=AO&&AO.tBodies[AT.page||0],AR=AP&&AP.rows[AT.row],AS=AR&&AR.cells[AT.cell];if(AS&&AQ!==AS){AR.replaceChild(AQ.cloneNode(true),AS);}}},unrender:function B(AO){this._clearLocalData();this._super&&this._super(AO);}});mstrmojo.XtabClonedColHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedColHeader",lockType:AF,init:function AJ(AO){this._super(AO);if(this.lockHeadersCase&AF){this.createDomNode();}},_getClipRect:function E(AP){var AO=this.parent.hasCustomScrollbar?"offset":"client";AP=AP||this.offset;return{top:0,right:this.toCloneNode[AO+"Width"],bottom:AP.y||0,left:0};},_getClonedFragment:function c(){var AO=document.createDocumentFragment(),AS=this.toCloneNode.cloneNode(true),AR=document.createElement("div"),AQ=i.clone(u),AT=i.clone(y),AP=this._getClipRect();AQ.clip=this._getClipStr(AP);AQ.zIndex=4;if(this.parent.zone&&this.parent.zone.autoFitWindow){AQ.width="100%";}AS.id=this.getID();i.copy(AQ,AS.style);i.copy({left:-this.left+"px"},AS.firstChild.style);this.domNode=AS;s(AT,AP,this.getTableSize());AT.zIndex=3;i.copy(AT,AR.style);this.curtainNode=AR;AO.appendChild(AS);AO.appendChild(AR);return AO;},scrollDM:function k(AP,AU,AW){var AQ=this.parent.shouldClipLockableXtab,AR;if(this.lockHeadersCase&AF){if(!this.isRendered()){this.left=AP;this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";}else{var AY=this.getTableNode();var AV=this.domNode.firstChild,AO=AV.style;this.domNode.style.width="100%";this.domNode.style.height="100%";AO.left=-AP+"px";this.left=AP;if(AQ){if(AO.position!=="absolute"){AO.position="absolute";AO.width="100%";}if(this.lockHeadersCase&A){AR=this._getClipRect();AR.left=AP+this.offset.x;AR.right=Math.max(AV.offsetWidth,AY.offsetWidth);AO.clip=this._getClipStr(AR);}}}if(AQ){var AT=AW.style,AS=AW.parentNode,AX=AS.style;AR={top:this.offset.y+AS.scrollTop,right:Math.max(AY.offsetWidth,AW.offsetWidth),bottom:Math.max(AY.offsetHeight,AW.offsetHeight,AS.clientHeight),left:0};if(this.lockHeadersCase&A){AR.left=this.offset.x+AP;}if(AT.position!=="absolute"){if(isNaN(parseInt(AX.width,10))){AX.width=AS.offsetWidth+"px";}if(isNaN(parseInt(AX.height,10))){AX.height=AS.offsetHeight+"px";}AT.position="absolute";AT.width="100%";if(isNaN(parseInt(AX.width,10))){AX.width=AY.offsetWidth+"px";}}AT.clip=this._getClipStr(AR);}}},insertPage:P,refreshNode:z,onCellUpdated:S,unrender:function B(AO){this._super(AO);this.fragment=null;this.renderedPages=null;}});mstrmojo.XtabClonedTitle=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedTitle",_getClipRect:function E(AO){AO=AO||this.offset;return{top:0,right:AO.x||0,bottom:AO.y||0,left:0};},init:function AJ(AO){this._super(AO);if(this.lockHeadersCase===K&&this.left){this.createDomNode();}},_getClonedFragment:function c(){var AO=document.createDocumentFragment(),AS=this.toCloneNode.cloneNode(true),AR=document.createElement("div"),AQ=i.clone(u),AT=i.copy(y),AP=this._getClipRect();AQ.clip=this._getClipStr(AP);AQ.zIndex=6;if(this.parent.zone&&this.parent.zone.autoFitWindow){AQ.width="100%";}i.copy(AQ,AS.style);AS.firstChild.style.left=0;AS.id=this.getID();this.domNode=AS;s(AT,AP,this.getTableSize());AT.zIndex=5;i.copy(AT,AR.style);this.curtainNode=AR;AO.appendChild(AS);AO.appendChild(AR);return AO;},scrollDM:function k(AR,AQ,AP){if(this.lockHeadersCase===K&&!this.isRendered()){this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";}if(this.parent.shouldClipLockableXtab&&this.isRendered()){var AO=this.domNode.firstChild.style;if(AO.position!=="absolute"){AO.position="absolute";AO.width="100%";}AO.clip=this._getClipStr(this._getClipRect());}},insertPage:P,refreshNode:z,onCellUpdated:S,unrender:function B(AO){this._super(AO);this.fragment=null;this.renderedPages=null;}});mstrmojo._IsLockableXtab={_mixinName:"mstrmojo._IsLockableXtab",initLock:function AE(AW){var AS=W.call(this),AV=this.scrollboxNode;if(this.lockHeadersCase&&AV&&AS){var AU=document.createElement("div"),AO=i.copy(AW,{containerNode:AU,toCloneNode:AV,offset:AS,lockHeadersCase:this.lockHeadersCase,parent:this});if(!this.xtabClonedNodes){this.xtabClonedNodes=[];}if(this.lockHeadersCase&A){if(!this.clonedRowHeader){this.clonedRowHeader=this.addDisposable(new mstrmojo.XtabClonedRowHeader(AO));this.xtabClonedNodes.push(this.clonedRowHeader);}}if(this.lockHeadersCase&AF){if(!this.clonedColHeader){this.clonedColHeader=this.addDisposable(new mstrmojo.XtabClonedColHeader(AO));this.xtabClonedNodes.push(this.clonedColHeader);}}if(this.lockHeadersCase===K){if(!this.clonedTitle){var AQ=this.clonedColHeader,AT=AQ.domNode,AP=AQ.fragment;AO.toCloneNode=AT||AO.toCloneNode;AO.fragment=AP&&AP.cloneNode();this.clonedTitle=this.addDisposable(new mstrmojo.XtabClonedTitle(AO));this.xtabClonedNodes.push(this.clonedTitle);}}var AR=this.hasCustomScrollbar?"offset":"client",AY=(m.isChrome&&!this.hasCustomScrollbar&&window.devicePixelRatio!==1&&this.gridData.afw)?0.5:0,AX={top:0,left:0,position:"absolute",overflow:"hidden",width:AV[AR+"Width"]+AY+"px",height:AV[AR+"Height"]+"px"};i.copy(AX,AU.style);this.tableContainerNode.appendChild(AU);this.lockFragment=AU;w.call(this);}},getColClonedZone:function G(){return this.clonedColHeader&&this.clonedColHeader.domNode.firstChild;},createZone:function t(AO){return new mstrmojo.XtabZoneWithClonedCover(AO||{});},getStickedTableNodes:function a(){var AP=this.xtabClonedNodes,AQ=[];if(AP instanceof Array){for(var AO in AP){var AR=AP[AO];if(AR.isRendered()){AQ.push(AR.getTableNode());}}}return AQ;},_adjustClipSize:function l(){if(this.lockHeadersCase){var AQ=this.xtabClonedNodes;if(AQ&&AQ.length){var AR=W.call(this),AP=(m.isChrome&&!this.hasCustomScrollbar&&window.devicePixelRatio!==1&&this.gridData.afw)?0.5:0;this.lockFragment.style.width=(this.hasCustomScrollbar?parseInt(this.scrollboxNode.style.width,10):this.scrollboxNode.clientWidth)+AP+"px";this.lockFragment.style.height=this.scrollboxNode.clientHeight+"px";for(var AO in AQ){AQ[AO].adjustClip(AR);}}}},getValueCellOffset:function U(){return W.call(this);},_refreshClonedNodes:function Z(){var AR=this.xtabClonedNodes,AX=this.scrollboxNode.firstChild.firstChild,AO=this.titlesCP.getSpanDimension().nRow,AW=AX&&(AX.rows[AO]||AX.rows[0]),AV=AW&&AW.cells,AP=AV&&AV.length,AS=[],AU=!this.lastCellsRBOffsetLeft,AT;for(AT=0;AT<AP;++AT){var AQ=AV[AT].offsetWidth;AS.push(AQ);if(!AU){AU=(this.lastCellsRBOffsetLeft[AT]!=AQ);}}this.lastCellsRBOffsetLeft=AS;if(AU){for(AT in AR){AR[AT].refreshNode();}this._adjustClipSize();this.alignLockNodes(this.scrollboxLeft,this.scrollboxTop);}else{this._adjustClipSize();}},alignLockNodes:function AD(AR,AQ){var AP=this.xtabClonedNodes;if(AP&&AP.length){for(var AO in AP){AP[AO].scrollDM(AR,AQ,this.scrollboxNode.firstChild);}w.call(this);}},isAutoTableLayout:function AG(){return this.zone.isAutoTableLayout();},onPageRendered:function Q(AR,AO,AP,AT){this._super&&this._super(AR,AO,AP,AT);if(AP&&AO===0){J(this);}var AQ=this.xtabClonedNodes;if(AQ&&AQ.length){for(var AS in AQ){AQ[AS].insertPage(AR,AO,AP,AT);}}},resetColgroupNodes:function q(AR){var AP=this.xtabClonedNodes,AO,AQ;if(AP&&AP.length){for(AO in AP){AQ=AP[AO].getTableNode();if(AQ&&AQ.firstChild&&AQ.firstChild.tagName==="COLGROUP"){AQ.replaceChild(AR.cloneNode(true),AQ.firstChild);}}}},gridPagesRendered:function j(){this._super&&this._super();if(!this.lockHeadersCase){return ;}if(!this.xtabClonedNodes){this.initLock();}else{if(this.isAutoTableLayout()){this._refreshClonedNodes();}}},onCellUpdated:function AA(AO,AR){var AS=this.zone,AT=AS.posMap[AO._ei],AP=AS.tableNode.tBodies[AT.page||0],AQ=this.xtabClonedNodes;L(AT,AP,AR);for(idx in AQ){AQ[idx].onCellUpdated(AT,AR);}if(this.isAutoTableLayout()){this._refreshClonedNodes();}},unrender:function B(AQ){var AP=this.xtabClonedNodes,AO;if(AP&&AP.length){for(AO in AP){AP[AO].unrender(true);}}this.zones=null;J(this);this.lockFragment=null;this.xtabClonedNodes=null;this.clonedColHeader=null;this.clonedRowHeader=null;this.clonedTitle=null;this.lastCellsRBOffsetLeft=null;this._super(AQ);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.XtabZone");var G=1,F=2,H=4,P=8,Z=1,L=2,K=-1,I=mstrmojo.array,M=mstrmojo.hash;function X(a){var b=null;if(a&&a.length>1){b=new mstrmojo.XtabVACP();b.cps=a;}return b;}function O(c){if(!c||this._onDemandCP){return null;}var m=c.bc,k=c.tc,d=c.tbc,n=c.rm===2,b=n?this.gridData.ghs.rhs.items.length:m,e=k-b,f=n?d-m:k-b,l=Math.ceil(f/m),h=[],j=[],g;if(n){m=Math.floor(e/l);}for(g=0;g<l;++g){if(n&&l===(g+1)&&e>m){m=e;}var a=Math.min(e,m);h.push(this.createOnDemandCP(g+1,a,H));j.push(this.createOnDemandCP(g+1,a,P));e-=m;}this._onDemandCP={rhs:h,vls:j};return this._onDemandCP;}function Q(b,d){var a=(b&&b.items)||[];if(d&&!b.ignoreCells&&a.length){var c=[];a[0].items.forEach(function(){c.push({items:[]});});a.forEach(function(e){e.items.forEach(function(g,f){c[f].items.push(g);});});b.items=c;}return b;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo._HasContentProvider=mstrmojo.provide("mstrmojo._HasContentProvider",{titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,dataBlocks:null,onDemandIF:true,initDataBlocks:function Y(a){if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=a;},prepareCP:function W(){var a=this.gridData,c=this.rw=a.rw,b=this.rhsCP;if(b&&c&&c.row.tc===0&&c.col.tc===0){b.rc=0;}this._onDemandCP=null;},_setupCP:function E(g){var d=this.titlesCP=this.getTitleCP(g),f=this.chsCP=this.getColumnHeadersCP(g),b=this.rhsCP=this.getRowHeadersCP(g),c=this.valuesCP=this.getValuesCP(g);d.forceAutoRowHeight=f.forceAutoRowHeight=g.rh;var j=new mstrmojo.XtabVACP();var a=this.getHACP();a.cps=[d,f];j.cps=[a];var h=this.getHACP(this.useLevelHACP());h.cps=[b,c];j.cps.push(h);var i=g.gmh&&g.gmh.gmrh,e=g.rw&&g.rw.row;if(i&&e){j.gsmh={};j.gemh={};j.gsmh[e.bb]=i.gsmh;j.gemh[e.bb+e.bc-1]=i.gemh;}this.zone.cp=j;},useLevelHACP:function B(){return !!this.isOutlineMode;},getTitleCP:function D(a){return this.initCP(a,this.interactiveCellsArray,G);},initCP:function N(c,b,h,e,g,d,f){var a={gridData:c,type:h,interactiveCellsArray:b,defn:this.defn};a.base=e||a.base;a.lookupBase=g||a.lookupBase;a.axis=d||a.axis;if(!f){if(h===G){a.showMetricsLabel=c.gridProps&&c.gridProps.sml;if(c.stitchSectionKey){f=new mstrmojo.MultiXtabTitlesCP(a);}else{f=new mstrmojo.XtabTitlesCP(a);}}else{f=new mstrmojo.XtabCP(a);}}else{M.copy(a,f);}if(this.needRCForHeaders){f.needRC=(h===G||h===L);}return f;},getColumnHeadersCP:function J(i){var c=i.gts&&i.gts.col;c.some(function(p){if(p.otp===K){p.n=mstrmojo.desc(3582,"Metrics");return true;}});var b=i.ghs&&i.ghs.chs,f=b&&b.items;if(i.isv&&c.length>0){var j=0,e=f.length,o,d,m=[],h=[],l=[],n,k,g=c[0].cni,a=0;I.forEach(c,function(p){if(p.cni!==g){j=Math.max(a,j);a=0;}a+=p.rs||1;g=p.cni;});j=Math.max(a,j);f.forEach(function(){l.push(1);h.push(0);});for(o=0;o<j;o++){n=[];for(d=0;d<e;){k=f[d].items[h[d]]||{rs:1,cs:0,isDummy:true};if(!k.rs||(k.rs===1&&!k.isDummy)){n.push(k);h[d]+=1;}else{if(k.rs===l[d]){l[d]=1;h[d]+=1;}else{if(l[d]===1){n.push(k);}l[d]+=1;}}d+=k.cs||1;}if(n.length){m.push({items:n});}}b.items=m;if(this.onColHeadersRotated){this.onColHeadersRotated(b);}}return this.initCP(i,this.interactiveCellsArray,F,b,c,L);},getRowHeadersCP:function A(a){var d=a.gts&&a.gts.row,b;d.some(function(e){if(e.otp===K){e.n=mstrmojo.desc(3582,"Metrics");return true;}});if(!a.stitchSectionKey||d.length>0){b=a.ghs&&a.ghs.rhs;}var c=this.initCP(a,this.interactiveCellsArray,H,b,d,Z);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){O.call(this,this.rw.row);}this.rhsCPList=[c].concat(this._onDemandCP.rhs);return X(this.rhsCPList)||c;}return c;},getValuesCP:function S(c){var a=Q(c.gvs,c.isv),b=this.initCP(c,this.interactiveCellsArray,P,a,c.gts&&c.gts.col);c.isv=false;if(this.onDemandIF&&this.rw){if(!this._onDemandCP){O.call(this,this.rw.row);}this.valuesCPList=[b].concat(this._onDemandCP.vls);return X(this.valuesCPList)||b;}return b;},getHACP:function C(b){var a;if(b){a=new mstrmojo.XtabLevelHACP();if(this.outlineState){a.outlineState=this.outlineState;}}else{a=(this._super&&this._super())||new mstrmojo.XtabHACP();}return a;},createOnDemandCP:function U(a,b){var c=new mstrmojo.XtabOnDemandCP();c.dataSource=this;c.blockNum=a;c.rc=b;return c;},dataDownloaded:function R(b,h){var j=h.blockNum,a=this.rhsCPList[j],c=this.valuesCPList[j],i=b.data,f=this.gridData;i._bidx=j;this.dataBlocks[j]=i;if(!a||!c){return ;}var k=Q(i.gvs,i.isv);i.isv=false;this.initCP(i,this.interactiveCellsArray,H,i.ghs&&i.ghs.rhs,i.gts&&i.gts.row,Z,a);this.initCP(i,this.interactiveCellsArray,P,k,f.gts&&f.gts.col,null,c);a.initContent();c.initContent();this.numRowsDownloaded+=parseInt(a.rc,10);if(this.updateStatus){this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}var e=this.zone;if(e){var g=e.cp;if(g){var l=i.gmh&&i.gmh.gmrh,d=i.rw&&i.rw.row;if(l&&d){g.gsmh[d.bb]=l.gsmh;g.gemh[d.bb+d.bc-1]=l.gemh;}}e.dataDownloaded();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo._DocXtabModelShared","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper","mstrmojo.DocDataService","mstrmojo.models.template.DataInterface","mstrmojo.models.datasets.DataInterface","mstrmojo.string");var l="Metrics",F=2,W=mstrmojo.array,H=mstrmojo.hash,h=mstrmojo.func,g=mstrmojo.DocDataService,A="\u001E";function P(p){if(!p){return false;}var q=this.scm,s,w,u,t,o,n=false;for(w in q){u=q[w];t=u.cgb;for(s in t){o=p[t[s]];if(o){if(!u.tks){u.tks=o;n=true;}else{if(u.tks&&(u.tks.indexOf(o)<0)){u.tks+=A+o;n=true;}}}}}return n;}function a(){var o=this.data,n=o.gts;if(!n){return ;}var p;W.forEach([n.row,n.col],function(q){W.forEach(q,function(s){if(s.sc){p=p||{};p[s.id||l]=s.sc;if(s.fid){p[s.id+"_"+s.fid]=s.sc;}}});});this.scm=p;P.call(this,this.docModel.getCGBMap());}function m(n,o){var p=this.getDataService();p[n].apply(p,o);}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,[mstrmojo._DocXtabModelShared],{scriptClass:"mstrmojo.DocXtabModel",docModel:null,allowMetricHeaderSelection:false,init:function i(n){this._super(n);var o=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(p){if(o.xtab.onCBGMapChange){o.xtab.onCGBMapChange(p);}});},ondataChange:function d(){a.call(this);},getMessageId:function G(){return this.docModel.mid;},getAction:function U(AD,s,y){var AB=AD[0],o=AB&&AB.at;var q;if(o){if((o&F)>0){var p=this.getCellTitleInfo(AB),z=p&&p.title,n=z&&z.id,AA=this.scm;this.sti={titleId:n||l};var x=(n&&AA[n])||AA[l],w=function(){var AE=[];W.forEach(AD,function(AF){if(AF._e&&AF._e.id){AE.push(AF._e.id);}});return AE.join(A);};if(x){var AC=this.xtab,t=(AC.allowToggleSelections&&x.all&&y),u=(p.isSrcTitle||t);this.sti.deselectCurrent=t;q={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:s,ck:x.ck,tks:x.tks,eid:u?"OA:(All)":w(),ctlKey:x.ckey,sliceId:AC.sid,isUConDS:x.isUConDS,ifw:x.ifw}};}}}if(!q){q=this._super(AD);}if(q&&q.a){q.a.sliceId=this.xtab.sid;}return q;},getDownloadAction:function f(p,u,s,q,w,o,t,x){var n=this._super(p,u,s,q,w,t,o);n.sliceId=this.xtab.sid;if(x&&x.name==="TransactionUpdates"){if(n.partialUpdate){if(n.partialUpdate.selectors){n.partialUpdate.selectors.push(x.ctlKey);}else{n.partialUpdate.selectors=[x.ctlKey];}}else{n.partialUpdate={selectors:[x.ctlKey]};}}return n;},getDrillAction:function c(o,q){var p=this._super(o,q),n=this.getCellTitleInfo(o[0]);if(p&&p.isWithin){p.attrObj=n.title;}p.srcMsgId=this.docModel.mid;return p;},sort:function k(o,p){var n=this.xtab;o.stp=o.stp||this.getSubTotalsPos();o.subTotalsPos=o.stp;o.nodeKey=n.k;o.treeType=n.treeType||1;if(n.gridData.ctlTPKeys){o.selectors=n.gridData.ctlTPKeys.split(A);}m.call(this,"sortGrid",[o,p]);},pivot:function I(n,o){m.call(this,"pivot",[n,o]);},removeUnit:function N(n,o){m.call(this,"removeUnit",[n,o]);},showTotals:function C(n,o){m.call(this,"showTotals",[n,o]);},drillGrid:function S(n,o){m.call(this,"drillGrid",[n,o]);},downloadGridData:function Z(n,o){m.call(this,"downloadGridData",[n,o]);},loadLayout:function X(n){this.docModel.loadLayout(n);},resizeXtabColumn:function K(n,o){m.call(this,"resizeXtabColumn",[n,o]);},submitTemplateActions:function j(n,o,p){m.call(this,"submitTemplateUpdates",[n,o,p]);},getDerivedMetricAction:function e(n,o){return{did:n._e.oid,um:n.um,alias:n._e.n,n:n._e.n,v:n.um?n.formula:n._e.v,mix:n.mix,cmd:o,model:this};},getAddTemplateUnitAction:function D(s,u,p,n){var o=s.t,t=this.data.gsi,q={act:"addUnit",unitId:s.did,unitType:o,unitPos:++n,dsId:u,isFirst:!t||(t.cols.length===0&&t.rows.length===0)};if(o!==4||!t||!t.mx.length){q.axis=p;}return q;},doesNameExistOnTemplate:function B(p,u,s,o){var t=p.node.data.gsi,n=s===4,q=n?t.mx:t.rows.concat(t.cols);return q.some(function(w){return w.did!==u&&(n||w.t===s)&&w.n===o;});},getPivotUnitAction:function M(q,n,w,p,u,t){n++;var s=parseInt(u,10),o=parseInt(t,10);return H.copy(isNaN(s)||isNaN(o)?{}:{originAxis:s,originUnitPos:++o},{act:"pivot",unitId:String(w||""),unitType:p||"",axis:q,unitPos:n});},getLinkedAttributes:function b(n){var o;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}o=this.docModel.als&&this.docModel.als.idLinks||{};return o[n];},getObjectInfo:function E(n){var o;W.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(p){if(p.did===n){o=p;}});return o;},supportsViewFilterActions:function J(n){if(this.data&&this.data.gsi){var o=this.getObjectInfo(n);return o&&!o.de&&(o.t!==1)&&(o.t!==47||o.st===12033);}return false;},submitDEAction:function Q(o,u){var p=this.docModel,n=p.controller,t=p.getDataService(),s;n._addNodeKeyToAction(o,u);s=t.getUpdateTemplateAction(o.k,u);p.addUpdateObjects(s,{id:u.oId,type:47,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});var q=function(x){var w=[s];return function(){if(x){w=n.model.wrapUnsetVisualizationFilterAction(w);}n.submitUndoRedoUpdates(w,{},h.wrapMethods(p.getRebuildCallback(),p.getDatasetsUpdateCallback(),p.getUpdateHiddenLayoutsCallback()),g.REQUEST_DEFN_DATA);};};p.checkAndNotifyVFChangeOnGroupUpdate({actions:s},q(true),q(false));},submitDEHierachyOptionsActions:function R(n,o){this.submitDEAction(n,o);},submitQuickDECalculationActions:function O(n,o){this.submitDEAction(n,o);},submitQuickDECalculationNumberFormatActions:function L(n,o){this.submitDEAction(n,o);},submitRemoveQuickDEActions:function Y(n,o){this.submitDEAction(n,o);},});}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.vi.viz.MapHelper");var O=mstrmojo.gm.EnumTRFManipulations;var J=mstrmojo.array,C=mstrmojo.hash,N=mstrmojo.vi.viz.MapHelper,M=mstrmojo.func.wrapMethods,G=mstrmojo.func.composite,I=mstrmojo.VisEnum.GMLegendFormatingPropertyTag;var D={silent:false,undo:mstrmojo.emptyFn,redo:mstrmojo.emptyFn};function K(P){return P.model.controller.cmdMgr;}function L(){return(this.getDocModel&&this.getDocModel())||this.model.docModel;}function H(){return{success:function P(){this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}function E(Q,S){var P,X,R,U,W={};W.tks=this.k;W.selectorObjects=Q;W.keepOnly=!!S;W.isDocVis=true;P=L.call(this);X=P.getDataService();R=X.getGMViewFilterAction(W);U=P.getSliceCallback(W);return{action:R,callbacks:U};}function B(R,Q){var P,U,S;P=L.call(this);S=P.getDataService();if(!this.isXMLDirty()){S.submitUpdates(R,Q);}else{U=this.getPersistAction();S.submitUpdates([R,U],Q);this.resetXMLDirtyFlag();}}function A(){var b=this,f=this.modelData||this.model.data,U=f.k,d,c="FormattingWidget",X,W,a,Q,R,S=[],Z=[],Y=this.edtModel;if(!f){console.log("warning: modelData is missing");return null;}var e=function(h,j){var g=W.createElement(j),i;if(h instanceof Object){for(i in h){if(h.hasOwnProperty(i)){var k=e(h[i],i);if(k){g.appendChild(k);}}}}else{if(b.isVisMap){g.setAttribute("value",N.convertToReferenceFormat(h,j));}else{g.setAttribute("value",h);}}return g;};var P=function(g){return g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};a=this.createWidgetPropsXML?this.createWidgetPropsXML():null;if(!a||a.length===0){X=this.getProperties(U);if(this.useCompatibleXML){W=(new DOMParser()).parseFromString("<widgetProps></widgetProps>","text/xml");W.firstChild.appendChild(e(X,"fmt"));}else{W=(new DOMParser()).parseFromString("<props><widgetProps></widgetProps></props>","text/xml");W.firstChild.firstChild.appendChild(e(X,"fmt"));}a=(new XMLSerializer()).serializeToString(W);}Q=P(a);R={act:"setProperty",nodeKey:U,prs:c,pri:4,v:Q};S.push(R);return S;}function F(Q,R,P,W){if(!(W instanceof Function)){return D;}var U=this.id;function S(X){return function(){var Z=mstrmojo.all[U],Y;if(!Z){return ;}Y=Z.getProperties();Y[Q]=X;W.call(Z,X,true);Z.getDocModel().selectVIUnit(Z.parent.id,true);};}return{silent:true,undo:S(P),redo:S(R)};}mstrmojo._VizSelectionHelper=mstrmojo.provide("mstrmojo._VizSelectionHelper",{postBuilderingCalled:false,listenToUpdateColorMap:function(S){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var R=this,Q,P=(R.getDocModel&&R.getDocModel())||R.model.docModel;if(P){return P.attachEventListener("colorMapChanged",R.id,function(W){Q=R.parent&&R.parent.parent;if(R.forceUpdateColorMap||(Q&&Q.isPanelDisplaying())){S.call(R);}else{var U=Q.attachEventListener("panelDisplaying",R.id,function(X){if(R.postBuilderingCalled){S.call(R);}Q.detachEventListener(U);});}});}},detachUpdateColorMapListener:function(Q){if(!Q){return ;}var P=(this.getDocModel&&this.getDocModel())||this.model.docModel;P.detachEventListener(Q);},updateTargets:function(Q){var U={},R=this,P=L.call(this);U.fromGM=true;U.type=1;U.src=this.k;U.selectorObjects=Q;function S(Y){var W=R.modelData||R.model.data,X=W.sc;if(X!==undefined){return X[Y];}return undefined;}U.keepOnly=true;U.ck=S.call(this,"ck");U.keyContext=U.ck;U.tks=S.call(this,"tks");U.ckey=S.call(this,"ckey");U.isDocVis=true;U.include=true;U.showall=S.call(this,"showall");P.slice(U);},updateAfterViewFilter:function(R,P){var Y,X,Q,W,U,Z,S;Y=L.call(this);X=Y.getDataService();W=E.call(this,R,P);Q=W.action;U=W.callbacks;S=this.model.controller||Y.controller;if(this.currKeepOnlyAction){Z=[C.clone(this.currKeepOnlyAction)];}else{Z=E.call(this,[],false).action;}this.currKeepOnlyAction=Q;S.submitUndoRedoUpdates([Q],Z,U);},updateAfterKeepOnly:function(R){var Q=L.call(this),P=this.model.controller||Q.controller,S=M(P._getXtabCallback(this),H.call(this));P.applyKeepOnly(this,S,{keepOnly:R,data:this.getContextMenuSelections()},R?-2:undefined);if(!R){this.clearSelections();this.endSelections();}},updateAfterKeepOnlyForMultiTemplate:function(R){var Q=L.call(this),P=this.model.controller||Q.controller,S=M(P._getXtabCallback(this),H.call(this));P.applyKeepOnlyForMutilTemplate(R,S,true);},updateAfterDrill:function(P,f,b){var c=this,g=L.call(this),e=g.getDataService(),W=e.newUpdate(),S=this.getContextMenuSelections(),Q=b||this,U=Q.model,X=Q.model.data||Q.node.data,a=U.getSelectorDataFromTemplateLimit(X.tpl).concat({keepOnly:true,data:S}),R=g.getKeepOnlyOrExcludeAction(X.k,a),Y=c.model.controller||g.controller,Z=Y._getXtabCallback(c);W.add(P,M(f,Z));W.add(R,H.call(c));K(c).execute({execute:function d(){this.submitUpdate(W);},urInfo:{callback:W.callback}});},updateAfterSort:function(S){var Q=this,P=L.call(this),U=P.getDataService(),W=P.getSliceCallback({tks:Q.k});K(Q).execute({execute:function R(){var Y=U.newUpdate(this,undefined),X={act:"sortGM",nodeKey:Q.k,subActions:S,partialUpdate:{nodes:[Q.k]}};Y.add(X,W,undefined);if(Q.isXMLDirty()){Y.addActions(Q.getPersistAction());}this.submitUpdate(Y,undefined);},urInfo:{callback:W}});},updateAfterAction:function(W,P,Q,d,a){if(!W){return ;}var Y=this,R=Y.parent&&Y.parent.id,e=Y.model.docModel,X=Y.model.controller||e.controller,c,b,U={},Z,S=a||D;if(Q){c=mstrmojo.emptyFn;Z=function(){this.submitSilent(W);};}else{c=e.getSliceCallback({tks:this.k});c.success=G([c.success,function(){e.selectVIUnit(R,true);}]);Z=function(){this.submit(W,c,U);};}b=X._getXtabCallback(Y);if(P){c=M(c,P);b=M(b,P);}b.success=G([b.success,function(){e.selectVIUnit(R,true);}]);if(Q){C.copy(mstrmojo.DocDataService.SUPPRESS_DATA,U);}if(d){C.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,U);}K(this).execute({execute:Z,urInfo:{silent:S.silent,callback:b,redo:S.redo,undo:S.undo}});},getProperties:mstrmojo.emptyFn,getSetPropertiesAction:A,updateAfterPropertiesChange:function(Q,R,P,S){this.updateAfterAction(A.call(this),Q,R,P,S);},setProperty:function(Y,S,W){var Q=W.callback,R=!!W.suppressData,a=W.requestDefinition,U=W.clientUndoRedoCallback,Z=this.getProperties(),P=Z[Y],X;if(Y===I.COLOR_SQUARE_COLOR){if(this.colorSqureIdentity){this.updateColorMap(this.colorSqureIdentity.comb,S);}}else{if(Z&&(Z[Y]===undefined||Z[Y].toString()!==S.toString())){Z[Y]=S;X=F.call(this,Y,S,P,U);this.updateAfterPropertiesChange(Q,R,a,X);}}},showData:function(P){if(!this.gridData){this.gridData=this.model.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisUtility");var E=mstrmojo.array,D=mstrmojo.hash,A=mstrmojo.func.wrapMethods;function B(F){return F.model.controller.cmdMgr;}mstrmojo._colorPalette=mstrmojo.provide("mstrmojo._colorPalette",{listenToUpdateColorMap:function(I){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var H=this,G,F=(H.getDocModel&&H.getDocModel())||H.model.docModel;if(F){return F.attachEventListener("colorMapChanged",H.id,function(K){G=H.parent.parent;if(G.isPanelDisplaying()){I.call(H);}else{var J=G.attachEventListener("panelDisplaying",H.id,function(L){if(H.postBuilderingCalled){I.call(H);}G.detachEventListener(J);});}});}},detachUpdateColorMapListener:function(G){if(!G){return ;}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel;F.detachEventListener(G);},submitUpdatesAndPersistXML:function C(H,L,F,P){if(!H||H.length===0){return ;}var G={},M=this,Q=(M.getDocModel&&M.getDocModel())||M.model.docModel,O=Q.getDataService(),I=M.model.controller||Q.controller,J=I._getXtabCallback(M);if(F){D.copy(mstrmojo.DocDataService.SUPPRESS_DATA,G);}if(P){D.copy(mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION,G);}var K=false;E.forEach(H,function(R){if(R.act==="updateElementsPropertiesMap"){K=true;}});if(K){A(Q.getUpdateColorMapCallback(),J);}B(M).execute({execute:function N(){var R=O.newUpdate(this,undefined);R.add(H,L,G);this.submitUpdate(R);},urInfo:{callback:J}});},updateColorMap:function(I,G,K){if(!E.isArray((G))){G=[G];I=[I];}if(I.length!==G.length){throw new Error("comb and color number mismatch");}var F=(this.getDocModel&&this.getDocModel())||this.model.docModel,J=mstrmojo.VisUtility.getUpdateColorMapAction.bind(this),H=I.map(function(M,L){return J(M,JSON.stringify({color:G[L]}));});this.submitUpdatesAndPersistXML(H,K?A(F.getUpdateColorMapCallback(),K):F.getUpdateColorMapCallback(),false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.DocDataService","mstrmojo.mstr.EnumWebAPIErrorCodes");var G=mstrmojo.hash.copy,S=mstrmojo.func,Y=S.wrapMethods,Z=mstrmojo.mstr.EnumWebAPIErrorCodes;var K=1,E=2,A=3;var P={FIRST:1,MIDDLE:2,LAST:3};var O={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var F=G(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function B(a,c,b){if(c.stid==="undefined"){b.submission=function(g,d,e){var h=e.params,f=JSON.parse(h.params);f.actions[0].stid=a.action===K?a.undoStateId:a.redoStateId;h.params=JSON.stringify(f);};}return b;}function H(b,f){var c=b.mgr;f.disablePU=true;var e=B(b,f,{success:function d(){b.state=O.DONE;},failure:function a(){c.onFailure();}});b.state=O.SILENT;c.dataService.submitUpdates(f,e,F);c.onSuccess(b);}function X(k,f){var j=k.urInfo,i=j.puKeys,p=j.puObjs,g=j.puFilters,l=k.mgr,h=l.model,m=l.dataService;if(i||p){if(i){f.partialRetrieval={nodes:i,filters:g};}if(p){h.addUpdateObjects(f,p);}}else{f.disablePU=true;}var d=B(k,f,{success:function o(){k.state=O.DONE;l.onSuccess(k);if(k.skipUIState){return ;}h.restoreUIState(k.action===K?k.undoUIState:k.redoUIState);},failure:function c(){l.onFailure();},complete:function b(){l.resetState();}}),a=j.callback||h.getRebuildCallback(),n=Y(a,d),e=G(j.extras);if(f.act==="undo"&&e!==undefined){e.hideCancel=true;if(f.killJob){e.message=mstrmojo.desc(14586,"Canceling...");}}k.state=O.BUSY;m.submitUpdates(f,n,e);}function M(d){var a=d.urInfo,b=d.mgr.model;if(!a.extras){var c=(a.treesToRender!==undefined)?a.treesToRender:d._treesFromRes;if(!a.disablePU&&!d._hasFullUpdate&&(!a.puKeys||!a.puKeys.length)){c=0;a.callback=Y(b.getDatasetsUpdateCallback(),a.callback);}a.extras={style:{params:{treesToRender:c}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,isUntracked:false,action:null,state:O.INTERIM,urInfo:null,getStateValue:function W(b,a){return this.action===K?a:b;},init:function Q(a){G(a,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function I(g){var c=this,e,b=this.urInfo,a=b.silent,h,d=this.mgr,f=d.dataService;if(c.action===A){e={act:"redo",stid:c.redoStateId};h=b.redo;}else{if(c.action===K){e={act:"undo",stid:c.undoStateId,killJob:g};h=b.undo;}else{d.handleError();}}if(h){f.blockRequests=true;try{a=!!h.call(c)||a;}finally{f.blockRequests=false;}}if(a){H(c,e);}else{X(c,e);}},submitUpdate:function J(b,a){this.submit(b.actions,b.callback,b.extras,a);},submit:function L(e,o,d,m){var j=this,k=j.mgr,g=k.model,l=k.dataService,i=mstrmojo.array.ensureArray(e);o=o?G(o):g.getRebuildCallback();j.state=O.BUSY;function f(p,q){return !(p&&p[q]&&p[q].length);}if(j._hasFullUpdate||i.some(function(p){return p.disablePU;})||i.every(function(q){var s=q.partialRetrieval,p=q.partialUpdate;return f(s,"nodes")&&f(p,"nodes")&&f(p,"selectors")&&f(p,"objects");})){j._hasFullUpdate=true;}S.override({submission:function c(){if(j.submitCount===0){j.undoStateId=l.stid;}j.submitCount++;},success:function n(u,w){if(j.action!==E){k.handleError();}j.redoStateId=u.stid;var t=!m||m===P.LAST;if(t){j.state=O.DONE;}else{j.state=O.INTERIM;}var s=j.urInfo;if(!s.disablePU){var p=s.puKeys||[],x=u.pukeys&&u.pukeys.split("\u001E");if(x&&x.length){p=p.concat(x);var q=s.extraPuKeys;if(q){p=p.concat(q);delete s.extraPuKeys;}}if(p.length){s.puKeys=p;}}j._treesFromRes|=(u.defn?1:0)|(u.data?2:0);if(this._super){this._super(u,w);}if(t){j.completeSubmit();}},failure:function b(p,t){var s=(d&&d.skipUICmdMgrOnFailure)||[],q=parseInt(p.code||(p.getResponseHeader&&p.getResponseHeader("X-MSTR-TaskErrorCode")||Z.UICMD_DEFAULT_ERROR),10);if(s.indexOf(q)===-1&&s.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){k.onFailure();}if(this._super){this._super(p,t);}},canceled:function h(p){if(this._super){this._super(p);}window.setTimeout(function(){j.cancel(true);},0);},complete:function a(){if(!m||m===P.LAST){k.resetState();}if(this._super){this._super();}}},o);l.submitUpdates(e,o,d);},submitInterim:function R(b,c,a){this.submit(b,c,a,P.MIDDLE);},resetCmdMgrOnComplete:function C(){this._resetMgr=true;},completeSubmit:function N(){var b=this,c=b.mgr,a=c.model;if(!b.completed){b.completed=true;b.state=O.DONE;c.onSuccess(b);M(b);b.redoUIState=a.getUIState();if(b.isUntracked){c.untrackLastCmd();}else{if(b._resetMgr){c.reset();}}}},cancel:function D(a){this.state=O.CANCELED;if(this._hasFullUpdate){this._treesFromRes=3;}M(this);this.mgr.onCancel(this,a);},submitSilent:function U(c){var e=this,f=e.mgr,d=f.model,g=f.dataService;e.state=O.SILENT;f.onSuccess(e);e.redoUIState=d.getUIState();var h={submission:function b(){e.undoStateId=g.stid;e.submitCount++;},success:function i(j){e.state=O.DONE;e.redoStateId=j.stid;},failure:function a(){f.onFailure();}};g.submitUpdates(c,h,F);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=P;mstrmojo.vi.controllers.UICmd.CMD_STATE=O;mstrmojo.vi.controllers.UICmd.CMD_ACT_TYPE={UNDO:K,EXEC:E,REDO:A};}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.CheckList","mstrmojo.DataGrid","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.func","mstrmojo.array","mstrmojo.dom","mstrmojo.models.template.DataInterface","mstrmojo.DocDataService","mstrmojo.ui.editors.controls.ColumnSetGroup","mstrmojo.NumStepperContentProvider");var M=mstrmojo.hash,p=mstrmojo.array,C=mstrmojo.css,d=mstrmojo.Button.newWebButton,z=mstrmojo.ui.Pulldown.newPulldown,t=mstrmojo.models.FormatModel.getFormatUpdate,j=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,n=mstrmojo.vi.ui.DatasetUnitMenuUtils,K,L=mstrmojo.dom,w=mstrmojo.models.template.DataInterface,AA="VLDB Select",Z="Outer Join To Lookup Table",U="Metric Join Type",AB="Allow Cartesian Join";var B=1,u=2,I=3,E="480px",q="visfilter";var F=[{n:mstrmojo.desc(6031,"Off"),v:"0"},{n:mstrmojo.desc(6030,"On"),v:"1"},{n:mstrmojo.desc(8504,"Form name only"),v:"2"},{n:mstrmojo.desc(8505,"Show attribute name once"),v:"3"},{n:mstrmojo.desc(4531,"Automatic"),v:"4"}],m=[{n:mstrmojo.desc(18365,"Above the children"),v:0},{n:mstrmojo.desc(18363,"Below the children"),v:1}],h=[{n:mstrmojo.desc(13786,"Show both nulls and zeros"),v:"-1"},{n:mstrmojo.desc(13787," Hide both nulls and zeros"),v:"2"},{n:mstrmojo.desc(9845,"Hide nulls only"),v:"0"},{n:mstrmojo.desc(9846,"Hide zeros only"),v:"1"}],D=[{n:mstrmojo.desc(17608,"Use inherited value"),v:undefined},{n:mstrmojo.desc(17607,"Cancel Execution"),v:"1"},{n:mstrmojo.desc(17605,"Execute Cartesian Join"),v:"2"}],R=[{n:mstrmojo.desc(13544,"Last selection only"),v:0},{n:mstrmojo.desc(13545,"Intersection of all selections"),v:1}],s=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(9640,"Inner Join"),v:"0",title:mstrmojo.desc(9640,"Inner Join")},{n:mstrmojo.desc(9641,"Outer Join"),v:"1",title:mstrmojo.desc(9641,"Outer Join")}],Q=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}];var k={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"2":mstrmojo.desc(13179,"Outer Join - Ignore Filter"),"3":mstrmojo.desc(13181,"Outer Join - Preserve Filter")},e={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"1":mstrmojo.desc(9641,"Outer Join")};var c;var o=false;function W(AJ,AG,AF,AI){var AH={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:AJ,col2Width:AG,children:AF};return M.copy(AI,AH);}function X(AG,AH,AF){return M.copy(AF,{scriptClass:"mstrmojo.Label",slot:AH,text:AG});}function G(AI,AF){return[X(AI,"col1Node",{cssClass:"subTitle"}),{scriptClass:"mstrmojo.ui.CheckList",orientation:"h",slot:"col2Node",preBuildRendering:function AG(){var AM=mstrmojo.all[K].data[AF],AJ=this.items,AL=this.selectedIndices;if(AM){p.forEach(AJ,function(AO,AN){AL[AN]=AM[AO.id]==="-1";});}var AK=mstrmojo.all[K].olm;if(!!AK&&AF==="rows"){this.items[1].css="disabled";}else{this.items[1].css="";}},postselectionChange:function AH(AJ){var AL=this.items,AK=[AJ.added,AJ.removed];AK.forEach(function(AN,AM){if(AN&&AN.length>0){t(AF+AL[AN[0]].id,AM===0?"-1":"0",mstrmojo.all[K].newData);}});},items:[{n:mstrmojo.desc(2969,"Show"),id:j.SHOW_HEADER},{n:mstrmojo.desc(1095,"Merge"),id:j.MERGE_HEADER,css:""},{n:mstrmojo.desc(2970,"Lock"),id:j.LOCK_HEADER}]}];}function a(){var AG=K.split("-"),AF=AG.length;if(!mstrApp.isInVFConfigMode&&AG[AF-1]===q){AG.splice(AG.length-1,1);}else{if(mstrApp.isInVFConfigMode&&AG[AF-1]!==q){AG.splice(AG.length,1,q);}}K=AG.join("-");}function f(AG){a();var AF=mstrmojo.all[K];if(AG){AF.update=AF.update.actions?AF.update:{actions:[]};AF.update.actions=AF.update.actions.concat(mstrmojo.hash.valarray(AF.joinActions));AF.update.callback=mstrmojo.func.wrapMethods(AF.update.callback,AF.host.parent.model.getRebuildCallback());if(AF.SelectionLimitSection&&AF.limitVal){AF.host.writeGlobalProperty("slctnLmt",AF.limitVal);}if(AF.showIncrementalFetchSection){AF.update.actions=AF.update.actions.concat(AF.host.getXtabIncrementalFetchActions(AF.ifChecked,AF.ifMaxRows));}AF.submitAction(AF.newData,AF.update.actions,AF.update.callback,AF.update.extras);}AF.newData=AF.update={};AF.joinActions={};AF.close();}function H(AH){var AF=M.walk("model.docModel",AH),AK=AH.k,AG=[];if(AH.hasArrayGSI){p.forEach(AH.gridData.gsi,function(AL){AG.push(AL.k);});}else{if(AH.isVisMap){AG=AH.getAllLayerKeys(true);}else{if(AF&&AF.isMapLayerNode(AK)){AK=AF.getHostKeyByNodeKey(AK)||AK;var AI=AF.getVisualizationByKey(AK),AJ=(AI&&AI.boxContent)||AH;AG=AJ.getAllLayerKeys&&AJ.getAllLayerKeys(true);}else{AG.push(AK);}}}return{nodeKeys:AG,hostKey:AK};}function S(AG){var AJ=AG.parent,AL=AJ.data,AH=mstrmojo.all[K],AI=AH.host,AK=AI.controller,AF=hostKey=AI.k,AM=new mstrmojo.ui.menus.MenuConfig();AH.joinActions=AH.joinActions||{};if(AI.hasArrayGSI){AF=AJ.dataGrid.columnSetKey;}if(AL.did==="AllAttr"){Q.forEach(function(AN){AM.addMenuItem(AN.n,"",function(){AG.parent.jtValue.set("text",AN.n);AL.v=AN.v;AL.dv=AN.n;AH.joinActions.AllAttr=AK.dataService().getSetVLDBPropAction(Z,"attributeJoin",AF,AN.v,hostKey);});});}else{s.forEach(function(AN){AM.addMenuItem(AN.n,"",function(){AG.parent.jtValue.set("text",AN.n);AL.v=AN.v;AL.dv=AN.n;var AO={unitId:AL.did,dataType:AL.dt,unitType:AL.t};AH.joinActions[AL.did]=AK.dataService().getSetVLDBPropAction(U,"metricJoin",AF,AN.v,hostKey,AO);});});}AM.hostId=K;AM.isHostedWithin=false;AM.hostElement=AG.domNode;AM.menuCssClass="joinbehavior";AM.setAlignment(3,2);AH.openPopup(AM.newInstance());}function J(AF,AG){if(AG){AF.set("visible",true);window.setTimeout(function(){AF.showTooltip();AF._autoHideTimeout=window.setTimeout(function(){AF.hideTooltip();},3000);},0);}else{AF.hideTooltip();AF.set("visible",false);}}mstrmojo.vi.ui.editors.MoreOptionsEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.editors.MoreOptionsEditor",host:undefined,showHeadersSection:false,showSelectionLimitSection:false,showIncrementalFetchSection:false,data:undefined,lockHeadersCase:undefined,update:undefined,newData:undefined,joinActions:undefined,cssClass:"mstrmojo-MoreOptions-Editor",title:mstrmojo.desc(9126,"More options"),help:"more_options_dialog_box.htm",submitAction:mstrmojo.emptyFn,supportCartesianJoin:false,init:function x(AF){this._super(AF);if(mstrApp.isInVFConfigMode){this.children.splice(2,1);}K=this.id;this.newData=this.update={};this.joinActions={};this.onshowHeadersSectionChange(this.showHeadersSection);this.onshowSelectionLimitSectionChange(this.showSelectionLimitSection);this.onshowIncrementalFetchSectionChange(this.showIncrementalFetchSection);},onOpen:function Y(){a();var AO=this.host,AH=AO&&AO.gridData,AF=M.walk("rw.row.bc",AH),AN=AH&&AH.olm&&!(AH.rw&&AH.rw.row.bc>0);this.olm=!!AN;if(this.JoinBehaviorSection){var AI=this.JoinBehaviorSection.joinUnits,AG=AI.dataGrid,AM=AI.columnSetPD;if(AO.hasArrayGSI){var AJ=w.getGSI(AH.gsi,0),AL=AO.model.docModel;if(!AM){AM=new mstrmojo.ui.editors.controls.ColumnSetGroup({value:AJ.k,gsi:AH.gsi,docModel:AL,cssClass:"columnSets-pd",alias:"columnSetPD",includeAll:false,width:"181px",callback:function(AP){AG.columnSetKey=AP;AG.updateUnits(AP);AI.refresh();},});AI.addChildren(AM,0);}else{AM.updatePulldownItems(AH.gsi,AL,0,AJ.k);}AG.columnSetKey=AJ.k;}else{if(AM){AI.removeChildren(AM);AG.columnSetKey=null;}}}if(this.showIncrementalFetchSection){this.initIncrementalFetchSectionStatus(AF,this.olm);}if(this.showSelectionLimitSection){var AK=this.SelectionLimitSection.children[1].children[1].provider;AK.curVal=AO.readGlobalProperty("slctnLmt");this.limitVal=undefined;}this.refresh();},onifCheckedChange:function(){var AF=this.IncrementalFetchSection.gridIfTwoColumnContainer.gridIfTextBox;AF.set("enabled",this.ifChecked);},_set_lockHeadersCase:function g(AI,AF){this.lockHeadersCase=AF;var AG=this.data,AH=this.lockHeadersCase;if(!AG){AG=this.data={rows:{},cols:{}};}else{AG.rows=AG.rows||{};AG.cols=AG.cols||{};}AG.rows.lhv=(AH===I||AH===B)?"-1":"0";AG.cols.lhv=(AH===I||AH===u)?"-1":"0";},onshowHeadersSectionChange:function N(AF){this.showSectionChange(AF,"headersSection");},onshowSelectionLimitSectionChange:function i(AF){this.showSectionChange(AF,"SelectionLimitSection");},onshowIncrementalFetchSectionChange:function AD(AF){this.showSectionChange(AF,"IncrementalFetchSection");},showSectionChange:function P(AF,AJ){var AI=AF.value,AG=this[AJ],AH="_orphaned"+AJ;if(!AI&&AG){this[AH]=AG;this.removeChildren(AG);}else{if(AI&&!AG){this.addChildren(this[AH]);this.children.sort(function(AL,AK){return AL.canonicalPosition-AK.canonicalPosition;});}}},initIncrementalFetchSectionStatus:function AC(AI,AF){var AH=this.IncrementalFetchSection.gridIfCheckBox,AG=this.IncrementalFetchSection.gridIfTwoColumnContainer.gridIfTextBox;AG.set("enabled",AI!==-1);AH.set("enabled",!AF);AH.checked=AI!==-1;AG.value=AI===-1?"":AI;this.ifChecked=AH.checked;this.ifMaxRows=AI;},children:[W("26%","74%",[X(mstrmojo.desc(2967,"Headers"),"col1Node",{cssClass:"title"}),W("20%","80%",G(mstrmojo.desc(2968,"Rows"),"rows"),{slot:"col2Node"}),W("20%","80%",G(mstrmojo.desc(122,"Columns"),"cols"),{slot:"col2Node"})],{alias:"headersSection",canonicalPosition:0,cssClass:"headers",width:E}),W("26%","74%",[X(mstrmojo.desc(4083,"Display"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row0",children:[X(mstrmojo.desc(18955,"Position of the parent elements")+":","containerNode",null),z(m,function(AF){t(j.PARENT_POSITION,AF.v,mstrmojo.all[K]?mstrmojo.all[K].newData:null);},0,{width:"151px",preBuildRendering:function A(){var AF=mstrmojo.all[K]?this.items.map(function(AG){return AG.v;}).indexOf(mstrmojo.all[K].data[j.PARENT_POSITION]):0;this.selectedIndex=Math.max(AF,0);},postBuildRendering:function O(){var AG=mstrmojo.all[K]?mstrmojo.all[K].data[j.PARENT_POSITION]>-1:false;var AF=this.parent.children[0];this.set("visible",AG);AF.set("visible",AG);this.constructor.prototype.postBuildRendering.call(this);}},true)]},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[X(mstrmojo.desc(8503,"Show attribute form names:"),"containerNode",null),z(F,function(AF){t(j.LONG_NAME,AF.v,mstrmojo.all[K].newData);},0,{width:"151px",preBuildRendering:function A(){var AF=this.items.map(function(AG){return AG.v;}).indexOf(mstrmojo.all[K].data[j.LONG_NAME]);this.selectedIndex=Math.max(AF,0);}},true)]},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row2",children:[X(mstrmojo.desc(13200,"Hide metric nulls and zeros"),"containerNode",null),z(h,function(AG){var AF=AG.v,AH=AF==="-1"?"-1":"0";if(AF!=="-1"){t(j.HIDE_NULL,AF,mstrmojo.all[K].newData);}t(j.SHOW_ALL_ROWS,AH,mstrmojo.all[K].newData);},0,{width:"181px",preBuildRendering:function A(){var AG=mstrmojo.all[K].data,AF=AG[j.SHOW_ALL_ROWS]==="-1"?0:this.items.map(function(AH){return AH.v;}).indexOf(AG[j.HIDE_NULL]);this.selectedIndex=Math.max(AF,0);}},true)]}],{alias:"viewSection",canonicalPosition:1,cssClass:"view",width:E}),W("26%","74%",[X(mstrmojo.desc(13546,"Filtering"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[X(mstrmojo.desc(13547,"When this visualization is filtered by multiple other visualizations, filter by:"),"containerNode",{cssClass:"dropdownLabel"}),z(R,function(AF){var AG=mstrmojo.all[K],AH=AG.host;if(AH.switchFilterType){AG.update=AH.switchFilterType(AF.v);}},0,{width:"181px",preBuildRendering:function A(){var AF=mstrmojo.all[K].host;if(AF.getFilterType){this.selectedIndex=AF.getFilterType();}}},true)]}],{alias:"filteringSection",canonicalPosition:2,cssClass:"filtering",width:E}),W("26%","74%",[X(mstrmojo.desc(5618,"Incremental Fetch"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.CheckBox",label:mstrmojo.desc(6115,"Enable incremental fetch in Grid"),alias:"gridIfCheckBox",slot:"col2Node",cssText:"line-height: 26px",oncheckedChange:function(){var AF=mstrmojo.all[K];AF.set("ifChecked",this.checked);}},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",slot:"col2Node",col1Width:"25%",col2Width:"15%",formatGroup:"overall",alias:"gridIfTwoColumnContainer",children:[X(mstrmojo.desc(8797,"Rows per page"),"col1Node",null),{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",slot:"col2Node",dtp:1,alias:"gridIfTextBox",constraints:{min:1,max:1000000},onValid:function(){var AF=mstrmojo.all[K];AF.ifMaxRows=parseInt(this.value,10);}}]}],{alias:"IncrementalFetchSection",canonicalPosition:3,cssClass:"incrementalfetch",width:E}),W("26%","73%",[X(mstrmojo.desc(16265,"Selection Data Limit"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[X(mstrmojo.desc(16264,"Set a limit for the maximum quantity of data points that a user can select on this visualization."),"containerNode",{cssClass:"stepperLabel"}),{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:"75px",preBuildRendering:function A(){C.addWidgetCssClass(this,"selection");mstrmojo.ui.editors.controls.Stepper.prototype.preBuildRendering.call(this);},provider:new mstrmojo.NumStepperContentProvider({item:{interval:1},min:1,max:200000,onTraverse:function(){var AF=mstrmojo.all[K];AF.limitVal=this.item.value;}})},X(mstrmojo.desc(16263,"(Max quantity should be no more than 200K.)"),"containerNode",{cssClass:"stepperLabel"})]}],{alias:"SelectionLimitSection",canonicalPosition:4,cssClass:"filtering",width:E}),W("26%","74%",[X(mstrmojo.desc(17612,"Data Join"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",alias:"joinOptions",children:[{scriptClass:"mstrmojo.Box",slot:"containerNode",alias:"labelRow",cssText:"overflow: hidden",children:[{scriptClass:"mstrmojo.Label",cssClass:"joinLabel",text:mstrmojo.desc(17606,"Cartesian Join Governing"),postBuildRendering:function(){var AF=mstrmojo.all[K];this.set("enabled",AF.supportCartesianJoin);this.constructor.prototype.postBuildRendering.call(this);}},{scriptClass:"mstrmojo.Button",cssClass:"warningTooltipBtn",alias:"warningBtn",visible:false,useRichTooltip:true,tooltipOpenDelay:0,richTooltip:{cssClass:"vi-warning vi-tooltip-C A-center disabled-cartesian",posType:mstrmojo.tooltip.POS_TOPLEFT,enableHover:true},showTooltip:function AE(){window.clearTimeout(this._autoHideTimeout);this._autoHideTimeout=undefined;if(this.hasOpenTooltip){this.hideTooltip();}this.constructor.prototype.showTooltip.call(this);},updateTooltipConfig:function y(){var AG=this.richTooltip,AF=L.position(this.domNode);AG.left=AF.x+AF.w+12;AG.top=AF.y-9;AG.content=mstrmojo.desc(17609,"Executing cartesian joins is not a recommended option.");},onvisibleChange:function(){J(this,this.visible);}}]},z(D,function(AG){var AH=mstrmojo.all[K],AJ=AH.host,AK=AJ.controller,AI=H(AJ),AF=AI.nodeKeys,AL=AI.hostKey;p.forEach(AF,function(AM){AH.joinActions["Cartesian"+AM]=AK.dataService().getSetVLDBPropAction(AB,"cartesianJoin",AM,AG.v,AL);});this.parent.labelRow.warningBtn.set("visible",parseInt(AG.v,10)===2);},0,{alias:"cartesianPulldown",width:"181px",postBuildRendering:function O(){var AI=mstrmojo.all[K],AJ=AI.host,AL=AJ.hasArrayGSI?w.getGSI(AJ.gridInfo,0).k+".":"",AG=M.walk(AL+AA,AJ.tmsProps.tpltProp),AH=p.filterOne(AG,function(AM){return AM.n===AB;})||{},AK=AH&&AH.v||undefined,AF=this.items.map(function(AM){return AM.v;}).indexOf(AK);this.selectedIndex=Math.max(AF,0);this.set("enabled",AI.supportCartesianJoin);this.parent.labelRow.warningBtn.set("visible",parseInt(AK,10)===2);this.constructor.prototype.postBuildRendering.call(this);}},true)],useRichTooltip:false,richTooltip:{cssClass:"vi-warning vi-tooltip-C A-center disabled-cartesian",posType:mstrmojo.tooltip.POS_TOPLEFT,enableHover:true},updateTooltipConfig:function y(){var AG=this.richTooltip,AF=L.position(this.cartesianPulldown.domNode);AG.left=AF.x+AF.w+12;AG.top=AF.y-7;},onenabledChange:function(){this.useRichTooltip=!this.enabled;},buildRendering:function l(){var AG=mstrmojo.all[K],AF=mstrApp.isCartesianJoinSupported&&mstrApp.isCartesianJoinSupported(),AH=AF?"":mstrApp.getCartesianJoinTtp&&mstrApp.getCartesianJoinTtp();this.set("enabled",AF);AG.supportCartesianJoin=AF;this.richTooltip.content=AH;this.constructor.prototype.buildRendering.call(this);}},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row2",alias:"joinUnits",children:[X(mstrmojo.desc(4571,"Join Behavior"),"containerNode",{cssClass:"joinLabel"}),{scriptClass:"mstrmojo.DataGridWithTooltip",cssClass:"jointype",banding:false,lockHeader:true,alias:"dataGrid",columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"n",headerCss:"objects-hd",tooltip:false,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:115,colHeight:24},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Box",cssClass:"jt-col",children:[{scriptClass:"mstrmojo.Label",cssClass:"jt-value",alias:"jtValue",bindings:{text:"this.parent.data.dv"}},{scriptClass:"mstrmojo.Button",cssClass:"jt-menu",alias:"jtBtn",onclick:function(){var AF=mstrmojo.all[K];S.call(AF,this);}}]}}],items:[],columnSetKey:null,itemFunction:function(){var AF=mstrmojo.DataGridWithTooltip.prototype.itemFunction.apply(this,arguments);AF.themeClassName=!!mstrApp.isWSStyling?"":"mojo-theme-dark";return AF;},updateUnits:function b(AI){var AT=mstrmojo.all[K].host,AS=AT.model&&AT.model.docModel,AP=AT.tmsProps,AL=M.walk((AT.hasArrayGSI?AI+".":"")+AA,AP.tpltProp),AN=[],AJ=w.getGSI(AT.gridInfo,AI)||{},AU=AJ.rows||[],AQ=AJ.cols||[],AR=AJ.mx||[],AM=AJ.dmx||[],AO=[].concat(AP.mxProp),AK=0,AH=[];var AF=p.filterOne(AL,function(AV){return AV.n===Z;})||{},AG=AF&&AF.v;AG=(AG&&AG.length)?AG:"-1";(AU.concat(AQ)).some(function(AV){if(AV.t===12){AN.push({did:"AllAttr",n:mstrmojo.desc(13185,"All Attributes"),v:AG,dv:k[AG],itemCss:"jt-allattr"});return true;}return false;});AR=p.filter(AR,function(AW){var AX=n.getUnitFromDataset(AS.datasets,AW.did,4),AV=AW.isSmart&&AW.decomposable===2;return AX&&(!AX.um||AW.afb||!AW.isSmart||AV);});if(AT.hasArrayGSI){w.forEachGSI(AT.gridInfo,function(AX,AW){var AV=AX&&AX.mx||[];AV.forEach(function(AY){if(AI===AW&&AO[AK]&&AO[AK][AY.did]){AH.push(AO[AK]);}AK++;});},AI);}else{AH=AO;}AM.forEach(function(AW){var AV={};AV[AW.did]=AW.prop;AH.push(AV);});(AR||[]).forEach(function(AW){var AV={v:"-1"};(AH||[]).forEach(function(AX){if(AX[AW.did]){(AX[AW.did]["VLDB Select"]||[]).forEach(function(AY){if(AY.n==="Metric Join Type"){AV=AY;}});}});AN.push({did:AW.did,n:AW.n,dt:AV.dt,t:4,v:AV.v,dv:e[AV.v],itemCss:"jt-metric"});});this.items=AN;mstrmojo.DataGridWithTooltip.prototype.preBuildRendering.apply(this,arguments);},preBuildRendering:function A(){var AF=mstrmojo.all[K].host,AG=this.columnSetKey||w.getGSI(AF.gridInfo,0).k||AF.k;this.updateUnits(AG);},postBuildRendering:function O(){mstrmojo.DataGridWithTooltip.prototype.postBuildRendering.apply(this,arguments);this.domNode.style.overflow="hidden";}}]}],{alias:"JoinBehaviorSection",canonicalPosition:5,cssClass:"joinbehavior",width:E}),{alias:"buttonBar",canonicalPosition:6,scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[d(mstrmojo.desc(221,"Cancel"),function(){f(false);}),d(mstrmojo.desc(118,"Save"),function(){f(true);},true)]}]});mstrmojo.DataGridWithTooltip=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasTooltip],{scriptClass:"mstrmojo.DataGridWithTooltip",tooltip:"",useRichTooltip:true,itemFunction:function(AH,AF,AG){var AI=new mstrmojo.DataRow({columns:AG.columns,data:AH,idx:AF,dataGrid:AG,parent:AG});AG.dataTextCSSClass=AI.dataTextCSSClass;return AI;},updateTooltipConfig:function y(AG){var AH=AG.target||L.eventTarget(AG.hWin,AG.e),AF=L.position(AH);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMRIGHT,content:this.getTooltipContent(AG),top:AF.y+1.5*AF.h,left:AF.x,cssClass:"vi-regular vi-tooltip-D"};},getTooltipContent:function(AF){return mstrmojo.string.regEscape(AF.target.innerText);},showTooltip:function AE(AF,AG){if(AF.target.className===this.dataTextCSSClass){this._super(AF,AG);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.mstr.EnumFunction","mstrmojo.warehouse.EnumDatabaseType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.models.template.DataInterface","mstrmojo.vi.viz.EnumDSSDropZones");mstrmojo.requiresDescs(5421,5422,13355);var R=mstrmojo.hash,M=mstrmojo.array,G=mstrmojo.desc,H=mstrmojo.DocDataService,Y=mstrmojo.warehouse.EnumDatabaseType,C=mstrmojo.string,e=mstrmojo.mstr.EnumFunction,f=mstrmojo.mstr.EnumDSSXMLObjectTypes,N=mstrmojo.models.template.DataInterface;var E=mstrmojo.vi.viz.EnumDSSDropZones;function L(t,h,AB,AD){var l=t.model,x=t.cmSelCells,AC=[],AK=l.getCellTitleInfo(h).title,AM,AE,o=function(i){var w=t.getCellForNode(i);AC.push(t.getCellUnitIndex(w));AM=w.dpt;},u,AH=h.lv>=0,AN,AA=h.setIdx,g=t.k,n=l.getFullObjectInfo(AK.id);if(t.hasArrayGSI){g=(typeof AA==="number"&&AA>-1)?N.getGSI(t.gridData.gsi,AA).k:t.gridData.sortIndex;}if(typeof AD==="string"&&AD.indexOf(";")>0){AE=parseInt(AD.substring(AD.indexOf(";")+1),10);AD=parseInt(AD.substring(0,AD.indexOf(";")),10);}if(AE===1&&!AB){x.reverse().forEach(o);}else{if(AE===1){u=1;x.forEach(o);}else{x.forEach(o);}}AN={oId:AK.id,oTp:AK.otp,depth:AM,ordinals:AC.join(","),sliceId:t.sid,viewKey:g,funcVal:AD,switchOrder:u,art:(n||{}).art,isRA:AH};if(AH&&AD===e.FunctionApplySimple){var z=l.docModel.datasets[l.data.datasetId];var j=R.walk("tables.0.dbt",z);if(j===Y.EssBase||j===Y.SAPHANAMDX||j===Y.KYLIGENCEMDX){AN.peName=AK.v||AK.n;}else{var p=t.getCellForNode(x[0]),AL=p._e.id;AN.peId=AL;AN.peName=p._e.ori_n||p._e.n;try{if(AK.fix>=0){var m=l.docModel.findUnitInDataSet(AK.id).fs,s=M.filterOne(m,function(i){return i.fnm==="DESC";}).fid;if(s){var AI=t.dataBlocks&&t.dataBlocks[p._gd]||l.data,AG=AI.gts[(AK.axis===E.Rows)?"row":"col"],q=M.filterOne(AG,function(i){return i.id===AK.id&&i.fid===s;}),AJ=q.es[p.idx];AN.peName=AJ&&(AJ.ori_n||AJ.n)||AN.peName;}}else{var y;M.forEach(AK.fs,function(AO,w){if(AO.n==="DESC"){y=w;return false;}});if(y!==undefined){var k=[];if(AK.axis===E.Rows){var AF;for(AF=p.idx;AF>-1;AF--){if(AK.es[AF].id===AL){k=[AK.es[AF].ori_n||AK.es[AF].n].concat(k);}else{break;}}for(AF=p.idx+1;AF<AK.es.length;AF++){if(AK.es[AF].id===AL){k.push(AK.es[AF].ori_n||AK.es[AF].n);}else{break;}}}else{k=M.map(M.filter(AK.es,function(i){return i.id===AL;}),function(i){return i.ori_n||i.n;});}AN.peName=k[y]||AN.peName;}}}catch(AJ){}}}return AN;}function D(i,h,k){var n=i.getDEInfo(h),m=n&&n.deObject&&n.deObject.des,l=1,j=k===-1?G(5187,"Group"):(k===e.FunctionApplySimple?G(13355,"Calculated Member"):G(5188,"Calculation")),g=function(o){return o.n===j+" "+l;};while(true&&m){if(m.some(g)){l++;}else{break;}}i.controller.onAddQuickDE(i,R.copy(L(i,h,false,k),{act:"addQuickDE",deName:j+" "+l}),h.setIdx);}function d(g,i){var h;for(h in g){if(M.find(g[h].att,"did",i)>-1){return h;}}return undefined;}function b(g){var i=g.split(";"),h;if(i.length>1&&i[i.length-2].slice(-1)!=="//"){i.splice(-1,1);}h=i.join(";");return h.replace(/\\:/g,"*:").replace(/\\;/g,";").replace(/\\\\/g,"\\").substring(1);}function A(t,h,o,k,g){var n=o.es,i=o.id,m;g.forEach(function(u){m=u[0];if(m.eid.indexOf(i)<0){n.push({n:C.decodeHtmlString(m.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:b(m.eid)});}});var j=t.controller,s=t.model&&t.model.docModel,q=j._getXtabCallback(t),l={act:"applyDEChanges",deId:h.did,attId:h.attId,attName:h.attName,dsId:h.dsId,k:t&&t.k,actions:[Z(o,k)]};s.addUpdateObjects(l,{id:l.deId||l.attId,type:47,flag:H.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});q=mstrmojo.func.wrapMethods(q,s.getDatasetsUpdateCallback(),s.getUpdateHiddenLayoutsCallback(),{success:function(){s.callOnNDECreated([o]);}});var p=function(u){return function(){if(l&&u){l.partialRetrieval={nodes:c(t,s,h)};}var w=u?s.wrapUnsetVisualizationFilterAction(l):l;j.submitUndoRedoUpdates(w,{},q,H.REQUEST_DEFN_DATA);};};s.checkAndNotifyVFChangeOnGroupUpdate({actions:l},p(true),p(false));}function Z(h,g){return{act:"update",position:g+1,item:h};}function F(i,h,l,k,j){var g=i.model.getCellTitleInfo(h).title;i.controller.onSetDEHierachyOptions(i,{act:"setDEHierarchyOptions",oId:g.id,eId:l.id,splice:k,expand:j},h.setIdx);}function Q(k,h){var g=[],j=h.t,i=h.did;k.getDropZones().zones.forEach(function(l){((l&&l.items)||[]).forEach(function(n){var o=n.t,m=n.did;if(o!==21&&m!=="-1"&&m!=="00000000000000000000000000000000"&&((o===4&&j===4)||(o!==4&&j!==4))&&m!==i&&M.find(g,"did",m)===-1){g.push(n);}});});k.docModel.getDatasetUnits(j===4?["mx"]:["att"]).forEach(function(l){if(M.find(g,"did",l.did)===-1&&l.did!==i&&!l.hide){g.push(l);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(g);}function c(j,g,i){var h=g.getSourceFilterKeys(j.zonesModel.getHost().k);M.forEach(j.parent.parent.children,function(m){var k=m.boxContent.gridInfo;if(k){var n=(k.rows.concat(k.cols)).some(function(o){return o.did===i.did;}),l=h.some(function(o){return o===m.k;});if(n&&!l){h.push(m.k);}}});return h;}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function O(g){D(this,g,-1);},addElementsToGroup:function P(i,j,h,g){A(this,i,j,h,g);},derivedElementCalculation:function B(h,g){D(this,h,g);},separateOthers:function S(g,h){F(this,g,h,1,1);},renameDEList:function J(g){this.controller.onEditQuickDEList(this,R.copy(L(this,g,true,-1),{act:"editQuickDEList",deName:g.v}));},editQuickDECalculationNumberFormat:function K(h,i){var g=L(this,h);g.deId=i.de.id;g.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,R.copy(g,this.model.docModel.createNumberFormatParams(i)),h.setIdx);},editDECalculation:function I(h,g){if(g!==undefined&&g!==null){this.controller.editQuickDECalculation(this,R.copy(L(this,h,true,g),{act:"editQuickDECalculation"}),h.setIdx);}else{this.controller.onEditQuickDECalculation(this,R.copy(L(this,h,true),{act:"editQuickDECalculation",deName:h.v}));}},createDEParam:function L(g,i,h){return L(this,g,i,h);},removeQuickDE:function W(o,t){var k=t&&t.deObject,l=(k&&k.des)||[],u=this,w=2,s=M.filter(l,function(y){return !y.ido;},{max:w+1});if(k&&(l.length<=w||s.length<=w)){var n=[],q=this.zonesModel.getZoneForObject(k.did),i=Q(this.zonesModel,k),h=M.find(i,"did",k.attId),g=h>=0?i[h]:null,p={};if(g&&q){n=this.zonesModel.getUngroupAddActions(q,k,g);p=this.controller._getXtabCallback(this);}n.push({act:"removeNDEFromDS",dsid:k.dsId,oid:k.did,disablePU:true});p=mstrmojo.func.wrapMethods(this.controller.model.getDatasetsUpdateCallback(),this.controller.model.getReloadLayoutModelCallback(),p,this.controller.getReloadLayoutViewCallback());var x=u.model&&u.model.docModel;var j=function(y){return function(){var z=(y&&x)?x.wrapUnsetVisualizationFilterAction(n):n;u.controller.submitUndoRedoUpdates(z,null,p,H.REQUEST_DEFN_DATA);};};if(x){x.checkAndNotifyVFChangeOnGroupUpdate({actions:n,zm:x},j(true),j(false));}}else{var m=R.copy(L(this,o),{act:"removeQuickDE"});this.controller.removeQuickDE(this,m,o.setIdx);}},derivedElementsEdit:function X(o,j){if(!j){j=this.getDEInfo(o);}var k=this.model,h=k.getCellTitleInfo(o).title,i=j&&j.deObject,n=j&&j.de,g,m,l;if(!i){g=this.gridData.datasetId||d(k.docModel.datasets,h.id);m=h.id;l=h.n?C.decodeHtmlString(h.n):undefined;}this.controller.openDEEditor(this,{dsId:g,attId:m,attName:l,deObj:i,elemId:n&&n.id,dispName:o.n?C.decodeHtmlString(o.n):l,setIdx:o.setIdx});},getDEInfo:function a(o){var j=this.model,l=j.getCellTitleInfo(o),m=l.isSrcTitle,h=l.title,g=o.dei,i,n;if((h&&h.ost!==12033)||(m&&o.otp!==f.Consolidation)){return null;}var k=(h&&h.id)||(m&&o.otp===f.Consolidation&&o.id);i=j.docModel.getDEObject(k);if(i&&g!==undefined){n=i.des[g];}return{deObject:i,de:n,ttl:h};},getOthersDEInfo:function U(h){var g;M.forEach(h.des,function(i){if(i.t===4){g=i;return false;}});return g;}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.DocDataService");mstrmojo.vi.models.PanelFormatSaver=mstrmojo.provide("mstrmojo.vi.models.PanelFormatSaver",{getPanelSaver:function A(C,B,D){return{saveProperty:function E(G,H){var J=B[G];if(J){if(J.convert){H=mstrmojo.boxmodel.px2Inches(C.getZoomProps(),H);}var I={},F=I[J.set]={};F[J.name]=H;C.updateUnitFormat(D||C.getRootNode(),1,I,undefined,mstrmojo.DocDataService.RAPID_EXEC);}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.ui.Checkbox","mstrmojo.css","mstrmojo.string","mstrmojo.Button","mstrmojo.threshold.ThresholdExprTree","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.models.FormatModel","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.threshold.ThresholdModel","mstrmojo.vi.util.NumberFormatUtility");mstrmojo.requiresDescs(2869,3397,5893,7978,7979,13788,13789,13790,13894,14599,14600,14601,14611);var N=mstrmojo.hash,J=mstrmojo.array,W=mstrmojo.css,B=mstrmojo.string,A=mstrmojo.models.FormatModel.decodeValue,K=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL,D=mstrmojo.vi.ui.DatasetUnitMenuUtils,L=12,M=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,O=mstrmojo.vi.util.NumberFormatUtility,G=mstrmojo.threshold.ThresholdModel.FEATURES;function U(Y){this.threshold.scope=Y;}function C(e,Z,Y,d){var a=this.previewNode;switch(e){case 10:var c=J.filterOne(K,function(f){return f.v===Z;});if(c){a.innerHTML=c.n;}break;case 4:W.addClass(a,"hasImage");a.innerHTML='<img class="replaceImg" src="'+B.encodeHtmlString(Z)+'" />';break;default:var b=B.encodeHtmlString(Z)||(Y===L?mstrmojo.desc(14611,"Sample"):"1234.567");if(!!d){b=O.applyFormatToNumber(d,b);}a.innerHTML=b;}}function E(a,Y){Y.fontFamily="'"+(a.ff||"").replace(/\'/g,"")+"'";Y.fontSize=parseInt(a.fsz,10)+"pt";Y.fontWeight=a.fw?"bold":"normal";Y.textDecoration=(a.fun?"underline":"")+" "+(a.fst?"line-through":"");Y.fontStyle=a.fit?"italic":"";Y.color=a.fc;var Z;if(!!a.bc&&!!a.bc.c1){Z=W.buildGradient(a.bc.or,a.bc.c1,a.bc.c2);if(Z&&Z.n){Y[Z.n]=Z.v;}}else{if(!!a.gdc){Z=W.buildGradient(a.gda===90?0:1,a.bc,a.gdc);if(Z&&Z.n){Y[Z.n]=Z.v;}}else{Y.backgroundColor=a.bc;}}Y.textAlign=a.alh;Y.verticalAlign=a.alv;Y.wordWrap=a.atw;Y.direction=a.atd;var b=a.bts;Y.border=a.borderStyle||(b?A("bts",b):"1px dotted");Y.borderColor=a.borderColor||a.btc||"#e1e1e1";}mstrmojo.threshold.ThresholdRow=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ThresholdRow",markupString:'<div id="{@id}" class="mstrmojo-thresholdRow cf {@cssClass}" style="{@cssText}" mstrAttach:click><div class="draggable-icon"></div><div class="container"></div><div class="previewWrap"><div class="preview"></div></div><div class="menu"></div><div class="delete"></div></div>',markupSlots:{containerNode:function Q(){return this.domNode.children[1];},draggableNode:function P(){return this.domNode.firstChild;},previewNode:function Q(){return this.domNode.children[2].firstChild;},menuNode:function Q(){return this.domNode.children[3];},deleteNode:function H(){return this.domNode.children[4];}},threshold:undefined,idx:undefined,editor:undefined,model:undefined,lblIndex:undefined,chkBox:undefined,exprTree:undefined,postBuildRendering:function S(){this.destroyChildren(false);var Y=this.threshold,Z=this.model,a=this.previewNode.style,c=N.copy(Y.fmt,N.clone(Z.getGridValueFormat())),b=Y.expr;C.call(this,Y.rtp,Y.rtxt,Z.objectType,c.nfs);if(c){E(c,a);}this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.Label",alias:"lblIndex",text:this.idx+1},{scriptClass:"mstrmojo.threshold.ThresholdExprTree",alias:"exprTree",editor:this.editor,model:this.model,items:[b]}]);Z.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");return this._super();},onselectedThresholdsChange:function R(){},onclick:function X(c){var a=this.editor,e=c.getTarget(),b=this,Z=this.model,d=a.objectType===L,Y=a.controller.supportsFeature(G.SHOW_MC_ADVANCED_EDITOR);if(e===this.deleteNode){this.removeFromModel();}else{if(e===this.menuNode){var f=new mstrmojo.ui.menus.MenuConfig();f.hostId=this.id;f.hostElement=this.menuNode;f.isHostedWithin=false;if(!Y){f.addSubMenuItem(mstrmojo.desc(13788,"Apply to"),"",a.id,function(){var g=new mstrmojo.ui.menus.MenuConfig(),i=b.threshold.scope||1,h;h=[{value:1,text:d?mstrmojo.desc(14599,"Element Rows Only"):mstrmojo.desc(13789,"Metric Only")},{value:2,text:d?mstrmojo.desc(14600,"Subtotal Rows Only"):mstrmojo.desc(13790,"Subtotals Only")},{value:3,text:d?mstrmojo.desc(14601,"Elements and Subtotals"):mstrmojo.desc(13894,"Metric and Subtotals")}];g.addRadioMenuGroup(i,U,h,"",b,true);return g;});}f.addMenuItem(mstrmojo.desc(2869,"Formatting"),"",function(){if(Y){a.openFillColor(b);}else{a.openPropertyPanel(b);}});if(Z.showNumberFormat()&&!Y){f.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),"",function(){var g=function(h){N.forEach(h,function(j,i){if(!b.threshold.fmt){b.threshold.fmt={};}b.threshold.fmt[i]=j;});b.model.raiseEvent(N.copy(b.model,{name:"modelEdit"}));};return D.getNumberFormatEditor(b,b.threshold.fmt||{},function(i){var h={};h[M.CATEGORY]=i.category||-3;h[M.CURRENCY_POSITION]=i.currencyPosition||0;h[M.CURRENCY_SYMBOL]=i.currencySymbol||"$";h[M.DECIMAL_PLACES]=i.decimalPlaces||2;h[M.FORMAT]=i.format||"";h[M.NEGATIVE_NUMBERS]=i.negativeNumbers||3;h[M.THOUSAND_SEPARATOR]=i.thousandSeparator||0;g(h);});});}f.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"",function(){Z.duplicateThreshold(b.idx);});if(this.idx!==0){f.addMenuItem(mstrmojo.desc(7978,"Move Up"),"",function(){Z.moveThreshold(b.idx,b.idx-1);});}else{f.addNonInteractiveMenuItem(mstrmojo.desc(7978,"Move Up"),"",true);}if(this.idx!==Z.thresholds[Z.metricId].length-1){f.addMenuItem(mstrmojo.desc(7979,"Move Down"),"",function(){Z.moveThreshold(b.idx,b.idx+1);});}else{f.addNonInteractiveMenuItem(mstrmojo.desc(7979,"Move Down"),"",true);}f.addMenuItem(mstrmojo.desc(5893,"New Condition"),"",function(){b.exprTree.newCondition(null);});this.openPopup(f.newInstance());}else{if(e===this.previewNode||e===this.previewNode.firstChild){if(Y){a.openFillColor(this);}else{a.openPropertyPanel(this);}}}}},removeFromModel:function F(){this.model.deleteThreshold(this.threshold);},onpropertyModelChange:function I(Y){N.copy(Y.threshold,N.clear(this.threshold));this.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo.hash","mstrmojo.EnumRWUnitType");var M=mstrmojo,D=mstrmojo.hash,B=mstrmojo.EnumRWUnitType,H=mstrmojo.chart.model.enums.EnumDSSObjectType,G=mstrmojo.vi.viz.EnumVisualizationTemplates,J=1,F=["#ec7b75","#f6db7f","#84c87b"],K=[0.35,0.65],C=M.models.FormatModel,L=C.ENUM_PROPERTY_NAMES;function E(Q,P,R,S){P.reverse().forEach(function(U){S.push(Q.getClearThresholdAction(R.did,R.t||H.DssTypeMetric,U.tid));});}mstrmojo.vi.util.ThresholdUtils=mstrmojo.provide("mstrmojo.vi.util.ThresholdUtils",{addClearAllThresholdsActions:function N(P,R,X){var W=R.data.gsi,Q=W.mx,S=W.thresholds,U;if(S){Q.forEach(function(Y){U=S[Y.did];if(U){E(P,U,Y,X);}});W.thresholds={};}},addThresholds:function A(Z,f,S,Y,W,P,Q,U){var X,c=[],b=new mstrmojo.threshold.ThresholdModel({});b.set("data",S.data);var d=D.walk("gsi.thresholds",b),R=d&&d[Y.did],a=D.walk("defn.t",S)===B.GRID;W=W||[];if(R&&b.isAdvanced(Y.did)&&!a){R=false;}if(!R||U){P=P||F;Q=Q||K;for(X=0;X<P.length;X++){var e={};e.fmt=C.getFormatUpdate(L.BACKGROUND_COLOR,P[X]);C.getFormatUpdate(L.FILL_STYLE,0,e.fmt);if(X>0){e.flr=b.getRealValue(Q[X-1],J);}if(X<Q.length){e.ceil=b.getRealValue(Q[X],J);}c.push(e);}W.push(Z.getClearThresholdAction(Y.did,H.DssTypeMetric,-1));W.push(Z.getCreateSimpleThresholdAction(c,f.k,Y.did,J,null,4));}b.destroy();return W;},getDefaultMapThreshold:function O(){return{colors:["#abcffa","#7ca8de","#4570af","#224b8f","#0e3270"],ranges:[0.2,0.4,0.6,0.8]};},getDefaultGMThreshold:function I(R){var Q,P;switch(R){case G.GRAPHMATRIXHORIZONTALBARCLUSTERED:case G.GRAPHMATRIXHORIZONTALBARSTACKED:case G.GRAPHMATRIXHORIZONTALBARPERCENT:case G.GRAPHMATRIXVERTICALBARCLUSTERED:case G.GRAPHMATRIXVERTICALBARSTACKED:case G.GRAPHMATRIXVERTICALBARPERCENT:case G.GRAPHMATRIXVERTICALBARAUTOMATIC:case G.GRAPHMATRIXGRIDCHART:case G.GRAPHMATRIXPIE:Q=["#d2e0e8","#a4cbe6","#80add9","#558dcc","#2e78bb"];P=[0.2,0.4,0.6,0.8];break;case G.GRAPHMATRIXVERTICALLINECLUSTERED:case G.GRAPHMATRIXVERTICALLINESTACKED:case G.GRAPHMATRIXVERTICALLINEPERCENT:case G.GRAPHMATRIXVERTICALLINEAUTOMATIC:case G.GRAPHMATRIXHORIZONTALLINECLUSTERED:case G.GRAPHMATRIXHORIZONTALLINESTACKED:case G.GRAPHMATRIXHORIZONTALLINEPERCENT:case G.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case G.GRAPHMATRIXVERTICALAREACLUSTERED:case G.GRAPHMATRIXVERTICALAREASTACKED:case G.GRAPHMATRIXVERTICALAREAPERCENT:case G.GRAPHMATRIXVERTICALAREAAUTOMATIC:case G.GRAPHMATRIXHORIZONTALAREACLUSTERED:case G.GRAPHMATRIXHORIZONTALAREASTACKED:case G.GRAPHMATRIXHORIZONTALAREAPERCENT:case G.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:Q=["#ec7b75","#f6db7f","#84c87b"];P=[0.35,0.65];break;case G.GRAPHMATRIXBUBBLECIRCLEMM:case G.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case G.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case G.GRAPHMATRIXBUBBLESQUAREAM:case G.GRAPHMATRIXBUBBLESQUAREMM:Q=["#abcffa","#7ca8de","#4570af","#224b8f","#0e3270"];P=[0.2,0.4,0.6,0.8];break;default:break;}return{colors:Q,ranges:P};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var G=mstrmojo.array;var I=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var F=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function B(N,O,M){this.parent.raiseFormatValueChange(N,O,M);}function E(O){var N=this.parent.model,M=N.threshold;this.replaceType.set("enabled",O);this.replaceText.set("enabled",O);this.replaceSymbol.set("enabled",O);if(!O){delete M[N.getReplaceTypeName()];delete M[N.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function K(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function A(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function D(){E.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:I,onenabledChange:function H(){if(this.enabled){B.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(O){var S=O.value,P=O.valueWas,N=this.parent,M=N.replaceText,R=N.replaceSymbol;if(S!==P){var Q=S===1;M.set("visible",!Q);M.set("hint",S===2?mstrmojo.desc(11889,"Image URL"):"");R.set("visible",Q);B.call(this,"rtp",this.items[S].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.value);}},onvalueChange:function J(){B.call(this,"rtxt",this.value);var M=this.parent,N=M.replaceType;if(!M.parent.model.threshold.rtp){B.call(this,"rtp",N.items[N.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:F,allowHTML:true,getPopupListConfig:function C(){var M=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();M.getItemMarkup=function N(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return M;},onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(M){var O=M.value,N=M.valueWas;if(O!==N){B.call(this,"rtxt",this.items[O].v);}}}],setFormatSource:function L(M){var N=this,O=N.parent.model;this.syncControls(function(){var P=M[O.getReplaceTextName()],S=M[O.getReplaceTypeName()];N.replaceRow.replaceChk.set("checked",!!P);var Q=G.find(I,"v",S);N.replaceType.set("selectedIndex",Q===-1?0:Q);if(S!==10){N.replaceText.set("value",P||"");N.replaceSymbol.set("selectedIndex",0);}else{var R=Math.max(G.find(F,"v",P),0);N.replaceSymbol.set("selectedIndex",R);N.replaceText.set("value","");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.dom","mstrmojo.css","mstrmojo._HasOwnAvatar","mstrmojo.Container","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.ColorMarker");var P=mstrmojo.color,D=mstrmojo.dom,Q=mstrmojo.css;function B(X){var W=this.parent,U=W.width,Y=Math.min(Math.max(X.last.x-D.position(this.domNode).x,0),U-1);return Y/U;}mstrmojo.threshold.MarkersNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.MarkersNode",cssClass:"markers",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"  mstrAttach:click,mousedown,mouseover,mouseout></div>',markupSlots:{containerNode:function N(){return this.domNode;}},dropZone:true,draggable:true,avatarCssClass:"marker-drag-avatar",addMarker:function O(c){this.parent.parent.switchToCustomScheme();var U=this.parent,f=U.parent.model,e=D.position(this.containerNode).w,W=U.getPalette(),a=c/e,Y=U.addMarkerToMap(a),b=W.length,Z=new mstrmojo.threshold.ColorMarker();Z.updateCompValue(a);Z.updateRealValue(f.getRealValue(a,U.selectedOption,U.minValue(),U.maxValue()));Z.set("index",Y);this.addChildren([Z]);if(b===(Y+1)){Y--;}if(this.selectedIndex!==undefined&&this.selectedIndex>-1&&this.selectedIndex<this.children.length){this.children[this.selectedIndex].unselect();}this.selectedIndex=Z.index;var X=W[Y+1],d=Y===-1?X:W[Y];W.splice(Y+1,0,P.findMidColorHex(d,X));U.update();this.children[this.selectedIndex].select();},remove:function L(U){if(U<0||U>=this.children.length){return ;}this.children[U].unselect();this.children.splice(U,1);this.domNode.removeChild(this.domNode.children[U]);},onclick:function S(W){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&W.getTarget()===this.domNode){var X=D.position(this.containerNode),U=W.e.clientX-X.x;this.addMarker(U);}},createAvatar:function K(Y,X){var W;for(W=0;W<this.children.length;W++){if(this.children[W].id===Y.id){X.tgtNode=this.children[W];X.i=W;}}var U=Y.cloneNode(true),Z=document.createElement("div");Q.addClass(Z,"bar");U.appendChild(Z);return U;},positionAvatar:function I(b){var U=this.avatar,X=U.style,Z=this.restrictedToAxis,W=D.position(this.domNode),Y=W.y;if(U){if(Z!=="y"){var a=b.x;if(a<W.x){a=W.x;}if(a>W.x+W.w){a=W.x+W.w-1;}X.left=a-2+"px";}if(Z!=="x"){X.top=Y+"px";}}},getMarkerComps:function H(U){if(!this.children){return undefined;}var W=this.children.map(function(X){return X.compValue;});return !!U?W.sort(U):W;},getMarkerRealValues:function M(U){if(!this.children){return undefined;}var W=this.children.map(function(X){return X.realValue;});return !!U?W.sort(U):W;},setMarkerRealValues:function E(W,Y,U,X){if(!this.children){return ;}this.children.forEach(function(a,Z){a.updateRealValue(W(a.compValue,Y,U,X));});},isDragValid:function A(U){return U.src.node!==this.domNode;},ondragstart:function R(W){this._super(W);var U=this.parent.getComp();this.selectedIndex=W.i;U.splice(W.i,1);},ondragmove:function J(X){this._super(X);var W=this.parent,a=W.parent.model,Z=B.call(this,X),c=this.children[X.i],U=X.tgt.pos.x-X.src.pos.x,Y=U<0,b=U>0;if((c.compValue===0&&Y)||(c.compValue===1&&b)){return ;}c.updateCompValue(Z);c.updateRealValue(a.getRealValue(Z,W.selectedOption,W.minValue(),W.maxValue()));W.editableBubble.showBubble(Z,c.realValue);},ondragend:function F(a){var Z=this.parent,W=Z.getComp(),c=this.children[a.i],Y=c.index,X=this.children.filter(function(d){return(d.index>c.index&&d.compValue<c.compValue)||(d.index<c.index&&d.compValue>c.compValue);}).map(function(d){return d.index;});if(X.length>0){var U=X[0],b=X[X.length-1];Y=(c.index>U)?U:b;}W.splice(Y,0,c.compValue);this.remove(c.index);Z.update();this.children[Y].select();this._super(a);},onmouseover:function G(W){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&!this._cursorAvatar){var Z=document,Y=this.domNode,X=this._cursorAvatar=Z.createElement("div"),U=this._mouseMoveHandler=function(d){var c=D.eventTarget(self,d),b=D.getMousePosition(d,self),a=X.style;a.top=b.y+12+"px";a.left=b.x+12+"px";a.display=(c===Y&&mstrApp.isInteractive())?"block":"none";};Z.body.appendChild(X);Q.addClass(X,"mstrmojo-SimpleThresholdEditor add-cursor");D.attachEvent(Y,"mousemove",U);}if(this._super){return this._super(W);}},onmouseout:function C(U){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED){D.detachEvent(this.domNode,"mousemove",this._mouseMoveHandler);var W=this._cursorAvatar;W.parentNode.removeChild(W);delete this._cursorAvatar;delete this._mouseMoveHandler;}if(this._super){return this._super(U);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.models.FormatModel","mstrmojo.Label","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.CustomVisUtility");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","FillConfigGroup","LineConfigGroup","PopupControlUtils");var b={HBOX:"HBox",LABEL:"Label",CHARACTERGROUP:"CharacterGroup",FILLGROUP:"FillGroup",LINEGROUP:"LineGroup",COLORBYGROUP:"ColorByGroup"};var P=mstrmojo.hash,L=mstrmojo.array,F=L.ensureArray,C=mstrmojo.VisUtility,R=mstrmojo.gm.GMUtility,S=mstrmojo.CustomVisUtility,M=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,G=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,X=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,U=mstrmojo.mstr.EnumDSSXMLObjectTypes,Y=S.log,I=mstrmojo.ui.editors.controls.PopupControlUtils;var B="30%",K="70%";function W(g,f){g.set("enabled",!f.disabled);var h=F(f.items);if(h.length>0&&g.getChildControl instanceof Function){h.forEach(function(i){var k=g.getChildControl(i.childName),j=i.disabled;if(k&&j!==undefined){k.set("enabled",!j);}});}}function e(f,i,h,g){f.forEach(function(l,k){l.slot="col"+(k+1)+"Node";});g=P.copy(g,{col1Width:i,col2Width:h,children:f});var j=new mstrmojo.ui.editors.controls.TwoColumnContainer(g);W(j,g);return j;}function a(g,i,j,f){var h="white-space: nowrap;"+(g.width?"width:"+g.width:"");return I.getLabelAndControlBox(g.text,i,j,f,h);}function A(g){var f={};P.forEach(g,function(i,h){f[i]=h;});return f;}function Z(g,h){var f={};if(g){P.forEach(h,function(j,i){var k=g[i];f[j]=k==="true"?true:(k==="false"?false:k);});}return f;}function O(p,g,q,j,n,i,m){var k=g.propertyName,h;var l={getChildComp:n,onGroupValueChange:function(t,s){if(typeof m==="function"){m(t,s);}else{p.saveObjectProperty(k,t,s,g.config,g.showFormatPanel);}},getChildControl:function(s){return this.getChildComp(s);}};P.copyProps(["width","showGradient","showNoFill","showAutomaticInColor","visibleControls","hideColorControl"],g,l);if(g.provideDefaultWidth&&l.width===undefined){l.width="140px";}h=new q(l);if(q===mstrmojo.ui.editors.controls.LineConfigGroup){var f=h.lineColorAndStyle.lineStyle;f.showNoneOption=h.showNoneOption;f.postInit();}var o=i?i:p.getProperty(k)||{};j.forEach(function(s){h.setChildValue(s,o[s]);});h.iniChildrenComp(j);W(h,g);if(g.label){return a(g.label,h);}return h;}mstrmojo.FormatControlHelper=mstrmojo.provide("mstrmojo.FormatControlHelper",{_mixinName:"mstrmojo.FormatControlHelper",getFillGroupControl:function N(h,j){var i="fillColor",f="fillAlpha";var g=0;if(j&&j.showFillColor!==false){g=g|X.FILL_COLOR;}if(j&&j.showFillAlpha!==false){g=g|X.FILL_TRANSPARENCY;}j.visibleControls=g;return O(h,j,mstrmojo.ui.editors.controls.FillConfigGroup,[i,f],function(l){if(l===i){return this.fillColorAndTrans.fillColor;}if(l===f){var k=this.fillColorAndTrans.fillAlpha;return k&&k.fillAlphaText;}return undefined;});},getLineGroupControl:function E(g,i){var h="lineColor",f="lineStyle";return O(g,i,mstrmojo.ui.editors.controls.LineConfigGroup,[h,f],function(j){if(j===h){return this.lineColorAndStyle.lineColor;}if(j===f){return this.lineColorAndStyle.lineStyle;}return undefined;});},getCharacterGroupControl:function d(o,g){var f=g&&g.config,i=g.propertyName,m=0,h,j={fontSize:M.FONT_SIZE,fontColor:M.COLOR,fontFamily:M.FONT_FAMILY,fontWeight:M.FONT_WEIGHT,fontItalic:M.FONT_STYLE,fontUnderline:M.UNDERLINE,fontLineThrough:M.LINE_THROUGH};if(g){if(g.showFontFamily!==false){m=m|G.FONT_FAMILY;}if(g.showFontStyle!==false){m=m|G.FONT_STYLE;}if(g.showFontSizeAndColor!==false){m=m|G.FONT_SIZE_AND_COLOR;}if(g.isFontSizeStepper===true){m=m|G.FONT_SIZE_USE_STEPPER;}}var k={visibleControls:m,onGroupValueChange:function(s,q){if(s===M.FONT_SIZE){if(this.visibleControls&G.FONT_SIZE_USE_STEPPER){q=q[0];}q=parseInt(q,10)+"pt";}o.saveObjectProperty(i,A(j)[s],q,f,g.showFormatPanel);},getChildControl:function(q){return this[q];}};h=new mstrmojo.ui.editors.controls.CharacterGroup(P.copy(k,g));var n=o.getProperty(i),l=Z(n,j),p=l[M.FONT_SIZE];if(g.isFontSizeStepper&&p){l[M.FONT_SIZE]=[parseInt(p,10)];}h.setFormatSource(l);W(h,g);if(g.label){return a(g.label,h);}return h;},getTwoColumnControl:function D(n,f,i){var l=L.ensureArray(f.items),k=l[0],j=l[1],h,g;h=(k&&k.width)||B;g=(j&&j.width)||K;var m=i(n,l);return e(m,h,g,f);},getLabelControl:function H(g){var f=g.labelText,h=g.cssText,i=new mstrmojo.Label({text:f});if(g.width&&g.width.match(/px$/)){h+=" white-space: nowrap;width:"+g.width;}if(h){return new mstrmojo.Box({children:i,cssText:h});}return i;},getHBoxControl:function c(i,g,f){var h=L.ensureArray(g.items),k=f(i,h),j;j={scriptClass:"mstrmojo.HBox",children:k};return j;},getColorByFillGroupControl:function J(n,h){var f="fillColor";var j=n.getColorBy(h.colorInfo);if(!j){Y("could not find color in color palette, please use the colorInfo got from dataInterface");return ;}var m=n.zonesModel.getColorByAttributes();if(!m||m.length===0){return ;}var o=n.getColorByAttInfo(m),i=L.filterOne(o,function(s,p){if(!s.colorByElementIDs){return false;}var q=P.equals(L.hash(s.colorByElementIDs),L.hash(h.colorInfo));if(q){n.currColorbyAttrListIdx=p;}return q;}),k={},l=function(u,t){var p=u===f,s=[],q=[],x=h.colorInfo,w=i.comb;q.push(w);if(p){s.push(R.encodeColor(t));x.color=t;n.updateColorMap(q,s,{success:n.openFormatPanelWithColorbyGroup.bind(n)});}};k[f]=j;h.visibleControls=X.FILL_COLOR;var g=O(n,h,mstrmojo.ui.editors.controls.FillConfigGroup,[f],function(p){if(p===f){return this.fillColorAndTrans.fillColor;}return undefined;},k,l);return g;},getColorByGroupControl:function Q(q,g){var m=q&&q.edtModel,f="fillColor",p=q.zonesModel.getColorByAttributes(),s=q.getColorByAttInfo(p),o=s.map(function(u,t){return{n:u.text,title:u.text,v:t};}),l=function(t){function u(){q.currColorbyAttrListIdx=t;var w=s[t];this.setChildValue(f,w.color);}this.syncControls(u);},i,n,h={},j=C.range(1,o.length),k=function(y,x){var w=[].concat(q.currColorbyAttrListIdx||j),u=[],t=[],AA,z;w.forEach(function(AB){AA=s[AB];z=AA&&AA.comb;t.push(z);u.push(R.encodeColor(x));AA.color=x;});q.updateColorMap(t,u);};g.visibleControls=X.FILL_COLOR;h[f]=s[q.currColorbyAttrListIdx||0].color;n=O(q,g,mstrmojo.ui.editors.controls.FillConfigGroup,[f],function(t){if(t===f){return this.fillColorAndTrans.fillColor;}return undefined;},h,k);i=m.getPulldown(o,l.bind(n),q.currColorbyAttrListIdx||0);if(p.length===0){i.set("enabled",false);n.set("enabled",false);}else{W(i,g);W(n,g);}return m.getEditorGroup([m.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),i,n]);}});mstrmojo.FormatControlHelper.FORMAT_CONTROL_TYPE=b;}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.hash");mstrmojo.requiresClsP("mstrmojo.gm","GMUtility","GMEnums");var D=mstrmojo.gm.EnumAxisScale,A=mstrmojo.gm.GMUtility,C=mstrmojo.hash;var B=mstrmojo.gm.GMAxisScale=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMAxisScale",axKey:undefined,rMin:undefined,rMax:undefined,mMin:undefined,mMax:undefined,logScale:false,scaleType:undefined,minMax:undefined,isCust:false,autoMin:false,autoMax:false,init:function(E){this._super(E);if(this.mMin===undefined){this.mMin=this.rMin;}if(this.mMax===undefined){this.mMax=this.rMax;}if(E.minMax!==undefined&&E.minMax!==D.CUSTOM){this.scaleType=E.minMax;}},absorbInfo:function(E){var F;if(this.axKey!==E.axKey){return ;}this.logScale=E.logScale;this.scaleType=E.scaleType;F=this.isCust=E.isCust;if(F===false){return ;}this.mMin=E.mMin;this.mMax=E.mMax;this.autoMin=E.autoMin;this.autoMax=E.autoMax;},serialize2String:function(){return[this.axKey,this.scaleType,this.mMin,this.mMax,this.rMin,this.rMax,this.logScale,this.autoMin,this.autoMax].join(":");}});mstrmojo.gm.GMAxisScale.createAxisScaleFromArr=function(E){var F={axKey:E[0],scaleType:parseInt(E[1],10),mMin:parseFloat(E[2]),mMax:parseFloat(E[3]),rMin:parseFloat(E[4]),rMax:parseFloat(E[5]),logScale:E[6]===""?undefined:A.isTrueForBoolValue(E[6]),autoMin:A.isTrueForBoolValue(E[7]),autoMax:A.isTrueForBoolValue(E[8])};F.isCust=(F.mMin!==F.rMin||F.mMax!==F.rMax)||F.scaleType===D.CUSTOM;return new B(F);};mstrmojo.gm.GMAxisScale.createAxisScaleCollectionFromArrays=function(F,E){E=E||{};F.forEach(function(G){E[G[0]]=mstrmojo.gm.GMAxisScale.createAxisScaleFromArr(G);});return E;};mstrmojo.gm.GMAxisScale.createAllMetricsAxObj=function(E,O){var N,J={axKey:"AllMetrics"},G=[],I=[],K,F=true,M=true,H=true;if(E.AllMetrics!==undefined){return ;}for(N in E){if(N!=="AllMetrics"&&E.hasOwnProperty(N)){K=E[N];if(J.rMin===undefined){J.rMin=K.rMin;}else{J.rMin=Math.min(J.rMin,K.rMin);}G.push(K.mMin);if(J.mMin===undefined){J.mMin=K.mMin;}else{J.mMin=Math.min(J.mMin,K.mMin);}if(J.rMax===undefined){J.rMax=K.rMax;}else{J.rMax=Math.max(J.rMax,K.rMax);}I.push(K.mMax);if(J.mMax===undefined){J.mMax=K.mMax;}else{J.mMax=Math.max(J.mMax,K.mMax);}if(J.logScale===undefined){J.logScale=K.logScale;}else{if(J.logScale!==K.logScale){F=false;}}if(J.scaleType===undefined){J.scaleType=K.scaleType;}else{if(J.scaleType!==K.scaleType){J.scaleType=D.DIFFERENT;}}if(J.autoMin===undefined){J.autoMin=K.autoMin;}else{if(J.autoMin!==K.autoMin){J.autoMin=false;M=false;}}if(J.autoMax===undefined){J.autoMax=K.autoMax;}else{if(J.autoMax!==K.autoMax){J.autoMax=false;H=false;}}}}if(O&&C.keyarray(E).length===0){J.scaleType=D.CUSTOM;J.autoMin=true;J.autoMax=true;}if(!F){J.logScale=undefined;}J.isCust=(J.mMin!==J.rMin||J.mMax!==J.rMax)||J.scaleType===D.CUSTOM;if(J.scaleType===D.CUSTOM){var L=false;I.forEach(function(P){if(P!==J.mMax){L=true;}});G.forEach(function(P){if(P!==J.mMin){L=true;}});if(!M||!H){L=true;}if(L){J.scaleType=D.DIFFERENT;}}E.AllMetrics=new B(J);return E.AllMetrics;};mstrmojo.gm.GMAxisScale.serializeCollection2String=function(I,E){var G,H=I.AllMetrics,F=[];if(H===undefined){H=mstrmojo.gm.GMAxisScale.createAllMetricsAxObj(I,E);}F.push(H.serialize2String());for(G in I){if(G!=="AllMetrics"&&I.hasOwnProperty(G)){F.push(I[G].serialize2String());}}return F.join(",");};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.color","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.PopupControlUtils");var b=mstrmojo,H=b.dom,J=b.hash,c=b.array,A=b.css,j=b.VisEnum.ControlType,i=mstrmojo.gm,E=mstrmojo.color,W=i.GMUtility,Q=b.VisUtility,k=i.FormatingPropertyTag,f=mstrmojo.models.FormatModel,e=f.ENUM_PROPERTY_NAMES,O=mstrmojo.chart.enums.EnumFontStyle,g=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,F=mstrmojo.VisEnum.NetworkLegendFormattingCategory,X=mstrmojo.ui.editors.controls.AdvancedColorPicker,R=mstrmojo.ui.editors.controls.PopupControlUtils,Y={GLOBAL:"glb",FORMATTING:"fmt"},C={FONT_COMP:"FntCmp",FONT_FAMILY:"FntFml",FONT_STYLE:"FntStyle",FONT_SIZE:"FntSz",FONT_COLOR:"FntClr",LINE_COMP:"LnCmp",SHOW:"Shw",COLOR:"Clr",STYLE:"Style",THICKNESS:"Thk"};function N(s,o){var n=this.widget,p=n.domToolbarPH,q=this;n._lastOpened=null;H.emptyNode(p);document.body.appendChild(p);A.toggleClass(p,mstrApp.getThemeClassName(),true);this.configureLegendPopup(o,p);n.toolEditor=o.newInstance({unrender:function(){}});n.toolEditorClosefn=function(t){var w=t.target,u=n.toolEditor.domNode;if(!H.contains(u,w,true,u)&&!Q.isHostedPopupNode(w,"class",true,document.body)){q.hideToolbar();n.syncWithReactFormatPanel(true);}};H.attachEvent(document.body,"mousedown",n.toolEditorClosefn,true);n.openPopup(this.widget.toolEditor);A.toggleClass(document.body,"hasToolbarPopup",true);}function L(o,n){var p;if(n===Y.GLOBAL){p=this.readGlobalProperty(o);}else{if(n===Y.FORMATTING){p=this.widget.getPropertiesOfFormatable();}}if(o.slice(-3)===C.COLOR){if(o!==k.COLOR_SQUARE_COLOR||n!==Y.GLOBAL){p=W.decodeColor(p);}}return p;}function P(o,n){var p=this;if(n===Y.GLOBAL){return function(s){var q=L.call(p,o,Y.GLOBAL);if(o===k.COLOR_SQUARE_COLOR){q=q.color;}if(!J.equals(s,q)){if(o.indexOf(C.COLOR)!==-1){s=W.encodeColor(s);}p.writeGlobalProperty(o,s);}};}return function(t,q){var s=L.call(p,o,Y.FORMATTING);if(t!==s){if(o.indexOf(C.COLOR)!==-1){t=E.encodeColor(t);}p.widget.writeFormatableProperties(o,t,q);}};}function d(o,p,n){var q=this;o=o||{};if(o.propNames===undefined){o.propNames=p;}o.onGroupValueChange=function(s,u,t){if(u!==t&&u!==undefined){(P.call(q,s,n))(u,t);}};return o;}function S(p,o,n){var q=this;c.forEach(o,function(s){var t=L.call(q,s,n);if(t!==undefined){p.setChildValue(s,t);}});}function K(o){var n="white-space: nowrap; width: 50px;";if(o===mstrmojo.desc(3905,"Background")||o===mstrmojo.desc(6242,"Color")){n="white-space: nowrap;";}else{if(o===mstrmojo.desc(2885,"Fill")){n="white-space: nowrap; margin-right: 9px;";}}return n;}function B(p,u,s,q){q=d.call(this,q,u,s);var t=this,n=function(w){w.height="22px";w.iniChildrenComp(u);S.call(t,w,u,s);},o=R.getFillConfigComp(p,q,n,K(p));return o;}function a(p,o,n){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolBoxBackgroundFill",children:[B.call(this,mstrmojo.desc(2885,"Fill"),p,o,J.copy({width:"140px",rowContainerCSSClass:"mstrmojo-ui-rowContainer"},n))]}]});}function l(s,p,u,t,o){var q=L.call(this,u,t),w=this;var n=new mstrmojo.ui.editors.controls.ColorPickerButton({isHostedWithin:true,width:"40px",selectedValue:q,showNoFill:true,postselectedValueChange:function(x){(P.call(w,u,t))(x.value,x.valueWas);}});if(s){n.alias=s;}if(typeof p==="string"){return R.getLabelAndControlBox(p,n,K(p));}return n;}function m(o){var n;if(o.listenToUpdateColorMap instanceof Function){n=o.listenToUpdateColorMap(function(){o.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});if(n&&o.detachUpdateColorMapListener instanceof Function){o.detachUpdateColorMapListener(n);}});}}function h(p,o){var n=L.call(this,p,o),q=this;return new mstrmojo.ui.menus.ToolbarEditorConfig({cssClass:"cbsquare-colorpicker",contents:[new mstrmojo.ui.editors.controls.AdvancedColorPicker({showAutomatic:!n.isDefaultColor,color:n.color,colorChanged:function(s){s=(this.showAutomatic&&s===X.VAL_AUTOMATIC)?"default":s;m(q.widget);(P.call(q,p,o))(s,n.color);q.hideToolbar();},colorCanceled:function(){q.hideToolbar();}})]});}function U(u,o){var n={},t=L.call(this,o+C.FONT_STYLE,Y.GLOBAL),q=L.call(this,o+C.FONT_COLOR,Y.GLOBAL),p=L.call(this,o+C.FONT_FAMILY,Y.GLOBAL),s=L.call(this,o+C.FONT_SIZE,Y.GLOBAL);if(t!==undefined){n[e.FONT_WEIGHT]=(!isNaN(t)&&((t&O.FS_BOLD)>0));n[e.FONT_STYLE]=(!isNaN(t)&&((t&O.FS_ITALIC)>0));n[e.UNDERLINE]=(!isNaN(t)&&((t&O.FS_UNDERLINE)>0));n[e.LINE_THROUGH]=(!isNaN(t)&&((t&O.FS_STRIKETHROUGH)>0));}if(q!==undefined){n[e.COLOR]=q;}if(s!==undefined){n[e.FONT_SIZE]=s;}if(p!==undefined){n[e.FONT_FAMILY]=p;}u.setFormatSource(n);}function G(o,n){var p=null;if(n.indexOf(C.FONT_FAMILY)!==-1){p=o.fontFamily;}else{if(n.indexOf(C.FONT_STYLE)!==-1){p=o.fontStyle;}else{if(n.indexOf(C.FONT_SIZE)!==-1){p=o.fontSize;}else{if(n.indexOf(C.FONT_COLOR)!==-1){p=o.fontColor;}}}}return p;}function M(q,p,n){var o={bold:O.FS_BOLD,italic:O.FS_ITALIC,underline:O.FS_UNDERLINE,strikeout:O.FS_STRIKETHROUGH},s=this;p.forEach(function(t){var u=G(q,t);if(u){u.propName=t;if(t.indexOf(C.FONT_STYLE)!==-1){u.postselectionChange=function(w){var z=w.added,AA=u.items[(z&&z[0]!==undefined)?z[0]:w.removed[0]],y=!!z,x=L.call(s,t,n),AB=(x===undefined?0:x);if(y){AB=AB|o[AA.css];}else{AB=AB&(~o[AA.css]);}u.parent.raiseFormatValueChange(t,AB,x);};}else{if(t.indexOf(C.FONT_FAMILY)!==-1){u.postselectedIndexChange=function(w){var z=w.value,y=w.valueWas;if(z!==y){var x=u.items;u.parent.raiseFormatValueChange(t,x[z].id,x[y]&&x[y].id);}};}else{if(t.indexOf(C.FONT_SIZE)!==-1){u.postselectedValueChange=function(w){var y=parseInt(w.value,10)+"pt",x=parseInt(w.valueWas,10)+"pt";if(y!==x){u.parent.parent.raiseFormatValueChange(t,y,x);}};}else{u.postselectedValueChange=function(w){u.parent.parent.raiseFormatValueChange(t,w.value,w.valueWas);};}}}}});}function Z(o,s,q,p){var w=this;p=p||{};if(p.propNames===undefined){p.propNames=s;}if(p.onGroupValueChange===undefined){p.onGroupValueChange=function(x,z,y){if(z!==y&&z!==undefined){(P.call(w,x,Y.GLOBAL))(z,y);}};}var n={cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"};p=J.copy(n,p);var u=new mstrmojo.ui.editors.controls.CharacterGroup(p),t=G(u,k.LEGEND_FONT_COLOR);t.showNoFill=true;M.call(this,u,s,q);U.call(this,u,o);return u;}function I(s,q){var x=q.firstChild,AB=x?x.offsetWidth:0,o=x?x.offsetHeight:0,t=document.body.offsetWidth,AA=document.body.offsetHeight,u=10,w=5,z=5;if(x){x.style.left="0";x.style.right="auto";x.style.top="0";x.style.bottom="auto";}var y={w:AB,h:0};var p=o>0;if(p){y.h=o;}else{return false;}if(p){q.style.left=s.x+"px";q.style.top=s.y-o-u/2+"px";}if(s.x+y.w>t){q.style.left=s.x-AB+"px";}if(p){var n=0;if(s.y-o-u/2<w){n=w;q.style.top=n+"px";}else{if(s.y+u/2>AA){n=Math.max(AA-u-o,w);q.style.top=n+"px";}}}}function D(n,q,p,o){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",showDivider:false,children:[Z.call(this,n,q,p,o)]}]});}mstrmojo._FormateVisLegend=mstrmojo.provide("mstrmojo._FormateVisLegend",{_mixinName:"mstrmojo._FormateVisLegend",widget:null,readGlobalProperty:undefined,writeGlobalProperty:undefined,configureLegendPopup:undefined,init:function(n){this.widget=null;if(this._super){this._super(n);}if(this.widget&&!this.widget.domToolbarPH){var o;o=document.createElement("div");o.setAttribute("class","gm-menu-placeholder");this.widget.domToolbarPH=o;}},handleRMCOnLegend:function(AA){var t=AA.getTarget(),u=AA.e,y={x:u.pageX,y:u.pageY},x=t.getAttribute("type"),o,w,q,s=this,p=this.widget;AA.cancel();AA.preventDefault();if(mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()||mstrApp.isInVFInteractMode){return ;}var z,n=function(AB){switch(AB){case j.LGD_COLORBOX_CTN:case j.LGD_COLORBOX:if(AB===j.LGD_COLORBOX){t=t.parentNode;}w=t.firstChild.identity;if(w&&w.comb){this.widget.colorSqureIdentity=w;this.selectColorBox(t,this.fmtMode);o=h.call(this,k.COLOR_SQUARE_COLOR,Y.GLOBAL);y=this.adjustColorPickerPos(t);if(!y.alignLeft){q=o.ENUM_CORNERS;o.setAlignment(q.BOTTOM_LEFT,q.TOP_RIGHT);}}break;case j.LGD_TITLE:case j.LGD_TEXT:this.selectText(true);var AC=[k.LEGEND_FONT_SIZE,k.LEGEND_FONT_FAMILY,k.LEGEND_FONT_STYLE,k.LEGEND_FONT_COLOR];o=D.call(this,"lgd",AC,Y.GLOBAL);z="lgd";break;default:this.selectLegendBody();var AD=[k.LEGEND_BG_COLOR,k.LEGEND_BG_FILL_TRANSPARENCY];o=a.call(this,AD,Y.GLOBAL);z="lgd";break;}if(o){N.call(this,y,o);if(!!z){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");p.parent.selectVIUnit();var AE=p.edtModel._targetPulldown;if(AE){AE.selectItemByField("v",z);}}}};n.call(this,x);I.call(this,y,this.widget.domToolbarPH);},hideToolbar:function(){var o=this.widget,p=o.domToolbarPH,s=p.firstChild,n=p.parentNode;if(s){p.removeChild(s);}if(n){n.removeChild(p);}var q=o.toolEditor;if(q){q.unrender=function(){q._super();};q.destroy();q.unrender=function(){};delete o.toolEditor;A.toggleClass(document.body,"hasToolbarPopup",false);A.toggleClass(p,mstrApp.getThemeClassName(),false);}if(o.toolEditorClosefn){H.detachEvent(document.body,"mousedown",o.toolEditorClosefn,true);delete o.toolEditorClosefn;}},highlightText:function(n){throw new Error("subclass need to implement highlightText function");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.viz.EnumVisualizationTemplates");var AJ=mstrmojo.gm,x=mstrmojo.array,Y=mstrmojo.hash,E=mstrmojo.css,K=AJ.GMUtility,H=mstrmojo.chart.enums.EnumFontStyle,t=AJ.WidgetPropertyTag,X=AJ.FormatingPropertyTag,e=AJ.ShapeFillType,AF=mstrmojo.vi.viz.EnumVisualizationTemplates,C=AJ.EnumContainerFitModes,g=AJ.EnumFitTo,L=AJ.EnumAxisScale,P=AJ.EnumShape,AG=AJ.EnumSubtype,O=AJ.EnumDataLabels,AP=AJ.EnumDataLabelPlacements,m=AJ.EnumLabelRotation,Z=AJ.EnumLegend,B=AJ.EnumLegendMode,i=AJ.EnumTextAlignH,y=AJ.EnumTextAlignV,n=AJ.EnumMaxSizeType,j=AJ.EnumMinSizeType,AH=AJ.EnumAxes,AO=AJ.EnumMatrixLines,AB=AJ.EnumGridLines,G=AJ.EnumLegendSlot,s=AJ.EnumGraphType,I=mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_THEME;var p={Content:1,Window:2,Compact:3,Manual:4},AS={Global:0,PerRC:1,Local:2,Custom:3,Different:4},w={Area:0,Bar:1,Line:2,Circle:4,Square:6,Tick:7,Pie:10,Ring:11},AR={Automatic:1,Absolute:2,Stacked:3,Clustered:4,Percent:5},AE={Hide:1,"Show only values":2,"Show only text":4,"Show both text value":6,"Show only percent":8,"Show both value percent":10,"Show both text percent":12,"Show text value percent":14},R={Automatic:1,Generic:2,Reserved:3},AC={Automatic:1,Manual:2,"Auto fit":3},AA={Automatic:1,Manual:2,Proportional:3},q={"Show Both":1,"Show None":2,"Show Only X":3,"Show Only Y":4},W={"Show All":1,"Show None":2,"Show Only Horizontal":3,"Show Only Vertical":4},M={Automatic:1,Show:2,Hide:3};var AI=[null,"Content","Window","Compact"],o=["Global","PerRC","Local","Custom","Different"],d=["Area","Bar","Line","StepLine","Circle","Rectangle","Square","Tick","PieSlice","Polygon","Pie","Ring"],U=[null,"Automatic","Absolute","Stacked","Clustered","Percent"],a=[null,"Hide","Show only values",null,"Show only text",null,"Show both text value",null,"Show only percent",null,"Show both value percent",null,"Show both text percent",null,"Show text value percent"],AM=[null,"Automatic","Generic","Reserved"],AL=[null,"Automatic","Manual","Auto fit"],AD=[null,"Automatic","Manual","Proportional"],A=[null,"Show Both","Show None","Show Only X","Show Only Y"],AQ=[null,"Show All","Show None","Show Only Horizontal","Show Only Vertical"],l=[null,"Automatic","Show","Hide"];var S={allAxLnShw:"xAxLnShw:yAxLnShw",allAxLnClr:"xAxLnClr:yAxLnClr",allAxLnStyle:"xAxLnStyle:yAxLnStyle",allAxLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle",allAxLnThk:"xAxLnThk:yAxLnThk",allAxTtShw:"xAxTtShw:yAxTtShw",allAxTtCtt:"xAxTtCtt:yAxTtCtt",allAxTtFntClr:"xAxTtFntClr:yAxTtFntClr",allAxTtFntFml:"xAxTtFntFml:yAxTtFntFml",allAxTtFntStyle:"xAxTtFntStyle:yAxTtFntStyle",allAxTtFntSz:"xAxTtFntSz:yAxTtFntSz",allAxLbFntClr:"xAxLbFntClr:yAxLbFntClr",allAxLbFntSz:"xAxLbFntSz:yAxLbFntSz",allAxLbFntFml:"xAxLbFntFml:yAxLbFntFml",allAxLbFntStyle:"xAxLbFntStyle:yAxLbFntStyle",allAxLbRtt:"xAxLbRtt:yAxLbRtt",allAxLbShw:"xAxLbShw:yAxLbShw",allMatrixLnShw:"vMatrixLnShw:hMatrixLnShw",allMatrixLnClr:"vMatrixLnClr:hMatrixLnClr",allMatrixLnThk:"vMatrixLnThk:hMatrixLnThk",allMatrixLnStyle:"vMatrixLnStyle:hMatrixLnStyle",allMatrixLnCmbStyle:"vMatrixLnCmbStyle:hMatrixLnCmbStyle",allNGMGridLnShw:"xGridLnShw:yGridLnShw",allGridLnShw:"majorGridLnShw:minerGridLnShw",allGridLnClr:"majorGridLnClr:minerGridLnClr",allGridLnThk:"majorGridLnThk:minerGridLnThk",allGridLnStyle:"majorGridLnStyle:minerGridLnStyle",allGridLnCmbStyle:"majorGridLnCmbStyle:minerGridLnCmbStyle",allRwColShw:"rwHdrShw:colHdrShw:rwVlShw:colVlShw",allLnShw:"xAxLnShw:yAxLnShw:xAxOriLnShw:yAxOriLnShw",allLnClr:"xAxLnClr:yAxLnClr:xAxOriLnClr:yAxOriLnClr",allLnStyle:"xAxLnStyle:yAxLnStyle:xAxOriLnStyle:yAxOriLnStyle",allLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle:xAxOriLnCmbStyle:yAxOriLnCmbStyle",allLnThk:"xAxLnThk:yAxLnThk:xAxOriLnThk:yAxOriLnThk",allTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr:lgdFntClr:dlFntClr:rfLnFntClr:xAxTtFntClr:xAxLbFntClr:yAxTtFntClr:yAxLbFntClr",allTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz:lgdFntSz:dlFntSz:rfLnFntSz:xAxTtFntSz:xAxLbFntSz:yAxTtFntSz:yAxLbFntSz",allTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml:lgdFntFml:dlFntFml:rfLnFntFml:xAxTtFntFml:xAxLbFntFml:yAxTtFntFml:yAxLbFntFml",allTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle:lgdFntStyle:dlFntStyle:rfLnFntStyle:xAxTtFntStyle:xAxLbFntStyle:yAxTtFntStyle:yAxLbFntStyle",allRwColTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr",allRwColTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz",allRwColTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml",allRwColTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle",allRwColTxtAlignH:"rwHdrTxtAlignH:colHdrTxtAlignH:rwVlTxtAlignH:colVlTxtAlignH",allRwColTxtAlignV:"rwHdrTxtAlignV:colHdrTxtAlignV:rwVlTxtAlignV:colVlTxtAlignV",outBdrShw:"OutSideBorder",allFillClr:"bgFillClr:rwHdrFillClr:colHdrFillClr",allFillTrans:"bgFillTrans:rwHdrFillTrans:colHdrFillTrans",colTxtShw:"colHdrShw:colVlShw",rwTxtShw:"rwHdrShw:rwVlShw",rwTxtTxtFntClr:"rwHdrTxtFntClr:rwVlTxtFntClr",rwTxtTxtFntSz:"rwHdrTxtFntSz:rwVlTxtFntSz",rwTxtTxtFntFml:"rwHdrTxtFntFml:rwVlTxtFntFml",rwTxtTxtFntStyle:"rwHdrTxtFntStyle:rwVlTxtFntStyle",rwTxtTxtAlignH:"rwHdrTxtAlignH:rwVlTxtAlignH",rwTxtTxtAlignV:"rwHdrTxtAlignV:rwVlTxtAlignV",colTxtTxtFntClr:"colHdrTxtFntClr:colVlTxtFntClr",colTxtTxtFntSz:"colHdrTxtFntSz:colVlTxtFntSz",colTxtTxtFntFml:"colHdrTxtFntFml:colVlTxtFntFml",colTxtTxtFntStyle:"colHdrTxtFntStyle:colVlTxtFntStyle",colTxtTxtAlignH:"colHdrTxtAlignH:colVlTxtAlignH",colTxtTxtAlignV:"colHdrTxtAlignV:colVlTxtAlignV",axOriLnShw:"xAxOriLnShw:yAxOriLnShw",axOriLnClr:"xAxOriLnClr:yAxOriLnClr",axOriLnStyle:"xAxOriLnStyle:yAxOriLnStyle",axOriLnCmbStyle:"xAxOriLnCmbStyle:yAxOriLnCmbStyle",axOriLnThk:"xAxOriLnThk:yAxOriLnThk",autoGridLnClr:"majorGridLnClr",autoGridLnCmbStyle:"majorGridLnCmbStyle",autoGridLnThk:"majorGridLnThk",autoGridLnStyle:"majorGridLnStyle"};var D={metricShapes:1,mtcLvlDataLabel:1,axisOrigin:1,AxisScale:1,fmtOnComb:1,yr:1,xr:1,y2r:1,x2r:1,rvr:1,chr:1,groupInfo:1};var AN=/[{}\[\],"'_:;\s]/i;var z="@pLd";var J=/@pLd/g;function k(AT){var AU=new window.DOMParser();return AU.parseFromString(AT,"text/xml");}function AK(){var AT=this.xmlData,AU=this.xmlDoc;if(!AU&&AT){this.xmlDoc=AU=k(AT);}return AU;}function c(AU,AT){if(!D[AU]){return AT;}return AT.replace(J,"");}function h(AY,AT){if(!D[AY]){return AT;}var AZ="",AX=0,AW,AV,AU,Aa=this.templateObjectMapping;if(!AT||AT.length===0){return AT;}AW=AT.search(AN);while(AW!==-1){if(AW!==AX){AV=AT.substring(AX,AW);if(AV.length===32){AU=Aa[AV];if(AU!==undefined){AZ+=z+AV;}}else{AZ+=AV;}}AZ+=AT[AW];AT=AT.substring(AW+1);AW=AT.search(AN);}AZ+=AT;return AZ;}function Q(AU){var AT=new XMLSerializer();return AT.serializeToString(AU);}function F(AU,AW){var AT,AV="",AX=AW.length;for(AT=0;AT<AX;AT++){if(AT!==0){AV+=",";}AV+=AU[AT]+":"+AW[AT];}return AV;}function N(AX){AX=AX||"";var AV,AU,AT=AX.split(","),AY=AT.length,AW={};for(AV=0;AV<AY;AV++){AU=AT[AV].split(":");if(AU.length===2){AW[AU[0]]=parseFloat(AU[1]);}}return AW;}function b(AV){AV=AV||"";var AT=AV.split(":"),AU={};if(AT.length===2){AU[AT[0]]=parseFloat(AT[1])||1;}return AU;}function u(AU){AU=AU||"";var AT=AU.split(",");return{first:parseInt(AT[0],10),second:parseInt(AT[1],10)};}mstrmojo.gm.GMProperty=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.gm.GMProperty",scales:null,generalProps:null,xmlDoc:null,xmlData:null,xmlDirty:false,jsonData:null,controller:null,rhIds:null,chIds:null,yIds:null,xIds:null,y2Ids:null,x2Ids:null,templateObjectMapping:null,isItemCached:null,readItemCache:null,init:function(AT){if(this._super){this._super(AT);}this.resetScales();this.resetGeneralProps();this.rhIds=[];this.chIds=[];if(!mstrmojo.gm.GMProperty.propertyMap){this.generatePropertyMap();}this.isItemCached={};this.readItemCache={};this.gm="OGM";},generatePropertyMap:function(){var AU,AW=mstrmojo.gm.GMProperty.propertyMap={};function AT(AX,AY){if(!AW[AX]){AW[AX]=[AY];}else{if(AW[AX].indexOf(AY)<0){AW[AX].push(AY);}}}function AV(AX){return function(AY){AT(AY,AX);};}for(AU in S){if(S.hasOwnProperty(AU)){AW[AU]=S[AU].split(":");x.forEach(AW[AU],AV(AU));}}},updateDefaults:function(AX,AU){var AT=AU[X.MODIFIED_DEF_FILL_COLOR],AV;if(AT){if(AT==="transparent"){AV=AT;}else{if(AT==="default"){AV=undefined;}else{if(!isNaN(AT)){AV=parseInt(AU[X.MODIFIED_DEF_FILL_COLOR],10);}else{try{AV=JSON.parse(AT.replace(/'/g,'"'));}catch(AW){AV=undefined;}}}}}if(AV!==undefined){AX[X.SHAPE_FILL_COLOR]=AV;AX[X.SHAPE_FILL_COLOR_DEFAULT]=false;}else{AX[X.SHAPE_FILL_COLOR_DEFAULT]=true;}this.defaultsObj=Y.clone(AX);},updateDefaultProp:function(AT,AU){if(this.defaultsObj&&this.defaultsObj[AT]!==AU){this.defaultsObj[AT]=AU;}},updateDataLabelValue:function(AT){if(AT&&(AT[t.DATA_LABEL]===3||AT[t.DATA_LABEL]===4)){AT[t.DATA_LABEL]=O.SHOW_TEXT_ONLY;}},resetScales:function(){this.scales={rh:[],ch:[],y:1,y2:1,x:1,x2:1,lgd:1,ctw:1,cth:1};},updateChartProps:function(AX){var AY=this,AW=this.jsonData,AV,AT=AY.host&&AY.host.supportFeature("ftFgGrpA","DataLabelMultiInfo");AV=mstrApp.getThemeProps(this.gm);AV=Y.mergeHashes(AV.GENERAL_PROPS.ALL,AV.GENERAL_PROPS[AX]);Y.keyarray(AV).forEach(function(AZ){if(AT&&AZ==="dataLabels"&&AX===s.PIE){return ;}AY.generalProps[AZ]=AV[AZ];});var AU={legendShow:t.LEGEND_VISIBLE,FitTo:t.FIT_TO,cntrFitMode:X.CONTAINER_FIT_MODE,dataLabels:t.DATA_LABEL};Y.keyarray(AU).forEach(function(AZ){if(AW[AU[AZ]]){AY.initItem(AU[AZ]);}});},resetGeneralProps:function(){var AT={};AT.fitTo=g.NONE;AT.axisScale=L.GLOBAL;AT.shape=P.LINE;AT.subtype=AG.AUTO;AT.dataLabels=O.HIDE;AT.dataLabelPlacements=AP.AUTOMATIC;AT.dataLabelRotate=m.AUTOMATIC;AT.banding=true;AT.legend=Z.SHOW;AT.legendMode=B.RESTORED;AT.legendShow=true;AT.colAlign=i.CENTER;AT.rowAlignH=i.CENTER;AT.rowAlignV=y.CENTER;AT.maxSizeType=n.AUTO;AT.minSizeType=j.AUTO;AT.maxSizeValue=0.9;AT.minSizeValue=0.2;AT.outBorder=true;AT.axes=AH.SHOW_BOTH;AT.matrixLine=AO.SHOW_ALL;AT.gridLine=AB.AUTO;AT.legendSlot=G.RIGHT_MIDDLE;this.generalProps=AT;},getXMLString:function(){return this.xmlData;},isXMLDirty:function(){return this.xmlDirty;},resetXMLDirtyFlag:function(){this.xmlDirty=false;},initFromXML:function(AW){if(AW){if(this.xmlData&&this.xmlData!==AW){this.xmlDoc=null;}this.xmlData=AW;}var AU,AX,AT=[t.FIT_TO,t.AXIS_SCALE,t.SHAPE,t.SUB_TYPE,t.DATA_LABEL,t.DATA_LABELS_PLACEMENT,t.BANDING,t.LEGEND_VISIBLE,t.DATA_LABELS_ROTATE,t.COL_ALIGNMENT,t.ROW_ALIGNMENT,t.MAX_SIZE_TYPE,t.MAX_SIZE_VALUE,t.MIN_SIZE_TYPE,t.MIN_SIZE_VALUE,t.SELECTION_TYPE,t.SELECTIONS,t.OUTSIDE_BORDER,t.AXES,t.MATRIX_LINES,t.GRID_LINES,t.LEGEND_MODE,t.LEGEND_POSITION,t.SCALE_LEGEND_WIDTH,t.SCALE_CHART_WIDTH,t.SCALE_CHART_HEIGHT,t.METRIC_SHAPES,t.AXIS_ORIGIN,t.LOG_SCALE,t.TREND_LINE_DEF,t.TREND_BUBBLE_FORE_DEF,t.REF_LINE_DEF,X.FORMATS_ON_COMBINATION,X.ALL_SHAPE_FORMAT,X.V_MATRIX_LINES_SHOW,X.V_MATRIX_LINES_COLOR,X.V_MATRIX_LINES_THICKNESS,X.V_MATRIX_LINES_STYLE,X.H_MATRIX_LINES_SHOW,X.H_MATRIX_LINES_COLOR,X.H_MATRIX_LINES_THICKNESS,X.H_MATRIX_LINES_STYLE];for(AU=0,AX=AT.length;AU<AX;AU++){this.initItem(AT[AU]);}var AV=this.generalProps;if(AV.legendShow){AV.legend=(AV.legendMode===B.MINIMIZED)?Z.MINIMIZED:Z.SHOW;}else{AV.legend=Z.HIDE;}},reInitItem:function(AW,AU){var AT=this.generalProps;var AV=this.hGetPropValue(AW);switch(AW){case t.FIT_TO:AT.fitTo=p[AV]||AU;break;case X.CONTAINER_FIT_MODE:AT[X.CONTAINER_FIT_MODE]=AV===undefined?AU:AV;break;default:break;}},initItem:function(Ac){var Ak,Ag,Aa,AZ,Aj,Ai,Ab,AV,Am,AY,An,AT,Af,AW,Al=this.rhIds,Ad=this.chIds,Ae=this.controller,AX=this.scales,AU=this.generalProps,Ah;Ah=this.hGetPropValue(Ac);switch(Ac){case X.CONTAINER_FIT_MODE:AU.cntrFitMode=Ah||C.AUTOMATIC;break;case t.FIT_TO:AU.fitTo=p[Ah]||g.AUTOMATIC;break;case t.AXIS_SCALE:AU.axisScale=AS[Ah]||L.GLOBAL;break;case t.SHAPE:Aa=w[Ah];AU.shape=isNaN(Aa)?P.LINE:Aa;break;case t.METRIC_SHAPES:case t.METRIC_LEVEL_DATA_LABEL:case t.AXIS_ORIGIN:case t.LOG_SCALE:case t.TREND_LINE_DEF:case t.TREND_BUBBLE_FORE_DEF:case t.REF_LINE_DEF:case t.FORMATS_ON_COMBINATION:case X.ALL_SHAPE_FORMAT:AU[Ac]=K.stringToJSON(Ah);break;case t.SUB_TYPE:AU.subtype=AR[Ah]||AG.AUTO;break;case t.DATA_LABEL:if(this.host&&this.host.supportFeature("ftFgGrpA","DataLabelMultiInfo")&&Ah===undefined){Ah="Show both text percent";}AU.dataLabels=AE[Ah];break;case t.DATA_LABELS_PLACEMENT:AU.dataLabelPlacements=R[Ah];break;case t.DATA_LABELS_ROTATE:AU.dataLabelRotate=Ah===undefined?m.AUTOMATIC:Number(Ah);break;case t.BANDING:AU.banding=Ah==="true";break;case t.LEGEND_VISIBLE:if(this.host&&this.host.supportFeature("ftFgGrpA","HideGMLegendByDefault")){AU.legendShow=Ah===undefined?false:Ah!=="Hide";}else{AU.legendShow=Ah!=="Hide";}break;case t.COL_ALIGNMENT:if(Ah!==undefined){Aa=parseInt(Ah,10);if(!isNaN(Aa)&&Aa>=0&&Aa<=2){this.updateItem(X.COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL,Aa);this.updateItem(X.COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,Aa);}}break;case t.ROW_ALIGNMENT:if(Ah!==undefined){Aa=u(Ah).first;if(!isNaN(Aa)&&Aa>=0&&Aa<=2){this.updateItem(X.ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL,Aa);this.updateItem(X.ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,Aa);}Aa=u(Ah).second;if(!isNaN(Aa)&&Aa>=0&&Aa<=2){this.updateItem(X.ROW_HEADER_TEXT_ALIGNMENT_VERTICAL,Aa);this.updateItem(X.ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL,Aa);}}break;case t.MAX_SIZE_TYPE:AU.maxSizeType=AC[Ah]||n.AUTO;break;case t.MAX_SIZE_VALUE:Aa=parseFloat(Ah);AU.maxSizeValue=isNaN(Aa)?0.9:Aa;break;case t.MIN_SIZE_TYPE:AU.minSizeType=AA[Ah]||(mstrApp.getThemeProps("THEME_STYLE")===I.DEFAULT?j.AUTO:j.PROPORTIONAL);break;case t.MIN_SIZE_VALUE:Aa=parseFloat(Ah);AU.minSizeValue=isNaN(Aa)?0.2:Aa;break;case t.OUTSIDE_BORDER:AU.outBorder=Ah!=="Hide";break;case t.AXES:if(Ah!==undefined){AU.axes=q[Ah]||AH.SHOW_BOTH;if(AU.axes===AH.SHOW_BOTH){Aj=Ai=true;}else{if(AU.axes===AH.SHOW_X){Aj=true;Ai=false;}else{if(AU.axes===AH.SHOW_Y){Aj=false;Ai=true;}else{Aj=Ai=false;}}}this.updateItem(X.X_AXIS_LINE_SHOW,Aj);this.updateItem(X.Y_AXIS_LINE_SHOW,Ai);}break;case t.MATRIX_LINES:if(Ah!==undefined){AU.matrixLine=W[Ah]||AO.SHOW_ALL;if(AU.matrixLine===AO.SHOW_ALL){Aj=Ai=true;}else{if(AU.matrixLine===AO.SHOW_HORIZONTAL){Aj=false;Ai=true;}else{if(AU.matrixLine===AO.SHOW_VERTICAL){Aj=true;Ai=false;}else{Aj=Ai=false;}}}this.updateItem(X.V_MATRIX_LINES_SHOW,Aj);this.updateItem(X.H_MATRIX_LINES_SHOW,Ai);}break;case t.GRID_LINES:AU.gridLine=M[Ah]||AB.AUTO;break;case t.LEGEND_MODE:AU.legendMode=parseInt(Ah,10);break;case t.LEGEND_POSITION:AW=parseInt(Ah,10);if(AW===G.LEFT){AW=G.LEFT_MIDDLE;}else{if(AW===G.RIGHT){AW=G.RIGHT_MIDDLE;}}AU.legendSlot=AW||G.RIGHT_MIDDLE;break;case t.SCALE_LEGEND_WIDTH:AX.lgd=parseFloat(Ah)||undefined;break;case t.SCALE_CHART_WIDTH:AX.ctw=parseFloat(Ah)||1;break;case t.SCALE_CHART_HEIGHT:AX.cth=parseFloat(Ah)||1;break;case t.SCALE_ROW_HEADERS:Al.length=0;Am=N(Ah);AV=Ae.getRowTitleInfo(true);Ag=AV.items.length;for(Ak=0;Ak<Ag;Ak++){Ab=AV.items[Ak].id;if(Am.hasOwnProperty(Ab)){AX.rh[Ak]=Am[Ab]||1;}else{AX.rh[Ak]=1;}Al.push(Ab);}break;case t.SCALE_COL_HEADERS:Ad.length=0;An=N(Ah);AY=Ae.getColTitleInfo(true);Ag=AY.items.length;for(Ak=0;Ak<Ag;Ak++){Ab=AY.items[Ak].id;if(An.hasOwnProperty(Ab)){AX.ch[Ak]=An[Ab]||1;}else{AX.ch[Ak]=1;}Ad.push(Ab);}break;case t.SCALE_Y:case t.SCALE_X:case t.SCALE_Y2:case t.SCALE_X2:if(Ac===t.SCALE_Y){AT=Ae.getYAxisInfo(undefined,undefined,true,false);AZ="y";}else{if(Ac===t.SCALE_X){AT=Ae.getXAxisInfo(undefined,undefined,true,false);AZ="x";}else{if(Ac===t.SCALE_Y2){AT=Ae.getYAxisInfo(undefined,undefined,false,false);AZ="y2";}else{if(Ac===t.SCALE_X2){AT=Ae.getXAxisInfo(undefined,undefined,false,false);AZ="x2";}}}}Af=b(Ah);Ag=AT.ids.length;Ab="";for(Ak=0;Ak<Ag;Ak++){if(Ak!==0){Ab+=",";}Ab+=AT.ids[Ak];}this[AZ+"Ids"]=Ab;AX[AZ]=Af[Ab]||1;break;}},resetDataLabelDefaultAngel:function(AU){var AT=this.defaultsObj;if(AT){AT.DataLabelTextAngle=AU;}},readItem:function(AV,AT){var AX=this.generalProps,AW=this.scales,AY,AU;switch(AV){case t.FIT_TO:if(AW.ctw!==1||AW.cth!==1){AU=g.MANUAL;}else{AU=AX.fitTo;}break;case X.CONTAINER_FIT_MODE:AU=AX[X.CONTAINER_FIT_MODE];break;case t.AXIS_SCALE:AU=AX.axisScale;break;case t.SHAPE:AU=AX.shape;break;case t.SUB_TYPE:AU=AX.subtype;break;case t.DATA_LABEL:AU=AX.dataLabels;break;case t.DATA_LABELS_PLACEMENT:AU=AX.dataLabelPlacements;break;case t.DATA_LABELS_ROTATE:AU=AX.dataLabelRotate;break;case t.BANDING:AU=AX.banding;break;case t.LEGEND_VISIBLE:AU=AX.legendShow;break;case t.COL_ALIGNMENT:AU=AX.colAlign;break;case t.ROW_ALIGNMENT:AU={};AU.h=AX.rowAlignH;AU.v=AX.rowAlignV;break;case t.MAX_SIZE_TYPE:AU=AX.maxSizeType;break;case t.MAX_SIZE_VALUE:AU=AX.maxSizeValue;break;case t.MIN_SIZE_TYPE:AU=AX.minSizeType;break;case t.MIN_SIZE_VALUE:AU=AX.minSizeValue;break;case t.OUTSIDE_BORDER:AU=AX.outBorder;break;case t.AXES:AU=AX.axes;break;case t.MATRIX_LINES:AU=AX.matrixLine;break;case t.GRID_LINES:AU=AX.gridLine;break;case t.LEGEND_MODE:AU=AX.legendMode;break;case t.LEGEND_POSITION:AU=AX.legendSlot;break;case t.SCALE_LEGEND_WIDTH:AU=AW.lgd;break;case t.SCALE_CHART_WIDTH:AU=AW.ctw;break;case t.SCALE_CHART_HEIGHT:AU=AW.cth;break;case t.SCALE_ROW_HEADERS:AU=AW.rh;break;case t.SCALE_COL_HEADERS:AU=AW.ch;break;case t.SCALE_Y:AU=AW.y;break;case t.SCALE_X:AU=AW.x;break;case t.SCALE_Y2:AU=AW.y2;break;case t.SCALE_X2:AU=AW.x2;break;case t.SCALE_ALL:AU=AW;break;default:AU=this.hGetPropValue(AV);break;}AY=AU;switch(AV){case X.LINE_MARKER_SHOW:case X.LEGEND_BORDER_SHOW:case X.X_AXIS_ORIGIN_LINE_SHOW:case X.Y_AXIS_ORIGIN_LINE_SHOW:case X.X_AXIS_LINE_SHOW:case X.X_AXIS_TITLE_SHOW:case X.X_AXIS_LABELS_SHOW:case X.Y_AXIS_LINE_SHOW:case X.Y_AXIS_TITLE_SHOW:case X.Y_AXIS_LABELS_SHOW:case X.V_MATRIX_LINES_SHOW:case X.H_MATRIX_LINES_SHOW:case X.ALL_ROW_COLUMN_SHOW:case X.COLUMN_HEADER_SHOW:case X.ROW_HEADER_SHOW:case X.COLUMN_VALUES_SHOW:case X.ROW_VALUES_SHOW:case X.GRID_LINE_AUTO:case t.SORT_ORDER:case X.TOTAL_SHOW:case X.INT_SUM_SHOW:case X.INT_SUM_FULL:case X.SHOW_MODEBAR:case t.AXIS_SCALE_SYNC_MODE:case X.X_AXIS_LABELS_WRAP_TEXT:case X.X_AXIS_NESTED_LABEL:if(AY){AU=(AY==="true"||AY===true);}break;case t.SHOW_ALL_LABELS:if(!this.host||!this.host.isOrdinalXAxisLabelRotationEnabled()){AU=false;}else{if(AY===undefined){var AZ=this.host&&this.host.GMController;AU=AZ&&!AZ.hasDateTimeAttr("x")&&!AZ.hasDateTimeAttr("y");}else{AU=(AY==="true"||AY===true);}}break;case X.MAJOR_GRID_LINES_SHOW:if(AY===undefined){AY=AX.gridLine;}AU=parseInt(AY,10);break;case X.MINOR_GRID_LINES_SHOW:if(AY===undefined){AY=AX.gridLine;if(AY===2){AY=AB.HIDE;}}AU=parseInt(AY,10);break;case X.X_AXIS_LABELS_ROTATION:case X.CONNECTION_LINE_STYLE:if(AY){AU=parseInt(AY,10);}break;case t.SORT_INDEX:if(AY){AU={};AU.row=u(AY).first;AU.col=u(AY).second;}break;case t.AXIS_SCALE_DATA:if(AY){AU=K.parseAxisScaleData(AY);}break;case t.METRIC_SHAPES:case t.METRIC_LEVEL_DATA_LABEL:case t.AXIS_ORIGIN:case t.LOG_SCALE:case t.TREND_LINE_DEF:case t.TREND_BUBBLE_FORE_DEF:case t.REF_LINE_DEF:case t.SELECTIONS:case t.FORMATS_ON_COMBINATION:case X.ALL_SHAPE_FORMAT:var Ab=this.isItemCached;var Aa=this.readItemCache;if(!Ab[AV]){Aa[AV]=K.stringToJSON(AU);Ab[AV]=true;}AU=Aa[AV];break;case t.SCALE_V_EXTRA_LINE:AU=parseFloat(AU)||1;break;case t.MAX_SIZE_VALUE:case t.MIN_SIZE_VALUE:if(AY){AU=parseFloat(AY);}break;case X.REF_LABELS_FONT_FAMILY:case X.REF_LABELS_FONT_SIZE:case X.REF_LABELS_FONT_STYLE:case X.REF_LABELS_FONT_COLOR:if(AY&&typeof AY==="string"&&AY.indexOf("{")>=0){AU=K.stringToJSON(AY);}break;case X.POINT_SIZE:case X.POINT_POS:case X.JITTER:case X.JTR_TYPE:case X.PTSZ_TYPE:case X.PTPOS_TYPE:if(AY){AU=parseFloat(AY);}break;case X.XBINS_START:case X.XBINS_END:case X.XBINS_SIZE:if(AY){AU=parseFloat(AY);}case X.POSITIVE_COLOR:case X.NEGATIVE_COLOR:case X.TOTAL_COLOR:case X.INT_SUM_COLOR:case X.START_COLOR:if(AU==="default"){AU=undefined;}default:break;}if(AU===undefined){if(!AT){AU=this.defaultsObj&&this.defaultsObj[AV];}}else{if(AV.slice(-3)==="Clr"&&typeof AU==="string"){if(AU!=="transparent"){if(isNaN(AU)){AU=K.stringToJSON(AU);}else{AU=parseInt(AU,10);}}}}if(typeof AU==="string"&&!isNaN(AU)){AU=parseInt(AU,10);}return AU;},clearReadItemCache:function(){this.isItemCached={};},updateItem:function(AV,AU){var AX=this.scales,AT=this.generalProps,AW=K.everythingToString(AU);this.clearReadItemCache();switch(AV){case t.FIT_TO:AU=AU===p.Manual?AT.fitTo:AU;AT.fitTo=AU;AW=AI[AU===p.Manual?AT.fitTo:AU];break;case t.AXIS_SCALE:AT.axisScale=AU;AW=o[AU];break;case t.SHAPE:AT.shape=AU;AW=d[AU];break;case t.SUB_TYPE:AT.subtype=AU;AW=U[AU];if(!AW){AW=AU;}break;case t.DATA_LABEL:AT.dataLabels=AU;AW=a[AU];break;case t.DATA_LABELS_PLACEMENT:if(typeof AU==="boolean"){AT.dataLabelPlacements=AU?1:2;}else{AT.dataLabelPlacements=AU;}AW=AM[AT.dataLabelPlacements];break;case t.DATA_LABELS_ROTATE:AT.dataLabelRotate=AU;break;case t.BANDING:AT.banding=AU;break;case t.LEGEND_VISIBLE:AT.legendShow=AU;AW=AU?"Show":"Hide";break;case t.ROW_ALIGNMENT:AT.rowAlignH=AU.h;AT.rowAlignV=AU.v;AW=AU.h+","+AU.v;break;case t.COL_ALIGNMENT:AT.colAlign=AU;break;case t.MAX_SIZE_TYPE:AT.maxSizeType=AU;AW=AL[AU];break;case t.MAX_SIZE_VALUE:AT.maxSizeValue=AU;break;case t.MIN_SIZE_TYPE:AT.minSizeType=AU;AW=AD[AU];break;case t.MIN_SIZE_VALUE:AT.minSizeValue=AU;break;case t.OUTSIDE_BORDER:AT.outBorder=AU;AW=AU?"Show":"Hide";break;case t.AXES:AT.axes=AU;AW=A[AU];break;case t.MATRIX_LINES:AT.matrixLine=AU;AW=AQ[AU];break;case t.GRID_LINES:AT.gridLine=AU;AW=l[AU];break;case t.LEGEND_MODE:AT.legendMode=AU;break;case t.LEGEND_POSITION:AT.legendSlot=AU;break;case t.SCALE_LEGEND_WIDTH:AX.lgd=AU;break;case t.SCALE_CHART_WIDTH:AX.ctw=parseFloat(AU)||1;break;case t.SCALE_CHART_HEIGHT:AX.cth=parseFloat(AU)||1;break;case t.SCALE_ROW_HEADERS:AX.rh=AU;AW=F(this.rhIds,AX.rh);break;case t.SCALE_COL_HEADERS:AX.ch=AU;AW=F(this.chIds,AX.ch);break;case t.SCALE_Y:AX.y=AU;AW=this.yIds+":"+AX.y;break;case t.SCALE_X:AX.x=AU;AW=this.xIds+":"+AX.x;break;case t.SCALE_Y2:AX.y2=AU;AW=this.y2Ids+":"+AX.y2;break;case t.SCALE_X2:AX.x2=AU;AW=this.x2Ids+":"+AX.x2;break;case t.SORT_INDEX:AW=AU.row+","+AU.col;break;default:break;}this.hSetPropValue(AV,AW);},removeItem:function(AT){this.hRemoveProp(AT);},updateItems:function(AW,AT){var AU,AV=AW.length;for(AU=0;AU<AV;AU++){this.updateItem(AW[AU],AT[AU]);}},setController:function(AT){this.controller=AT;this.initItem(t.SCALE_ROW_HEADERS);this.initItem(t.SCALE_COL_HEADERS);this.initItem(t.SCALE_Y);this.initItem(t.SCALE_X);this.initItem(t.SCALE_Y2);this.initItem(t.SCALE_X2);},initHTML5Props:function(AV){var Aa=this.readItem,Ai=AV.LEGEND={},Ao=AV.BK={},Al=AV.RH_BK={},Af=AV.CH_BK={},Ad=AV.RH_TITLE={},Ab=AV.RH={},Ae=AV.CH_TITLE={},AX=AV.CH={},Ah=AV.AXIS_LABEL_X={},Ag=AV.AXIS_LABEL_Y={},An=AV.AXIS_TITLE_X={},Am=AV.AXIS_TITLE_Y={},AY=AV.AXIS_LINE_X={},AW=AV.AXIS_LINE_Y={},Ak=AV.MATRIX_LINE_H={},AZ=AV.MATRIX_LINE_V={},AU=AV.GRID_LINE_MAJOR={},Ac=AV.GRID_LINE_MINOR={},AT=AV.OUTSIDE_BORDER={},Aq=function(Au,Ar,As){if(Ar===e.Gradient){As=K.decodeColor(As);var At=E.buildGradient(As.or,As.c1,As.c2);if(At){Au[At.n]=At.v;}}else{Au.backgroundColor=K.decodeColor(As);}},Ap=function(As,Ar){As.fontWeight=(Ar&H.FS_BOLD?"bold":"normal");As.fontStyle=(Ar&H.FS_ITALIC?"italic":"normal");if((Ar&H.FS_STRIKETHROUGH)&&(Ar&H.FS_UNDERLINE)){As.textDecoration="line-through underline";}else{if(Ar&H.FS_STRIKETHROUGH){As.textDecoration="line-through";}else{if(Ar&H.FS_UNDERLINE){As.textDecoration="underline";}else{As.textDecoration="none";}}}},Aj=function(Ar){var As=["solid","dashed","dotted"];return As[Ar]||"none";};Ai.fontFamily=Aa.call(this,X.LEGEND_FONT_FAMILY);Ai.fontSize=Aa.call(this,X.LEGEND_FONT_SIZE);Ap(Ai,Aa.call(this,X.LEGEND_FONT_STYLE));Ai.color=K.decodeColor(Aa.call(this,X.LEGEND_FONT_COLOR));Aq(Ai,Aa.call(this,X.LEGEND_BG_FILL_STYLE),Aa.call(this,X.LEGEND_BG_COLOR));Ai.opacity=Aa.call(this,X.LEGEND_BG_FILL_TRANSPARENCY)/100;if(Aa.call(this,X.LEGEND_BORDER_SHOW)){Ai.borderWidth=parseInt(Aa.call(this,X.LEGEND_BORDER_THICKNESS),10)+"px";Ai.borderStyle=Aj(Aa.call(this,X.LEGEND_BORDER_LINE_STYLE));Ai.borderColor=K.decodeColor(Aa.call(this,X.LEGEND_BORDER_COLOR));}Aq(Ao,Aa.call(this,X.BG_FILL_STYLE),Aa.call(this,X.BG_COLOR));Ao.opacity=Aa.call(this,X.BG_FILL_TRANSPARENCY)/100;Aq(Al,Aa.call(this,X.ROW_HEADER_FILL_STYLE),Aa.call(this,X.ROW_HEADER_FILL_COLOR));Al.opacity=Aa.call(this,X.ROW_HEADER_FILL_TRANSPARENCY)/100;Aq(Af,Aa.call(this,X.COLUMN_HEADER_FILL_STYLE),Aa.call(this,X.COLUMN_HEADER_FILL_COLOR));Af.opacity=Aa.call(this,X.COLUMN_HEADER_FILL_TRANSPARENCY)/100;Ad.fontFamily=Aa.call(this,X.ROW_HEADER_TEXT_FONT_FAMILY);Ad.fontSize=Aa.call(this,X.ROW_HEADER_TEXT_FONT_SIZE);Ap(Ad,Aa.call(this,X.ROW_HEADER_TEXT_FONT_STYLE));Ad.color=K.decodeColor(Aa.call(this,X.ROW_HEADER_TEXT_FONT_COLOR));Ae.fontFamily=Aa.call(this,X.COLUMN_HEADER_TEXT_FONT_FAMILY);Ae.fontSize=Aa.call(this,X.COLUMN_HEADER_TEXT_FONT_SIZE);Ap(Ae,Aa.call(this,X.COLUMN_HEADER_TEXT_FONT_STYLE));Ae.color=K.decodeColor(Aa.call(this,X.COLUMN_HEADER_TEXT_FONT_COLOR));Ab.fontFamily=Aa.call(this,X.ROW_VAVLUE_TEXT_FONT_FAMILY);Ab.fontSize=Aa.call(this,X.ROW_VAVLUE_TEXT_FONT_SIZE);Ap(Ab,Aa.call(this,X.ROW_VAVLUE_TEXT_FONT_STYLE));Ab.color=K.decodeColor(Aa.call(this,X.ROW_VAVLUE_TEXT_FONT_COLOR));AX.fontFamily=Aa.call(this,X.COLUMN_VAVLUE_TEXT_FONT_FAMILY);AX.fontSize=Aa.call(this,X.COLUMN_VAVLUE_TEXT_FONT_SIZE);Ap(AX,Aa.call(this,X.COLUMN_VAVLUE_TEXT_FONT_STYLE));AX.color=K.decodeColor(Aa.call(this,X.COLUMN_VAVLUE_TEXT_FONT_COLOR));Ag.fontFamily=Aa.call(this,X.Y_AXIS_LABELS_FONT_FAMILY);Ag.fontSize=Aa.call(this,X.Y_AXIS_LABELS_FONT_SIZE);Ap(Ag,Aa.call(this,X.Y_AXIS_LABELS_FONT_STYLE));Ag.color=K.decodeColor(Aa.call(this,X.Y_AXIS_LABELS_FONT_COLOR));Ah.fontFamily=Aa.call(this,X.X_AXIS_LABELS_FONT_FAMILY);Ah.fontSize=Aa.call(this,X.X_AXIS_LABELS_FONT_SIZE);Ap(Ah,Aa.call(this,X.X_AXIS_LABELS_FONT_STYLE));Ah.color=K.decodeColor(Aa.call(this,X.X_AXIS_LABELS_FONT_COLOR));Am.fontFamily=Aa.call(this,X.Y_AXIS_TITLE_FONT_FAMILY);Am.fontSize=Aa.call(this,X.Y_AXIS_TITLE_FONT_SIZE);Ap(Am,Aa.call(this,X.Y_AXIS_TITLE_FONT_STYLE));Am.color=K.decodeColor(Aa.call(this,X.Y_AXIS_TITLE_FONT_COLOR));An.fontFamily=Aa.call(this,X.X_AXIS_TITLE_FONT_FAMILY);An.fontSize=Aa.call(this,X.X_AXIS_TITLE_FONT_SIZE);Ap(An,Aa.call(this,X.X_AXIS_TITLE_FONT_STYLE));An.color=K.decodeColor(Aa.call(this,X.X_AXIS_TITLE_FONT_COLOR));AY.borderWidth=parseInt(Aa.call(this,X.X_AXIS_LINE_THICKNESS),10)+"px";AY.borderColor=K.decodeColor(Aa.call(this,X.X_AXIS_LINE_COLOR));AY.borderTopStyle=Aj(Aa.call(this,X.X_AXIS_LINE_STYLE));AW.borderWidth=parseInt(Aa.call(this,X.Y_AXIS_LINE_THICKNESS),10)+"px";AW.borderColor=K.decodeColor(Aa.call(this,X.Y_AXIS_LINE_COLOR));AW.borderLeftStyle=Aj(Aa.call(this,X.Y_AXIS_LINE_STYLE));Ak.borderWidth=parseInt(Aa.call(this,X.H_MATRIX_LINES_THICKNESS),10)+"px";Ak.borderColor=K.decodeColor(Aa.call(this,X.H_MATRIX_LINES_COLOR));Ak.borderTopStyle=Aj(Aa.call(this,X.H_MATRIX_LINES_STYLE));AZ.borderWidth=parseInt(Aa.call(this,X.V_MATRIX_LINES_THICKNESS),10)+"px";AZ.borderColor=K.decodeColor(Aa.call(this,X.V_MATRIX_LINES_COLOR));AZ.borderLeftStyle=Aj(Aa.call(this,X.V_MATRIX_LINES_STYLE));AU.borderWidth=parseInt(Aa.call(this,X.MAJOR_GRID_LINES_THICKNESS),10)+"px";AU.borderColor=K.decodeColor(Aa.call(this,X.MAJOR_GRID_LINES_COLOR));AU.borderTopStyle=Aj(Aa.call(this,X.MAJOR_GRID_LINES_STYLE));AU.borderLeftStyle=AU.borderTopStyle;Ac.borderWidth=parseInt(Aa.call(this,X.MINER_GRID_LINES_THICKNESS),10)+"px";Ac.borderColor=K.decodeColor(Aa.call(this,X.MINER_GRID_LINES_COLOR));Ac.borderTopStyle=Aj(Aa.call(this,X.MINER_GRID_LINES_STYLE));Ac.borderLeftStyle=Ac.borderTopStyle;AT.borderWidth=parseInt(Aa.call(this,X.OUTSIDE_BORDER_THICKNESS),10)+"px";AT.borderColor=K.decodeColor(Aa.call(this,X.OUTSIDE_BORDER_COLOR));AT.borderLeftStyle=Aj(Aa.call(this,X.OUTSIDE_BORDER_STYLE));AT.borderTopStyle=Aj(Aa.call(this,X.OUTSIDE_BORDER_STYLE));},readItemDefault:function(AY,AW){var AX,AU={CIRCLE:0.7,Bar:0.7,AREA:0.7,PIE:0.8,RING:0.8},AV={CIRCLE:2,Bar:1,AREA:2,PIE:1,RING:1},AT={1:AR.Stacked,2:AR.Automatic,0:AR.Automatic};switch(AY){case X.X_AXIS_TITLE_SHOW:case X.Y_AXIS_TITLE_SHOW:AX=AW.isMetric?true:false;break;case X.SHAPE_FILL_TRANSPARENCY:AX=AU[AW.shapeType];break;case X.SHAPE_BORDER_THICKNESS:AX=AV[AW.shapeType];break;case t.SUB_TYPE:AX=AT[AW.shapeType];break;}return AX;},consumeJsonFmt:function(AU){var AW,AV=[],AT=[];for(AW in AU){if(AU.hasOwnProperty(AW)){AV.push(AW);AU[AW]=c(AW,AU[AW],this.templateObjectMapping);AT.push(AU[AW]);}}this.xmlData=this.makeDefaultPropXML(AV,AT);this.jsonData=AU;},hSyncWithJson:function(AV,AU,AW){var AT=this.jsonData;if(AT){if(AW){delete AT[AV];}else{AT[AV]=AU;}}},hGetPropValue:function(AX){var AW,AU=this.jsonData,AV;if(AU){return AU[AX];}else{AW=AK.call(this);if(AW){var AT=AW.getElementsByTagName("fmt")[0],AY=AT.getElementsByTagName(AX)[0];if(AY){AV=AY.getAttribute("value");return c(AX,AV,this.templateObjectMapping);}}}return undefined;},hRemoveProp:function(AV){this.hSyncWithJson(AV,"",true);var AU=AK.call(this),AT=AU.getElementsByTagName("fmt")[0],AW=AT.getElementsByTagName(AV)[0];if(AW){AW.parentNode.removeChild(AW);this.xmlData=Q(AU);this.xmlDirty=true;}return this.xmlData;},hSetPropValue:function(AW,AV){if(typeof AV==="undefined"){return this.hRemoveProp(AW);}if((typeof AV)!=="string"){AV=AV.toString();}this.hSyncWithJson(AW,AV);var AU=AK.call(this),AT=AU.getElementsByTagName("fmt")[0],AX=AT.getElementsByTagName(AW)[0];if(!AX){AX=AU.createElement(AW);AT.appendChild(AX);}AX.setAttribute("value",h.call(this,AW,AV));this.xmlData=Q(AU);this.xmlDirty=true;return this.xmlData;},hSetPropValues:function(Aa,AZ){var AX,AW,AT,AY,AU=Aa.length,Ab=AK.call(this),AV=Ab.getElementsByTagName("fmt")[0];for(AX=0;AX<AU;AX++){AT=Aa[AX];AY=AZ[AX];this.hSyncWithJson(AT,AY);AW=AV.getElementsByTagName(AT)[0];if(!AW){AW=Ab.createElement(AT);AV.appendChild(AW);}AW.setAttribute("value",h.call(this,AT,AY));}this.xmlData=Q(Ab);this.xmlDirty=true;return this.xmlData;},clearCachedXMLDoc:function(){if(this.xmlDoc){delete this.xmlDoc;}},setTemplateObjectMapping:function(AT){this.templateObjectMapping=AT;},makeDefaultPropXML:function f(AZ,Aa){var AW,AV,AT=AZ.length,AY=new window.DOMParser(),AX="<props><widgetProps><fmt></fmt></widgetProps></props>",Ab=AY.parseFromString(AX,"text/xml"),AU=Ab.getElementsByTagName("fmt")[0];for(AW=0;AW<AT;AW++){AV=Ab.createElement(AZ[AW]);AV.setAttribute("value",h.call(this,AZ[AW],Aa[AW]));AU.appendChild(AV);}return Q(Ab);}});mstrmojo.gm.GMProperty.getUnderlyingPropertyNameWithAll=function(AT){return(S[AT]||AT).split(":");};mstrmojo.gm.GMProperty.convertToReferenceFormat=h;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.VisEnum","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.editors.controls.AdvancedColorPicker");var I=mstrmojo.gm,G=mstrmojo.dom,H=mstrmojo.css,A=I.GMUtility,K=I.EnumIdentityType,M=mstrmojo.VisEnum.ControlType,N=mstrmojo.ui.editors.controls.AdvancedColorPicker,J=I.ColorSquareIdentity,B=1,F=3,C=16,D="px";function L(P,Q){var R=P.decodedColor||P.color||N.VAL_AUTOMATIC,O;if(R.c1){O=H.buildGradient(R.or,R.c1,R.c2);Q.style[H.convertCssToCamelCase(O.n)]=O.v;}else{Q.style.backgroundColor=R;}if(P.image){Q.style.backgroundImage=P.image;}if(P.opacity!==undefined){Q.style.opacity=P.opacity;}Q.identity=new J({objType:K.COLOR_SQUARE,parentIdentity:this.identity,token:P.token,decodedColor:P.decodedColor,encodedColor:P.encodedColor,isDefaultColor:P.isDefaultColor});}mstrmojo.gm.SingleColorByLegend=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gm.SingleColorByLegend",markupString:'<div class="gm-legend-colorby-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><div class="gm-legend-table-container"><table class="gm-legend-table"></table></div></div>',markupSlots:{domLgdContent:function(){return this.domNode;},sepLine:function(){return this.domNode.firstChild;},cbTitle:function(){return this.domNode.childNodes[1];},cbTableContainer:function(){return this.domNode.childNodes[2];},cbTable:function(){return this.domNode.childNodes[2].firstChild;}},rowHeight:22,setupScrollNodes:function E(){this.scrollNode=this.cbTableContainer;},postBuildRendering:function(){var O,Q,R,P={objType:K.LEGEND};this._super();Q=this.sepLine;Q.style.width=this.coreWidth+D;O=this.cbTitle;R=O.style;O.identity={objType:K.LEGEND_TEXT,parentIdentity:P};R.lineHeight=this.tableTitleLineHeight+D;R.maxHeight=2*this.tableTitleLineHeight+D;},onscroll:function(){var Q=this.scrollNode.scrollTop,P=this.data,O=P&&P.dataObj;if(this.prevScrpllTop===Q){return ;}if(O){this.fillColorByTableInNormalMode(O,Math.floor(Q/this.rowHeight));this.prevScrpllTop=Q;this.scrollNode.scrollTop=Q;this._super();}},fillColorByTableInNormalMode:function(j,Y){var k,g,Q,X,W,Z,a,O,c=this.coreWidth,d,R,P,l,f,o,m,S=this.parent,b=S.styles,U=this.rowHeight,e=this.data.cutBy;m=this.cbTable;G.emptyNode(m);if(Y<0){Y=0;}d=j.elements;g=d.length;O=document.createDocumentFragment();R=c-C-F;P=0;l=U*g;f=Y*U;function h(i){Q=document.createElement("tr");X=document.createElement("td");Q.style.height=i+D;X.setAttribute("class","gm-legend-colorbox");Q.appendChild(X);O.appendChild(Q);}if(Y>0){h(f);}for(k=Y;k<g;k++){Q=document.createElement("tr");X=document.createElement("td");W=document.createElement("td");Z=document.createElement("div");a=document.createElement("div");Z.setAttribute("class","gm-legend-colorbox-ctn-div");Z.setAttribute("type",M.LGD_COLORBOX_CTN);a.setAttribute("class","gm-legend-colorbox-div");a.setAttribute("type",M.LGD_COLORBOX);L.call(this,d[k],a);Q.setAttribute("class","gm-legend-tr");Q.style.height=U+D;X.setAttribute("class","gm-legend-colorbox");W.setAttribute("class","gm-legend-desc");o=d[k];if(o.bftp){A.fillImageInDiv(W,o.bftp,o.label,"gm-img-legend");}else{S.fillTextInDiv(W,o.label,k,B,R,b);}Z.appendChild(a);X.appendChild(Z);Q.appendChild(X);Q.appendChild(W);O.appendChild(Q);P+=U;if(e&&(e+P-U)>l){h(l-P-f);break;}}m.appendChild(O);},fillColorByTableInMinMode:function(P,X){var W,Q,Y,U,Z=document,S,R,a,O=this.rowHeight;if(!P||isNaN(X)){return ;}a=this.cbTable;G.emptyNode(a);Q=P.length;for(W=0;W<Q;W++){Y=Z.createElement("tr");U=Z.createElement("td");S=Z.createElement("div");R=Z.createElement("div");S.setAttribute("class","gm-legend-colorbox-ctn-div");S.setAttribute("type",M.LGD_COLORBOX_CTN);S.setAttribute("title",P[W].label);R.setAttribute("class","gm-legend-colorbox-div");R.setAttribute("type",M.LGD_COLORBOX);L.call(this,P[W],R);Y.setAttribute("class","gm-legend-tr");Y.style.height=O+D;U.setAttribute("class","gm-legend-colorbox");S.appendChild(R);U.appendChild(S);Y.appendChild(U);a.appendChild(Y);if(a.offsetHeight+O>X){break;}}a.style.top="0px";a.style.marginLeft="0px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TargetMask","mstrmojo.css","mstrmojo.desc","mstrmojo.hash");var B="targetMask";mstrmojo.vi.ui._HasTargets=mstrmojo.provide("mstrmojo.vi.ui._HasTargets",{_mixinName:"mstrmojo.vi.ui._HasTargets",init:function C(D){if(this._super){this._super(D);}this.addChildren([{scriptClass:"mstrmojo.vi.ui.TargetMask",alias:B,slot:"domNode",tooltipContent:this.maskTooltip,allowFilters:this.allowFilters}]);},setMaskClass:function(E,D){if(this[B].setMaskClass(E,D)){this._originalContextMenu=this.shouldShowCustomizeContextMenu;this.shouldShowCustomizeContextMenu=function(){return false;};this._originalIsDraggable=this.draggable;this.draggable=false;}},clearMaskClass:function(){this.shouldShowCustomizeContextMenu=this._originalContextMenu;delete this._originalContextMenu;this.draggable=this._originalIsDraggable;delete this._originalIsDraggable;this[B].clearMaskClass();},widgetResized:function A(){this._super();if(this.targetMask&&this.targetMask.candidatePicker){this.targetMask.candidatePicker.resize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder","mstrmojo.gm.GMEnums","mstrmojo.gm.GMAxisScale","mstrmojo.VisUtility","mstrmojo.gm.GMProperty");var U=mstrmojo,J=U.hash,H=U.array,S=U.vi.viz,P=S.EnumDSSDropZones,M=1,G=0,K=S.DropZoneHelper.METRIC_NAMES_ID,I,X=mstrmojo.gm.DualAxisSubAxisBit,W=mstrmojo.gm.EnumFeatureFlags,A=mstrmojo.gm.GMProperty,C=mstrmojo.vi.viz.EnumVisualizationTemplates,B=mstrmojo.gm.GMAxisScale,F=X.PRIMARY,Q=mstrmojo.VisUtility;function O(Y){if(this.AxisScaleSyncMode){Y.AxisScaleSyncMode=this.AxisScaleSyncMode;Y.MinMax="Custom";Y.AxisScale=B.serializeCollection2String([],true);}switch(this.visType){case C.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:Y.userVisType=C.GRAPHMATRIXVERTICALBARCLUSTERED;break;case C.VERTICALSYNCHRONIZEDAXISBAR:case C.HORIZONTALSYNCHRONIZEDAXISBAR:break;default:Y.userVisType=this.visType;break;}}mstrmojo.vi.viz.GraphMatrixHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.GraphMatrixHelper",handled:false,rowObjects:null,columnObjects:null,xAxisObjects:null,yAxisObjects:null,angleObjects:null,sliceObjects:null,breakByObjects:null,colorByObjects:null,currentXML:"",sizeByObjects:null,tooltipMetrics:null,data:null,metricsDropZone:"",secondaryMetricsDropZone:"",shape:"",subtype:"",metricShapes:null,visType:-1,init:function N(Y){this.rowObjects=[];this.columnObjects=[];this.xAxisObjects=[];this.yAxisObjects=[];this.angleObjects=[];this.sliceObjects=[];this.breakByObjects=[];this.colorByObjects=[];this.sizeByObjects=[];this.tooltipMetrics=[];this.currentXML="";this.metricsDropZone="";this.secondaryMetricsDropZone="";this.shape="";this.subtype="";this.metricShapes="{}";this._super(Y);},clone:function R(Z){var Y=this;Y.rowObjects=Z.rowObjects.concat();Y.columnObjects=Z.columnObjects.concat();Y.xAxisObjects=Z.xAxisObjects.concat();Y.yAxisObjects=Z.yAxisObjects.concat();Y.angleObjects=Z.angleObjects.concat();Y.sliceObjects=Z.sliceObjects.concat();Y.breakByObjects=Z.breakByObjects.concat();Y.colorByObjects=Z.colorByObjects.concat();Y.sizeByObjects=Z.sizeByObjects.concat();Y.tooltipMetrics=Z.tooltipMetrics.concat();Y.currentXML=Z.currentXML;Y.metricsDropZone=Z.metricsDropZone;Y.secondaryMetricsDropZone=Z.secondaryMetricsDropZone;Y.shape=Z.shape;Y.subtype=Z.subtype;Y.metricShapes=Z.metricShapes;},exists:function(a,Y){var b=this[Y],Z=false;H.forEach(b,function(c){Z=(c.did===a.did);if(Z){return false;}});return Z;},removeAngleMetricFromOthers:function(Y){["xAxisObjects","yAxisObjects","tooltipMetrics"].every(function(b){var a=this[b],Z=H.find(a,"did",Y.did);if(Z>-1){a.splice(Z,1);return false;}});},getXml:function L(c){var Y=this.data.dz,b=A.convertToReferenceFormat,d,Z=Y?J.copy(Y.visProp&&Y.visProp.fmt,{}):{},a=new mstrmojo.XMLBuilder();if(c&&J.walk("property.scriptClass",c)==="mstrmojo.gm.GMProperty"){d=c.property;}if(this.data.visName===mstrmojo.vi.viz.EnumVizStyles.MAPBOX){delete Z.cr;}if(this.visStyle){Z.visStyle=this.visStyle;}if(this.shape){Z.Shape=this.shape;}if(this.subtype){Z.Subtype=this.subtype;}if(this.metricShapes){Z.metricShapes=this.metricShapes;}if(this.groupInfo){Z.groupInfo=this.groupInfo;}Z.visType=this.visType;O.call(this,Z);Q.addDefaultProps(Z);Q.addVisFeatureFlags(W,Z);a.addChild("props");a.addChild("widgetProps");a.addChild("fmt");J.forEach(Z,function(e,f){a.addChild(f);a.addAttribute("value",d?b.call(d,f,e):e);a.closeElement();});a.closeElement();a.closeElement();a.closeElement();return a.toString();},setData:function D(b){if(!b){return ;}var Z=this,a=function(d,e){if(d){var c=(d.TemplateUnit||[]).concat(d.TemplateMetric||[]);if(c){c.forEach(function(f){var g=J.copy(f);if(!g.did){g.did=g.id;}e.push(g);});}}};a(b[I.PROP_ROWS],this.rowObjects);a(b[I.PROP_COLUMNS],this.columnObjects);a(b[I.PROP_XAXIS],this.xAxisObjects);a(b[I.PROP_YAXIS],this.yAxisObjects);a(b[I.PROP_BREAKBY],this.breakByObjects);a(b[I.PROP_COLORBY],this.colorByObjects);a(b[I.PROP_SIZEBY],this.sizeByObjects);a(b[I.PROP_SLICE],this.sliceObjects);a(b[I.PROP_ANGLE],this.angleObjects);a(b[I.PROP_TOOLTIPMETRICS],this.tooltipMetrics);var Y=b.visProp.fmt;this.shape=Y[I.PROP_SHAPE];this.subtype=Y[I.PROP_SUBTYPE];},setMetricsDropZone:function E(Y){if(!Y){return ;}var Z=this;[I.PROP_ROWS,I.PROP_COLUMNS,I.PROP_XAXIS,I.PROP_YAXIS,I.PROP_BREAKBY,I.PROP_SLICE,I.PROP_COLORBY].forEach(function(a){if(Y[a]&&Y[a].hasOwnProperty("MetricNames")){if(Z.metricsDropZone){Z.secondaryMetricsDropZone=a;}else{Z.metricsDropZone=a;}}});},getAddDropZonesAction:function(){var c=this,Z=this.metricsDropZone,Y=this.secondaryMetricsDropZone,a={act:"updateTemplate",keyContext:this.data.k,actions:[]},b=function(d){a.actions.push({act:"addDropZoneUnit",zoneId:P[d],unitId:K,unitType:G});};[{p:"rowObjects",v:"Rows"},{p:"columnObjects",v:"Columns"},{p:"xAxisObjects",v:"XAxis"},{p:"yAxisObjects",v:"YAxis"},{p:"breakByObjects",v:"BreakBy"},{p:"colorByObjects",v:"ColorBy"},{p:"sizeByObjects",v:"SizeBy"},{p:"angleObjects",v:"Angle"},{p:"sliceObjects",v:"SliceBy"},{p:"tooltipMetrics",v:"AdditionalMetrics"}].forEach(function(f){var d=c[f.p],g=P[f.v];d.forEach(function(h){if(h){a.actions.push({act:"addDropZoneUnit",zoneId:g,unitId:h.did,unitType:h.t,ax:h.ax||F});}});if(Z===f.v){var e=function(h){return(h&&(h.length>M)&&c.isMetricZone(h));};if(e(c.xAxisObjects)||e(c.yAxisObjects)||e(c.angleObjects)){b(Z);}}});if(Y==="ColorBy"){b(Y);}return a;}});I=mstrmojo.vi.viz.GraphMatrixHelper;I.PROP_ROWS="Rows";I.PROP_COLUMNS="Columns";I.PROP_HORIZONTAL_AXIS="HorizontalAxis";I.PROP_VERTICAL_AXIS="VerticalAxis";I.PROP_XAXIS="XAxis";I.PROP_YAXIS="YAxis";I.PROP_SLICE="SliceBy";I.PROP_ANGLE="AngleBy";I.PROP_BREAKBY="BreakBy";I.PROP_COLORBY="ColorBy";I.PROP_SIZEBY="SizeBy";I.PROP_TOOLTIPMETRICS="AdditionalMetrics";I.PROP_SHAPE="Shape";I.PROP_SUBTYPE="Subtype";I.PROP_METRICSHAPES="metricShapes";I.PROP_SHAPE_AREA="Area";I.PROP_SHAPE_LINE="Line";I.PROP_SHAPE_BAR="Bar";I.PROP_SHAPE_CIRCLE="Circle";I.PROP_SHAPE_SQUARE="Square";I.PROP_SHAPE_PIE="Pie";I.PROP_SHAPE_RING="Ring";I.PROP_SHAPE_TICK="Tick";I.PROP_SUBTYPE_CLUSTERED="Clustered";I.PROP_SUBTYPE_AUTOMATIC="Automatic";I.PROP_SUBTYPE_STACKED="Stacked";I.PROP_SUBTYPE_ABSOLUTE="Absolute";I.PROP_SUBTYPE_PERCENT="Percent";}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.taphold","mstrmojo.VisUtility","mstrmojo.CustomVisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.FormatControlHelper","mstrmojo.customviz.GraphicModel","mstrmojo.customviz.CustomVisEnums");mstrmojo.CUSTOM_CONTEXT_MENU={NORMAL:"normal",TOGGLE:"toggle",SUBMENU:"submenu",SEPARATOR:"seperator",SINGLE_SELECT_LIST:"single_select_list",MULTI_SELECT_LIST:"multiple_select_list",FORMAT:"format"};mstrmojo.DEFAULT_CONTEXT_MENU={KEEP_ONLY:"KEEP_ONLY",EXCLUDE:"EXCLUDE",DRILL:"DRILL",GROUP:"GROUP",CALCULATION:"CALCULATION",SHOW_DATA:"SHOW_DATA",GO_TO_TARGETS:"GO_TO_TARGETS",SHOW_LEGEND:"SHOW_LEGEND",CHANGE_VISUALIZATION:"Change_VIZ"};var N=mstrmojo.dom,i=mstrmojo.array,O=mstrmojo.hash,C=mstrmojo.css,m=mstrmojo.CustomVisUtility,AA=mstrmojo.CUSTOM_CONTEXT_MENU,u=mstrmojo.DEFAULT_CONTEXT_MENU,U=m.log,n=mstrmojo.FormatControlHelper,AD=n.FORMAT_CONTROL_TYPE,a=mstrmojo.VisUtility,b=mstrmojo.vi.enums.EnumFeatures,M=mstrmojo.customviz.CustomVisEnums,A=M.ENUM_LEGEND_PROPS,K=3,j="touchstart",o="mousedown",E=N.isIOSTouch,X=E?j:o,S,AB;function L(AG,AE){if(!AB||typeof AB.validate!=="function"){AB=new Ajv_d6({useDefaults:true});}var AF=AB.validate(AG,AE);if(!AF){U(AB.errorsText());}return AF;}function d(AF,AE){return AF&&AF[AE]&&AF[AE] instanceof Function;}function F(AE){return function(){AE(true);};}function s(AE){return function(){AE(false);};}function p(AG,AH,AE){var AF=AE.propertyName;if(AF){AE.currentValue=AG.getProperty(AF);AE.onClick=function(AI){AG.savePropertyAndUpdateWidget(AF,AI.toString(),AE.config,AE.showFormatPanel);};}AH.addToggleMenuItem(AE.name,AE.cls||"",F(AE.onClick),s(AE.onClick),AG.id,m.parseBoolean(AE.currentValue),AE.ctxt);}function q(AE){return i.map(AE,function(AF){return{text:AF.name,value:AF.value};});}function w(AH,AE,AF){var AG=AF.propertyName;if(AG){AF.currentValue=AH.getProperty(AG);AF.onClick=function(AI){AH.savePropertyAndUpdateWidget(AG,AI,AF.config,AF.showFormatPanel);};}AE.addRadioMenuGroup(AF.currentValue,AF.onClick,q(AF.items),AF.cls||"",AF.ctxt);}function J(AH,AE,AF){var AG=AF.propertyName,AI;if(AG&&AF.items){AI=AH.getProperty(AG)||{};i.forEach(AF.items,function(AL){var AK=AL.propertyName,AJ=O.clone(AI);if(AK){AL.currentValue=AI[AK];AL.onClick=function(AM){AJ[AK]=AM;AH.savePropertyAndUpdateWidget(AG,AJ,AF.config,AF.showFormatPanel);};}AE.addToggleMenuItem(AL.labelText,AF.cls||"",F(AL.onClick),s(AL.onClick),AH.id,m.parseBoolean(AL.currentValue),AL.ctxt);});}}function W(AF,AG,AE){if(AE.isDisabled){AG.addNonInteractiveMenuItem(AE.name,AE.cls||"",true);}else{AG.addMenuItem(AE.name,AE.cls||"",AE.onClick,AE.ctxt);}}function h(AG,AH,AE,AF){AE.onClick=function(){AG.openFormatEditor(AF,AE.formatConfig);if(AE.showFormatPanelName){AG.openFormatPanelByName(AE.showFormatPanelName);}};AH.addMenuItem(AE.name,AE.cls||"",AE.onClick,AE.ctxt);}function B(AE){return i.filter(AE,function(AF){var AG;switch(AF.type){case AA.NORMAL:AG=S.customConfig.validNormalSchema(AF);break;case AA.TOGGLE:AG=S.customConfig.validToggleSchema(AF);break;case AA.SEPARATOR:AG=true;break;case AA.SUBMENU:AG=S.customConfig.validSubMenuSchema(AF);break;case AA.SINGLE_SELECT_LIST:AG=S.customConfig.validSingleSelectListSchema(AF);break;case AA.MULTI_SELECT_LIST:AG=S.customConfig.validMultiSelectListSchema(AF);break;case AA.FORMAT:AG=S.customConfig.validFormatSchema(AF);break;default:AG=true;}return AG&&(AF.isShown!==false);});}function I(AF,AG,AE){var AH=new mstrmojo.ui.menus.MenuConfig();if(!S.customConfig.validCommonSchema(AG)){return ;}AG=B(AG);i.forEach(AG,function(AI){switch(AI.type){case AA.NORMAL:W(AF,AH,AI);break;case AA.TOGGLE:p(AF,AH,AI);break;case AA.SEPARATOR:AH.addSeparator();break;case AA.SUBMENU:if(AI.subMenuConfig){AI.getSubMenuConfig=function(){return I(AF,AI.subMenuConfig);};}AH.addPopupMenuItem(AI.name,AF.id,AI.getSubMenuConfig,AI.cls||"",AI.ctxt);break;case AA.SINGLE_SELECT_LIST:w(AF,AH,AI);break;case AA.MULTI_SELECT_LIST:J(AF,AH,AI);break;case AA.FORMAT:h(AF,AH,AI,AE);break;default:AH.addNonInteractiveMenuItem(AI.name,"",true);}});return AH;}function k(AG,AI,AF){var AE=[],AH;if(!S.formatControlConfig.validCommonSchema(AI)){return ;}AI=B(AI);i.forEach(AI,function(AK,AJ){AK.provideDefaultWidth=true;switch(AK.type){case AD.FILLGROUP:if(S.formatControlConfig.validFillGroupSchema(AK)){AH=n.getFillGroupControl(AG,AK);}break;case AD.LINEGROUP:if(S.formatControlConfig.validLineGroupSchema(AK)){AH=n.getLineGroupControl(AG,AK);}break;case AD.CHARACTERGROUP:if(S.formatControlConfig.validCharacterGroupSchema(AK)){O.copy({cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"397px",height:"22px"},AK);AH=n.getCharacterGroupControl(AG,AK);}break;case AD.COLORBYGROUP:if(S.formatControlConfig.validColorByGroupSchema(AK)){AH=n.getColorByFillGroupControl(AG,AK);}break;}if(AH){if(AJ>0&&AF){AH.cssClass=(AH.cssClass?AH.cssClass+" ":"")+"mstrmojo-ui-rowContainer";}AE.push(AH);}});return AE;}function G(AV,AW){var AX=this,AK=AW.updateActions,AO={act:"updateTemplate",keyContext:AX.k,actions:[]},AS=AO.actions,AN=[a.pick(AV,["did","t"])],AH=AW.drillFromUnit.id,AL=AW.drillFromUnit.n,AP=AX.zonesModel,AJ=AP.getCustomDropZones(),AR,AE,AT,AI,AG,AQ,AF;if(AK&&AK instanceof Array){for(AF=0;AF<AK.length;++AF){var AU=AK[AF];AR=parseInt(AU.dropZoneIndex);if(!isNaN(AR)&&AR>=0){AT=AP.getZoneModelByZoneId(AR+K);if(AT){var AM=AJ[AR].maxCapacity||Infinity;AE={id:AR+K};AI=AT.items||[];AQ=a.findInArray(AI,function(AY){return AY.did===AH;});if(!AU.keepParent){if(AQ!==-1){AG=AI[AQ];Array.prototype.push.apply(AS,AP.getRemoveDropZoneUnitActions(AE,AG));Array.prototype.push.apply(AS,AP.getAddDropZoneUnitsActions(AE,AN,AG.idx));}else{U('The attribute "'+AL+'" to replace does not exist in drop zone ['+AR+"].");}}else{if(AI.length<AM){AG=AI[AQ];Array.prototype.push.apply(AS,AP.getAddDropZoneUnitsActions(AE,AN,AG?AQ+1:0));}else{U("Can not append attribute to drop zone ["+AR+"].");}}}}else{U('The parameter "dropZoneIndex" is invalid in the item ['+AF+'] of the parameter "updateDropZoneActions".');}}}else{U('Parameter "updateDropZoneActions" does not exist or is invalid.');}return AO;}function z(AF,AE,AH){var AG={};AG[AF]=[{id:AE,n:AH}];return AG;}mstrmojo.customviz._HasCustomContextMenu=mstrmojo.provide("mstrmojo.customviz._HasCustomContextMenu",{_mixinName:"mstrmojo.customviz._HasCustomContextMenu",selectionSupportsVizFilter:function Q(AF){var AG=this.model,AE=true;if(!AG){return false;}i.forEach(AF,function(AH){i.forEach(AH,function(AI){if(!AG.supportsViewFilterActions(AI.tid)){AE=false;return false;}});});return AE;},getHost:function f(){return this;},canDrill:function R(AE){var AF={show:false,enable:false};if(!mstrApp.isInVFConfigMode&&mstrmojo.resolveFeature(b.WEB_DRILL_AND_LINK)){AF.show=true;if(a.getDrillCandidates(this,AE.tid).length>0){AF.enable=true;}else{U('The drill action can not be performed, may be the given parameter "drillFrom" is not right or there is no attribute left to drill');}}else{U("The drill action not supported, may be you do not have the privilege or you are editing a viz filter.");}return AF;},canDoGroupCalculation:function D(){var AE={show:false,enable:false};if(!mstrApp.isAppStatePresentation()&&!mstrApp.isInVFConfigMode){AE.show=true;AE.enable=true;}else{U("The group/calculation action not supported, may be you are in the presentation mode or editing a viz filter.");}return AE;},canShowData:function Z(){var AE={show:false,enable:false};if(!mstrApp.isDossier&&!this.excludeData){AE.show=true;AE.enable=true;}else{U("The show data action not supported, may be you are in the pause mode or not editing a dossier.");}return AE;},getSelectionGroupMenuConfig:function P(AM,AQ){var AN={},AL=AM.hasOwnProperty("group"),AO=AM.hasOwnProperty("calculation"),AI,AG,AK,AF=AQ[0].isAttributeSelector(),AE=true;i.forEach(AQ,function(AS){if((AF&&!AS.isAttributeSelector())||(!AF&&AS.isAttributeSelector())){AE=false;U("The group/calculation action cannot be performed, because the context menu selection has both headers and data points.");return false;}AG=AS.getGroupHeaders();if(AG.length===0){AE=false;U('The group/calculation action cannot be performed, please check the format of parameter "headers" you passed to "setGroupOptions()" of graphic model.');return false;}for(AI=0;AI<AG.length;++AI){AK=AG[AI];if(AK.headerObj&&!d(AK.headerObj,"getElementId")){AE=false;U('The group/calculation action cannot be performed, please check the format of parameter "headers" you passed to "setGroupOptions()" of graphic model.');return false;}}});if(!AE){return AN;}var AH=function(AS){return AS.getName();},AJ,AR=function(AU){var AS=[],AW,AV,AT={};i.forEach(AU,function(AX){AV=AX.getGroupHeaders();i.forEach(AV,function(AY){AW=AY.headerObj.getElementId();if(!AT.hasOwnProperty(AW)){AT[AW]=true;AS.push(AY.headerObj);}});});return AS;};if(AF){var AP=AQ[0].getGroupHeaders()[0];AJ=this.getCellForNode(AP.headerObj);AN=a.getGroupAndCalculationContextMenu(this,AJ,{skipSingleAttrCheck:true,selection:AR(AQ),fnCellName:AH,hideGroupMenu:AL,hideCalculationMenu:AO});}else{AN=a.getGroupAndCalculationContextMenuForDataPoints(this,{selection:AQ,fnCellName:AH,fnUnique:AR,fnMakeNode:function(AS){return AS;},hideGroupMenu:AL,hideCalculationMenu:AO});}if(Object.getOwnPropertyNames(AN).length===0){U("The group/calculation action can not be performed, please check the given headers.");}return AN;},getCustomDrillMenu:function(AE,AK,AG){var AJ=AE,AI=AJ.tid,AH=AJ.n,AF={id:AI,n:AH};return a.getDrillMenu.bind(a,this,AI,AK,{drillFromUnit:AF,updateActions:AG});},getMenuHandler:function c(AI){var AK=this,AH;switch(AI){case u.KEEP_ONLY:AH=function AG(){AK.updateAfterKeepOnly(true);};break;case u.EXCLUDE:AH=function AL(){AK.updateAfterKeepOnly(false);};break;case u.DRILL:AH=function AJ(AM){a.doDrill(AK,AM.ctxt.drillUnit,G,AM.ctxt);};break;case u.SHOW_DATA:AH=function AE(){AK.showData();};break;case u.GO_TO_TARGETS:AH=function(){AK.genGotoTargetMenuConfig().handler();};break;case u.SHOW_LEGEND:AH=function AF(){AK.saveObjectProperty(M.LEGEND_PROPERTY_SET,A.SHOW_LEGEND,true,undefined,true);};break;default:AH=mstrmojo.emptyFn;break;}return AH;},getCustomMenuConfig:function t(AE,AF){AE=i.ensureArray(AE);return I(this,AE,AF);},getCommonMenuConfig:function H(AR){var AV=this.getContextMenuSelExtraInfo(),AO={},AU,AW,AL={showLegend:this.getShowLegendMenuConfig(AR)},AE={changeViz:this.getChangeVizMenuConfig(AR)},AK;if(AV.length>0){var AI=new mstrmojo.ui.menus.MenuConfig(),AQ=new mstrmojo.ui.menus.MenuConfig(),AX=this.selectionSupportsVizFilter(this.getContextMenuSelections()),AG,AT,AN,AM,AZ,AS,AF=AV[0]&&AV[0].getDrillHeader(),AY=AV[0]&&AV[0].getUpdateDropZoneActions();AO={filter:AI,showData:AQ};this.modelData=this.model.data;AN=i.find(AR,"type",u.GO_TO_TARGETS);if(AN!==-1){AT=AR[AN];AS=this.genGotoTargetMenuConfig();if(AX&&AS.menuText){AG=this.getMenuHandler(AT.type);AI.addMenuItem(AS.menuText,"",AG);AI.addSeparator();}}AN=i.find(AR,"type",u.KEEP_ONLY);if(AN!==-1){AT=AR[AN];if(AX){AG=this.getMenuHandler(AT.type);AI.addMenuItem(mstrmojo.desc(11701,"Keep only"),AT.cls||"",AG,AT.ctxt);}}AN=i.find(AR,"type",u.EXCLUDE);if(AN!==-1){AT=AR[AN];if(AX){AG=this.getMenuHandler(AT.type);AI.addMenuItem(mstrmojo.desc(3946,"Exclude"),AT.cls||"",AG,AT.ctxt);}}AN=i.find(AR,"type",u.DRILL);if(AN!==-1){AT=AR[AN];if(AX){AZ=this.canDrill(AF);if(AZ.show&&AZ.enable){var AJ;AJ=this.getCustomDrillMenu(AF,this.getMenuHandler(AT.type),AY);AI.addPopupMenuItem(mstrmojo.desc(145,"Drill"),AT.cls||"",AJ,AT.ctxt);}else{if(AZ.show&&!AZ.enable){AI.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),AT.cls||"",true);}}}}AN=i.find(AR,"type",u.SHOW_DATA);if(AN!==-1){AT=AR[AN];if(AX){AZ=this.canShowData();if(AZ.show&&AZ.enable){AG=this.getMenuHandler(AT.type);AQ.addMenuItem(mstrmojo.desc(13537,"Show Data..."),AT.cls||"",AG,AT.ctxt);}else{if(AZ.show&&!AZ.enable){AI.addNonInteractiveMenuItem(mstrmojo.desc(13537,"Show Data..."),AT.cls||"",true);}}}}AN=i.find(AR,"type",u.GROUP);AM=i.find(AR,"type",u.CALCULATION);if(AN!==-1||AM!==-1){AZ=this.canDoGroupCalculation();if(AZ.show&&AZ.enable){var AP={};AU=this.getSelectionGroupMenuConfig(AP,AV);}else{if(AZ.show&&!AZ.enable){AU={};}}}}AK=a.mergeHashes(AO,AU,AW,AL,AE);var AH=[{name:"filter"},{name:"editGroup"},{name:"editCalculation"},{name:"createDe"},{name:"showData"},{name:"renameDe"},{name:"showLegend"},{name:"changeViz"}];return a.mergeMenuConfigs(AK,AH);},getShowLegendMenuConfig:function(AI){var AG=new mstrmojo.ui.menus.MenuConfig(),AF,AJ,AE,AH;if(this.enableLegend){AF=i.find(AI,"type",u.SHOW_LEGEND);AJ=this.getLegendProperty(A.SHOW_LEGEND);if(AF!==-1&&!AJ){AE=AI[AF];AH=this.getMenuHandler(AE.type);AG.addMenuItem(mstrmojo.desc(12001,"Show Legend"),AE.cls||"",AH,AE.ctxt);}}return AG;},getChangeVizMenuConfig:function(AG){var AF=new mstrmojo.ui.menus.MenuConfig(),AE=i.find(AG,"type",u.CHANGE_VISUALIZATION);if(AE>-1&&AG[AE].isShown!==false){a.addChangeVizContextMenu(AF,this);}return AF;},getMobileMenuConfig:function Y(AG,AI){var AF,AH,AE={},AJ=AI&&AI.getDrillHeader(),AK=AI&&AI.getUpdateDropZoneActions();for(AF in u){AH=u[AF];if(i.find(AG,"type",AH)!==-1){if(AH===u.DRILL){AE[u.DRILL]={drillFrom:AJ,updateDropZoneActions:AK};}else{AE[AH]=true;}}}return AE;},getMousePositionFromEvent:function l(AE){if(AE.touches&&AE.touches.length>0){AE=AE.touches[0];}return N.getMousePosition(AE,window);},showContextMenu:function e(AE,AH,AL){var AF=this;if(mstrApp.isExpress||mstrApp.isInVFInteractMode){N.stopPropogation(window,AE);N.preventDefault(window,AE);return false;}if(AE.e){AE=AE.e;}var AN=this.getCommonMenuConfig(AH),AM=this.getCustomMenuConfig(AL,AE),AJ={common:AN,custom:AM},AK=[{name:"common"},{name:"custom"}],AI=a.mergeMenuConfigs(AJ,AK),AG;if(!AI.hasMenuItems()){AG=false;}else{AI.hostId=this.id;AI.isHostedWithin=false;AI.position=this.getMousePositionFromEvent(AE);AI.menuCssClass+=" mstrmojo-customvis-contextmenu";if(d(this.contextMenu,"destroy")){this.contextMenu.destroy();}AG=true;if(!mstrApp.isDisplayOnMobile){this.contextMenu=AI.newInstance();if(this.contextMenu){this.contextMenu.onCloseMenuCallBack=function(){AF.applySelection([],{forContextMenu:true});AF.updateHighlight();i.removeItem(AF.disposables,this);};}this.openPopup(this.contextMenu);}AE.stopPropagation();AE.preventDefault();}return AG;},addSelectionBySelectors:function x(AO,AH,AP){var AN=this,AK,AJ,AF=AO[0]&&AO[0].isSelectAttr,AM,AE=0,AL=0,AI=0,AG={x:0,y:0};for(AK=0;AK<AO.length;++AK){AJ=AO[AK];if(AF){AJ=z(AJ.tid,AJ.eid,AJ.n);}AM=AN.addSelectionBySingleSelector(AJ,AF,false,AH,AP);if(AP){AE+=AM.xTotal;AL+=AM.yTotal;AI+=AM.count;}}if(AI===0&&AO.length!==0){U('We did not get any graphic model by the selector given what may lead to the functionality of restore context menu not work, please check the function "getGraphicModelBySelector()" you have implemented.');}else{if(AP){AG.x=AE/AI;AG.y=AL/AI;}}return AG;},updateContextMenu:function AC(AH,AI){var AF=this,AG,AE={x:0,y:0};AG=AF.isHighlightedAsTarget;AF.isHighlightedAsTarget=false;AE=this.addSelectionBySelectors(AH,true,true);this.addSelectionBySelectors(AI,false);AF.isHighlightedAsTarget=AG;if(this.plotted){this.updateHighlight();}var AJ={messageType:"updatePosition",pos:AE};return a.sendToMobileDevice(AJ);},getContextMenuConfig:mstrmojo.emptyFn,openFormatEditor:function g(AH,AF){var AG=this.getHost(),AJ=this.formatPopupPlaceholder;var AE=k(AG,AF,true);var AI=new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolbarBorderAndFill",children:AE}]});if(!AJ){AJ=document.createElement("div");AJ.setAttribute("class","gm-menu-placeholder");this.formatPopupPlaceholder=AJ;}N.emptyNode(AJ);document.body.appendChild(AJ);AI.hostId=AG.id;AI.hostElement=AJ;if(AH.e){AH=AH.e;}AI.position=this.getMousePositionFromEvent(AH);AI.isHostedWithin=false;if(m.isLibrary()){AI.hostProxyCssClass="mojo-theme-light";AI.cssClass="mstrmojo-FormatPopupEditor";}if(!AI.cssClass){AI.cssClass="";}this.openPopup(AI.newInstance({onClose:function(){C.toggleClass(document.body,"hasToolbarPopup",false);}}));C.toggleClass(document.body,"hasToolbarPopup",true);},init:function y(AF){if(this._super){this._super(AF);}if(!window.Ajv_d6){var AE=window.Ajv;delete window.Ajv;mstrmojo.requiresDepLib(mstrmojo.getJsRoot()+"libraries/ajv.min.js");window.Ajv_d6=Ajv;window.Ajv=AE;}}});S=mstrmojo.customviz._HasCustomContextMenu.ValidationHelper={customConfig:{validCommonSchema:function(AE){var AF={type:"array",items:[{type:"object",properties:{type:{type:"string",minLength:1},isShown:{type:"boolean"}},required:["type"]}]};return L(AF,AE);},validNormalSchema:function(AE){var AG={type:"object",properties:{name:{type:"string",minLength:1},isDisabled:{type:"boolean"}},required:["name"]},AF=L(AG,AE);if(!AE.isDisabled&&(!AE.onClick||typeof AE.onClick!=="function")){AF=false;U("onClick function is required for "+AE.type+" context menu");}return AF;},validToggleSchema:function(AE){var AG={type:"object",properties:{name:{type:"string",minLength:1},currentValue:{type:"boolean"},propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true}},anyOf:[{required:["name","propertyName"]},{required:["name","currentValue","onClick"]}]},AF=L(AG,AE);if(!AE.propertyName&&typeof AE.onClick!=="function"){AF=false;U("onClick function is required for "+AE.type+" context menu when not bingding with property");}return AF;},validSingleSelectListSchema:function(AE){var AG={type:"object",properties:{currentValue:{type:"string",minLength:1},propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true},items:{type:"array",items:{type:"object",properties:{name:{type:"string",minLength:1},value:{type:"string",minLength:1}},required:["name","value"]},minItems:1,uniqueItems:true}},required:["items"],anyOf:[{required:["propertyName"]},{required:["currentValue","onClick"]}]},AF=L(AG,AE);if(!AE.propertyName&&typeof AE.onClick!=="function"){AF=false;U("onClick function is required for "+AE.type+" context menu when not bingding with property");}return AF;},validMultiSelectListSchema:function(AE){var AF={type:"object",properties:{propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true},items:{type:"array",items:{type:"object",properties:{labelText:{type:"string",minLength:1},propertyName:{type:"string",minLength:1}},required:["labelText","propertyName"]},uniqueItems:true,minItems:1}},required:["items","propertyName"]};return L(AF,AE);},validSubMenuSchema:function(AE){var AG={type:"object",properties:{name:{type:"string",minLength:1},subMenuConfig:{type:"array"}},required:["name"],anyOf:[{required:["subMenuConfig"]},{required:["getSubMenuConfig"]}]},AF=L(AG,AE);if(AE.getSubMenuConfig&&typeof AE.getSubMenuConfig!=="function"){AF=false;U("getSubMenuConfig must be a function for "+AE.type+" context menu");}return AF;},validFormatSchema:function(AE){var AF={type:"object",properties:{name:{type:"string",minLength:1,"default":mstrmojo.desc(1918,"Format")},isShown:{type:"boolean","default":!m.isLibrary()&&!m.isVIPresentationMode()},formatConfig:{type:"array"},showFormatPanelName:{type:"string",minLength:1}},required:["formatConfig"]};return L(AF,AE);}},formatControlConfig:{validCommonSchema:function(AE){var AF={type:"array",items:[{type:"object",properties:{type:{type:"string",minLength:1},isShown:{type:"boolean"},label:{type:"object",properties:{text:{type:"string"},width:{type:"string",minLength:1}},required:["text"]}},required:["type"]}]};return L(AF,AE);},validFillGroupSchema:function(AE){var AF={type:"object",properties:{propertyName:{type:"string",minLength:1},showFillColor:{type:"boolean"},showFillAlpha:{type:"boolean"},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AF,AE);},validLineGroupSchema:function(AE){var AF={type:"object",properties:{propertyName:{type:"string",minLength:1},hideColorControl:{type:"boolean"},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AF,AE);},validCharacterGroupSchema:function(AE){var AF={type:"object",properties:{propertyName:{type:"string",minLength:1},showFormatPanel:{type:"boolean","default":true}},required:["propertyName"]};return L(AF,AE);},validColorByGroupSchema:function(AE){var AF={type:"object",properties:{colorInfo:{type:"array",items:{type:"string",minLength:1},minItems:1},showFormatPanel:{type:"boolean","default":true}},required:["colorInfo"]};return L(AF,AE);}}};}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","num","css","Container","Box","Label","EditableLabel","Image");mstrmojo.requiresClsP("mstrmojo.threshold","ColorBand","ImageBand","MarkersNode","ColorMarker","ThresholdModel");var M=mstrmojo.dom,H=mstrmojo.num,B=mstrmojo.css,e=mstrmojo.array,O=mstrmojo.hash,L=mstrmojo.Widget,u=["bands","markers"];var A=0,x=1;var c=mstrmojo.threshold.ThresholdModel,Y=c.SLIDER_MODE,X=c.BASED_ON_TYPES,C=function(AA,z){return AA-z;},h=function(AA,z){return z-AA;},F=5;function Q(z){var AA;if(z===u[A]){AA=this.sliderMode===Y.IMAGE_BASED?new mstrmojo.threshold.ImageBand():new mstrmojo.threshold.ColorBand();}else{AA=new mstrmojo.threshold.ColorMarker();}this[z].addChildren([AA]);}function j(AE,AG,AH,AC){var AA=AE.length-1,AF=AC?0:1,AB=AC?AA-1:AA-2;for(var AD=AF;AD<=AB;AD++){if(AD===AF&&AE[AD]<=0){AE[AD]=AG;}else{var z=AE[AD]-AE[AD-1];AE[AD]+=(z<AG)?(AG-z):0;AE[AD]=AE[AD]>=AH?(AH-AG):AE[AD];}}for(var AD=AB;AD>AF;AD--){if(AD===AB&&AE[AB]>=AH){AE[AD]=AH-AG;}else{var z=Math.abs(AE[AD+1]-AE[AD]);AE[AD]-=(z<AG)?(AG-z):0;}}AE.sort(C);}function U(AC){var AD=this[u[AC]],AE=AD.children,AA=AE?AE.length:0,AN=this.getComp().sort(C),AM=this.getPalette(),AB=this.width,AP=AC?AN.length-1:AN.length,z=this.sliderMode===Y.IMAGE_BASED,AQ=this.parent.model.globalMinMax(this.minValue(),this.maxValue()),AL,AF,AI;var AK=e.map(AN,function(AR){return parseInt(AB*AR,10);});j(AK,F,AB,this.selectedOption===X.VALUE);if(AA>AP){for(AL=AA-AP-1;AL>=0;AL--){AD.removeChildren(AE[AL]);}}else{if(AP>AA){for(AL=0;AL<AP-AA;AL++){Q.call(this,u[AC]);}}}if(AC===0&&this.getReversedValue()){AM=AM.concat().reverse();}AE=AD.children;var AH,AG;for(AL=0;AL<AP;AL++){AF=AE[AL];AH=(AL===0)?0:AK[AL-1];AG=AK[AL];if(AC===0){AF.set("left",(this.containerNode.offsetLeft+AH+1)+"px");AI=AG-AH;B.toggleClass(AF.domNode,"no-border",!AI);AF.set("width",AI+"px");if(z){AF.set("src",AM[AL]);AF.domNode.firstChild.style.left=AF.domNode.clientWidth/2-12+"px";}else{AF.set("backgroundColor",AM[AL]);}}else{AF.set("left",AG-(z?0:1)+"px");AF.updateCompValue(AN[AL]);var AO=this.parent.model,AJ=AO.getRealValue(AN[AL],this.selectedOption,this.minValue(),this.maxValue());AF.updateRealValue(AJ);AF.updatePosition(AK[AL]);}AF.set("index",AL);}}function q(AA,z,AB){z.forEach(function(AD){var AC=AA[AD.id]={palette:[],comp:[],reversed:false};AD.bands.forEach(function(AE){AC.palette.push(AE[AB?"url":"bc"]);AC.comp.push(AE.end/100);});});}function D(){var z=this.parent.model,AA={};q(AA,z.getDefaultColors(),false);q(AA,z.getDefaultImages(),true);return AA;}function y(AB){var z=H.parseNumeric(AB);if(isNaN(z)&&window.numeral){var AA=window.numeral(AB.toLowerCase()).value();z=typeof AA==="number"?AA:z;}return z;}mstrmojo.threshold.TextBubble=mstrmojo.declare(mstrmojo.EditableLabel,null,{scriptClass:"mstrmojo.EditableLabel",visible:false,cssClass:"editable-bubble",text:"",isPercentage:true,maxValue:1,showBubble:function(z,AB,AA){this.updatePosition(z,AA);this.updateText(AB);this.set("visible",true);},hideBubble:function(){this.set("visible",false);},updatePosition:function W(AA,z){var AB=(z!==undefined)?z:this.parent.width*AA;this.domNode.style.left=AB+"px";},updateText:function(AC){var AB=this.parent,z=AB.parent.model,AA=AC;if(AB.selectedOption===X.VALUE){this.realValue=AA;AA=H.formatByMask(z.getFormatString(),AA);}if(this.isPercentage){AA+="%";}this.set("text",String(AA));}});mstrmojo.threshold.ColorSlider=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.threshold.ColorSlider",markupString:'<div class = "mstrmojo-color-slider {@cssClass}"  style="{@cssText}" mstrAttach:click,keyup><div class="labels"></div><input type="text" class="hidden-field"></div>',markupSlots:{containerNode:function Z(){return this.domNode;},labelsNode:function R(){return this.domNode.firstChild;},hiddenField:function g(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:L.visibleMarkupMethod},sliderMode:Y.COLOR_BASED,baseColor:undefined,editableBubble:undefined,hoverBubble:undefined,bands:undefined,markers:undefined,colorMap:undefined,selectedOption:undefined,userComp:[],getComp:function a(){return this.userComp;},getPalette:function N(){return this.colorMap[this.baseColor].palette;},getReversedValue:function o(){var z=this.colorMap;return z&&z[this.baseColor].reversed||false;},postBuildRendering:function S(){this.width=M.position(this.containerNode).w;this.resetColorMap();if(this._super){this._super();}this.update();},resetColorMap:function w(){var z=undefined;if(this.colorMap){z=this.colorMap.custom;}this.colorMap=D.call(this);if(z){this.colorMap.custom=z;}if(this.baseColor in this.colorMap){this.userComp=O.clone(this.colorMap[this.baseColor].comp);}},onkeyup:function(AC){var AA=window.event||AC.e,AD=AA.keyCode;if(this.sliderMode===Y.COLOR_BASED&&(AD===mstrmojo.Enum_Keys.DELETE||AD===mstrmojo.Enum_Keys.BACKSPACE)){if(this.editableBubble.isEditing){return ;}var AB,z;if(this.bands.isSelected){AB=this.bands;}else{if(this.markers.isSelected){AB=this.markers;}else{return ;}}z=AB.selectedIndex;AB.children[z].unselect();AB.remove(z);this.update();}},update:function f(){if(this.baseColor){U.call(this,A);U.call(this,x);}this.updateMinMax();},onsliderModeChange:function k(){B.toggleClass(this.domNode,"image-mode",this.sliderMode===Y.IMAGE_BASED);this.resetMinMax();this.unselectAll();this.bands.removeChildren();},onbaseColorChange:function p(z){if(z.value&&z.value in this.colorMap){this.userComp=O.clone(this.colorMap[z.value].comp);}this.resetMinMax();this.unselectAll();this.update();},onselectedOptionChange:function K(AA){var AB=this.parent.model,AC=this.editableBubble,AD=AA.valueWas===X.VALUE?AC.realValue:AC.text;if(AA.valueWas!==undefined){this.resetMinMax();this.markers.setMarkerRealValues(AB.getRealValue.bind(AB),AA.value,this.minValue(),this.maxValue());this.update();}if(AC.visible){if(AA.valueWas===X.LOWEST_PERCENT||AA.valueWas===X.HIGHEST_PERCENT){AD=AD.slice(0,AD.length-1);}var z=this.markers.selectedIndex;AC.updateText(this.markers.children[z].realValue);}},updateLabels:function G(AA){var AD=this.parent.model,AE=this.editableBubble,AC=this.hoverBubble,AF=this.markers.selectedIndex,AG,AB;AA=AA||this.selectedOption;if(AA===X.LOWEST_PERCENT||AA===X.HIGHEST_PERCENT){AG="0%";AB="100%";AE.set("isPercentage",true);AC.set("isPercentage",true);}else{if(AA===X.LOWEST||AA===X.HIGHEST){AG="0";AB=AD.getMetricsCount();AE.set("isPercentage",false);AC.set("isPercentage",false);}else{var z=AD.getFormatString();AG=(this.minValue()<AD.getMetricsMinValue())?"-&#8734":H.formatByMask(z,AD.getMetricsMinValue());AB=(this.maxValue()>AD.getMetricsMaxValue())?"&#8734":H.formatByMask(z,AD.getMetricsMaxValue());AE.set("isPercentage",false);AC.set("isPercentage",false);}}this.startLabel.set("text",AG);this.endLabel.set("text",AB);if(!!this.markers.children&&AF>-1&&AF<this.markers.children.length){AE.updateText(this.markers.children[AF].realValue);}},setColorComp:function i(AA,z){this.userComp=O.clone(z);var AB=this.colorMap;if(AB){AB[AA].comp=z;this.unselectAll();this.update();}},addCustomScheme:function(AA,z){this.colorMap.custom={comp:AA,palette:z,reversed:false};this.set("baseColor","custom");},addMarkerToMap:function P(AA){var AB=this.getComp(),z=AB.length,AC;if(AB[0]>AA){AC=0;}else{for(AC=1;AC<z;AC++){if(AB[AC-1]<=AA&&AB[AC]>=AA){break;}}}AB.splice(AC,0,AA);this.unselectAll();this.resetMinMax();return AC;},unselectAll:function t(){var AA=this.bands,AB=AA.children&&AA.selectedIndex>-1&&AA.children[AA.selectedIndex];if(AA.isSelected&&AB&&typeof (AB.unselect)==="function"){AB.unselect();}var AC=this.markers,z=AC.children&&AC.selectedIndex>-1&&AC.children[AC.selectedIndex];if(AC.isSelected&&z&&typeof (z.unselect)==="function"){z.unselect();}},reverseMapColor:function b(){if(this.colorMap&&this.baseColor){var z=this.colorMap[this.baseColor];z.reversed=!z.reversed;this.unselectAll();this.update();}},_minRealValue:undefined,_maxRealValue:undefined,resetMinMax:function J(){this.set("_minRealValue",undefined);this.set("_maxRealValue",undefined);},updateMinMax:function l(){var AD=this.markers.getMarkerRealValues(C),AC=this.parent.model.globalMinMax(),AB=AC.min,z=AC.max,AA=-1;if(e.isArray(AD)){while(++AA<AD.length){if(AD[AA]!==undefined){AB=AD[AA];break;}}AA=AD.length;while(--AA>=0){if(AD[AA]!==undefined){z=AD[AA];break;}}}this.set("_minRealValue",AB);this.set("_maxRealValue",z);this.updateLabels(this.selectedOption);},minValue:function E(){return this._minRealValue;},maxValue:function I(){return this._maxRealValue;},children:[{scriptClass:"mstrmojo.Label",cssClass:"start-label",alias:"startLabel",slot:"labelsNode",text:"0%",allowHTML:true},{scriptClass:"mstrmojo.Label",cssClass:"end-label",alias:"endLabel",slot:"labelsNode",text:"100%",allowHTML:true},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"editableBubble",slot:"labelsNode",allowEmptyText:true,onTextEditComplete:function(AG,AH){if(AG){var AL=this.parent,AE=AL.parent.model,AD=AL.markers.selectedIndex,AR=AL.markers.children[AD];var AI=this.text;if(this.isPercentage){AI=AI.replace(/%$/,"");}var AN=AI.charAt(0),AS=1;if(AN==="-"||AN==="+"){AI=AI.substring(1);AS=(AN==="-")?-1:1;AN=AI.charAt(0);}if(AN.match(/\W/)!==null){AI=AI.replace(new RegExp("^\\"+AN),"");}var AJ=AE.getFormatString(),AO=(AJ||"").indexOf("%")>-1,AC=1,AF=AL.selectedOption===X.VALUE;if(AF&&AO&&AI.indexOf("%")===-1){AC=0.01;}AI=y(AI)*AC;if(isNaN(AI)){this.set("text",AH);return ;}AI=AI*AS;if(AI<0&&!AF){AI=0;}AR.updateRealValue(AI);AL.updateMinMax();var AM=AL.markers.getMarkerRealValues(C);AD=AM.indexOf(AI);var AP=AM.map(function(AT){return AE.getNormalizedValue(AT,AL.selectedOption,AL.minValue(),AL.maxValue());}),AQ=AL.getComp(),AB=AP[AD],AA=AL.width,z=(AL.sliderMode===Y.IMAGE_BASED),AK=parseInt(AA*AB,10);AP.forEach(function(AU,AT){AQ[AT]=AU;AL.markers.children[AT].updateCompValue(AU);});this.updatePosition(AB);AR.updateCompValue(AB);AR.set("left",AK-(z?0:1)+"px");AR.unselect();AL.update();AL.markers.children[AD].select();}}},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"hoverBubble",slot:"labelsNode",allowEmptyText:false},{scriptClass:"mstrmojo.Box",cssClass:"color-bands",alias:"bands",isSelected:false,selectedIndex:0,remove:function d(AB){if(this.children.length===1){return ;}var AC=this.parent;var AA=AC.getComp(),z=AC.getPalette();if(AB===this.children.length-1){AA.splice(AB-1,1);}else{AA.splice(AB,1);}z.splice(AB,1);},onBandHovered:function(){this.isSelected=true;},onBandUnhovered:function(){this.isSelected=false;},onBandSelected:function(z){var AA,AC=this.children,AB=this.parent,AD=AB.markers;for(AA=0;AA<AC.length;AA++){if(AA!==z&&AC[AA].selected){AC[AA].unselect();}}if(AD.isSelected===true){AD.children[AD.selectedIndex].unselect();}AB.hiddenField.focus();this.isSelected=true;this.selectedIndex=z;},onBandUnselected:function(z){var AA,AB=this.children;for(AA=0;AA<AB.length;AA++){if(AA!==z&&AB[AA].selected){return ;}}this.isSelected=false;this.selectedIndex=-1;}},{scriptClass:"mstrmojo.threshold.MarkersNode",alias:"markers",isSelected:false,selectedIndex:-1,isHovered:false,hoveredIndex:-1,onMarkerSelected:function s(AA){var z=this.parent,AE=this.children[AA];z.editableBubble.showBubble(AE.compValue,AE.realValue,AE.position);var AB,AD=this.children;for(AB=0;AB<AD.length;AB++){if(AB!==AA&&AD[AB].selected){AD[AB].unselect();}}var AC=z.bands;if(AC.isSelected===true){AC.children[AC.selectedIndex].unselect();}this.parent.hiddenField.focus();this.isSelected=true;this.selectedIndex=AA;},onMarkerUnselected:function(z){var AA,AB=this.children;for(AA=0;AA<AB.length;AA++){if(AA!==z&&AB[AA].selected){return ;}}this.parent.editableBubble.hideBubble();this.isSelected=false;this.selectedIndex=-1;},onMarkerHovered:function n(AA){var z=this.parent,AB=this.children[AA];z.hoverBubble.showBubble(AB.compValue,AB.realValue,AB.position);this.isHovered=true;this.hoveredIndex=AA;},onMarkerUnhovered:function m(z){var AA,AB=this.children;for(AA=0;AA<AB.length;AA++){if(AA!==z&&AB[AA].hovered){return ;}}this.parent.hoverBubble.hideBubble();this.isHovered=false;this.hoveredIndex=-1;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.Container","mstrmojo.threshold.TextGroup","mstrmojo.threshold.ThresholdRow","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.CharacterGroup");var G=mstrmojo.Widget,F=mstrmojo.hash,D="175px";mstrmojo.threshold.PropertyPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo.threshold.PropertyPanel],{markupString:'<div class="mstrmojo-threshold-PropertyPanel"><div class="condition"></div><div class="format mstrmojo-vi-PropEditor"><div class="text"><div class="title">'+mstrmojo.desc(5998,"Replace Data")+'</div></div><div class="font mstrmojo-vi-EditorGroup"><div class="title">'+mstrmojo.desc(3433,"Font")+'</div></div><div class="border"><div class="title">'+mstrmojo.desc(5616,"Color And Borders")+'</div></div></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1].firstChild;},fontNode:function(){return this.domNode.children[1].children[1];},borderNode:function(){return this.domNode.children[1].children[2];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod},model:undefined,editor:undefined,textGroup:undefined,charGroup:undefined,containerGroup:undefined,onvisibleChange:function A(){if(this.visible){var J=this.model;J.updateControl(this);var H=F.clone(J.threshold),I=this.thresholdRow;if(I){this.removeChildren(I);}this.addChildren({scriptClass:"mstrmojo.threshold.ThresholdRow",alias:"thresholdRow",slot:"conditionNode",idx:J.thresholdRow.idx,model:this.editor.model,threshold:H,onclick:mstrmojo.emptyFn});this.refresh();}},onOK:function B(){this.model.submitChange();this.close();},close:function E(){var H=this.thresholdRow;if(H){this.removeChildren(H);}this.set("visible",false);this.editor.toggleButtonStatus(true);this.editor.setRowPanelVisibility(true);},children:[{scriptClass:"mstrmojo.threshold.TextGroup",slot:"textNode",alias:"textGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("threshold",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",slot:"fontNode",alias:"charGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",slot:"borderNode",alias:"containerGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"btnContainer",slot:"applyNode",width:"740px",height:"32px",col1Width:"50%",col2Width:"50%",children:[{scriptClass:"mstrmojo.Label",alias:"tip",slot:"col1Node",cssClass:"tip",text:mstrmojo.desc(14000,"Press ## after finishing formatting.").replace("##",'""')},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"btnContainer",slot:"col2Node",cssClass:"btnContainer",col1Width:"40px",col2Width:"40px",children:[{scriptClass:"mstrmojo.Button",alias:"cancelBtn",slot:"col1Node",cssClass:"cancelBtn",onclick:function(){var H=this.parent.parent.parent;if(H.close){H.close();}}},{scriptClass:"mstrmojo.Button",alias:"okBtn",slot:"col2Node",cssClass:"okBtn",onclick:function(){var H=this.parent.parent.parent;if(H.onOK){H.onOK();}}}]}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.PanelFormatSaver");mstrmojo.vi.ui._IsViPanel=mstrmojo.provide("mstrmojo.vi.ui._IsViPanel",{_mixinName:"mstrmojo.vi.ui._IsViPanel",getPanelSaver:function A(){return null;},setOpenStatus:function D(F,E,I,H){if(this.visible!==F){this.set("visible",F);if(!H){this.resetLayout(H);}if(!E){var G=this.getPanelSaver();if(G){G.saveProperty("visible",F);}}mstrApp.rootCtrl.generateToolbar();}},getOpenStatus:function C(){return !!this.visible;},resetLayout:function B(){this.height=this.width="1px";this.parent.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.array","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Label","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.editors.MoreOptionsEditor","mstrmojo.models.template.DataInterface");var I=mstrmojo.array,O=mstrmojo.hash,K=mstrmojo.EnumRWUnitType,L=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,W="mstrmojo-more-options-editor",G="mstrmojo-more-options-editor-visfilter",J=mstrmojo.models.template.DataInterface;mstrmojo.vi.models.editors.EditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.ControlsViewFactory,null,{scriptClass:"mstrmojo.vi.models.editors.EditorModel",hostId:"",help:"",getHost:function C(){return mstrmojo.all[this.hostId];},docModel:null,getEditorContents:mstrmojo.emptyFn,getGroupTitle:function E(Y){return new mstrmojo.Label({cssClass:"edt-title",text:Y});},getShowTitleCheckbox:function P(){var Y=this.getHost();return this.getCheckboxAndLabel(Y.parent.getTitleBarVisibility(),mstrmojo.desc(13599,"Show titlebar"),function(Z){Y.parent.toggleTitleBar(!!Z);});},getTextAlign:function H(a,b,Z){var Y=new mstrmojo.vi.ui.TextAlignButtonBar(!Z?null:{itemsValueMap:Z});Y.singleSelect(I.find(Y.items,"id",a));Y.onValueChange=b;return Y;},getWrapText:function U(Z,Y){return this.getCheckboxAndLabel(Z,mstrmojo.desc(13577,"Wrap text"),Y);},getChangeFormatPropertyFn:function A(Y,Z){var a=this.id;return function(d,b){var c=mstrmojo.all[a];c.docModel.changeUnitFormatProperty(c.getHost().parent,[{formatType:Z||1,propertyName:Y,newValue:d,oldValue:b}]);};},getChangeGroupLayoutFn:function N(){var Y=this.docModel;return function(Z,c,a){var b=["left","top","width","height"].indexOf(Z)>-1,d={};if(b){d[Z]=c;Y.changeUnitBoxLayout(d);}};},getChangeGroupPropertyFn:function X(Y){var Z=this.id;return function(a,c,b){(mstrmojo.all[Z].getChangeFormatPropertyFn(a,Y))(c,b);};},getCharacterGroup:function B(b,Y,Z){var c={onGroupValueChange:b};if(Z){c.visibleControls=Z;}var a=new mstrmojo.ui.editors.controls.CharacterGroup(c);a.setFormatSource(Y);return a;},isContainerPositionSizeEnabled:function D(){var b=this.getHost(),a,Y=false,Z=this.docModel,c=O.walk("defn.t",b)===K.PANEL,d=function(e){return O.walk("parent.defn.ifp",e);};if(!c&&Z){a=Z.getOwningPanel(b);if(a&&!d(a)){Y=a.isManualMode();}}return Y;},getContainerGroup:function S(Y,c,Z,b){var a=this.docModel,e=this.isContainerPositionSizeEnabled(),d=L.FILL_COLOR+L.BORDER+(e?L.SIZE_POSITION:0),f=new mstrmojo.ui.editors.controls.ContainerGroup(O.copy(b,{onGroupValueChange:c||this.getChangeGroupPropertyFn(),onGroupLayoutChange:this.getChangeGroupLayoutFn(),visibleControls:Z||d}));f.setFormatSource(Y);if(e){a.attachEventListener("setPositionAndSize",this.id,function(g){f.setPositionAndSize(g);});}a.raiseSetPositionSizeEvent();return f;},getMoreOptionsEditorLink:function Q(a,Z,b,Y){return new mstrmojo.Label({text:mstrmojo.desc(9126,"More options"),cssClass:"edt-link",onclick:function(){this.openMoreOptionsEditor(a,Z,b,Y);}.bind(this)});},openMoreOptionsEditor:function R(d,Z,e,Y){var c=this.getHost(),b;var a=function(o,k,m,h){var n=this.host,f=n.controller,l=f.dataService(),i=[],j=n.model,g=n.k;if(!O.isEmpty(o)){m=mstrmojo.func.wrapMethods(f._getXtabCallback(n),m);J.forEachGSI(n.gridInfo,function(q,p){i=i.concat([l.getUpdateTemplateAction(p,[j.getAdvancedPropertiesAction(o)],null,g)]);},g);}i=i.concat(k||[]);if(!O.isEmpty(i)){f.submitUndoRedoUpdates(i,null,m,h);}};if(mstrApp.isInVFConfigMode){b=mstrmojo.all[G]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:G,submitAction:a});}else{b=mstrmojo.all[W]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:W,submitAction:a});}b.set("data",d);b.set("showHeadersSection",!!Z);b.set("showSelectionLimitSection",!!c.GMController);b.set("showIncrementalFetchSection",!!Y);b.set("lockHeadersCase",e);b.set("host",c);b.open();return b;},replaceChildControls:function M(a,Z){var Y=[].concat(a.children||[]);a.removeChildren();Y.forEach(function(b){b.destroy();});a.addChildren(Z);a.doLayout();},getHelpUrl:function F(){return this.help;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.vi.controllers.UICmd");var H=mstrmojo.hash.copy,X=mstrmojo.array.forEach,F=mstrmojo.vi.controllers.UICmd;var P=2,E=1,O=F.CMD_ACT_TYPE.UNDO,G=F.CMD_ACT_TYPE.EXEC,A=F.CMD_ACT_TYPE.REDO;var Y=F.CMD_PHASE;var W=F.CMD_STATE;function U(){X(this._delayRemovedCmds,function(g){g.discard();});this._delayRemovedCmds=null;}function L(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function N(h){var g=this.cmds,i=this.pos;this._delayRemovedCmds=g.splice(i+1);if(i>=this.size-1){g.shift().discard();}g.push(h);this.pos=g.length-1;}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:E,CMD_PHASE:Y,init:function Z(g){H(g,this);this.cmds=[];},execute:function J(i){if(this.state===P){this.handleError();}try{i=H(i,{mgr:this,undoUIState:this.model.getUIState(),action:G});var g=this.curCmd=new F(i);N.call(this,g);this.state=P;g.execute();}catch(h){this.reset();throw h;}},getInterimCmd:function S(){if(this.state===P){var g=this.cmds[this.pos];if(g&&g.state===W.INTERIM){return g;}}return null;},combineMultipleCMDs:function D(n,m,o){var l=this.cmds.length,j=m-n;if(j<=0||n<0||m>=l){return false;}var h=this.cmds[n],g=this.cmds[m];g.undoStateId=h.undoStateId;g.undoUIState=h.undoUIState;var k;for(k=n;k<m;k++){this.cmds[k].discard();}this.cmds.splice(n,j);if(this.pos>=m){this.pos-=j;}this.controller.onCmdMgrChanged();if(o){H(o,this.cmds[n]);}},undo:function e(i){if(this.canUndo()){this.state=P;try{var g=this.curCmd=this.cmds[this.pos--];g.action=O;if(!g.skipUIState){this.model.setVizContentComponentByUIState(g.undoUIState);}g.redoUIState=this.model.getUIState();g.undoRedo(i);}catch(h){this.reset();throw h;}}},redo:function Q(){if(this.canRedo()){this.state=P;try{var g=this.curCmd=this.cmds[++this.pos];g.action=A;if(!g.skipUIState){this.model.setVizContentComponentByUIState(g.redoUIState);}g.undoUIState=this.model.getUIState();g.undoRedo();}catch(h){this.reset();throw h;}}},clearDelayRemovedCmds:function B(){U.call(this);},onSuccess:function I(g){if(this.state===E){this.handleError();}if(g!==this.curCmd){this.handleError("Wrong command");}this.state=E;U.call(this);this.controller.onCmdMgrChanged();},onFailure:function b(){U.call(this);this.reset();},onCancel:function M(h,i){this.state=E;var g=!!h.submitCount;if(g){this.undo(i);}else{this.pos--;}this.cmds.pop();h.discard();if(g){U.call(this);}else{L.call(this);}this.controller.onCmdMgrChanged();},untrackLastCmd:function d(){var g=this.cmds.pop();g.discard();this.pos--;this.controller.onCmdMgrChanged();},reset:function d(){X(this.cmds,function(g){g.discard();});this.cmds.length=0;this.pos=-1;this.state=E;this.controller.onCmdMgrChanged();},resetState:function a(){this.state=E;},canUndo:function f(){return this.state===E&&this.pos>=0;},canRedo:function R(){return this.state===E&&this.pos<this.cmds.length-1;},onSubmitUpdates:function c(){if(this.state===E){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var g=this.curCmd||{};return(this.state===P&&(g.action===O||g.action===A));},handleError:function K(g){this.reset();throw new Error(g||"Invalid state.");}});mstrmojo.vi.controllers.UICmdMgr.STATES={BUSY:P,IDLE:E};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo.locales","mstrmojo.models.template.DataInterface","mstrmojo.DocDataService","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo._HasContentProvider");var I=mstrmojo.array,Q=mstrmojo.models.template.DataInterface,J=Q.ENUM_GRID_RESIZE,M=J.FIXED,B=J.FIT_TO_WINDOW,R=J.FIT_TO_CONTENTS,U=mstrmojo.mstr.EnumDSSXMLObjectTypes,K=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,G="px";function Y(Z){return Z&&Z.otp===U.Consolidation&&Z.ost===K.ConsolidationManaged;}mstrmojo.SharedXtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasContentProvider],{scriptClass:"mstrmojo.SharedXtabBase",isRTL:false,rtlHTML:"",init:function N(Z){if(this._super){this._super(Z);}if(mstrmojo.locales.isRTL(mstrApp&&mstrApp.whLocaleId)){this.isRTL=true;this.rtlHTML="dir='rtl'";}},getCellUnitIndex:function D(Z){if(Z.lo!==undefined){return Z.lo;}else{if(Z.o!==undefined){return Z.o;}}return Z._ei;},getTargetZone:function L(){return this.zone;},sort:function W(a,b,c,Z){this.controller.onSort(this,this.model.getSortAction(a,b,c,Z));},advSort:function S(Z,a,b){this.controller.onGetAdvSortData(this,a,Z._e&&Z._e.otp,b);},clearSort:function P(Z,a){this.controller.onClearSort(this,a);},hasHiddenSubtotal:function O(){var a=this.gridData.gsi,Z=a&&a.hidesb;return !!Z;},setAllXtabWidths:function X(c){var b=this.gridData.twm||{},Z=b.top,a=b.bottom,d=c?(c+G):c;(a||[]).forEach(function(e,f){Z[f]=Z[f]||{};Z[f].w=e.w=d;});},updateScenario:function F(b,Z){var a=this.gridData;a.afc=b===R;a.afw=b===B;if(b!==M){this.setAllXtabWidths("");}if(Z){Z();}else{this.refresh();}},updateRelatedColWidths:function E(a){if(this.isCustomSort&&this.getActionMgr().isCurrentActionSilent()){return ;}var f=(new mstrmojo.models.template.DataInterface(this.gridData)).getColumnHeaderData(true),d=this.gridData.twm||{},c=d.bottom,Z=d.top,b=this.getTargetZone(),e;(a||[]).forEach(function(i){var h=i.colIndex,j=f[h],g=j._ridx||[];e=i.value;if(Z&&c){if(g.length>1){g.forEach(function(k){Z[k]=Z[k]||{};Z[k].w=c[k].w=e;});}else{Z[h]=Z[h]||{};Z[h].w=c[h].w=e;}}if(b){b.autoFitWindow=false;b.autoFitContent=false;}});this.refresh();},changeRowScenario:function C(Z,b,a){Z=Z||0;b=b||M;a=!!a;var c=this,d=[];Q.forEachGSI(c.gridData.gsi,function(e,f){d=d.concat(c.model.getDataService().getUpdateTemplateAction(f,{act:"changeXtabRowHeightScenario",value:b,height:Z},null,c.k));},c.k);if(!a){c.submitUndoRedoActionsWithCallback(d);}},changeRowHeight:function H(Z){this.changeRowScenario(Z);},getBasicSubtotalEditorConfig:function A(b,c){var Z=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.express.ui.SubtotalsWidget({onchange:function a(){var d=this.getSubtotalTypes(),e=d[0].length>0||d[1].length>0;Z.set("okEnabled",e);}}),data:{},okEnabled:false});if(!this.hasHiddenSubtotal(c)){Z.contents.set("selectedItems",b||[]);}return Z;},getNdeInfosOfGrid:function(){var Z=[];var c=this;var b=this.model,a=this.interactiveCellsArray;I.forEach(a,function(k){if(k.isObjHeader){var i=k,f=i.otp,e=i.ost,j=c.getDEInfo(i),h=j&&j.deObject,l={did:i.id||(h&&h.did),t:f||(h&&h.t),st:e||(h&&h.st),attId:h&&h.attId,ndetype:h&&h.ndetype},g=l.attId&&Y(i)&&b.getNDEFormsFromDataset(l.attId),d={n:i.n,did:i.id,t:l.t,st:l.st,ndeForms:g};Z.push(d);}});return Z;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Box","mstrmojo.Editor","mstrmojo.StackContainer","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.LinkGroup","mstrmojo.TextBox","mstrmojo.array","mstrmojo.hash","mstrmojo.XMLBuilder","mstrmojo.ui.Checkbox","mstrmojo.vi.enums.EnumFeatures","mstrmojo.ui.editors.controls.PromptAndAnswerList","mstrmojo.vi.enums.EnumPromptType","mstrmojo.EnumRWUnitType","mstrmojo.DocSelector","mstrmojo.vi.models.VIComponentMap");var P=mstrmojo.array,S=mstrmojo.hash,d=mstrmojo.DocSelector,C=mstrmojo.EnumRWUnitType,Q=mstrmojo.vi.models.VIComponentMap.TYPES,E=d.STYLES,c=mstrmojo.ui.editors.controls.PromptAndAnswerList,G=mstrmojo.vi.enums.EnumPromptType,W=mstrmojo.ui.editors.controls.LinkGroup.getFileBrowser,B=mstrmojo.ui.editors.controls.LinkGroup.getCtrlBtns,M=mstrmojo.ui.editors.controls.LinkGroup.getPageSelector,e=mstrmojo.ui.editors.controls.LinkGroup.genDLXML,F=mstrmojo.ui.editors.controls.LinkGroup.getInfoOfDossier;var D={THIS_DOSSIER:0,ANOTHER_DOSSIER:1};var I=2;var R=[{n:mstrmojo.desc(16999,"Select a page in the dossier"),idx:0}];var J=function(g){return mstrmojo.desc(16991,"Go to Dossier: #").replace("#",g||"...");};var O=function(g){return g.dtxt?g.dtxt:J(g.tnm);};var b=function(h,g){var i=P.filterOne(g,function(j){return j.navPage===h;})||{};return i.idx;};var L=function(i,h){var j={},g=S.clone(h)||[];P.forEach(i,function(k){j[k.id]=k;});return g.map(function(k){return S.copy(j[k.id],k);});};var Z=function(j,h){var i=function(l){return(l||[]).map(function(m){return{id:m.id,am:m.am};});};var k=S.clone(j);var g=S.clone(h);k.prms=i(k.prms);g.prms=i(g.prms);return S.equals(k,g);};var K=function(i,g){var j={},h;P.forEach(i,function(k){var l=k.d;P.forEach(l,function(m){if(m.id===g){var n=m.v;P.forEach(m.elems,function(p,o){if(!j[p]){j[p]={ei:p,emt:1,disp_n:n[o]};}});return false;}});});j=S.valarray(j);if(j.length>0){h={es:j};}return h;};function A(g){return g&&(g.sections||g.subsections||g.objects||g.panels);}function U(i,g,j){var h=i&&j&&i[j.k],k;if(h&&h.t===C.SELECTOR&&h.srcid===g){return{data:j,defn:h};}P.forEach(A(j),function(l){k=U(i,g,l);if(k){return false;}});return k;}var Y=function(g){var h=P.ensureArray(g.ces);if(h.length===1&&h[0].t===14){return{promptUser:false};}if(h.length>1000){return{promptUser:true};}h=h.map(function(i){return{ei:i.v,emt:i.t!==undefined?i.t:1,disp_n:i.n};});return{promptUser:false,answer:{es:h}};};var f=function(n,k){if(!n){return{promptUser:true};}var g=n.getCurrentLayoutKey(),i=S.walk("data.layouts",n),o=S.walk("defn.layouts",n),j=P.filterOne(i,function(s){return s.k===g;}),m=P.filterOne(o,function(s){return s.k===g;}),q=m&&m.units,h=U(q,k,j),l=h&&h.data,p=h&&h.defn;if(l&&p){if(!p.include){return{promptUser:true};}if(p.style!==E.ATTR_QUAL){return Y(l);}}return{promptUser:true};};var X=function(h,g){if(!h){return{promptUser:true};}var i=h.getVIComponent(Q.FILTER_STACK),k=i&&i.getFilterBySrcId(g),l=k&&k.defn,j;if(l&&l.style===E.ATTR_QUAL){j=k.buildPromptAnswerInfo();if(!S.isEmpty(j)){return{promptUser:false,answer:{exp:j}};}}return{promptUser:true};};var N=function(h,j){var g={};P.forEach(h,function(k){var l=k.d;P.forEach(l,function(m){g[m.id]=true;});if(Object.keys(g).length>1){return false;}});var i=Object.keys(g);return i.length===1&&j[i[0]];};var a=function(p,j,h){var n=new mstrmojo.ResSetLink({mid:p&&p.mid,srct:j.ttp||55,aopam:j.aopam}),k=j.prms,i=!!h,l=false,g={},m,o;if(k&&k.length>0){n.prms=[];m=n.prms;}P.forEach(k,function(s){var q={};S.copyProps(["id","nm","am","pt","orid","ortp"],s,q);switch(s.am){case n.DYNAMIC:if(s.pt===G.ATTRIBUTE_LELMENT_LSIT&&s.orid){o=K(h,s.orid);if(o){q.pa=o;l=true;g[s.orid]=true;}}break;case n.USE_FILTER_PANEL_SELECTIONS:if(s.pt===G.ATTRIBUTE_LELMENT_LSIT&&s.orid){q.am=n.DYNAMIC;o=f(p,s.orid);if(o.promptUser){q.am=n.DO_NOT_ANSWER;}else{if(o.answer){q.pa=o.answer;}}}else{if(s.pt===G.EXPRESSION&&s.orid){if(!mstrApp.isDossier){o=X(p,s.orid);if(o.promptUser){q.am=n.DO_NOT_ANSWER;}else{if(o.answer){q.pa=o.answer;}}}}else{q.am=n.DO_NOT_ANSWER;}}break;case n.DO_NOT_ANSWER:case n.CLOSE:case n.USE_DEFAULT_ANSWER:case n.SAME_PROMPT:default:break;}m.push(q);});if(l&&N(h,g)){i=false;}return{hyperLink:n,passSelection:i};};var H=function(i,g,k,h){var m=a(g,i,k),l=m.hyperLink,j=m.passSelection,n=i.linkTarget;i.so=2;if(!n){if(i.onw===undefined){n=(mstrApp&&mstrApp.isDossier)?"_self":"_blank";}else{n=i.onw===0?"_self":"_blank";}}return{linkInfo:i,isDossierLink:true,linkTarget:n,evt:3140,objectID:i.tid,srcMsgId:g&&g.mid,link:l,passFilter:i.psf,targetPageKey:i.navpage,vizSelection:JSON.stringify({sels:j?k:[],isBranch:!!h})};};mstrmojo.ui.editors.controls.ContextualLink=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ui.editors.controls.ContextualLink",cssClass:"link-editor contextual-link-editor mojo-theme-light",showTitle:true,title:mstrmojo.desc(17513,"Contextual Link"),autoClose:true,top:"100px",zIndex:8,onSelectThisDossier:mstrmojo.emptyFn,onLinkUpdated:mstrmojo.emptyFn,btns:undefined,dossierTextBox:undefined,pageTextBox:undefined,tooltipTextBox:undefined,passFilterCheckbox:undefined,openNewWCheckbox:undefined,promptWrapper:undefined,linkData:undefined,canSave:true,requesting:false,init:function(g){this._super(g);this.resetData();this.addChildren([this.createConfigContainer()]);},suppressClose:function(){return true;},fieldChange:function(i,h){this.setData(i,h);var g=!Z(this.linkData,this.originalLinkData)&&this.linkData.tid&&this.linkData.navpage;this.set("canSave",g);},setSaveBtnState:function(){this.btns.rtBtns.saveBtn.set("enabled",this.canSave&&!this.requesting);},oncanSaveChange:function(){this.setSaveBtnState();},onrequestingChange:function(){this.setSaveBtnState();},resetUI:function(){var j=this,i=this.host,h=i.getDocModel(),g=i.boxContent.hasDossierLink();if(g){F(this.linkData.tid,this.linkData.ttp,h,function(k){j.pageTextBox.set("enabled",true);j.pageTextBox.set("items",k.pages);j.pageTextBox.set("selectedIndex",b(j.linkData.navpage,k.pages)||0);j.fieldChange("prms",L(j.linkData.prms,k.prms));j.setStateOfPrompts();});}else{this.pageTextBox.set("enabled",false);this.pageTextBox.set("items",R);this.pageTextBox.set("selectedIndex",0);this.setStateOfPrompts();}this.dossierTextBox.text.set("value",this.linkData.tnm);this.tooltipTextBox.set("value",this.linkData.dtxt);this.passFilterCheckbox.set("checked",this.linkData.psf);this.openNewWCheckbox.set("checked",this.linkData.onw);this.btns.rmvBtn.set("enabled",g);this.set("canSave",false);this.set("requesting",false);},setStateOfPrompts:function(){this.promptWrapper.set("visible",this.linkData.prms.length>0);this.promptWrapper.set("prompts",this.linkData.prms);this.promptWrapper.set("aopam",this.linkData.aopam);},setData:function(h,g){if(typeof h==="string"){this.linkData[h]=g;}else{if(typeof h==="object"){S.copy(h,this.linkData);}}},resetData:function(){var h=this.host,g=h.boxContent.hasDossierLink()?h.boxContent.model.data.doslinkinfo:{};this.originalLinkData=S.copy(g,{tid:"",tnm:"",navpage:"",navpagenm:"",dtxt:"",psf:1,onw:1,aopam:2,prms:[]});this.linkData=S.clone(this.originalLinkData);},writeData:function(h,i){var g=mstrmojo.all[h];if(S.walk("model.data",g)){g.model.data.doslinkinfo=i;this.onLinkUpdated(g);}},submit:function(g,h){var q=this,n=this.host.model,k=this.host.boxContent,p=k.id,i=S.clone(S.walk("boxContent.model.data.doslinkinfo",this.host)),u=g?undefined:S.clone(this.linkData),m=g?"":e(this.linkData,S.walk("linkData.onw",this)),l=function(){q.set("canSave",true);},t=function(){q.writeData(p,g?undefined:q.linkData);},j=function(){q.set("requesting",false);},s=this.writeData.bind(this,p,i),o=this.writeData.bind(this,p,u);m={Hyperlinks:m};if(h){return{actions:k.hasArrayGSI?n.getCompoundGridLinkAction(k,m):n.getLinkAction(k,m),callbacks:{success:t},undo:s,redo:o};}this.set("requesting",true);n.editLink(k,m,{failure:l,success:t,complete:j,undo:s,redo:o},mstrmojo.DocDataService.SUPPRESS_DATA);return{};},createConfigContainer:function(){var i=this,g=this.host.getDocModel(),h=new mstrmojo.Box({cssClass:"link-config-container",children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(15463,"Dossier")},this.dossierTextBox=W(this.linkData.tnm,function(k){i.fieldChange({tid:k.did,tnm:k.n,ttp:k.t,vwm:k.dvm});F(k.did,k.t,g,function(l){i.pageTextBox.set("enabled",true);i.pageTextBox.set("items",l.pages);i.pageTextBox.set("selectedIndex",I);i.fieldChange("prms",l.prms);i.setStateOfPrompts();});},{slot:"col2Node",placeholder:mstrmojo.desc(17004,"Choose a dossier to link to"),noReport:true,folderLinksContextId:30,browsableViewMedias:"2048,8192",parentFolderId:g&&g.pfid})]},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(3687,"Page")},this.pageTextBox=M(this.linkData.navpage,R,function(){return null;},function(k){i.fieldChange({navpage:k.navPage,navpagenm:k.n});},{slot:"col2Node"})]},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[{scriptClass:"mstrmojo.Label",slot:"col1Node",text:mstrmojo.desc(15698,"Tooltip")},this.tooltipTextBox=new mstrmojo.TextBox({alias:"text",slot:"col2Node",valueChangeDelay:1000,value:this.linkData.dtxt,onfocus:function(){if(!this.value){this.set("value",J(i.linkData.tnm));}},onkeydown:function(k){if(k.e.keyCode===13){this.blur();}},onvalueChange:function j(){i.fieldChange("dtxt",this.value.trim());}})]},{scriptClass:"mstrmojo.Box",cssClass:"should-pass-filter",children:[this.passFilterCheckbox=new mstrmojo.ui.Checkbox({cssDisplay:"inline-block",checked:this.linkData.psf,oncheckedChange:function(){i.fieldChange("psf",Number(this.checked));}}),new mstrmojo.Label({cssDisplay:"inline-block",text:mstrmojo.desc(17003,"Pass the filter conditions to the target page"),onclick:function(){this.parent.children[0].onclick();}})]},{scriptClass:"mstrmojo.Box",cssClass:"open-in-new-tab",children:[this.openNewWCheckbox=new mstrmojo.ui.Checkbox({cssDisplay:"inline-block",checked:this.linkData.onw,oncheckedChange:function(){i.fieldChange("onw",Number(this.checked));}}),new mstrmojo.Label({cssDisplay:"inline-block",text:mstrmojo.desc(18451,"Open in new tab"),onclick:function(){this.parent.children[0].onclick();}}),new mstrmojo.Label({cssDisplay:"inline-block",cssClass:"desc-text",text:mstrmojo.desc(18449,"(Web only)"),onclick:function(){this.parent.children[0].onclick();}})]},this.promptWrapper=new c({fromVis:true,prompts:this.linkData.prms,aopam:this.linkData.aopam,onAnswerChange:function(l,k){i.fieldChange(l?"aopam":"prms",k);}}),this.btns=B(function(){i.submit(true);i.close();},function(){if(i.host.boxContent.hasSelectTarget()){i.host.clearTargets(i.submit(false,true));}else{i.submit();}i.close();},function(){i.close();})]});return h;},onOpen:function(){mstrmojo.ui.PopupConfig.directionCfg.setDirection(false);this.resetData();this.resetUI();}});mstrmojo.ui.editors.controls.ContextualLink.LINK_TYPE=D;mstrmojo.ui.editors.controls.ContextualLink.getLinkTooltip=O;mstrmojo.ui.editors.controls.ContextualLink.genDLAction=H;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.datasets.DataInterface","mstrmojo.expr","mstrmojo.array","mstrmojo.VisUtility","mstrmojo.vi.util.DIUtils","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi.enums.EnumFeatures","mstrmojo.num","mstrmojo.string","mstrmojo.DocSelector","mstrmojo.elementHelper");mstrmojo.requiresDescs(2031,3945,3946,11505,11571,13629,13630,13860,14595,15952);var l=mstrmojo.vi.ui.DatasetUnitMenuUtils,U=mstrmojo.models.datasets.DataInterface,Y=mstrmojo.expr.DTP,X=mstrmojo.array,E=mstrmojo.num,i=mstrmojo.string,j=mstrmojo.VisUtility,a=mstrmojo.vi.util.DIUtils,d=a.DIConstants,F=mstrmojo.vi.enums.EnumFeatures,Q=mstrmojo.DocSelector.UNSET_STATUS,D=mstrmojo.DocSelector.STYLES,Z=mstrmojo.elementHelper;function L(u){var s=350,m={fontFamily:"Arial",fontSize:"12px"},q=j.measureTextWidth(u,m);if(q>s){var p,n,o=u.indexOf(" "),t=o;while(o>-1){p=u.substring(0,o);n=j.measureTextWidth(p,m);if(n>=s){break;}t=o;o=u.indexOf(" ",o+1);}if(o>-1){u=u.substring(0,t)+"\n"+u.substring(t);}}return u;}function O(m){var q,p=m.selector,s=m.fn(),t=s.keys,n=s.items,u=n.reduce(function(x,y){if(y.fgk!==undefined){x.push(n.indexOf(y));}return x;},[]),w=new mstrmojo.ui.CheckList({alias:"unitCheckList",cssClass:"units",items:n.map(function(x){x.css=l.getUnitCssClass(x.src||{});return x;}),onchange:function(x){var y=x.added||x.removed;if(q&&y.length===1){q.set("okEnabled",true);if(u.length>1&&w.items[y[0]].fgk){w[x.added?"addSelect":"removeSelect"](u);}}}}),o=L(m.title);w.setSelectedItems(n.filter(function(x){return t.indexOf(x.id)>-1;}));q=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.Box({cssClass:"mstrmojo-vi-FilterBox-content",children:[{scriptClass:"mstrmojo.Label",text:o},w]}),okEnabled:false,data:{},onOpen:function(){w.updateScrollbars();},cssClass:"mstrmojo-vi-FilterBox-targets",okBtnText:mstrmojo.desc(2031,"Apply"),fnOk:function(){p.model.changeFilterTargets(p,t,w.getSelectedItems().map(function(x){return x.id;}),p.isInFilterPanel());}});return q;}function e(m,n){return function(o,p){var q=o!==p;if(q){m.set(n,o);}return q;};}mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",addModeMenuItems:function K(n,m,o){if(!m.supportsInclude()){return false;}var p=function(t,q){var s=m.include===q;n.addMenuItem(t,s?"on":"",function(){if(!s){m.set("include",q);this.generateToolbar();if(o){o();}}return !s;}.bind(this));}.bind(this);p(mstrmojo.desc(3945,"Include"),true);p(mstrmojo.desc(3946,"Exclude"),false);n.hasToggleItem=true;n.addSeparator();return true;},addShowAllMenuItem:function H(n,m){if(!m.supportsShowAllToggle()||m.isAttrQualSelector()||m.isRecursiveAttributeSelector()||m.isSearchBox()||mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){return false;}var p=mstrmojo.desc(4741,"Show Option for All");if(!m.include){n.addNonInteractiveMenuItem(p,"",true);return true;}var o=function(){var t=!m.defn.showall,q=m.model,s=q.getSelectorPropsChangeAction(m,{showAll:t}),u=s.concat(q.getCtrlActionsByStyleForToggleShowAll(m,t));q.submitToggleShowAllActions(m,u);};n.addToggleMenuItem(p,"",o,o,this.id,m.defn.showall);return true;},addClearFilterMenuItem:function I(n,m,o){if(mstrApp.isAppStatePresentation()&&(m.hasDynamicSelection(true)||(m._dynamicSelDefn&&!m.isUnset()))){return false;}n.addMenuItem(m.isAMSelector()?mstrmojo.desc(16876,"Unset Selector"):mstrmojo.desc(14595,"Unset Filter"),"",function(){var s=mstrApp.isAppStatePause(),p=true,q;if(m.isInFilterPanel()&&!s){q=m.getFilterPanel();p=q&&q.isAutoApply();}m.clearSelector(p);if(o){o();}});return true;},addResetToDynamicItem:function C(o,n,p){var s=p.sus,m=p.suc,q=s===Q.FIRST?mstrmojo.desc(17762,"Reset to First ##"):mstrmojo.desc(19389,"Reset to Last ##");q=q.replace("##",m);o.addMenuItem(q,"",function(){n.configDynamicSelection(s,m);});},addDynamicSelConsumptionItems:function J(n,m){var p=m.style,t=m.node.data,s=m._dynamicSelDefn,q=m.content,o=q&&q.items;if(p===D.SEARCH_BOX){if(o.length){n.addMenuItem(mstrmojo.desc(2119,"Clear All"),"",function(){m.updateSelectionsByStyle([]);});}}else{if(m.useAttrStyle()&&!m.showall&&m.include){n.addMenuItem(mstrmojo.desc(3474,"Select All"),"",function(){m.updateSelectionsByStyle(m.multi?t.elms:[Z.ELEM_ALL_ID]);});}}if(s&&!t.unset){this.addResetToDynamicItem(n,m,s);}},addDynamicSelectionMenuItem:function g(w,q){var t=mstrApp&&mstrApp.supportFeature(F.DYNAMIC_SEL_AND_SORT),o=mstrApp&&mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation(),n=q.node.data.dt;if(!t||o||(!q.isAttributeSelector()&&!q.isSlicingSelector())||q.isRecursiveAttributeSelector()||(q.isAttrQualSelector()&&(n===Y.DATE||n===Y.TIMESTAMP))){return false;}var x=q.defn,AA=1,m=2000000000,u=999,p={1:0,2:1,4:2},s={selectedIndex:p[x.sus||1],count:x.suc||AA},z=!q.multi,y=[{n:'<div style="opacity:0.45">'+mstrmojo.desc(11722,"Unset")+"</div>",v:1,hid:s.selectedIndex>0},{n:z?mstrmojo.desc(17765,"First Element"):mstrmojo.desc(17577,"First N Elements"),v:2},{n:z?mstrmojo.desc(17770,"Last Element"):mstrmojo.desc(17578,"Last N Elements"),v:4}];w.addPopupMenuItem(mstrmojo.desc(17768,"Dynamic Selection"),this.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"dynamicSelection",data:mstrmojo.hash.clone(s),bindings:{okEnabled:function(){var AD=this.data.selectedIndex,AE=this.data.count,AF=!isNaN(AE);return(AD!==s.selectedIndex||AE!==s.count)&&AF;}},contents:[{alias:"dynamicStates",scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:s.selectedIndex,isHostedWithin:false,items:y,allowHTML:true,onitemSelected:function(AD){if(!this.hasRendered){return ;}if(AD.v>1&&!z){this.parent.quantity.set("visible",true);}else{this.parent.quantity.set("visible",false);}this.parent.data.set("selectedIndex",AD._renderIdx);}},{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"quantity",width:"140px",cssText:"padding-top:10px;",col1Width:"90px",col2Width:"50px",visible:s.selectedIndex>0&&!z,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(17769,"Quantity"),slot:"col1Node",},{scriptClass:"mstrmojo.TextBox",alias:"value",slot:"col2Node",value:s.count,lastValidValue:s.count,onvalueChange:function(){var AD=this.value,AG=E.parseInteger(this.value),AF=i.isEmpty(AD);if(!AF&&E.inNumericRange(AG,AA,m)!==0){var AE=AG>m;q.set("validation",{invalid:true,errorCode:AE?"maxValueVIWarning":"minValueVIWarning",args:AE?undefined:[0],refNode:this.domNode,offsetAlgo:true,position:4});AG=NaN;}else{if(AG>u){q.set("validation",{invalid:true,errorCode:"largeSelectionVIWarning",refNode:this.domNode,offsetAlgo:true,position:4});}else{if(q.hideWarning){q.hideWarning();}}if(!AF){this.lastValidValue=AG;}}this.parent.parent.data.set("count",AG);},onblur:function(){var AD=this.value,AE=E.parseInteger(this.value);if(AD.length===0||isNaN(AE)||AE>m){this.set("value",this.lastValidValue);}else{if(AE<AA){this.set("value",AA);}}}}]}],fnOk:function AC(AE){var AD=y[AE.selectedIndex].v;if(q.warning&&q.warning.visible&&q.hideWarning){q.hideWarning();}q.configDynamicSelection(AD,z?1:AE.count);},fnCancel:function AB(){if(q.warning&&q.warning.visible&&q.hideWarning){q.hideWarning();}}});});return true;},isSortingAllowed:function R(n){var p=mstrApp&&mstrApp.supportFeature(F.DYNAMIC_SEL_AND_SORT),o=mstrApp&&mstrApp.isAppStatePresentation(),m=[mstrmojo.DocSelector.STYLES.CHECKBOX,mstrmojo.DocSelector.STYLES.PULLDOWN,mstrmojo.DocSelector.STYLES.RADIO,mstrmojo.DocSelector.STYLES.LINK,mstrmojo.DocSelector.STYLES.BUTTON,mstrmojo.DocSelector.STYLES.SEARCH_BOX,mstrmojo.DocSelector.STYLES.SCROLLER,mstrmojo.DocSelector.STYLES.LIST],q=n.node.data.dt;if(!p||o||(!n.isAttributeSelector()&&!n.isConsolidationSelector())||(n.isAttrQualSelector()&&(q===Y.DATE||q===Y.TIMESTAMP))){return false;}return m.indexOf(n.style)!==-1;},addAttributeSortMenuItem:function A(s,AB,AG){if(mstrmojo.resolveFeature("set-attributeform-display")){var o=AB.defn,y=o.sorts&&o.sorts[0]||{},x=(y.key||"").split("!"),z=x.length&&x[2],AD=y.isAsc===AG,p=AB.model,t=p.datasets,m=o.srcid,AC=AB.isNewDerivedElementSelector(),AA=AC&&l.getUnitFromDataset(t,m,o.srct),q=U.getFormsByAttrId(AC?AA.attId:m,t),w=q.length>1,u,AF,n;if(w){u=AG?mstrmojo.desc(17761,"Sort Ascending By"):mstrmojo.desc(17766,"Sort Descending By");}else{u=AG?mstrmojo.desc(7974,"Sort Ascending"):mstrmojo.desc(7975,"Sort Descending");}s.addMenuItem(u,AD?"on":"attrSort",function(){if(w){AF=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"hasToggleItem sortAttributeForm"});if(AB.isRecursiveAttributeSelector()){q=X.filter(q,function(AI){return AI.fid!=="A9BFF03B4D72CC4F457ACBB4B185E91D"&&AI.fnm!=="LEVEL_NUMBER";});}AF.addDisabledMenuItem(mstrmojo.desc(17763,"Attribute Form"),"label");AF.addSeparator();q.forEach(function(AI){var AK=AI.fid,AJ=z===AK&&AD;AF.addMenuItem(AI.fnm,AJ?"on":"",p.sortSelectorByAttrForm.bind(p,AB,false,AG,AK));},this);return AF;}else{n=q.length===1?q[0].fid:undefined;p.sortSelectorByAttrForm(AB,false,AG,n);}});if(w){var AH=s.getMenuItems(),AE=AH.length-1;AH[AE].pop=true;AH[AE].scope=this.id;}return true;}},addClearSortMenuItem:function K(n,m){var o=m.model;n.addMenuItem(mstrmojo.desc(17764,"Clear Sort..."),"",o.sortSelectorByAttrForm.bind(o,m,true));return true;},addDossierLevelFilterMenuItem:function M(q,n){var w=mstrApp&&mstrApp.supportFeature(F.DOSSIER_LEVEL_FILTER),m=mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation(),p=n.model,o=n.n,s=(p.datasetsSettings&&p.datasetsSettings.units)||{},t=s[o]&&s[o].completeHide;if(!w||m||n.isVisFilter()||t){return false;}var u=[{n:mstrmojo.desc(18465,"This Chapter Only"),v:false},{n:mstrmojo.desc(18463,"All Chapters Containing This Filter"),v:true}];q.addPopupMenuItem(mstrmojo.desc(18464,"Apply Selections To"),this.id,function(){var y=n.defn.sync,z=new mstrmojo.ui.menus.MenuConfig(),x=function(AA){return function(){if(y!==AA){p.synchronizeSelector(n,AA);}};};u.forEach(function(AA){z.addMenuItem(AA.n,y===AA.v?"on":"",x(AA.v));},this);z.hasToggleItem=true;return z;});return true;},addMenuItemIfSelectTargetsValid:function k(n,m,o){if(!mstrApp.isAppStatePresentation()){var p=this.getTargetInfo();if(p.items.length){n.addEditorMenuItem(mstrmojo.desc(13629,"Select Targets"),this.id,O,{selector:m,fn:this.getTargetInfo.bind(this),title:o});}}},addSelectorTargetsMenuItem:function W(n,m){if(!mstrApp.isAppStatePresentation()){n.addMenuItem(!!m.tks?mstrmojo.desc(16874,"Edit Targets"):mstrmojo.desc(13629,"Select Targets"),"uaf",function(){mstrApp.rootCtrl.view.openInlineDialog({scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",vis:m.parent});});}},addFilterStyleMenuItem:function S(n,m){if(mstrApp.isAppStatePresentation()||m.isSolrSelector()){return false;}var o=m.getSelectorStyleList();if(!o.length){return false;}n.addSubMenuItem(mstrmojo.desc(11505,"Display Style"),"",this.id,function(){var q=m.defn.style,p=function(t){return function(){if(t!==q){var u=mstrmojo.DocSelector.STYLES.ATTR_QUAL;if(t===u||q===u){m.model.openSelWarnFlag(m.k);}m.model.changeFilterStyle(m,t);}};};var s=new mstrmojo.ui.menus.MenuConfig();if(m.isDynamicAttributeSelector()&&m.expr){s.useTooltip=true;o.forEach(function(u){var t=u.n;if(q!==u.v){t=typeof t==="object"?t.n:t;s.addDisabledMenuItem({n:t,ttp:mstrmojo.desc(15952,"Please unset filter selections before switching to the # display style").replace("#",t)});}else{s.addMenuItem(t,"on",mstrmojo.emptyFn);}});}else{o.forEach(function(t){var u=t.v;s.addMenuItem(t.n,q===u?"on":"",p(u));},this);}s.hasToggleItem=true;return s;});return true;},addMultiSelectMenuItem:function f(n,m){if(!m.allowsTogglingMultiSelect()||mstrApp.isAppStatePresentation()){return false;}if(m.isAMSelector()&&!m.parent.isAllGrid){return false;}n.addMenuItem(mstrmojo.desc(13860,"Allow Multiple Selections"),m.multi?"on":"",function(){m.model.changeFilterStyle(m,m.style,!m.multi,m.iase);});n.hasToggleItem=true;return true;},addAutoSearchMenuItem:function c(n,m){if(!m.allowsTogglingAutoSearch()||mstrApp.isAppStatePresentation()){return false;}n.addMenuItem(mstrmojo.desc(15913,"Allow Instant Search"),m.iase?"on":"",function(){m.model.changeFilterStyle(m,m.style,m.multi,!m.iase);});n.hasToggleItem=true;return true;},addConfigVisSelectorMenu:function B(n,m){var o=this;n.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.closeVisSelectorPanel();var q=m.model,p=m.k;q.checkLargeItemsForVisFilter(p,function(){var s=q.addVisFilterContainer(),u=q.getSelectedViUnit(),t;q.oldSelectedVizBoxId=u?u.id:null;mstrApp.isInVFConfigMode=true;mstrApp.restoreVFKey=p;q.beforeEnterVFConfigMode();t=q.insertVizBox(p,s,{});q.controller.rootCtrl.initPanelStautsInConfigMode();q.selectVIUnit(t.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(m.parent.baseTitle,true);});});},addQualMenuItems:function P(n,m){if(m.isSolrSelector()||!m.isMetricSelector()||m.isRankMetricSelector()||!m.isNumericMetricSelector()){return false;}n.addRadioMenuGroup(m.qua>0?1:0,e(m,"qua"),[{value:0,text:mstrmojo.desc(11571,"Qualify on Value")},{value:1,text:mstrmojo.desc(13630,"Qualify on Rank")}],"",undefined,true);n.addSeparator();return true;},addBFAMenuItem:function G(n,m){if(m.isRecursiveAttributeSelector()&&m.showBFAMenu&&!mstrApp.isDossier&&!mstrApp.isAppStatePresentation()){n.addMenuItem(mstrmojo.desc(17314,"Use Alternate Filter Technique"),m.defn.pdf?"on":"",function(){m.changeFilterTechnique();});n.hasToggleItem=true;}},addSetDisplayFormsMenuItem:function h(w,q){var o=q.node.data.dt;if(!q.isAttributeSelector()&&!q.isNewDerivedRecursiveElementSelector()||(q.isAttrQualSelector()&&(o===Y.DATE||o===Y.TIMESTAMP))){return false;}var t=q.model,x=q.defn,p=[],AB=l.getUnitFromDataset(t.datasets,x.srcid,x.srct),z=AB&&AB.attId,m=U.getFormsByAttrId(z||x.srcid,t.datasets),s=t.datasets[x.dsid];if(q.isRecursiveAttributeSelector()){m=X.filter(m,function(AC){return AC.fid!=="A9BFF03B4D72CC4F457ACBB4B185E91D"&&AC.fnm!=="LEVEL_NUMBER";});}if(m.length<2){return false;}var y=x.fs||x.sfs;if(!y){var u=[],AA=t.getDatasetUnits(["att","mx"],function(AC){return AC.did===(z||x.srcid);})[0]||{};(AA.fs||[]).forEach(function(AC){if(AC.isbf){u.push({did:AC.fid});}});if(u.length){y=u;}}if(s&&s.xdaType===d.xdaType.customFreeFormSQL&&!!x.sfs){var n=!!x.fs?x.fs.concat(x.sfs):x.sfs;m=X.filter(m,function(AC){return X.find(n,"did",AC.fid)!==-1||AC.fnm==="ID";});}m=X.map(m,function(AD,AC){var AE=AD.fid;if(X.find(y,"did",AE)!==-1){p[AC]=true;}return{id:AE,n:AD.fnm};});if(mstrmojo.resolveFeature("set-attributeform-display")&&!mstrApp.isAppStatePresentation()){w.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"displayForms",data:{defn:x,oldSelectedIndices:p.slice()},contents:[{alias:"formCheckList",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:m,selectedIndices:p.slice()}],fnOk:function AD(AL,AO){var AH=[],AP=[],AM=AO.formCheckList,AQ=AM.items,AE=AM.selectedIndices,AK=AL.defn.fs||AL.defn.sfs,AJ=false,AG,AI;for(AI=0;AI<AQ.length;AI++){var AF=!!AL.oldSelectedIndices[AI],AN=!!AE[AI];if(AF!==AN){AJ=true;break;}}if(!AJ){return ;}X.forEach(AE,function(AR,AS){if(AR){AH.push(AQ[AS]);}});X.forEach(AK,function(AR){AG=X.filterOne(AH,function(AS){return AS.id===AR.did;});if(AG){AP.push(AG);X.removeItem(AH,AG);}});AP=AP.concat(AH);t.setFilterDisplayForms(q,AP);},onOpen:function AC(){this.formCheckList.updateScrollbars();}});});}},addReplaceWithMenuItem:function b(n,m){var o=m.getSelectorReplaceUnitList();if(o.length===0){return false;}n.addEditorMenuItem(mstrmojo.desc(14003,"Replace with"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:m.getSelectorReplaceUnitList(),listHooks:{select:function p(q,s){if(m.isInFilterPanel()){m.model.replaceFilterStackSelectors(m.defn,s);}else{m.model.replaceFilter(m,s);}}}}]}]});});return true;},getTargetInfo:function N(){this.throwAbstractMethodError("getTargetInfo");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.HBox","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.css","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.vi.ui.IncHierarchyCheckList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var G=mstrmojo.css,A=mstrmojo.mstr.EnumDSSXMLObjectTypes;var E="36px";mstrmojo.vi.ui.HierarchyElementsCheckListBrowser=mstrmojo.declare(mstrmojo.vi.ui.ElementsBrowser,null,{scriptClass:"mstrmojo.vi.ui.HierarchyElementsCheckListBrowser",children:[{scriptClass:"mstrmojo.HBox",slot:"searchBoxNode",alias:"util",cssClass:"elemsBrowser-utils-bar",children:[{scriptClass:"mstrmojo.Box",cssClass:"eb-box-search",alias:"box",children:[{scriptClass:"mstrmojo.TextBox",alias:"searchBox",hint:"Search",cssClass:"eb-searchBox",onEnter:function B(){var O=this.value,M=this.parent.parent.parent,N=!M.searchPattern&&!O;if(!N){M.set("searchPattern",O);}this.blur();}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-clear",text:"",onclick:function(){var M=this.parent.searchBox;M.set("value","");M.cleanUp();M.focus();M.onEnter();},bindings:{visible:"(this.parent.searchBox.value || '').length > 0"}},{scriptClass:"mstrmojo.Button",cssClass:"eb-searchBox-search",text:"",onclick:function(){var M=this.parent.searchBox;M.focus();M.onEnter();}}]}]},{scriptClass:"mstrmojo.HBox",slot:"buttonPanelNode",alias:"buttonPanel",cssClass:"elemsBrowser-button-panel"},{scriptClass:"mstrmojo.vi.ui.IncHierarchyCheckList",alias:"elementList",slot:"elementListNode",allowUnlistedValues:false,bindings:{disableLevel:"this.parent.disableLevel"},getDataHelper:function(){return this.parent.ifDataHelper;},getAttribute:function(){return this.parent.attribute;},isHiearachyDisplay:function F(){var M=this.parent;return !M.searchPattern||M.searchPattern==="";},setSelectedItems:function J(M){if(typeof M==="object"){this.setSelectionByExprJSON(M);}},postSelectionChange:function I(){var M=this.getAttribute();if(M){this.parent.onItemsSelectionChange(this.buildSelectionExprJSON(M));}}}],init:function L(M){this._super(M);G.addWidgetCssClass(this,"hierarchy");if(this.disableLevel){G.addWidgetCssClass(this,"disable-level");}},postCreateChildren:function D(){var M=this.elementList;this.util.addChildren(M.getLevelPopupConfig());this.buttonPanel.addChildren([M.getAllButtonConfig(true),M.getAllButtonConfig(false)]);},onattributeChange:function H(M){var N=this.elementList;N.clearItems();this._super(M);},onsearchPatternChange:function C(){var N=this.elementList,M=N.isHiearachyDisplay();this._super();this.buttonPanel.set("visible",M);this.layoutConfig.h.buttonPanelNode=M?E:"0px";this.doLayout();},isObjSearchable:function K(M){return true;},onElementsListchange:mstrmojo.emptyFn,updateClearAllBtnState:mstrmojo.emptyFn,_set_selectedItems:null});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.ui.HierarchyElementsCheckListBrowser","mstrmojo.vi.ui.ElementsBrowser","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox","mstrmojo.Label","mstrmojo._IsList","mstrmojo.rw.ConditionWalkProviderBase","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.ui.CheckList","mstrmojo.ui.ColumnContainer","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo._HasItemAliases");var P=mstrmojo.array,X=mstrmojo.css,F=mstrmojo.string,M=mstrmojo.expr,Y=mstrmojo.dom,Z=mstrmojo.hash,z=M.ET,b=M.ET2TGT,o=M.DTP2FN_DTP,a=M.FN,n=M.FNT,S=M.FN_MRP,t=mstrmojo.rw.ConditionWalkProviderBase,e=t.onWalkChange,q=t.updateList,AK=t.fnItem,AJ=t.isComparisonAllowed,c=t.clearInvalid,D=t.shouldShowCst,f=t.getConstant,G=t.getConstantDataType,y=t.getConstantValue,AL=t.isDATE,g=t.getCstListCompareTgts,h=t.fmJson,AC=t.allowedTargetTypes,L=t.updatePulldown,U=t.onWalkChangeThroughPulldown,p=mstrmojo.mstr.EnumDSSXMLObjectTypes,AG=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,AO=mstrmojo.vi.ui.DatasetUnitMenuUtils,B=mstrmojo.ui._HasListTooltip;var E=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;var Q=mstrmojo.meta.TP,AF=mstrmojo.meta.STP,C="-2";var N={SELECT:0,QUALIFICATION:1};var i={TEMPLATE_LEVEL:0,DATASET_LEVEL:1};var W={VALUE:1,RANK_PERCENTAGE:2,BOTH:3};var m=0,s=1;var H=368,AE=H-5,AN=5,R=26,K=10;var AM=2147761857,AI=2147786389;var x={};x[z.MQ]={key:"metricFns",def:M.METRIC_FNS};x[z.MC]={key:"metricFns",def:M.METRIC_FNS};x[z.AQ]={key:"formFns",def:M.FORM_FNS};x[z.AL]={key:"formFns",def:M.FORM_FNS};x[z.AC]={key:"formFns",def:M.FORM_FNS};x[z.AE]={key:"elemFns",def:M.ELEM_FNS};function AH(AP){return'<div class="unit item '+AO.getUnitCssClass(AP)+'">'+F.encodeHtmlString(AP.n)+"</div>";}function AB(AP){var AQ=this.selectedNode;P.forEach(AQ.classList,function(AR){if(AR&&F.startsWith(AR,"ic")){X.removeClass(AQ,AR);}});X.addClass(AQ,"unit");X.addClass(AQ,"item");X.addClass(AQ,AO.getUnitCssClass(AP));return F.encodeHtmlString(AP.n);}function l(AQ,AY){var AU=AQ.model,AX=AU.et,AZ=AU&&AU[b[AX]]&&AU[b[AX]][AQ.columnWalk.target.itemIdField||"did"],AT=AU&&AU.fm,Ac=AT&&AT.dtp,AR=AJ(AU,AQ.ets);if(this.targetsLastMod&&this.targetsLastMod===AQ.targetsLastMod&&AZ&&AZ===this._lastTargetId&&this.lastFmDtp===Ac&&this.lastFnTp===AR&&this.lastEt===AX){return ;}var AW=this.attMxPd,Ab=this.attMxLabel;if(!AR){AW.set("items",[]);Ab.set("visible",false);AW.set("visible",false);}else{var Aa=AU.a?mstrmojo.desc(518,"Attribute"):AU.m?mstrmojo.desc(517,"Metric"):"",AV=g(AQ),AP=AU[b[AU.et]+(2+AY)],AS=AP?P.find(AV,"did",AP.did):undefined;Ab.set("text",Aa);AW.items=AV;AW.selectedIndex=AS>=0?AS:undefined;AW.refresh();Ab.set("visible",true);AW.set("visible",true);}this._lastTargetId=AZ;this.lastFnTp=AR;this.lastFmDtp=Ac;this.lastEt=AX;this.targetsLastMod=AQ.targetsLastMod;}function J(AX,Aa){AX.updating=true;var AT=AX.parent.parent.parent,AZ=D(AT,Aa);if(!AZ){AX.updating=false;return ;}var AR=AT.model||{},AW=f(AT,Aa),AS=G(AT,AW),Ab=y(AT,Aa),AY=AR.fn,AV=M.fn_List(AY,AR.fnt),AP=AL[AS];var AU=AP?AX.dateInput:AX.txtInput;var AQ=AP?AX.txtInput:AX.dateInput;AQ.set("visible",false);AU.updating=true;AU.set("dtp",AS);AU.set("isList",AV);AU.set("value",Ab);AU.set("visible",true);AU.set("hint",AV?mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"):"");AU.updating=false;if(AY===1||AY===2){AU.constraints.min=0;}if(AU.clearValidation&&AU.inputNode){AU.clearValidation();}l.call(AX,AT,Aa);switch(AR.et){case z.AQ:case z.AL:case z.MQ:AX.attMxPd.set("selectedIndex",undefined);break;}AX.updating=false;}function AD(){var AS=this.parent,AQ=AS.parent.parent.parent,AR=(this.isValid&&this.isValid())||(!this.isValid&&!F.isEmpty(this.value)),AP=AQ.model;AQ["invalid"+AS.cstIndex]=!AR;if(!this.updating){this.updating=true;if(AP){AP.edit(AS.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}if(AQ.updateOkBtn){AQ.updateOkBtn();}}function I(AP){if(AP){var AR=AP.n,AQ=AP.dsName;if(AR&&AQ){return'<div class="name">'+F.encodeHtmlString(AR,true)+'</div><div class="dsc dataset">'+F.encodeHtmlString(AQ,true)+"</div>";}else{return B.getTooltipText.call(this,AP);}}}function k(AP){return Z.copy(AP,{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"txtInput",cssText:"width: 100%",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.VALUESET},onValid:AD,onInvalid:AD,onClearValidation:c,size:6,visible:true},{scriptClass:"mstrmojo.DateTextBox",alias:"dateInput",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AD,onInvalid:AD,onClearValidation:c,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(AS){Y.stopPropogation(AS.hWin,AS.e);}},visible:true},{scriptClass:"mstrmojo.Label",cssClass:"attMxLabel",text:"Attribute",alias:"attMxLabel"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attMxPd",itemIdField:"did",cssClass:"conditionWalk-attMxPd",onSelectedItemChange:function AQ(AT){if(this.hasRendered){var AS=this.parent.parent.parent.parent;U.call(this,AS,AT,"c0");}},getPulldownTextInnerHTML:AH,getPopupListConfig:function AR(){var AS=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AS.showTooltipForLargeText=false;AS.getItemProps=function AT(AW,AU){var AV=mstrmojo._IsList.getItemProps.call(this,AW,AU);AV.title="";AV.style=this.parent.itemCssText||"";AV.addCls("unit "+AO.getUnitCssClass(AW));return AV;};AS.getTooltipText=I;return AS;}}],update:function(){J(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});}});}function u(AP){return AP[Q]===p.Attribute&&AP[AF]===AG.AttributeRecursive;}function w(AP){var AR=AP[Q]===p.Consolidation&&AP[AF]===AG.ConsolidationManaged,AQ=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(AR&&AQ&&AQ.findUnitInDataSet){AP=AQ.findUnitInDataSet(AP.did);if(AP&&AP.attId){return u(AQ.findUnitInDataSet(AP.attId));}}}mstrmojo.vi.ui.ConditionWalkProvider=mstrmojo.declare(mstrmojo.rw.ConditionWalkProviderBase,[mstrmojo._HasItemAliases],{scriptClass:"mstrmojo.vi.ui.ConditionWalkProvider",getTargetNodeProps:function j(){var AZ=this;return{alias:"target",isAttribute:false,isMetric:false,showChooseMethod:true,showLevel:false,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15115,"Based on")},{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"target",itemIdField:"did",cssClass:"conditionWalk-target",allowEmptyText:true,onRender:function(){if(this.hasRendered){this[this.editableSlot].setAttribute("placeholder",mstrmojo.desc(10,"Search"));}},postCreate:function(){this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},getEditableTextInnerHTML:function Aa(){var Ac=this.selectedIndex,Ab=this.getPopupList(),Ad=Ab&&Ab.items;if(this.selectedNode&&Ad&&Ad[Ac]){return this.getPulldownTextInnerHTML(Ad[Ac]);}else{return"";}},update:function AV(){var Ae=this.parent.parent.parent,Ad=Ae.model,Ab=Ae.targetsLastMod,Am=Ae.editor.docModel,Al=Ae.editor.xtab,Ah=Al&&Al.gridInfo,Ai=Ad&&Ad.et;if(this.lastModel!==Ad||this.targetsLastMod!==Ab){this.lastModel=Ad;this.targetsLastMod=Ab;var Ac=Ae.targets,Af=Ae.ets;if(Af&&Ac&&Ac.length){var Ag=AC(Ae.ets);Ac=P.filter(Ac,function(Ap){return Ag[Ap[Q]];});}var An=Ad&&Ad[b[Ai]],Ak=Ae.objectBrowsingEnabled,Ao=Ak&&(!Ac||P.find(Ac,"did",C)===-1);if(Ai===z.ANDOR){An=Ad.a||Ad.m||null;}An=An&&An.did&&An.n?An:undefined;this.set("objectBrowsingEnabled",Ak);if(Ao){Ac=Ac||[];var Aj=mstrmojo.desc(15346,"Browse Metadata Objects...");Ac.push({did:C,n:Aj,t:-1,title:Aj});}if(Am){P.forEach(Ac,function(Ap){AZ.adjustItemName(Ap,Am,Ah);});}L(this,true,M.getSortedObjectsByTypeGroup(Ac),An);if((!Ak||Ao)&&!An){this.set("isEditing",true);this.openPopup(this.getPopupList());}}},onitemSelected:function AQ(Ac){if(this.hasRendered){var Ab=this.parent.parent.parent;U.call(this,Ab,Ac,"target");}},preisEditingChange:function AW(){if(this.hasRendered&&this.isEditing){var Ab=this.selectedNode;this._lastText=Ab.innerHTML;X.removeClass(Ab,"unit");X.removeClass(Ab,"item");}return true;},postisEditingChange:function AX(){if(this.hasRendered&&!this.isEditing){var Ab=this.selectedNode;if(this._lastText){Ab.innerHTML=this._lastText;X.addClass(Ab,"unit");X.addClass(Ab,"item");}else{Ab.innerHTML="";}delete this._lastText;}},onPopupWidgetClosed:function AY(Ad){if(this.objectBrowsingEnabled&&Ad&&Ad.pressingEnter){var Ab=this.getPopupList(),Ag=Ab._oldItems,Af=this.text;if(Ag&&Af){var Ae=P.filterOne(Ag,function(Ah){return Ah.n===Af;});Ae=Ae||Ab.items[0];if(!Ae){delete Ab._oldItems;Ab.set("items",Ag);return ;}if(Ae.did===C){var Ac=this.parent.parent.parent;Ac.browse(this);delete Ab._oldItems;Ab.set("items",Ag);return ;}}}mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this,Ad);},getPulldownTextInnerHTML:AB,getPopupListConfig:function AP(){var Ab=mstrmojo.ui.SearchablePulldown.prototype.getPopupListConfig.call(this);Ab.showTooltipForLargeText=false;Ab.getItemProps=function Ac(Ah,Af){var Ag=mstrmojo._IsList.getItemProps.call(this,Ah,Af);Ag.title="";Ag.style=this.parent.itemCssText||"";Ag.addCls("unit "+AO.getUnitCssClass(Ah));Ag.addCls(Ah.isInvalid?"invalid":"");return Ag;};Ab.doItemSelect=function Ad(Ai,Af){if(Ai.did===C){var Ag=this.parent;Ag.parent.parent.parent.browse(Ag);}else{if(Ai.isInvalid){var Ah=this;window.setTimeout(function(){Ah.showTooltip({target:Ah._getItemNode(Ai._renderIdx)},window);},0);}else{mstrmojo._IsList.doItemSelect.call(this,Ai,Af);}}};Ab.showTooltip=function Ae(Ak,Aj){if(!this.hasOpenTooltip&&!(this._lastOpened&&this._lastOpened.visible)){var Ai=Y.eventTarget(Aj,Ak),Ah=this.getItemFromTarget(Ai);if(Ah&&Ah.isInvalid){var Ag=this.getItemNodeFromTarget(Ai),Af=Y.position(Ag);this.richTooltip={content:mstrmojo.desc(15391,"This is an invalid object. Please contact your administrator for more information."),cssClass:"vi-warning triangle-warning vi-tooltip-C A-center",left:Af.x+168,top:Af.y};mstrmojo._HasTooltip.showTooltip.call(this,Ak,Aj);}else{this.constructor.prototype.showTooltip.call(this,Ak,Aj);}}};Ab.tooltipOpenDelay=700;Ab.getTooltipText=I;return Ab;}},{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(15116,"Choose elements by"),alias:"attrLabel",bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"chooseMethodPd",cssClass:"targetMethod",exceedsLimit:false,items:null,visible:false,bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onitemSelected:function AQ(Ae){var Ad=this.parent.fm,Ac=Ad&&Ad.cssClass,Ab=Ad&&Ad.domNode,Af=Ad&&Ad.selectedItem;if(Ae.v===N.SELECT){X.toggleClass(Ab,"forms",false);if((Ac||"").indexOf(" forms")>-1){Ad.cssClass=Ac.replace(" forms","");}if((!Af)||Af.did!=="1,22"&&Af.did!=="1,57"){Ad.singleSelectByField("1,22","did");}}else{X.toggleClass(Ab,"forms",true);if((Ac||"").indexOf(" forms")===-1){Ad.cssClass=(Ac||"")+" forms";}if(!Af||Af.did==="1,22"||Af.did==="1,57"){Ad.singleSelect(2);}}Ad.updateScrollbars();},update:function AV(){var Ag=this.parent.parent.parent,Ae=Ag&&Ag.model,Ac=Ag&&Ag.disableElementsBrowsing,Ab=Ae&&Ae.a,Ad=Ab&&Ac&&Ac(Ab);if(Ad){this.set("items",[{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}else{if(this.exceedsLimit){this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT,cls:"disabled invalid",dsbld:true,ttp:mstrmojo.desc(19839,"This object exceeds the maximum row limit defined by the server's governing settings. Reduce the item count by filtering the data via qualifications.")},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);this.selectItemByField("v",N.QUALIFICATION);}else{if(Ab.ndetype===1){this.children[0].showTooltipForLargeText=false;this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT,ttpDisabled:true},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION,cls:"disabled",dsbld:true,ttp:mstrmojo.desc(16184,"This method is not available for this object type.")}]);}else{this.set("items",[{n:mstrmojo.desc(15118,"Selecting in list"),v:N.SELECT},{n:mstrmojo.desc(15117,"Qualification on"),v:N.QUALIFICATION}]);}}}var Af=this.getSelectedItem();switch(Ae.et){case z.AQ:case z.AL:case z.AC:if(!Af||Af.v!==N.QUALIFICATION){this.selectItemByField("v",N.QUALIFICATION);}break;default:if(!Af||Af.v!==N.SELECT){this.selectItemByField("v",N.SELECT);}break;}this.exceedsLimit=false;},getPopupListConfig:function AP(){var Ab=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);Ab.showTooltipForLargeText=false;return Ab;}},h({scriptClass:"mstrmojo.ui.CheckList",alias:"fm",fmPost:"",itemIdField:"did",filter:false,isFirstFm:true,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,lastAttrId:null,height:AE-R*4-K*2-AN+"px",onchange:function AT(Ab){e.call(this,Ab,"fm");},bindings:{visible:"this.parent.isAttribute && this.parent.showChooseMethod"},onvisibleChange:function(){this.lastAttrId=null;}}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(15119,"Output Level"),cssClass:"baseOn",alias:"metricLabel",bindings:{visible:"this.parent.isMetric && this.parent.showLevel"}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"outputLevelPd",items:[{n:mstrmojo.desc(12178,"Visualization level"),v:i.TEMPLATE_LEVEL},{n:mstrmojo.desc(13519,"Dataset level"),v:i.DATASET_LEVEL}],selectedIndex:0,bindings:{visible:"this.parent.isMetric && this.parent.showLevel"},onSelectedItemChange:function AR(Ac){var Ab=this.parent.parent.parent,Ad=Ab.condition;Ad.level=Ac.v;}}],updateColumnContainer:function AS(){this.target.update();var Ae=this.parent,Aj=Ae.parent,Am=Aj.model,Au=Am&&Am.et,An=this.idx,Ar=this.next,As=Am&&Am.a,Ak=Am&&Am.fm,Ah=Aj&&Aj.inRelation;if(Au){switch(Au){case z.AQ:case z.AL:case z.AC:case z.AE:case z.ANDOR:if(As){this.set("isMetric",false);this.set("isAttribute",true);var Aq=Aj.disableElementsBrowsing,Ad=As&&Aq&&Aq(As),Ao=Aj.getAttributeInfo(As.did),Ai=u(Ao)||w(Ao),Al=Aj.disableHierarchyLevel;if(Ai){Am.et=z.AE;this.set("showChooseMethod",false);}var Ag=(Am.etWas&&Am.etWas===z.AE)?s:m,Ap=m;if(Am.et===z.AE&&!Ad){Ap=s;}if(Ag!==Ap||Ap===m||!Ae.next){Ae.removeTrailingContainer(An);if(Ap===m&&Ak){Ae.addNextColumn(AZ.getFnNodeProps());}else{if(Ap===s){Ae.addNextColumn(AZ.getEsNodeProps(Ai,Al));}}}Aj.condition.level=i.DATASET_LEVEL;var At=this.fm;At.updating=true;At.update();this.chooseMethodPd.update();At.updating=false;}break;case z.MQ:case z.MC:if(Am.m){this.set("isMetric",true);this.set("isAttribute",false);var Ac=Aj.isMDXDM(Am.m.did),Ab=Aj.condition.level,Af=Aj.editor&&Aj.editor.showLimits;if(Ab!==i.TEMPLATE_LEVEL&&Ab!==i.DATASET_LEVEL){Ab=Aj.condition.level=Af?i.TEMPLATE_LEVEL:i.DATASET_LEVEL;}if(!Ah&&!Ac&&Af){this.set("showLevel",true);this.outputLevelPd.set("selectedIndex",Ab);}else{this.set("showLevel",false);}if(!(Ar&&Ar.fn)){this.parent.insertAndRemoveTrailing(An,AZ.getFnNodeProps());}}break;case z.R:case z.F:case z.XML:this.set("isMetric",false);this.set("isAttribute",false);Aj.condition.level=i.DATASET_LEVEL;this.parent.removeTrailingContainer(An);break;}}else{this.set("isMetric",false);this.set("isAttribute",false);}E.call(this);},setupScrollNodes:function AU(){this.scrollNode=null;}};},getEsNodeProps:function A(AW,AR){var AV=AW?"HierarchyElementsCheckListBrowser":"ElementsBrowser",AQ=[{scriptClass:"mstrmojo.vi.ui."+AV,alias:"es",height:AE-5+"px",disableLevel:AR,update:function AU(){var Aa=this.parent.parent.parent,Ab=Aa.model,AZ=Ab&&Ab.a,AY=!!AZ&&!AZ.ilk;if(!AY){return ;}this.set("ifDataSource",Aa.getIfDataSource());this.onUpdateBrowseElementsParams=function(Ae){Aa.onUpdateBrowseElementsParams(Ae);};if(!Ab.es){Ab.es=[];}if(AW){var Ad=Aa.getAttributeInfo(AZ.did);Z.copyProps(["t","st"],Ad,AZ);if(Ad&&Ad.attId){Ad=Aa.getAttributeInfo(Ad.attId);}Z.copyProps(["fs","lvfs"],Ad,AZ);}else{if(!AZ.fs){Z.copyProps(["fs"],Aa.getAttributeInfo(AZ.did),AZ);}}var Ac=Z.clone(AW?Ab.data:Ab.es);this.set("attribute",AZ);this.set("selectedItems",Ac);},onBrowseElementsFailure:function AP(Ab){var Ad=this.attributeId,AY=this.parent.parent,Aa=AY.parent,Ac=AY.target.chooseMethodPd,AZ=P.filterOne(Aa.targets,function(Af){return Af.did===Ad;});if(Ab===AM||Ab===AI){Ac.exceedsLimit=true;Ac.update();}else{if(AZ){AZ.isInvalid=true;AZ.cls=(AZ.cls||"")+" invalid";}Aa.set("model",{et:5,isNew:true,defaultETAttr:5});var Ae=AY.target.target;Ae.openPopup(Ae.getPopupWidget());}},onItemsSelectionChange:function AX(AY){var AZ=this.parent.parent.parent,Aa=AZ.model;Aa.edit(AW?"data":"es",AY);}}];return{alias:"es",children:AQ,cssClass:"lastStage",updateColumnContainer:function AS(){this.es.update();},setupScrollNodes:function AT(){this.scrollNode=null;}};},getFnNodeProps:function d(){var AT=this,AQ=[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrApp.isWSStyling?mstrmojo.desc(15006,"Operator"):mstrmojo.desc(9579,"Condition")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"fnTypePulldown",items:[{n:mstrmojo.desc(15302,"By Value"),v:W.VALUE},{n:mstrmojo.desc(15303,"By Rank"),v:W.RANK_PERCENTAGE}],onSelectedItemChange:function AU(){var AW=this.parent;AW.fn.update();}},h({scriptClass:"mstrmojo.ui.CheckList",alias:"fn",multiSelect:false,allowUnlistedValues:false,hideCheckMark:true,itemIdField:"did",onchange:function AP(AW){e.call(this,AW);},update:function(){var AY=this.parent,Ac=AY.parent.parent,AX=Ac.model||{},Ad=AX.et,Ab,Ae=false,Af,AW,Ah=W.BOTH;switch(Ad){case z.AE:Ae=!!AX.a;break;case z.AQ:case z.AC:case z.AL:Ae=!!(AX.fm&&AX.fm.did);Ab=Ae?AX.fm.dtp:null;break;case z.MQ:case z.MC:Ae=!!AX.m;Ab=Ae?M.METRIC_DTP:null;Ah=AY.fnTypePulldown.getSelectedItem().v;break;}if(!Ae){return ;}var Ag=o[Ab];if((this.lastEt!==Ad)||(this.lastFnDtp!==Ag)||(this.lastFnTypeToDisplay!==Ah)){this.lastEt=Ad;this.lastFnDtp=Ag;this.lastFnTypeToDisplay=Ah;var Aa=Ad?x[Ad]:null,AZ=Aa&&Aa.key;Af=(AZ&&Ac[AZ])||Aa.def||[];if(typeof (Af)==="object"){Af=Af[Ag]||Af["*"];}if(Ah!==W.BOTH){Af=P.filter(Af,function(Ai){var Aj=Ai.tp===n.PER||Ai.tp===n.RANK;return Ah===W.RANK_PERCENTAGE?Aj:!Aj;});}AW=AK(AX.fn,AX.fnt||1);AW=P.filterOne(Af,function(Ai){return Ai.did===(AW&&AW.did);});q(this,Ae,Af,AW);if(!AW){this.set("selectedIndex",0);}}this.parent.updateScrollbars();}})];return{alias:"fn",children:AQ,updateColumnContainer:function AV(){var Ae=this.parent,Aa=Ae.parent,AZ=Aa.model,Ab=AZ&&AZ.fn,Ad=AZ&&AZ.fnt,Ac=AZ&&AZ.et,AY=this.next,AX=Ab===a.IS_NULL||Ab===a.IS_NOT_NULL,AW=(Ac===z.MC||Ac===z.MQ);this.changeFnTypePdVisibility(AW);if(AW){this.fnTypePulldown.getPopupList().singleSelectByField((Ad===n.RANK||Ad===n.PER)?W.RANK_PERCENTAGE:W.VALUE,"v");}else{this.fn.update();}if(Ab&&AX){Ae.removeTrailingContainer(this.idx);}else{if(Ab&&!(AY&&AY.c0)){Ae.insertAndRemoveTrailing(this.idx,AT.getC0NodeProps());}}AY=this.next;if(AY){AY.updateColumnContainer();}},changeFnTypePdVisibility:function AS(AX){this.fnTypePulldown.set("visible",AX);var AW=AE-AN-R;if(AX){AW-=(R+K);}this.fn.set("height",AW+"px");},setupScrollNodes:function AR(){this.scrollNode=null;}};},getC0NodeProps:function O(){return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},k({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},k({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false},h({scriptClass:"mstrmojo.ui.CheckList",alias:"fm2",fmPost:2,itemIdField:"did",filter:false,multiSelect:false,minimumSelectCnt:0,hasDummyLabel:false,height:AE-R*4-K*2-AN+"px",onchange:function AP(AS){e.call(this,AS,"fm2");}})],updateColumnContainer:function AR(){this.c0.update();var AT=this.parent,AW=AT.parent,AX=AT.parent.model,AY=AX&&AX.fn,AV=AY===a.BETWEEN||AY===a.NOT_BETWEEN||AY===S.BETWEEN||AY===S.BETWEEN_DESCENDING,AS=AY===a.EQUAL||AY===a.NOT_EQUAL||AY===a.GREATER||AY===a.GREATER_EQUAL||AY===a.LESS||AY===a.LESS_EQUAL;this.browseLink.set("visible",AW.objectBrowsingEnabled&&AJ(AX,AW.ets));this.btwn.set("visible",AV);var AZ=this.c1;AZ.set("visible",AV);if(AV){AZ.update();}else{if(AX.c1){AX.edit("c1",{v:null,dtp:null,skipET:true},true);}}if((!AX.a)&&AX.m&&this.domNode){X.addClass(this.domNode,"lastStage");}var AU=this.fm2;if(AX.a2&&AS){AU.update();AU.set("visible",true);}else{AU.set("visible",false);}E.call(this);},setupScrollNodes:function AQ(){this.scrollNode=null;}};},browseObjs:function AA(AU,AT,AW){var AS=Y.position(AU.parent.containerNode);AW=AW||{};AW.x=AS.x+40;AW.y=AS.y;this._super(AU,AT,AW);var AQ=AU.ob.browser,AP=AU.parent.opener.docModel,AR=AT.alias,AV=AU.model.et;AP.controller.rootCtrl.loadDataProvider(function(AX){if(AR==="target"||AV===z.AQ){AQ.rootFolder={did:"6F55FB47F9974EABA18CB0C5FF46785C"};}else{if(AV===z.MQ){AQ.rootFolder={did:"E0CCB9CF22104A489CBE78D974AFD19E"};}}AQ.model=AP;AQ.set("dataProvider",AX);AQ.set("opened",true);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.ui.editors.controls.ContextualLink");var E=mstrmojo.hash,F=mstrmojo.array,D=mstrmojo.ui.editors.controls.ContextualLink.LINK_TYPE;mstrmojo._HasContextualLink=mstrmojo.provide("mstrmojo._HasContextualLink",{genGotoTargetMenuConfig:function A(J,I){var G=this.getLinkType(),H,K;if(G===undefined){return{};}if(G===D.ANOTHER_DOSSIER&&(I?I():true)&&!(mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode())){K=mstrmojo.desc(16991,"Go to Dossier: #").replace("#",this.getTargetDossierName());H=this.goToDocument.bind(this,true);}else{if(G===D.THIS_DOSSIER&&this.isLinkedFilterEnabled&&this.isLinkedFilterEnabled()&&(J?J():true)){K=mstrmojo.desc(16992,"Go to Page: #").replace("#",this.getTargetPageName());H=this.handleContextMenuSelectionData.bind(this,true);}}return{menuText:K,handler:H};},genGotoOneClickConfig:function B(K,I){var G=this.getLinkType(),H,L,J;if(G===undefined){return{};}if(G===D.ANOTHER_DOSSIER&&(I?I():true)&&!(mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode())){L=mstrmojo.desc(16991,"Go to Dossier: #").replace("#",this.getTargetDossierName());J=this.getLinkTooltip();H=this.goToDocument.bind(this,false);}else{if(G===D.THIS_DOSSIER&&this.isLinkedFilterEnabled&&this.isLinkedFilterEnabled()&&(K?K():true)){L=mstrmojo.desc(16992,"Go to Page: #").replace("#",this.getTargetPageName());H=this.handleContextMenuSelectionData.bind(this,true);}}return{menuText:L,tooltip:J,handler:H};},hasLink:function(H){var G=this.getLinkType();if(H===undefined){return G!==undefined;}return G===H;},hasDossierLink:function(){return this.hasLink(1);},hasSelectTarget:function(){return this.hasLink(0);},hasLinkTooltip:function(){return this.hasDossierLink()&&E.walk("model.data.doslinkinfo.dtxt",this);},getLinkType:function(){var I=this,L=I.selectorControl||I.findSelectorControl(),G=I.model.data.doslinkinfo,K=L&&L.tks,H=E.walk("parent.getSelectedIFW",this)&&this.parent.getSelectedIFW(),J=!!H&&(K===H);if((!E.isEmpty(L)&&!J)||I.hasAssociatedNodes()){return D.THIS_DOSSIER;}if(!E.isEmpty(G)&&G.tnm&&(G.isAvailable!==false)&&!mstrApp.isExpress&&!(mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode())){return D.ANOTHER_DOSSIER;}return undefined;},getPageName:function(I,H){var G="";F.forEach(I,function(J){F.forEach(J.pages,function(K){var L=K.key.split("--")[0];if(L===H){G=K.name;return false;}});if(G!==""){return false;}});return G;},getTargetPageName:function(){var J=this,G=J.model.docModel,K=J.selectorControl||J.findSelectorControl(),H=K&&K.navPage,I;if(G&&H){I=G.getLayoutUnitDefn(H,G.getLayoutKeyByUnitKey(H));}return I?I.ttl:this.getPageName(G.toc,H);},getTargetDossierName:function(){return E.walk("model.data.doslinkinfo.tnm",this)||"";},getLinkTooltip:function C(){return E.walk("model.data.doslinkinfo.dtxt",this);},getSelection4Linking:function(H){var M=H?"getContextMenuSelectionHash":"getSelectionHash",K=H?this.getContextMenuSelectionType():undefined;if(this.isVisMap){var G=this,I=this.mapViewer,J=[],L;if(I&&typeof I.forEachGraphicLayer==="function"){I.forEachGraphicLayer(function(N){L=N[M]();J=J.concat(G.getSelectionDataTree(L,K,true,N));});}return J;}return this.getSelectionDataTree(this[M](),K,true);},goToDocument:function(G){var I=this,H=this.getSelection4Linking(G);I.controller.onLink(this,I.model.getDossierInfo(H,false));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.ui._HasScroller","mstrmojo.ui.editors.controls.ContextualLink","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.VisUtility","mstrmojo.mobile._MobileVisTooltip");var B=mstrmojo.css,K=mstrmojo.dom,b=mstrmojo.VisUtility,d=mstrmojo.chart.model.enums.EnumDSSBaseFormType,a=mstrmojo.array,l=mstrmojo.func,L=mstrmojo.hash,Z="new-vis-tooltip",C=16,N=12,S=20,h=5,f=20,Y=2,Q=220,o=300,k=120,p="px",R=200,J=mstrmojo.ui.editors.controls.ContextualLink.getLinkTooltip,E=["mouseenter","mouseleave"];function n(q){var t=this.tableNode;K.emptyNode(t);for(var s=0;s<q;s++){t.appendChild(document.createElement("COL"));}return t;}function e(y,t,x){if(b.containsImg(x,y)){t.innerHTML=y;return undefined;}var z,AA,u,q=false;if(x===d.DssBaseFormHTMLTag){u=b.getHTMLAnchorFromHTMLTag(y);if(u instanceof HTMLAnchorElement){q=true;t.innerHTML=y;z=u.innerText;}}if(!q){z=y||"";t.textContent=z;}var w=b.getComputedFontStyle(t),s=Math.ceil(b.measureTextWidth(z,w,w.bonus));if(s>Q){AA=b.truncateTextToLineWithWordWrap(z,w,Q,3,true);if(q){if(t.firstChild){t.firstChild.innerText=AA.text;}}else{t.textContent=AA.text;}t.setAttribute("title",z);}return Math.min(s,Q);}function M(x,w){var t=x.childNodes,z=(w&&w.length)||0,q=0,y=true,s,u;for(s=0;s<z;s++){if(isNaN(w[s])){y=false;t[s].style.width="";}else{u=w[s]+((s<z-1)?C:1);t[s].style.width=u+p;q+=u;}}if(y){x.style.width=q+p;}else{x.style.width="";}}function D(y){var s=this,x,t,q,u,w;if((mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode())||K.isMobile){return ;}if(this.exitFixMode){this.exitFixMode();}if(this.isVisible()){q=function(z,AD){var AC=s.domNode.getBoundingClientRect();var AB=Math.min(Math.abs(AC.left-z),Math.abs(AC.left+AC.width-z));var AA=Math.min(Math.abs(AC.top-AD),Math.abs(AC.top+AC.height-AD));return Math.sqrt(AB*AB+AA*AA);};x=q(y.x,y.y);t=function(){K.detachEvent(document,"mousemove",w,true);K.detachEvent(document,"contextmenu",u,true);s.exitFixMode=null;};w=function(AA){var z=q(AA.clientX,AA.clientY);var AB=30;if(z>x+AB){t();}};u=function(z){if(!K.contains(s.domNode,z.target,true)){t();}};K.attachEvent(document,"mousemove",w,true);K.attachEvent(document,"contextmenu",u,true);K.attachOneTimeEvent(this.domNode,"mouseenter",t);this.exitFixMode=t;}}mstrmojo.NewVisTooltip=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.NewVisTooltip",infoObj:null,link:null,exitFixMode:null,visId:null,hideTooltipHandler:null,domEventListeners:{},markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="new-vis-tooltip-container-wrapper"><div class="new-vis-tooltip-container"><div class="new-vis-tooltip-table"></div></div><div class="new-vis-tooltip-link" mstrAttach:click></div></div></div>',markupSlots:{containerNode:".new-vis-tooltip-container",wrapperNode:".new-vis-tooltip-container-wrapper",linkNode:".new-vis-tooltip-link",tableNode:".new-vis-tooltip-table"},init:function m(q){this._super(q);B.addWidgetCssClass(this,(q&&q.widgetClass)?[q.widgetClass,Z]:Z);},postBuildRendering:function P(){this._super();this.attachListeners();},attachListeners:function U(){this.detachListeners();a.forEach(E,function(q){this.domEventListeners[q]=K.attachMarkupEvent(this.id,this.domNode,q);},this);},setupScrollNodes:function g(){this.scrollNode=this.containerNode;this.scrollbarHostNode=this.domNode;},toggle:function W(q){var s=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=q&&!s?"block":"none";}},isVisible:function F(){return this.domNode&&(this.domNode.style.display!=="none");},hasTableContent:function A(){return this.tableNode;},clearTooltipHandler:function G(){if(this.hideTooltipHandler){clearTimeout(this.hideTooltipHandler);this.hideTooltipHandler=null;}},renderTooltip:function c(s,t,q){if(!s&&!q){return ;}this.toggle(true);if(a.isArray(s)){this.showSimpleInfo(s,t);}else{this.showGridInfo(s,t);}this.renderLink(q,!s);},renderLink:function(s,q){if(s){this.linkNode.innerText=J(s);}B.toggleClass(this.linkNode,"hide",!s||(mstrApp.isWSLocalMode&&mstrApp.isWSLocalMode()));B.toggleClass(this.linkNode,"single",q);},showDossierTtp:function j(t,u,q,s){if(!s&&this.exitFixMode){return ;}if(!this.domNode.parentNode){document.body.appendChild(this.domNode);}this.clearTooltipHandler();if(this.isVisible()&&L.equals(this.infoObj,t)&&L.equals(q,this.link)){this.moveTo(u,true);}else{this.infoObj=t;this.link=q;this.renderTooltip(t,u,q);this.moveTo(u);}if(s){this.enterFixMode(u);}},displayInfo:function I(s,x,w,q,t,u){this.showDossierTtp(s,x,t,u);return this.tableNode;},showSimpleInfo:function H(s){if(!s||s.length<=0){return ;}var u=n.call(this,2),t=document.createElement("tbody"),w=0,q=0;u.appendChild(t);a.forEach(s,function(y){var z=t.insertRow(-1),AA=z.insertCell(-1),x=z.insertCell(-1);if(!y){B.addClass(z,"seperator");}else{B.addClass(AA,"name");w=Math.max(w,e(y.n,AA));q=Math.max(q,e(y.v,x,y.ft));}});M.call(this,u,[w,q]);},showGridInfo:function X(s){var t=s&&s.header,y=s&&s.body,u=(s&&s.bftp)||[],AB=s&&s.attrCount;if(!t||t.length<=0){return ;}var AD=this,AA=t.length,AF=n.call(this,AA),AC=document.createElement("thead"),x=document.createElement("tbody"),z=AC.insertRow(-1),w=[];AF.appendChild(AC);AF.appendChild(x);a.forEach(t,function(AI,AG){var AH=z.insertCell(-1);B.addClass(AH,"header");if(AG>=AB){B.addClass(AH,"metric");}w[AG]=e(AI,AH);});var q=function(){var AG=0;return function(AM){var AI=document.createDocumentFragment();var AK,AL,AN;for(var AH=0;AH<100;AH++){if(AG>=y.length){break;}AK=y[AG];if(AM){AL=x.insertRow(-1);}else{AL=document.createElement("tr");AI.appendChild(AL);}for(var AJ=0;AJ<AA;AJ++){AN=AL.insertCell(-1);if(AG===0){B.addClass(AN,"firstRow");}if(AJ>=AB){B.addClass(AN,"metric");}if(AM){w[AJ]=Math.max(w[AJ],e(AK[AJ],AN,u[AJ]));}else{e(AK[AJ],AN,u[AJ]);}}AG++;}if(!AM){x.appendChild(AI);}return AG<y.length;};};var AE=q();if(AE(true)){this.onScrollEnd=l.throttle(function(){var AG=AD.scrollNode;if(AG.scrollTop+AG.clientHeight>AG.scrollHeight-150){if(!AE()){AD.onScrollEnd=null;}}},100);}M.call(this,AF,w);},moveTo:function(AC,q){if(!AC||isNaN(AC.x)||isNaN(AC.y)||!this.tableNode){return ;}var AE=mstrmojo.dom.position(document.body),AM=this.domNode,t=this.containerNode,AL=this.tableNode,AO=AM.style,u=t.style,s=AE.x+AE.w,AF=AE.y+AE.h,AG=AC.x,AD=AC.y,AB=AG+N,z=AD+S,AH,AK,AP,AA,AJ,AI,AN;if(this.link){AP=b.getComputedFontStyle(this.linkNode);AJ=Math.ceil(b.measureTextWidth(J(this.link),AP,AP.bonus));AI=Math.max(AL.offsetWidth,AJ>o?o:AJ,k-f);}else{AI=AL.offsetWidth;}AH=AI+f+Y;if(AH>AE.w*0.8){AH=AE.w*0.8;}AN=AH<k?(k-AH)/2:0;u.paddingLeft=AN+p;if(AH<k){AH=k;}this.wrapperNode.style.width=AH-f-Y+p;u.width=this.wrapperNode.offsetWidth-2*AN+p;AA=this.link?this.linkNode.offsetHeight:0;AK=AL.offsetHeight+f+Y+AA;if(AK>AE.h*0.8){AK=AE.h*0.8;}u.height=AK-f-Y-AA+p;AH+=h;AK+=h;if(AB+AH<=s&&z+AK>AF){z=AF-AK;}else{if(AB+AH>s&&z+AK<=AF){AB=s-AH;}else{if(AB+AH>s&&z+AK>AF){AB=s-AH;if(AD>=AK+h){z=AD-AK-h;}else{if(AD>AF-AD){z=h;u.height=AD-2*h-f-Y-AA+p;}else{u.height=AF-AD-S-h-f-Y-AA+p;}}}}}AO.left=AB+p;AO.top=z+p;this.updateScrollbars();if(u.overflowY==="scroll"||u.overflowX==="scroll"){if(!q){t.scrollLeft=0;t.scrollTop=0;}}},enterFixMode:D,onmouseenter:function(){this.clearTooltipHandler();},onmouseleave:function(){this.hide(true);},hide:function i(q){if(this.exitFixMode){return ;}var s=this;if(this.isVisible()){if(q){if(!this.hideTooltipHandler){this.hideTooltipHandler=setTimeout(function(){s.toggle(false);},R);}}else{this.clearTooltipHandler();this.toggle(false);}}},onclick:function(){var q=mstrmojo.all[this.visId];if(q){q.goToDocument();this.hide();}},detachListeners:function O(){a.forEach(E,function(q){var s=this.domEventListeners[q];if(s){K.detachEvent(this.domNode,q,s);}},this);this.domEventListeners={};},destroy:function(){this.detachListeners();this.clearTooltipHandler();this._super();}});mstrmojo.NewVisTooltip.enterFixMode=D;if(K.isTouchOptimizationEnabled()){mstrmojo.mixin(mstrmojo.mobile._MobileVisTooltip,mstrmojo.NewVisTooltip.prototype);}}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.SharedXtabBase","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSBaseFormType","mstrmojo.string","mstrmojo.tooltip","mstrmojo.vi.ui.DatasetUnitMenuUtils");var e=mstrmojo.models.template.DataInterface,s=e.ENUM_LOCKED_HEADERS,Y=s.OFF,I=s.BOTH,c=mstrmojo.dom,i=mstrmojo.array,P=mstrmojo.hash,x=mstrmojo.tooltip,p=mstrmojo.vi.ui.DatasetUnitMenuUtils,AC=mstrmojo.string,AB=mstrmojo.EnumRWUnitType,R=mstrmojo.chart.model.enums.EnumDSSBaseFormType,o,M="-1",J=-1;var X=c.isTouchOptimizationEnabled()?["touchstart"]:["click","mousemove","mouseleave","selectstart","touchstart","keydown"];function Q(AH){var AI=c.findWidget(AH),AG=[];while(AI){if(AI.defn&&AI.defn.t===AB.PANEL&&AI.domNode.style&&AI.domNode.style.display==="none"){return AI;}AI=AI.parent;}}function E(AG){return AG&&(AG.show?(AG.items&&AG.items.length||1):0)-1;}mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.SharedXtabBase,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,handleClicks:function F(){return true;},markupString:'<div {@rtlHTML} id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:'+X.join(",")+'><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:I,interactiveCellsArray:null,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,getCellUnitIndex:function l(AG){if(AG.lo!==undefined){return AG.lo;}else{if(AG.o!==undefined){return AG.o;}}return AG._ei;},getCellTitleId:function d(AG){var AH="";if(AG.axis&&AG.ui!==undefined){AH=AG.axis+"A"+(AG.ui+1);}else{if(AG.mix!==undefined){AH="0A"+AG.mix;}}return AH;},getCellTooltip:function m(AT,AP){var AJ=P.walk("controller.model.encodeHtmlContent",this)&&!this.isViewOnly,AM=c.position(AP);if(AJ&&AT.ts===R.DssBaseFormHTMLTag&&!AT.isDynamicLink){return{cssClass:"vi-regular vi-tooltip-C",posType:x.POS_TOPLEFT,content:mstrmojo.desc(19767,"This content has been disabled.##Please contact your administrator.").replace("##","</br>"),top:AM.y-6,left:AM.x+AM.w-6,keepArrowYPos:true,enableHover:true};}var AH=AT._e&&AT._e.oid,AV=!!AH,AL=AT.id,AU=!!AL,AQ,AO,AR,AI,AS,AN,AK,AG;if(AU){AQ=p.getUnitFromDataset(this.model.docModel.datasets,AL);}else{if(AV){AQ=p.getUnitFromDataset(this.model.docModel.datasets,AH,AT._e.otp);}}AO=AQ&&(AQ.dsc||AQ.desc);if(!AO){return null;}if(AT.isObjHeader){AR=AM.y+AM.h+3;AI=AM.x+(AM.w/2);AS=x.POS_TOPCENTER;AN="vi-regular vi-tooltip-A A-center";AK=true;}else{AR=AM.y-6;AI=AM.x+AM.w-6;AS=x.POS_TOPLEFT;AN="vi-regular vi-tooltip-C";AG=true;}return{cssClass:AN,posType:AS,content:'<div class="name">'+AT.v+'</div><div  class="dsc">'+AC.encodeHtmlString(AO,true)+"</div>",top:AR,left:AI,keepArrowXPos:!!AK,keepArrowYPos:!!AG,enableHover:true};},updateTooltipConfig:function AD(AH){var AI=AH.target||c.eventTarget(AH.hWin,AH.e),AG=this.getCellForNode(AI);if(AG){this.richTooltip=this.getCellTooltip(AG,AI);}},update:function j(AI){var AJ=P.walk("data.gsi",AI),AH=function(AK){if(!AK){return ;}if(AK.mx&&AK.mx.length){["cols","rows"].some(function(AL){return AK[AL].some(function(AM){if(AM.did===M){AM.n=mstrmojo.desc(11808,"Metric Names");return true;}});});}};if(!i.isArray(AJ)){AH(AJ);}this.set("gridData",AI.data[0]||AI.data);var AG=this.defn||AI.defn;this.sid=this.gridData.sid;this.treeType=(AG&&AG.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AI);}return true;},preBuildRendering:function C(){var AI=this.gridData,AG=this.height,AH=this.width,AJ=AI.rw;this.usesTouches=this.usesTouches||c.isTouchOptimizationEnabled();this.lockHeadersCase=AI.lhv||Y;this.selections={};this.numRowFixed=!!(!AG&&AJ&&AJ.row&&(AJ.row.bc<AJ.row.tc));this.prepareCP();if(AH){this.widthLimit=parseInt(AH,10);}if(AG){this.heightLimit=parseInt(AG,10);}return this._super();},renderEmptyGrid:function q(){var AJ=this.gridData,AH=this.msgNode,AI=AH.style,AG=this.viewport;AH.firstChild.childNodes[1].innerText=AJ.eg;if(AJ.eg!==""&&!this.excludeData){AI.display="block";AI.overflow="hidden";AH.className="mstrmojo-message";AG.style.display="none";}return true;},postBuildRendering:function S(){var AP=this.gridData,AH=!!this.viewport&&AP,AI=this.msgNode,AM=this.viewport,AJ=AP.gts,AN;if(AP.eg===undefined){if(AI.style.display==="block"){AI.style.display="none";AM.style.display="block";}}else{return this.renderEmptyGrid();}i.forEach(AJ.row,function(AQ){AQ.isObjHeader=true;});i.forEach(AJ.col,function(AQ){if(AQ.otp===-1){i.forEach(AQ.es,function(AR){AR.isObjHeader=true;});}else{AQ.isObjHeader=true;}});if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AH){AP.ghs=AP.ghs||[];AP.gts=AP.gts||[];this._setupZone(AP);this._setupCP(AP);var AK=this.zone;if(AK.parent!==this){this.addChildren(AK);}this.shouldClipLockableXtab=!this.zone.icr.isIncremental;if(this.scrollboxNode){var AL=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AL)&&(AL>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AL;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AO=this.controller.getScrollPosition(this.controller.model.oid+"."+this.gridData.k);if(AO){this.scrollTo(AO);}}AN=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((AH&&this.scrollboxNode&&AP.afc)||this.numRowFixed){this.resizeScrollBox();}this.onGridWidthChanged(AP.afc||AP.afw);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(this.scrollboxNode&&this.scrollboxNode.childNodes&&this.scrollboxNode.childNodes[0]){this.scrollboxNode.style.zIndex=this.scrollboxNode.childNodes[0].style.zIndex;}if(this.lockHeadersCase&&this.initLock){if(this.scrollboxNode.clientWidth===0&&this.scrollboxNode.clientHeight===0){var AG=Q.call(this,this.scrollboxNode.parentNode);if(mstrApp.isExpress&&AG){AG.refreshWhenVisible=true;}}this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AN;},onclick:function n(AH){var AJ=mstrmojo.dom,AL=AH.getTarget(),AK=AL&&AJ.findAncestorByName(AL,"td",true,this.viewport);if(AL.nodeName.toLowerCase()==="a"&&AK.getAttribute("ei")){try{var AI=this.interactiveCellsArray[parseInt(AK.getAttribute("ei"),10)];if(AI&&AI.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AL.href=mstrmojo.addCSRFTokenToURL(AL.href);}}catch(AM){}}if(AK){var AG=AJ.findAncestorByName(AL,"span",true,AK);if(AG&&!AH.shiftKey&&!AH.ctrlKey){this.defaultAction(AK);}else{this.doSelection(AH.e,AH.hWin,AK);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function f(AH,AG){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AG,AH));},onselectstart:function t(AH,AG){if(this.isHandleNode&&this.isHandleNode(AH.getTarget())){c.preventDefault(AG,AH);}return false;},onscroll:function w(){var AG=this.zone.icr;if(AG&&AG.isIncremental){window.clearTimeout(this.scrollingTimeOut);this.scrollingTimeOut=window.setTimeout(function(){this.zone.renderPageInView(true);this._alignHeaders();}.bind(this),100);}else{this._alignHeaders();}if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.controller.model.oid+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function G(){var AJ=this.scrollboxNode,AI=AJ&&AJ.style,AH=this._TB_CELL;if(!AI||!AH){return ;}var AG=this.heightLimit;if(!AG){AI.height="auto";this.scrollboxHeightFixed=false;}else{if(AG>0){AI.height=AG+"px";this.scrollboxHeight=AG;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AF(AH,AK){var AG=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AJ=AH||null,AI=AK||null;if(AJ||AI){if(AG){AG.fixedSizeCanGrowShrink(this,AI,AJ);}}else{if(AG){AG.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function W(){var AN=this.scrollboxNode,AL=AN.scrollWidth+(AN.offsetWidth-AN.clientWidth),AJ=AN&&AN.style,AH=this._TB_CELL;if(this.useTouchScrolling||!AJ||!AH){return ;}var AK=this.widthLimit;if(!AK){var AM=AN.firstChild.style,AI=c.isChrome&&window.devicePixelRatio!==1?0.5:0,AG=AM.position;AM.position="relative";AJ.width="auto";AL=AN.firstChild.firstChild.offsetWidth+(AN.offsetWidth-AN.clientWidth);if(AL>0){AL+=AI;}AN.firstChild.style.position=AG;}if((AL&&(AL>0))&&(!AK||(AK&&(AL<AK)))&&(AN.firstChild.firstChild.offsetWidth>=AN.clientWidth)){AJ.width=AL+"px";}},onGridWidthChanged:function b(AH){if(!AH){this._resizeScrollBoxWidth();}var AG=this.widthLimit;if(!AG){this.width=o;}this._onContainerGrowShrink(AG,null);},getGridDimension:function N(AJ){var AH=1,AI=AJ===AH?"Height":"Width",AK=AI.toLowerCase(),AG=this[AK+"Limit"];if(!AG&&(this[AK]===o||this[AK]===0)){AG=this.viewport["offset"+AI];this[AK]=AG+"px";return AG;}return AG||parseInt(this[AK],10);},_alignHeaders:function B(AG){var AI=this.scrollboxLeft,AH=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AI,AH);}},defaultAction:function O(AL,AH){var AG=AH||this.getCellForNode(AL),AK=AL&&AL.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AK=this.isReselectedTD(AG);if(AK&&this.hasSelectAll&&this.hasSelectAll(AG)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AG;}}var AJ=this.model.getAction(this.getActionCells(AG),AL,AK),AI=AJ&&AJ.h;this._currentSelectedTD=AL;if(AI&&this.controller[AI]){this.controller[AI](this,AJ.a);return true;}return false;},createZone:function h(AH){var AI=AH||{},AG=this._super&&this._super(AI);if(!AG){AG=new mstrmojo.XtabZone(AI);}return AG;},_setupZone:function u(AK){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AG=this.zone;this.zones.origin=AG;AG.rh=AK.rh;AG.autoFitWindow=!!AK.afw;AG.autoFitContent=!!AK.afc;if(!this.isVIXtab){AG.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AG.numColumnCanMerge=AK.gts&&AK.gts.cws?(AK.gts.cws.length-1):0;var AL=[],AI=undefined,AN=null,AJ,AH;mstrmojo.array.forEach(AK.gts&&AK.gts.row,function(AO){AJ=AN&&AN.id===AO.id;if(AJ){AL[AL.length-1]+=AO.fs&&AO.fs.length||1;}else{if(AO.otp===J){AI=0;mstrmojo.array.forEach(AL,function(AP){AI+=AP;});}AL.push(AO.fs&&AO.fs.length||1);}AN=AO;});AG.acws=AL;var AM=e.getGSI(AK.gsi);AG.rowMerge=AM&&AM.prop&&AM.prop.rows&&AM.prop.rows.mg!=="0";AH=AK.ghs&&AK.ghs.chs;this.updateHeaderOffset(AH);AG.mxPos=AI;AG.icr.isIncremental=AH&&AH.cws&&AH.cws.length>AG.icr.limit&&mstrmojo.resolveFeature("use-grid-inc-col-render");},onColHeadersRotated:function k(AG){this.updateHeaderOffset(AG);},updateHeaderOffset:function U(AH){var AG=this.zone;if(AG){AG.headerOffset=E(AH);}},ongridDataChange:function Z(){var AG=this.model;if(AG){AG.set("data",this.gridData);this.initDataBlocks(this.gridData);}},gridPagesRendered:function a(){if(this._super){this._super();}},showDownloadStatus:function L(AG){if(!AG){return ;}if(this.showingStatus){this.numRowsToDownload+=AG;}else{this.numRowsToDownload=AG;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function g(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function H(AJ,AG,AN){var AM=this.gridData.rw,AI=AM.row,AK=AM.col,AL=AI.rm,AH=AI.bc;this.rhsCPList[AJ].isDownloading=this.valuesCPList[AJ].isDownloading=true;if(AH){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AJ*AH+1,AH,AK.bb,AK.bc,this.id,AL,{blockNum:AJ},AG),AN);}},unrender:function D(AG){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AG);},getCellForNode:function AA(AH){var AG=AH&&parseInt(AH.getAttribute("ei"),10);if(isNaN(AG)){return null;}return this.interactiveCellsArray[parseInt(AG,10)];},getActionCells:function K(AG){var AH=[],AJ=this.selections;var AK=AG.axis+"A"+(AG.ui+1),AL=AJ[AK],AI;if(AL&&AL[AG.o]){for(AI in AL){var AM=this.getCellForNode(AL[AI][0]);AH.push(AM);}}else{AH.push(AG);}return AH;},setModel:function AE(AG){this.model=AG;if(AG.data){this.set("gridData",AG.data);}},delegateGridAction:function A(AG,AH){if(this._shouldResponseToAction(AH)){AG(this.zone);}},_shouldResponseToAction:function y(AG){return AG!=="refreshOnDataDownloaded";},destroy:function z(){var AG=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AG&&AG.destroy){AG.destroy();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var Y=mstrmojo.func,S=mstrmojo.hash,P=mstrmojo.array,M=mstrmojo.vi.controllers.UICmdMgr.STATES,J={SHARED:0,SEPARATE:1},N={AND:19,OR:20},e=function e(i,h){var f={},g=function(l,k){var j=[];if(!k){return l;}P.forEach((k||[]),function(m){j.push(m);});P.forEach((l||[]),function(n){var m=P.find(k,"id",n.id);if(!~m){j.push(n);}});return j;};S.forEach(h,function(j,k){f[k]=j;});S.forEach(i,function(j,k){f[k]=g(j,h[k]);});return f;},D=function D(f){var g=[];S.forEach(f,function(h){g.push({ft:N.AND,d:h});});return g;},K=function(g){var f={},h=function(i){var j=S.keyarray(i)[0];return{id:j,d:i[j][0]};};S.forEach(g,function(l){var k={},i=h(l),j=k[i.id];if(i.id){if(!j){k[i.id]=j=[];}j.push(i.d);}f=e(f,k);},this);return[{ft:N.OR,d:f}];},C=function C(k,q,p,j){var l=j||this.model,o,g=[],h=mstrmojo.vi.ui.rw.SelectionType,m=true,i=false,n=false,f=this;if(!q){q=this.getSelectionType();}if(!S.isEmpty(k)){if(q===h.METRICS){o=D.call(this,k);}else{o=K.call(this,k);}}S.forEach(o,function(s){m=false;var t=[];S.forEach(s.d,function(x,AC){var AB;if(p){AB=j?j.supportsDSLKViewFilter(AC):l.supportsDSLKViewFilter(AC);}else{AB=j?j.supportsViewFilterActions(AC):f.isSupportViewFilterForSelection(AC);}if(AB){i=true;var y=[],u=x.reverse(),AA={id:AC,elems:y,fm:x[0].fm,v:P.map(u,function(w){return w.n;})},z=l.getObjectInfo(AC);if(z){AA.t=z.t;AA.st=z.st;if(f.isVIXtab&&q===h.ATTS&&f.model.isRecursiveAttribute(z.did)){n=true;}if(z.st===12033){AA.attId=z.attId;}}P.forEach((u||[]),function(w){y.push(w.id);});t.push(AA);}});if(t.length){g.push({ft:s.ft,d:t});}});g.hasElements=i;g.clearSelections=m;g.isRecursiveAttribute=n;return g;},F=function F(h){var f=this.getContextMenuSelectionType(),g=[];g=C.call(this,h,f);return g;},b=function b(m,o,g){var l=this.selectorControl,i,h,n,k=this,j,f;if(l){if(m.clearSelections||m.hasElements){i=this.controller;if(o){h=i.model;f=l.navPage;j=h.getLayoutKeyByUnitKey(f);this.clearSelections();this.setSelectionCache();}l.exp=null;if(i.onGridSelector){n=function(){i.onGridSelector(k,{type:mstrmojo.EnumRWUnitType.GRID,ck:l.ck,tks:l.tks,cgb:S.valarray(l.cgb),ctlKey:l.ckey,sliceId:this.sid,isBranch:g,isUConDS:l.isUConDS,isNavigation:o,layoutKey:j,panelKey:f,ct:l.ct,anchor:S.walk("event.target",window),selections:m});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(i.cmdMgr.state===M.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(i.cmdMgr.state!==M.BUSY){window.clearInterval(k.multiUnitCtrlInterval);if(!k.destroyed){k.multiUnitCtrlInterval=null;n();}}},1000);}else{n();}}}}},B=function B(h){var f={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:h},g=function(i,j){if(parseInt(i.fn,10)===22&&parseInt(j,10)===19){f.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}P.forEach((i.nds||[]),function(k){g(k,i.fn);});};g(h,null);return f;},c=function c(){return this.parent.model.getCurrentLayoutDef().cgbMap;},O=function O(){var f=c.call(this),g=[];S.forEach(f,function(i,h){if(this.k===i){g.push(h);}},this);return g;},d=function d(){var f=this.controller&&this.controller.cmdMgr;if(f&&f.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,_previousSelection:null,multiUnitCtrlInterval:null,postBuildRendering:function Z(){if(this._super){this._super();}var f=mstrApp.isInVFConfigMode||this.isCustomSort?null:this.findSelectorControl();if(d.call(this)){this.clearSelections();}if(f&&!f.isNavigation&&!S.isEmpty(f.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(f.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},getSelectorDataFromExpression:B,getSelectionDataTree:C,getContextMenuSelectionDataTree:F,deleteSelectorControl:function E(){if(this._super){return this._super();}this.throwAbstractMethodError("deleteSelectorControl");},findSelectorControl:function X(){if(this._super){return this._super();}this.throwAbstractMethodError("findSelectorControl");},handlesMultiSelection:function H(f){return(this._super&&this._super(f))||!!this.selectorControl;},isSupportViewFilterForSelection:function I(g){var f=this.model;return f.supportsViewFilterActions(g);},isLinkedFilter:function(){var f=this.findSelectorControl&&this.findSelectorControl();return f&&f.isNavigation;},isLinkedFilterEnabled:function(){return this.isLinkedFilter()&&this.getContextMenuSelectionHash&&!S.isEmpty(this.getContextMenuSelectionHash());},handleContextMenuSelectionData:function G(g,f){this.isNavigation=g;this.isBranch=f;this.onContextMenuSelectionChange(this.getContextMenuSelectionHash&&this.getContextMenuSelectionHash());},onSelectionChange:function Q(g){var k=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),j=false,i=this.isNavigation,h=(typeof this.getVisType==="function"?this.getVisType():{}).s;if(i){delete this.isNavigation;}if(this._super){j=this._super(g);}if(!i&&this.isLinkedFilter()){return true;}if(k.length>0){this.singleUnitSelect();j=true;}else{if(!!this.selectorControl&&!this.isCustomSort){if(S.equals(g,this._previousSelection)&&!(h==="VisGrid"||h==="VisMultiGrid")){return true;}if(this.hasElementSelection){delete this.hasElementSelection;}this._previousSelection=S.clone(g);var f=C.call(this,g);b.call(this,f,i,f.isRecursiveAttribute&&this.selectionContainsOnlyLeafNode&&!this.selectionContainsOnlyLeafNode());return true;}}return j;},onContextMenuSelectionChange:function L(h){var k=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),j=false,i=this.isNavigation,f=this.isBranch;if(i){delete this.isNavigation;}if(f){delete this.isBranch;}if(this._super){j=this._super(h);}if(!i&&this.isLinkedFilter()){return true;}if(k.length>0){this.singleUnitSelect();j=true;}else{if(!!this.selectorControl){var g=F.call(this,h);b.call(this,g,i,f);return true;}}return j;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function W(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function a(f){if(this.selectorControl){return true;}if(this._super){return this._super(f);}return false;},getFilterType:function R(){return this.defn.ins||J.SHARED;},switchFilterType:function U(s){var m=this,q,n=m.getFilterType(),k=m.parent.model,j,i={actions:[]},t,h=c.call(m),f,l=false,o,x,p,w,g;if(n!==s){q=O.call(m);o=k.getCurrentLayoutDef().units;if(q.length&&n===J.SHARED){t=P.filterOne(q,function(y){x=o[y];if(x){p=x.scs||[];return true;}j=k.getSourceControls(m.parent,y);p=j;return j.length;});if(!j||!j.length){j=k.getSourceControls(m.parent,t);j=P.filter(j,function(y){w=y.control.key;return !P.find(p,"ckey",w);});p=p.concat(j);}P.forEach(p,function(y,z){if(z!==0){f=k.getNextKey();h[f]=m.k;i.actions.push(k.redoFilterAssociations(true,y.ckey||y.control.ckey,y.pnk||y.sourceKey,m.k,t,f));l=true;}}.bind(m));}else{g="";P.forEach(q,function(y){x=o[y];if(!x){j=k.getSourceControls(m.parent,y);x=j.length&&j[0];if(!x){return true;}x.pnk=x.sourceKey;x.ckey=x.control.ckey;}if(!g){g=y;}else{delete h[y];p=(x.scs&&x.scs[0])||x;i.actions.push(k.redoFilterAssociations(false,p.ckey,p.pnk,m.k,y,g));l=true;}}.bind(m));}i.actions.push(k.getUnitFormatAction(m,1,{FormattingSelector:{IndependentNodeSelector:s}},true));var u=false;i.callback=({success:function(){m.defn.ins=u?n:s;u=!u;}});if(l){i.callback=Y.wrapMethods(i.callback,k.getRebuildCallback());}}i.extras={style:{params:{treesToRender:3}}};return i;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.array","mstrmojo.hash","mstrmojo.VisEnum");var B=0,I=mstrmojo.array,J=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,a=mstrmojo.models.FormatModel,H=a.ENUM_PROPERTY_NAMES.TEXT_ALIGN,N=mstrmojo.hash,b=B,R=B,L=mstrmojo.VisEnum.SERVER_JSON_ERROR_TYPE,Y=mstrmojo.vi.ui.TextAlignButtonBar.TEXT_ALIGN;function O(h,c,e,i,f){var d=h===this.getTitleFormatCode(),g;if(e===H){g=function(j){return this.titleAlignButtonBar.items.filter(function(k){return k.v===j;})[0].id;}.bind(this);}this.getHost().parent.changeUnitFormats(d,h,c,e,i,f,g,function(j){this.raiseEvent({name:"BEMFormatChange",propertyName:e,value:j,isTitle:d});}.bind(this));}function X(d,e){var c=new mstrmojo.vi.ui.TextAlignButtonBar({includeJustify:false});this.titleAlignButtonBar=c;c.singleSelect(c.items.map(function(f){return f.id;}).indexOf(d));c.onValueChange=function(g,f){e(H,g,f);};return c;}function C(f){var k=this.getHost(),i=k.getFormats(),l=i.ttl,e=k.hideTitleCtrl&&k.hideTitleCtrl(),j=[];if(l&&!e){var g=this,c=O.bind(this,this.getTitleFormatCode(),i),d=k.parent.getTitleBarVisibility(),h=[this.getCharacterGroup(c,l),X.call(this,a.getFormatBlockValue(l,H),c),this.getContainerGroup(l,c,J.FILL_COLOR+J.FILL_ALPHA,{showBackgroundNoFill:true})];h.forEach(function(m){m.set("enabled",d);});j.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(4756,"Title")),this.getCheckboxAndLabel(d,mstrmojo.desc(13599,"Show Title Bar"),function(n){var m=g.getHost();if(m){m.parent.toggleTitleBar(!!n);}})].concat(h),{cssClass:"bem-tc-title",showDivider:false}));}j.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11917,"Container")),this.getContainerGroup(i,O.bind(this,this.getContainerFormatCode(),i),this.getContainerCtrlFlags(),{showBackgroundNoFill:true,showBorderNoFill:true})],{cssClass:"bem-tc-container"}));this.replaceChildControls(f,j.concat(this.getTitleAndContainerControls()));}function D(c){var e=this.getTargetPulldownItems(c);var d=this.getPulldown(e,function(f){if(e.length>1){b=f;}else{b=R;}e[e.map(function(g){return g.v;}).indexOf(f)].h(f);if(c&&c.postUpdateFn){c.postUpdateFn();}});if(d.items&&d.items.length){d.set("selectedIndex",Math.max(e.map(function(f){return f.v;}).indexOf(b),0));}return d;}mstrmojo.vi.models.editors.BaseEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.BaseEditorModel",titleAlignButtonBar:null,init:function U(c){this._super(c);R=this.getInitialTarget(b);b=R;},selectTargetByValue:function P(c){if(c!==undefined){var d=this._targetPulldown;if(d){d.selectItemByField("v",c);}}},getInitialTarget:function Z(){return B;},getEditorContents:function S(c){var d=this.getEditorGroup([],{cssClass:"bem-dynamic-grp",showDivider:false,isNested:true,isContainer:true,postUpdateFn:c});var g=this._targetPulldown;if(g&&"function"===typeof g.destroy){I.removeItem(this.disposables,g);g.destroy();}var f=this._targetPulldown=D.call(this,d),e=[d].concat(this.getCommonControls());if(f.items.length>1){e.unshift(this.getEditorGroup([f]));}this.addDisposable(f);return e;},getFormattingToolbar:function F(d,i,e){if(d===B){var h=this.getHost(),c=h.getFormats(),g=c.ttl;if(g){g=N.copy(g);if(!this.titleAlignButtonBar){this.titleAlignButtonBar=new mstrmojo.vi.ui.TextAlignButtonBar({includeJustify:false});}g[H]=this.titleAlignButtonBar.items.filter(function(j){return j.id===g["text-align"];});g[H]=g[H].length>0?g[H][0].v:Y.LEFT;var f=new mstrmojo.ui.editors.CharacterToolbarPopup(N.copy({onGroupValueChange:O.bind(this,this.getTitleFormatCode(),c),textAlignJustify:false,textAlignFmtName:H,anchorElement:i},e));f.setFormatSource(g);return f;}}return null;},getCommonControls:function E(){return[];},getContainerCtrlFlags:function A(){var c=this.isContainerPositionSizeEnabled();return J.FILL_COLOR+J.BORDER+(c?J.SIZE_POSITION:0)+J.FILL_ALPHA;},getTitleAndContainerControls:function W(){return[];},getTargetPulldownItems:function G(d){var f=this.getHost(),c=f.getFormats(),e=[];if(c&&(f.showTitleAndContainerFormats!==false)&&!mstrApp.isInVFConfigMode){e.push({n:mstrmojo.desc(12049,"Title and Container"),v:B,h:C.bind(this,d)});}return e;},getTitleFormatCode:function K(){return 2;},getContainerFormatCode:function M(){return 1;},isNormalOrExcludeAllDataButNotInPauseMode:function Q(e){var c=!e.isEmpty()||e.errorType===L.EMPTY_DATA,d=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();return c&&!d;}});mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE=B;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.TreeBrowserSelector","mstrmojo.DynamicClassFactory","mstrmojo._HasLayout","mstrmojo.ObjectBrowserDataProvider","mstrmojo.ui._HasScroller","mstrmojo.ui.SearchBox","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.vi.ui.theme");var G=mstrmojo.DynamicClassFactory,W=mstrmojo.array,I=mstrmojo.hash,H=mstrmojo.dom,A=mstrmojo.css,j=mstrmojo.string,F=mstrmojo.vi.ui.theme,c=mstrmojo.vi.ui.DatasetUnitMenuUtils,i=[4,12,1,47];var J={n:mstrmojo.desc(15348,"No applicable objects"),t:0},R={n:mstrmojo.desc(15559,"No result matches your search."),t:0};function L(q){var p=[],o=[],w=this._shiftStartIndex,u=this.selectedIndices,t=Math.min(w,q),s=Math.max(w,q);W.forEach(this.items,function(x,y){if(t<=y&&y<=s){if(!u[y]){p.push(y);}}else{if(u[y]){o.push(y);}}});this.addSelect(p);this.removeSelect(o);}function P(){return !mstrmojo.resolveFeature("hide-objects-description");}function Z(p){var o=mstrmojo.vi.enums.EnumDSSAccessRightFlags;return p.acg&&(p.acg&o.DssAccessRightUseFlag)&&(p.acg&o.DssAccessRightExecuteFlag);}function k(p,t){var s=p.itemsContainerNode,q=H.isMetaKey(t.src.hWin,t.src.e),w=H.eventTarget(t.src.hWin,t.src.e),o=-1;if(s&&w){W.forEach(s.childNodes,function(x,y){if(H.contains(x,w,true,x)){o=y;return false;}});}if(o!==-1){var u=p.items[o];if(!q&&!p.selectedIndices[o]){p.tree.clearTreeSelect();}if(W.indexOf(i,u.t)>=0){p.addSelect(o);}return true;}return false;}function d(q,o){var p=this.listSelector;if(p){p[q](this,this.itemsContainerNode,o);}}function M(p,q){var o=false;if(p.itemsContainerNode){W.forEach(p.ctxtBuilder.itemWidgets,function(s){if(H.contains(s.itemsContainerNode,q,s.domNode)){o=true;}});}return o;}mstrmojo.vi.ui.BrowserNodesAvatarContent=G.newComponent(mstrmojo.vi.ui.UnitList,null,{getItemProps:function(q,o){var p=this._super(q,o);p.addCls("isAvatar");return p;}});mstrmojo.vi.ui.TreeBrowserSelector=I.copy({premousedown:function(q,s,o){q.tree._selectNode=H.eventTarget(o.hWin,o.e);},premouseup:function D(AA,o,AC){if(H.isPrimaryMouseBtn(AC.e)){var t=AC.hWin,x=AC.e,y=H.eventTarget(t,x),s=H.shiftKey(AC.hWin,AC.e),AB=AA._shiftStartIndex,u=M(AA,y),z=AA.listMapper.findIndex(AA,o,y);if(z>-1&&!u&&AA.tree._selectNode===y){var q=W.indexOf(i,AA.items[z].t)!==-1;if(s&&AB>-1&&q){AA.rangeSelect(z);}else{AA.toggleSelect(z);if(AA.selectedIndices[z]&&q){AA._shiftStartIndex=z;}}}}}},mstrmojo.TreeBrowserSelector);mstrmojo.vi.ui.TreeBrowser=G.newComponent(mstrmojo.TreeBrowser,[mstrmojo.vi.ui._HasUnitListAvatar],{containerResizable:false,draggable:true,avatarCssClass:"mstrmojo-VIUnitList",rangeSelect:L,_selectNode:null,_shiftStartIndex:-1,blockBegin:1,blockCount:50,getContent:function(p,u){p=p||this;var q=(p===this),o=this,x=function(w){if(q){mstrmojo.css.removeClass(o.domNode,["loading"]);}o.updateTreeContent(p,w);},s=function(w){p.contentRetrieved=true;p.set("items",[o.failItemCreaterFunc()]);mstrmojo.err(w);},t={success:x,failure:s};if(q){mstrmojo.css.addClass(o.domNode,["loading"]);}if(mstrApp.objectsBlockCount){this.blockCount=parseInt(mstrApp.objectsBlockCount,10);}this.getContentThroughTaskCall({isRoot:q,data:p.data,blockBegin:u||p.blockBegin,blockCount:parseInt(mstrApp.objectsBlockCount,10)||o.blockCount},t);},getDragData:function l(p){p.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit();var t=this,u=function(z){W.forEach(z.ctxtBuilder.itemWidgets,function(AA){var AB=H.eventTarget(p.src.hWin,p.src.e);if(AB&&H.contains(AA.itemsContainerNode,AB,true,AA.itemsContainerNode)){t=AA;u(AA);return false;}});};u(this);var q=k(t,p);var w=q?this.getSelectedItems().filter(function(z){return W.indexOf(i,z.t)!==-1;}):null;var o=this.id,s=function s(z){var AC=mstrmojo.all[o],AA=AC.avatar;if(AA){var AB=[AC.avatarCssClass,"hasOwnAvatar",z];AA.className=AB.join(" ");}};return{items:w,item:w&&w[0],src:mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST,setAvatarClass:function x(z){s(z);},setInvalidAvatarClass:function y(){s("icn clsx_sub");}};},getSelectedItems:function(){var o=this.ctxtBuilder,p=[];if(o){W.forEach(o.itemWidgets,function(q){if(q.state===1){p=p.concat(q.getSelectedItems());}});}p=(this._super()||[]).concat(p);return p;},createAvatar:function(q,p){var o=document.createElement("div");this.avatarContent=new mstrmojo.vi.ui.BrowserNodesAvatarContent({items:p.src.data.items});this.avatarContent.render();A.addClass(this.avatarContent.domNode,[F.getThemeClass.call(this)]);o.appendChild(this.avatarContent.domNode);return o;},ondragend:function(o){this._super(o);if(this.avatarContent&&this.avatarContent.destroy){this.avatarContent.destroy();}delete this.avatarContent;},isDragValid:function S(p){var o=p.src.data.items;return(o&&o.length)||this._super(p)||false;},contentRetrieved:false,onvisibleChange:function(){if(!this.contentRetrieved){this.getContent(this);}}});mstrmojo.vi.ui.TreeBrowserNode=G.newComponent(mstrmojo.TreeBrowserNode,[{_mixinName:"newClass"}],{containerResizable:false,draggable:false,_shiftStartIndex:-1,rangeSelect:L,premousedown:function(o){this.tree._selectNode=H.eventTarget(o.hWin,o.e);},premouseup:function(p){if(H.isPrimaryMouseBtn(p.e)){var u=H.isMetaKey(p.hWin,p.e),t=H.shiftKey(p.hWin,p.e),w=H.eventTarget(p.hWin,p.e),x=H.contains(this.itemsContainerNode,w,true,this.domNode),s=x&&M(this,w),q=(this.state===2),o=!q&&(w!==this.stateNode&&w!==this.textNode)&&!x;if(s||this.tree._selectNode!==w){return ;}if((!u&&!t)||this.tree.isSelectedFolder||o){this.tree.clearTreeSelect();}if(o){this.tree.isSelectedFolder=true;}else{if(!x){this.tree.isSelectedFolder=false;}}if(!q&&(w===this.stateNode||w===this.textNode)){this.toggleState();this.tree.updateScroller();H.stopPropogation(p.hWin,p.e);}else{if(x){d.call(this,"premouseup",p);}else{this.handleNodeClicked();}}}},getSelectedItems:function(){var o=this.ctxtBuilder,p=[];if(o){W.forEach(o.itemWidgets,function(q){if(q.state===1){p=p.concat(q.getSelectedItems());}});}p=(this._super()||[]).concat(p);return p;}});function a(q){var p=this;return I.copy(q,{scriptClass:"mstrmojo.vi.ui.TreeBrowser",alias:"contents",slot:"containerNode",isSelectedFolder:false,browserNodeClass:mstrmojo.vi.ui.TreeBrowserNode,noCheckBox:true,itemIdField:"did",useRichTooltip:true,dataProvider:this.dataProvider,listSelector:mstrmojo.vi.ui.TreeBrowserSelector,showTooltip:function u(AE,AA){var AC=AE.target||H.eventTarget(AE.hWin,AE.e),z=H.findWidget(AC),x=z.data;if(x&&x.n){var AD=z.domNode.firstChild,w=function(){var AH=I.walk("anc.items",x),AG=[];W.forEach(AH,function(AI){AG.push(AI.n);});return AG.join(" > ");},AF=w();var AB='<div class="name">'+j.encodeHtmlString(x.n,true)+"</div>"+(AF.length>0?'<div class="path">'+j.encodeHtmlString(AF,true)+"</div>":"")+(x.desc?'<div class="dsc">'+j.encodeHtmlString(x.desc,true)+"</div>":"");var y=H.position(AD);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:AB,top:y.y-4,left:y.x+y.w+6};this.constructor.prototype.showTooltip.call(this,AE,AA);}},updateScroller:function(){p.updateScrollbars();},isBranch:function(w){return w.t===8;},items:null,bindings:{data:"this.parent.rootFolder"},setDimensions:mstrmojo.emptyFn,item2textCss:function o(x){var z={8:"folder",3:"report",12:"attribute",4:"metric",47:"consolidation",1:"custom-group",0:"no-obj"},w=mstrmojo.TreeBrowser.prototype.item2textCss(x)||z[x.t],y=this.parent&&this.parent.highlightItems;if(y&&y.indexOf(x.did)!==-1){w+=" highlight";}return w;},onnodechange:function t(w){this.constructor.prototype.onnodechange.call(this,w);this.parent.onSelectedItemsChange(w);},getTotalSelections:function(){return[];},getContentThroughTaskCall:function s(AD,AA){var w=this.parent,z=AD.data||{fty:w.rootFolderType},y=AD.isRoot,x=w.folderList,AB=AD.blockBegin,AC=AD.blockCount;this.dataProvider.fetchFolderContents({sId:mstrApp.sessionState,browsableTypes:w.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:w.folderLinksContextId||29,blockCount:AC||50},{fid:z.did,fty:z.fty,blockBegin:AB||1},{success:function(AF){var AE=AF.items?AF.items.filter(function(AH){return AH.t===8||Z(AH);}):[];AA.success({items:AE.length?AE:[J],sz:AF.sz,bb:AF.bb,bc:AF.bc});if(y&&!x.initialized){x.set("items",AF.sc);var AG=W.find(AF.sc,"did",AF.did);if(AG!==-1){x.set("selectedIndex",AG);}}x.initialized=true;p.updateScrollbars();},failure:AA.failure});}});}function g(p,q){if(p.state===2){var o=p.data;A.toggleClass(p.textNode,"highlight",o&&(q.indexOf(o.did)!==-1));}else{p.ctxtBuilder.itemWidgets.forEach(function(s){g(s,q);});}}mstrmojo.vi.ui.AllObjectsBrowser=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIAllObjectsBrowser {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="filter"></div><div class="search-box"></div><div class="horizontal-line"></div><div class="mstrmojo-VIPanel-contentContainer"><div style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div></div></div>',markupSlots:{titlebarNode:function m(){return this.domNode.firstChild;},filterNode:function B(){return this.domNode.childNodes[1];},searchBox:function Q(){return this.domNode.childNodes[2];},contentNode:function n(){return this.domNode.childNodes[4].firstChild;},containerNode:function U(){return this.domNode.childNodes[4].firstChild.firstChild;}},title:mstrmojo.desc(5679,"All Objects"),model:null,rootFolder:null,rootFolderType:null,highlightItems:null,allResultsLoaded:false,getObjectSubTypes:function(){var o=[2048,3072,1024];if(!mstrApp.isSingleTier){o.push(12032);o.push(257);o.push(2560);}return o;},layoutConfig:{h:{titlebarNode:"30px",filterNode:"30px",searchBox:"33px",containerNode:"100%"},w:{titlebarNode:"100%",searchBox:"100%",containerNode:"100%"},xt:true},opened:false,dataProvider:null,onSelectedItemsChange:mstrmojo.emptyFn,onopenedChange:function(){if(!this.searchList&&this.opened){var o=this.folderList,p=o.getSelectedItem(),q=this.rootFolder;if(p&&q&&p.did!==q.did){o.initialized=false;}this.addChildren([a.call(this,{ondataChange:function(){if(this.data){this.getContent(this);}},ondblclick:this.dblClickOnNodes.bind(this)}),a.call(this,{alias:"searchList",visible:false,contentRetrieved:true,ondblclick:this.dblClickOnNodes.bind(this)})]);}},reset:function(){if(this.contents){this.removeChildren(this.contents);}if(this.searchList){this.removeChildren(this.searchList);}},dblClickOnNodes:function N(p){var t=p.getTarget(),s=H.findWidget(t).data,q=this.model,o=q.getSelectedViUnit();if(o&&s&&W.indexOf(i,s.t)!==-1){this.dataProvider.loadObjects([s],{success:function(){var u=c.getCfgForAddUnitFromAllObject([s],q.datasets);if(o){o.getZonesModel().addUnitsFromDataSource([s],u.dsid,u.actions,q.getDatasetsUpdateCallback());}}},true);}},getSelectedItems:function K(){var p=this.contents,o=p.visible?p:this.searchList;return o.getSelectedItems();},getLayoutOffsets:function(){return{w:18,h:0};},children:[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",cssClass:"vi-allObjects-tb",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,getLayoutOffsets:function(){return{w:0,h:5};},onclick:function X(){this.close();},close:function(){this.parent.close();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"folderList",initialized:false,getLayoutOffsets:function(){return{w:0,h:9};},onitemSelected:function(o){if(this.initialized){this.parent.set("rootFolder",o);this.parent.obSearchBox.clearSearch(true);}}},{scriptClass:"mstrmojo.ui.SearchBox",slot:"searchBox",alias:"obSearchBox",getLayoutOffsets:function(){return{w:0,h:13};},searchTriggered:function O(x,u){this.text=x;if(!x){this.clearSearch(true);return ;}var w=this.parent,p=w.contents.visible?w.contents:w.searchList,s=p.getSelectedItems(),z=w.folderList,t=this.parent.dataProvider,o=z.items[z.selectedIndex],q=o&&o.did,y=this;s.forEach(function(AA){if(AA.t===8){q=AA.did;return false;}});A.addClass(p.domNode,["loading"]);t.fetchFolderContents({browsableTypes:w.getObjectSubTypes().join(","),includeObjectDesc:true,folderLinksContextId:w.folderLinksContextId||29,blockCount:50,enableQuickSearch:!!(mstrApp.useQuickSearch&&mstrApp.useQuickSearch())},{blockBegin:u||1,fid:q,searchPattern:x,recursive:1},{success:function(AA){A.removeClass(p.domNode,["loading"]);if(y.inputNode.value===x){w.contents.set("visible",false);w.searchList.set("visible",true);var AB=w.searchList||this;if(!u||u<=1){AB.set("items",null);}AB.add(AA.items||[R]);y.parent.allResultsLoaded=AB.items.length>=AA.sz;w.updateScrollbars();}}});},onkeyup:function h(p){var o=p.hWin,q=p.e||o.event;if((mstrApp.useQuickSearch&&mstrApp.useQuickSearch())||((q.keyCode===13||q.keyCode===27||!this.inputNode.value))){this.constructor.prototype.onkeyup.call(this,p);}},postClearSearch:function(){var o=this.parent,q=o.contents,p=o.searchList;if(q){q.set("visible",true);}if(p){p.set("visible",false);}p.parent.allResultsLoaded=false;}}],getDropAvatarIcon:function C(o){return" ";},passToolbarCfg:function E(o){this.titleBar.set("toolbarCfg",o);},updateToolbar:function b(o){o.hasCloseButton=true;o.closeButtonText="";return o;},onhighlightItemsChange:function Y(){var o=this.highlightItems;if(o){g(this.contents,o);g(this.searchList,o);}},setupScrollNodes:function e(){this.scrollNode=this.containerNode;},onscroll:function f(o){var q=this.scrollNode,t=this.obSearchBox,p=this.searchList,s=t.inputNode.value;if(Math.ceil(q.offsetHeight+q.scrollTop)>=q.scrollHeight&&!this.allResultsLoaded){t.searchTriggered(s,p.items.length+(p.blockBegin||1));}if(this._super){this._super(o);}},updateScrollbars:function(){this._super();if(this.scrollNode&&this.hasCustomScrollbar){var p=this.scrollNode,o=H.getComputedScrollbarWidth(p);p.style.marginRight=-o+"px";p.style.paddingRight=o+"px";}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","array","css","hash","color","dom","Editor","Button","Box","Label","num");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown","Checkbox","CheckList");mstrmojo.requiresClsP("mstrmojo.threshold","ColorSlider","ThresholdModel");mstrmojo.requiresClsP("mstrmojo.models","FormatModel");mstrmojo.requiresClsP("mstrmojo.models.template","DataInterface");mstrmojo.requiresCls("mstrmojo.ag.models.template.AgDataInterface");mstrmojo.requiresDescs(16098,16096,16094,16097,16095,16099,16100,16101,16102,16103,16104,2290,16105,16106,16107,16108,5585,7665,7666,7905,7907,7908,7909,7910,12110,12111,16110,16109,16106);var d=mstrmojo.array,A=mstrmojo.css,N=mstrmojo.hash,f=mstrmojo.Button.newWebButton,H=mstrmojo.num,M=mstrmojo.dom,m=mstrmojo.models.FormatModel.getFormatUpdate,E=mstrmojo.vi.viz.EnumVizStyles,P=mstrmojo.vi.viz.EnumVisualizationTemplates,q=mstrmojo.models.template.DataInterface,w=mstrmojo.ag.models.template.AgDataInterface,X=w.WIDGET_PROPS_ENUM,L=4,D=20,C=[{n:mstrmojo.desc(16111,"Sequential"),idx:0},{n:mstrmojo.desc(16134,"Diverging"),idx:14},{n:mstrmojo.desc(16135,"Accessible"),idx:20}],o={BUSINESS_BLUE:1,MARINE_BLUE:2,BUSINESS_TEAL:3,AQUAMARINE:4,EMERALD:5,YELLOW_TO_GREEN:6,TANGERINE:7,HONEY:8,SUNFLOWER:9,BUSINESS_RED:10,RASPBERRY:11,LAVENDER:12,GRAY:13,TROPICAL_JUNGLE:15,ORANGE_AND_TEAL:16,WILD_BERRY:17,TRAFFIC_LIGHTS:18,TEMPERATURE:19,ACCESSIBLE_GOLD_AND_PURPLE:21,ACCESSIBLE_GRAY:22,ACCESSIBLE_ORANGE_AND_TEAL:23};var W=mstrmojo.threshold.ThresholdModel.SLIDER_MODE,I=mstrmojo.threshold.ThresholdModel.FEATURES;var x=null,k=null,J=[{n:mstrmojo.desc(527,"Value"),v:7},{n:mstrmojo.desc(4405,"Lowest"),v:4},{n:mstrmojo.desc(529,"Highest"),v:5},{n:mstrmojo.desc(4406,"Lowest %"),v:1},{n:mstrmojo.desc(4407,"Highest %"),v:2}];var u="#84c87b",y="#ec7b75",G=0;function t(AN){var AJ=this.controller;if(this.isTrend&&this.selectedThreshold===W.COLOR_TREND){var AR=this.compare,AE=AR.compareOption,z=AE.items[AE.selectedIndex];AJ.onSubmitColorTrend(z.v,this.upwardColor,this.downwardColor,this.metricId);return ;}var AB=[],AK=this.colorSlider,AQ=AK.getComp(),AL=AK.getPalette(),AI=this.basedOn.value,AF=this.model,AA=AF.orgThresholds,AD=this.metricId,AC=AA&&AA[AD],AO=this.breakBy.breakByList,AP=AO.items[AO.selectedIndex],AG=AQ.length,AM,AH;if(AK.getReversedValue()){AL=AL.concat().reverse();}for(AM=0;AM<AG;AM++){AH={};if(this.colorSlider.sliderMode===W.IMAGE_BASED){AH.rtp=4;AH.rtxt=AL[AM];}else{AH.fmt=m("bc",AL[AM]);}if(AM>0){AH.flr=H.toLocaleString(AF.getRealValue(AQ[AM-1],AI,AK.minValue(),AK.maxValue()));}if(AM<AG-1||AG===1){AH.ceil=H.toLocaleString(AF.getRealValue(AQ[AM],AI,AK.minValue(),AK.maxValue()));}if(AP&&AP.did!==-1){AH.dmy={did:AP.did,t:AP.t};}AB.push(AH);}AK.resetColorMap();AJ.onSubmitActions(AB,AC,AD,AJ.supportsFeature(I.SHOW_BASED_ON)?this.basedOn.selectedMetric:AD,this.basedOn.value,AN,L);}function h(AJ,AQ){var AF=this.model,Ae=AF.data,AB=AF.thresholds&&AF.thresholds[AJ],AZ=q.getGSI(Ae.gsi,this.setIdx),AO=this.colorSlider,AH=[],Ad=[],AG=[],AL,Ac,AA,AR=this.colorPalettes,AK=this.imageSelector,AX=AR.colorPulldown,Ab=this.typeSelector.typeCheckList,z=AK.imagePulldown,AI=this.basedOn,AE=AI.options,AV=AI.metricsList,AU=this.breakBy.breakByList,AN=this.controller,AT=AN.supportsFeature(I.SHOW_BASED_ON),AS=AQ&&Object.keys(AQ).length>0;O(this,AS);b(this,!AS);p(this,Ab.selectedIndex);if(AB&&AB.length>0){AL=AF.getSimpleThresholdType(AJ);if(AL!==-2){AA=AF.isImageBasedType(AJ);AE.set("selectedIndex",d.find(AE.items,"v",AL));AB.forEach(function(Af){var Ah=N.copy(Af),Ag=Ah.ceil;if(Ag!==Infinity){Ah.comp=AF.getNormalizedValue(Ag,Af.ttp,AO.minValue(),AO.maxValue());}else{Ah.comp=1;}AH.push(Ah);});AH.sort(function(Ag,Af){return Ag.comp-Af.comp;});AH.forEach(function(Af){Ad.push(Af.comp);if(AA){AG.push(Af.rtxt);}else{AG.push(Af.fmt.bc);}});Ab.set("selectedIndex",AA?W.IMAGE_BASED:W.COLOR_BASED);if(AA){Ac=AF.getImageSetName(AG);z.set("selectedIndex",d.find(k,"v",Ac));}else{Ac=AF.getColorScheme(AG);if(Ac==="custom"){this.switchToCustomScheme(Ad,AG);}else{AX.set("items",x);AX.set("selectedIndex",d.find(x,"v",Ac));}}AO.set("baseColor",Ac);AO.setColorComp(Ac,Ad);var AM=AF.isMapReversed(Ac,AG,AA);if((AM!==undefined)&&(AM!==AO.getReversedValue())){AO.reverseMapColor();}if(AT){var AD=AB[0].expr,AP=AD.m||AD.nds[0].m;AV.set("selectedIndex",d.find(AZ.mx,"did",(AP&&AP.did)||AF.metricId));}var Aa;try{Aa=AB[0].expr.nds[0].dmy.uts[0].utgt.did;}catch(AY){}AU.set("selectedIndex",Math.max(0,d.find(AU.items,"did",Aa)));}}else{var AW=Ae.visName,AC;Ab.set("selectedIndex",AS?W.COLOR_TREND:W.COLOR_BASED);AX.set("items",x);if(AW===undefined){AX.set("selectedIndex",o.TRAFFIC_LIGHTS);}else{if(AW===E.HEAT_MAP){AX.set("selectedIndex",o.TRAFFIC_LIGHTS);}else{if(AW===E.NETWORK){AX.set("selectedIndex",o.BUSINESS_BLUE);}else{if(AW===E.ESRI_MAP||AW===E.GOOGLE_MAP||AW===E.MAPBOX){AX.set("selectedIndex",o.MARINE_BLUE);}else{AC=parseInt(N.walk("dz.visProp.fmt.visType",Ae));switch(AC){case P.GRAPHMATRIXVERTICALLINECLUSTERED:case P.GRAPHMATRIXVERTICALLINESTACKED:case P.GRAPHMATRIXVERTICALLINEPERCENT:case P.GRAPHMATRIXVERTICALLINEAUTOMATIC:case P.GRAPHMATRIXHORIZONTALLINECLUSTERED:case P.GRAPHMATRIXHORIZONTALLINESTACKED:case P.GRAPHMATRIXHORIZONTALLINEPERCENT:case P.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case P.GRAPHMATRIXVERTICALAREACLUSTERED:case P.GRAPHMATRIXVERTICALAREASTACKED:case P.GRAPHMATRIXVERTICALAREAPERCENT:case P.GRAPHMATRIXVERTICALAREAAUTOMATIC:case P.GRAPHMATRIXHORIZONTALAREACLUSTERED:case P.GRAPHMATRIXHORIZONTALAREASTACKED:case P.GRAPHMATRIXHORIZONTALAREAPERCENT:case P.GRAPHMATRIXHORIZONTALAREAAUTOMATIC:AX.set("selectedIndex",o.TRAFFIC_LIGHTS);break;case P.GRAPHMATRIXBUBBLECIRCLEMM:case P.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case P.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case P.GRAPHMATRIXBUBBLESQUAREAM:case P.GRAPHMATRIXBUBBLESQUAREMM:AX.set("selectedIndex",o.MARINE_BLUE);break;default:AX.set("selectedIndex",o.BUSINESS_BLUE);break;}}}}}AO.update();if(AT){AV.set("selectedIndex",d.find(AZ.mx,"did",AJ||AF.metricId));}AU.set("selectedIndex",0);}}function R(z){this.parent.colorSlider.set("baseColor",z);this.selectedColor=z;}function U(){return f("",function(){this.parent.parent.colorSlider.reverseMapColor(this.checked);},false,{cssClass:"reverse-btn"});}function F(){var z=this.model,AB=this.basedOn.options,AD=AB.items,AE=isNaN(z.getMetricsMaxValue())||isNaN(z.getMetricsMinValue()),AA=(AE||!this.controller.supportsFeature(I.SHOW_VALUE_ITEM))?J.slice(1):J,AC=AD[AB.selectedIndex];if(AA.length!==AD.length){AB.set("items",AA);AB.set("selectedIndex",Math.max(AA.indexOf(AC),0));}}function O(AB,AD){var AC=AB.compare,AA=AB.Upward,z=AB.Downward;[AC,AA,z].forEach(function(AE){AE.set("visible",AD);});}function b(AA,AE){var AC=AA.colorPalettes,AF=AA.imageSelector,AD=AA.breakBy,AB=AA.basedOn,z=AA.colorSlider;[AC,AF,AB,AD,z].forEach(function(AG){AG.set("visible",AE);});}function p(AG,AK){var AE=AG.model,AH=AG.colorSlider,AB=AG.colorPalettes,AD=AB.colorPulldown,AJ=AG.imageSelector,AC=AJ.imagePulldown,AA=AD.items[AD.selectedIndex],z=k[AC.selectedIndex],AF=AK?z:AA,AL=AK===W.IMAGE_BASED&&!AG.isTrend,AI=AK?AE.getDefaultImages()[0].id:AE.getDefaultColors()[0].id;AB.set("visible",!AK);AJ.set("visible",AL);AH.set("sliderMode",AK);AH.set("baseColor",(AF&&AF.v)||AI);AH.editableBubble.set("visible",false);if(AL&&!AC.selectedIndex){AC.set("selectedIndex",0);}}mstrmojo.threshold.SimpleThresholdEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.threshold.SimpleThresholdEditor",cssClass:"mstrmojo-SimpleThresholdEditor",title:mstrmojo.desc(3647,"Thresholds"),help:"thresholds_editor.htm",model:undefined,controller:undefined,metricId:undefined,metricName:undefined,typeSelector:undefined,basedOn:undefined,breakBy:undefined,colorSlider:undefined,colorPalettes:undefined,imageSelector:undefined,showAdvancedEditorLink:undefined,setIdx:0,init:function s(AB){this._super(AB);this.addContent();var AA=mstrApp.customization.getCustomThresholds(),z=function(AC){return{n:mstrmojo.desc(AC.title,"N/A"),v:AC.id,cls:AC.id};};this.buildColorPulldownItems(AA,z);this.buildImagePulldownItems(AA,z);},initTrendProperties:function c(z){this.upwardColor=z.color_up||u;this.downwardColor=z.color_down||y;this.compareSelection=z.type||G;},buildColorPulldownItems:function i(AA,z){if(!x){x=AA.color.map(function(AB){return z(AB);});}d.forEach(C,function(AB){x.splice(AB.idx,0,{n:AB.n,cls:"title",v:null});});this.colorPalettes.colorPulldown.set("items",x);},buildImagePulldownItems:function l(AA,z){if(!k){k=AA.image.map(function(AC){var AB=z(AC);AB.bc=AC.combinedImageUrl;return AB;});this.imageSelector.imagePulldown.set("items",k);}},getThresholdType:function g(){var z=[{n:mstrmojo.desc(12113,"Color-based"),v:"color",cls:"color"}];return{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"typeSelector",typeCheckList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12112,"Thresholds Type:")},{scriptClass:"mstrmojo.ui.CheckList",alias:"typeCheckList",multiSelect:false,orientation:"h",postselectionChange:function AA(AC){var AD=this.parent.parent,AB=AC.added[0];AD.selectedThreshold=AB;if(AD.isTrend){O(AD,AB===W.COLOR_TREND);b(AD,AB===W.COLOR_BASED);p(AD,AB);if(AB===W.COLOR_TREND){return ;}AD.colorSlider.refresh();}else{p(AD,AB);}},selectedIndex:0,items:z}]};},getColorSelector:function Z(){return[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"colorPalettes",selectedColor:undefined,colorPulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"color-pulldown",alias:"colorPulldown",onitemSelected:function z(AC){R.call(this.parent,AC.v);for(var AB=0;AB<=D;AB++){A.removeClass(this.selectedNode,["C"+AB]);}if(AC.cls){A.addClass(this.selectedNode,AC.cls);}},getPopupListConfig:function AA(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,useRichTooltip:true,showTooltipForLargeText:true,scrollNodeMaxHeight:this.scrollNodeMaxHeight,getItemMarkup:function AD(AG,AE){var AF="item {@cls}";if((M.isFF&&!M.isMac())||M.isEdge){AF+=" scrollbar-fix";}if(AG.cls==="title"){return'<{@tag} class="'+AF+'" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';}return'<{@tag} class="'+AF+'" idx="{@idx}" style="{@style}" title="{@title}"><div class="text">{@en@n}</div></{@tag}>';},listHooks:{select:function AB(AF,AG,AE){if((AG.cls||"").indexOf("title")>-1){AE++;}this.parent.set("selectedIndex",AE);if(this.visible&&this.closeAfterSelection){this.close();}}},getItemProps:function AC(AG,AE){var AF=mstrmojo._IsList.getItemProps.call(this,AG,AE);AF.style=this.parent.itemCssText||"";return AF;}};},selectedIndex:1,items:x},U()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"imageSelector",visible:false,selectedColor:undefined,imagePulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(6369,"Images:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"image-pulldown",alias:"imagePulldown",onitemSelected:function z(AB){R.call(this.parent,AB.v);},getPopupListConfig:function AA(){var AB=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);AB.getItemMarkup=function AD(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="bc" style="{@bc}"></div><div class="text">{@n}</div></{@tag}>';};AB.getItemProps=function AC(AG,AE){var AF=mstrmojo._IsList.getItemProps.call(this,AG,AE);AF.bc="background:url("+AG.bc+");background-size: contain;background-repeat: no-repeat;";return AF;};return AB;},items:k},U()]}];},getBasedOnControl:function n(){return{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"basedOn",value:"",metricsList:undefined,options:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4402,"Based on:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"left-pulldown",alias:"metricsList",onitemSelected:function z(AD){var AC=this.parent,AA=AC.parent,AB=AD.did;AC.selectedMetric=AA.model.basedOnId=AB;AA.colorSlider.resetMinMax();AA.colorSlider.update();AA.colorSlider.updateLabels();F.call(AA);}},{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:3,cssClass:"right-pulldown option",alias:"options",onitemSelected:function z(AC){var AF=this.parent,AB=AF.parent,AE=AB.breakBy,AD=AC.v,AA=AD===7;AF.value=AD;AB.colorSlider.set("selectedOption",AC.v);AE.set("visible",!AA);if(AA){AE.breakByList.set("selectedIndex",0);}},items:J}]};},getBreakByControl:function K(){return{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"breakBy",breakByList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4564,"Break By:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"breakByList"}]};},getAdvancedThresholdLink:function S(){return{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"showAdvancedEditorLink",slot:"buttonNode",text:mstrmojo.desc(4569,"Advanced Thresholds Editor..."),onclick:function z(){var AG=this.parent,AF=AG.breakBy.breakByList,AC=AF.items[AF.selectedIndex].did!==-1,AB=AG.isTrend&&(AG.selectedThreshold===W.COLOR_TREND),AH=function(){AG.colorSlider.unselectAll();AG.close();AG.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;},AA,AE,AD;if(AB){AA=mstrmojo.desc(19945,"Trend color settings will be lost if you switch to the Advanced Threshold Editor. Do you want to continue?");AE={confirmBtn:{t:mstrmojo.desc(212,"Continue"),fn:function(){AG.close();AG.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;AG.controller.openEditor(AG.setIdx);},hot:true},cancelBtn:{t:mstrmojo.desc(2223,"Cancel"),hot:false}};}else{AA=AC?mstrmojo.desc(14160,"Save thresholds definition before proceeding to the Advanced Thresholds Editor? The Break By attribute will be lost."):mstrmojo.desc(14159,"Save thresholds definition before proceeding to the Advanced Thresholds Editor?");AD={cssClass:"save-threshold-warning",buttons:[f(mstrmojo.desc(2827,"Clear"),function(){AH();AG.controller.openEditor(AG.model.setIdx);},false,{cssClass:"nosave"}),f(mstrmojo.desc(2223,"Cancel")),f(mstrmojo.desc(2031,"Apply"),function(){AH();AF.set("selectedIndex",0);t.call(AG,true);},true)]};}mstrmojo.warn(AA,AE,AD);}};},getColorSlider:function Q(){return[{scriptClass:"mstrmojo.threshold.ColorSlider",alias:"colorSlider"},this.getAdvancedThresholdLink()];},getTrendControl:function B(){var AC=this,AD=AC.compareSelection,z=AC.upwardColor,AB=AC.downwardColor;return[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"compare",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(19944,"Compare")},{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:function AA(AE){},alias:"compareOption",selectedIndex:AD,items:[{n:mstrmojo.desc(19948,"The First and Last Points"),v:0},{n:mstrmojo.desc(19949,"The Last Two Points"),v:1}]}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"Upward",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(19947,"Upward")},{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"colorPicker",showGradient:false,selectedValue:z,width:"60px",cssDisplay:"inline-block",postselectedValueChange:function(AE){AC.upwardColor=AE.value;}}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"Downward",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(19951,"Downward")},{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"colorPicker",showGradient:false,selectedValue:AB,width:"60px",cssDisplay:"inline-block",postselectedValueChange:function(AE){AC.downwardColor=AE.value;}}]}];},addContent:function j(){var AA=[];AA=AA.concat(this.getThresholdType(),this.getColorSelector(),this.getBasedOnControl(),this.getBreakByControl(),this.getTrendControl(),this.getColorSlider(),{scriptClass:"mstrmojo.Box",cssClass:"editor-buttons",slot:"buttonNode",children:[f(mstrmojo.desc(221,"Cancel"),function z(){var AB=this.parent.parent;AB.colorSlider.unselectAll();AB.close();}),f(mstrmojo.desc(1442,"OK"),function z(){var AB=this.parent.parent;t.call(AB);AB.colorSlider.unselectAll();AB.close();},true),f(mstrmojo.desc(2031,"Apply"),function z(){var AB=this.parent.parent;t.call(AB,true);AB.colorSlider.unselectAll();},true)]});this.addChildren(AA);},onOpen:function Y(){var AF=this.controller,AE=this.model,AD=AE.data,AK=this.basedOn,AL=AK.options,z=AK.metricsList,AB=this.metricId,AJ=q.getGSI(AD.gsi,this.setIdx),AI=AF.supportsFeature(I.SHOW_IMAGE),AA=AF.supportsFeature(I.SHOW_COLOR_TREND),AG=this.typeSelector.typeCheckList.items,AC=w.widgetPropsToJson(AJ,X.colorTrend),AH=(AC&&AC[0])||{};if(this.colorSlider.editableBubble){this.colorSlider.editableBubble.hideBubble();}if(AG.length>1){AG.pop();}this.isTrend=AA;if(AA){this.initTrendProperties(AH);AG.push({n:mstrmojo.desc(19950,"Color trends"),v:"trend",cls:"trend"});this.compare.compareOption.set("selectedIndex",this.compareSelection);this.Upward.colorPicker.set("selectedValue",this.upwardColor);this.Downward.colorPicker.set("selectedValue",this.downwardColor);}else{if(AI){AG.push({n:mstrmojo.desc(12114,"Image-based"),v:"image",cls:"image"});}}this.typeSelector.refresh();A.toggleClass(this.containerNode,"hideImage",!AI&&!AA);if(AF.supportsFeature(I.SHOW_BASED_ON)){A.addClass(AL.domNode,"right-pulldown");z.set("items",AJ.mx);z.set("visible",true);}else{z.set("visible",false);A.removeClass(AL.domNode,"right-pulldown");}this.breakBy.breakByList.set("items",[{n:mstrmojo.desc(2057,"None"),did:-1}].concat(this.targets.filter(function(AM){return AM.t===12;})));this.showAdvancedEditorLink.set("visible",AF.supportsFeature(I.SHOW_ADVANCED_EDITOR));h.call(this,AB,AH);this.colorSlider.updateLabels();this.domNode.oncontextmenu=function(){if(mstrApp.isSingleTier){return false;}};},onClose:function a(){this.model.cleanUp();this.colorSlider.resetColorMap();},switchToCustomScheme:function e(AH,AB){var AC="custom",AF=this.colorSlider,AE=this.colorPalettes.colorPulldown,AD=AE.items,z=AD.map(function(AI){return AI.v;}).indexOf(AC)!==-1;AH=AH||AF.getComp().concat();if(!AB){var AA=AF.getPalette().concat();AB=AF.getReversedValue()?AA.reverse():AA;}AF.addCustomScheme(AH,AB);if(!z){var AG=N.clone(AD);AG.unshift({n:mstrmojo.desc(2056,"Custom"),v:AC});AE.set("items",AG);}AE.set("selectedIndex",d.find(AE.items,"v",AC));}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.GraphMatrixHelper","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.viz.EnumVisualizationTemplates","mstrmojo.vi.util.ThresholdUtils","mstrmojo.gm.GMEnums","mstrmojo.gmaps.MapEnums","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.gmaps._AreaMapHelper","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.template.DataInterface","mstrmojo.ag.models.template.AgDataInterface","mstrmojo.DocDataService","mstrmojo.expr");var a=mstrmojo,b=a.array,C=a.vi.viz,N=a.gm.EnumGMZoneIds,Z=C.EnumVisualizationTemplates,M=a.gmaps,d=C.GraphMatrixHelper,c=C.EnumDSSDropZones,X=C.KnownVisualizations,J=a.vi.util.ThresholdUtils,k=a.chart.model.enums.EnumDSSObjectType,g=M.EnumGraphicType,H=M.EnumPropertyType,B=M.EnumDefaultShapeFormatStyle,p=a.gm.EnumABLDirection,m=C.MapHelper,o=a.vi.ui.DatasetUnitMenuUtils,F=M.CustomShapeId,Q=mstrmojo.expr,Y=Q.TP,f=mstrmojo.vi.viz.EnumDSSDropZones,l=mstrmojo.models.template.DataInterface,n=mstrmojo.ag.models.template.AgDataInterface,j=mstrmojo.DocDataService.EnumTreesToRender,L="-1";function R(q){return q&&q.getHostModel&&q.getHostModel();}function P(s){var q=false;if(s.t!==4){b.forEach(s.fs||[],function(t){if(t.ftr||t.bftp===1||t.bftp===8||t.bftp===9){q=true;return false;}});}return q;}function D(s,u){var q=s.getHost(),t=q.GMController;if(t){switch(u){case"bp":return t.isBoxPlot;case"wf":return t.isWaterfall;case"hg":return t.isHistogram;default:break;}}return false;}function G(AW,AF,As,AA,AM){var AK=As.dz,AQ=As.gsi||{},Ak=[],Aq=false,u=false,AZ=false,AC=AA.getHost(),Ah=AC.GMController,s=parseInt(Ah.property.hGetPropValue("visType")),AT=s===Z.GRAPHMATRIXGRIDCHART,z=s===Z.GRAPHCOMBINATIONBARAREADUALAXIS,Aj=s===Z.VERTICALDUALAXISLINECHART||s===Z.HORIZONTALDUALAXISLINECHART,AR=AC.getChartStyle()==="NewGraphMatrixVisualizationStyle",AH=D(AA,"bp"),Ao=D(AA,"wf"),Ae=D(AA,"hg"),AG=Ah.isDualAxis,AD=["Reserved","Rows","Columns","XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy"],Aa=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALBARAUTOMATIC:case Z.GRAPHMATRIXHORIZONTALBARAUTOMATIC:return true;default:return false;}},Ab=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALBARCLUSTERED:case Z.GRAPHMATRIXVERTICALBARSTACKED:case Z.GRAPHMATRIXVERTICALBARPERCENT:case Z.GRAPHMATRIXHORIZONTALBARCLUSTERED:case Z.GRAPHMATRIXHORIZONTALBARSTACKED:case Z.GRAPHMATRIXHORIZONTALBARPERCENT:case Z.GRAPHMATRIXVERTICALAREASTACKED:case Z.GRAPHMATRIXHORIZONTALAREASTACKED:case Z.GRAPHMATRIXVERTICALAREACLUSTERED:case Z.GRAPHMATRIXHORIZONTALAREACLUSTERED:return true;default:return false;}},AI=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALBARCLUSTERED:case Z.GRAPHMATRIXVERTICALBARSTACKED:case Z.GRAPHMATRIXVERTICALBARPERCENT:case Z.GRAPHMATRIXHORIZONTALBARCLUSTERED:case Z.GRAPHMATRIXHORIZONTALBARSTACKED:case Z.GRAPHMATRIXHORIZONTALBARPERCENT:case Z.VERTICALSYNCHRONIZEDAXISBAR:case Z.HORIZONTALSYNCHRONIZEDAXISBAR:case Z.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:case Z.GRAPHMATRIXVERTICALLINEAUTOMATIC:case Z.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case Z.VERTICALDUALAXISLINECHART:case Z.HORIZONTALDUALAXISLINECHART:case Z.GRAPHMATRIXVERTICALAREASTACKED:case Z.GRAPHMATRIXHORIZONTALAREASTACKED:case Z.GRAPHMATRIXVERTICALAREACLUSTERED:case Z.GRAPHMATRIXHORIZONTALAREACLUSTERED:return true;default:return false;}},AN=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALBARCLUSTERED:case Z.GRAPHMATRIXVERTICALBARSTACKED:case Z.GRAPHMATRIXVERTICALBARPERCENT:case Z.VERTICALSYNCHRONIZEDAXISBAR:case Z.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:case Z.GRAPHMATRIXVERTICALBARAUTOMATIC:return true;default:return false;}},w=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXHORIZONTALBARCLUSTERED:case Z.GRAPHMATRIXHORIZONTALBARSTACKED:case Z.GRAPHMATRIXHORIZONTALBARPERCENT:case Z.HORIZONTALSYNCHRONIZEDAXISBAR:case Z.GRAPHMATRIXHORIZONTALBARAUTOMATIC:return true;default:return false;}},At=function(Av){return AN(Av)||w(Av);},AY=function(Av){switch(parseInt(Av.visType)){case Z.HORIZONTALSYNCHRONIZEDAXISBAR:case Z.VERTICALSYNCHRONIZEDAXISBAR:case Z.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:return true;default:return false;}},Am=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALLINEAUTOMATIC:case Z.GRAPHMATRIXHORIZONTALLINEAUTOMATIC:case Z.VERTICALDUALAXISLINECHART:case Z.HORIZONTALDUALAXISLINECHART:return true;default:return false;}},AE=function(Av){switch(parseInt(Av.visType)){case Z.GRAPHMATRIXVERTICALAREACLUSTERED:case Z.GRAPHMATRIXVERTICALAREASTACKED:case Z.GRAPHMATRIXHORIZONTALAREACLUSTERED:case Z.GRAPHMATRIXHORIZONTALAREASTACKED:return true;default:return false;}},AX=function(Av){return At(Av)||Am(Av)||AE(Av);},x=function(Ay){var Ax=parseInt(Ay.visType),Av=!Ay.breakByObjects.length&&Ay.metricsDropZone!=="BreakBy",Aw="";switch(Ax){case Z.GRAPHMATRIXVERTICALBARCLUSTERED:case Z.GRAPHMATRIXHORIZONTALBARCLUSTERED:case Z.VERTICALCLUSTEREDSYNCHRONIZEDAXISBAR:case Z.GRAPHMATRIXVERTICALAREACLUSTERED:case Z.GRAPHMATRIXHORIZONTALAREACLUSTERED:Aw=d.PROP_SUBTYPE_CLUSTERED;break;case Z.GRAPHMATRIXVERTICALBARSTACKED:case Z.GRAPHMATRIXHORIZONTALBARSTACKED:Aw=d.PROP_SUBTYPE_STACKED;break;case Z.GRAPHMATRIXVERTICALAREASTACKED:case Z.GRAPHMATRIXHORIZONTALAREASTACKED:Aw=(Ay.subtype===d.PROP_SUBTYPE_PERCENT)?d.PROP_SUBTYPE_PERCENT:d.PROP_SUBTYPE_STACKED;break;case Z.GRAPHMATRIXVERTICALAREAPERCENT:case Z.GRAPHMATRIXHORIZONTALAREAPERCENT:Aw=Av?d.PROP_SUBTYPE_STACKED:d.PROP_SUBTYPE_PERCENT;break;case Z.GRAPHMATRIXVERTICALBARPERCENT:case Z.GRAPHMATRIXHORIZONTALBARPERCENT:Aw=d.PROP_SUBTYPE_PERCENT;break;case Z.GRAPHMATRIXVERTICALBARAUTOMATIC:case Z.GRAPHMATRIXHORIZONTALBARAUTOMATIC:Aw=d.PROP_SUBTYPE_AUTOMATIC;break;case Z.VERTICALSYNCHRONIZEDAXISBAR:case Z.HORIZONTALSYNCHRONIZEDAXISBAR:Aw=(Ay.subtype!=="Automatic"&&Ay.subtype)||d.PROP_SUBTYPE_CLUSTERED;break;}return Aw;},q=function(Av){return Av.shape==="Pie"||Av.shape==="Ring";},Au=function(){var Av=AA.getHost();return Av&&Av.GMController&&Av.GMController.isBubbleOrScatter();},Ap=function(Av,A1,A0,Ax){var Az=Ax||AW;Ak.push({ax:A0?A0:0,act:"addDropZoneUnit",zoneId:Av,datasetId:AF,unitId:Az.did,unitType:Az.t,unitPos:A1||0});Aq=true;AZ=(Av===c.ColorBy);u=(Av===c.AdditionalMetrics);var Ay=AD[Av],Aw=Az.t===4?"TemplateMetric":"TemplateUnit";if(AK[Ay]){if(!AK[Ay][Aw]){AK[Ay][Aw]=[];}Az.ax=A0?A0:0;AK[Ay][Aw].push(Az);}},t=function(Av,Aw){if(Aw){Ak.push({act:"removeDropZoneUnit",zoneId:Av,unitId:Aw.did,unitType:Aw.t});}},Ai=function(Av){Ak.push({act:"addDropZoneUnit",zoneId:Av,unitId:"00000000000000000000000000000000",unitType:0});},AO=new C.GraphMatrixHelper({data:As}),AB=function(Av){if(!AO.shape){AO.shape=Av;AM=true;}},AJ=function(Av){if(!AO.subtype||AO.subtype!==Av){AO.subtype=Av;if(!AM){delete AK.visProp.fmt.LegendVisibleness;delete AK.visProp.fmt.ShwAllLbl;AM=true;}}},An=function(A2,Av){var A0=(Av===N.XAXIS),A1=A0?A2.rowObjects:A2.columnObjects,Az=A0?A2.columnObjects:A2.rowObjects,Ay=A0?A2.yAxisObjects.slice(1):A2.xAxisObjects.slice(1),Ax=Ay.concat(Az).concat(A1),Aw=Ax[Ax.length-1];if(Aw){Ap(c.BreakBy,undefined,undefined,Aw);if(!A2.exists(AW,"colorByObjects")&&!AA.isMetricZone(c.ColorBy)){Ap(c.ColorBy,undefined,undefined,Aw);}}},Ad=function(Ax,Av,Aw){if(AX(Ax)&&!AY(Ax)&&!Aj){if(AI(Ax)&&!Ax.breakByObjects.length){Ai(c.BreakBy);}else{Ai(Av);}}else{Ai(Aw);}},AL=function(Ay,A3){var A5,A4=AD[Ay],A2=AK[A4]||[],Az=A2.TemplateMetric?A2.TemplateMetric.length:0,A1=!AO.breakByObjects.length,A8=AA.getHost(),A6=A8.GMController,Av,A7=!z,Ax=A6.getChartInfo(),Aw={dndGM:false};if(z||AG||Aj){A6.shallWeUseGroupInfo=true;}if(!AO.metricsDropZone){if(Ay===c.XAxis&&AO.xAxisObjects.length){Ad(AO,c.Rows,c.Columns);}else{if(Ay===c.YAxis&&AO.yAxisObjects.length){Ad(AO,c.Columns,c.Rows);}}}if(A6.shallWeUseGroupInfo){if(Aj||z){Av=AA.fillGroupInfo(Aw,A6.getGroupInfo(),AW.did,false,false,true);for(var A0=0;A0<Av.length;A0++){if(Av[A0][0]===AW.did){A5=0;break;}if(Av[A0][1]===AW.did){A5=1;break;}}}else{Av=!z||!Az?A6.getGroupInfo():A6.getDummyGroupInfo();if((Ax.dirc===p.VERTICAL&&Ay===c.YAxis)||(Ax.dirc===p.HORIZONTAL&&Ay===c.XAxis)){Av=AA.fillGroupInfo(Aw,Av,AW.did,A5?false:true,A7);}}A6.setGroupInfo(Av);AM=true;}Ap(Ay,A3,A5);if(Ab(AO)&&!Az&&A1){An(AO,Ay);}};AO.setData(As.dz);AO.setMetricsDropZone(As.dz);AO.visType=Ah.property.hGetPropValue("visType");if(AW.t===k.DssTypeMetric){if(Ae){if(!AO.yAxisObjects.length){Ap(c.YAxis);}else{t(c.YAxis,AO.yAxisObjects[0]);t(c.AdditionalMetrics,AO.tooltipMetrics.filter(function(Av){return Av.t===k.DssTypeMetric;})[0]);Ap(c.YAxis);}}else{if(AT){var AP=!AO.colorByObjects.length?c.ColorBy:(!AO.sizeByObjects.length?c.SizeBy:c.AdditionalMetrics);if(AP!==c.AdditionalMetrics||(!AO.exists(AW,"colorByObjects")&&!AO.exists(AW,"sizeByObjects"))){Ap(AP);if(AP===c.ColorBy&&AW.t===4){var Ac=J.getDefaultGMThreshold(Z.GRAPHMATRIXGRIDCHART);J.addThresholds(AC.model,AC,AC.node,AW,Ak,Ac.colors,Ac.ranges,false);}}}else{if(AO.exists(AW,"yAxisObjects")||AO.exists(AW,"xAxisObjects")||AO.exists(AW,"sizeByObjects")||AO.exists(AW,"colorByObjects")||AO.exists(AW,"angleObjects")){var AS=!AO.exists(AW,"yAxisObjects")&&!AO.exists(AW,"xAxisObjects");if(AS&&(!AO.yAxisObjects.length||AO.yAxisObjects[0].t===4)){AL(c.YAxis);}else{if(AS&&(!AO.xAxisObjects.length||AO.xAxisObjects[0].t===4)){AL(c.XAxis);}else{if(!AO.angleObjects.length&&q(AO)){Ap(c.Angle);}else{if(!AH&&!AO.colorByObjects.length&&AO.secondaryMetricsDropZone!=="ColorBy"){Ap(c.ColorBy);}else{if(!AO.sizeByObjects.length||(!AO.exists(AW,"sizeByObjects")&&Au())){Ap(c.SizeBy);}}}}}}else{if(!AH&&!AO.angleObjects.length&&q(AO)){Ap(c.Angle);}else{if((!AO.yAxisObjects.length)&&(!AO.xAxisObjects.length)){if(w(AO)){Ap(c.XAxis);}else{Ap(c.YAxis);}if(!AH&&!Ao){AB(d.PROP_SHAPE_BAR);}}else{if(AO.yAxisObjects.length&&!AO.xAxisObjects.length){if((AH||Ao)&&AO.yAxisObjects[0].t===4){AL(c.YAxis);}else{if(!AO.exists(AW,"yAxisObjects")){if((AX(AO)||z)&&AO.yAxisObjects[0].t===4){AL(c.YAxis);if(z&&(AO.metricsDropZone!==d.PROP_COLUMNS&&AO.metricsDropZone!==d.PROP_ROWS&&(!AO.colorByObjects.length||AO.colorByObjects[0].t!==4))){Ai(c.ColorBy);}}else{AL(c.XAxis);}if(!AH&&!Ao){AB(AA.isMetricZone(c.YAxis)?d.PROP_SHAPE_CIRCLE:d.PROP_SHAPE_BAR);}}}}else{if((!AO.yAxisObjects.length)&&AO.xAxisObjects.length){if((AH||Ao)&&AO.xAxisObjects[0].t===4){AL(c.XAxis);}else{if(!AO.exists(AW,"xAxisObjects")){if((AX(AO)||z)&&AO.xAxisObjects[0].t===4){AL(c.XAxis);if(z&&(AO.metricsDropZone!==d.PROP_COLUMNS&&AO.metricsDropZone!==d.PROP_ROWS&&(!AO.colorByObjects.length||AO.colorByObjects[0].t!==4))){Ai(c.ColorBy);}}else{AL(c.YAxis);}if(!AH&&!Ao){AB(AA.isMetricZone(c.XAxis)?d.PROP_SHAPE_CIRCLE:d.PROP_SHAPE_BAR);}}}}else{if((AO.xAxisObjects[0].t!==4)&&(AO.yAxisObjects[0].t===4)&&!AO.exists(AW,"yAxisObjects")&&!AO.exists(AW,"sizeByObjects")&&!AO.exists(AW,"colorByObjects")){AL(c.YAxis);if(AO.metricsDropZone!==d.PROP_COLUMNS&&AO.metricsDropZone!==d.PROP_ROWS&&(!AO.colorByObjects.length||AO.colorByObjects[0].t!==4)){Ai(c.ColorBy);}}else{if((AO.xAxisObjects[0].t===4)&&(AO.yAxisObjects[0].t!==4)&&!AO.exists(AW,"xAxisObjects")&&!AO.exists(AW,"sizeByObjects")&&!AO.exists(AW,"colorByObjects")){AL(c.XAxis);if(AO.metricsDropZone!==d.PROP_COLUMNS&&AO.metricsDropZone!==d.PROP_ROWS&&(!AO.colorByObjects.length||AO.colorByObjects[0].t!==4)){Ai(c.ColorBy);}}else{if((AO.xAxisObjects[0].t===4)&&(AO.yAxisObjects[0].t===4)&&!AO.exists(AW,"xAxisObjects")&&!AO.exists(AW,"yAxisObjects")&&!AO.exists(AW,"sizeByObjects")&&!AO.exists(AW,"colorByObjects")){if(!AH&&!AO.colorByObjects.length&&AO.metricsDropZone!==d.PROP_COLORBY){Ap(c.ColorBy);}else{if(!AO.sizeByObjects.length&&AO.shape!=="Area"){Ap(c.SizeBy);}else{if(AO.xAxisObjects.length===1){AL(c.XAxis);}else{if(AO.yAxisObjects.length===1){AL(c.YAxis);}else{if(AO.sizeByObjects.length===1&&AO.shape!=="Area"){Ap(c.SizeBy);}else{if(!AO.exists(AW,"tooltipMetrics")){Ap(c.AdditionalMetrics);}}}}}}}else{if(!AH&&!AO.colorByObjects.length&&AO.metricsDropZone!==d.PROP_COLORBY){Ap(c.ColorBy);}else{if(!AO.sizeByObjects.length){Ap(c.SizeBy);}else{if(!AO.exists(AW,"tooltipMetrics")){Ap(c.AdditionalMetrics);}}}}}}}}}}if((!u)&&Aq){if(AO.exists(AW,"tooltipMetrics")){var Ar=b.find(AO.tooltipMetrics,"did",AW.did);if(Ar>-1){AO.tooltipMetrics.splice(Ar,1);t(c.AdditionalMetrics,AW);}}}}if(Aq&&AZ){var AC=AA.getHost(),AV=AC.getVisType().vt,Ac=J.getDefaultGMThreshold(AV);J.addThresholds(AC.model,AC,AC.node,AW,Ak,Ac.colors,Ac.ranges,false);}}}}else{if(Ae){Ap(c.XAxis);}else{if((AQ.rows||[]).concat(AQ.cols||[]).some(function(Av){return Av.did===AW.did;})){if(AH&&AO.exists(AW,"breakByObjects")){}else{if(!AO.colorByObjects.length||(AO.colorByObjects[0].t!==4&&!AO.exists(AW,"colorByObjects"))){if(!Aa(AO)&&!AT){Ap(c.ColorBy);}}}}else{if(!AH&&!AO.sliceObjects.length&&q(AO)){Ap(c.SliceBy);if(!AO.colorByObjects.length){Ap(c.ColorBy);}}else{if((!AO.yAxisObjects.length)&&(!AO.xAxisObjects.length)){if(w(AO)){Ap(c.YAxis);}else{Ap(c.XAxis);}if(!AH&&!Ao){AB(P(AW)?d.PROP_SHAPE_LINE:d.PROP_SHAPE_BAR);}}else{if((AO.yAxisObjects.length)&&(!AO.xAxisObjects.length)){if((AH||Ao)&&AO.yAxisObjects[0].t!==4){Ap(c.Rows);}else{if(AO.yAxisObjects[0].t!==4&&(AX(AO)||z)){Ap(c.Rows);}else{Ap(c.XAxis);}if(!AH&&!Ao){AB(P(AW)&&AO.yAxisObjects[0]===4?d.PROP_SHAPE_LINE:d.PROP_SHAPE_BAR);}}}else{if((!AO.yAxisObjects.length)&&(AO.xAxisObjects.length)){if((AH||Ao)&&AO.xAxisObjects[0].t!==4){Ap(c.Columns);}else{if(AO.xAxisObjects[0].t!==4&&(AX(AO)||z)){Ap(c.Columns);}else{Ap(c.YAxis);}if(!AH&&!Ao){AB(P(AW)&&AO.xAxisObjects[0]===4?d.PROP_SHAPE_LINE:d.PROP_SHAPE_BAR);}}}else{if((AO.xAxisObjects[0].t!==4)&&(AO.yAxisObjects[0].t===4)){if(AH&&!AO.breakByObjects.length){Ap(c.BreakBy);}else{if(!AO.colorByObjects.length&&!AH&&!Aa(AO)&&AO.secondaryMetricsDropZone!=="ColorBy"){Ap(c.ColorBy);if(!AO.exists(AW,"breakByObjects")){Ap(c.BreakBy);}}else{if(AI(AO)&&!AO.breakByObjects.length&&AO.metricsDropZone!=="BreakBy"){Ap(c.BreakBy);if(!AO.exists(AW,"colorByObjects")&&!AA.isMetricZone(c.ColorBy)){Ap(c.ColorBy);}}else{Ap(c.Columns);}}}}else{if((AO.xAxisObjects[0].t===4)&&(AO.yAxisObjects[0].t!==4)){if((AH||Ao)&&!AO.breakByObjects.length){Ap(c.BreakBy);}else{if(!AO.colorByObjects.length&&!AH&&!Aa(AO)&&AO.secondaryMetricsDropZone!=="ColorBy"){Ap(c.ColorBy);if(!AO.exists(AW,"breakByObjects")&&AO.metricsDropZone!=="BreakBy"){Ap(c.BreakBy);}}else{if(AI(AO)&&!AO.breakByObjects.length&&AO.metricsDropZone!=="BreakBy"){Ap(c.BreakBy);if(!AO.exists(AW,"colorByObjects")&&!AA.isMetricZone(c.ColorBy)){Ap(c.ColorBy);}}else{Ap(c.Rows);}}}}else{if((AO.xAxisObjects[0].t!==4)&&(AO.yAxisObjects[0].t!==4)){if(w(AO)){Ap(c.Rows);}else{Ap(c.Columns);}}else{if((AO.xAxisObjects[0].t===4)&&(AO.yAxisObjects[0].t===4)){if((AH||Ao)&&!AO.breakByObjects.length){Ap(c.BreakBy);}else{if(!AO.colorByObjects.length&&!AH){Ap(c.ColorBy);if(!AO.exists(AW,"breakByObjects")){Ap(c.BreakBy);}}else{if(!AO.columnObjects.length&&AO.rowObjects.length&&AO.rowObjects[0].t!==4){Ap(c.Rows);}else{Ap(c.Columns);}}}}}}}}}}}}}}var Ag=[];if(Ak.length){if(AR){Ap(c.AdditionalMetrics,AA.getTooltipDropzoneIdx(AW)+1);}var Af=AA.getUpdateTemplateAction(Ak);var y=AA.docModel,AU=y.controller.view.builder,Al=AU.getLayoutVIMap(y.getCurrentLayoutKey()).getComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK);if(Al&&!mstrApp.isInVFConfigMode){Af.partialRetrieval.nodes.push(Al.k);}Ag.push(Af);}if(At(AO)||AE(AO)){AJ(x(AO));}if(AM){Ag.push({act:"setProperty",nodeKey:As.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(AO.getXml(AC))});}if(Ag.length){AA.clearCardinalityFlags();AA.findLargeItemsForAddUnits([AW]);}return Ag;}function E(u,x,w,q){var s,t=true;function y(AC,AE,AB){var AD=q.getZoneModelByZoneId(AC);if(q.getUnitIndexInZone(AD,u)===-1&&(!AB||AB(AD))){var AA=AE?0:AD.items.length;s=q.getAddItemActions(AD,[u],AA,false,AE?AD.items[AA]:null,x);AD.items.push(u);return false;}return true;}function z(AA){return AA.items.length===0;}if(!q.isMetric(u)){t=y(c.ColorBy,false,z);t=t&&y(c.Grouping);if(s){q.clearCardinalityFlags();q.findLargeItemsForAddUnits([u]);}}else{t=y(c.SizeBy,false,z);t=t&&y(c.ColorBy,false,z);t=t&&y(c.SizeBy,true,function(AA){return AA.items[0].did===q.getZoneModelByZoneId(c.ColorBy).items[0].did;});t=t&&y(c.AdditionalMetrics,false,function(){return q.getUnitIndexInZone(q.getZoneModelByZoneId(c.SizeBy),u)===-1&&q.getUnitIndexInZone(q.getZoneModelByZoneId(c.ColorBy),u)===-1;});}return s?[q.docModel.getDataService().getUpdateTemplateAction(q.getHost().k,s)]:[];}function W(t,w,u,q){var s=null,x=!q.isMetric(t)?[c.FromItem,c.ToItem]:[c.ColorBy,c.ItemSize,c.SizeBy];b.forEach(x,function(y){var z=q.getZoneModelByZoneId(y);if(z.items.length===0){s=q.getAddItemActions(z,[t],0,w);z.items.push(t);return false;}});if(s){q.clearCardinalityFlags();q.findLargeItemsForAddUnits([t]);return[q.docModel.getDataService().getUpdateTemplateAction(q.getHost().k,s)];}return[];}function e(AA,w,s,z){var q=null,u=!z.isMetric(AA)?[c.BreakBy,c.Trend]:[c.Metric],y=z.getZoneModelByZoneId(c.Trend);if(o.isTimeAttr(AA)&&y.items.length===0){q=z.getAddItemActions(y,[AA],0,w);y.items.push(AA);}else{for(var t=0;t<u.length;t++){var x=z.getZoneModelByZoneId(u[t]);if(x.items.length===0){q=z.getAddItemActions(x,[AA],0,w);x.items.push(AA);break;}}}if(q){z.clearCardinalityFlags();z.findLargeItemsForAddUnits([AA]);return[z.docModel.getDataService().getUpdateTemplateAction(z.getHost().k,q)];}return[];}function K(t,w,u,q){var s=null,x=!q.isMetric(t)?[c.GeoAttribute,c.Layout]:[c.ColorBy,c.SizeBy,c.AdditionalMetrics];b.forEach(x,function(y){var z=q.getZoneModelByZoneId(y);if((y===c.AdditionalMetrics||z.items.length===0)&&q.isZoneAvalaible(y)){s=q.getAddDropZoneUnitsActions(z,[t],0,{datasetId:w});return false;}});return s?[q.docModel.getDataService().getUpdateTemplateAction(q.getHost().k,s)]:[];}function O(AQ,AC,Ac,u,t,Ae){var AJ=Ac.gsi||{},AY=u.getHost(),w=AY.fnGetWidget(),Aa=w&&w.scriptClass==="mstrmojo.mapbox.VisMapbox",AV=[],AW=false,AR=u.getZoneModelByZoneId(c.GeoAttribute),AE=u.getZoneModelByZoneId(c.Geometry),AB=u.getZoneModelByZoneId(c.Latitude),AX=u.getZoneModelByZoneId(c.Longitude),AO=u.getZoneModelByZoneId(c.ColorBy),z=u.getZoneModelByZoneId(c.SizeBy),AH=u.getZoneModelByZoneId(c.Angle),AF=u.getZoneModelByZoneId(c.SliceBy),AU=u.getZoneModelByZoneId(c.AdditionalMetrics),Ab=false,AA=function(An,Am,Ai,Ao){if(An){var Al=u.getCreateDropZonesAction(Ai);AV=AV.concat(Al.length?u.getUpdateTemplateAction(Al):[]);AV.push(u.getUpdateTemplateAction([{act:"addDropZoneUnit",zoneId:Ai,unitId:An,unitType:Am,datasetId:Ao}]));if(Ai===c.ColorBy){var Ak=J.getDefaultMapThreshold();AV.push(u.getUpdateTemplateAction(J.addThresholds(AY.model,AY,AY.node,AQ,undefined,Ak.colors,Ak.ranges)));}}switch(Ai){case c.GeoAttribute:t.geoAttribute=An;break;case c.Latitude:t.latitude=An;break;case c.Longitude:t.longitude=An;break;case c.Geometry:t.geometry=An;break;case c.SliceBy:if(!t.slice){t.slice=[];}t.slice.push(An);break;case c.ColorBy:t.colorBy=An;break;case c.SizeBy:t.sizeBy=An;break;case c.Angle:t.angle=An;break;case c.AdditionalMetrics:t.tooltip.push(An);break;}var Aj=u.getZoneModelByZoneId(Ai);if(Aj&&b.isArray(Aj.items)){Aj.items.push(AQ);}Ab=true;},AG=function(Ak,Aj,Ai,Al){AA(Ak,Aj,Ai,Al);if(Aa&&m.shouldSyncItemToTooltipZone(Ak,Ai,t&&t.tooltip)){AA(Ak,Aj,c.AdditionalMetrics,Al);}},AI=function(Al,Ak,Ai){if(Al){AV.push(u.getUpdateTemplateAction([{act:"removeDropZoneUnit",zoneId:Ai,unitId:Al,unitType:Ak}]));}switch(Ai){case c.geoAttribute:t.geoAttribute="";break;case c.Latitude:t.latitude="";break;case c.Longitude:t.longitude="";break;case c.Geometry:t.geometry="";break;case c.SliceBy:var Aj=t.slice.indexOf(Al);if(Aj!==-1){t.slice(Aj,1);}break;case c.Angle:t.angle="";break;case c.ColorBy:t.colorBy="";break;case c.SizeBy:t.sizeBy="";break;case c.AdditionalMetrics:t.tooltip=b.filter(t.tooltip,function(Am){return Am!==Al;},{max:t.tooltip.length});break;}},q=function(Ai,Aj){AV.push(u.getUpdateTemplateAction({act:"addForm",unitId:Ai,attFormId:Aj,unitPos:0}));};t.setWidget(AY);b.forEach((AJ.rows||[]).concat(AJ.cols||[]),function(Ai){if(Ai.did===AQ.did){AW=true;return false;}});if(AW){return[];}switch(AQ.t){case Y.METRIC:if(AO&&!AO.items.length){AG(AQ.did,AQ.t,c.ColorBy,AC);}else{if(z&&!z.items.length){AG(AQ.did,AQ.t,c.SizeBy,AC);}else{if(AH&&!AH.items.length){AG(AQ.did,AQ.t,c.Angle,AC);}else{if(AU){var s=AQ.did;if(t.colorBy.indexOf(s)<0&&t.sizeBy.indexOf(s)&&t.angle.indexOf(s)&&t.tooltip.indexOf(s)<0){AG(s,AQ.t,c.AdditionalMetrics,AC);}}}}}break;default:var Af=w.edtModel.getEditingPropertyVal(H.graphicType),x=Af===g.Area,AK=AR?!AR.items.length:true,AN=AB?!AB.items.length:true,AL=AX?!AX.items.length:true,AZ=AE?!AE.items.length:true,AP=AK&&((!x&&AN&&AL)||(x&&AZ)),Ah=m.getGeoForm(AQ,function(Ai){return m.isGeoRoleSupportArea(Ai.fgr);}),AS=m.getLatitudeForm(AQ),AM=m.getLongitudeForm(AQ),AD=m.getGeometryForm(AQ),Ad=function(){var Ai=t.vp,Ak=t.tooltip;if(!m.canShowSizeByZone(Ai)&&t.sizeBy&&Ak.indexOf(t.sizeBy)<0){AG(t.sizeBy,4,c.AdditionalMetrics);AI(t.sizeBy,4,c.SizeBy);}if(!m.canShowColorByZone(Ai)&&t.colorBy&&Ak.indexOf(t.colorBy)<0){AG(t.colorBy,4,c.AdditionalMetrics);AI(t.colorBy,4,c.ColorBy);}if(!m.showAngleZone(Ai)&&t.angle&&Ak.indexOf(t.angle)<0){AG(t.angle,4,c.AdditionalMetrics);AI(t.angle,4,c.Angle);}if(!m.showSliceZone(Ai)&&t.slice&&t.slice.length>0){var Aj=t.slice;b.forEach(Aj,function(Al){AG(Al,12,c.AdditionalMetrics);AI(Al,12,c.SizeBy);});}};if(Aa&&AP&&AD){t.setMapType(g.Area);t.setShapeFile(F);if(Ah){AG(AQ.did,AQ.t,c.GeoAttribute,AC);q(AQ.did,AD.fid);AG(AD.fid,21,c.Geometry,AC);t.setUseAttributeForm(true);}else{AG(AQ.did,AQ.t,c.Geometry,AC);q(AQ.did,AD.fid);t.setUseAttributeForm(false);}t.setBorderStyle(B.BORDER_STYLE);}else{if(AP&&Ah&&!(!x&&(AS||AM))){t.setMapType(g.Area);if(Aa){t.setBorderStyle(B.BORDER_STYLE);}t.setUseAttributeForm(false);AG(AQ.did,AQ.t,c.GeoAttribute,AC);q(AQ.did,Ah.fid);}else{var AT=(Ae&&AQ.card>500)?g.Density:(!x?Af:g.Marker);if(AS&&AM&&AP){AG(AQ.did,AQ.t,c.GeoAttribute,AC);t.setMapType(AT);if(Aa&&AT===g.Marker&&x){t.setBorderStyle(B.BORDER_STYLE_CIRCLE);}t.setUseAttributeForm(true);q(AQ.did,AS.fid);q(AQ.did,AM.fid);AG(AS.fid,21,c.Latitude,AC);AG(AM.fid,21,c.Longitude,AC);}else{if((AS||m.isLatitude(AQ.n))&&(!AM&&!m.isLongitude(AQ.n))&&AK&&AN){AG(AQ.did,AQ.t,c.Latitude,AC);t.setMapType(AT);t.setUseAttributeForm(false);}else{if((!AS&&!m.isLatitude(AQ.n))&&(AM||m.isLongitude(AQ.n))&&AK&&AL){AG(AQ.did,AQ.t,c.Longitude,AC);t.setMapType(AT);t.setUseAttributeForm(false);}else{if(!AS&&!AM&&!Ah&&AF){AG(AQ.did,AQ.t,c.SliceBy,AC);}else{if(t.tooltip.indexOf(AQ.did)<0){AG(AQ.did,AQ.t,c.AdditionalMetrics,AC);}}}}}}}if(Ab){Ad();}break;}if(Ab){AV.push({act:"setProperty",nodeKey:Ac.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(t.getXml())});}if(AV.length){var y=Ac.visName,Af=t.getMapType(),Ag=t.getLayerName();u.addAttributeNameAndTargetVisForAddUnits(Ac,[AQ],y,Af,Ag);u.clearCardinalityFlags();u.findLargeItemsForAddUnits([AQ]);}return AV;}function S(AA,y,x,u,AB,t){var z,q,w,s;z=!!b.filterOne(u,function(AC){return AC.t!==Y.METRIC;});q=!!b.filterOne(AB,function(AC){return AC.t!==Y.METRIC;});w=!!b.filterOne(AB,function(AC){return AC.did==="-1";});if(AA.t===Y.METRIC){s=f.Columns;if(t.length===0){if(!q&&z){s=f.Rows;y.findEstimatedTotalRow([AA],s);}else{x+=u.length;}}else{if(w){y.findEstimatedTotalRow([AA],f.Rows);}}x+=t.length;}else{if(z&&!q){s=f.Columns;x+=u.length;y.findLargeItemsForAddUnits([AA]);y.findTotalColumnCount([AA],null);}else{s=f.Rows;x+=AB.length;y.findEstimatedTotalRow([AA],s);}}return{axis:s,idx:x};}function h(x,t,s,w,u){var q=x?(x.rows||[]).concat(x.cols||[]).concat(x.mx||[]):[];if(t&&(u.length||mstrmojo.array.find(q,"did",s.did)!==-1)){u.push({act:"editNode",nodeKey:w,datasetId:t});}}function i(AQ,AB,AX,AG,AD){var AW=AG.getHost(),AA=AW.model,AK=AG.activeTemplateSet,AJ=AK,AR=AW.gridData.gsi,AI=AD||0,y,q,AF,AH,AM,AS,AP,u,AO,w,AT,t=AQ.t===Y.METRIC,x=true,z=-1,AU=false,AV,s,AC=function(AY){return !n.hasMicrocharts(AY);},AE=[];for(var AN=AR.length-1;AN>=0;AN--){var AL=AR[AN];if(AC(AL)){z=AN;break;}}AU=AJ===-1||z===-1;if(AJ===-1){AJ=z;}y=l.getGSI(AR,AJ)||{};q=y.k;x=AC(y);if(!x){AU=true;}AF=y.rows||[];AH=y.cols||[];AM=y.mx||[];AS=x&&b.find(AF.concat(AH).concat(AM),"did",AQ.did)>-1;AG.clearCardinalityFlags();if(!AS&&!AA.hasSameRecursiveAttributeGroup(AQ)){AP=S(AQ,AG,AI,AH,AF,AM);u=AP.axis;AI=AP.idx;AO=b.find(AF,"did",L);AT=AO>-1;AO=AT?AO:b.find(AH,"did",L);if(t&&AT){AI=AO+AM.length;u=f.Rows;}else{if(AQ.t===Y.ATTR){u=f.Rows;}}if(u===f.Rows){l.forEachGSI(AR,function(AY,AZ){AE.push(AG.getUpdateTemplateAction(AG.getAddAction(AW,AQ,u,AB,AI,AJ,false),AZ));});}else{if(u===f.Columns){if(t){if(AO>0){AI++;}}else{w=b.findLast(AH,"t",Y.ATTR);if(w>-1){AI=w+1;}else{AI=0;}}if(AU){AV=AG.getAddColumnSetAction();AE.push.apply(AE,AV);AJ=AR.length;q=b.filterOne(AV,function(AY){return AY.act==="copyUnit";}).newKey;AG.activeTemplateSet=AJ;}s=AG.getAddAction(AW,AQ,u,AB,AI,AJ,false);if(t&&AU){s.push(AW.model.getValuesDefaultFormatGridZoneAction([AQ],true,q,true));}AE.push(AG.getUpdateTemplateAction(s,q));}}}if(!AX.dataSourceState&&!y.datasetId){h(y,AB,AQ,y.k,AE);}return AE;}function A(AE,x,w,AD,q){var AC=AD.getHost(),AG=AC.model,AB=w.gsi||{},AF=AB.rows||[],z=AB.cols||[],y=AB.mx||[],u=[],s,AA=q||0,t;if(AC.hasArrayGSI){return i(AE,x,w,AD,q);}AD.clearCardinalityFlags();if(b.find(AF.concat(z).concat(y),"did",AE.did)===-1&&!AG.hasSameRecursiveAttributeGroup(AE)){t=S(AE,AD,AA,z,AF,y);s=t.axis;AA=t.idx;u.push({act:"updateTemplate",keyContext:w.k,actions:[AG.getAddTemplateUnitAction(AE,x,s,AA)]});}return u;}var I=function(s,u,t,q){var x=[];var w=q.getActionsForDoubleClick(s,u);if(b.isArray(w)&&w.length>0){x.push(q.getUpdateTemplateAction(w));}return x;};mstrmojo.vi.models.DatasetDoubleClick=mstrmojo.provide("mstrmojo.vi.models.DatasetDoubleClick",{addObject:function(AA,u,y,q){var t=R(y),s=[],x=y.getHost();if(!AA||!t){return s;}var AB=t.visName||"Grid";switch(X.getDefinition(AB).id){case X.GRAPHMATRIX:case X.NEWGRAPHMATRIX:s=G(AA,u,t,y);break;case X.ESRIMAP:case X.GOOGLEMAP:s=O(AA,u,t,y,new C.MapHelper({data:t}),true);break;case X.MAPBOX:s=O(AA,u,t,y,new C.MapHelper({data:t}),false);break;case X.HEATMAP:s=E(AA,u,t,y);break;case X.NETWORK:s=W(AA,u,t,y);break;case X.KPICARD:s=e(AA,u,t,y);break;case X.IMAGELAYOUT:s=K(AA,u,t,y);break;case X.CUSTOM:if(y.getCustomDropZones&&y.getCustomDropZones()){s=I(AA,u,t,y);}else{s=A(AA,u,t,y,q);}break;default:s=A(AA,u,t,y,q);break;}if(!t.dataSourceState&&!t.datasetId){var z=y.getHost();if(!z.hasArrayGSI){var w=z.model.data.gsi;h(w,u,AA,x.k,s);}}return s;},getExtras:function U(s){var q=s.getHost(),t=q.scriptClass;if(t==="mstrmojo.vi.ui.rw.MultiXtab"||t==="mstrmojo.ag.AgXtab"){return{style:{params:{treesToRender:j.BOTH}}};}return{style:{params:{treesToRender:j.DATA}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumVisualizationTemplates","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DatasetDoubleClick","mstrmojo.vi.models._CheckDataCards","mstrmojo.vi.util.TemplateUtils");var Z=mstrmojo.hash,p=mstrmojo.array,AH=mstrmojo.func,g=mstrmojo.vi.util.TemplateUtils,AA=mstrmojo.vi.ui.DatasetUnitMenuUtils,d="00000000000000000000000000000000",q=mstrmojo.vi.models.EnumDragSources,c=mstrmojo.chart.model.enums.EnumDSSObjectType,j=mstrmojo.vi.enums.EnumFeatures,J=mstrmojo.vi.viz.EnumVisualizationTemplates,e=mstrmojo.vi.viz.EnumDSSDropZones;var f={ABOVE:0,ON:1,BELOW:2};mstrmojo.vi.models.DropZoneItemType=null;mstrmojo.vi.models.DropZoneType=null;mstrmojo.vi.models.DropZonesEditorConfigType=null;function L(AQ,AM,AO,AR,AU,AP,AS,AT){var AN={act:AQ,zoneId:AM,unitId:AO,unitType:AR};if(AU!==undefined){AN.unitPos=AU+1;}if(AT!==undefined){AN.is_disableonly=AT;}if(AP){AN.datasetId=String(AP);AN.datasetType=String(AS);}return AN;}function S(AM){return function(AN){var AO=[{t:AM,did:NaN}];return !!this.getAllowDropInfo(AN,AO,AN.items.length-1,f.BELOW,{src:{data:{src:q.DATASETS}}}).allowedItems.length;};}function I(AR,AT){var AQ=this.getZoneModelByZoneId(e.XAxis).items,AV=this.getZoneModelByZoneId(e.YAxis).items,AS;if(AQ.length&&this.isMetric(AQ[0])){AS=false;}else{if(AV.length&&this.isMetric(AV[0])){AS=true;}else{if(AQ.length&&!AV.length){AS=true;}else{if(!AQ.length&&AV.length){AS=false;}else{AS=AT.isBar?AT.isVerticalBarVis(AT.getVisType()):true;}}}}var AW,AM=AS?AQ:AV,AO=AS?AV:AQ,AN=[],AP=[],AU=[];while(AR.length){AW=AR.shift();if(this.isMetric(AW)){AP.push(AW);}else{AN.push(AW);}}if(AN.length&&!AM.length){AU.push(AN.shift());}if(AP.length&&!AO.length){AU.push(AP.shift());}return AU.concat(AN).concat(AP);}function b(AN){var AM=[],AP=false,AO=this;p.forEach(AN,function(AQ){if(AO.isMetric(AQ)&&!AP){AM.push(AQ);AP=true;}else{if(!AO.isMetric(AQ)){AM.push(AQ);}}});return AM;}mstrmojo.vi.models.DropZonesModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.vi.models._CheckDataCards],{scriptClass:"mstrmojo.vi.models.DropZonesModel",hostId:"",docModel:null,getDropZones:mstrmojo.emptyFn,postAddActions:mstrmojo.emptyFn,getDZFlatStruct:function N(){var AP=this.getHost().model.data,AQ=AP.gsi||{},AM=(AQ.rows||[]).concat(AQ.cols||[]),AO={},AN={};AM.forEach(function(AR){if(AR.hasOwnProperty("st")&&AR.hasOwnProperty("did")){AO[AR.did]=AR.st;}});if(AP.dz){Object.keys(AP.dz).forEach(function(AV){var AR=AP.dz[AV],AS=AR.TemplateUnit||[],AU=AR.TemplateMetric||[],AT=AS.concat(AU);AT.forEach(function(AW){var AX=AW.id;if(AW.st===undefined&&AO.hasOwnProperty(AX)){AW.st=AO[AX];}});if(AS.length>0&&AU.length>0){AT.sort(function(AX,AW){return AX.idx-AW.idx;});}AN[AV]=AT;});}return AN;},getAvatarIconClass:function i(){throw new Error(this.scriptClass+" must implement getAvatarIconClass method.");},canSwapAxis:function z(){return false;},swapAxis:function A(){if(this.canSwapAxis()){throw new Error(this.scriptClass+" must implement swapAxis method if this.canSwapAxis returns true.");}},canDefineSubtotals:function(){var AM=this.getHost();if(AM&&AM.GMController&&AM.GMController.isWaterfall){return true;}return false;},hasVisibleSubtotals:function o(){var AM=this.getHost();return AM.getWidgetPropertyValue("totalShw");},showQuickSubtotals:function K(){var AM=this.getHost();AM.writeGlobalProperty("totalShw",true);},hideDefinedSubtotals:function AG(){var AM=this.getHost();AM.writeGlobalProperty("totalShw",false);},getZoneMenuItems:function AC(AN,AM){},getUnitMenuItems:function t(AN,AM,AP,AO){},getMultiUnitsMenuItems:function n(AN,AM,AO){var AP=this.id;if(!mstrApp.isInVFConfigMode&&AA.getMultiSelectionShortcutMetricFunctions(AO).length&&mstrmojo.resolveFeature(j.INSERT_NEW_METRIC)){AN.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[AP].getMultipleMetricsCalcMenus(AM,AO,true);});}AN.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AP].deleteItems(AM,AO);});},deleteItem:function M(AN,AM){this.throwAbstractMethodError("deleteItem");},deleteItems:function M(AM,AN){this.throwAbstractMethodError("deleteItems");},addZoneItem:function m(AP,AQ){AP.t=AP.t||4;if(AP.did===undefined){AP.did=AP.id;}var AO=this.getHost(),AT=Z.walk("model.data.gsi",AO),AM=AT&&g.findUnitsById(AT,AP.did)[0];if(AM){Z.copyProps(["n","um"],AM,AP);}var AN=this.docModel.datasets,AS=false,AR=AP.t===4?"mx":"att";Object.keys(AN).every(function(AU){(AN[AU][AR]||[]).every(function(AW){if(AW.did===AP.did){AS=true;var AX,AV=AW.n;for(AX in AW){if(!AP.hasOwnProperty(AX)){AP[AX]=AW[AX];}}if(AV!==AP.n){AP.objectNameinDataset=AV;}}return !AS;});return !AS;});AQ.push(AP);},getZone:function AB(AR,AQ,AP,AM,AN){var AO=[];(AP||[]).forEach(function(AS){this.addZoneItem(Z.copy(AS),AO,AN);},this);return{n:AR,id:AQ,enabled:!AM,cssClass:(AN&&AN.allowSingle)?"singleUnitZone":"",getDropIconCls:function(){return"pivot";},title:(AN&&AN.title)||"",items:AO};},getZoneForObject:function X(AN){var AM=null;this.getDropZones().zones.every(function(AO){if(p.find(AO.items,"did",AN)>-1){AM=AO;return false;}return true;});return AM;},getUnitIndexInZone:function y(AM,AN){return p.find(AM.items,"did",AN.did);},isZoneDropAllowed:function a(AM){if(!AM.enabled){return false;}return true;},getAllowDropInfo:function C(AN,AO,AM,AP){return{allowedItems:AO.concat(),removeReplaced:AP===f.ON&&AN&&AN.items&&AN.items[AM]&&p.find(AO,"did",AN.items[AM].did)===-1};},getTargetEdgePortion:function U(AM){return 0.33;},allowInsertNewMetric:function(AM){return AM.id!==e.SizeBy&&S(4).call(this,AM);},allowInsertNewAttribute:S(12),unitsDropped:function AI(AM,AN,AO,AQ,AP){if(this.unitDropped!==mstrmojo.vi.models.DropZonesModel.prototype.unitDropped){return this.unitDropped(AM,AN,AO.idx,AO.edge,AQ,AP);}this.throwAbstractMethodError("unitsDropped");},getHost:function k(){return mstrmojo.all[this.hostId];},getHostModel:function B(){this.throwAbstractMethodError("getHostModel");},shouldMetricNameShowIcon:function AL(){return true;},addUnitsFromDataSource:function H(AZ,AV,AX,Ab){var Ag=this,Ad=Ag.docModel,Aa=Ad.controller,Ah=this.getHost(),Af=Ah&&Ah.GMController,AM=Af&&Af.isBar,Ac=Af&&Af.isHistogram,Ae=Af&&Af.isArea,AY=Af&&Af.isLine,AN=Af&&Af.getVisType()===J.GRAPHCOMBINATIONBARAREADUALAXIS,AT,AS;if(AM||Ae||AY||AN){AZ=I.call(this,AZ,Af);}if(Ac){AZ=b.call(this,AZ);}AX=AX||[];var AQ=false,AW=[],AP,AU=mstrmojo.vi.models.DatasetDoubleClick.getExtras(this);[].concat(AZ).forEach(function(Aj,Ai){AP=this.isMetric(Aj);AQ=AP||AQ;AT=mstrmojo.vi.models.DatasetDoubleClick.addObject(Aj,AV,this,Ai);AS=AT&&Z.walk("0.actions",AT);AX=AX.concat(AT);if(AP){AW.push(Aj);}},this);if(AX&&AX.length){if(AQ&&AS){AS.push(Ah.model.getValuesDefaultFormatGridZoneAction(AW,true));}var AR=Aa._getXtabCallback(this.getHost());if(Ab){AR=AH.wrapMethods(Ab,AR);}var AO=function(){Ad.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AX,zm:Ag},function(){AX=Ad.wrapUnsetVisualizationFilterAction(AX);return Aa.submitUndoRedoUpdates(AX,{},AR,AU);},function(){return Aa.submitUndoRedoUpdates(AX,{},AR,AU);});};if(this.existLargeOrManyItems()){this.warnAndExecCallBackForAddUnits(function(){AO();});return ;}if(this.getHost().isOutlineMode){this.warnAndExecCallBackForOutlineAddUnits(function(){AO();});return ;}AO();}},changeZoneUnits:function x(AN,AM,AO){},getZoneAddCandidates:function h(AM){return[];},getRequiredItemsInfo:function s(AN){if(!AN){return 0;}var AM=[];this.getDropZones().zones.forEach(function(AO){AM=AM.concat(AO.items);});return Number(AM.reduce(function(AO,AP){if(parseInt(AP.did,10)!==-1&&AP.t===AN){return AO+1;}return AO;},0));},getUpdateCallback:function Y(){var AM=this.id;return{success:function(){var AQ=mstrmojo.all[AM];if(!AQ){return ;}var AS=AQ.getHost();if(!AS){return ;}var AR=mstrmojo.all.visualizationFilterToolbar,AP=AQ.docModel,AU,AO,AT,AN;if(mstrApp.isInVFConfigMode){AU=AS.zonesModel;AS.parent.selectVIUnit(true);AN=AU&&AU.isTemplateContainAttCategoryItem();mstrApp.isEnableSaveBtn=AN;AR.toggleSaveBtn(AN);}else{if(AS.isAMSelector&&AS.isAMSelector()){AO=AS.k;}else{AO=AS.parent&&AS.parent.k;}AT=AP.getPanel().getUnitByKey(AO);if(AT){AT.selectVIUnit(true);}}}};},getUpdateTemplateAction:function R(AM,AN){return this.docModel.getDataService().getUpdateTemplateAction(AN||this.getHost().k,AM);},getReplaceCandidates:function Q(AP,AU){var AQ=[],AO=AU.t,AM=AU.did,AN=this.getHostModel().datasetId,AS=AP.id===e.AdditionalMetrics,AT=this.getHost(),AR=AT.getChartStyle&&AT.getChartStyle()==="NewGraphMatrixVisualizationStyle";this.getDropZones().zones.forEach(function(AV){((AV&&AV.items)||[]).forEach(function(AX){var AY=AX.t,AW=AX.did;if(AY!=undefined&&AW!=undefined&&AY!==21&&AW!=="-1"&&AW!==d&&((AY===4&&AO===4)||(AY!==4&&AO!==4))&&AW!==AM&&p.find(AQ,"did",AW)===-1){AQ.push(AX);}});});if(!AR||!AS){if(AN){this.docModel.getDatasetUnits(AO===4?["mx"]:["att"],null,AN).forEach(function(AV){if(p.find(AQ,"did",AV.did)===-1&&AV.did!==AM&&!AV.hide&&!AT.model.hasSameRecursiveAttributeGroup(AV,AT.gridData,AU)){AQ.push(AV);}});}}return AA.getSortedDatasetUnits(AQ);},getDropTargetIndex:function E(AN,AP){var AM=AP.idx,AO=(AP.edge===f.ON&&!AP.removeReplaced)?f.BELOW:AP.edge,AR=AM,AQ=this,AS={};AP.allowedItems.forEach(function(AU){var AT=AQ.getUnitIndexInZone(AN,AU);if(AT!==-1){AS[AT]=AU;}});Z.forEach(AS,function(AU,AV){var AT=parseInt(AV,10);if(AT<AM){AR--;}else{if(AT===AM){AO=f.ON;}}});return AO===f.BELOW?(AR+1):AR;},getAddDropZoneUnitAction:function w(AN,AP,AM,AO){return L("addDropZoneUnit",AN.id,AP.did,AP.t,AM,AO&&AO.datasetId,(AO&&AO.datasetType)||c.DssTypeReportDefinition);},getAddDropZoneUnitsActions:function AK(AN,AO,AM,AP){return AO.reverse().map(function(AQ){return L("addDropZoneUnit",AN.id,AQ.did,AQ.t,AM,AP&&AP.datasetId,(AP&&AP.datasetType)||c.DssTypeReportDefinition);});},getRemoveThresholdsActions:function P(AM,AO){var AT=AO.id||AO.did;var AP=this.getHostModel(),AS=AP&&AP.gsi,AQ=AS&&AS.thresholds&&AS.thresholds[AT]||[],AR=[];for(var AN=AQ.length-1;AN>=0;AN--){AR.push({act:"clearThreshold",unitId:AT,unitType:AO.t,tid:AQ[AN].tid});}return AR;},getRemoveDropZoneUnitActions:function G(AM,AP,AQ){if(AQ===undefined||AQ===null){AQ=1;}var AR=[];var AO=this.getHost(),AN=AO.isCustomVis;if(AM.id===e.ColorBy&&this.isMetric(AP)&&!AN){AR=this.getRemoveThresholdsActions(AM,AP);}if(AP){AR.push(L("removeDropZoneUnit",AM.id,AP.did,AP.t,undefined,undefined,undefined,AQ));}return AR;},checkAndAddThresholdAction:function AF(AO,AM,AN){return false;},getAllZones:function(){return this.getDropZones().zones||[];},getClearAllUnitsActions:function W(){var AM=[];(this.getAllZones()).forEach(function(AN){((AN&&AN.items)||[]).forEach(function(AO){Array.prototype.push.apply(AM,this.getRemoveDropZoneUnitActions(AN,AO));},this);},this);return AM;},getClearAllUnitsUnTemplateActions:function l(){return[];},clearAllDropZones:function AE(AQ){var AN=this.docModel,AP=this,AM=AP.getAllZones().filter(function(AS){return AS&&AS.items&&AS.items.length;}).map(function(AS){return AS.id;}),AO=function(){AQ=AQ||{actions:[]};AQ.actions=AN.wrapUnsetVisualizationFilterAction(AQ.actions);AP.clearAllDropZonesDeferred(AQ);},AR=function(){AP.clearAllDropZonesDeferred(AQ);};return AN&&AN.checkAndNotifyVFChangeOnClearAll({zm:AP,ca:AM,cmb:true},AO,AR);},clearAllDropZonesDeferred:function D(AV){var AO=this.getClearAllUnitsActions(),AQ=this.getClearAllUnitsUnTemplateActions(),AX=this.getHost(),AT=AX.id,AP=AX.gridData||AX.model.data||AX.node.data,AS=AP.vlexpr,AY=this.docModel,AN=AX.model,AR=AY.controller,AU=AH.wrapMethods({success:function(){var AZ=mstrmojo.all[AT];if(AZ._viSelections){AZ.clearSelections();AZ.endSelections();}}},AR._getXtabCallback(AX),{success:function AW(){mstrmojo.all[AT].raiseEvent({name:"regenerateToolbar"});}}),AM=AN.getKeepOnlyActionsForAssociatedNodes([],AU);if(AS){AM.actions.push(AR.dataService().getUpdateTemplateAction(AX.k,AN.getRemoveMetricLimitsAction(AS)));}if(AV){AV.actions=[].concat(AV.actions).concat(AM.actions);AV.callback=AH.wrapMethods(AV.callback,AM.callback);}else{AV=AM;}if(AQ&&AQ.length>0){AV.actions=AV.actions.concat(AQ);}this.submitDropZoneTemplateUpdates(AO,AV);},getUngroupAddActions:function AD(AN,AQ,AM){var AP=this.getHost(),AO=AP.model,AR=[Z.copy({isUngroup:1,deId:AQ.did},AO.getAddTemplateUnitAction(AM,AQ.dsId,AN.id,p.find(AN.items,"did",AQ.did)))];return[this.getUpdateTemplateAction(AR)];},submitDropZoneUpdates:function u(AS,AT,AO){var AQ=this.getHost(),AN=this.docModel,AM=AN.controller,AP=[].concat(AS||[]);if(AP&&AP.length){var AR=AT||AM._getXtabCallback(AQ);AM.cmdMgr.execute({execute:function(){this.submit(AP,AR,AO);},urInfo:{callback:AR}});}},submitDropZoneTemplateUpdates:function F(AM,AO){var AN=(AM&&AM.length)?[this.getUpdateTemplateAction(AM)]:[];if(AO&&AO.actions){AN=AN.concat(AO.actions);}this.submitDropZoneUpdates(AN,AO&&AO.callback,AO&&AO.extras);},getHighlightTargets:function AJ(AN,AM){return[AM];},getHostKey:function O(){var AM=this.getHost();return AM.k;}});mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION=f;mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE={ATTRIBUTE:12,METRIC:4,LONGITUDE:"long",LATITUDE:"lat"};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo._HasPopup","mstrmojo.Popup","mstrmojo.hash","mstrmojo.expr","mstrmojo.Container","mstrmojo.ConditionModel","mstrmojo.Widget","mstrmojo.Button","mstrmojo.ui.ColumnWalk","mstrmojo.rw.ConditionWalk","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalkProvider","mstrmojo.vi.ui.AllObjectsBrowser");var U=mstrmojo.Widget,M=mstrmojo.array,G=mstrmojo.dom,Q=mstrmojo.hash,c=mstrmojo.css,W=mstrmojo.Button.newWebButton,L=mstrmojo.expr,C=L.ET,A=mstrmojo.mstr.EnumNodeDimty,N=M.hash([A.NodeDimtyOutputLevel]);var O=mstrmojo.rw.ConditionWalk.getAttForms,E=mstrmojo.rw.ConditionWalk.isMdxDM;function F(){var e=this.model;if(e){if(!e.attachEventListener){Q.make(e,mstrmojo.ConditionModel,{defaultETAttr:e.defaultETAttr,data:e.data});}e.attachEventListener("edit",this.id,"onmodeledit");}}function P(f,e){if(e&&e.detachEventListener){e.detachEventListener("edit",f.id,"onmodeledit");}}mstrmojo.vi.ui.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.ConditionWalk",markupString:'<div id="{@id}" class="mstrmojo-vi-ui-ConditionWalk" mstrAttach:click><div class="walk"></div></div>',markupSlots:{walkNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:U.visibleMarkupMethod,onheightChange:U.heightMarkupMethod,onwidthChange:U.widthMarkupMethod},layoutConfig:{h:{walkNode:"100%"},xt:true},editor:undefined,columnWalk:undefined,walkProvider:null,objectBrowsingEnabled:false,children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"370px",width:"600px"}],postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=this.addDisposable(mstrmojo.insert(mstrmojo.vi.ui.ConditionWalkProvider));}},initWalk:function X(){var e=this.columnWalk,f=this.walkProvider;e.removeTrailingContainer(-1);e.addNextColumn(f.getTargetNodeProps());e.target.updateColumnContainer();this.updateOkBtn();},ob:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-vi-ui-ConditionWalk ObjectBrowserPopup mojo-theme-light",children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"browser",title:mstrmojo.desc(5298,"Select an Object"),layoutConfig:null,onSelectedItemsChange:function K(){var e=this.getSelectedItems(),f=e&&e[0],g=f&&f.t;this.parent.buttons.selectBtn.set("enabled",g&&g!==L.TP.FOLDER);},browse:function R(e){Q.copy(e,this);},getObjectSubTypes:function(){var e=this.browsableTypes;if(e){return e.split(",");}return this.constructor.prototype.browsableTypes();},dblClickOnNodes:function b(e){var h=this.onSelectCB,g=e.getTarget(),f=G.findWidget(g).data;h[0][h[1]](f);}},{scriptClass:"mstrmojo.Box",alias:"buttons",cssClass:"buttons",children:[W(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.opener.closePopup();}),W(mstrmojo.desc(547,"Select"),function(){var g=this.parent.parent,h=g.browser,i=h.onSelectCB,f=h.getSelectedItems(),e=this.parent.parent.opener;if(f&&f.length>0){i[0][i[1]](f[0]);}else{e.closePopup();}},true,{alias:"selectBtn",enabled:false})]}],onOpen:function H(){var i=this.shadowNode,e=document.body,f=document.documentElement,h=i.style,g=this.domNode;this.browser.obSearchBox.clearSearch(true);h.width=Math.max(e.clientWidth,f.scrollWidth)+"px";h.height=Math.max(e.clientHeight,f.scrollHeight)+"px";window.setTimeout(function(){c.addClass(g,"open");},1);},onClose:function D(){c.removeClass(this.domNode,"open");var e=this.browser;e.opened=false;e.reset();}},_set_model:function a(h,e){var f=this.model,g=(e!==f);if(g){P.call(this,f);e.dimtyTypes=this.dimtyTypes||N;this.model=e;F.call(this,e);this.initWalk();}return g;},onmodeledit:function J(f){var e=this.columnWalk[f.prop==="c1"?"c0":f.prop];if(f.prop==="fm"){e=this.columnWalk.target;}if(e){e.updateColumnContainer();}this.updateOkBtn();this.postmodeledit(f);},postmodeledit:mstrmojo.emptyFn,updateOkBtn:function d(){var h=true,e=this.model,f,g=e&&L.fnCstCount(e.fn,e.fnt);if(!e){return ;}switch(e.et){case C.AQ:case C.AL:case C.MQ:for(f=0;f<g;f++){h=h&&!this["invalid"+f];}break;}h=h&&!!e.completed;this.delegateUpdateOkBtn(h);},delegateUpdateOkBtn:mstrmojo.emptyFn,browse:function I(g){var i=this.parent.editorNode,h=function(k,m){var j=G.position(k,true),l=G.position(m,true);return{x:j.x+j.w,y:l.y};},e=this.columnWalk,f=this.walkProvider;switch(g&&g.alias){case"target":case"dmy":f.browseObjs(this,g);break;case"c0":case"c1":f.browseObjs(this,g);break;case"es":f.browseEs(this,g,h(e.es.domNode,i));break;}},onOBSelect:function(j){var l=j.t;if(l===L.TP.FOLDER||l===0||l===undefined){return ;}var h=this.ob.browser,m=h.target;this.closePopup();if(m.alias==="c0"){m=m.attMxPd;}var g=this.targets,k=m.itemIdField,i=g||[],e=M.find(g,k,j[k]);if(e===-1){i.push(j);this.targets=i;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}m.list.set("selectedIndex",M.find(m.items,"did",j.did));if(m.onObjBrowsed){m.onObjBrowsed(j);}},getDatasets:mstrmojo.emptyFn,getAttributeForms:function Y(g){var f=this.editor;if(f&&f.getAttributeForms){return f.getAttributeForms(g);}var e=this.getDatasets();return O(g,e);},getAttributeInfo:function Z(e){var f,h=this.editor;if(h&&h.model&&h.model.targets){M.forEach(h.model.targets,function(i){if(i.did===e){f=Q.clone(i);return false;}});}else{var g=this.getDatasets();Q.forEach(g,function(i){f=Q.clone(i.att.filter(function(j){return j.did===e;})[0]);if(f){return false;}});}if(f){f.fs=this.getAttributeForms(e);}return f?f:{};},isMDXDM:function S(e){return E(e,this.getDatasets());},getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr","mstrmojo.XtabCellHoverPopup","mstrmojo._HasPopup","mstrmojo._HasContextualLink","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.rw._SupportTabNav","mstrmojo.vi.ui.rw.CustomSortDisplayPanel","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes");var c=0,A=1,AC=2,M=3,m="overflow:auto",j="overflow:hidden",Q=mstrmojo.dom,Y=Q.position,l=mstrmojo.array,AB="mstrmojo.DocPanelStack",AF="px",I=mstrmojo.DocDataService.SUPPRESS_DATA,u=mstrmojo.models.template.DataInterface,N=u.ENUM_GRID_RESIZE,AA=N.FIXED,J=Q.isIOSTouch,D=mstrmojo.css;var n=function P(AH,AI){var AJ=AH&&AH.parent;while(AJ&&AJ.scriptClass!==AB){if(AJ.scriptClass===AI){return AJ;}AJ=AJ.parent;}return AJ;};function x(){var AN=36;var AI=this.model.docModel.getPanel(),AK=AI.containerNode,AJ=Y(AK),AH=mstrApp.rootCtrl.view.toolbar,AO=Y(AH.domNode);var AM={};AM.x=AJ.x;AM.w=AJ.w;AM.y=(AO.y+AO.h)-AN;AM.h=(AJ.y+AJ.h)-AM.y;var AL=AJ.y-(AO.y+AO.h);return{csPanelPos:AM,spacerHeight:AL};}function F(){var AH=window.event,AI=AH.target,AO=AH.keyCode;var AN=Q.findWidget(this),AQ=AN&&AN.zone.tableNode.rows;if(AI.getAttribute("role")==="grid"&&(AH.keyCode===37||AH.keyCode===38||AH.keyCode===39||AH.keyCode===40)){var AP=AN.getCellFromTableToBeFocussed(AI.rows[0].cells[0],AN);AP.focus();D.addClass(AP,"xtabCellFocus");AH.preventDefault();}else{if(AI.tagName==="TD"||AI.tagName==="TABLE"){var AP,AL=AI.parentElement.rowIndex;switch(AO){case 37:case 39:var AM=AO===37;AP=q.call(this,AQ,AL,AI,AM,AN);AH.preventDefault();break;case 38:case 40:var AK=AO===40;AP=S.call(this,AQ,AL,AI,AK,AN);AH.preventDefault();break;case 121:if(AH.shiftKey&&AN&&AN.cellHoverMgr&&AN.cellHoverMgr.oncontextmenu){AN.cellHoverMgr.oncontextmenu(AH,self,AI);}break;case 13:var AJ=AI.firstChild;if(AJ.tagName==="A"&&AH.altKey){window.open(AJ.getAttribute("href"),"_blank");}else{E.call(this,AI,AN);}break;}if(AP){window.setTimeout(function(){AP.focus();D.removeClass(AI,"xtabCellFocus");D.addClass(AP,"xtabCellFocus");},100);}}}}function q(AM,AL,AK,AN,AH){var AJ=AN?AK.previousElementSibling:AK.nextElementSibling,AI=AN?AM[AL-1]:AM[AL+AK.rowSpan];if(AJ===null&&AI){AJ=AN?AI.lastChild:AI.firstChild;}if(AJ){return AH.getCellFromTableToBeFocussed(AJ,AH);}}function E(AJ,AH){var AI=Q.findAncestorByName(AJ,"table",false);if(AI){AH.handleSelection(event,AI,AJ);}}function S(AP,AY,AL,AM,AK){var AT=AM?AP[AY+AL.rowSpan]:AP[AY-1],AW=AL.parentElement,AQ=AW.childElementCount,AU=AL.cellIndex,AI,AV;var AO=[],AX=[],AS=[],AR=[],AN=0,AJ=0,AH=0;for(AV=0;AV<AQ;AV++){AO[AV]=AW.childNodes[AV].colSpan;AN=AN+AO[AV];if(AV===0){AS[0]=AO[0];}else{AS[AV]=AS[AV-1]+AO[AV];}}if(AT){AI=AT.childElementCount;for(AV=0;AV<AI;AV++){AX[AV]=AT.childNodes[AV].colSpan;AJ=AJ+AX[AV];if(AV===0){AR[0]=AX[0];}else{AR[AV]=AR[AV-1]+AX[AV];}}}AH=AS[AU]-AO[AU];if(AN<AJ){AU=AH+(AJ-AN);}else{if(AN>AJ){AU=AH-(AN-AJ);}else{AU=AH;}}for(AV=0;AV<AR.length;AV++){if((AR[AV]-AX[AV])<=AU&&AU<(AR[AV])){AU=AV;break;}}if(AU<0&&AY>0){AY=AY-1;return S.call(this,AP,AY,AL,AM,AK);}else{if(AY>0||AM){return AK.getCellFromTableToBeFocussed(AT.cells[AU],AK);}}}function U(){var AI=false,AJ=this.gridData,AK=(AJ&&AJ.olm&&!(AJ.rw&&AJ.rw.row.bc>0)&&!this.defn.txi),AH=this.defn.txi,AL=false;if(this.model.hasRecursiveAttribute){AL=this.model.hasRecursiveAttribute(AJ);}if(mstrApp.isDossier&&mstrApp.enableGridAccessibility&&mstrApp.isVI&&!AK&&!AL&&!AH&&!J){AI=true;}return AI;}function i(AL){var AI=this,AH=AI.clonedColHeader&&AI.clonedColHeader.isRendered()&&AI.clonedColHeader.getTableNode(),AJ=AI.clonedRowHeader&&AI.clonedRowHeader.isRendered()&&AI.clonedRowHeader.getTableNode(),AK=AI.clonedTitle&&AI.clonedTitle.isRendered()&&AI.clonedTitle.getTableNode();if(AH){D.toggleClass(AH,"displayBorder",AL);}if(AJ){D.toggleClass(AJ,"displayBorder",AL);}if(AK){D.toggleClass(AK,"displayBorder",AL);}}mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections,mstrmojo._HasContextualLink,mstrmojo._HasPopup,mstrmojo.vi.ui.rw._SupportTabNav,],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function B(){var AJ=this._super();var AI=this.gridData;var AH=this.lockHeadersCase===c&&AI.co;this.scrollboxNodeOverflow=AH&&!this.numRowFixed?j:m;var AK=this.getFormats();if(mstrmojo.dom.isIE8&&!AI.co&&this.lockHeadersCase===c&&(!AI.rw||(AI.rw&&(AI.rw.row.bc>=AI.rw.row.tc)))&&mstrmojo.string.isEmpty(AK.height)&&mstrmojo.string.isEmpty(AK.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||AI.cssflt||false;return AJ;},postBuildRendering:function o(){var AM=this.gridData,AL=this._super(),AJ=this.scrollboxNode;var AO=this;if(this.viewport){var AN=function(){AO.addDisposable(AO.requiresContrib("cellHoverMgr",true));if(J){AO.viewport.ontouchstart=null;}else{AO.viewport.onmouseover=null;}if(event.type==="focus"&&AO.hasAccessibility&&AO.lockHeadersCase){i.call(AO,true);}};if(J||Q.isTouchOptimizationEnabled()){this.viewport.ontouchstart=AN;}else{this.viewport.onmouseover=AN;}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID&&(this.parent&&this.parent.scriptClass!=="mstrmojo.ExpressDocPanel")){this.model.docModel.addAutoWidthID(this.id);AM=this.gridData;var AK=AM&&AM.afc;if(AK&&mstrmojo.dom.isIE7){var AH=n(this,AB);if(AH&&AH.scriptClass===AB){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(Q.isIE&&!Q.isIE8&&this._useFilter){window.setTimeout(function(){var AQ=document.createElement("img");AJ.appendChild(AQ);AJ.removeChild(AQ);},0);}if(U.call(this)){var AP=this.zone&&this.zone.tableNode;this.hasAccessibility=true;if(AP){this.domNode.onkeydown=this.keyDownHandler;AP.onfocus=AN;AP.onblur=this.onblur;mstrmojo.css.addClass(this.zone.gridContainerNode,"gridAccessible");if(this.isMenuClicked){AP.focus();this.isMenuClicked=false;}}else{if(this.isMenuClicked){this.isMenuClicked=false;this.parent.menuBtnInfo.btn.focus();}}if((this.lockHeadersCase&M)||(this.lockHeadersCase&AC)){var AI=this.clonedColHeader&&this.clonedColHeader.isRendered()&&this.clonedColHeader.getTableNode();if(AI){D.addClass(AI.parentElement,"gridAccessible");AI.tabIndex="-1";}}}return AL;},isValidTarget:function O(AI){if(!this._super(AI)){return false;}var AH=true;if(AI.classList&&AI.classList.contains("invalid")){AH=false;}return AH;},initTabNavigation:function(){if(this.viewDataDialog){return ;}this._super();},buildNavList:function y(){var AJ=this.parent,AH=AJ&&AJ.menuBtnInfo&&AJ.menuBtnInfo.btn,AL=AJ&&AJ.filterBtnNode,AK=AJ&&AJ.maxRestoreBtnNode,AI=[AL,AK,AH];if(U.call(this)){AI.unshift(this);}this.navList=AI;},enterUnit:function g(){this.resetTabNav();this.grabFocus();this.navigateToFirstValidTarget();},grabFocus:function K(AH){if(this._super){this._super(AH);}var AI=this.zone&&this.zone.tableNode;if(AI&&AH&&U.call(this)){AI.focus();}},loseFocus:function s(AI){if(this._super){this._super(AI);}var AH=this.zone&&this.zone.tableNode;if(AH&&AI){AH.blur();}},onkeydown:function X(AH){if(this._super){this._super(AH);}if(this.viewDataDialog){return ;}var AJ=AH.e||AH,AI=AJ.key;if(this.handleTab(AH)){return ;}if(AI==="Escape"){AH.preventDefault();AJ.stopPropagation();this.navigateToParent(true);}},onCGBMapChange:function(AH){if(this._resolveCGBToTKS(AH.cgbMap)&&this._currentSelectedTD){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function w(AP){if(!AP){return false;}var AN=this.model.scm,AJ="\u001E",AL,AI,AM,AK,AH,AO=false;for(AI in AN){AM=AN[AI];AK=AM.cgb;for(AL in AK){AH=AP[AK[AL]];if(AH){if(!AM.tks){AM.tks=AH;AO=true;}else{if(AM.tks&&(AM.tks.indexOf(AH)<0)){AM.tks+=AJ+AH;AO=true;}}}}}return AO;},onGridWidthChanged:function e(AH){if(this._super){this._super(AH);}if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}},getDim:function(){var AH=this.contentNode;return{w:AH.scrollWidth,h:AH.scrollHeight};},unrender:function C(AH){var AI=this.cellHoverMgr;if(AI&&AI.shutdown){AI.shutdown();}this._super(AH);},link:function H(AI,AH){this.controller.onLink(this,this.model.getLinkAction(AI,AH));},customSort:function AE(AO,AJ){var AM=this,AQ=this.model,AN=AQ.getDataService(),AP=AQ.docModel,AH=AP.getUnitDefinitions(this.k)[this.k].pnk,AL=AP.currlaykey,AI=AP.getNextKey(),AK=AQ.getCreateCSVizActions(AO,AJ,AI);AN.submitUpdates(AK,{success:function(AW,AS){var AV=AW.data,AU=l.filterOne(AV.layouts,function(Aa){return Aa.k===AL;}),AR={};AR[AI]=AU.xtabStyles[AI];AP.controller.view.updateXtabStyles(AL,AR);AP.updateDefnCache(AW.defn,[AI,AH]);AP.updateDataCache(AV,AP.getTargetDefn(AI));var AZ=x.call(AM),AX=Y(AM.domNode),AT=600,AY=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.rw.CustomSortDisplayPanel",model:AP,nodeKey:AI,srcPanelKey:AH,srcLayoutKey:AL,srcViz:AM,srcUnit:AO,srcAxis:AJ,width:Math.max(AX.w,AT)+"px",height:AZ.csPanelPos.h+"px",left:((typeof AX.x==="number")?AX.x:0)+"px",top:((typeof AZ.csPanelPos.y==="number")?AZ.csPanelPos.y:0)+"px",spacer:AZ.spacerHeight});AY.setVizBoxPortalStateRestore();AY.open();AY.parent=mstrmojo.findAncestor(AM,"openXtabCellMenu");},failure:function(AU,AV){var AS=6,AW=10000,AT=0,AR=function(){AN.submitUpdates({act:"undo",stid:AN.stid},{success:function(AX,AY){mstrApp.hideWait();},failure:function(AX,AY){if(++AT<AS&&AX.code==mstrmojo.mstr.EnumWebAPIErrorCodes.MSI_ADDUSERJOB_ERROR){setTimeout(AR,AW);}else{mstrApp.hideWait();}}},{config:{silent:true},hideCancel:true,noUpdate:true,preserveStid:true,noDeltaXML:true});};mstrApp.showWait();AR();}},{style:{params:{treesToRender:3}},noUpdate:true,preserveStid:true,noDeltaXML:true,hideCancel:true});},pivot:function R(AH,AI){this.controller.onPivot(this,this.model.getPivotAction(AH,AI));},drill:function AD(AH,AI){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(AH),AI));},removeUnit:function Z(AH){this.controller.onRemoveUnit(this,this.model.getRemoveTemplateUnitAction({id:AH._e?AH._e.oid:AH.id,t:AH._e?AH._e.otp:AH.otp}));this.onDemandDrillItems=null;this.onDemandDrillDynamicItems=null;},showViewFilter:function b(AH){this.controller.onShowFilterEditor(this,AH);},showTotal:function L(AH,AJ,AI){this.controller.onShowTotals(this,this.model.getTotalsAction(AH,AJ,AI));},supportAdvancedSort:function z(){return !mstrApp.isDossier&&!this.hasArrayGSI;},deleteSelectorControl:function W(){var AH=this.gridData,AI=AH.sc;if(AI&&parseInt(AI.ct,10)===6){delete AH.sc;}},findSelectorControl:function G(){var AH=this.gridData.sc;if(AH&&parseInt(AH.ct,10)===6){this.selectorControl=AH;}else{delete this.selectorControl;}return this.selectorControl;},handlesMultiSelection:function t(AI){var AH=this.getCellForNode(Q.findAncestorByName(AI.getTarget(),"td",true,this.viewport)),AK=AH&&this.model.data.gts[AH.axis===1?"row":"col"][AH.tui||AH.ui],AJ=AK&&AK.id&&AK.sc;return !!(this.findSelectorControl()||AJ);},setAllXtabWidths:function AG(AH){},changeResizeScenario:function p(AP,AU,AV,AQ){var AX=new mstrmojo.models.template.DataInterface(this.gridData),AJ=this.gridData.twm||{},AK=AJ.bottom,AH=AX.getColumnHeaderData(true),AR=this,AN=this.model,AI=this.id,AW=this.k,AL=[],AM=[],AO=1,AT=[];if(AU){AL.push({act:"changeXtabColWidthScenario",value:AP});AH.forEach(function(Aa,AZ){var Af=Aa.oid||Aa.id,Ad=function(Ag){return Ag.unitId===Af&&Ag.depth===AO;};if(!(Aa.fs&&Aa.fs.length>0)){AO=1;}var Ac=Af===(AV&&AV.did);if(!AT.some(Ad)){AT.push({unitId:Af,depth:AO});var Ae=Ae||AN&&AN.docModel.getZoomFactor(),Ab=Ac?AV.width:parseInt((AK[AZ].w)||0,10),AY=Math.round(Ab/Ae);AM.push({colIndex:AZ,value:Ac?AV.width+AF:Ab+AF});if(AP===AA){AL.push(AN.getColumnResizeAction(Af,Aa.otp,AY,AO,Ac?AV.isExtra:false));}}AO++;});var AS=function AS(AY,Aa){var AZ=mstrmojo.all[AI];if(AY===AA){AR.updateRelatedColWidths(Aa);}AR.updateScenario(AY);};AS(AP,AM);AR.submitColumnWidthChange(AL,AQ);}return AQ?AL:undefined;},submitColumnWidthChange:function d(AJ,AH){if(!AH){this.model.getDataService().submitTemplateUpdates(this.k,AJ,{success:function AI(){}},I);}},changeColumnWidth:function a(AM,AT,AJ,AU,AK,AQ){var AX=new mstrmojo.models.template.DataInterface(this.gridData),AH=AX.getColumnHeaderData(true),AO=this.model,AL=[],AS=this,AN=[],AP=1,AR=-1,AV=[];if(AX.getColResizeScenario()!==AA){AL=this.changeResizeScenario(AA,true,{did:AM,t:AT,width:AJ,depth:AU,isExtra:AK},AQ);return AQ?AL:undefined;}var AI=AI||this.model.docModel.getZoomFactor(),AW=Math.round(AJ/AI);if(AM==="all"){AH.forEach(function(AZ,AY){var Ac=AZ.oid||AZ.id,Ab=function(Ad){return Ad.unitId===Ac&&Ad.depth===AP;},Aa=AH[AY-1];if(!(AZ.fs&&AZ.fs.length>0)||(Aa&&Ac!==(Aa.oid||Aa.id))){AP=1;}if(!AV.some(Ab)){AV.push({unitId:Ac,depth:AP});AN.push({colIndex:AY,value:AJ+AF});AL.push(AO.getColumnResizeAction(Ac,AZ.otp,AW,AP,false));}AP++;});}else{AH.every(function(AZ,AY){var Aa=(AZ.oid===AM||AZ.id===AM);if(Aa){AR=AY+AU-1;}return !Aa;});if(AR>=0){AN.push({colIndex:AR,value:AJ+AF});AL.push(AO.getColumnResizeAction(AM,AT,AW,AU,AK));}}AS.updateRelatedColWidths(AN);AS.submitColumnWidthChange(AL,AQ);return AQ?AL:undefined;},keyDownHandler:function k(){F.call(this);},onblur:function f(){var AH=Q.findWidget(this),AI=AH&&AH.parent;if(AI){i.call(AI,false);}},getCellFromTableToBeFocussed:function h(AK,AS){var AJ=AK,AR=AS.getCellForNode(AK),AL=AS.model.getCellInfo(AR),AP=AK.parentElement&&AK.parentElement.rowIndex||0,AQ=AK.cellIndex,AN=AS.lockHeadersCase,AH=AS.zone.tableNode;if(AN){var AI=AS.clonedColHeader&&AS.clonedColHeader.isRendered()&&AS.clonedColHeader.getTableNode(),AO=AS.clonedRowHeader&&AS.clonedRowHeader.isRendered()&&AS.clonedRowHeader.getTableNode(),AM=AS.clonedTitle&&AS.clonedTitle.isRendered()&&AS.clonedTitle.getTableNode();if(AL.isTitle){if((AN!==M)&&(AN&A)){AJ=AO?AO.rows[AP].cells[AQ]:AH.rows[AP].cells[AQ];}else{if((AN!==M)&&(AN&AC)&&(AI)){AJ=AI.rows[AP].cells[AQ];}else{AJ=AM?AM.rows[AP].cells[AQ]:AI.rows[AP].cells[AQ];}}}else{if(AL.isHeader){if((AN!==M)&&(AN&A)){AJ=AH.rows[AP].cells[AQ];}else{AJ=AI.rows[AP].cells[AQ];}}else{if(AR&&AR.axis===2){if((AN&AC)&&(AI)){AJ=AI.rows[AP].cells[AQ];}else{AJ=AH.rows[AP].cells[AQ];}}else{AJ=(!AL.isMetric&&AS.clonedRowHeader&&AS.clonedRowHeader.isRendered())?AO.rows[AP].cells[AQ]:AH.rows[AP].cells[AQ];}}}}AH.rows[AP].cells[AQ].focus();return AJ;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.NewVisTooltip");var H=mstrmojo.array,G=mstrmojo.NewVisTooltip;mstrmojo.customviz._TooltipHelper=mstrmojo.provide("mstrmojo.customviz._TooltipHelper",{_mixinName:"mstrmojo.customviz._TooltipHelper",initTooltip:function F(){if(!this.tooltipWin){this.tooltipWin=this.addDisposable(new G({visId:this.id}));this.tooltipWin.render();}},showTooltip:function E(M,O,N){var L=this.hasLinkTooltip();if(!mstrApp.isDisplayOnMobile){var J=this.tooltipWin,I=J&&J.domNode,K=this.getTooltipContent(M);if(!I.parentNode){document.body.appendChild(I);}J.showDossierTtp(K,O,L&&this.model.data.doslinkinfo,N);}},hideTooltip:function A(I){if(!mstrApp.isDisplayOnMobile){if(this.tooltipWin){this.tooltipWin.hide(I!==false);}}},getTooltipContent:function B(J){var K=J.additional&&J.additional.length||1,I;if(K===1){I=this.generateSimpleInfoObj(J);}else{I=this.generateGridInfoObj(J);}return I;},generateSimpleInfoObj:function C(O){var J=[],N=this,K,M=O.idValueMapping,I=O.additional,L={};if(I){L=I[0].idValueMapping;}H.forEach(this.tooltipObjsInOrder,function(P){if(P!=="seperate"){K=N.idTitleMapping[P];if(L[P]!==undefined){J.push({n:K,v:L[P]});}else{if(M[P]!==undefined){J.push({n:K,v:M[P]});}}}else{J.push(null);}});return J;},generateGridInfoObj:function D(N){var P=this,K={header:[],body:[]},J,M=N.idValueMapping,L=N.additional,Q;var I=function(){var R=K.header;H.forEach(P.tooltipObjsInOrder,function(S){if(S!=="seperate"){J=P.idTitleMapping[S];R.push(J);}});if(R.length>0){return true;}return false;},O=function(){var U=K.body,S,R;for(R=0;R<L.length;R++){S=[];U.push(S);Q=L[R].idValueMapping;H.forEach(P.tooltipObjsInOrder,function(W){if(W!=="seperate"){if(Q[W]!==undefined){S.push(Q[W]);}else{if(M[W]!==undefined){S.push(M[W]);}}}});}};if(!I()){return K;}O();return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasContextualLink","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.VisUtility","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.rw._SupportViewFilterInVizBox","mstrmojo.util.FontLoader");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var O=mstrmojo.dom;var b={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var Q=["background-color","fx"],K={width:"width",height:"height"},h=mstrmojo.array,P=mstrmojo.hash,a=mstrmojo.VisUtility;$FORMAT_MODEL=mstrmojo.models.FormatModel,$ENUM_REACT_FORMAT_TABS=$FORMAT_MODEL.ENUM_REACT_FORMAT_TABS;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate,mstrmojo._HasContextualLink,mstrmojo.vi.ui.rw._SupportViewFilterInVizBox,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,excludeData:false,skipReRender:false,triggerReRender:false,updateFormatsOnUpdate:true,bgFormats:{},init:function m(w){this.excludeData=!!(mstrConfig.resolveOnly||mstrApp.isAppStatePause&&mstrApp.isAppStatePause());if(this._super){this._super(w);}},setModel:function p(w){this.set("model",w);},destroy:function l(){var w=this.model;if(w&&w.destroy){w.destroy();delete this.model;}this._super();},resize:function S(){var w=this.getFormats();if(parseInt(w.height,10)===0||parseInt(w.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(w.height,w.width);this.domNode.style.display="";}},setDimensions:function k(z,y){var x=this._super(z,y);if(x&&this.hasRendered&&!this.skipReRender){this.reRender();}return x;},reRender:function N(){this.unrender();this.render();},unrender:function E(w){mstrmojo.util.FontLoader.cancelLoadRequests(this.id,true);this._super(w);},getWidth:function q(){return parseInt(this.width,10);},getHeight:function g(){return parseInt(this.height,10);},getLeft:function e(){return parseInt(this.left,10);},getTop:function B(){return parseInt(this.top,10);},needExtraPaddingTop4Legend:function(){var w=a.isOnExpressMode();return !w&&this.parent&&this.parent.showTitleBar===false;},getFonts:mstrmojo.emptyFn(),loadFonts:function H(w,x){if(mstrmojo.util.FontLoader.load(this.id,w,x)){x.success();}},getNodeKey:function I(){return this.node.k;},getTemplateKey:function X(){return this.node.k;},preBuildRendering:function A(){if(this.requirePreload){var w=function w(){this.requirePreload=false;this.render();};if(mstrmojo.util.FontLoader.load(this.id,this.getFonts(),{success:w.bind(this),failure:w.bind(this)})){return this._super();}else{return false;}}return this._super();},buildRendering:function D(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function j(){},postBuildRendering:function(){var w=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:w||this.excludeData,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !w;},applyBackground:function f(){var x=this.bgFormats,z,w,AA,y;if(mstrApp.isExpress&&!P.isEmpty(x)){z=this.formatHandlers=this.formatHandlers||{};AA=z.domNode=z.domNode||[];w="BG";y=h.indexOf(AA,w);if(y<0){AA.push(w);}this.applyCSSFormatToNode("domNode",x);}},parseBgFormats:function J(){var w=this.id;return{success:function(AC){var z,AE,AB,x,AD,y,AA=mstrmojo.all[w],AF=AA&&AA.getDocModel();if(AC.defn&&AC.defn.layouts&&AA&&AF){AE=AC.defn.layouts;z=h.find(AE,"k",AF.getCurrentLayoutKey());AB=AE[z];x=AB&&AB.units&&AB.units[AA.k];AD=x&&x.fmts;if(AD){y=AA.bgFormats={};h.forEach(Q,function(AG){if(AD[AG]){y[AG]=AD[AG];}});}}}};},onAppStateChange:function(w){var x=mstrApp.isAppStatePause&&mstrApp.isAppStatePause(),y=w.valueWas&mstrmojo.vi.VisualInsightApp.APP_STATES.PAUSE;this.excludeData=!!(mstrConfig.resolveOnly||x);if(this._super){this._super(w);}if((x&&!y)||(!x&&y&&!mstrApp.enableUpdate)){this.raiseEvent({name:"toggleCtrlOverlay",visible:this.excludeData||this.isEmpty(),controls:this.getVisEmptyMsgControls()});if(this.triggerReRender){this.refresh();this.triggerReRender=false;}}},refresh:function s(w){if(this.excludeData){this.raiseEvent({name:"toggleCtrlOverlay",visible:true,controls:this.getVisEmptyMsgControls()});return ;}this._super(w);},update:function i(z){z=z||this.node;if(z){var w=z.data;if(w){this.model.set("data",w);}this.waitingForData=!!w.nsj;if(this.waitingForData){var x="ServerJsonRWDStyle";var AA=this.model,y=AA.getDataService(),AB={host:this,nodes:[this.k]},AD;if(w.wid!==undefined){AB.slices=[w.wid];}AD=mstrmojo.func.wrapMethods(this.parseBgFormats(),AA.docModel.getUpdateColorMapCallback(),AA.docModel.getUpdateThemePaletteCallback(true),AA.controller._getXtabCallback(this,false));y.retrieveServerJson(AB,AD,{preserveUndo:true,style:{name:x,params:{treesToRender:3}},params:{styleName:x}});this.updated=true;return false;}this.updateContentFormats(z);}if(this.model){var AE=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(AE&&AE.getDocBuilder){var AC=AE.getDocBuilder().getMojoVisName(z);if(AC){z.data.visName=AC;}}}this.updated=true;if(this._super){return this._super(z);}return true;},updateContentFormats:function R(AA){var y,AB,x,z=AA.defn,w=this.builder;if(this.updateFormatsOnUpdate&&z){if(w&&w.isPortlet&&w.isPortlet(z)){AB=K;}else{AB=b;}x=z.fmts||z.units[this.model.k].fmts;for(y in AB){if(AB.hasOwnProperty(y)&&x.hasOwnProperty(y)){this[AB[y]]=x[y];}}}},isEmpty:function U(){return false;},canDuplicate:function Z(){return true;},getVisEmptyMsgControls:function M(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function t(){return this.model;},getData:function Y(){return this.model.data;},getRowsAndCols:function(){var w=this.model.data.gts;return(w.row||[]).concat(w.col||[]);},getExp:function(){var w=this.model.data,x=w&&w.sc&&w.sc.exp;return x;},getDocModel:function n(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function d(){return mstrmojo.emptyFn;},renderErrorMessage:function u(w){var x=document.createElement("div");x.className="mstrmojo-message";x.textContent=w;this.domNode.appendChild(x);},getMessageID:function c(){return this.model.docModel.mid||this.model.mid;},performAction:function o(w){var x=this.model,AA=this.scriptClass==="mstrmojo.heatmap.vi.VisHeatMap",z=AA?x.getHMAction(w):x.getAction(w),y=z&&z.h;if(y&&this.controller[y]){this.controller[y](this,z.a);return true;}return false;},deleteSelectorControl:function W(){var w=this.getData(),x=w.sc;if(x&&parseInt(x.ct,10)===6){delete w.sc;}},findSelectorControl:function G(){var x=this.getData(),w=x&&x.sc;if(w&&parseInt(w.ct,10)===6){this.selectorControl=w;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;},displayVizBoxVisFilterIndicator:function C(w,x){if(w&&x&&x.displayVisFilterIndicator){x.displayVisFilterIndicator();}},isCurrentVizBoxSelected:function L(){var x=this.getDocModel(),y,w;if(x&&typeof x.getSelectedViUnit==="function"){y=x.getSelectedViUnit();w=y&&y.boxContent;return w===this;}},supportFeatureImpl:function(y,AA,x,z){var w=y[AA][x];if(z!==undefined&&w!==undefined){return(z&w)>0;}return false;},syncWithReactFormatPanel:function F(x){if(mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.DOSSIER_REACT_FORMAT_PANEL)){var w;if(!x){w=$ENUM_REACT_FORMAT_TABS.PROPERTY_TAB;}this.raiseEvent({name:"updateFormatPanelSelection",tabId:w});}},});if(O.isTouchOptimizationEnabled()){mstrmojo.mixin(mstrmojo.mobile.vi.ui.rw._IsInPanelStack,mstrmojo.VisBase.prototype);mstrmojo.mixin(mstrmojo.mobile._VisBaseSupportsTouches,mstrmojo.VisBase.prototype);}}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo.hash","mstrmojo.color","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasPopup","mstrmojo._HasOwnAvatar","mstrmojo.vi.controllers.EnumEvents","mstrmojo.vi.ui._HasTargets","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi._MonitorsAppState","mstrmojo.vi._MonitorsLayoutMode","mstrmojo._Formattable","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.string","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.vi.ui.TitleBar","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.ui.rw._HasVisFilterIndicator","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui._CanGroup","mstrmojo._IsAccessibleMenu","mstrmojo.util.ui._HostsSplitter","mstrmojo.vi.ui._CanFreeformGroup","mstrmojo.vi.ui._SupportLayerNode","mstrmojo.vi.ui.rw._boxCornerResizer","mstrmojo.vi.ui.BoxLayoutConfig","mstrmojo.VisUtility","mstrmojo.VisBase","mstrmojo.Xtab","mstrmojo.vi.util.A11yUtility","mstrmojo.vi.ui.rw._SupportTabNav");mstrmojo.requiresDescs(629,1388,3099,3100,3101,3102,3499,3500,3501,3502,3503,3504,3506,3507,11477,11478);var Bz=mstrmojo.array,CA=mstrmojo.vi.ui.BoxLayoutConfig.EnumBoxType,Be=mstrmojo.css,BD=mstrmojo.dom,At=mstrmojo.hash,AH=mstrmojo.func,A4=mstrmojo.string,AB=mstrmojo.color,n=mstrmojo.vi.util.A11yUtility,BI=mstrmojo.vi.models.EnumDragSources,AD=mstrmojo.models.FormatModel,Ax=AD.ENUM_PROPERTY_NAMES,BV=AD.ENUM_REACT_FORMAT_TABS,y=mstrmojo.vi.enums.EnumFeatures,Bd=mstrmojo.vi.ui.BoxLayoutConfig.EnumModeHidden,Bt=mstrmojo.EnumRWUnitType,CC=mstrmojo.VisUtility,Bs=mstrmojo.vi.controllers.EnumEvents,M=1,G="visible",B1="mouse-left",CD="no-menu",A7="ctrlOverlay",Aq="or-v",AL="or-h",A8="accessible",Ay=3.5,BX=5,AV=2,CS=0;var Bk=BD.isTouchOptimizationEnabled()?[]:["mouseenter","mouseover","mouseleave","mousemove","mouseout","click","contextmenu","keydown","keyup","focus","blur"];var B0={SHORT:"ghost-short",TALL:"ghost-tall",GRANDE:"ghost-grande",VENTI:"ghost-venti",HIDE_TITLE:"ghost-hide-title",HIDE_DESC:"ghost-hide-desc"};var Ac={BLACK:"ghost-black",WHITE:"ghost-white",GREY:"ghost-grey"};var d=At.valarray(B0);var W=At.valarray(Ac);var D=d.concat(W);var B8={W_LV1:{H_LV1:[B0.VENTI],H_LV2:[B0.GRANDE],H_LV3:[B0.TALL],H_LV4:[B0.TALL,B0.HIDE_TITLE],H_LV5:[B0.SHORT,B0.HIDE_TITLE],H_LV6:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC]},W_LV2:{H_LV1:[B0.GRANDE],H_LV2:[B0.GRANDE],H_LV3:[B0.TALL],H_LV4:[B0.TALL,B0.HIDE_TITLE],H_LV5:[B0.SHORT,B0.HIDE_TITLE],H_LV6:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC]},W_LV3:{H_LV1:[B0.TALL],H_LV2:[B0.TALL],H_LV3:[B0.TALL],H_LV4:[B0.TALL,B0.HIDE_TITLE],H_LV5:[B0.SHORT,B0.HIDE_TITLE],H_LV6:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC]},W_LV4:{H_LV1:[B0.SHORT],H_LV2:[B0.SHORT],H_LV3:[B0.SHORT],H_LV4:[B0.SHORT,B0.HIDE_TITLE],H_LV5:[B0.SHORT,B0.HIDE_TITLE],H_LV6:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC]},W_LV5:{H_LV1:[B0.SHORT],H_LV2:[B0.SHORT],H_LV3:[B0.SHORT],H_LV4:[B0.SHORT,B0.HIDE_TITLE],H_LV5:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC],H_LV6:[B0.SHORT,B0.HIDE_TITLE,B0.HIDE_DESC]}};function g(CY){var Cb=CY?CY.c1||CY:"",Ca=AB.getLuminance(Cb),CX=255,Cc=68.7914,CZ=Math.max(CX/Ca,Ca/CX),Cd=Math.max(Cc/Ca,Ca/Cc);if(CZ>=Cd){return Ac.WHITE;}if(Ca<190){return Ac.BLACK;}return Ac.GREY;}function o(Cb,CY){var Cd,Cc,Ca;if(Cb>=1024){Cd="W_LV1";}else{if(Cb>=640){Cd="W_LV2";}else{if(Cb>=320){Cd="W_LV3";}else{if(Cb>=100){Cd="W_LV4";}else{Cd="W_LV5";}}}}if(CY>=1024){Cc="H_LV1";}else{if(CY>=640){Cc="H_LV2";}else{if(CY>=320){Cc="H_LV3";}else{if(CY>=200){Cc="H_LV4";}else{if(CY>=100){Cc="H_LV5";}else{Cc="H_LV6";}}}}}Ca=B8[Cd][Cc];if(this.getFormats){var CX=this.getFormats(),CZ=CX&&CX["background-color"];Ca=Ca.concat(g(CZ));}return Ca;}function z(CX){CX=document.createElement("div");CX.className="hover-drag-icon-btn";CX.setAttribute("tabindex","0");CX.setAttribute("role","button");CX.setAttribute("data-icon-type","drag");var CY="Drag Icon for "+this.title;CX.setAttribute("aria-label",CY);if(this.menuBtnInfo.btn){this.domNode.insertBefore(CX,this.menuBtnInfo.btn);}else{this.domNode.appendChild(CX);}return CX;}mstrmojo.vi.ui.rw.UnitContainerTitleBar=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.vi.ui.TitleBar,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar"});var AQ={n:mstrmojo.desc(11477,"Hide Titlebar"),cls:"htb",fn:function(){this.toggleTitleBar(false);},dsbld:false};var CB={n:mstrmojo.desc(11478,"Show Titlebar"),cls:"stb",fn:function(){this.toggleTitleBar(true);},dsbld:false};function E(CY,CX,CZ){var Ca=mstrApp.isAppStatePresentation(),Cb=this.domNode;Be.toggleClass(this.domNode,"pulse",CY&&!Ca&&!CZ);if(CX){setTimeout(function(){Be.toggleClass(Cb,"pulse",false);},500);}}function BO(Ca,CX){var CY=mstrmojo.all[Ca],CZ=CY.getNodeDataByKey(CX).id;return mstrmojo.all[CZ].parent;}function AG(CX,CY){Be.toggleClass(CX,G,CY);Be.toggleClass(CX,B1,!CY);}function AR(){var Ca=this.menuBtnInfo,Cc=Ca&&Ca.menuCfg,CZ=Cc&&Cc.menus,Cb=(CZ&&CZ.length>0)&&!BD.isTouchOptimizationEnabled(),CX=Ca&&Ca.btn,CY=this.dragIcon;if(CX){CX.style.display=Cb?"block":"none";}Be.toggleClass(this.domNode,CD,!Cb);AG(CY,this.draggable&&!Cb&&!mstrApp.isAppStatePresentation());}function B9(CX,CZ){var CY=this.getContextDragData(CX);return !!(CY&&(CY.src===CZ));}function AW(CX){return B9.call(this,CX,BI.FILTERS);}function CI(CX){return B9.call(this,CX,BI.DATASETS);}function A3(CX){return B9.call(this,CX,BI.ALL_OBJECT_LIST);}function BE(CX){return B9.call(this,CX,BI.VIZ_GALLERY);}function AI(CX){var CY=CX.children;if(CY&&CY.length){CX.removeChildren();CY.forEach(function(CZ){CZ.destroy();});}}function a(){var CX=this.boxContent;if(CX&&CX.getFormats){return CX.getFormats();}return null;}function Bn(CX){if(CX.visible){if(CX.controls){this.showControlOverlay(CX.controls);}else{throw new Error('mstrmojo.vi.ui.rw.UnitContainer: "controls" should be provided when showing the control overlay');}}else{this.hideControlOverlay();}}function BK(Cb,CY){var CZ=this.model.controller,Ca="propertiesPanel",CX=function(){var Cd=this.getFormatMenuItemTarget(Cb);var Cf=this.getEditorModel();if(Cf.selectTargetByValue){Cf.selectTargetByValue(Cd,Cb&&Cb.data);}if(CY){CY(Cd);}var Cc=CZ.getViPanel(Ca),Ce=Cc&&Cc.parent;if(Ce&&Ce.highlightSelected){Ce.highlightSelected();}}.bind(this);if(CZ.getViPanel(Ca)){CZ.selectViPanel(Ca);CX();}else{CZ.openViPanel(Ca,{success:CX});}}function BY(CZ,CX){var CY=CZ?"titlebarNode":"domNode";this.clearCache();this.clearSlotBackgroundCSS(CY);this.applyCSSFormatToNode(CY,CX);}mstrmojo.vi.ui.rw.UnitContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._HasPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState,mstrmojo.vi._MonitorsLayoutMode,mstrmojo.vi.ui._HasTargets,mstrmojo.vi.ui.rw._HasVisFilterIndicator,mstrmojo.vi.ui._CanGroup,mstrmojo.util.ui._HostsSplitter,mstrmojo.vi.ui.rw._boxCornerResizer,mstrmojo.vi.ui._CanFreeformGroup,mstrmojo.vi.ui._SupportLayerNode,mstrmojo.vi.ui.rw._SupportTabNav],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainer",markupString:'<div id="{@id}" tabindex = "-1" role="widget" aria-label="{@en@ariaLabel}" class="mstrmojo-UnitContainer {@cssClass}" style="{@cssText} {@domNodeCssText}" mstrAttach:'+Bk.join(",")+'><div class="mstrmojo-UnitContainer-SplitterHost"><div class="mstrmojo-UnitContainer-ContentBox"><div class="mstrmojo-UnitContainer-titlebar" style="{@titlebarNodeCssText}"></div><div class="mstrmojo-UnitContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild.childNodes[1];},splitterHostNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.firstChild.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||M;},ondraggableChange:function(){if(this.titleBar.lblTitle.domNode){this.titleBar.lblTitle.domNode.style.cursor=this.draggable?"move":"auto";}if(!this.draggable){AG(this.dragIcon,this.draggable&&!this.getTitleBarVisibility());}},onresizableChange:function(){if(this.resizerCache){var CX=this;this.resizerCache.forEach(function(CZ,CY){CZ.style.cursor=CX.resizable?(CY&2?"s":"n")+(CY===0||CY===3?"w":"e")+"-resize":"auto";});this.splitterCache.forEach(function(CZ,CY){CZ.style.cursor=CX.resizable?(CY%2?"ns":"ew")+"-resize":"auto";});}},onmaxRestoreActiveChange:function(){if(this.maxRestoreBtnNode){this.maxRestoreBtnNode.style.display=this.maxRestoreActive&&this.toolbarActive?"":"none";}},ontoolbarActiveChange:function(){if(this.menuBtnInfo&&this.menuBtnInfo.btn){this.menuBtnInfo.btn.style.display=this.toolbarActive?"":"none";}},oneditableChange:function(){this.editable=this.editable&&mstrApp.allowWebDashboardDesign();var CX=this.editable;if(this.titleBar.lblTitle){this.titleBar.lblTitle.set("editOnDoubleClick",CX);}this.set("draggable",CX);this.set("resizable",CX);},onenabledChange:function(){Be.toggleClass(this.domNode,"inactive",!this.enabled);},onorientationChange:function(){var CY=this.ctrlOverlay.domNode,CX=this.orientation;Be.toggleClass(CY,Aq,CX==="v");Be.toggleClass(CY,AL,CX==="h");this.orientationHasChanged();},onghostImgCssChange:function(){var CY=this.ctrlOverlay.domNode,CX=this.ghostImgCss;Be.removeClass(CY,D);Be.addClass(CY,CX);},onariaLabelChange:function(){this.domNode.setAttribute("aria-label",A4.encodeHtmlString(this.ariaLabel,true));},ontitleChange:function(){this.updateAriaLabel();}},layoutConfig:{h:{titlebarNode:"auto",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},formatHandlers:{domNode:["B","BG"],titlebarNode:{src:"ttl",props:["F","BG","text-align"]}},ariaLabel:"",updateOverlay:mstrmojo.emptyFn,getCacheKey:function h(){return this._super()+"-vi-uc";},getPanelForAddAction:function k(){return"propertiesPanel";},getExcludedPanels:function A(){return["editPanel"];},getEditorPanelContents:function Ah(CY,CZ,CX){return undefined;},getEditorPanelContentsBase:function c(Cm,Cd,Ct){var Cs=this,Cn=[],Ce=Cs.openMoreOptions;var Ci=(!!mstrApp.isWSStyling)?"mstrmojo.vi.ui.VisualizationEditorPanelPortlet":"mstrmojo.vi.ui.PanelPortlet",Ch=function(Cu){return{scriptClass:Cu.scriptClass==="mstrmojo.gmaps.MapLayerZone"?"mstrmojo.vi.ui.PanelPortlet":Ci,title:Cu.n,panelId:Ct,canCollapse:false,enabled:Cu.enabled,portletSrc:Cu,children:[Cu]};},Cr=function(Cw){var Cv=Cm.getEditorListCls?Cm.getEditorListCls(Cw):"mstrmojo.vi.ui.VisualizationEditorUnitList",Cu={scriptClass:Ci,title:Cw.n,getTitleBarCfg:function(){return At.copy({useRichTooltip:true,shouldShowTooltip:function(){return true;},getTooltipContent:function(){return Cw.title;}},this.constructor.prototype.getTitleBarCfg.call(this));},panelId:Ct,canCollapse:false,enabled:Cw.enabled,portletSrc:Cw,children:[{scriptClass:Cv,items:Cw.items,alias:"unitList",cssClass:Cw.cssClass,panelId:Ct,zonesModel:Cm,zonesSource:Cw}]};if(Cw.siblings){Cu.children=Cu.children.concat(Cw.siblings);}return Cu;},Ck=[],Cf=Cm.docModel.datasets,Cq=function(Cu){(Cu||[]).forEach(function(Cv){if(Cv.usedInDropZones){Cv.usedInDropZones=false;}});},CZ=function(Cu,Cw){var Cv=Bz.find(Cu,"did",Cw.did);if(Cv>-1){Cu[Cv].usedInDropZones=true;return true;}return false;},Cc=new mstrmojo.ui.menus.ToolbarConfig({supportsScroll:true,alignWithAnchor:true,isHostedWithin:false,maxHeight:BD.getMaxScrollHeight()});(Cd.zones||[]).forEach(function(Cu){Ck=Ck.concat(Cu.items);});var Co=this.isAMSelector();if(!Co){if(Cm.canSwapAxis()){Cc.addToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap",function(){Cm.swapAxis();});}else{Cc.addDisabledToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap");}if(Cm.canDefineSubtotals()){Cc.addToggleToolbarButton(mstrmojo.desc(6193,"Show Totals"),"totals",function(){Cm.showQuickSubtotals();},function(){Cm.hideDefinedSubtotals();},null,Cm.hasVisibleSubtotals());}else{Cc.addDisabledToolbarBtn(mstrmojo.desc(6193,"Show Totals"),"totals");}}var CX=function(Cz,Cy){var Cx=Cz&&Cz.boxContent,Cv=Cx&&Cx.isVisMap,Cw,Cu=Cy.docModel;if(!mstrApp.isInVFConfigMode&&Cx.isInFilterPanel&&Cx.isInFilterPanel()){if(Cv){Cw=Cu.clearVisAsFilterActionForMapLayer(Cz,Cx.getEditingHost(),false);}else{Cw=Cu.clearVisAsFilterAction(Cz,false);}}Cy.clearAllDropZones(Cw);};var Cj=mstrmojo.all[Cm.hostId];if(Co){Cc.addToolbarBtn(mstrmojo.desc(14389,"Remove Data"),"clearall",function(){Cs.objects=[];Cs.getUpdateCandAction();});}else{Cc.addToolbarBtn(mstrmojo.desc(14389,"Remove Data"),"clearall",function(){CX(Cs,Cm);});}if(Ce){Cc.addToolbarDivider();Cc.addToolbarBtn(mstrmojo.desc(9126,"More Options"),"moreOptions",Ce.bind(Cs));}Cn.push({scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",visible:true,useRichTooltip:true,cssClass:"VizEditorToolbar",getItemMarkup:function Cb(Cu){return this.constructor.prototype.getItemMarkup.call(this,Cu).replace("{@en@n}",'<div class="icn"></div>');},getLayoutOffsets:function(){return{w:6};}});At.keyarray(Cf).forEach(function(Cu){Cq(Cf[Cu].att);Cq(Cf[Cu].mx);(Ck||[]).forEach(function(Cv){if(!CZ(Cf[Cu].att,Cv)){CZ(Cf[Cu].mx,Cv);}});});(Cd.zones||[]).forEach(function(Cu){if(Cu.scriptClass){Cn.push(Ch(Cu));}else{Cn.push(Cr(Cu));}});if(Co){var Cp=this.id,Ca=this.selectorHasSource(),CY=this.hasTargets(),Cg=function(Cu){var Cv=mstrmojo.all[Cp];mstrApp.rootCtrl.view.openInlineDialog({scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",vis:Cv});Cu.cancel();},Cl=mstrmojo.Button.newWebButton(CY?mstrmojo.desc(16874,"Edit Targets"):mstrmojo.desc(13629,"Select Targets"),Ca?Cg:mstrmojo.emptyFn,true,{alias:"btnSelect",enabled:Ca});Cl.cssClass+=" btn-select-targets";Cn.push(Cl);}return{contents:Cn,toolbarCfg:Cc};},titleBarCss:"",orientation:"h",k:"",boxContent:null,parent:null,enabled:true,isUnitContainer:true,draggable:true,editable:true,resizable:true,ctrlOverlay:null,model:null,title:"",titleBar:null,showTitleBar:false,bubbleMouseOver:true,dimensionsSet:false,getEditOverlayControls:mstrmojo.emptyFn,isNewUnitContainer:false,ghostImgCss:[],isGhstImgVisible:false,splittersInfo:null,resizerInfo:null,splitterCache:null,resizerCache:null,timer:null,shouldShowCustomizeContextMenu:function(CX){var CY=CX.getTarget(),CZ=CY&&CY.nodeName.toLowerCase();return CZ&&!(CZ==="textarea"||(CZ==="input"&&CY.type.toLowerCase()==="text"));},switchToEditMode:function b(){this.showControlOverlay(this.getEditOverlayControls());},init:function CL(CZ){this._super(CZ);var Cc=this.id,CY=this.model,Cb=this.boxContent,CX;CY.attachEventListener(Bs.SELECT_UNIT,Cc,function(Cd){var Ce=this;if(!((Cd&&(Cd.ctrlKey||Cd.metaKey)&&!mstrApp.isLayoutModePreview())&&Ce.model._multiSelectUnits&&Ce.model.isCurPanelManual())){this.toggleBoxSelection(Cc===Cd.id);}if(Ce.model.isCurPanelManual()){if(Cc===Cd.id&&this.parent.groupTreeLayoutConfig&&this.parent.groupTreeLayoutConfig.getFloatGroupTree()){this.selectGroup();}}});CY.attachEventListener("viIconTabClicked",Cc,function(Ce){var Cd=CY.hgl;if(CY.getSelectedViUnit()&&Ce.id!=="vi_flt"&&!Cd){E.call(this,Cc===CY.getSelectedViUnit().id,true,false);}});CY.attachEventListener("viVizEditorDrag",Cc,function(Ce){var Cd=CY.hgl;if(CY.getSelectedViUnit()&&Ce.id!=="vi_flt"&&!Cd){E.call(this,Cc===CY.getSelectedViUnit().id,false,!Ce.isIn);}});this.addChildren([this.getTitleBarCfg(),{scriptClass:"mstrmojo.Box",cssClass:A7,alias:"ctrlOverlay",slot:"containerNode",visible:false}],0);CX=this.titleBar;if(CX&&CX.tbToolbar){CX.tbToolbar.toolbarClicked=function(){CY.selectVIUnit(Cc);};}this.menuBtnInfo={};this.showTitleBar=!!this.defn.httl;this.draggable=mstrApp.allowWebDashboardDesign();Cb.attachEventListener("toggleCtrlOverlay",this.id,Bn);var Ca=Cb.edtModel;if(Ca){Ca.attachEventListener("BEMFormatChange",this.id,"updateGhostImgCss");}this.applyNoFillClass();},getDocModel:function t(){return this.model;},getBoxBorderWidth:function S(){var CX=a.call(this),Ca=CX&&CX.border;if(Ca){if(mstrApp.isExporting||!this.domNode){var Cb=[2.66,5.34];return Ca.indexOf("2pt")>-1?Cb[1]:Cb[0];}var CZ=window.getComputedStyle(this.domNode),CY=2*parseFloat(CZ["border-width"]||CZ.borderTopWidth);return CY;}return 0;},onFormat:function BZ(){var CX=this.boxContent;if(CX.execFormatHandler){CX.execFormatHandler();return ;}BK.call(this);},showControlOverlay:function AY(CZ,CY){var Ca=this.ctrlOverlay,Cb=Ca.domNode;if(Cb){var CX=[A7];CX.push((this.orientation==="v")?Aq:AL);CX=CX.concat(this.ghostImgCss);if(CY){CX.push(CY);}Cb.className=CX.join(" ");}Ca.set("visible",true);AI(Ca);if(CZ){Ca.addChildren(CZ);this.isGhstImgVisible=true;}},hideControlOverlay:function BJ(){var CX=this.ctrlOverlay;CX.set("visible",false);AI(CX);this.isGhstImgVisible=false;},editingTitleCallback:function Bp(CX){var CY=this.menuBtnInfo;Be.toggleClass(CY.btn,"editing-title",CX);},getTitleBarCfg:function Bf(){return{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar",slot:"titlebarNode",alias:"titleBar",title:this.title,editTitleOnDoubleClick:mstrApp.allowWebDashboardDesign(),beganEditingTitlebar:function CZ(){this.parent.editingTitleCallback(true);},titleEdited:function CX(){this.parent.editingTitleCallback(false);},close:function(){this.parent.deleteSelf();},getLayoutOffsets:function CY(){return{h:mstrApp.getThemeProps(mstrmojo.vi.enums.EnumThemeProperties.SUBTYPE.LAYOUT).ucTBLOHeight,w:1};}};},getDisplayName:function Bm(){return this.title;},updateDisplayName:function CO(Ca,Cb,Cc,CX){var CY=this.model,CZ=this.k;if(CX){CY.renameRWUnitTitle(Ca,Cb,CZ,AH.wrapMethods({success:function(Cd){this.set("title",Cd);}.bind(this),failure:function(Cd){mstrmojo.err(Cd);this.set("title",Cb);}.bind(this)},Cc));}else{CY.renameRWUnit(Ca,Cb,CZ,AH.wrapMethods({success:function(){this.set("title",Ca);this.synchronizeEditors();}.bind(this)},Cc));}},ontitleChange:function m(){this.titleBar.set("title",this.title);if(!this._skipLayerUpdate&&this.parent){this.parent.buildLayers();}},oncontextmenu:function Bb(Cj){if(mstrApp.isDossier){this.toggleTitleBarButtonCSS(false);}if(mstrApp.isInVFInteractMode||(this.boxContent&&this.boxContent.isCustomSort)){BD.preventDefault(window,Cj.e);}else{if(this.shouldShowCustomizeContextMenu(Cj)){var Cq=this.addContextMenuItems(new mstrmojo.ui.menus.MenuConfig({position:BD.getMousePosition(Cj.e,Cj.hWin),isHostedWithin:false}),Cj);BD.preventDefault(window,Cj.e);var Cl=this.model&&this.model._multiSelectUnits,Cg=this.parent.boxLayoutConfig,Cn=function Ci(){var Cw=Cg.box.floatChildren.children,Cv=Cb.getMultiSelectUnits(),Cu=Cv.map(function(Cx){return mstrmojo.all[Cx];}),Ct={},Cs;Cw.forEach(function(Cz){if(Cz.t==="g"){var Cx=Cz.children;for(var Cy=0;Cy<Cx.length;Cy++){Cs=Ch.parent.getUnitByKey(Cx[Cy].k);if(!Ct[Cz.k]&&Cv.indexOf(Cs.id)!==-1){Ct[Cz.k]=Cz;}}}else{Cs=Ch.parent.getUnitByKey(Cz.k);if(Cv.indexOf(Cs.id)!==-1){Ct[Cz.k]=Cz;}}});return Ct;};if(!!Cl&&Cl.length>1&&Cg&&this.model.isCurPanelManual()&&!mstrApp.isLayoutModePreview()){var Ch=this,Cb=this.model,Ce=function Ce(Cs){Ch.parent.saveBoxLayout(Cs);},Cc=function Cc(Ct,Cs){return{execute:function(){Ce(this);},urInfo:{callback:mstrmojo.DocDataService.EMPTY_CALLBACK,extras:mstrmojo.DocDataService.SUPPRESS_DATA},undoUIState:Ct,redoUISTate:Cs};},Co=Cn(),Ca=function Ca(Cu,C0,Cy,Cw,Cs,Cv){Cu.preBoxOp();if(!Cv){Cy(Cu,Cs);}Cg.updateFloatLayout(null,Cu);Cu.updateSelfSplitter();Cu.parent.snapGuide.boxIntervalOperations(Cu,"insert");var Ct=Cu.parent.model.getUIState(),Cx=Cw.length,Cz=Cw.indexOf(Cu);if((!Cv&&Cz===Cx-1)||(!!Cv&&Cz===Cx-2)){Cb.execute(Cc(C0,Ct));}},Cf=function Cf(Cw){var Cy=Number.MAX_VALUE,Cv=Number.MAX_VALUE,Cu=0,C0=0,Cx;if(Bz.isArray(Cw)){Cx=Cw.map(function(C6){var C5=mstrmojo.all[C6],C4=C5.domNode.style,C3=!!C5.getBoxBorderWidth?parseInt(C5.getBoxBorderWidth(),10):0;Cy=Math.min(parseInt(C4.top,10),Cy);Cv=Math.min(parseInt(C4.left,10),Cv);Cu=Math.max(parseInt(C4.left,10)+parseInt(C4.width,10)+C3,Cu);C0=Math.max(parseInt(C4.top,10)+parseInt(C4.height,10)+C3,C0);return C5;});}else{for(var C2 in Cw){var C1=Cw[C2],Ct=!!C1.getBoxBorderWidth?parseInt(C1.getBoxBorderWidth(),10):0;Cy=Math.min(parseInt(C1.top.split("|")[1],10),Cy);Cv=Math.min(parseInt(C1.left.split("|")[1],10),Cv);Cu=Math.max(parseInt(C1.left.split("|")[1],10)+parseInt(C1.width.split("|")[1],10)+Ct,Cu);C0=Math.max(parseInt(C1.top.split("|")[1],10)+parseInt(C1.height.split("|")[1],10)+Ct,C0);}}var Cs=Math.floor((C0+Cy)/2),Cz=Math.floor((Cv+Cu)/2);return{vizArr:Cx,lowestTop:Cy,lowestLeft:Cv,biggestRight:Cu,biggestBottom:C0,center:Cs,mid:Cz};},CY=function CY(Cx,Cz,Cy){var Cs=0,C1,Cu,C0;for(var Cv=1;Cv<Cx.length;Cv++){C1=Cx[Cv];Cu=Cx[Cv-1];C0=!Cy?parseInt(Cu[Cz?"top":"left"],10)+parseInt(Cu[Cz?"height":"width"],10):parseInt((Cu[Cz?"top":"left"]).split("|")[1],10)+parseInt((Cu[Cz?"height":"width"]).split("|")[1],10);var Cw=!Cy?parseInt(C1[Cz?"top":"left"],10):parseInt((C1[Cz?"top":"left"]).split("|")[1],10),Ct=Cw-C0;Cs+=Ct;}return Cs/(Cx.length-1);},CZ=function CZ(Cv){var Ct=Cf(Cb._multiSelectUnits),Cs=Ct.vizArr,Cu=Ch.parent.model.getUIState();Bz.forEach(Cs,function(Cw){Ca(Cw,Cu,Cv,Cs,Ct);});Ch.parent.applyGroupTree();},Ck=function Ck(C0,Cw){var Cz=C0==="v",Cs=Cf(Cb.getMultiSelectUnits()),C2=Cw.parent.model.getUIState(),Cx=Cs.vizArr.sort(function(C4,C3){var C6=parseInt(C4[Cz?"top":"left"],10)+parseInt(C4[Cz?"height":"width"],10)/2,C5=parseInt(C3[Cz?"top":"left"],10)+parseInt(C3[Cz?"height":"width"],10)/2;return C6-C5;}),Ct,C1,Cy=CY(Cs.vizArr,Cz),Cu;for(Cu=1;Cu<Cx.length-1;Cu++){var Cv=Cx[Cu];Ct=Cx[Cu-1];C1=parseInt(Ct.domNode.style[Cz?"top":"left"],10)+parseInt(Ct[Cz?"height":"width"],10);Cv.domNode.style[Cz?"top":"left"]=C1+Cy+"px";Ca(Cv,C2,null,Cx,Cs,true);}},CX=function(C3){var C2=Cb.getMultiSelectUnits().map(function(C9){return mstrmojo.all[C9];}),Cs=Cf(Co),C8=Ch.parent.model.getUIState();for(var C5 in Co){var C4=Co[C5];if(C4.t==="g"){var Cw=parseInt(C4.left.split("|")[1]),Ct=parseInt(C4.width.split("|")[1]),C1=parseInt(C4.top.split("|")[1]),C7=parseInt(C4.height.split("|")[1]);switch(C3){case"left":C4.delta={x:Cs.lowestLeft-Cw,y:0};break;case"right":C4.delta={x:Cs.biggestRight-Cw-Ct,y:0};break;case"top":C4.delta={x:0,y:Cs.lowestTop-C1};break;case"middle":C4.delta={x:0,y:Cs.center-(C1+Math.floor(C7/2))};break;case"center":C4.delta={x:Cs.mid-(Cw+Math.floor(Ct/2)),y:0};break;default:C4.delta={x:0,y:Cs.biggestBottom-C1-C7};}}else{C4=Ch.parent.getUnitByKey(C5);C4.preBoxOp();var Cy=C4.domNode.style,Cw=parseInt(Cy.left,10),Ct=parseInt(Cy.width,10),C1=parseInt(Cy.top,10),C7=parseInt(Cy.height,10),Cz=!!C4.getBoxBorderWidth?parseInt(C4.getBoxBorderWidth(),10):0;switch(C3){case"left":C4.domNode.style.left=Cs.lowestLeft+"px";break;case"center":C4.domNode.style.left=(Cw+(Cs.mid-(Cw+Math.floor(Ct/2)+Math.floor(Cz/2))))+"px";break;case"right":C4.domNode.style.left=(Cw+(Cs.biggestRight-Cw-Ct-Cz))+"px";break;case"top":C4.domNode.style.top=Cs.lowestTop+"px";break;case"middle":C4.domNode.style.top=(C1+(Cs.center-(C1+Math.floor(C7/2)+Math.floor(Cz/2))))+"px";break;case"bottom":C4.domNode.style.top=(C1+(Cs.biggestBottom-C1-C7-Cz))+"px";break;}Cg.updateFloatLayout(null,C4);C4.updateSelfSplitter();C4.parent.snapGuide.boxIntervalOperations(C4,"insert");}}for(var C5 in Co){var C4=Co[C5];if(C4.t==="g"){var Cv=C4.children;for(var Cx=0;Cx<Cv.length;Cx++){var Cu=Ch.parent.getUnitByKey(Cv[Cx].k),C0=parseInt(Cu.domNode.style.left,10),C6=parseInt(Cu.domNode.style.top,10);Cu.preBoxOp();if(C3==="left"||C3==="center"||C3==="right"){Cu.domNode.style.left=C0+C4.delta.x+"px";}else{Cu.domNode.style.top=C6+C4.delta.y+"px";}Cg.updateFloatLayout(null,Cu);Cu.updateSelfSplitter();Cu.parent.snapGuide.boxIntervalOperations(Cu,"insert");}}}Cb.execute(Cc(C8,Ch.parent.model.getUIState()));Ch.parent.applyGroupTree();},Cm=function Cm(C5){var C2=Cb.getMultiSelectUnits().map(function(C9){return mstrmojo.all[C9];}),C4=C5==="v",Cs=Cf(Co),Cw=Cp.sort(function(DA,C9){var DC=parseInt(DA[C4?"top":"left"],10)+parseInt(DA[C4?"height":"width"],10)/2,DB=parseInt(C9[C4?"top":"left"],10)+parseInt(C9[C4?"height":"width"],10)/2;return DC-DB;}),Cz=At.clone(Cw),C8=Ch.parent.model.getUIState(),C6,Cv,C3=CY(Cz,C4,true);for(var Cy=1;Cy<Cz.length;Cy++){C6=Cz[Cy];var C1=Cz[Cy-1],C7=parseInt(C1[C4?"top":"left"].split("|")[1],10)+parseInt(C1[C4?"height":"width"].split("|")[1],10);if(C6.t==="g"){var C0=parseInt(C6[C4?"top":"left"].split("|")[1],10);Cz[Cy][C4?"top":"left"]="|"+(C7+C3)+"px";if(C4){C6.delta={x:0,y:C7+C3-C0};}else{C6.delta={x:C7+C3-C0,y:0};}}else{Cv=Ch.parent.getUnitByKey(C6.k);Cz[Cy][C4?"top":"left"]="|"+(C7+C3)+"px";}}for(Cy=1;Cy<Cz.length;Cy++){C6=Cz[Cy];if(C6.t==="g"){var Cu=C6.children;for(var Cx=0;Cx<Cu.length;Cx++){var Ct=Ch.parent.getUnitByKey(Cu[Cx].k);Ct.preBoxOp();if(C4){Ct.domNode.style.top=parseInt(Ct.domNode.style.top,10)+C6.delta.y+"px";}else{Ct.domNode.style.left=parseInt(Ct.domNode.style.left,10)+C6.delta.x+"px";}Cg.updateFloatLayout(null,Ct);Ct.updateSelfSplitter();Ct.parent.snapGuide.boxIntervalOperations(Ct,"insert");}}else{Cv=Ch.parent.getUnitByKey(C6.k);Cv.domNode.style[C4?"top":"left"]=C6[C4?"top":"left"].split("|")[1];Cg.updateFloatLayout(null,Cv);Cv.updateSelfSplitter();Cv.parent.snapGuide.boxIntervalOperations(Cv,"insert");}}Cb.execute(Cc(C8,Ch.parent.model.getUIState()));};Cq.menus.length=0;var Cd=false,Cp=[];for(var Cr in Co){Cp.push(Co[Cr]);}if(Cp.length>1&&Cp.some(function(Cs){return Cs.children;})){Cd=true;}Cq.addMenuItem(mstrmojo.desc(3499,"Align Left"),"align align-left",function(){if(!Cd){CZ(function(Ct,Cs){Ct.domNode.style.left=Cs.lowestLeft+"px";});}else{CX("left");}});Cq.addMenuItem(mstrmojo.desc(3500,"Align Center"),"align align-center",function(){if(!Cd){CZ(function(Cv,Cs){var Cu=Cv.domNode.style,Ct=!!Cv.getBoxBorderWidth?parseInt(Cv.getBoxBorderWidth(),10):0;Cv.domNode.style.left=(parseInt(Cu.left,10)+(Cs.mid-(parseInt(Cu.left)+Math.floor(parseInt(Cu.width)/2)+Math.floor(Ct/2))))+"px";});}else{CX("center");}});Cq.addMenuItem(mstrmojo.desc(3501,"Align Right"),"align align-right",function(){if(!Cd){CZ(function(Cv,Cs){var Cu=Cv.domNode.style,Ct=!!Cv.getBoxBorderWidth?parseInt(Cv.getBoxBorderWidth(),10):0;Cv.domNode.style.left=(parseInt(Cu.left,10)+(Cs.biggestRight-parseInt(Cu.left,10)-parseInt(Cu.width,10)-Ct))+"px";});}else{CX("right");}});Cq.addSeparator();Cq.addMenuItem(mstrmojo.desc(3502,"Align Top"),"align align-top",function(){if(!Cd){CZ(function(Ct,Cs){Ct.domNode.style.top=Cs.lowestTop+"px";});}else{CX("top");}});Cq.addMenuItem(mstrmojo.desc(3503,"Align Middle"),"align align-middle",function(){if(!Cd){CZ(function(Cv,Cs){var Cu=Cv.domNode.style,Ct=!!Cv.getBoxBorderWidth?parseInt(Cv.getBoxBorderWidth(),10):0;Cv.domNode.style.top=(parseInt(Cu.top,10)+(Cs.center-(parseInt(Cu.top)+Math.floor(parseInt(Cu.height)/2)+Math.floor(Ct/2))))+"px";});}else{CX("middle");}});Cq.addMenuItem(mstrmojo.desc(3504,"Align Bottom"),"align align-bottom",function(){if(!Cd){CZ(function(Cv,Cs){var Cu=Cv.domNode.style,Ct=!!Cv.getBoxBorderWidth?parseInt(Cv.getBoxBorderWidth(),10):0;Cv.domNode.style.top=(parseInt(Cu.top,10)+(Cs.biggestBottom-parseInt(Cu.top,10)-parseInt(Cu.height,10)-Ct))+"px";});}else{CX("bottom");}});Cq.addSeparator();Cq.addMenuItem(mstrmojo.desc(3506,"Distribute Horizontally"),"align dist-h",function(){if(Cd){Cm("h");}else{Ck("h",Ch);}Ch.parent.applyGroupTree();});Cq.addMenuItem(mstrmojo.desc(3507,"Distribute Vertically"),"align dist-v",function(){if(Cd){Cm("v");}else{Ck("v",Ch);}Ch.parent.applyGroupTree();});this.addContextMenuGroupingMenuItem(Cq,Cl);this.openPopup(Cq.newInstance());}else{if(Cq.hasMenuItems()){this.addContextMenuGroupingMenuItem(Cq);this.openPopup(Cq.newInstance());}}}}Cj.cancel();},addContextMenuItems:function e(Cb,CX){var Ca=this.getEditorModel(),CY;if(Ca.getFormattingToolbar){CY=function(Cc){var Cd=Ca.getFormattingToolbar(Cc,CX.getTarget());if(Cd){this.openPopup(Cd);}}.bind(this);}var CZ=this.boxContent;if(CZ&&(CZ instanceof mstrmojo.SharedXtabBase||CZ instanceof mstrmojo.VisBase)){CC.addChangeVizContextMenu(Cb,CZ);}if(!mstrApp.isInVFConfigMode){this.addFormatMenuItem(Cb,CX,CY);}return Cb;},addFormatMenuItem:function AU(CZ,CY,CX){if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()){CZ.addMenuItem(mstrmojo.desc(1918,"Format"),"",function(){this.launchFormatEditor(CY,CX);}.bind(this));}return CZ;},launchFormatEditor:function Ad(CZ,CX){this.selectVIUnit();BK.call(this,CZ,CX);if(!!CZ&&mstrApp.supportFeature(y.DOSSIER_REACT_FORMAT_PANEL)){var CY=this.getFormatMenuItemTarget(CZ)===mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE?BV.TITLE_TAB:BV.PROPERTY_TAB;this.raiseEvent({name:"switchTab",tabId:CY});}},updateSelfSplitter:function AC(){if(this.getSplitterHost&&this.calculateContainerRect){this.calculateContainerRect();this.updateSplitters();}},preBoxOp:function Bq(){if(this.timer){clearTimeout(this.timer);if(this.originBox){this.parent.snapGuide.boxIntervalOperations([],"delete",this.originBox);this.originBox=null;}this.timer=null;}else{this.parent.snapGuide.boxIntervalOperations(this,"delete");}},shouldSaveBoxDimensionChange:function BW(){return !mstrApp.hasRequests();},postBoxOp:function B3(Cb,Cd,Ca,CY){var Cc=this.id,CZ=this.parent.id,CX=this.model;if(Cb){CY=CY||function(Cg){var Cf=mstrmojo.all[Cc],Ce=mstrmojo.all[CZ];Cf.updateLayout(Ca);Cf.raiseEvent({name:"member_snap_guide_changed_pre"});Ce.applyGroupTree(undefined,Cf.getPUKeys(false));Cf.updateSelfSplitter();Ce.snapGuide.boxIntervalOperations(Cf,"insert");Cf.raiseEvent({name:"member_snap_guide_changed_post"});Ce.saveBoxLayout(Cg);},exe={execute:function(){CY(this);},urInfo:{extras:mstrmojo.DocDataService.SUPPRESS_DATA}};if(Cd){exe.undoUIState=Cd;}if(this.shouldSaveBoxDimensionChange()){CX.execute(exe);}else{CY();}}},createGuidesDiv:function AN(CX){return this.parent.createGuidesDiv(CX);},updateGuidesDiv:function s(CZ,CY,CX){return this.parent.updateGuidesDiv(CZ,CY,CX);},toggleGuidesDiv:function Z(CY,CX){this.parent.toggleGuidesDiv(CY,CX);},getResizerInfo:function B5(CY,Cb){if(this.parent){var Ca=this.parent.parentRect,CZ=(this.parent.getScrollPosition&&this.parent.getScrollPosition())||{scrollLeft:0,scrollTop:0},Cc=Cb?this.splitterCache[CY].getBoundingClientRect():this.resizerCache[CY].getBoundingClientRect(),CX=Cc.left+CZ.scrollLeft,Cd=Cc.top+CZ.scrollTop;return{min:{x:Ca.left+4,y:Ca.top+4},max:{x:Ca.right-4,y:Ca.bottom-4},axis:{x:(Cb&&CY===AV||!(Cb&&CY===CS))?CX:CX+Ay,y:(Cb&&(CY===AV||CY===CS))?Cd:Cb?Cd+Ay:Cd+BX}};}},resizerMouseDown:function J(CX){if(!CX.skipGuideOperation){this.preBoxOp();}CX.parentRect=this.parent.parentRect;CX.parentScrollPos=(this.parent.getScrollPosition&&this.parent.getScrollPosition())||{scrollLeft:0,scrollTop:0};this.getSplitterHost().appendChild(CX.boxOverlay);},splitterMouseDown:function AE(){if(this.parent&&this.parent.snapGuide){this.preBoxOp();}},resizerMouseUp:function C(Ca,CY){var CX=CY.parentRect,CZ=CY.parentScrollPos,Cb={left:(Ca.x-CX.left-CZ.scrollLeft)+"px",top:(Ca.y-CX.top-CZ.scrollTop)+"px",width:Ca.width,height:Ca.height};this.getSplitterHost().removeChild(CY.boxOverlay);this.postResizerMouseUp(Cb);},postResizerMouseUp:function CG(Ca){var CZ=this,CX=this.parent,CY=this.model,Cb=CY.getUIState();CX.boxLayoutConfig.updateFloatLayout(Ca,CZ);this.postBoxOp(true,Cb,Ca);},getSplitterHost:function A2(){return this.splitterHostNode;},getSplitterInfo:function AS(Ca){if(this.parent){var CX=this.parent.parentRect,CY=this.domNode.getBoundingClientRect(),CZ=Ca.orientation;return{splitter:Ca,min:CZ&2?4:CZ%2?CX.top-CY.top+10:CX.left-CY.left+10,max:CZ&2?CZ%2?CX.bottom-CY.top-10:CX.right-CY.left-10:CZ%2?CY.height:CY.width};}},getNewNode:function Bg(CX,CY){var CZ=document.createElement("div");CZ.setAttribute("unselectable","on");CZ.className=CX;CZ.setAttribute("pos",CY%4);return CZ;},calculateContainerRect:function P(){if(!this.domNode){return ;}var CX=this,CY=this.getSplitterHost().getBoundingClientRect();["left","top","right","bottom"].forEach(function(CZ,Ca){(CX.splittersInfo=CX.splittersInfo||[]).push({left:(Ca%2?CY.left:CY[CZ]-3.5)+"px",top:(Ca%2?CY[CZ]-3.5:CY.top)+"px",width:(Ca%2?CY.width:7)+"px",height:(Ca%2?7:CY.height)+"px"});(CX.resizerInfo=CX.resizerInfo||[]).push({left:((Ca===0||Ca===3)?CY.left:(CY.right-5))+"px",top:(Ca&2?CY.bottom-5:CY.top-5)+"px",width:"7px",height:"7px"});});},updateSplitters:function AP(){if(!this.splittersInfo){return ;}var Cc=this,Ca=this.splitterCache=this.splitterCache||[],Cb=this.resizerCache=this.resizerCache||[],CZ=this.splittersInfo,CY=this.resizerInfo,Cd=this.getSplitterHost(),CX=this.getSplitterHost().getBoundingClientRect(),Ce=this.parent.maximizedBox;if(Cd){[].concat(CZ,CY).forEach(function(Cj,Ch){var Cg=Ch&1<<2?"resizer":"edge",Cf=Cg==="resizer"?"resizer":"splitter",Ck=this[Cf+"Cache"]||[],Ci=Ck[Ch%4];if(!Ci){Ck[Ch%4]=Ci=this.getNewNode(Cg,Ch);if(Cg==="edge"){Ci.style.position="absolute";Ci.isV=false;if((Ch%2)===0){Be.addClass(Ci,["v"]);Ci.isV=true;}Ci.style.cursor=Cc.resizable?(Ch%2?"ns":"ew")+"-resize":"auto";Ci.isSide=true;this.registerResizerHandler(Ci);}else{Ci.style.position="absolute";Ci.style.cursor=Cc.resizable?(Ch&2?"s":"n")+(Ch===4||Ch===7?"w":"e")+"-resize":"auto";this.registerResizerHandler(Ci);}if(!Ci.parentNode){Cd.appendChild(Ci);}}Cj.left=(parseFloat(Cj.left)-CX.left)+"px";Cj.top=(parseFloat(Cj.top)-CX.top)+"px";At.copy(Cj,Ci.style);Ci.style.display=(this.unDocked&&!mstrApp.isAppStatePresentation()&&!Ce&&!mstrApp.isLayoutModePreview())?"block":"none";Ci.style.zIndex=this.unDocked?this.zIndex:M;},this);this.splittersInfo=this.resizerInfo=null;}},splitterMoved:function By(Cp,Co){var Cf=this,CX=Co&&Co.splitter,Cg=mstrmojo.all[this.model.id].getPanel(),Cn=this.model.getUIState(),Cd=Cg.boxLayoutConfig,Ci=Cd.box.floatChildren,Cj=CX.orientation;if(CX){if(Cd&&Cd.findFloatKey(this)){var CZ=Cj%2?"height":"width",Cc=Bz.find(Ci,"k",this.k);if(Cc!==-1){var Cb=Ci[Cc],Cm=Cd.getBoxTreeRoots(Cg,Cb.rk),Ce=Cm[CZ],Cl=Cp/Ce*100,Ck=Cb[CZ].split("|"),Ca=parseFloat(Ck[0]),CY=parseFloat(Ck[1]);Cb[CZ]=Cj&2?(Ca+Cl)+"|"+(CY+Cp):(Ca-Cl)+"|"+(CY-Cp);if(!(Cj&2)){var Ch=Cj?"top":"left";Ck=Cb[Ch].split("|");Ca=parseFloat(Ck[0]);CY=parseFloat(Ck[1]);Cb[Ch]=(Ca+Cl)+"|"+(CY+Cp)+"px";}this.postBoxOp(true,Cn,Cg.calculateFloatBoxLayout(Cb,Cm,Cf.fixed));}}else{this.updateSplitters();}}},toggleDock:function BN(){this.unDocked=!this.unDocked;if(!this.unDocked){this.set("zIndex",1);}},getGroupOperationCallback:function x(Ca,CZ,Cb){var CY,CX,Cc=function(Cd,Ce,Cf){return function(){var Cg=Ce.parent,Ci=Cg.id,Ch=Cg.model,Ck=mstrmojo.DocDataService,Cj=Cg.model.getUIState();Ch.execute({execute:function(){var Cl=mstrmojo.all[Ci];Cf(Cd,Ce,Cb);Cl.applyGroupTree(undefined,CX);Cl.snapGuide.reconstructTree(Cl);Cl.saveBoxLayout(this);Cl.buildLayers();},urInfo:{extras:Ck.SUPPRESS_DATA},undoUIState:Cj});};};if(Ca==="ungroup"){CY=Cc(CZ,this,function(Cf,Ce){var Cg=Cf[0].getParentGroup(),Cd=Cg.parent;CX=[Cd.k].concat(Cg.getPUKeys());Cf.forEach(function(Ch){Ch.unGroup();});});}else{if(Ca==="moveToGroup"){CY=Cc(CZ,this,function(Ce,Cd,Cf){Ce.forEach(function(Cg){Cg.moveToGroup(Cf);});});}else{CY=Cc(CZ,this,function(Ce,Cd){var Cf=Cd.createGroup(Ce);Cf.editable=true;Cf.displayGroupNode(true,true);CX=undefined;});}}return CY;},addGroupingMenuItem:function Y(Ce,CX){if(!CX||CX.length===0){CX=[this];}var Cb=CX[0],Ca,Cd;for(var CZ=0;CZ<CX.length;CZ++){var Cc=CX[CZ];if(!Cc.editable){Ca=true;Cd=true;break;}if(Cc.isGrouped()){Ca=true;}else{Cd=true;}if(CX.length===1){Ca=true;}if(Ca&&Cd){break;}}var CY=[];if(Bz.find(Ce.getMenuItems(),"ctxt","group")<0&&!Ca){CY.push({text:mstrmojo.desc(17264,"Group"),cls:"",ctxt:"group",fn:Cb.getGroupOperationCallback("group",CX)});}if(Bz.find(Ce.getMenuItems(),"ctxt","ungroup")<0&&!Cd){CY.push({text:mstrmojo.desc(17333,"Remove from group"),cls:"",ctxt:"ungroup",fn:Cb.getGroupOperationCallback("ungroup",CX)});}if(CY.length>0){Ce.addSeparator();}CY.forEach(function(Cf){Ce.addMenuItem(Cf.text,Cf.cls,Cf.fn,Cf.ctxt);});},addToolbarGroupingMenuItem:function Bc(CX){if(At.walk("parent.groupTreeLayoutConfig.getFloatGroupTree",this)){this.addGroupingMenuItem(CX);}},addContextMenuGroupingMenuItem:function Q(CZ,CX){if(At.walk("parent.groupTreeLayoutConfig.getFloatGroupTree",this)){var CY=[this];if(CX&&CX.indexOf(this.id)>-1){CY=CX.filter(function(Ca){return Ca;}).map(function(Ca){return mstrmojo.all[Ca];});}this.addGroupingMenuItem(CZ,CY);}},addUnDockMenuItem:function BG(Cd){if(!mstrApp.isLayoutModePreview()&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)){var Cc=this.k,CX=this.parent;if(this.unDocked){if(CX.boxOperation&&CX.groupTreeLayoutConfig.getFloatGroupTree()&&this.editable){var Cb=[[true,true],[true,true]];if(CX.maximizedBox){Cb[0]=Cb[1]=[false,false];}else{var CY=CX.groupTreeLayoutConfig.getFloatGroupTreeNode(Cc);if(CY.parent){CY.parent.children.sort(function(Cg,Cf){return parseFloat(Cg.zIndex)-parseFloat(Cf.zIndex);});if(CY.parent.children[0].k===Cc){Cb[1]=[false,false];}else{if(CY.parent.children[CY.parent.children.length-1].k===Cc){Cb[0]=[false,false];}}}}var Ca=Cb.reduce(function(Cf,Cg){return Cf.concat(Cg);});var CZ=[{strId:3100,fn:"bringToFront"},{strId:3102,fn:"bringForward"},{strId:3099,fn:"sendToBack"},{strId:3101,fn:"sendBackward"}],Ce="";Bz.forEach(CZ,function(Cg,Cf){Ce=mstrmojo.desc(Cg.strId,Cg.fn);if(Ca[Cf]){Cd.addMenuItem(Ce,"",function(){CX.boxOperation(Cg.fn,CX.getUnitByKey(Cc));});}else{Cd.addDisabledMenuItem(Ce,"");}});}}}return Cd;},unrender:function U(){this.splitterCache=null;this.resizerCache=null;return this._super();},getFormatMenuItemTarget:function Bo(CX){return mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE;},applyBoxSize:function BB(CX,CZ,Cc,Cb){this._super(CX,CZ,Cc,Cb);this.dimensionsSet=true;var Ca=parseInt(CZ,10),Cd=parseInt(CX,10);var CY=Ca>Cd?"h":"v";if(CY!==this.orientation){this.set("orientation",CY);}this.set("ghostImgCss",o.call(this,Ca,Cd));},childRenderCheck:function AT(CY){var CX=this._super(CY);if(CY===this.boxContent){CX=CX&&this.dimensionsSet;}return CX;},postUpdateLayout:function Bi(Ca){var Cd=this.boxContent;var Cc=true;if(this._currentLayout&&Ca&&Math.abs(parseFloat(Ca.width)-parseFloat(this._currentLayout.width))<0.1&&Math.abs(parseFloat(Ca.height)-parseFloat(this._currentLayout.height))<0.1){Cc=false;}if(!this.domNode){return ;}if(!Cd.hasRendered){Cd.render();var CZ=this.parent,CX=this.model,CY=CX.getLatestSelectedViObjKey(),Cb=CY&&CZ.getUnitByKey(CY);if(Cb){CX.selectVIUnit(Cb.id);}else{CZ.selectFirstBox();}}else{if(Cc){this.updateVisFilterIndicator();Cd.refresh(null,!mstrApp.isPartialUpdate);}}this.isNewUnitContainer=false;},orientationHasChanged:mstrmojo.emptyFn,onRender:function H(){this._super();var CX=this.model.getSelectedViUnit();this.toggleBoxSelection(CX&&CX.k===this.k);},onAppStateChange:function Au(Cf){var Ca=mstrmojo.vi.VisualInsightApp.APP_STATES,Ce=Ca.SELECTOR_TARGETING,Cc=Ca.PRESENTATION,Cg=Ca.PAUSE,Cd=mstrApp.isAppStatePresentation(),CZ=mstrApp.isAppStatePause(),Cb=this.dragIcon;if(Cd||Cf.valueWas&Cc){this.draggable=!(Cd||mstrApp.isLayoutModePreview());this.generateToolbar();}if(Cf.valueWas&Ce||mstrApp.isAppStateSelection()||CZ||Cf.valueWas&Cg){this.generateToolbar();}var CX=this.model.getSelectedViUnit(),CY=CX&&CX.k===this.k;this.toggleBoxSelection(CY);if(Cb){AG(Cb,this.draggable&&!Cd&&CY&&!this.getTitleBarVisibility());}},onLayoutModeChange:function Ai(CX){var CY=mstrApp.isLayoutPreview(CX.value);this.set("editable",!(mstrApp.isAppStatePresentation()||CY));if(CY||mstrApp.isLayoutPreview(CX.valueWas)){this.generateToolbar();}},selectVIUnit:function Az(CX,CY){var CZ=this.parent;if(this.enabled&&CZ&&CZ.selectVIUnit&&!(mstrApp.isAppStateSelection()&&mstrApp.isLayoutModePreview())){var Cb=Bt.SURVEYCONTAINER;if(CZ._tgtSelections&&this.defn.t===Cb){var Ca=CZ.getTargetKeysByType([Cb]);Bz.forEach(Ca,function(Cc){var Cd=CZ.getUnitByKey(Cc);Cd.toggleBoxSelection(Cd.parent.selectVIUnit(Cd,CX,CY));});}else{if(this.defn.t!==Bt.PANELSTACK&&At.walk("e",CY)){CY.e.stopPropagation();}this.toggleBoxSelection(this.parent.selectVIUnit(this,CX,CY));}}},toggleTabSelectionEffect:function Ba(CX){if(this.domNode){Be.toggleClass(this.domNode,n.CSS_FOCUS_VISIBLE,CX);}},grabFocus:function I(CX){if(this._super){this._super();}this.selectVIUnit();this.toggleTabSelectionEffect(true);this.toggleTitleBarButtonCSS(true);if(CX){this.domNode.focus();}},loseFocus:function X(CX){if(this._super){this._super();}this.toggleTabSelectionEffect(false);this.toggleTitleBarButtonCSS(false);if(CX){this.domNode.blur();}},buildNavList:function CR(){if(At.walk("menuBtnInfo.btn",this)){this.navList=[this.menuBtnInfo.btn];}else{this.navList=[];}},isValidTarget:function Aw(CY){if(!this._super(CY)){return false;}var CX=true;if(CY.classList&&CY.classList.contains("invalid")){CX=false;}return CX;},enterUnit:function B7(){if(this.boxContentSupportAccessibility()){return ;}else{this.toggleTabSelectionEffect(false);this.resetTabNav();this.navigateToFirstValidTarget();}},boxContentSupportAccessibility:function B2(){return this.boxContent&&this.boxContent.canTab;},getLayerActionIconConfig:function Am(){var CX=this.parent,Ca=CX.model,Cd=CX._tgtSelections,Cc=Cd&&mstrmojo.all[Cd.id],Cb=!!Cd?Cd.getSelections():Ca.getMultiSelectUnitKeys(),Ce=!!At.walk("targetMask.candidatePicker.rplObj",this),CZ,CY=function(Cf,Ch,Cg){CZ={};CZ.cssClassName=Cf;CZ.role=Ch;CZ.ariaLabel=Cg;};if(!Cc){return undefined;}if(Cc.k===this.k){CY("source","img",mstrmojo.desc(4283,"Source"));}else{if(Cb.indexOf(this.k)!==-1){CY(!Cc.isAMSelector()?"target":Ce?"target with-default":"target without-default","button",!Cc.isAMSelector()?mstrmojo.desc(4787,"Target"):Ce?mstrmojo.desc(17531,"Target without a default value"):mstrmojo.desc(17532,"Target with a default value"));}}return CZ;},synchronizeEditors:function CM(){if(this.model.getLatestSelectedViObjKey()===this.k){this.selectVIUnit(true);}},addToggleTitleMenuItem:function AX(CX){var CY=[AQ,CB];if(!this.showTitleBar){CY.reverse();}CX.addDualStateItem(this.id,CY[0],CY[1]);},canShowDesignMenuItems:function B6(){return mstrApp.allowWebDashboardDesign();},updateToolbar:function Ae(CX){var CY=CX.ENUM_CORNERS,CZ=this.boxContent,Cb=CZ&&CZ.node,Ca=Cb&&(!Cb.defn.vis||!Cb.defn.vis.ve);CX.setAlignment(CY.BOTTOM_RIGHT,CY.TOP_RIGHT);CX.isHostedWithin=false;CX.showContextMenu=false;if(this.canShowDesignMenuItems()&&!mstrApp.isAppStatePresentation()){CX.addSeparator();if(!(mstrApp.isInVFConfigMode&&!Ca)){this.addFormatMenuItem(CX);}if(this.showTitleBar){CX.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.draggable=false;this.titleBar.editTitle();}.bind(this));}if(!(this.isContentDisabled&&this.isContentDisabled())&&this.editable&&undefined!==this.getEditOverlayControls()){CX.addMenuItem(mstrmojo.desc(3272,"Edit"),"cls",this.switchToEditMode.bind(this));}this.addDeleteMenuItem(CX);this.addUnDockMenuItem(CX);this.addToolbarGroupingMenuItem(CX);}return CX;},addDeleteMenuItem:function Ar(CY){if(!mstrApp.isLayoutModePreview()&&!(mstrApp.isInVFConfigMode||mstrApp.isInVFInteractMode)&&this.editable){var CX=this.k,CZ=this.model.id;CY.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){BO(CZ,CX).deleteSelf();});}return CY;},deleteSectionNodeDefn:function BR(Cd,CY,CZ){if(Cd&&CY&&CZ&&CZ.length){var Ca=function Cc(){var Cf=CY.getCGBMap(),Cg=CY.getCurrentLayoutDef(),Ce=Cg&&Cg.units;if(Cf&&Ce){Bz.forEach(CZ,function(Ch){delete Cf[Ch];delete Ce[Ch];});}};Cd.addCallbacks({success:Ca});var Cb=CY.cmdMgr(),CX=At.walk("curCmd.urInfo",Cb);if(CX){CX.callback=AH.wrapMethods({success:Ca},CX.callback||mstrmojo.emptyFn);}}},cleanSelfAndDescendants:function B4(){var CX=this.model,CZ=CX.data,CY=function(Cd,Cc){var Cb=CX.extractChildren(Cd),Ca;if(Cb){for(Ca=0;Ca<Cb.length;Ca++){if((Cb[Ca]&&Cb[Ca].k)===Cc){Bz.removeIndices(Cb,Ca,1);return ;}else{CY(Cb[Ca],Cc);}}}};CY(CZ,this.k);CX.deleteDataCache(this.boxContent&&this.boxContent.id);},deleteLastUnitHandler:function BT(CZ,CY,Ca,CX){if(!CZ){CY.addVisualizationDeferred(Ca,CX.k);}},deleteSelf:function F(Ck){var Cj,Cc=this.k,Ca=this.model,Ci=Ca.id,Cg=BO(Ci,Cc).parent,Ch=Cg.k,Cl=[Ch],CZ=[],CX={success:function(){var Co=Ca.getNodeDataByKey(Ch),Cm=Ca.getOwningNodeByType(Bt.PANELSTACK,Co.k),Cp=Ca.extractChildren(Cm.data),Cn=Bz.find(Cp,"k",Co.k);if(Cn>=0){Cp[Cn]=Co.data;}Co.p=Cm.data;}},Ce=AH.wrapMethods(Ca.getRebuildCallback(),CX,{}),CY=AH.wrapMethods({success:function(){var Cm=BO(Ci,Cc);Cm.cleanSelfAndDescendants();}},Ca.getRebuildCallback(),CX,{}),Cb=function(Cn){var Cm=mstrmojo.all[Ci];Cm.syncLayerDefn(Cc,Cj,Cn);};CZ=CZ.concat(Ca.getSourceFilterKeys(Cc,true));CZ=CZ.concat(Ca.getTargetFilterKeys(this));CZ=CZ.concat(Ca.getPanelSelectorKeys(this.k));this.model.execute({execute:function(){var Cn=BO(Ci,Cc);if(Cn){var Cm=Cn.parent,Co=mstrmojo.all[Ci],Cr=Co.getDataService().newUpdate();var Cp=Cm.hasMultipleChildren();Cr.addUpdate(Cn.createDeleteUpdate());Cj=Co.getMapLayerKeys(Cn.boxContent);Cr.addActions(Co.getDeleteMapLayersActions(Cj));Cr.addCallbacks({success:function Cq(Cs){Co.partialUpdate(Cs.data,Co.getTargetDefn(CZ),Cs.defn,CZ);Cn.cleanSelfAndDescendants();Co.syncLayerDefn(Cc,Cj,true);Cn.destroy();Cm.selectFirstBox(true);}});Cm.deleteBoxAndSubmitDeferred(Cr,Cn,null,true);Cn.deleteLastUnitHandler(Cp,Co,Cr,Cm);if(Cn.isMaxed){Cm.toggleCurtain(false);}Cm.selectFirstBox();Cm.buildLayers();Cr.addCallbacks(Ck);Cr.addExtras({style:{params:{treesToRender:0}}});this.submitUpdate(Cr);}},urInfo:{undo:function Cf(){Cb(false);this.urInfo.callback=Ce;},redo:function Cd(){Cb(true);this.urInfo.callback=CY;},puKeys:Cl,extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA}});},undoInsert:function Bw(){var CX=this.parent,CY=mstrmojo.all[this.model.id];CX.deleteBoxAndSubmitDeferred(CY.getDataService().newUpdate(),this,null,true);CX.selectFirstBox();CX.buildLayers();this.destroy();},createDeleteUpdate:function AF(){},getKeyDownHandler:function(CX){return function(CY){var Cb=BD.findWidget(this),Ca=Cb.boxContent,CZ=Cb.boxContentSupportAccessibility(),Cc=CZ?Ca:Cb;if(Cc.handleTab(CY,this)){return ;}switch(CY.keyCode){case mstrmojo.Enum_Keys.ESCAPE:CY.stopPropagation();if(this.loseFocus){this.loseFocus(true);}Cc.navigateToParent(!!CZ);if(!CZ){Cc.grabFocus(true);}break;case mstrmojo.Enum_Keys.ENTER:case mstrmojo.Enum_Keys.SPACE:CY.stopPropagation();CX(CY);break;}};},getTitleBarVisibility:function As(){return this.titleBar&&this.showTitleBar;},setTitleBarVisibility:function q(CX){var Cb=this.titleBar;Cb.set("visible",CX);var Cd=this.menuBtnInfo,CY=Cd&&Cd.btn;if(Cd){if(!Cd.menuCfg){Cd.menuCfg=Cb.getMenuConfig();}if(mstrApp&&mstrApp.isInVFInteractMode){Cd.menuCfg=null;}if(!CY){var Ca=this.boxContentSupportAccessibility(),CZ=Ca?this.boxContent.canTab:this.canTab;CY=Cd.btn=document.createElement("div");CY.className="hover-menu-btn";CY.setAttribute("tabindex","-1");CY.setAttribute("role","button");CY.setAttribute("aria-label",mstrmojo.desc(9917,"More"));var Ce=this.id;var Cc=function(Ch){var Cg=mstrmojo.all[Ce],Cf=Cd.menuCfg,Cj=Cg.boxContent.hasAccessibility||CZ;Cf.hostId=Ce;Cf.hostElement=CY;Cf.supportsScroll=true;Cf.isHostedWithin=false;Cf.maxHeight=BD.getMaxScrollHeight();Cf.hasAccessibility=Cj;var Ci=mstrmojo.ui.menus.Menu;if(CZ){Ci=mstrmojo.DynamicClassFactory.newComponent(Ci,[mstrmojo._IsAccessibleMenu,mstrmojo.vi.ui.rw._SupportTabNav]);Cg.boxContent.isMenuClicked=true;}else{if(Cj){Ci=mstrmojo.DynamicClassFactory.newComponent(Ci,[mstrmojo._IsAccessibleMenu]);Cg.boxContent.isMenuClicked=true;}}Cg.addToolbarGroupingMenuItem(Cf);var Ck=new Ci({popupConfig:Cf});if(Cj){Ck.onCloseMenuCallBack=Cg.onMenuClose;}if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()&&BD.isMobile){Ck.orientationAngle=window.orientation||At.walk("screen.orientation.angle",window);}Ck.navMode=n.isKeyBoardEvent(Ch);if(Ck.navMode){Cg.attachEventListenerOnce("menuClosed",Ce,function(Cl){if(Cl&&Cl.needFocus){this.menuBtnInfo.btn.grabFocus(true);}});}Cg.openPopup(Ck);Ch.preventDefault();};if(this.menuBtnInfo&&this.menuBtnInfo.btn){BD.attachEvent(this.menuBtnInfo.btn,"mousedown",function(){this.generateToolbar();}.bind(this));}BD.attachEvent(CY,"click",Cc);BD.attachEvent(CY,"keydown",this.getKeyDownHandler(Cc));if(CZ){n.enableAccessibility({domNode:CY});}}this.domNode.appendChild(CY);}AR.call(this);this.doLayout();},refresh:function Aj(){delete this._currentLayout;if(!this.parent.boxLayoutConfig.dirty){this._super();if(this.hasRendered&&this.parent.isManualMode()){this.updateSelfSplitter();}}else{BY.call(this,false,this.getFormats());BY.call(this,true,this.getFormats());}this.applyNoFillClass();},addFormatProps:function u(CY,CX){return CY;},isKBSupportEditing:function BC(){return !((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())||(mstrApp.isAppStateSelection&&mstrApp.isAppStateSelection())||mstrApp.isInVFConfigMode||mstrApp.isVisBuilder);},isKBSupportAccessibility:function A5(){return this.isKBSupportEditing()||(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation());},onkeydown:function CT(Ci){var Co=this,Cp=Ci.e.key,Cf=Co.parent,CY=Co.isKBSupportEditing(),Cj=Co.isKBSupportAccessibility(),Cd=Cf&&Cf.isRootPanel();if(!Cj||Co.isDragging||!Cf){return ;}if(Cp==="Escape"){this.loseFocus(true);}var Cc=Ci.e.keyCode,Ca=Ci.e.target,Ch=Cf.model?Bz.map(Cf.model._multiSelectUnits,function(Cr){return mstrmojo.all[Cr];}):[],Cg=Ch.length===1,Ck,Ce,CZ,Cn=function(){return Bz.some(Ch,function(Cv){if(Ci.keyboardSupport){var Cs=Ca&&Ca.tagName;return !(typeof Cs==="string"&&Cs.toUpperCase()==="INPUT");}var Cu=Ca===Cv.domNode||Ca===Cv.domNode.getElementsByClassName("hover-drag-icon-btn visible")[0];if(BD.isIE11){if(!!(Ca.getAttribute&&Ca.getAttribute("spellcheck"))){return false;}var Cr=BD.findAncestorByAttr(Ca,"onkeydown",true),Ct=function(Cw){return Bz.some(["mstmojo-ghostImgTableCell","ghost-vis-img","ctrlOverlay","hover-drag-icon-btn mouse-left"],function(Cx){return Cw.indexOf(Cx)!==-1;});};return Cu||(Ct(Ca.className)&&Cr&&Cr.node===Cv.domNode);}return Cu;});},Cl=function(){var Cs=document.createElement("div"),Cr=Cs.style;Cr.left="0px";Cr.top="0px";Cr.position="fixed";Cr.right="0px";Cr.bottom="0px";Cr.visible="true";Cr.opacity=0;Cr.zIndex=99999;Cs.id="disableClickOverlay";Cs.onclick=function(){Co.onkeyup({e:null,stopMoveNow:true});};document.body.appendChild(Cs);};if(!Cd){if(Cc===27){this.loseFocus(true);Ci.e.preventDefault();Ci.e.stopPropagation();var Cq=Cf.parent,CX=Cq&&Cq.parent;if(Cq.isSwitchModeNone()){CX.grabFocus(true);}else{Cq.restoreFocus();}return ;}}if(Cg&&Cc===mstrmojo.Enum_Keys.ENTER){CZ=Cn();}else{if(CY&&Cg&&(Cc===46||Cc===8)){Ce=Cn();}else{if(CY&&Cc>=37&&Cc<=40){Ci.e.stopPropagation();if(!this.isMaxed&&Cf.isManualMode()){Ck=Cn();}}}}if(Ce&&!Cf.isKeyboardMoving){Ci.e.preventDefault();Ci.e.stopPropagation();Bz.some(Ch,function(Cr){Cr.deleteSelf();});}else{if(Ck){var Cb;Ci.e.preventDefault();Ci.e.stopPropagation();window.clearTimeout(Cf.updatePanelDataTimer);if(!Cf.isKeyboardMoving){Cf.isKeyboardMoving=true;Cl();Bz.forEach(Ch,function(Cr){Cf.snapGuide.boxIntervalOperations(Cr,"delete");});}Cf.curKeyBoardMoveCount+=1;if(Ci.e.shiftKey){Cf.curKeyBoardMoveCount=0;Cb=10;}else{Cb=Math.min(Cf.maxKeyBoardMoveSpeed,Math.floor(Cf.curKeyBoardMoveCount/10)+1);}var Cm=Cf.getCanvasWidthAndHeight();Bz.forEach(Ch,function(Cs){var Cr;switch(Cc){case 37:Cr=parseFloat(Cs.left);if(Cr-Cb>=10-parseFloat(Cs.width)){Cs.set("left",Cr-Cb+"px");}break;case 38:Cr=parseFloat(Cs.top);if(Cr-Cb>=10-parseFloat(Cs.height)){Cs.set("top",Cr-Cb+"px");}break;case 39:Cr=parseFloat(Cs.left);if(Cr+Cb<=parseFloat(Cm.width)-10){Cs.set("left",Cr+Cb+"px");}break;case 40:Cr=parseFloat(Cs.top);if(Cr+Cb<=parseFloat(Cm.height)-10){Cs.set("top",Cr+Cb+"px");}break;}});}else{if(CZ){this.enterUnit();Ci.cancel();Ci.preventDefault();}}}},onkeyup:function l(CY){if(!this.isKBSupportEditing()){return ;}var CX=this.parent;if(CX&&CX.isKeyboardMoving){CY.e.preventDefault();CY.e.stopPropagation();CX.curKeyBoardMoveSpeed=1;CX.curKeyBoardMoveCount=0;var Ca=Bz.map(CX.model._multiSelectUnits,function(Cc){return mstrmojo.all[Cc];}),Cb=function(){CX.updateBoxDimensionByKeyBoardMove(Ca);CX.isKeyboardMoving=false;var Cc=document.getElementById("disableClickOverlay");if(Cc){document.body.removeChild(Cc);}};if(CY&&CY.stopMoveNow){Cb();}else{var CZ=At.walk("e.keyCode",CY);if(!(CZ&&CZ>=37&&CZ<=40)){return ;}CX.updatePanelDataTimer=window.setTimeout(function(){Cb();},300);}}},onclick:function BA(CX){CX.e.justSwitched=this.k!==this.getDocModel().getLatestSelectedViObjKey();this.selectVIUnit(null,CX);if(!CX.e.ptvSelected&&this.switchPropertyOnClick(CX)){this.boxContent.edtModel.selectTargetByValue(mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE);}if(At.walk("parent.updateCanTab",this)){this.parent.updateCanTab(true);}},switchPropertyOnClick:function BM(){var CX=this.boxContent.edtModel;return !!(CX&&CX.selectTargetByValue);},getZonesModel:function CJ(){return null;},getEditorModel:function AJ(){return this.boxContent.edtModel;},onmouseenter:function CQ(){var CY=this.menuBtnInfo,CX=this.dragIcon;if(CY&&CY.menuCfg){Be.addClass(CY.btn,G);Be.removeClass(CY.btn,B1);}if(CX&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()&&!mstrApp.isLayoutModePreview()){AG(CX,this.draggable);}if(At.walk("parent.groupTreeLayoutConfig.getFloatGroupTree",this)&&this.parent.groupTreeLayoutConfig.getFloatGroupTree()){var CZ=this.getParentGroup();if(CZ&&CZ.editable){this.parent.groupTreeLayoutConfig.editGroup();}this.selectGroup();}},onmouseleave:function Af(){var CY=this.menuBtnInfo,CX=this.dragIcon;if(CY&&CY.menuCfg){Be.addClass(CY.btn,B1);Be.removeClass(CY.btn,G);}if(CX&&this.model.getLatestSelectedViObjKey()!==this.k&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AG(CX,false);}},onfocusin:function BU(){var CY=BD.findWidget(this),CX=CY&&CY.boxContent&&CY.boxContent.hasAccessibility;if(CX){CY.toggleTitleBarButtonCSS(true);}},onMenuClose:function K(){var CZ=window.event,Ca=CZ&&CZ.currentTarget;if(Ca&&Ca.tagName==="BODY"){var CY=this.opener&&this.opener.containerNode,CX=CY&&BD.findWidget(CY);if(CX&&CX.toggleTitleBarButtonCSS){CX.toggleTitleBarButtonCSS(false);}}},onfocusout:function j(){var Cc=BD.findWidget(this),CZ=Cc&&Cc.boxContent&&Cc.boxContent.hasAccessibility,Ca=window.event;if(CZ){var CY=BD.findWidget(Ca.currentTarget),Cb=BD.findWidget(Ca.relatedTarget),CX;if(Cb&&(Cb.isUnitContainer||Cb.parent)){CX=Cb.isUnitContainer?Cb:Cb.parent.parent;}if(CY&&CX&&CY.isUnitContainer&&CX.isUnitContainer&&CY!==CX){CY.toggleTitleBarButtonCSS(false);CX.toggleTitleBarButtonCSS(true);}else{if(CY&&CY.isUnitContainer&&!Cb){CY.toggleTitleBarButtonCSS(false);}}}},onblur:function O(){this.toggleTabSelectionEffect(false);},toggleTitleBarButtonCSS:function Bx(Ca){var CZ=this.menuBtnInfo,CX=this.filterBtnNode&&this.filterMenuCfg,CY=this.maxRestoreBtnNode;if(CZ&&CZ.menuCfg){Be.toggleClass(CZ.btn,A8,Ca);}if(CX){Be.toggleClass(this.filterBtnNode,A8,Ca);}if(CY){Be.toggleClass(CY,A8,Ca);}},onmouseover:function Ak(CX){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){CX.cancel();}var CY=this._panelTimeout;if(CY){window.clearTimeout(CY);delete this._panelTimeout;}if(this.titleBar.visible&&!mstrApp.isAppStateSelection()){this.titleBar.setToolbarVisibility(true);}},onmouseout:function Ap(){var CX=this.id;this._panelTimeout=window.setTimeout(function(){var CY=mstrmojo.all[CX];if(CY){CY.titleBar.setToolbarVisibility(false);}},200);},menuDisplayCallback:function f(CY){var CX=this.menuBtnInfo;Be.toggleClass(CX.btn,G,CY);Be.toggleClass(CX.btn,B1,!CY);},onmousemove:function p(){var CX=this,CY=CX.menuBtnInfo;if(CX.titleBar&&!CX.titleBar.visible&&CY&&CY.menuCfg){if(!!CX.mouseMovingTimer){clearTimeout(CX.menuDisplayTimeout);}CX.mouseMovingTimer=setTimeout(function(){clearTimeout(CX.menuDisplayDelay);CX.menuDisplayDelay=null;clearTimeout(CX.menuDisplayTimeout);CX.menuDisplayTimeout=setTimeout(function(){CX.menuDisplayCallback(false);},1500);},100);if(!CX.menuDisplayDelay){CX.menuDisplayDelay=setTimeout(function(){CX.menuDisplayCallback(true);},500);}}},isDragValid:function AZ(CY){var Ca=CY.src.node,CX=Ca.tagName,CZ=Ca.getAttribute("class");CX=(CX&&CX.toLowerCase())||"";CZ=(CZ&&CZ.toLowerCase())||"";if(CX==="input"||CX==="textarea"||CZ.indexOf("hover-menu-btn")>-1||CZ.indexOf("icn")>-1||CZ.indexOf("edge")>-1||CZ.indexOf("resizer")>-1){return false;}return(this.unDocked&&this.parent.hasFloatChildren())||this.parent.hasMultipleChildren();},initializeDrag:function CV(){if(this._super()!==false){this.selectVIUnit();}},getTargetDropZone:function BH(CX){if(CI.call(this,CX)||A3.call(this,CX)){return"";}return this._super(CX);},allowDrop:function R(CX){var Ca=CX.src,CZ=Ca&&Ca.widget,CY=this.parent,Cb=false;if(CY&&CY.isManualMode&&typeof CY.isManualMode==="function"){Cb=CY.isManualMode();}if(this.boxContent&&this.boxContent.hasArrayGSI&&At.walk("widget.scriptClass",Ca)!=="mstrmojo.vi.ui.VizGalleryContainer"&&!At.isEmpty(this.getContextDragData(CX))){return false;}if(CZ&&CZ===this){return false;}if(Cb&&CZ&&CZ.isUnitContainer&&CY===CZ.parent){return false;}if(AW.call(this,CX)&&this.allowDropFromFilter(CX)&&!Cb){return true;}if(BE.call(this,CX)&&this.allowDropFromVizGallery(CX)&&!Cb){return true;}if(CI.call(this,CX)&&this.allowDropFromDataset(CX)){return true;}if(A3.call(this,CX)&&this.allowDropFromAllObjectsBrowser(CX)){return true;}return this._super(CX);},allowDropFromFilter:function CH(CX){var CZ=CX&&CX.src,CY=CZ&&CZ.widget;return mstrApp.allowWebDashboardDesign()&&!(CY&&CY.isVisFilter());},allowDropFromVizGallery:function AO(CX){return true;},allowDropFromDataset:function CP(CX){return false;},allowDropFromAllObjectsBrowser:function Ag(CX){return this.allowDropFromDataset(CX);},allowContainerSwitch:function CW(CX){return false;},getSelectedViUnitFnName:function Al(){return undefined;},close:function(){this.parent.deleteBoxAndSubmit(this);this.parent.removeChildren(this);mstrApp.rootCtrl.generateToolbar();this.destroy();},createAvatar:function BS(){this.domNode.style.zIndex="-1";var CX=document.createElement("div");CX.className=this.getAvatarCls().join(" ");CX.textContent=this.getDisplayName();return this.offsetAvatar(CX);},duplicateUnit:function L(CX){return ;},canDuplicate:function(){var CX=this.boxContent;return !!CX.canDuplicate&&CX.canDuplicate();},ondragstart:function A9(CX){this.isDragging=true;this._super(CX);},ondragmove:function BQ(CX){if(CX.src.widget&&CX.src.widget.unDocked&&(CX.delay=CX.delay^1)){this.parent.processGuidesMove(CX);}},ondragend:function Bj(CX){this.domNode.style.zIndex=CX.floatIndex?CX.floatIndex:M;this.isDragging=false;this._super(CX);},wasDropped:function Aa(CX){this.domNode.style.zIndex=M;this._super(CX);},ondrop:function CK(CX){var Ca=AW.call(this,CX),Ce=BE.call(this,CX),CZ=this.maskNode.zone,Cc,Ch=this.getDocModel(),Cg=this;if(Ca){Cc=CX.src.widget.selector.node;}this._super(CX);if(CI.call(this,CX)){Ch.selectVIUnit(this.id);this.dropFromDataset(CX);}if(A3.call(this,CX)){var Cd=CX.src.widget,Cb=Cd&&Cd.dataProvider;if(Cb){Cb.loadObjects(CX.getCtxtDragData().items,{success:function(){Cg.dropFromAllObjects(CX);}});}}var Cf;if(Ca){Cf=this;if(!CZ){CZ=this.parent.getPanelTargetEdge(CX);if(CZ){Cf=null;}}this.parent.restoreAnyMaxedVizBox();this.model.insertExistingFilter(Cc,Cf,CZ,Cf.parent);}else{if(Ce){Cf=this;var Ci=CX.getCtxtDragData().vizItem;if(!CZ){CZ=this.parent.getPanelTargetEdge(CX);if(CZ){Cf=null;}}this.parent.restoreAnyMaxedVizBox();this.model.dndInsertNewBox(Ci,{targetBox:Cf,targetPanelKey:Cf.parent.k,edge:CZ});var CY=At.walk("mstrApp.rootCtrl.datasetsPanel",window);if(CY&&typeof CY.showAddDataToVizTutorialOnce==="function"){CY.showAddDataToVizTutorialOnce();}}}},postDropBox:function CF(){this.domNode.style.zIndex=M;},rebuildBoxContent:function AK(CX){var Ca=this.boxContent,CY=this.parent;this.removeChildren(Ca);Ca.destroy();if(CX){var CZ=CY.builder.build([CX],this.model,{pk:CY.k})[0];Ca=CZ.boxContent;CZ.removeChildren(Ca);CZ.destroy();}else{Ca=this.model.rebuildUnitFromDataCache(Ca.id,CY.k,CY.builder).boxContent;}this.defn=Ca.defn;this.addChildren([Ca]);},dropFromDataset:mstrmojo.emptyFn,dropFromAllObjects:mstrmojo.emptyFn,generateToolbar:function N(){var CX=this.titleBar,CY=CX.toolbarCfg,CZ=this.menuBtnInfo;if(CZ){if(CY){CY.destroy();}if(CZ.menuCfg&&CZ.menuCfg.destroy){CZ.menuCfg.destroy();}if(mstrApp&&mstrApp.isInVFInteractMode||mstrApp.isAppStateSelection()){CZ.menuCfg=null;}else{CX.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));CZ.menuCfg=CX.getMenuConfig();}}if(this.hasRendered){AR.call(this);}if(BD.isTouchOptimizationEnabled()){if(this.isToolbarShow&&this.isToolbarShow()){this.showMobileDossierToolbar();}}},getTitleVisibilityFmts:function Bv(CX){return{FormattingView:{ShowTitleBar:CX}};},toggleTitleBar:function BP(CY){var Cd=this.boxContent.id,Cb=this.model,Cc=function Cc(Ce){var Cg=mstrmojo.all[Cd],Cf=Cg.parent;clearTimeout(Cf.mouseMovingTimer);clearTimeout(Cf.menuDisplayTimeout);clearTimeout(Cf.menuDisplayDelay);Cf.setTitleBarVisibility(Ce);Cf.parent.selectVIUnit(Cf,true);Cf.applyBoxSize(Cf.height,Cf.width,Cf.top,Cf.left);Cf.showTitleBar=Ce;Cf.generateToolbar();Cg.refresh(null,true);},CX=this.id;Cc(CY);Cb.controller.cmdMgr.execute({execute:function(){var Ce=mstrmojo.all[Cd].parent;this.submit([Cb.getUnitFormatAction(Ce,Ce.defn.t===Bt.SELECTOR?5:1,Ce.getTitleVisibilityFmts(CY?1:0),true)],{success:function Cg(){mstrmojo.all[CX].defn.httl=CY;},failure:function Cf(){Cc(!CY);}},mstrmojo.DocDataService.RAPID_EXEC);Cc(CY);},urInfo:{silent:true,undo:function CZ(){Cc(!CY);},redo:function Ca(){Cc(CY);}}});},getFormats:function Ao(){var CX=this.boxContent;if(CX){return CX.getFormats();}return null;},clearFormats:function B(){var CX=this.boxContent;if(CX&&CX.clearFormats){CX.clearFormats();}},preBuildRendering:function CN(){var CX=this.boxContent;if(CX){CX.attachEventListener("regenerateToolbar",this.id,"generateToolbar");}this.generateToolbar();return this._super();},postBuildRendering:function A1(){var CX=this.showTitleBar;this.setTitleBarVisibility(CX);if((mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||(mstrApp.isLayoutModePreview&&mstrApp.isLayoutModePreview())){this.draggable=false;}this._super();this.titleBar.setToolbarVisibility(false);this.applyBoxSize(this.height,this.width,this.top,this.left);this.updateSplitters();if(!mstrApp.isInVFConfigMode&&!mstrApp.isInVFInteractMode&&!(this.boxContent&&this.boxContent.isCustomSort)){this.dragIcon=z.call(this,this.dragIcon);}this.updateAriaLabel();this.canTab=true;return true;},updateAriaLabel:function Bh(){var CX=this.title+", Unit Container";if(CX!==this.ariaLabel){this.set("ariaLabel",CX);}},changeUnitFormats:function Bu(Ca,Cd,Ch,Cf,CZ,CX,Cb,Ce){var Cc=function(Co){if(Cb){Co=Cb(Co);}AD.updateFormatBlock(Ca?Ch.ttl:Ch,Cf,Co);var Cl=this.parent,Cm=Cl?this:this.model.getSelectedViUnit();if(Cl&&Cl.isManualMode()&&Ch.border){Cl.snapGuide.boxIntervalOperations(Cm,"delete");}var Ck=Ch;if(typeof Cm.filterFormats==="function"){Ck=Cm.filterFormats(Ca,Ch);}BY.call(Cm,Ca,Ck);this.applyNoFillClass();if(Cl&&Cl.isManualMode()&&Ch.border){Cl.snapGuide.boxIntervalOperations(Cm,"insert");}var Cn=this.boxContent;if(!Cn.excludeData){if(!Ca&&Cn.restylePlotly&&Cn._slots){Cn.restylePlotly(Ch);}}if(Ce){Ce(Co);}Cm.synchronizeEditors();if(Ca&&Cf===Ax.FONT_SIZE){Cm.doLayout();Cm.postUpdateLayout();}},Cg=function(Cm){var Cl,Ck=this.model.currlaykey;Cl=Bz.filterOne(Cm.defn.layouts,function(Cn){return(Cn.k===Ck&&Cn.loaded);});Ch.border=Cl.units[this.k].fmts.border;},Ci={success:Cc.bind(this,CZ)};var Cj="none",CY=mstrmojo.DocDataService.SUPPRESS_DATA;if(Cf===Ax.BORDER_STYLE&&CX===Cj){CY=mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION;Ci=mstrmojo.func.wrapMethods({success:Cg.bind(this)},Ci);}this.model.saveUnitFormatProperty(this,[{formatType:Cd,propertyName:Cf,newValue:CZ,oldValue:CX}],Ci,CY,{silent:true,undo:Cc.bind(this,CX),redo:Cc.bind(this,CZ)});},redraw:function Ab(){if(this.boxContent.redraw()===true){return true;}return this._super();},getAvatarCls:function Br(){return["mstrmojo-VIUnit-avatar","icn-avi",mstrApp.getThemeClassName()];},addDragHandle:function Bl(){var CX=document.createElement("div");CX.className="uc-drag-handle";this.domNode.appendChild(CX);},toggleDragHandleVisibility:function i(CX){Be.toggleClass(this.domNode,"no-handler",!CX);},toggleBoxSelection:function CU(Ca){if(mstrApp.isInVFInteractMode){return ;}var Cc=mstrApp.isAppStatePresentation(),CY=mstrApp.isAppStatePrintPreview(),Ce=this.domNode,Cd=this.dragIcon,CZ=this.model.getMultiSelectUnits(),Cb=CZ.length>1,CX=CZ.length===2&&mstrmojo.all[CZ[0]];Be.toggleClass(Ce,"selected",Ca&&!(Cc||CY));if(this.isGhstImgHidden()){if(Cb){this.ctrlOverlay.set("visible",Ca);if(CX&&!CX.ctrlOverlay.visible){CX.ctrlOverlay.set("visible",Ca);}}else{this.ctrlOverlay.set("visible",false);}}if(Cd&&!this.showTitleBar&&!mstrApp.isAppStatePresentation()){AG(Cd,this.draggable&&Ca);}if(!Ca){this.toggleTabSelectionEffect(Ca);}},isGhstImgHidden:function BL(){return !this.isGhstImgVisible;},updateGhostImgCss:function CE(CX){if(CX.propertyName===Ax.BACKGROUND_COLOR&&!CX.isTitle){var CY=this.ghostImgCss||[];CY=Bz.filter(CY,function(CZ){return W.indexOf(CZ)===-1;});CY=CY.concat(g(CX.value));this.set("ghostImgCss",CY);}},isAMSelector:function AM(){return this.scriptClass==="mstrmojo.vi.ui.rw.AMSelectorBox";},isPanelSelector:function A6(){return this.scriptClass==="mstrmojo.vi.ui.rw.PanelSelectorBox";},applyNoFillClass:function BF(){var CX=this.getFormats(),CZ=At.walk("background-color",CX),CY=CZ==="transparent"||CZ===undefined;if(!CX){return ;}if(this.domNode){if(CY){Be.addClass(this.domNode,"noFill");}else{Be.removeClass(this.domNode,"noFill");}}else{if(CY){Be.addWidgetCssClass(this,"noFill");}}},getUnitType:function A0(){return this.defn.t;},selectFromLayer:function Av(CY,CX){var Cc=this.parent._tgtSelections,Ce=At.clone(this.model._multiSelectUnits)||[],Cb=Ce.indexOf(this.id)!==-1,Ca=CY.indexOf(this.id)!==-1,CZ=CX&&(CX.ctrlKey||CX.metaKey)&&this.parent.isManualMode(),Cd=CY.length===1&&!CZ;this.parent.infoWindowViewHandler(this);if(Cc){this.selectVIUnit(true);}else{if(Cd){this.selectVIUnit();}else{if(Ca&&!Cb){this.toggleBoxSelection(true);}else{if(!Ca&&Cb){this.toggleBoxSelection(false);}}}}this._super();},renameFromLayer:function An(CZ,CX,CY){this.updateDisplayName(CZ,CX,CY);},deleteFromLayer:function w(){this.deleteSelf();},formatFromLayer:function AA(){this.launchFormatEditor();}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(U,S){var R=this._super(U,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=mstrmojo.boxmodel.offset(this.domNode);this.offsetTop=R.top;this.offsetLeft=R.left;},update:function F(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}var U=this.controller,S=U.view,Z=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(U.view.fullScreenInfoWindow&&(Z&&Z.defn.visName)){var Y=mstrApp.rootView.getContentDimensions();this.height=Y.h+"px";this.width=Y.w+"px";}else{this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var W in L){v=L[W];if(W in R){this[v]=R[W];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){var S=document.createElement("div");S.className="mstrmojo-message";S.textContent=R;this.domNode.appendChild(S);},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(W){var d=this.xtabModel,c=(d&&d.docModel);var e=false;if(c){var b=c.defn&&c.defn.layouts,U=null;var S;if(b){for(S in b){if(b[S].loaded){U=b[S];break;}}}var X=U&&U.units;this.selectorTargets={};if(X&&W.scObjList){for(var S=0;S<W.scObjList.length;S++){var Y=W.scObjList[S];var Z=Y.sc.tks.split("\x1E");for(var R=0;R<Z.length;R++){var a=X[Z[R]];if(a){this.selectorTargets[Z[R]]=a;if(!this.isChildOfIfw(X,a)){e=true;}}}}}}return e;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var U=this.xtabModel.getAction(R),S=U&&U.h;if(S&&this.controller[S]){this.controller[S](this,U.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,a,S){var Y=a;var W=R.getChildren(a,false);for(var U=0;U<W.length;U++){var Z=W[U];if(Z.k==S){return Z;}else{var X=mstrmojo.Vis.getVisGrid(R,Z,S);if(X){a=Y;return X;}}}};mstrmojo.Vis.DataParser=function(U){var c=mstrmojo.Vis;return{getRowTitles:function(){return new c.Titles(U,true);},getColTitles:function(){return new c.Titles(U,false);},findMetricValue:function(g,l){var k=U.ghs.rhs.items;for(var h in k){var j=k[h].items;var f=true;for(var d in g){if(g[d]!=j[d].idx){f=false;break;}}if(f){return new mstrmojo.Vis.MetricValue(U.gvs.items[h].items[l]);}}},getTotalRows:function Y(){var d=U.ghs&&U.ghs.rhs&&U.ghs.rhs.items;return(U.eg||!d)?0:d.length;},getTotalColHeaderRows:function W(){return(!U.ghs.chs.items?0:U.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function b(d){return new c.Headers(U,d,true);},getColHeaders:function a(d){return new c.Headers(U,d,false);},getMetricValue:function Z(e,d){return new c.MetricValue(U,U.gvs.items[e].items[d]);},getColumnHeaderCount:function X(){return U.gvs.items[0].items.length;},getCSSString:function S(){return U.cssString;}};};mstrmojo.Vis.Titles=function(R,Y){var X=(Y)?R.gts.row:R.gts.col;return{size:function W(){return X.length;},getTitle:function U(Z){return new mstrmojo.Vis.Title(X[Z]);},getCSS:function S(Z){return R.css[X[Z].cni].n;}};};mstrmojo.Vis.Headers=function(S,U,Z){var a=(Z)?S.gts.row:S.gts.col;var Y=(Z)?S.ghs.rhs:S.ghs.chs;var W=Y.items&&Y.items[U].items;return{size:function b(){return(!W?0:W.length);},getHeader:function R(c){return W&&W[c]&&new mstrmojo.Vis.Header(W[c],Z?a[c]:a[U]);},getCSS:function X(c){return W&&S.css[W[c].cni].n;},getHeaderCell:function(c){return W&&W[c];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function U(X){return S.es[X].n;},getHeaderId:function U(X){return S.es[X].id;},getForms:function W(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(U,R){return{getName:function X(){return(U.idx===-1)?"":R.es[U.idx].n;},getElementId:function a(){return(U.idx===-1)?"":R.es[U.idx].id;},getObjectId:function W(){return(U.idx===-1)?"":R.es[U.idx].oid;},getElementIndex:function S(){return U.idx;},getActionType:function Z(){return U.at;},isTotal:function Y(){return U.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,a){var Z=a;return{getValue:function S(){return Z.v;},getThresholdType:function U(){return Z.ty;},getRawValue:function Y(){return Z.rv;},getCSS:function W(){return R.css[Z.cni].n;},getThresholdValue:function b(c){if(Z.ti==undefined){return c;}return R.th[Z.ti].n;},getFillColor:function X(c){if(Z.ci==undefined){return c;}return R.fc[Z.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Label","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.vi.ui.ConditionWalk","mstrmojo.fe.FilterUtils","mstrmojo.expr");mstrmojo.requiresDescs(15540);var I=mstrmojo.array,M=mstrmojo.hash,R=mstrmojo.Button.newWebButton,G=mstrmojo.mstr.EnumNodeDimty,P=I.hash([G.NodeDimtyUnspecified,G.NodeDimtyNone]),B=mstrmojo.fe.FilterUtils,J=mstrmojo.expr,Q=J.ET;mstrmojo.vi.ui.ConditionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ConditionEditor",cssClass:"mstrmojo-vi-ui-ConditionEditor",help:"Create_Edit_Delete_Qualifications_In_Advanced_Filter_Editor.htm",title:mstrmojo.desc(15540,"Edit Qualification"),objectBrowsingEnabled:false,targets:null,targetsLastMod:null,ets:null,condition:null,model:null,hasPrompt:false,disableElementsBrowsing:null,inRelation:null,editor:null,children:[{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',cssDisplay:"inline-block",cssClass:"conditionBar",model:null,alias:"conditionBar",bindings:{model:"this.parent.model"},update:function(){var E=this.model,U=B.getExprNodeHtmlAndText(E.data?E.data:E,{emptyText:mstrmojo.desc(15413,"Qualification Details"),elemsEmpty:" "});if(this.containerNode){this.containerNode.innerHTML=U.html;this.containerNode.title=U.text;}}},{scriptClass:"mstrmojo.vi.ui.ConditionWalk",alias:"walk",dimtyTypes:P,delegateUpdateOkBtn:function D(W){var E=this.parent,X=E&&E.btnHbox,U=X&&X.okBtn;if(U){U.set("enabled",!!W);}},onOK:function O(){var U=this.condition,E=this.editor;E.onConditionEdit(U,this.model.get());},close:function L(){var E=this.condition;if(E&&E.isEmpty()){E.del();}},postmodeledit:function H(E){this.parent.updateConditionBar();},getIfDataSource:function S(){return this.parent.getIfDataSource();},onUpdateBrowseElementsParams:function N(E){this.parent.onUpdateBrowseElementsParams(E);},getDatasets:function F(){return this.parent.getDatasets();}}],buttons:[R(mstrmojo.desc(1442,"OK"),function(){var E=this.parent.parent;E.walk.onOK();E.close();},true,{enabled:true,alias:"okBtn"}),R(mstrmojo.desc(221,"Cancel"),function(){var E=this.parent.parent;E.close();})],updateConditionBar:function A(){this.conditionBar.update();},open:function K(W,E){this._super(W,E);var U={objectBrowsingEnabled:this.objectBrowsingEnabled,targets:this.targets,targetsLastMod:this.targetsLastMod,ets:this.ets,condition:this.condition,hasPrompt:this.hasPrompt,disableElementsBrowsing:this.disableElementsBrowsing,disableHierarchyLevel:this.disableHierarchyLevel,inRelation:this.inRelation,editor:this.editor};M.copy(U,this.walk);if(!(this.disableElementsBrowsing&&this.disableElementsBrowsing())){this.model.defaultETAttr=Q.AE;}this.walk.set("model",this.model);this.updateConditionBar();},onClose:function C(){this.walk.close();},getDatasets:mstrmojo.emptyFn,getIfDataSource:mstrmojo.emptyFn,onUpdateBrowseElementsParams:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Widget","mstrmojo.Label","mstrmojo.Box","mstrmojo.desc","mstrmojo.css","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.ui._HasScroller","mstrmojo._HasPopup","mstrmojo.vi.ui.ConditionEditor","mstrmojo.threshold.ThresholdRow","mstrmojo.threshold.ConditionWalk","mstrmojo.threshold.PropertyPanel","mstrmojo.threshold.PropertyModel","mstrmojo.threshold.ThresholdRowPanel","mstrmojo.threshold.ThresholdModel","mstrmojo.mstr.EnumNodeProperties","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.ui.editors.controls.PopupControlUtils");var B=mstrmojo.css,Q=mstrmojo.hash,h=mstrmojo.array,P=mstrmojo.dom,E=mstrmojo.mstr.EnumNodeProperties,e=mstrmojo.mstr.EnumDSSXMLObjectTypes,z=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,O=mstrmojo.expr,f=O.ET,n=O.BRANCH_FNS,j=mstrmojo.Button.newWebButton,t=mstrmojo.models.FormatModel.getFormatUpdate,o=600,M="",Y=mstrmojo.ui.editors.controls.PopupControlUtils;var d=mstrmojo.models.FormatModel.ENUM_NUMBER_FORMAT_KEYS_OBJ,w=[d.CATEGORY,d.CURRENCY_POSITION,d.CURRENCY_SYMBOL,d.DECIMAL_PLACES,d.FORMAT,d.NEGATIVE_NUMBERS,d.THOUSAND_SEPARATOR],a=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AD=[a.BORDER_TOP_STYLE,a.BORDER_RIGHT_STYLE,a.BORDER_BOTTOM_STYLE,a.BORDER_LEFT_STYLE],u={0:"none",1:"1pt solid",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid"},AE={COLOR:"FillClr",OPACITY:"FillTrans"},c={VALUE:1,COLOR:"transparent"},J={bc:"#FFF",bgs:0,bo:"100"};function q(AF,AH){var AG=[];if(AH){AH.forEach(function(AJ){var AK=AJ.fmt,AI={FormattingAppearance:{Visible:-1}};if(!!AK){AK.nth=AK.nth?-1:0;if(!!AK.bc&&!!AK.bc.c1){delete AK.gdc;delete AK.gda;}}Q.forEach(AK,function(AL,AM){var AN=false;if(w.indexOf(AM)>-1){t(AM,AL,AI);}else{if(AD.indexOf(AM)===-1){t(AM,AL,AI);}else{if(!AK.borderStyle&&!AN){t(a.BORDER_STYLE,u[AL],AI);}}}});AF.setAttIdToNDE(AJ.expr);AG.push({n:AJ.n,scope:AJ.scope,rtp:AJ.rtp,rtxt:AJ.rtxt,expr:mstrmojo.fe.FilterUtils.getExprXml(AJ.expr),fmt:AI});});}return AG;}function y(AJ){var AG=this.controller,AH=this.model,AI=AH.thresholds,AK=this.metricId,AM=AI&&AI[AK],AL=AH.orgThresholds,AF=AL&&AL[AK];AG.onSubmitActions(q(AH,AM),AF,AK,undefined,-1,AJ,this.objectType);}function G(AF){(AF||[]).forEach(function(AG){delete AG.dmy;var AH=AG.nds;if(AH){G(AH);}});}function i(){var AI=this.content,AF=this.model,AM=AF.thresholds,AH=this,AJ=[],AL=AI.rowPanel,AK=AM&&AM[AF.metricId],AG=0;if(AK){AK.forEach(function(AN){G(AN.expr.nds);AJ.push({scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:AN,editor:AH,model:AF,idx:AG++});});}AL.destroyChildren(false);AL.addChildren(AJ);this.updateScrollbars();}function s(){var AK=this.content.rowPanel,AI=AK.children,AG=(AI&&AI.length)||0,AH=this.model,AL=AH.thresholds,AJ=AL&&AL[AH.metricId],AF={expr:{et:14,fn:19}},AM={et:f.AE};if(!AL){AL=AH.thresholds={};}if(!AJ){AJ=AL[AH.metricId]=[];}AJ.push(AF);AK.addChildren([{scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:AF,editor:this,model:AH,idx:AG}]);if(this.disableElementsBrowsing&&this.disableElementsBrowsing()){AM.et=f.AQ;}AK.children[AG].exprTree.newCondition(AM);this.updateScrollbars();}function AB(AG){var AF=this.model,AI=AF.thresholds,AH=AI&&AI[AF.metricId];if(AH){AH.forEach(function(AJ){AF.toggleThresholdSelected(AJ,AG);});}}function K(AJ,AK){var AF=this.controller,AG=this.model,AH=this.metricId,AI=AG.selectedThresholds;if(AI.length>0){AF.onSaveThresholds(q(AG,AI),AH,-1,AJ,AK);}}function N(AG){var AI="mstrIVE_THRESHOLD_SAVER",AF=AG.controller.dataService.model,AH=mstrmojo.all[AI];if(!AH){AH=new mstrmojo.SaveAsEditor({id:AI,zIndex:AG.zIndex+1,folderLinksContextId:32,rootFolderID:AF.isnew?null:AF.pfid,showCompletePath:false,saveParams:{},typeDesc:mstrmojo.desc(3647,"Thresholds"),saveAs:function(AL){var AJ=this.contPanel;this.name=AJ.name.value;this.desc=AJ.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var AM=this.saveParams||{};AM.folderId=this.ob.currentFolder.did;AM.name=this.name||"New Thresholds";AM.saveAsOverwrite=!!AL;var AK=this.saveAsCallback();AK.failure=function(AO){var AN=AO.code,AP=this.parent;if(AN==="-2147217373"||AN==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",AP.typeDesc||"Object").replace("###",AP.name),{confirmBtn:{fn:function(){AP.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite"),zIndex:AP&&AP.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+AO.message);}};AK.parent=this;K.call(AG,AM,AK);}});AH.render();}AH.open();}function m(AH){var AM="mstrIVE_THRESHOLD_LOADER",AK=mstrmojo.all[AM],AG=AH.controller.dataService.model,AL=[72];if(!AK){AK=new mstrmojo.vi.ui.editors.ObjectPicker({id:AM,supportedTypes:mstrmojo.array.hash(AL),zIndex:AH.zIndex+1,rootFolderID:AG.isnew?null:AG.pfid,onOpen:function AF(){this.browse();},postBuildRendering:function AJ(){mstrmojo.Editor.prototype.postBuildRendering.apply(this);},OKFn:function(AN){if(AN){AH.controller.onLoadThresholds(AH.metricId,AN.did);}}});var AI=AK.ob;AI.set("folderLinksContextId",32);AI.set("multiSelect",false);AI.set("searchVisible",true);AI.set("upButtonVisible",true);AI.set("browsableTypes","8,"+AL.join(","));AK.render();}AK.open();}function W(AG){if(!AG){return ;}if(AG.t===e.Consolidation&&AG.st===z.ConsolidationManaged){var AF=mstrApp&&mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model;if(AF&&AF.findUnitInDataSet){AG=AF.findUnitInDataSet(AG.did);if(AG&&AG.attId){AG=AF.findUnitInDataSet(AG.attId);}}}return AG.t===e.Attribute&&AG.st===z.AttributeRecursive;}function F(AG){var AH=Q.clone(AG);if(!(AH.node&E.CONDITION)&&W(AH.a)){AH={et:f.ANDOR,fn:mstrmojo.expr.FN.AND,node:E.CONDITION,nds:[AH]};}if(AH&&AH.et===f.ANDOR&&(AH.node&E.CONDITION)){var AI=Q.valarray(O.findTargets(AH,"did"))[0],AF={et:f.ANDOR,data:AH};switch(AI&&AI.t){case e.Attribute:case e.Consolidation:AF.a=AI;break;case e.Metric:AF.m=AI;break;}return AF;}return AH;}mstrmojo.threshold.AdvancedThresholdEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller,mstrmojo._HasPopup],{scriptClass:"mstrmojo.threshold.AdvancedThresholdEditor",cssClass:"adv-threshold",title:"Advanced Threshold Editor",help:"Advanced_Thresholds_Editor.htm",model:undefined,targets:undefined,content:undefined,buttonBar:undefined,init:function x(AF){this._super(AF);M=this.id;},postBuildRendering:function S(){this._super();var AF=this.content;i.call(this);AF.conditionWalk.set("editor",this);AF.property.set("editor",this);},onOpen:function X(){i.call(this);this.setRowPanelVisibility(true);var AF=this.content;AF.conditionWalk.set("visible",false);AF.property.set("visible",false);AF.set("editorNode",this.editorNode);var AG=this.buttonBar&&this.buttonBar.quickLink;if(!!AG){AG.set("visible",this.objectType!==12);}},setupScrollNodes:function p(){this.scrollNode=this.content.containerNode;},onClose:function g(){this.model.cleanUp();},onmodelChange:function A(){var AF=this.model;if(AF){AF.attachEventListener("modelEdit",this.id,"onmodelEdit");AF.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");i.call(this);}},onselectedThresholdsChange:function I(){},openConditionWalk:function D(AL,AK){var AI=this,AJ=AI.content,AG=AK.tree.parent,AF=Q.clone(AG.threshold),AH=P.position(AI.titleNode);AF.expr=AL;var AM=new mstrmojo.threshold.ThresholdRow({alias:"thresholdRow",slot:"conditionNode",idx:AG.idx,model:this.model,threshold:AF,onclick:mstrmojo.emptyFn});AM.render();B.toggleClass(AI.content.domNode,"no-overflow",true);AI.openPopup("conditionEditorPopupRef",{editor:AI,objectBrowsingEnabled:AI.objectBrowsingEnabled,showLimits:true,targets:AI.targets,targetsLastMod:new Date(),ets:AK.tree.validExprTypes,condition:AK,hasPrompt:false,model:F(AL),left:parseInt(AH.x+(AH.w-o)/2,10)+"px",top:parseInt(AH.y+AH.h,10)+"px",zIndex:AI.zIndex+1,title:AK.isEmpty()?mstrmojo.desc(5893,"New Condition"):mstrmojo.desc(14916,"Edit Condition"),disableHierarchyLevel:true});},onmodelEdit:function Z(){i.call(this);},openFillColor:function U(AG){var AI=AG.threshold,AM=AI.fmt||J,AH=new mstrmojo.threshold.PropertyModel({thresholdRow:AG,threshold:Q.clone(AI),gridValueFormat:Q.clone(this.model.getGridValueFormat())});this.disposables.push(AH);AH.attachEventListener("propertyModelChange",AG.id,"onpropertyModelChange");var AJ=Object.values(AE),AL=function AL(AQ){h.forEach(AJ,function(AR){var AS;if(AR===AE.COLOR){AS=AM.bgs===c.VALUE?c.COLOR:AM.bc;}else{AS=AM.bo!==undefined?AM.bo:100;}AQ.syncControls(function(){AQ.setChildValue(AR,AS);});});},AK=function(AQ){AQ.iniChildrenComp(AJ);AL(AQ);},AP={width:"120px",alias:"fillColorAndTrans",onGroupValueChange:function(AQ,AS,AR){if(AS!==AR){AH.changeFormatProperty("fmt",AQ===AE.COLOR?"bc":"bo",AS);}}},AN=Y.getFillConfigComp(mstrmojo.desc(2885,"Fill"),AP,AK),AF=new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolbarBorderAndFill",children:[AN]},Y.getRowContainer([j(mstrmojo.desc(1442,"OK"),function AO(){var AQ=this.parent.parent;AH.submitChange();AQ.close();},true),j(mstrmojo.desc(221,"Cancel"),function AO(){var AQ=this.parent.parent;AQ.close();})],"mstrmojo-ui-ToolbarButtonBox")]});AF.hostId=AG.id;AF.hostElement=AG.previewNode;AF.isHostedWithin=false;this.openPopup(AF.newInstance());},openPropertyPanel:function H(AF){this.setRowPanelVisibility(false);var AH=this.content.property,AG=AH.model=new mstrmojo.threshold.PropertyModel({thresholdRow:AF,threshold:Q.clone(AF.threshold),gridValueFormat:Q.clone(this.model.getGridValueFormat())});this.disposables.push(AG);AG.attachEventListener("propertyModelChange",AF.id,"onpropertyModelChange");AH.set("visible",true);this.toggleButtonStatus(false);this.updateScrollbars();},getDatasets:function l(){if(this.model){return this.model.controller.datasets;}return null;},getIfDataSource:function b(){if(this.model){return this.model.controller.dataService;}return null;},onUpdateBrowseElementsParams:mstrmojo.emptyFn,onConditionEdit:function L(AH,AG){var AF=this;AF.model.setConditionData(AH,AG);AF.setRowPanelVisibility(true);AF.toggleButtonStatus(true);AF.updateScrollbars();},conditionEditorPopupRef:{scriptClass:"mstrmojo.vi.ui.ConditionEditor",isHostedWithin:false,getIfDataSource:function b(){return this.editor.getIfDataSource();},getDatasets:function l(){return this.editor.getDatasets();},onUpdateBrowseElementsParams:function AC(AF){this.editor.onUpdateBrowseElementsParams(AF);}},openAndORPopup:function AA(AI,AF){var AG=new mstrmojo.ui.menus.MenuConfig();AG.hostId=this.id;AG.hostElement=AF;AG.isHostedWithin=false;AG.menuCssClass="andor-PopupList";var AH=function AH(AO){var AJ=AI,AN=AO.ctxt.did,AM=AN>21?true:null,AL=AN-(AM?21:0);var AK=AJ&&AJ.parent;if(AK&&AK.data&&AK.data.et===f.ANDOR){AK.edit(AJ,AL,AM);}else{var AP=AJ&&AJ.data;if(AP&&(AP.not!==AM)){AP.not=AM;AJ.paint();}}};AG.addMenuItem(n[19],"",AH,{did:19});AG.addMenuItem(n[20],"",AH,{did:20});AG.addMenuItem(n["19_21"],"",AH,{did:19+21});AG.addMenuItem(n["20_21"],"",AH,{did:20+21});this.openPopup(AG.newInstance());},toggleButtonStatus:function C(AF){this.buttonBar.children.forEach(function(AG){AG.set("enabled",AF);});},setRowPanelVisibility:function R(AG){var AF=this.content;AF.rowPanel.set("visible",AG);AF.newCondition.set("visible",AG);this.updateScrollbars();},children:[{scriptClass:"mstrmojo.Widget",alias:"rulesTitles",markupString:"<div class='rulesTitles'><div class='container'></div><div class='order'>"+mstrmojo.desc(3095,"Order")+"</div><div class='condition'>"+mstrmojo.desc(11890,"Threshold Conditions")+"</div><div class='format'>"+mstrmojo.desc(11891,"Format Preview")+"</div></div>"},{scriptClass:"mstrmojo.Box",cssClass:"content",alias:"content",editorNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},rowPanel:undefined,newCondition:undefined,conditionWalk:undefined,property:undefined,children:[{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",alias:"rowPanel",children:[]},{scriptClass:"mstrmojo.Label",alias:"newCondition",cssClass:"link",text:mstrmojo.desc(4585,"New Threshold"),onclick:function k(){s.call(mstrmojo.all[M]);}},{scriptClass:"mstrmojo.threshold.ConditionWalk",alias:"conditionWalk",height:"300px",width:"750px",visible:false},{scriptClass:"mstrmojo.threshold.PropertyPanel",alias:"property",width:"750px",visible:false}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[j(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[M].close();},false,{enabled:true,alias:"cancelBtn"}),j(mstrmojo.desc(1442,"OK"),function(){y.call(mstrmojo.all[M],false);mstrmojo.all[M].close();},true),j(mstrmojo.desc(2031,"Apply"),function(){y.call(mstrmojo.all[M],true);},true),{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"quickLink",text:mstrmojo.desc(14004,"Quick Thresholds Editor..."),onclick:function k(){var AH=mstrmojo.all[M],AG=AH.model,AF=AH.controller,AJ=AG.isAdvanced(AG.metricId),AK=function(){AH.close();AG.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.SIMPLE_EDITOR;},AI=[j(AJ?mstrmojo.desc(1442,"OK"):mstrmojo.desc(2827,"Clear"),function(){AK();AF.openEditor(AG.setIdx);},AJ,AJ?undefined:{cssClass:"nosave"})];if(!AJ){AI.push(j(mstrmojo.desc(2031,"Apply"),function(){AK();y.call(AH,true);},true));}AI.push(j(mstrmojo.desc(2223,"Cancel")));mstrmojo.warn(AJ?mstrmojo.desc(13998,"This action will clear the thresholds definition. Do you want to proceed?"):mstrmojo.desc(13999,"Do you want to apply your thresholds before using the Quick Thresholds Editor?"),undefined,{cssClass:AJ?undefined:"save-threshold-warning",buttons:AI});}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Vis","mstrmojo._HasOwnAvatar");var L=mstrmojo.css,J=mstrmojo.dom,G="px";var F=J.isTouchOptimizationEnabled()?[]:["mouseover","mouseout","click"];function B(R,Q){return{x:R.x-Q.x,y:R.y-Q.y};}function N(R,Q){return(R.x-Q.x)*(R.x-Q.x)+(R.y-Q.y)*(R.y-Q.y);}function O(Q){var R=Q.src.data;return(!R||!R.isScrollBar);}mstrmojo.VisLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.gm.VisLegend",bodyCssClass:"",avatarCssClass:"legend-dragged",dropZoneHighlightCss:"legend-dropZone",ownAvatar:true,draggable:true,dropZone:true,dockedPositions:null,calculateDockedPositions:mstrmojo.emptyFn,widget:null,boundaryNode:null,draggableNodeName:"domLegend",legendMarkup:"",extrasMarkup:"",markupString:'<div id="{@id}" class="{@cssClass}" style="width:{@width}px;height:{@height}px;top:{@top}px;left:{@left}px;position:absolute;" mstrAttach:'+F.join(",")+'><div class="gm-legend-bg"><div class="{@bodyCssClass}" style="width:{@width}px;height:{@height}px;text-decoration:inherit">{@legendMarkup}</div></div><div class="gm-anchor-point topLeft"></div><div class="gm-anchor-point topRight"></div><div class="gm-anchor-point bottomLeft"></div><div class="gm-anchor-point bottomRight"></div>{@extrasMarkup}</div>',markupSlots:{dropZoneNode:function(){return this.domNode;},domLegend:function(){return this.domNode.firstChild.firstChild;}},postBuildRendering:function(){this._super();this.calculateDockedPositions(this.widget.getWidth(),this.widget.getHeight());this.boundaryNode=this.widget.domNode;this.boundaryPosition=J.position(this.boundaryNode,true);},createAvatar:function D(){return this[this.draggableNodeName];},updateDropZoneNode:function C(S){var Q=this.dockedPositions;if(Q&&Q.length>0){var Z=B(S.tgt.pos,this.boundaryPosition);var X=N(Z,Q[0]),W=0,R,Y;for(R=1;R<Q.length;R++){Y=N(Z,Q[R]);if(Y<X){X=Y;W=R;}}if(W!==this.currDockedPositionIdx){var U=this.dropZoneNode.style;U.left=Q[W].x+G;U.top=Q[W].y+G;if(this.widget.onLegendDropZoneChange){this.widget.onLegendDropZoneChange(Q[W],W);}this.currDockedPositionIdx=W;this.updateAlignClass();return true;}}return false;},toggleDropZoneBorder:function P(Q){L.toggleClass(this.dropZoneNode,this.dropZoneHighlightCss,Q);},isDragValid:O,ondragstart:function E(Q){if(!O(Q)){return ;}this._super(Q);this.toggleDropZoneBorder(true);},ondragmove:function A(Q){if(!O(Q)){return ;}this.updateDropZoneNode(Q);this._super(Q);},allowDrop:function I(Q){var S=Q.src,R=S&&S.widget;return(R&&R!==this&&R.parent===this.parent);},ondrop:function K(S){var Q=this.domLegend;L.removeClass(Q,this.avatarCssClass);var U=Q.style;U.left="0";U.top="0";this.dropZoneNode.firstChild.appendChild(Q);if(this.widget.onLegendDropped){var R=this.getDockedPosition();this.widget.onLegendDropped(R&&R.pos);}S.dropSuccessful=true;},getDockedPosition:function H(){return this.dockedPositions&&this.dockedPositions[this.currDockedPositionIdx];},ondragend:function A(Q){if(!O(Q)){return ;}this._super(Q);if(!Q.dropSuccessful){this.ondrop(Q);}this.toggleDropZoneBorder(false);},positionAvatar:function M(X){var S=this,R=this.avatar,U=R.style,W=this.boundaryPosition;var Q=function(Y,Z){if(Y==="x"){if(Z<W.x){return W.x;}return Math.min(Z,W.x+W.w-S.domNode.offsetWidth);}if(Y==="y"){if(Z<W.y){return W.y;}return Math.min(Z,W.y+W.h-S.domNode.offsetHeight);}};U.left=Q("x",X.x)+G;U.top=Q("y",X.y)+G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi.ui.TargetSelector","mstrmojo.vi.ui.FilterBoxInlineDialog","mstrmojo.Label","mstrmojo.dom","mstrmojo.css","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.tooltip","mstrmojo.DocSelector","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.EnumRWUnitType","mstrmojo.vi.enums.EnumFeatures","mstrmojo.DocDataService");var H=mstrmojo.css,Z=mstrmojo.dom,AO=mstrmojo.func,t=mstrmojo.array,AQ=mstrmojo.string,b=mstrmojo.hash,D="\u001E",AF=mstrmojo.EnumRWUnitType,AE=mstrmojo.models.FormatModel,AG=AE.getFormatUpdate,z=AE.ENUM_PROPERTY_NAMES,X=mstrmojo.DocSelector.STYLES,c=mstrmojo._HasTooltip.TOOLTIP_OPEN_DELAY,AM=mstrmojo.vi.ui.rw.GhostImageContainer,AH=[{scriptClass:"mstrmojo.vi.ui.rw.GhostImageContainer",cssClass:"amselector",visDesc:AM.getVisDesc("amselector")}],u=mstrmojo.DocDataService.EnumTreesToRender,N=mstrmojo.vi.enums.EnumFeatures;function L(AV){return AV&&AV.did!=="-1"&&AV.t!==14;}function W(AV){var AW=AV.getCtxtDragData();return(AW.items||[]).filter(L)[0];}function E(AW){var AX=AW.getCtxtDragData(),AV=AX.items||[];return AX.src&&AV.some(L);}function K(){var AW=this.getSelectorSource(),AV=this.model.getDatasetUnits(["att","mx"],function(AX){return AX.did===AW;});return(AV.length&&AV[0])||null;}function Q(){var AV=this;this.showControlOverlay([mstrmojo.Button.newWebButton(mstrmojo.desc(1088,"Edit"),function(){var AW=AV.boxContent;if(AW&&AW.expandOrEditToFetchElements){AW.expandOrEditToFetchElements();}AV.hideControlOverlay();},false,{alias:"ctrlEditBtn",enabled:true,cssClass:"filterBoxEdit"})]);H.toggleClass(this.ctrlOverlay&&this.ctrlOverlay.domNode,"editOverLay",true);}function AR(AV){return{scriptClass:"mstrmojo.vi.ui.FilterBoxInlineDialog",vis:AV};}function I(){var AV=this,AW=mstrmojo.Button.newWebButton(mstrmojo.desc(4799,"Select Target"),function(AX){var AY=mstrmojo.all[AV.id];AY.selectVIUnit(null,AX);mstrApp.rootCtrl.view.openInlineDialog(AR(AY));AX.cancel();},true,{alias:"btnSelect"});AW.cssClass+=" btn-select-targets";this.showControlOverlay([AW]);this.setSelectTargetsState(true);}function U(){var AV=this.boxContent;if(AV.isInvalid){this.showInvalidMessage();return ;}if(!this.isPanelSelector()&&(!this.selectorHasSource()||(mstrApp&&(mstrApp.isAppStatePresentation()||mstrApp.isAppStatePrintPreview())))){return ;}if(this.getTargetKeys().length>0){if(b.walk("boxContent.node.data.disabled",this)){Q.call(this);}else{this.hideControlOverlay();}return ;}I.call(this);}function k(){return !this.defn.ob;}function AU(AV){this.set("useRichTooltip",AV);}function Y(){H.toggleClass(this.domNode,"horizontal",!!this.defn.horiz);}mstrmojo.vi.ui.rw.FilterBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.rw.FilterBox",targetSelector:null,useRichTooltip:true,isDynamicTooltip:true,tooltipOpenDelay:c,maskTooltip:mstrmojo.desc(15274,"Selector cannot be selected as target"),allowFilters:true,shouldHideDynamicSelIcon:false,markupMethods:b.mergeHashes(mstrmojo.vi.ui.rw.UnitContainer.prototype.markupMethods,{onenabledChange:function(){H.toggleClass(this.domNode,"inactive",!this.enabled);this.targetMask.set("useRichTooltip",!this.enabled);}}),init:function AP(AX){this._super(AX);if(mstrApp.isDossier){var AW=this.boxContent,AV=b.walk("node.defn",AW)||{};if(AW.hasDynamicSelection(true)){AW._dynamicSelDefn={sus:AV.sus,suc:AV.suc};}}H.addWidgetCssClass(this,"mstrmojo-FilterBox");},getSelectorSource:function x(){return this.boxContent.defn.srcid;},selectorHasSource:function AS(){return !!this.getSelectorSource();},onclick:function y(AV){var AZ=Z.isPrimaryMouseBtn(AV.e),AW=this.selectorHasSource(),AY=Z.contains(this.containerNode,AV.getTarget(),true,this.domNode),AX;if(AZ&&AW){if(AY){AX=true;AV.e.ptvSelected=true;}else{if(!Z.contains(this.titlebarNode,AV.getTarget(),true,this.domNode)){AV.e.ptvSelected=true;}}}this._super(AV);if(AX){this.getEditorModel().selectTargetByValue(mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE);}},onmouseenter:function R(){this._super();var AV=this.boxContent,AW;if(this.selectorHasSource()&&this.dynamicSelIcon&&AV.hasDynamicSelection()&&!mstrApp.isAppStatePresentation()&&!mstrApp.isAppStateSelection()){AW=AV.isDsIconVisible();this.dynamicSelIcon.set("visible",AW);this.shouldHideDynamicSelIcon=AW;}},onmouseleave:function j(){this._super();if(this.shouldHideDynamicSelIcon){this.dynamicSelIcon.set("visible",false);this.shouldHideDynamicSelIcon=false;}},moveTooltip:function f(AV,AX){var AW=Z.findWidget(AV.target);if(AW.id!==this.boxContent.id){return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.getTooltipContent(),top:AV.clientY+15,left:AV.clientX-15};this._super(AV,AX);},getTooltipContent:function AT(){var Aa=K.call(this),AY=Aa&&Aa.n,AV=this.getDisplayName(),AW=this.isAMSelector(),AX=(AV!==AY),AZ='<div class="name">'+AQ.encodeHtmlString(AV,true)+"</div>";return(AW||!AX)?AZ:(AZ+'<div class="dsc">'+AQ.encodeHtmlString(mstrmojo.desc(15112,"Name in Dataset:")+" "+AY,true)+"</div>");},setSelectTargetsState:function l(AV){var AW=(this.ctrlOverlay||{}).btnSelect;if(AW){AW.set("enabled",AV);AW.set("visible",AV);}},postBuildRendering:function g(){Y.call(this);this._super();this.generateToolbar();var AZ=this.boxContent,AW=this.isAMSelector(),AV=this.isPanelSelector(),AY=mstrApp.isAppStatePresentation(),AX=mstrApp&&mstrApp.supportFeature(N.DYNAMIC_SEL_AND_SORT);if(AV){if(!this.getTargetKeys().length){I.call(this);}}else{if(!this.selectorHasSource()){this.setSelectTargetsState(false);AZ.set("visible",false);if(AW){this.showControlOverlay(AH);}else{this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(13258,"Drag object here.")}]);}}else{if(AZ&&AZ.isInvalid){this.showInvalidMessage();}else{if(!this.getTargetKeys().length&&!AY){I.call(this);}else{if(b.walk("node.data.disabled",AZ)){Q.call(this);}}}}}if(AX&&!AY){var Aa=this.addDisposable(AZ.createDynamicSelectionIcon());Aa.render();this.domNode.insertBefore(Aa.domNode,this.menuBtnInfo.btn);this.dynamicSelIcon=Aa;}if(this.model){H.toggleClass(this.domNode,"items-fit-content",this.model.itemsFitContent);}},showInvalidMessage:function P(){this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"invalidMsg",text:this.boxContent.getInvalidTooltip()}]);},onRender:function F(){if(this._super){this._super();}AU.call(this,!this.showTitleBar);if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&this.model&&this.model.hasRADataset()){this.set("isMasked",true);}},orientationHasChanged:function q(){if(k.call(this)){var AV=this.orientation,AY=AV==="h",AX=this.boxContent,AW=AX.content;this.defn.horiz=AY;if(AX.isRecursiveAttributeSelector()&&AW.isHoriz!==AY){t.removeItem(this.boxContent.disposables,AX.defn);this.rebuildBoxContent(AX.node);this.doLayout();}else{AW.isHoriz=AY;AW.set("orientation",AV);}Y.call(this);}},addFormatProps:function AI(AX,AW){AX=this._super(AX,AW);var AV=this.orientation,AY=AV==="h";if(!this.skipOrientationAction&&k.call(this)){AX=AX||this.model.getUnitFormatAction(this,NaN,null,AW);mstrmojo.models.FormatModel.getFormatUpdate(mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.CONTROL_ORIENTATION,AY?1:0,AX.format);}this.skipOrientationAction=false;return AX;},createDeleteUpdate:function w(){var AW=this.model,AZ=AW.getRemoveControlUpdate(this.k,this.parent.k,this.defn.tks||""),AV=this.boxContent,AX=AV.isFilterNothing&&AV.isFilterNothing();if(this.isPanelSelector()){AZ.setTreesToRender(u.DEFN);}else{if(this.defn.tks&&(!AX||AV.hasDynamicSelection(true))){AZ.setTreesToRender(u.BOTH);}}AZ.addUpdate(AW.associatedNodesUpdate(this.parent.children));if(this.isAMSelector&&this.isAMSelector()){var AY=b.valarray(this.defn.cgb);this.deleteSectionNodeDefn(AZ,AW,AY);}return AZ;},updateToolbar:function AB(AV){U.call(this);var AX=this.boxContent,AW=AX.isAMSelector();if(AX&&this.selectorHasSource(this)){if(mstrApp.isDossier){if(!this.addClearFilterMenuItem(AV,AX)){this.addDynamicSelConsumptionItems(AV,AX);}}else{if(this.canShowDesignMenuItems()){if(this.isSortingAllowed(AX)){this.addAttributeSortMenuItem(AV,AX,true);this.addAttributeSortMenuItem(AV,AX,false);if(AX.defn.sorts){this.addClearSortMenuItem(AV,AX);}AV.addSeparator();}this.addModeMenuItems(AV,AX);AV.addSeparator();this.addDynamicSelectionMenuItem(AV,AX);if(!this.addClearFilterMenuItem(AV,AX)){this.addDynamicSelConsumptionItems(AV,AX);}AV.addSeparator();if(!AW){this.addQualMenuItems(AV,AX);this.addSetDisplayFormsMenuItem(AV,AX);AV.addSeparator();}this.addFilterStyleMenuItem(AV,AX);this.addMultiSelectMenuItem(AV,AX);if(!AW){this.addAutoSearchMenuItem(AV,AX);}AV.addSeparator();if(!AW){this.addMenuItemIfSelectTargetsValid(AV,AX,mstrmojo.desc(12288,"Target the following elements:"));}else{this.addSelectorTargetsMenuItem(AV,AX);}AV.addSeparator();this.addToggleTitleMenuItem(AV);AV.addSeparator();if(!AW){this.addReplaceWithMenuItem(AV,AX);AV.addSeparator();}this.addBFAMenuItem(AV,AX);}else{this.addModeMenuItems(AV,AX);AV.addSeparator();this.addClearFilterMenuItem(AV,AX);}}}return this._super(AV);},showControlOverlay:function s(AW,AV){this._super(AW,AV);H.addClass(this.domNode,"overlay");},hideControlOverlay:function C(){this._super();H.removeClass(this.domNode,"overlay");},onAppStateChange:function AA(AV){var AZ=mstrmojo.vi.VisualInsightApp.APP_STATES,AX=mstrApp.isAppStatePause(),AY=!!(AV.valueWas&AZ.PAUSE),AW=mstrApp.isAppStateSelection();if(AX!==AY){if(this.model.hasRADataset()){this.set("isMasked",AX);}}if(AW){if(this.dynamicSelIcon){this.dynamicSelIcon.set("visible",false);}}if(this._super){this._super(AV);}},addContextMenuItems:function AL(AX,AW){this._super(AX,AW);var AV=this.boxContent;if(!AV.isAMSelector()&&this.selectorHasSource()&&!(AV&&AV.isInvalid)){this.addMenuItemIfSelectTargetsValid(AX,AV,mstrmojo.desc(12288,"Target the following elements:"),false);}if(AV&&AV.isInvalid){this.addDeleteMenuItem(AX);}return AX;},getFormatMenuItemTarget:function G(AV){if(!AV||!Z.contains(this.titlebarNode,AV.getTarget(),true,this.domNode)){return mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE;}return this._super(AV);},getTargetInfo:function e(){var AY=this.parent,AW=this.model,AX=[AF.GRID,AF.GRAPH,AF.MOJOVISUALIZATION,AF.SURVEYCONTAINER,AF.PANELSTACK].concat(AW.isFromSolrCube(this.getSelectorSource())?[]:[AF.SELECTOR]),AZ=AY&&AY.getTargetKeysByType(AX),AV=[];t.forEach(AZ,function(Aa){var Ac=AY.getUnitByKey(Aa),Ab=Ac.defn;if(!((Ac.isAMSelector instanceof Function&&Ac.isAMSelector())||(Ac.isPanelSelector instanceof Function&&Ac.isPanelSelector()))){AV.push({n:Ac.getDisplayName(),id:Aa,st:Ab.style,src:AW.getObjectInfo(Ab.srcid),fgk:Ab.fgk});}});AV=AV.filter(function(Aa){return Aa.id!==this.k&&Aa.st!==X.ATTR_QUAL;},this)||[];return{keys:this.getTargetKeys(),items:AV};},toggleTitleBar:function i(AV){this._super(AV);AU.call(this,!AV);},updateDisplayName:function J(AV,AW,AX){this._super(AV,AW,AX,true);},getAvatarCls:function AC(){return this._super().concat(["filterAvatar"]);},allowDropFromDataset:function h(AV){return !this.selectorHasSource()&&E.call(this,AV)&&mstrApp.allowWebDashboardDesign();},getFormatRelatedActions:function O(Ai){var AY=[],AX=this.boxContent,Ad=AX.isAMSelector(),Ab=this.getDocModel(),AW=this.defn,Ae=0,Ah=this.height,Af=Ad?AW.style:Ab.getCtrlStyleFromDatasetUnit(Ai),AV=Ad?(AW.horiz?1:0):(this.orientation==="v"?0:1);AY=AY.concat(Ab.getCtrlActionsByStyle(Ai,AX.ck,Af,AV,parseInt(this.height,10),parseInt(this.width,10),undefined,undefined,Ad));if(!Ad){if(Ai.t===4){AY.push(Ab.getUnitFormatAction(this,5,AG(z.SHOW_TITLE_BAR,true)));if(Ah==="40px"){Ae=20;}}if(this.orientation==="h"){var Ag=this.parent,Ac=Ag.boxLayoutConfig,Aa=Ac.box,AZ=Aa&&Aa.children&&Aa.children[Ac.getBoxPath(this)];Ae=Ae+Ab.getICSCtrlMoveHeightByStyle(Af);if(AZ&&AZ.f){AZ.l=AZ.l+Ae;AY=AY.concat(Ag.getChildPositionActions(true));AY=AY.concat(Ag.getBoxLayoutActions(true));}}}return AY;},dropFromDataSource:function AN(AV){var Ah=W.call(this,AV);if(Ah){var Ac=this.getDocModel(),Af=Ac.getDataService(),AX=this.defn,AZ=this.getTargetKeys(),AY=[this.k].concat(AZ),Aa=this.boxContent,AW=Aa.k,Ae=b.valarray(AX.cgb).map(function(Ai){return[Ai,true];}),Ab=(AV.actions||[]).concat([Af.getSetCtrlSourceAction(AX.ck,Ah.did,Ah.t,Ae)]),Ag=AO.wrapMethods(AV.callback,{success:function(Ai){var Ak=Ac.getVizContentPanel().getUnitByKey(AW),Aj;Ac.partialUpdate(Ai.data,Ac.getTargetDefn(AY.join(D)),Ai.defn,[Aa.defn.ckey]);if(!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause())){Ak=Ak.parent.rebuildChild(Ak);}Aj=b.walk("defn.srcid",Ak);Ak.boxContent.set("visible",!!Aj);Ak.generateToolbar();}});if(AX.sus){Ab.push(Af.getUnsetSelectorAction({ck:AX.ck,ckey:AX.ckey,resetSuc:true}));}Ab.push(Ac.getUnitFormatAction(this,1,AG(z.TITLE,Ah.n)));var Ad=this.getFormatRelatedActions(Ah);Ab=Ab.concat(Ad);Ac.controller.cmdMgr.execute({execute:function(){var Ai=Af.newUpdate(this,{extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});Ai.addActions(Ab);Ai.addCallbacks(Ag);this.submitUpdate(Ai);},urInfo:{callback:Ag,undo:function(){var Ai=Ac.getVizContentPanel().getUnitByKey(AW);delete Ai.defn.srcid;delete Ai.defn.httl;}}});}},dropFromDataset:function a(AV){this.dropFromDataSource(AV);},dropFromAllObjects:function AK(AV){this.augmentDropContextForSchema(AV,this.getDocModel());this.dropFromDataSource(AV);},validateTarget:function B(AV,AW){return !AV&&!AW;},setTargets:function n(AV){this.getDocModel().changeFilterTargets(this,this.getTargetKeys(),AV,true,true);},getTargetKeys:function A(){var AV=this.parent,AX=this.defn.tks,AW=(AX&&AX.split(D))||[],AZ=(AV&&AV.getTargetKeysByType([AF.SURVEYCONTAINER]))||[],AY=[];AW=AW.concat(AZ.reduce(function(Ac,Aa){var Ab=AV.getUnitByKey(Aa),Ad=Ab.defn.fgk;if(AW.indexOf(Ad)>-1){AY.push(Ad);Ac.push(Ab.k);}return Ac;},[]));AW=AW.filter(function(Aa){return AY.indexOf(Aa)===-1;});return AW;},isSelectionDirty:function S(AV){return AV.length;},getTitleBarCfg:function M(){var AV=this._super(),AW=this;AV.titleEdited=function AX(AZ,Ad,AY){var Ac=this.parent,Af={success:function Ae(Ag){Ac.defn.ttl=Ag;Ac.set("title",Ag);},failure:function Ab(Ag){mstrApp.onerror(Ag);Ac.titleBar.set("title",AY);}};Ac.draggable=true;if(Ad){var Aa=Ac.getDocModel();Aa.updateTitle(AZ,this.title,Ac.k,Aa.currlaykey,"ttl",Af);}Ac.editingTitleCallback(false);};AV.getTooltipContent=function(){return AW.getTooltipContent();};AV.shouldShowTooltip=function(){return !AW.isAMSelector();};AV.tooltipOpenDelay=c;return AV;},applyCSSFormatToNode:function p(AW,AV){var AY=this.boxContent;if(AY&&AY.content&&AY.content.hasRendered){var AX=AY._inSyncPhase;AY._inSyncPhase=true;AY.content.refresh();AY._inSyncPhase=AX;}this._super(AW,AV);},getBoxConfiguration:function d(){var AV=this._super();if(this.showTitleBar){AV=mstrmojo.hash.clone(AV);AV.f.v+=20;}return AV;},cancel:function o(){this.refresh();},updateAriaLabel:function AD(){var AV=this.title+", "+mstrmojo.desc(6189,"Filter");if(AV!==this.ariaLabel){this.set("ariaLabel",AV);}},onfocus:function AJ(){var AV=this.boxContent;if(AV.updateAriaLabel){AV.updateAriaLabel();}},enterUnit:function m(){this.toggleTabSelectionEffect(false);var AV=this.boxContent;if(AV&&AV.enterUnit){AV.enterUnit();}}});mstrmojo.vi.ui.rw.FilterBox.boxConfiguration={f:{h:150,v:42},o:"v"};mstrmojo.vi.ui.rw.FilterBox.AMSelectorCtrlOverLay=AH;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.VisEnum","mstrmojo.VisLegend","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.gm.GMIdentities","mstrmojo.gm.GMUtility","mstrmojo.array","mstrmojo.hash","mstrmojo._FormateVisLegend","mstrmojo.gm.SingleColorByLegend");var Ao=mstrmojo,Ak=Ao.gm,AG=Ao.dom,Aj=Ao.css,P=Ao.array,S=Ao.hash,AU=Ao.VisUtility,d=Ak.GMUtility,B=Ao.VisEnum.ControlType,m=Ak.EnumLegendSlot,AS=Ak.EnumDockPosition,q=Ak.EnumLegendSlot,AM=Ak.EnumIdentityType,AJ=Ak.EnumShape,Ae=Ao.VisEnum.GMLegendDataType,H=mstrmojo.desc(13966,"Size by:"),AC="px",D=1.35,c=0.75,Z=5,I=20,o=I,AK=5,A=5,AD=16,i=15,F=16,AP=20,E=150,y=15,Am=1,AF="setAttribute",n=3,k=2,Q=8,w=15,AZ=14,AA=1,R=2,j=4,Ap=8,An=16,K=10,Ab=3,AQ=50,AW=-3,z=5,AX="gm-legend-lock-icon",AT=mstrmojo.desc(14442,"This metric has its axis scale set to custom min and max values"),O="http://www.w3.org/2000/svg",AB="\u2026",L=/[ \-]/;var x=[{pos:q.LEFT_TOP},{pos:q.LEFT_MIDDLE},{pos:q.LEFT_BOTTOM},{pos:q.RIGHT_TOP},{pos:q.RIGHT_MIDDLE},{pos:q.RIGHT_BOTTOM}];function U(Aq){return{top:Aq?Z*4:Z,bottom:Z};}function N(Aq,As){var Ar=U(As);return Aq-Ar.top-Ar.bottom;}function AY(Av,Ax,Aq,Ay){if(!Av){return ;}var As,A1,At,A0,Aw=Av.style,A2=Ax===AS.TOP,Ar=Ax===AS.BOTTOM,Az=Ax===AS.LEFT,Au=Ax===AS.RIGHT;if(A2||Ar){As=Aq;A1=1;At=-1;A0=AW;if(Ar){A0+=Ay;}}else{if(Az||Au){As=1;A1=Ay;A0=-1;At=AW;if(Au){At+=Aq;}}}Aw.cssText="left:"+At+AC+";top:"+A0+AC+";width:"+As+AC+";height:"+A1+AC+";";if(mstrApp.isInVFInteractMode){Aw.cursor="default";}}function G(Ar){var Aq=String(Ar);return Aq.indexOf(" ")>=0||Aq.indexOf("-")>=0;}function a(As,Ar,At){var Aq=typeof As==="string"?d.restoreSpecialChars(As):As;return AU.measureTextWidth(Aq,Ar,At,undefined,true,true);}function AO(Au,At,Ar,Aq){var As=a(At,Ar,K);Au.setAttribute("measureWidth",As);if(As>Aq){As=Aq;}else{Au.style.overflow="visible";}Au.setAttribute("displayWidth",As);Au.style.width=As+AC;return As;}function Al(Av,Au){var At=Av.cloneNode(true),Aq,As,Ar;document.body.appendChild(At);As=At.style;for(Ar in Au){As[Ar]=Au[Ar];}As.visibility="hidden";Aq=At.offsetHeight;document.body.removeChild(At);return Aq;}function f(As){var Ar=As.getAttribute("measureWidth"),Aq=As.getAttribute("displayWidth");if(!Ar){As[AF]("title","");}Ar=parseFloat(Ar,10);Aq=parseFloat(Aq,10);if((Ar-Aq)>0.1){As[AF]("title",As.textContent);}else{As[AF]("title","");}}function AR(Au,Aq,Ar,At){var As=document.createElement("div");As[AF]("class","gm-legend-underLine");As.style.width=At-K+AC;As.style.left=Aq+5+AC;As.style.top=Ar+AC;Au.appendChild(As);}function Ad(At,Aq,Ar){var As=document.createElement("div");As[AF]("class","gm-legend-underLine-anchorPoint");As.style.left=Aq+AC;As.style.top=Ar-3+AC;At.appendChild(As);}function AN(At,Aq,Ar,As){AR(At,Aq,Ar,As);Ad(At,Aq,Ar);}function p(As,A3,Az,Ax,A1){var Ay,At,A0,Aq,A2=As.textContent,Aw=A2.length,Au=0,Ar=Aw,Av=false;if(As.scrollHeight>1.5*F){Ay=a(As.textContent,A3,K);At=Ay-Az+K;if(At>A1){while((Ar-Au)>1){A0=(Au+Ar)>>1;Aq=A2.substring(0,A0)+AB;Ay=a(Aq,A3,K);At=Ay-Az+K;if(At>A1){Ar=A0;}else{Au=A0;}}As.textContent=A2.substring(0,Au)+AB;As[AF]("title",A2);Av=true;Ay=a(As.textContent,A3,K);At=Ay-Az+K;}AR(As,0,Ax+F,(At<A1)?At:A1);}if(Az>A1){As[AF]("title",A2);}else{if(!Av){As[AF]("title","");}}}function AE(Aq,Az,Av,Ar,Ay,A0){var As,Au,Aw,Ax,At=document.createElement("div");At[AF]("class","gm-legend-textcell");At[AF]("type",B.LGD_TEXT);At.style.lineHeight=i+AC;if(Ay){Ax=AO(At,Az,A0,Ay);}if(Ar&AA){As=(AP+AZ)/2+Av*AP;Aw=AD;}else{As=(y+AZ)/2+Av*y;if(Ar&Ap){if(Ar&An){Aw=0;}else{Aw=w;}}else{if(Ar&j){Aw=Q;}else{Aw=0;}}}Au=Ax||w+K;At.innerText=Az;At.identity={objType:AM.LEGEND_TEXT};AN(Aq,Aw,As,Au);this.textDivs.push(At);Aq.appendChild(At);}function Ah(Aq,At){var Ar,Av,Au,As=0;if(Aq){Au=Aq.elements;for(Ar=0,Av=Au.length;Ar<Av;Ar++){As=Math.max(As,a(Au[Ar].label,At,K));}As+=AD+A*2+Ab;}return As;}function Y(At,As){var Aw,Aq,Av,Au=At.items,Ar=0;if(!Au){return 0;}Aw=Au.length;Av=At.custMetrics;for(Aq=0;Aq<Aw;Aq++){if(Av&&Av.indexOf(Au[Aq])!==-1){Ar=Math.max(Ar,a(Au[Aq],As,K)+Q);}else{Ar=Math.max(Ar,a(Au[Aq],As,K));}}return Ar;}function AV(At,As){var Aq,Av,Au,Ar=0;if(At){Au=At.elements;Av=Au.length;if(At.caseFlag===1){Ar=Y(At,As);}else{if(At.caseFlag===0){for(Aq=0;Aq<Av;Aq++){Ar=Math.max(Ar,a("Max: "+Au[Aq].v,As,K));}Ar+=y*n;Ar=Math.max(Ar,Y(At,As));}else{if(At.caseFlag===2){for(Aq=0;Aq<Av;Aq++){Ar=Math.max(Ar,a(Au[Aq].v,As,K));}Ar+=y*Av+w;Ar=Math.max(Ar,Y(At,As));}else{if(At.caseFlag===3){for(Aq=0;Aq<Av;Aq++){Ar=Math.max(Ar,a(Au[Aq].v,As,K));}Ar+=y*z;}}}}Ar=Math.max(Ar,a(H,As,K));Ar+=A*3;}return Ar;}function h(A7,A0,Au){if(!A7||!A7.length||A7.length<1){return 0;}var A4,A2,Av,Aw,Az,As,Aq,A3,A5,Ar,A6,Ax,A1,Ay=o+2*Am,At=Ay;for(A4=0;A4<A7.length;A4++){Aq=A7[A4];if(Aq.dataType===Ae.COLOR_BY){A3=Aq.dataObj;if(A3){Ar=2*AK+F;Av=d.removeExtraSpace(A3.item);As=a(Av,Au,K);if((As+2*A>A0-2*Am)&&G(Av)){Ar+=F;}Aw=A3.elements;A2=Aw.length;Ar+=A;Ar+=k;Aw.forEach(function(A8){if(AU.containsImg(A8.bftp,A8.label)){Ak.GMLegend.IMAGE_SIZE_FIXED=E;AP=E;}});A6=Ar+AP*A2;Ax=Ar+(A2>0?AP:0);Ay+=A6;At+=Ax;Aq.height=A6;Aq.minHeight=Ax;}}else{if(Aq.dataType===Ae.SIZE_BY){A5=Aq.dataObj;if(A5){A1=2*AK+F;Av=d.removeExtraSpace(A5.item);As=a(Av,Au,K);if((As+2*A>A0-2*Am)&&G(Av)){A1+=F;}Az=A5.caseFlag;if(Az===1){A2=0;}else{if(Az===0){A2=2;}else{if(A5.caseFlag===2||Az===3){A2=A5.elements.length;}}}A2+=(A5.items&&A5.items.length)||0;A1+=y*A2;A1+=A;A1+=k;Aq.height=A1;Aq.minHeight=A1;Ay+=A1;At+=A1;}}}}return{height:Ay,minHeight:At};}function Ai(Aq,Ar){var At=0,As=0;P.forEach(Aq||[],function(Au){var Av;if(Au.dataType===Ae.COLOR_BY){Av=Ah(Au.dataObj,Ar);if(Av>At){At=Av;}}else{if(Au.dataType===Ae.SIZE_BY){Av=AV(Au.dataObj,Ar);if(Av>As){As=Av;}}}});return Math.max(At,As)+2*Am;}function J(Aq,Aw){var Av=Aq.reduce(function(Ax,Ay){return Ax+(Ay.dataType===Ae.SIZE_BY?(Ay.height||0):0);},0),Au=Aw-(o+2*Am)-Av,Ar=function(Ax){return S.walk("dataObj.elements.length",Ax);},As=Aq.reduce(function(Ax,Ay){return Ax+(Ay.dataType===Ae.COLOR_BY?Ar(Ay):0);},0),At;P.forEach(Aq,function(Ax){At=Ar(Ax);if(Ax.dataType===Ae.COLOR_BY&&At>=0){Ax.maxHeight=Math.max(At/As*Au,Ax.minHeight);if(Ax.height>Ax.maxHeight){Ax.cutBy=Ax.height-Ax.maxHeight;}Au-=Math.min(Ax.height,Ax.maxHeight);As-=At;}});}function l(Aw,As,Ar,Ay,At){var Av=h(Aw,As,Ay),Ax=Av.height,Aq=N(Ar,At),Au={};Au.autoCollapse=false;Au.minHeight=Av.minHeight;Au.width=As;Au.height=Math.min(Ax,Aq);if(Ax>Aq){J(Aw,Aq);}return Au;}function AL(Aq){Aq=P.ensureArray(Aq);return P.filter(Aq,function(Ar){return Ar&&Ar.dataType===Ae.COLOR_BY&&Ar.dataObj;});}function M(Aq){var As=[],Ar;Aq=AL(Aq);P.forEach(Aq,function(At){Ar=At.dataObj;As=As.concat(Ar.elements);});return As;}function b(){return AL(this.dataArray).length;}function Aa(){var Aq,Ar,A0,Au=this.triBtn,Ay=this.closeBtn,Aw=this.cbContainer,Ax,Av=this.height-o-A-2*Am,Az=this.width-2*A-2*Am,As=this.children,At;Au[AF]("class","gm-legend-tri-button-collapsed");Au[AF]("title",this.autoCollapse?mstrmojo.desc(13682,"There is not enough space to display the legend"):mstrmojo.desc(13683,"Maximize Legend"));Ay.style.display="none";this.splitter.style.display="none";this.domNode.style.overflow="hidden";Aw.style.top=o+AC;Aw.style.width=Az+AC;Aq=M(this.dataArray);P.forEach(As,function(A1,A2){At=A1.domNode.style;if(A2===0){Ar=A1.cbTitle;Ar.style.display="none";Aj.addClass(A1.sepLine,"toggleHide");Ax=A1.cbTableContainer;Ax.style.top="0px";A0=A1.cbTable;A1.fillColorByTableInMinMode(Aq,Av);Ax.style.top=A+AC;Ax.style.height=A0.offsetHeight+AC;Aw.style.height=Av+AC;}else{At.display="none";}});}function s(As,Ar,Au,Aq){var At=document.createElementNS(O,"circle");At.setAttribute("cx",Ar);At.setAttribute("cy",Au);At.setAttribute("r",Aq);At.setAttribute("class","gm-legend-sizeby-circle");As.appendChild(At);}function AI(As,At,Aw,Ar,Av,Ax,Au){var Aq=document.createElementNS(O,"line");Aq.setAttribute("x1",At);Aq.setAttribute("y1",Aw);Aq.setAttribute("x2",Ar);Aq.setAttribute("y2",Av);Aq.style.strokeWidth=Ax;if(Au){Aq.setAttribute("class",Au);}As.appendChild(Aq);}function Ag(Ar,A5){var A4,As,Au,Av,At,Aq,A3,Aw,A6,Ax,A1=Math.PI,Ay=A5.elements,Az=Ay.length,A0=Az*y,A2=Ar.getContext("2d"),A7={LINE_COLOR:"#b0b0b0",MIN_WIDTH:1,MAX_WIDTH:10},A8=AU.getPropertyByPath(this,"widget.model.data.visName")||AU.getPropertyByPath(this,"widget.model.data.vis.vn");switch(A8){case"GraphMatrixVisualizationStyle":if(this.shapeType===AJ.SQUARE||this.shapeType===AJ.TICK||this.shapeType===AJ.LINE||this.shapeType===AJ.BAR||this.shapeType===AJ.AREA||this.shapeType===AJ.RECTANGLE){Ax="rectangle";}else{Ax="circle";}break;case"VIHeatMapVisualizationStyle":Ax="rectangle";break;default:Ax="circle";break;}switch(A5.caseFlag){case 0:A2.save();if(mstrApp.getThemeClassName().indexOf("dark")>=0){A2.strokeStyle="rgba(116, 116, 117, 0.7)";A2.fillStyle="rgba(116, 116, 117, 0.7)";}else{A2.strokeStyle="rgba(188, 188, 189, 0.7)";A2.fillStyle="rgba(188, 188, 189, 0.7)";}A0=y*n;A6=Math.floor(y*0.75+0.5);As=Math.floor(A6/3.5+0.5);if(Ax==="circle"){Av=A6+1;At=y;A2.beginPath();A2.arc(Av,At,A6,0,2*A1,false);A2.fill();A2.stroke();Av=2*Av+2*As;At=Math.floor(0.53*y+0.5);A2.beginPath();A2.arc(Av,At,As,0,2*A1,false);A2.fill();A2.stroke();}else{Av=1;At=y-A6;A2.beginPath();A2.fillRect(Av,At,2*A6,2*A6);Av=2*A6+2+As;At=Math.floor(0.53*y-As+0.5);A2.beginPath();A2.fillRect(Av,At,2*As,2*As);}A2.translate(0.5,0.5);A2.lineWidth=1;A2.strokeStyle="#9C9C9C";Av=2*A6+3*As+3;At=Math.floor(0.53*y+0.5);A2.beginPath();A2.moveTo(Av,At);A2.lineTo(A0,At);A2.stroke();Av=2*A6+2;At=Math.floor(1.53*y-As+0.5);A2.beginPath();A2.moveTo(Av,At);A2.lineTo(Av+As,At+As);A2.lineTo(A0,At+As);A2.stroke();A2.restore();break;case 1:break;case 2:Au=parseInt(Ay[0].diameter,10);Au=Math.min(Au,A0);A2.fillStyle="#ADADAC";A2.strokeStyle="#ADADAC";if(Ax==="circle"){Av=A0>>1;At=Av;A2.arc(Av,At,Au>>1,0,2*A1,false);A2.fill();A2.stroke();}else{Av=(A0-Au)>>1;At=Av;A2.rect(Av,At,Au,Au);A2.fill();A2.stroke();}break;case 3:Aq=A7.MIN_WIDTH;A3=(Az===1?0:(A7.MAX_WIDTH-A7.MIN_WIDTH)/(Az-1));A0=Ar.width;Aw=y;Av=0;At=y/2;A2.strokeStyle=A7.LINE_COLOR;for(A4=0;A4<Az;A4++){A2.lineWidth=Aq;A2.beginPath();A2.moveTo(Av,At);A2.lineTo(A0-Av,At);A2.stroke();At+=Aw;Aq+=A3;}break;default:break;}}function Ac(Ar,Ay){var Ax=1,Aq,Av=1.5*F,Aw=Ar.textContent,As=Aw.split(L),Az,At;var Au=function(A0){At=Aw[A0];return At!==undefined?At:"";};if(Ar.scrollHeight>Av){if(!As[0]){return 0;}Aq=As[0]+Au(As[0].length);while(As[Ax]!==undefined){Az=Aq+As[Ax];Az+=Au(Az.length);Ar.textContent=Az;if(Ar.scrollHeight>Av){break;}Aq=Az;Ax++;}Ar.textContent=Aw;}else{Aq=Aw;}return a(Aq,Ay,K);}function g(A6,A4,A5,A0){var A3,As,Av,Au,Az,A2,Ay=A4.elements,A1=Ay.length,Ax=[],A7=document,Aq=A7.createDocumentFragment(),At=false,Aw=this.styles,Ar=A5;switch(A0){case 0:if(A1>0){Ax.push({v:"Min: "+Ay[A1-1].v});Ax.push({v:"Max: "+Ay[0].v});A1=2;}break;case 1:Ay=A4.items;P.forEach(Ay,function(A8){Ax.push({v:A8});});break;case 3:Ax=Ay;break;default:Ax=Ay;At=true;break;}A1=Ax.length;for(A3=0;A3<A1;A3++){As=A7.createElement("tr");As[AF]("class","gm-legend-tr2");As.style.height=y+AC;if(At){Av=A7.createElement("td");AE.call(this,Av,Ax[A3].sign,A3,R|Ap|An);Av[AF]("class","gm-legend-sign");As.appendChild(Av);Ar-=w;}Au=A7.createElement("td");Au[AF]("class","gm-legend-desc");if(A4.custMetrics&&A4.custMetrics.indexOf(Ax[A3].v)!==-1){AE.call(this,Au,Ax[A3].v,A3,R|j,Ar-Q,Aw);A2=parseInt(Au.lastChild.style.width,10);Az=A7.createElement("div");Az.setAttribute("class",AX);Az.setAttribute("title",AT);Au.appendChild(Az);Az.style.top=(y-8)/2+A3*y+AC;Au.lastChild.style.marginLeft=A2+AC;}else{if(At){AE.call(this,Au,Ax[A3].v,A3,R|Ap,Ar,Aw);}else{AE.call(this,Au,Ax[A3].v,A3,R,Ar,Aw);}}As.appendChild(Au);Aq.appendChild(As);}A6.appendChild(Aq);}function X(){var As="."+AX,Aq=this.domLegend.querySelectorAll(As),Ar;P.forEach(Aq,function(At){Ar=At.parentNode;if(Ar){Ar.removeChild(At);}});}function Af(){this.destroyChildren();var As=[],Aq=this.width-2*A-2*Am,Ar=AL(this.dataArray);P.forEach(Ar,function(At){As.push({scriptClass:"mstrmojo.gm.SingleColorByLegend",slot:"cbContainer",data:At,coreWidth:Aq,rowHeight:AP,tableTitleLineHeight:F});});this.addChildren(As);}function W(){var BM,BF,BR=0,BS,A8,BH,BB,At,BK,BN,Ay,BQ,A9=0,BL,Aq=this.width-2*Am,A2=Aq-2*A,Av=document,As=this.triBtn,BG=this.closeBtn,BE=this.cbContainer,A3,BU=this.sb1Container,Ax=this.sb2Container,A1,Az,Au,A0,BI,Aw=0,A5,BD=0,BO=0,BC=this.styles,BJ,BP,A7=(F+AZ)/2,Ar,A4,BT,BA,A6=this.children;As[AF]("class","gm-legend-tri-button");As[AF]("title",mstrmojo.desc(13684,"Minimize Legend"));BG.style.display="block";BG[AF]("title",mstrmojo.desc(12002,"Hide Legend"));this.updateSplitter();X.call(this);this.domNode.style.overflow="visible";BE.style.top=o+AC;BE.style.width=A2+AC;for(BF=0;this.dataArray&&BF<this.dataArray.length;BF++){Az=this.dataArray[BF];BI=null;A5=null;if(Az.dataType===Ae.COLOR_BY){BI=Az.dataObj;if(BI){BT=A6[Aw++];BA=BT.domNode.style;BA.top=BD+AC;BA.width=A2+AC;A3=BT.cbTableContainer;BB=d.removeExtraSpace(BI.item);At=BI.elements;BM=At.length;BQ=0;if(BO===0){Aj.addClass(BT.sepLine,"toggleHide");BO++;}BS=BT.cbTitle;BS.style.display="block";AO(BS,BB,BC,A2);BS.textContent=BB;BQ+=Al(BS,BC)+2*AK;Ar=Ac(BS,BC);p(BS,BC,Ar,A7,A2);AN(BS,0,A7,(Ar<A2)?Ar:A2);A8=BT.cbTable;A8.style.display="block";A8.style.width=(A2-Ab)+AC;A8.style.marginLeft=Ab+AC;BT.fillColorByTableInNormalMode(BI,0);BK=AP*BM+1;A3.style.top=BQ+AC;A8.style.display="table";BQ+=BK+A;if(Az.cutBy>0){BQ-=Az.cutBy;BK-=Az.cutBy;}A3.style.height=BK+AC;A9+=BQ;BD+=BQ+k;}}else{if(Az.dataType===Ae.SIZE_BY){A5=Az.dataObj;if(A5){BR++;if(BR===1){Au=BU;A0=this.sb1Title;BH=this.sb1MetricNamesTable;A8=this.sb1DataTable;A1=this.sb1Canvas;}else{Au=Ax;A0=this.sb2Title;BH=this.sb2MetricNamesTable;A8=this.sb2DataTable;A1=this.sb2Canvas;}Au.style.display="block";BB=d.removeExtraSpace(A5.item);At=A5.elements;BM=At.length;Au.style.top=(o+BD)+AC;Au.style.width=A2+AC;BQ=0;if(BO===0){Aj.addClass(this.sepLine2,"toggleHide");BO++;}if(A5.caseFlag===0){BN=n*y;Ay=2*y;}else{if(A5.caseFlag===3){BN=z*y;Ay=BM*y;}else{BN=BM*y;Ay=BN;}}BS=A0;BS.textContent=BB;BP=A5.custMetrics&&A5.custMetrics.indexOf(BB)!==-1;if(BP){A4=A2-Q;}else{A4=A2;}AO(BS,BB,BC,A4);if(BP){BJ=Av.createElement("div");BJ.setAttribute("class",AX);BJ.setAttribute("title",AT);Au.appendChild(BJ);BJ.style.top=(BS.offsetHeight-8)/2+AK+k+AC;BJ.style.left=BS.offsetWidth+"px";}Ar=Ac(BS,BC);p(BS,BC,Ar,A7,A4);AN(BS,0,A7,(Ar<A4)?Ar:A4);BQ+=Al(BS,BC)+2*AK;BL=A2;AG.emptyNode(BH);if(A5.items&&A5.items.length>0){BH.style.display="block";g.call(this,BH,A5,BL,1);}else{BH.style.display="none";}BH.style.top=BQ+AC;BH.style.left="0"+AC;BH.style.width=BL+AC;BQ+=BH.offsetHeight;if(BN>0){BL-=BN+A;}AG.emptyNode(A8);if(A5.elements&&A5.elements.length>0){A8.style.display="block";g.call(this,A8,A5,BL,A5.caseFlag);}else{A8.style.display="none";}A1.style.position="absolute";A1.style.top=BQ+AC;A1.style.marginLeft=A+AC;A8.style.top=BQ+AC;A8.style.left=(BN+A)+AC;A8.style.width=BL+AC;BQ+=Ay+A;Au.style.height=BQ+AC;A8.style.display="table";A1.width=BN;A1.height=Ay;Ag.call(this,A1,A5);BD+=BQ+k;}}}}if(Aw>0){BE.style.height=A9+AC;}}function t(){var Aq,Ar=this.textDivs,As=Ar.length;for(Aq=0;Aq<As;Aq++){f(Ar[Aq]);}}function e(Aq){P.forEach(this.children,function(Ar){if(Aq){Ar.cbTableContainer.scrollTop=Ar.cbTableScrollTop;}else{Ar.cbTableScrollTop=Ar.cbTableContainer.scrollTop;}});}mstrmojo.gm.GMLegend=mstrmojo.declare(mstrmojo.VisLegend,[mstrmojo._FormateVisLegend],{scriptClass:"mstrmojo.gm.GMLegend",cssClass:"gm-legend",dropZoneHighlightCss:"gm-legend-slot",dockedPositions:null,dockPos:AS.LEFT,GMW:0,GMH:0,isMinimal:false,shapeType:undefined,legendMarkup:'<div class="gm-legend-button"><div class="gm-legend-tri-button"></div><div class="gm-legend-name"></div><div class="gm-legend-close-button"></div></div><div class="gm-legend-container"></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-resizer-v" draggable="false"></div><div class="gm-legend-resizeRect"></div>',init:function AH(Ar){this.styles={};this.dataArray=null;this.textDivs=[];this.dockedPositions=[{pos:q.LEFT_TOP},{pos:q.LEFT_MIDDLE},{pos:q.LEFT_BOTTOM},{pos:q.RIGHT_TOP},{pos:q.RIGHT_MIDDLE},{pos:q.RIGHT_BOTTOM}];var As=Ar.placeholder,Aq=As.style;if(As){this.cssClass=As.getAttribute("class");if(!this.cssClass){this.cssClass="";}if(Ar.hasOwnProperty("width")===false){Ar.width=(Aq&&Aq.width)||As.clientWidth;}if(Ar.hasOwnProperty("height")===false){Ar.height=(Aq&&Aq.height)||As.clientHeight;}if(Ar.hasOwnProperty("left")===false){Ar.left=As.offsetLeft;}if(Ar.hasOwnProperty("top")===false){Ar.top=As.offsetTop;}}this._super(Ar);},getSplitterDockPos:function(){return(this.currDockedPositionIdx<3)?AS.RIGHT:AS.LEFT;},isOnRight:function(Aq){return(Aq===q.RIGHT_MIDDLE||Aq===q.RIGHT_TOP||Aq===q.RIGHT_BOTTOM||Aq===q.RIGHT);},updateAlignClass:function(){var Au=this.getDockedPosition(),Av=Au&&Au.pos,As=this.isOnRight(Av),Aq=this.domLegend,Ar=this.domNode,At=this.resizeRect;if(As){Aj.removeClass(Aq,"gm-align-left");Aj.addClass(Aq,"gm-align-right");Aj.toggleClass(Aq,"gm-legend-alignRight",true);Aj.toggleClass(Aq,"gm-legend-alignLeft",false);Aj.toggleClass(Ar,"gm-legend-alignRight",true);Aj.toggleClass(Ar,"gm-legend-alignLeft",false);Aj.toggleClass(At,"gm-legend-alignRight",true);Aj.toggleClass(At,"gm-legend-alignLeft",false);}else{Aj.removeClass(Aq,"gm-align-right");Aj.addClass(Aq,"gm-align-left");Aj.toggleClass(Aq,"gm-legend-alignRight",false);Aj.toggleClass(Aq,"gm-legend-alignLeft",true);Aj.toggleClass(Ar,"gm-legend-alignRight",false);Aj.toggleClass(Ar,"gm-legend-alignLeft",true);Aj.toggleClass(At,"gm-legend-alignRight",false);Aj.toggleClass(At,"gm-legend-alignLeft",true);}},postBuildRendering:function(){this._super();var A4=this.styles,Aw=this.domNode,A3=this.domLegend.childNodes,Ay=A3[1],A2=A3[2],At=A3[3],A0={objType:AM.LEGEND};this.addSlots({lgdBtn:A3[0],triBtn:A3[0].firstChild,lgdName:A3[0].childNodes[1],closeBtn:A3[0].lastChild,cbContainer:Ay,sb1Container:A2,sepLine2:A2.firstChild,sb1Title:A2.childNodes[1],sb1MetricNamesTable:A2.childNodes[2],sb1DataTable:A2.childNodes[3],sb1Canvas:A2.childNodes[4],sb2Container:At,sepLine3:At.firstChild,sb2Title:At.childNodes[1],sb2MetricNamesTable:A2.childNodes[2],sb2DataTable:At.childNodes[3],sb2Canvas:At.childNodes[4],splitter:A3[4],resizeRect:A3[5]});Ak.GMLegend.applyHTML5Props(A4);this.bgColor=A4.background||A4.backgroundColor||"transparent";AU.applyStyle2Legend(A4,Aw,this.domLegend);if(mstrApp.isInVFInteractMode||AG.isTouchOptimizationEnabled()){this.closeBtn.style.visibility="hidden";}var Ax=this.getSplitterDockPos(),A1=this.width-2*A-2*Am,Ar=this.sb1Title,Av=this.sb2Title,Au=Ar.style,Az=Av.style,As=this.sepLine2,Aq=this.sepLine3;As.style.width=A1+AC;Aq.style.width=A1+AC;Au.lineHeight=F+AC;Az.lineHeight=F+AC;Au.maxHeight=2*F+AC;Az.maxHeight=2*F+AC;Ar.identity={objType:AM.LEGEND_TEXT,parentIdentity:A0};Av.identity={objType:AM.LEGEND_TEXT,parentIdentity:A0};this.dockPos=Ax;this.identity=Aw.identity=A0;this.updateAlignClass();},feedData:function(Aq,Ar){this.dataArray=Aq;Af.call(this);this.isMinimal=Ar;this.textDivs=[];Ak.GMLegend.applyHTML5Props(this.styles);this.autoCollapseLegend();var As=this.cbContainer,At=this.sb1Container,Au=this.sb2Container;As.style.display=b.call(this)>0?"block":"none";At.style.display="none";Au.style.display="none";if(Ar||this.autoCollapse){Aa.call(this);this.draggable=false;}else{W.call(this);this.draggable=true;}t.call(this);P.forEach(this.children,function(Av){Av.updateScrollbars();});},autoCollapseLegend:function(){this.autoCollapse=false;},updateColorBySquare:function(Aq){if(!this.children){return ;}var Ar=this.children.filter(function(As){return As.data&&As.data.inColorByDropZone===true;});if(Ar.length>0){Ar=Ar[0];Ar.data.dataObj=Aq;if(this.isMinimal){Aa.call(this);}else{Ar.prevScrpllTop=null;Ar.onscroll();}}},updateContainerSize:function(Aq,Ar){this.GMW=Aq;this.GMH=Ar;this.calculateDockedPositions(Aq,Ar);},updateAfterResize:function(){Ak.GMLegend.applyHTML5Props(this.styles);var Av=0,Au=this.width,Aw=this.cbContainer,Ay=this.sb1Container,As=this.sb2Container,At=this.sepLine1,Ar=this.sepLine2,Aq=this.sepLine3,Ax=Au-2*A-2*Am;P.forEach(this.dataArray||[],function(Az){if(Az.dataType===Ae.COLOR_BY){if(Az.dataObj){if(Aw){Aw.style.width=Ax+AC;}}}else{if(Az.dataType===Ae.SIZE_BY){if(Az.dataObj){Av++;if(Av===1&&Ay){Ay.style.width=Ax+AC;}if(Av===2&&As){As.style.width=Ax+AC;}}}}});if(At){At.style.width=Ax+AC;}if(Ar){Ar.style.width=Ax+AC;}if(Aq){Aq.style.width=Ax+AC;}this.domLegend.style.width=this.width+AC;this.domLegend.style.height=this.height+AC;},updateStyle:function(Aq){this.styles=Aq;this.bgColor=Aq.background||Aq.backgroundColor||"transparent";AU.applyStyle2Legend(Aq,this.domNode,this.domLegend);},updateTitleLineHeight:function(){var Ar,Au,As=this.sb1Title,Aq=this.sb2Title,Av=As.style,At=Aq.style;Ak.GMLegend.applyHTML5Props(this.styles);Av.lineHeight=F+AC;At.lineHeight=F+AC;Av.maxHeight=2*F+AC;At.maxHeight=2*F+AC;P.forEach(this.children,function(Aw){Ar=Aw.cbTitle;Au=Ar.style;Au.lineHeight=F+AC;Au.maxHeight=2*F+AC;});},getSplitterPosition:function(As){var Ar=As.src.startPos+As.tgt.pos.x-As.src.pos.x,Au=As.src.posInfo,At=Au&&Au.min,Aq=Au&&Au.max;if(At!==undefined){Ar=Math.max(Ar,At);}if(Aq!==undefined){Ar=Math.min(Ar,Aq);}return Ar;},positionResizeRect:function(Aq,Ar){var At=Aq.src.posInfo.dockPosition===AS.LEFT,Au=Ar-AW,Av=At?Au:0,As=At?this.width-Au:Au;this.resizeRect.style.left=(Av-1)+AC;this.resizeRect.style.width=(As-2)+AC;},updateLegendSlot:function(As){var Ar=this.getDockedPosition(),Aq=Ar&&Ar.pos;if(Aq!==As){this.currDockedPositionIdx=this.getLegendDockPosIdx(As);this.dockPos=this.getSplitterDockPos();this.updateDropZonePosition();this.updateAlignClass();this.updateSplitter();this.widget.onLegendDropZoneChange(this.getDockedPosition());}},isDragValid:function u(Aq){return !mstrApp.isInVFInteractMode&&this._super(Aq);},ondragstart:function(Aq){var As=Aq.src.e.target,Ar=Aq.src.data;if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(false);}if(As===this.splitter){Aq.src.startPos=As.offsetLeft;Aq.src.posInfo=this.getSplitterInfo(As);this.positionResizeRect(Aq,Aq.src.startPos);Aj.addClass(this.resizeRect,"resizing");}else{e.call(this,false);this._super(Aq);if(!Ar||!Ar.isScrollBar){this.clearSelectedTargets();Aj.toggleClass(this.domNode,"gm-legend-hover",false);Aj.toggleClass(this.domLegend,"active",false);e.call(this,true);this.domLegend.style.background=this.bgColor;this.isDragging=true;}}},ondragmove:function C(Aq){var As=Aq.src.e.target,Ar;if(As===this.splitter){Ar=this.getSplitterPosition(Aq);As.style.left=Ar+AC;this.positionResizeRect(Aq,Ar);}else{this._super(Aq);}},ondragend:function(Aq){var As=Aq.src.e.target;if(As===this.splitter){Aj.removeClass(this.resizeRect,"resizing");this.splitterMoved(this.getSplitterPosition(Aq)-Aq.src.startPos,Aq.src.posInfo);}else{this._super(Aq);var Ar=Aq.src.data;if(!Ar||!Ar.isScrollBar){e.call(this,true);this.domLegend.style.background="transparent";this.isDragging=false;}}if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},calculateDockedPositions:function(Ax,Ar){var Aq,Au=this.getWidth(),At=this.getHeight(),Av=this.dockedPositions,As=this.widget&&this.widget.needExtraPaddingTop4Legend&&this.widget.needExtraPaddingTop4Legend(),Aw=U(As),Ay=function(Az){switch(Az.pos){case m.LEFT_TOP:Az.x=0;Az.y=Aw.top;break;case m.LEFT_MIDDLE:Az.x=0;Az.y=Math.max(Aw.top,(Ar-At)>>1);break;case m.LEFT_BOTTOM:Az.x=0;Az.y=Math.max(Aw.top,Ar-At-Aw.bottom);break;case m.RIGHT_TOP:Az.x=Ax-Au;Az.y=Aw.top;break;case m.RIGHT_MIDDLE:Az.x=Ax-Au;Az.y=Math.max(Aw.top,(Ar-At)>>1);break;case m.RIGHT_BOTTOM:Az.x=Ax-Au;Az.y=Math.max(Aw.top,Ar-At-Aw.bottom);break;default:}};for(Aq=0;Aq<Av.length;Aq++){Ay(Av[Aq]);}this.updateDropZonePosition();},updateDropZonePosition:function(){var Aq=this.getDockedPosition(),Ar=this.dropZoneNode.style;Ar.left=Aq.x+AC;Ar.top=Aq.y+AC;},updateDropZoneNode:function(Aq){this._super(Aq);this.dockPos=this.getSplitterDockPos();this.updateSplitter();},onmouseover:function(Aq){var As=this.domLegend,Aw=Aq.getTarget(),At=Aw.getAttribute("type"),Av=this.widget,Ar;if(this.isDragging){return ;}var Au=S.copy(this.styles);Au.opacity+=0.4;AU.applyStyles2DomNode(this.domNode,Au);if(AG.contains(As,Aw,true)){Aj.addClass(As,"active");}if(At===B.LGD_COLORBOX){Aw=Aw.parentNode;At=Aw.getAttribute("type");}if(At===B.LGD_COLORBOX_CTN){Ar=Aw.firstChild.identity;if(!Ar||!Ar.comb){return ;}Aj.toggleClass(Aw,"hover-colorsquare",true);return ;}if(Av.formattingMode){switch(At){case B.LGD_TITLE:case B.LGD_TEXT:Aj.toggleClass(As,"hover-txt",true);break;default:Aj.toggleClass(this.domNode,"gm-legend-hover",true);break;}}},onmouseout:function(Ar){var At=this.domLegend,Aq=Ar.e.toElement||Ar.e.relatedTarget,Aw=Ar.getTarget(),Au=Aw.getAttribute("type"),Av=this.widget,As;AU.applyStyles2DomNode(this.domNode,this.styles);if(!AG.contains(At,Aq,true)){Aj.removeClass(At,"active");}if(Au===B.LGD_COLORBOX){Aw=Aw.parentNode;Au=Aw.getAttribute("type");}if(Au===B.LGD_COLORBOX_CTN){As=Aw.firstChild.identity;if(!As||!As.comb){return ;}Aj.toggleClass(Aw,"hover-colorsquare",false);return ;}if(Av.formattingMode||Av.isOnFormattingMode){switch(Au){case B.LGD_COLORBOX_CTN:case B.LGD_COLORBOX:break;case B.LGD_TITLE:case B.LGD_TEXT:Aj.toggleClass(At,"hover-txt",false);break;default:Aj.toggleClass(this.domNode,"gm-legend-hover",false);break;}}},handleSingleTap:function(Aq){Aj.toggleClass(this.domLegend,"active",true);if(this.isMinimal||Aq===this.triBtn){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});Aj.toggleClass(this.domLegend,"active",!this.isMinimal);}},onclick:function(Aq){var At=Aq.getTarget(),Ar=At.getAttribute("type"),As=this.widget;if(At===this.triBtn){if(!this.autoCollapse){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});}}else{if(At===this.closeBtn){this.raiseEvent({name:"gm-legend-clicked",action:"close",mousePos:Aq.e});}else{if(Ar===B.LGD_COLORBOX){At=At.parentNode;Ar=At.getAttribute("type");}if(As.formattingMode||As.isOnFormattingMode){if(Ar===B.LGD_COLORBOX_CTN){this.selectColorBox(At,true);}else{if(Ar===B.LGD_TEXT||Ar===B.LGD_TITLE){this.selectText();}else{this.selectLegendBody();}}}else{this.clearSelectedColorBox();}}}AG.stopPropogation(null,Aq.e);},attachClearEvent:function(){if(this.clearSelectTargetfn){return ;}var Ar=this,Aq=this.domLegend;this.clearSelectTargetfn=function(Av){var Au=Av.target,As=Ar.widget.toolEditor,At;if(!AG.contains(Aq,Au,true,Aq)){if(As){At=As.domNode;if(!AG.contains(At,Au,true,At)){Ar.clearSelectedTargets();}}else{Ar.clearSelectedTargets();}}};AG.attachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);},clearSelectedColorBox:function(){var Aq=this.selectedColorBox;if(Aq){Aj.toggleClass(Aq,"select",false);Aj.toggleClass(Aq,"selectfmt",false);this.selectedColorBox=undefined;}},clearSelectedText:function(){Aj.removeClass(this.domNode,"select-txt");},clearSelectedLegendBody:function(){Aj.removeClass(this.domNode,"gm-legend-select");},clearSelectedTargets:function(){this.clearSelectedColorBox();this.clearSelectedText();this.clearSelectedLegendBody();if(this.clearSelectTargetfn){AG.detachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);delete this.clearSelectTargetfn;}},selectColorBox:function(As,Ar){var Aq=As.firstChild.identity;if(!Aq||!Aq.comb){return ;}this.clearSelectedText();this.clearSelectedLegendBody();if(this.selectedColorBox!==As){this.clearSelectedColorBox();this.selectedColorBox=As;if(Ar){Aj.toggleClass(As,"selectfmt",true);}else{Aj.toggleClass(As,"select",true);}this.attachClearEvent();}},selectText:function(){this.clearSelectedColorBox();this.clearSelectedLegendBody();Aj.addClass(this.domNode,"select-txt");this.attachClearEvent();},selectLegendBody:function(){this.clearSelectedColorBox();this.clearSelectedText();Aj.addClass(this.domNode,"gm-legend-select");this.attachClearEvent();},adjustColorPickerPos:function(Aq){var At=AG.position(Aq),Ar=0,As={};if(this.currDockedPositionIdx<3){As.x=At.x+At.w+Ar;As.alignLeft=true;}else{As.x=At.x-Ar;As.alignLeft=false;}As.y=At.y+At.h+Ar;return As;},getSplitterInfo:function(Av){if(!Av){return{};}var Ar=this.dockPos,Au={},At=this.width,Aq=AQ,As=Math.floor(this.GMW/3);Au.dockPosition=Ar;if(Ar===AS.LEFT){Au.min=Math.min(At-As,0);Au.max=Math.max(At-Aq,0);}else{if(Ar===AS.RIGHT){Au.min=Aq;Au.max=As;}}Au.min+=AW;Au.max+=AW;return Au;},splitterMoved:function(Aq,Ar){if(Aq===0){return ;}if(Ar.dockPosition===AS.LEFT){Aq=-Aq;}this.raiseEvent({name:"gm-legend-resized",position:Aq});this.updateSplitter();if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},updateSplitter:function(){AY(this.splitter,this.dockPos,this.width,this.height);this.resizeRect.style.height=this.height-2+AC;},getLegendDockPosIdx:function(Aq){return P.find(x,"pos",Aq);},getLegendDockPosByIdx:function(Aq){return(Aq>=0&&Aq<x.length)?x[Aq].pos:q.RIGHT_MIDDLE;},fillTextInDiv:function(Av,At,Aq,Au,As,Ar){AE.call(this,Av,At,Aq,Au,As,Ar);}});Ak.GMLegend.IMAGE_SIZE_FIXED=0;Ak.GMLegend.applyHTML5Props=function(As){var At=parseInt(As.fontSize,10)||8,Ar;if(As.fontSize.indexOf("px")>=0){At=Math.floor(At*c+0.5);}Ar=Math.floor(At/c*D+0.5);F=Math.max(At,8)+9;AZ=Math.floor(At/c+0.5);i=Math.max(Ar,15);AP=Ak.GMLegend.IMAGE_SIZE_FIXED||(Math.max(Ar,20)+2);y=Math.max(Ar,14)+2;Am=parseInt(As.borderWidth,10)||1;var Aq=parseInt(As.tbHeight,10);o=isNaN(Aq)?I:Aq;};Ak.GMLegend.getLegendSize4MinMode=function(Ar,As,Aw){var Av,At,Au=N(As,Aw),Aq=o+2*Am;if(Ar){At=Ar.elements||M(Ar);Av=At.length;Aq+=AP*Av;Aq+=2*A;}Aq=Math.min(Aq,Au);return{width:AD+5+7+2*Am,height:Aq};};Ak.GMLegend.getLegendSize=function(A6,A4,A0,A7,Au,Aw,Ar){var Az,Ax,Av,A2,A1=N(A7,Ar),A3=0,A5=0,At={},Ay,Aq,As;if(!A6||!A6.length||A6.length<1){return{};}if(A4!==undefined){if(!Aw){Aw=Math.floor(Ai(A6,Au)*A4);}A2=Math.min(Aw,Math.floor(A0/3));A2=Math.max(A2,50);return l(A6,A2,A7,Au,Ar);}A2=Math.min(Math.floor(0.2*A0),300);for(Az=0;Az<A6.length;Az++){Aq=A6[Az];if(Aq.dataType===Ae.COLOR_BY){Ay=Ah(Aq.dataObj,Au);if(Ay>A3){A3=Ay;}Aq.cutBy=0;}else{if(Aq.dataType===Ae.SIZE_BY){Ay=AV(Aq.dataObj,Au);if(Ay>A5){A5=Ay;}}}}Ax=Math.max(A3,A5)+2*Am;At.width=Math.min(Ax,A2);At.scale=At.width/Ax;As=h(A6,At.width,Au);Av=As.height;At.autoCollapse=false;At.minHeight=As.minHeight;At.height=Math.min(Av,A1);if(Av>A1){J(A6,A1);}return At;};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.SimpleThresholdEditor","mstrmojo.threshold.AdvancedThresholdEditor","mstrmojo.mstr.EnumDSSXMLObjectTypes");var $HASH=mstrmojo.hash,SIMPLE_THRESHOLD_ID="mstrmojo-simple-threshold-editor",ADVANCED_THRESHOLD_ID="mstrmojo-advanced-threshold-editor",EDITOR_TYPES=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES,ENUM_OBJECT_TYPE=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.threshold.ThresholdController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdController",metricId:undefined,data:undefined,model:undefined,targets:undefined,editor:undefined,messageId:undefined,datasets:undefined,dataService:undefined,onSubmitActions:mstrmojo.emptyFn(),onSaveThresholds:mstrmojo.emptyFn(),onLoadThresholds:mstrmojo.emptyFn(),supportsFeature:function supportsFeature(featureId){return true;},init:function init(props){this._super(props);if(!window.numeral){var numeral=mstrmojo.loadFileSync(mstrmojo.getJsRoot()+"libraries/numeral.js.2.0.6/numeral.min.js");function evalInContext(){eval(numeral);}try{evalInContext.call(window);}catch(e){}}this.model=new mstrmojo.threshold.ThresholdModel({controller:this});},openEditor:function openEditor(setIdx){var data=this.data;if(!data){throw new Error("Visualization data not provided.");}var metricId=this.metricId,objectType=this.objectType,model=this.model,messageId=this.messageId,editor;model.set("data",$HASH.clone(data));model.set("setIdx",setIdx);model.metricId=metricId;model.objectType=objectType;var isAdvanced=model.isAdvanced(metricId),forceOpenEditorType=model.editorMode,forceOpenSimpleEditor=forceOpenEditorType===EDITOR_TYPES.SIMPLE_EDITOR,referenceMetricId=model.basedOnId||model.metricId;if(objectType===ENUM_OBJECT_TYPE.Metric&&!isAdvanced&&!model.isMetricAvailable(referenceMetricId)){model.thresholdMetricNotAvailable(model.basedOnName);return ;}if(forceOpenEditorType===EDITOR_TYPES.ADVANCED_EDITOR||(!forceOpenSimpleEditor&&isAdvanced)){editor=mstrmojo.all[ADVANCED_THRESHOLD_ID]||new mstrmojo.threshold.AdvancedThresholdEditor({id:ADVANCED_THRESHOLD_ID,onUpdateBrowseElementsParams:function onUpdateBrowseElementsParams(params){var datasetId,datasets=this.controller.datasets,findAttrFn=function(attribute){return attribute.did===params.attributeID;};for(datasetId in datasets){if(datasets[datasetId].att.filter(findAttrFn).length>0){params.datasetID=datasetId;break;}}params.messageID=messageId;params.templateNodeKey=data.k;}});}else{if(isAdvanced){model.clearData();}editor=mstrmojo.all[SIMPLE_THRESHOLD_ID]||new mstrmojo.threshold.SimpleThresholdEditor({id:SIMPLE_THRESHOLD_ID,controller:this});}this.editor=editor;editor.set("model",model);editor.set("controller",this);editor.set("metricId",metricId);editor.set("objectType",objectType);editor.set("title",this.title);editor.set("targets",this.targets);editor.set("setIdx",setIdx);editor.open();this.addDisposable([model,editor]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Button","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.models.datasets.DataInterface","mstrmojo.models.template.DataInterface","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.VIComponentMap","mstrmojo.threshold.ThresholdController","mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.mstr.EnumDSSConsolidationType","mstrmojo.VisUtility");var f=mstrmojo,O=f.array,U=f.hash,Ab=mstrmojo.chart.model.enums.EnumDSSObjectType,i=f.vi.ui.DatasetUnitMenuUtils,Z=mstrmojo.models.datasets.DataInterface,t=mstrmojo.models.template.DataInterface,AW=f.vi.models.VIComponentMap,j=mstrmojo.vi.viz.EnumDSSDropZones,J=mstrmojo.ME.MetricDataService,e="\u001E",AF=mstrmojo.VisUtility,I=1,AU=2,G=3,Ad=4,Q=5,AP=6,m=7,P=8,AE=9,Ag=10,A=11,AL=12,D="00000000000000000000000000000000",AS=-1,Ao="-1",g=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,AO=mstrmojo.chart.model.enums.EnumDSSAxisName,An=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut,S=mstrmojo.mstr.EnumDSSXMLBaseFormType,X=mstrmojo.mstr.EnumDSSXMLObjectTypes,Am=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,H=mstrmojo.mstr.EnumDSSConsolidationType,AN={ABSOLUTE:1,NESTED:2,SORT_UNDER:3};function Y(Au,Av){var Aw=this.getGSI(Av);return Aw.cols.concat(Aw.rows).filter(function(Ax){return Ax.t===Au;});}function AI(Av,Ax,Aw,Au){return{act:"updateTemplate",keyContext:Av,partialRetrieval:{nodes:Aw?null:[Av].concat(Au||[])},actions:Ax};}function Ac(Ay,Av,Az,Aw){var A3=this,A0=[],A1=[],A4={};if(Av.useDropzone){Ay.useDropzone=true;A4.dropzoneId=Av.zone.id;if(Av.item.ax!==undefined){A4.ax=Av.item.ax;}}A4.position=Av.idx+1+(Az.offset||0);if(Az.replaceSourceId){Ay.replaceSourceId=Az.replaceSourceId;}if(Az.addToTooltip){A1.push({dropzoneId:AE,position:A3.gmZones.getTooltipDropzoneIdx(Av.item)+1});}Ay.partialRetrieval={nodes:[Ay.nodeKey]};if(Aw){Ay.partialRetrieval.nodes=Ay.partialRetrieval.nodes.concat(Aw);}A1.push(A4);Ay.dropzones=A1;A0.push(Ay);var A2="$GUID_115",Au=[],Ax=this.checkAndAddThresholdAction(Av.zone.id,{did:A2,t:4},Au);if(Ax){Ay.newObjectIds=[A2];A0.push(this.getUpdateTemplateAction(Au));}return A0;}function At(Ax){var Au=this.getHost().model.data.datasetId,Aw=O.ensureArray(Ax),Av=O.hash(Aw);if(!Au){U.forEach(this.docModel.datasets,function(A0,A1){var Ay=(A0.att||[]).concat(A0.mx||[]),Az=Ay.some(function(A2){return Av[A2.did];});if(Az){Au=A1;return false;}});}return Au;}function Ah(Au,Ay,Av){var A3=this,A9=this.docModel,A1=Au.item,A7=i.getUnitFromDataset(A3.docModel.datasets,A1.did,A1.t)||A1,BA=this.getHost(),A6=A3.docModel.getDataService(),Az=Ay==="edit",A5=BA.getChartStyle&&BA.getChartStyle()==="NewGraphMatrixVisualizationStyle",Aw,Ax={dsid:Az?A9.findDatasetIdFromUnit(A7.did):At.call(A3,A7.did),alias:A7.alias||A7.n},A8=null,A2=BA.zonesModel,A0=A2.getHostKey(Au,true),A4=BA.k;if(A7.t===X.Metric){Ax.nodeKey=A0;Ax.retrieveKey=A4;if(Az){Aw={metricId:A7.did,metric:A7,action:{cmd:Ay,n:A7.n,alias:A1.n}};Ax.did=A7.did;A8=A6.getEditDerivedMetricSubmitFunc(Ax);}else{Aw={metricId:"",action:{cmd:Ay,refOi:{did:A7.did,n:A7.n}}};Ax.idx=Au.idx;Ax.host=BA;Ax.zoneid=Au.zone.id;if(A5){Ax.extraZone={id:AE,idx:A3.gmZones.getTooltipDropzoneIdx(Au.item)};}if(Av){Ax.replace={did:A7.did,t:A7.t};}if(Au.useDropzone){A8=A6.getAddNewDerivedMetricToDropzoneSubmitFunc(Ax);}else{A8=A6.getAddNewDerivedMetricToXtabSubmitFunc(Ax);}}if(A3.docModel.isFromSolrCube(A7.did)||A3.docModel.isFromMDXCube(A7.did)){Aw.disableAFB=true;}A3.docModel.controller.openDME(BA,Aw,A8);}}mstrmojo.vi.models._DropZoneCommon=mstrmojo.provide("mstrmojo.vi.models._DropZoneCommon",{_mixinName:"mstrmojo.vi.models._DropZoneCommon",isMetric:function l(Au){return Au&&Au.t===X.Metric&&Au.id!==D;},isAttribute:function AQ(Au){return Au&&Au.t===X.Attribute;},isRecursiveAttribute:function d(Au){return Au&&Au.t===X.Attribute&&Au.st===Am.AttributeRecursive;},isNewDerivedElement:function AX(Au){return Au.t===X.Consolidation&&Au.st===Am.ConsolidationManaged;},isNewDerivedRecursiveElement:function AX(Au){return Au.t===X.Consolidation&&Au.st===Am.ConsolidationManaged&&Au.ndetype===H.DssRecursiveDerivedElement;},isConsolidation:function Al(Au){return Au.t===X.Consolidation&&Au.st===Am.Consolidation;},isCustomGroup:function C(Au){return Au.t===X.Filter;},isAttrCategory:function a(Au){return Au&&(Au.t===X.Attribute||Au.t===X.Filter||Au.t===X.Consolidation||Au.t===X.Dimension);},isMetricName:function Af(Au){return Au&&(Au.id===D||Au.did===D);},differInType:function W(Av,Au){return(this.isMetric(Av)&&this.isAttrCategory(Au))||(this.isAttrCategory(Av)&&this.isMetric(Au));},isDynamicLink:function K(Av){if(this.isAttribute(Av)){var Au=Av.fs||Z.getFormsByAttrId(Av.did,this.docModel.datasets);return Au.length===2&&Au[1].bftp===S.DssXmlBaseFormHTMLTag&&Au[1].fnm==="DYNAMICLINK";}return false;},hasOldDEOverDatasets:function(Ax){var Aw=this.docModel.datasets,Av=false,Au;U.forEach(Aw,function(Ay){Au=O.find((Ay.att||[]),"did",Ax);if(Au!==-1&&Ay.att[Au].de){Av=true;return false;}});return Av;},getZoneModelByZoneId:function(Au){var Av=this.dropZones,Aw;if((!Av||!Av.length)&&typeof this.getDropZones==="function"){Av=(this.getDropZones()||{}).zones;}O.forEach(Av,function(Ax){if(Ax.id===Au){Aw=Ax;return false;}});return Aw;},hGetItemOccurrence:function(Ay,A0){A0=A0||[];if(A0.length===0){A0=[I,AU,G,Ad,m,Q,P,AE,AP,Ag];}var Aw,Au,Av,Az=A0.length,Ax=[];for(Aw=0;Aw<Az;Aw++){Av=this.getZoneModelByZoneId(A0[Aw]);if(!Av){continue;}Au=this.getUnitIndexInZone(Av,Ay);if(Au!==-1){Ax.push({zoneId:A0[Aw],itemIndex:Au});}}return Ax;},removeColorByItemFromBreakByIfExists:function AM(Ax,Az){var Ay,Aw,Au,Av;Ay=this.hGetItemOccurrence(Ax,[I,AU,G,Ad,Q,P,AP]);if((Ay.length===1)&&(Ay[0].zoneId===Q||Ay[0].zoneId===AP)){Aw=Ay[0];Au=this.getZoneModelByZoneId(Aw.zoneId);Av=Au.items[Aw.itemIndex];if(Av.hidden){Array.prototype.push.apply(Az,this.getRemoveDropZoneUnitActions(Au,Av));}}},updateBreakByAndSliceUnits:function p(){var Au=this,Aw=[I,AU,G,Ad,m,P,A,AL],Av=this.getZoneModelByZoneId(AP)||this.getZoneModelByZoneId(Q),Ax;Av.items.forEach(function(Ay){if(Au.isAttrCategory(Ay)||Au.isMetricName(Ay)){Ax=Au.hGetItemOccurrence(Ay,Aw);if((Ax.length===1)&&(Ax[0].zoneId===m)){Ay.hidden=true;}}});},getAxisSummary:function AY(){var Au={};Au[G]=this.getItemCountInZone(G);Au[Ad]=this.getItemCountInZone(Ad);Au[Ag]=this.getItemCountInZone(Ag);return Au;},getItemCountInZone:function(Au){var Av=this.getZoneModelByZoneId(Au);if(Av){return Av.items.length;}return 0;},isOnlyMetricZone:function k(Au){var Aw,Ay,Ax,Av=this.getZoneModelByZoneId(Au);if(!Av){return false;}Ax=Av.items;Ay=Ax.length;if(Ay===0){return false;}for(Aw=0;Aw<Ay;Aw++){if(!this.isMetric(Ax[Aw])){return false;}}return true;},isMetricZone:function AH(Au){var Aw,Ay,Ax,Av=this.getZoneModelByZoneId(Au);if(!Av){return false;}Ax=Av.items;Ay=Ax.length;if(Ay===0){return false;}for(Aw=0;Aw<Ay;Aw++){if(!this.isMetric(Ax[Aw])){if(this.isMetricName(Ax[Aw])){continue;}else{return false;}}}return true;},getMetricCntInZone:function(Au){var Aw=this,Av=this.getZoneModelByZoneId(Au),Ay=Av.items,Ax=0;O.forEach(Ay,function(Az){if(Aw.isMetric(Az)){Ax++;}});return Ax;},isAttrCategoryZone:function(Au){var Aw,Ay,Ax,Av=this.getZoneModelByZoneId(Au);if(!Av){return false;}Ax=Av.items;Ay=Ax.length;if(Ay===0){return false;}for(Aw=0;Aw<Ay;Aw++){if(!this.isAttrCategory(Ax[Aw])&&!this.isMetricName(Ax[Aw])){return false;}}return true;},getZoneSummary:function AV(Au){var Ax=this,Av=this.getZoneModelByZoneId(Au),Az=Av?Av.items:[],Ay=0,A0=0,Aw=false;O.forEach(Az,function(A1){if(Ax.isMetric(A1)){Ay++;}else{if(Ax.isAttrCategory(A1)){A0++;}else{if(Ax.isMetricName(A1)){Aw=true;}}}});return{metricCount:Ay,attributeCount:A0,hasMetricName:Aw};},isTemplateContainAttCategoryItem:function Aa(){var Ax=this,Aw=Ax.getHost(),Ay=Aw.model.data.gsi,Av=(Ay.rows||[]).concat(Ay.cols||[]),Au=false;if(Av&&Av.length){O.forEach(Av,function(Az){if(Ax.isAttrCategory(Az)){Au=true;return false;}});}return Au;},showNumberFormat:function(Au){return mstrmojo.all[this.hostId].model.showNumberFormat(Au);},renameItem:function(Av,Au){var Aw=this.id;i.renameItem(Av,Au,function(A2){var A4=mstrmojo.all[Aw],Ax=Au.setIdx,A7=A4.getHost(),A8=A7.hasArrayGSI,A1=t.getGSI(A4.getHostModel().gsi,Math.max(Ax,0)||0),Ay=A8&&Ax>-1?A1.k:A7.k,A3=A2.allowTrimming?A2.text.trim():A2.text,A9=Au.t===X.Metric,A0=A9?A1.mx:A1.rows.concat(A1.cols),A6=function(){var BC=[],BB=A4.docModel.getPanel(),BD,BF;O.forEach(BB.children,function(BG){if((BG.isAMSelector instanceof Function)&&BG.isAMSelector()){BD=U.walk("defn.tks",BG);BD=BD&&BD.split(e);BF=BD&&BD[0];if(BF===A7.k){BC.push(BG.k);}}});var BE=[],BA={act:"renameUnit",id:Au.did,type:Au.t,name:A3,isDynamicAlias:false};if(A8&&Ax===-1){t.forEachGSI(A7.gridData.gsi,function(BG,BH){BE.push(AI(BH,[BA],false,BC));});}else{BE.push(AI(Ay,[BA],false,BC));}A4.submitDropZoneUpdates(BE);},Az=function(){A2.set("text",Au.n);},A5=A0.some(function(BA){return BA.did!==Au.did&&(A9||BA.t===Au.t)&&BA.n===A3;});if(A5){mstrmojo.warn(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",A3),{confirmBtn:{fn:A6},cancelBtn:{fn:Az}});}else{A6();}},{allowEmptyText:true,cssClass:Av.className});},getPageByUnit:function Ap(){var Av=this.getHost(),Au=Av.builder.getLayoutVIMap(Av.defn._lkz).getComponent(AW.TYPES.PAGEBY_PANEL);return Au&&Au.unit;},shouldShowDisplayFormsMenu:function F(Ax){if(!mstrmojo.resolveFeature("set-attributeform-display")||!this.isAttribute(Ax)&&!this.isNewDerivedRecursiveElement(Ax)||this.isDynamicLink(Ax)){return false;}var Au=Z.getFormsByAttrId(Ax.attId||Ax.did,this.docModel.datasets),Ay=this.getHost().model.data,Av=Ay&&Ay.gts,Aw=!!Av&&Au.length>1;if(Av&&Au.length===1){var Az=false;O.forEach((Av.row||[]).concat(Av.col||[]),function(A0){if(A0.id===Ax.did&&O.find(A0.fs||[],"id",Au[0].fid)>-1){Az=true;return false;}});if(!Az){Aw=true;}}return Aw;},getDisplayFormsMenu:function(Av){var Au=this;return i.getDisplayFormsMenu(Av,Au.getHost(),Au.docModel.datasets,function(Aw){Au.submitDropZoneUpdates(Aw);});},editDerivedMetric:function(Au){Ah.call(this,Au,"edit");},newDerivedMetric:function(Av){var Au=mstrmojo.all[this.hostId].zonesModel.allowInsertNewMetric(Av.zone);if(Av.zone.id===m){Au=false;}Ah.call(this,Av,"editNew",!Au);},newDerivedAttribute:function h(A0,Aw){var A1=A0.item,Az=i.getUnitFromDataset(this.docModel.datasets,A1.did,A1.t)||A1,Ay=this.getHost(),Av=Ay.getChartStyle&&Ay.getChartStyle()==="NewGraphMatrixVisualizationStyle",Ax=this,Au={forceRefresh:true,alias:"New Attribute",precreate:function(A5){var A4=Ax.getGSI(A0),A3=Ay.k;if(Ay.hasArrayGSI){A3=A4.k;}if(Ax.getAddItemActions){var A2=Ax.getAddItemActions(A0.zone,[{did:"$GUID_1",t:12}]);A5.newObjectIds=["$GUID_1"];if(Aw){A2=Ax.getRemoveDropZoneUnitActions(A0.zone,Az).concat(A2);}A5=[A5,{act:"updateTemplate",keyContext:A3,actions:A2}];}else{A5=U.copy({act:"addDAToTemplate",nodeKey:A3,treeType:Ay.defn.tt},A5);if(A0.useDropzone){A5.useDropzone=true;A5.dropzones=[{dropzoneId:A0.zone.id,position:0}];if(A0.item.ax!==undefined){A5.dropzones[0].ax=A0.item.ax;}if(Aw){A5.dropzones[0].replaceSourceId=Az.did;}}else{A5.axis=A0.axis;}if(Av){A5.dropzones.push({dropzoneId:AE,position:Ax.getTooltipDropzoneIdx(A0.item)+1});}}return A5;}};this.docModel.controller.openDAE(this,Au,mstrmojo.emptyFn,Az);},newDynamicLinkAttr:function AG(Az,Av){var A0=Az.item,Ay=i.getUnitFromDataset(this.docModel.datasets,A0.did,A0.t)||A0,Ax=this.getHost(),Aw=this,Au={forceRefresh:true,alias:"New Link",precreate:function(A4){var A3=Aw.getGSI(Az),A2=Ax.k;if(Ax.hasArrayGSI){A2=A3.k;}if(Aw.getAddItemActions){var A1=Aw.getAddItemActions(Az.zone,[{did:"$GUID_1",t:12}]);A4.newObjectIds=["$GUID_1"];if(Av){A1=Aw.getRemoveDropZoneUnitActions(Az.zone,Ay).concat(A1);}A4=[A4,{act:"updateTemplate",keyContext:A2,actions:A1}];}else{A4=U.copy({act:"addDAToTemplate",nodeKey:A2,treeType:Ax.defn.tt},A4);if(Az.useDropzone){A4.useDropzone=true;A4.dropzoneId=Az.zone.id;if(Az.item.ax!==undefined){A4.ax=Az.item.ax;}if(Av){A4.replaceSourceId=Ay.did;}}else{A4.axis=Az.axis;A4.pos=Az.idx+2;}}return A4;}};this.docModel.controller.openDynamicLinkEditor(this,Au,mstrmojo.emptyFn,Ay);},editDerivedAttribute:function(Ax){var Aw=this.getHost(),A0=Aw.gridData&&Aw.gridData.gsi,Az=Ax.item,Av=i.getUnitFromDataset(this.docModel.datasets,Az.did,Az.t)||Az,Ay=this.docModel.findDatasetIdFromUnit(Av.did),Au={dsid:Ay,did:Av.did,n:Av.n,alias:Az.n,forms:Av.fs,preupdate:function(A3){var A1=A3.name,A2=[{act:"renameUnit",id:Av.did,type:12,name:A1}];A3.name=Av.n;A3=[A3,AI(Aw.getTemplateKey(),A2,true)];if(Aw.hasArrayGSI&&A0){t.forEachGSI(A0,function(A5,A6,A4){if(A4===0){return true;}A3.push(AI(A6,A2,true));});}return A3;}};if(this.isDynamicLink(Az)){this.docModel.controller.openDynamicLinkEditor(this,Au,mstrmojo.emptyFn);}else{this.docModel.controller.openDAE(this,Au,mstrmojo.emptyFn);}},getTemplateAttributes:function o(Au){return Y.call(this,12,Au);},getTemplateHierarchies:function b(Au){return Y.call(this,14,Au);},getTemplateDEs:function Aj(Au){var Av=this.getGSI(Au);return Av.cols.concat(Av.rows).filter(function(Aw){return Aw.st===Am.ConsolidationManaged;});},getUnitInfoInTemplate:function w(Av){var Aw={},Au=this.getHost().model.data.gts;[{axis:I,name:"row"},{axis:AU,name:"col"}].forEach(function(Ax){O.forEach(Au[Ax.name],function(Az,Ay){if(Az.id===Av){Aw.axis=Ax.axis;Aw.axisName=Ax.name;Aw.tplIdx=Ay;Aw.unit=Az;return false;}});});return Aw;},sortGrid:function AB(A7,A2,Au){var A8=this.getHost(),Aw=Au&&Au.breakByType,Az=Au&&Au.breakByAttribute,A1=A7.t,A5=A7.did,Av=null,A4,A9=I,Ay=null,A0=[];if(A1===Ab.DssTypeMetric){var A3=U.walk("model.data.gts.col",A8)||[];A9=O.find(A3,"otp",-1)>-1?I:AU;Ay=["","","",A9];if(Aw){A0.push(Aw);if(Aw===AN.SORT_UNDER){A0=A0.concat([Az.did,Az.t]);}}}else{Av=this.getUnitInfoInTemplate(A7.did);A9=Av.axis;if(A8.zonesModel.isDynamicLink(A7)){A4="45C11FA478E745FEA08D781CEA190FE5";}else{A4=Av.unit.fid||(Av.unit.fs&&Av.unit.fs[0].id);}Ay=[A4,"21","",A9];}var Ax=A8.model.data.gts[(A9===I?"row":"col")+"SubPos"],A6=(A8.hasArrayGSI&&A7.setIdx>-1)?this.getSetData(A7.setIdx).k:undefined;A8.controller.onSort(A8,A8.model.getSortGridAction(Ax,[A1,A5].concat(Ay).join("!"),A9,A2,{columnSetKey:A6,metricSortKey:A0.join("!")}));},addSortMenu:function c(A7,A0,BP,Au){var A5=this,Ax=this.getHost(),BE=A7.item,BA=A7.axis,BT=Ax.model,BR=BT.data,Av=BR.gts,A8=this.getGSI(A7),Az=A8.tma,BJ=this.isMetric(BE),BD=BJ?Az===I:BA===I,BI=BD?A8.rows:A8.cols,BM=U.copy(BE),A6=BE.did,BN=O.some(A8.cols.concat(A8.rows),function(BU){return BT.isRecursiveAttribute(BU.did);});if(BE.t===Ab.DssTypeFilter){return ;}if(BE.t===Ab.DssTypeDimension){O.forEach((Av.row||[]).concat(Av.col||[]),function(BU){if(BU.hid===BM.did){BM.did=BU.id;BM.t=BU.otp;return false;}});}var A9=true,BK;if(BJ){BK=!!O.filterOne(BI,function(BU){return BU.did!==Ao;});if(BK){A9=false;}}if(A9){var BS=BD?[]:A8.rows,BG=((BD&&BJ)||(!BD&&!BJ)?AU:I)-1,BO=A8.sorts&&A8.sorts.length>BG?A8.sorts[BG]:[],BF=false,Ay=false,BB=false,BH=false,BC=-1,BL=O.filterOne(BO||[],function(BW,BU){var BV=BW.key.split("!");if(BV.length>1&&BV[1]===A6){BC=BU;return true;}return false;}),A1,Aw,A2,A3;if(BL){switch(BL.isAsc){case true:BF=true;break;case false:Ay=true;break;default:BB=true;A3=AN.NESTED;}A1=BL.metricSortKey&&BL.metricSortKey.split("!");if(A1&&A1.length){A2=parseInt(A1[0],10);Aw=A1[1];BH=(A2===AN.SORT_UNDER);}}else{A3=AN.NESTED;}if(Ax.isVIXtab&&BJ&&!BN){A0.addMenuItem({ttp:mstrmojo.desc(7974,"Sort Ascending")},"xt btn asc"+(BF?" on":""),function(){A5.sortGrid(BM,true,{breakByType:A2||A3,breakByAttribute:(Aw?{did:Aw,t:A1[2]}:undefined)});});A0.addMenuItem({ttp:mstrmojo.desc(7975,"Sort Descending")},"xt btn desc"+(Ay?" on":""),function(){A5.sortGrid(BM,false,{breakByType:A2||A3,breakByAttribute:(Aw?{did:Aw,t:A1[2]}:undefined)});});if(BL){A0.addMenuItem({ttp:mstrmojo.desc(11699,"Clear Sort")},"xt btn clr",function(){var BU=[];BO.splice(BC,1);BU[BG]=BO;Ax.controller.onClearSort(Ax,BU);});}A0.addSeparator();A0.addMenuItem(mstrmojo.desc(17812,"Sort Within (Default)"),"xt"+(A2===AN.NESTED?" on":""),function(){A5.sortGrid(BM,BF,{breakByType:AN.NESTED});},BM);A0.addMenuItem(mstrmojo.desc(17813,"Sort All Values"),"xt"+(A2===AN.ABSOLUTE?" on":""),function(){A5.sortGrid(BM,BF,{breakByType:AN.ABSOLUTE});},BM);if(BS.length>1){A0.addPopupMenuItem(mstrmojo.desc(17811,"Sort Within an Attribute"),BM.id,function(){var BU=new mstrmojo.ui.menus.MenuConfig({isHostedWithin:false,alignWithAnchor:true});O.forEach(BS,function(BX,BW,BV,BY){if(!BY){BU.addMenuItem(BX.n,"xt"+(BH&&Aw===BX.did?" on":""),function(){A5.sortGrid(BM,BF,{breakByType:AN.SORT_UNDER,breakByAttribute:BX});},BM);}else{BU.addMenuItem(BX.n,"xt sort non-int disabled"+(BH&&Aw===BX.did?" on":""),mstrmojo.emptyFn);}});return BU;});}if(Ax.hasSubtotal()){A0.addMenuItem(mstrmojo.desc(19388,"Sort with Subtotals"),"xt"+(BL&&!BB&&!A1?" on":""),function(){A5.sortGrid(BM,BF);});}}else{A0.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt"+(BF?" on":""),function(){A5.sortGrid(BM,true);});A0.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt"+(Ay?" on":""),function(){A5.sortGrid(BM,false);});}if(Ax.isVIXtab&&BT.isRecursiveAttribute(A6)&&mstrApp&&mstrApp.isAppStateDefault()&&!mstrApp.isDossier){A0.addMenuItem(mstrmojo.desc(15676,"Custom Sort..."),"xt"+(BB?" on":""),function(){if(Ax.customSort){Ax.customSort(O.filterOne(Av.col.concat(Av.row),function(BU){return BU.id===A6;}),BA);}});}}if(BP){if(!Ax.excludeData&&(Ax.supportAdvancedSort?Ax.supportAdvancedSort():!Ax.hasArrayGSI)){A0.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){if(BA===AS){BA=Az;}Ax.controller.onGetAdvSortData(Ax,BA,BM.t,Au);});}}else{var A4=A8.sorts.some(function(BU){return !!BU.length;}),BQ=mstrmojo.desc(11699,"Clear Sort");if(A4){A0.addMenuItem(BQ,"",function(){A5.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},convertToMetric:function x(A0){var Az=this.getHost(),Au=Az.model&&Az.model.data&&Az.model.data.datasetId,Aw=Az.k,Ay=Az.defn.tt,Ax=A0.item;if(!Au){mstrmojo.hash.forEach(this.docModel.datasets,function(A2,A3){if(mstrmojo.array.find((A2.att||[]),"did",Ax.did)!==-1){Au=A3;return false;}});}var Av=mstrmojo.mstr.EnumFunction,A1=Ac.call(this,{act:"addShortcutMetric",nodeKey:Aw,treeType:Ay,funcType:Ax.formType===2?Av.FunctionSum:Av.FunctionCount,units:[{id:Ax.did,type:Ax.t}],prs:[{n:"UseLookupForAttributes",v:"0"}],dsid:Au,replaceSourceId:Ax.did},A0);this.submitActionForDatasetUpdate(A1);},getAddMetricNameAction:function(A3,Az){if(!this.gmZones){return null;}var A1=this,Av=0,A0=false,Ay,Au=A1.gmZones.getZoneModelByZoneId((Az===I)?Ad:G),A2={n:"Metric Names",did:D,t:0},Ax=U.clone(A2),Aw=A1.gmZones.hGetItemOccurrence(Ax,[I,AU,G,Ad,m]);O.forEach(Au.items,function(A4){if(A1.isMetric(A4)){Av++;}});if(Aw.length===0&&Av<=1){A0=true;}if(A0){Ay={act:"updateTemplate",keyContext:A3.k,actions:A1.gmZones.getUpdateMetricNameUnitActions(A0,Az)};}return Ay;},getAggregateByMetricSubMenu:function(Aw){var A0=this,Az=Aw.item,A5=i.getUnitFromDataset(this.docModel.datasets,Az.did,Az.t)||Az,Av=this.id,A6=this.getHost(),Ay=A6.k,A2=Ay,Ax=A6.defn.tt,A1=this.submitActionForDatasetUpdate,A3=A6.getChartStyle&&A6.getChartStyle()==="NewGraphMatrixVisualizationStyle",Au=this.getSetIdx(Aw);if(A6.hasArrayGSI&&Au>-1){var A4=this.getGSI(Aw);Ay=A4.k;}return i.getAggregateByMenu(A5,function(BC,BA){var A9=A0.allowInsertNewMetric(Aw.zone),BE=[];if(Aw.zone.id===m){A9=false;}if(A9&&Aw.useDropzone&&A0.gmZones){var BD=A0.gmZones.getZoneModelByZoneId((Aw.zone.id===Ad)?I:AU);var BB=A0.getAddMetricNameAction(A6,BD.id);if(BB){BE.push(BB);}BB=A0.gmZones.getUpdateGroupInfoActionForNewMetric(Aw.zone.id,Aw.idx+1,Az.ax===0);if(BB){BE.push(BB);}}var A8=[];if(J.isFuncHasUseLookupForAttributeProp(BA)){A8=[{n:"UseLookupForAttributes",v:"0"}];}var A7=function(BF){BE=BE.concat(Ac.call(A0,{act:"addShortcutMetric",dsid:At.call(A0,A5.did),nodeKey:BF,treeType:Ax,funcType:BA,units:[{id:BC.did,type:BC.t}],prs:A8},Aw,{offset:A9?1:0,replaceSourceId:A9?null:A5.did,addToTooltip:A3},[A2]));};if(A6.hasArrayGSI&&Au===-1){A7(A6.gridData.sortIndex);}else{A7(Ay);}A1.call(mstrmojo.all[Av],BE);});},getCalculationEditorCfg:function Ae(Av){var A0=this,A6=this.getHost(),Az=this.submitActionForDatasetUpdate.bind(this),Ay=A6.k,A1=Ay,A3=this.getGSI(Av),Aw=A6.defn.tt,A5=A0.allowInsertNewMetric(Av.zone),Ax=[],A2=A6.getChartStyle&&A6.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(A6.hasArrayGSI){Ay=A3.k;}if(Av.zone.id===m){A5=false;}var Au=A3.mx;if(U.walk("model.data.trendref",A6)){var A4=U.walk("model.data.dz",A6);Au=AF.filterTrendlineMXByDZ(Au,A4);}return i.getCalculationMetricEditor(Au,Av.item,function(A8,A7,BC,A9){if(A5&&Av.useDropzone&&A0.gmZones){var BB=A0.gmZones.getZoneModelByZoneId((Av.zone.id===Ad)?I:AU);var BA=A0.getAddMetricNameAction(A6,BB.id);if(BA){Ax.push(BA);}BA=A0.gmZones.getUpdateGroupInfoActionForNewMetric(Av.zone.id,Av.idx+1,Av.item.ax===0);if(BA){Ax.push(BA);}}Az(Ax.concat(Ac.call(A0,{act:"addShortcutMetric",dsid:At.call(A0,Av.item.did),nodeKey:Ay,treeType:Aw,funcType:BC,funcType2:A9,units:[A8,A7]},Av,{offset:A5?1:0,replaceSourceId:A5?null:Av.item.did,addToTooltip:A2},[A1])));});},submitAddShortcutMetric:function(A0,BE){var BG=this,A8=BG.id,A5=this.getHost(),Av=A5.k,Ax=A5.defn.tt,BH=BG.submitActionForDatasetUpdate,BB=BG.allowInsertNewMetric(A0.zone),A2=[],A6=A5.getChartStyle&&A5.getChartStyle()==="NewGraphMatrixVisualizationStyle";if(A0.zone.id===m){BB=false;}if(BB&&A0.useDropzone&&BG.gmZones){var Az=BG.gmZones.getZoneModelByZoneId((A0.zone.id===Ad)?I:AU);var BA=BG.getAddMetricNameAction(A5,Az.id);if(BA){A2.push(BA);}BA=BG.gmZones.getUpdateGroupInfoActionForNewMetric(A0.zone.id,A0.idx+1,A0.item.ax===0);if(BA){A2.push(BA);}}var BC=BE.item,A3=BE.extraItem,BF=BE.funcType,Aw=BE.funcType2,A1=BE.breakBys,Au=BE.sortBys,Ay=BE.prs,A9=[{id:BC.did,type:BC.t}],A7,A4=A5.k;if(A3){A9.push(A3);}if(A5.hasArrayGSI){var BD=this.getGSI(A0);Av=BD.k;}A7={act:"addShortcutMetric",dsid:At.call(BG,BC.did),nodeKey:Av,treeType:Ax,funcType:BF,units:A9,breakBys:A1,sortBys:Au};if(Aw){A7.funcType2=Aw;}if(Ay){A7.prs=Ay;}if(J.isFuncHasUseLookupForAttributeProp(BF)){A7.prs=A7.prs||[];A7.prs.push({n:"UseLookupForAttributes",v:"0"});}A2=A2.concat(Ac.call(BG,A7,A0,{offset:BB?1:0,replaceSourceId:BB?null:BC.did,addToTooltip:A6},[A4]));BH.call(mstrmojo.all[A8],A2);},getDynamicBreakByAxisOptions:function q(Aw,Ay){var Ax=this,Az=this.getGSI(Ay),Au=[],Av=function Av(A0){return A0.some(function(A1){return Ax.isAttribute(A1)||Ax.isNewDerivedElement(A1)||Ax.isCustomGroup(A1)||Ax.isConsolidation(A1);});};if(Av(Az.rows)){Au.push({n:Aw?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:g.DssXmlAxisRowsBit,dmy:"@cols"});}if(Av(Az.cols)){Au.push({n:Aw?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:g.DssXmlAxisColumnsBit,dmy:"@rows"});}return Au;},getBreakByAxisOptions:function n(Av,Aw){var Au=[{n:mstrmojo.desc(4531,"Automatic"),axes_bitmap:AO.DssAxisDynamicShortcutRoot+An.DssDynamicShortcutAuto,dmy:"@auto"},{n:Av?mstrmojo.desc(13408,"By None"):mstrmojo.desc(2057,"None"),axes_bitmap:g.DssXmlAxisPagesBit,dmy:"@p"}];if(Av){Au.splice(1,0,{isSeparator:true});}return Au.concat(this.getDynamicBreakByAxisOptions(Av,Aw));},getBreakByAttributeOptions:function E(Av){var Au=this,Aw=[],Ay=Au.getTemplateAttributes(Av).concat(Au.getTemplateDEs(Av)),Ax=Au.getPageByUnit();Aw=Aw.concat(Ay);if(Ax&&Ax.srcid){if(O.find(Aw,"did",Ax.srcid)===-1){Aw.push({n:Ax.n,did:Ax.srcid,t:Ax.srct});}}return Aw;},getDynamicBreakByOptions:function AJ(Au,Aw){var Av=this,Ax=Av.getBreakByAttributeOptions(Aw);if(Au&&Ax.length){Ax.unshift({isSeparator:true});}return Av.getBreakByAxisOptions(Au,Aw).concat(Ax);},getDynamicLevelOptions:function u(Av){var Au=this,Ax=Au.getBreakByAxisOptions(true,Av),Aw=Au.getBreakByAttributeOptions(Av);Ax.some(function(Ay){if(Ay.axes_bitmap===g.DssXmlAxisPagesBit){Ay.n=mstrmojo.desc(3329,"Grand Total");return true;}});if(Aw.length){Aw.unshift({isSeparator:true});}return Ax.concat(Aw);},getShortcutMetricSubMenu:function(Ay){var Ax=this,Au=new mstrmojo.ui.menus.MenuConfig(),Az=Ay.item,Aw=i.getUnitFromDataset(this.docModel.datasets,Az.did,Az.t)||Az,Av=Ax.allowInsertNewMetric(Ay.zone);if(Aw.t===X.Metric){Ax.addRankShortcutMenu(Ay,Au);Ax.addPercentileShortcutMenu(Ay,Au);Ax.addPercentToTotalShortcutMenu(Ay,Au);Au.addSeparator();Ax.addPercentOfShortcutMenu(Ay,Au);Ax.addPercentChangeShortcutMenu(Ay,Au);Ax.addDifferenceShortcutMenu(Ay,Au);Au.addSeparator();Ax.addMovingTotalShortcutMenu(Ay,Au);Ax.addRunningTotalShortcutMenu(Ay,Au);Ax.addPercentRunningTotalShortcutMenu(Ay,Au);}Au.addSeparator();Au.addMenuItem(mstrmojo.desc(11491,"More Functions..."),"",function(){Ah.call(Ax,Ay,"add",!Av);},Aw);return Au;},hasReplaceCandidates:function(Au){var Av=this.getReplaceCandidates(Au.zone,Au.item);return Av&&Av.length>0;},getReplaceSubMenu:function(Av,Ax){var A1,A2=Av.item,Ay=Av.zone,Aw=this.getReplaceCandidates(Ay,A2),Az=this;A1=Ax?[Ax]:[];A1.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Aw,listHooks:{select:function A0(A4,A7){var A6=Az.getHost(),A3=Av.cell,A5;if(A6.hasArrayGSI){A5=Az.activeTemplateSet;Az.activeTemplateSet=A3?A3.setIdx:A2.setIdx;}Az.unitsDropped(Ay,{src:{data:{item:A7,items:[A7],dsid:A7.dsId}},getCtxtDragData:function(){var A8=this.src;return(A8&&A8.data)||{};}},{allowedItems:[A7],idx:Az.getUnitIndexInZone(Ay,A2),edge:mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION.ON,removeReplaced:true});if(A6.hasArrayGSI){Az.activeTemplateSet=A5;}if(this.parent&&this.parent.parent&&this.parent.parent.closeAllMenus){this.parent.parent.closeAllMenus();}}}}]});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:A1,onOpen:function Au(){this.scrollableContainer.updateScrollbars();if(this.hasAccessibility&&this.enableAccessibility){this.enableAccessibility();}}});},addRankShortcutMenu:function AA(Ax,Av){var Aw=this,Az=this.id;function Au(A2,A1,A0){Aw.submitAddShortcutMetric(Ax,{item:A2,funcType:mstrmojo.mstr.EnumFunction.FunctionRank,prs:[{n:"ASC",v:A1}],breakBys:A0});}function Ay(A0){return i.getRankMetricEditor(A0.item,Aw.getDynamicBreakByOptions(false,A0),Au);}Av.addActionPopupMenuItem(mstrmojo.desc(2789,"Rank"),Az,function(){Au(Ax.item,"0",[{dmy:"@auto"}]);},Ay,"",Ax);},addPercentileShortcutMenu:function z(Aw,Au){var Av=this,Az=this.id;function Ax(A0){var A1;if(A0.dmy){A1={dmy:A0.dmy};}else{A1={id:A0.did,type:A0.t};}Av.submitAddShortcutMetric(Aw,{item:Aw.item,funcType:mstrmojo.mstr.EnumFunction.FunctionPercentRank,breakBys:[A1],prs:[{n:"inclusive",v:"False"}]});}function Ay(){var A1=new mstrmojo.ui.menus.MenuConfig(),A0=Av.getDynamicBreakByOptions(false,Aw);A0.forEach(function(A2){if(A2.isSeparator){A1.addSeparator();return ;}A1.addMenuItem(A2.n,"",function(){Ax(A2);});});return A1;}Au.addActionPopupMenuItem(mstrmojo.desc(13409,"Percentile Rank"),Az,function(){Ax({dmy:"@auto"});},Ay,"",Aw);},addPercentToTotalShortcutMenu:function AR(Av,A1){var A3=this,Au=this.id,A8=Av.item,A9=A3.getHost(),A5=A9.getChartStyle&&A9.getChartStyle()==="NewGraphMatrixVisualizationStyle",A2=A3.submitActionForDatasetUpdate.bind(A3),A0=A3.getDynamicLevelOptions(Av),Az=A9.k,Aw=A9.defn.tt,A7=A3.allowInsertNewMetric(Av.zone),Ay=[];if(Av.zone.id===m){A7=false;}if(A9.hasArrayGSI){var A6=this.getGSI(Av);Az=A6.k;}function A4(BA){if(A7&&Av.useDropzone&&A3.gmZones){var BC=A3.gmZones.getZoneModelByZoneId((Av.zone.id===Ad)?I:AU);var BB=A3.getAddMetricNameAction(A9,BC.id);if(BB){Ay.push(BB);}BB=A3.gmZones.getUpdateGroupInfoActionForNewMetric(Av.zone.id,Av.idx+1,Av.item.ax===0);if(BB){Ay.push(BB);}}A2(Ay.concat(Ac.call(A3,{act:"addPercentToTotalMetric",nodeKey:Az,treeType:Aw,metric_id:A8.did,axes_bitmap:BA.axes_bitmap||0,units:BA.did&&[{id:BA.did,type:BA.t}]},Av,{offset:A7?1:0,replaceSourceId:A7?null:Av.item.did,addToTooltip:A5})));}function Ax(){var BA=new mstrmojo.ui.menus.MenuConfig();A0.forEach(function(BB){if(BB.isSeparator){BA.addSeparator();return ;}BA.addMenuItem(BB.n,"",function(){A4(BB);});});return BA;}A1.addActionPopupMenuItem(mstrmojo.desc(3323,"Percent to Total"),Au,function(){A4({axes_bitmap:AO.DssAxisDynamicShortcutRoot+An.DssDynamicShortcutAuto});},Ax,"",Av);},addPercentOfShortcutMenu:function N(Ay,Au){var Ax=this,Az=this.id;function Aw(A1,A2,A0){Ax.submitAddShortcutMetric(Ay,{item:A1,funcType:A2,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:A0,sortBys:[{dmy:"@auto"}]});}function Av(A0){return i.getRelativeReferenceMenu(A0.item,mstrmojo.desc(13394,"Percent of:"),Ax.getDynamicBreakByOptions(false,A0),Aw);}Au.addActionPopupMenuItem(mstrmojo.desc(13390,"Percent Of"),Az,function(){Aw(Ay.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Av,"",Ay);},addPercentChangeShortcutMenu:function s(Ax,Av){var Aw=this,Az=this.id;function Ay(A1,A2,A0){Aw.submitAddShortcutMetric(Ax,{item:A1,funcType:A2,funcType2:mstrmojo.mstr.EnumFunction.FunctionVar,breakBys:A0,sortBys:[{dmy:"@auto"}]});}function Au(A0){return i.getRelativeReferenceMenu(A0.item,mstrmojo.desc(20073,"From:"),Aw.getDynamicBreakByOptions(false,A0),Ay);}Av.addActionPopupMenuItem(mstrmojo.desc(13391,"Percent Change"),Az,function(){Ay(Ax.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Au,"",Ax);},addDifferenceShortcutMenu:function L(Ax,Au){var Aw=this,Az=this.id;function Av(A1,A2,A0){Aw.submitAddShortcutMetric(Ax,{item:A1,funcType:A2,funcType2:mstrmojo.mstr.EnumFunction.FunctionMinus,breakBys:A0,sortBys:[{dmy:"@auto"}]});}function Ay(A0){return i.getRelativeReferenceMenu(A0.item,mstrmojo.desc(20073,"From:"),Aw.getDynamicBreakByOptions(false,A0),Av);}Au.addActionPopupMenuItem(mstrmojo.desc(11495,"Difference"),Az,function(){Av(Ax.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ay,"",Ax);},addMovingTotalShortcutMenu:function AT(Aw,Au){var Av=this,Az=this.id;function Ay(A3,A2,A1,A0){Av.submitAddShortcutMetric(Aw,{item:A3,funcType:A2,breakBys:A0,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"3"},{n:"OLAPWinStOffset",v:A1.toString()},{n:"OLAPWinEndType",v:"2"}]});}function Ax(A0){return i.getMovingTotalMenu(A0.item,Av.getDynamicBreakByOptions(false,A0),Ay);}Au.addActionPopupMenuItem(mstrmojo.desc(13392,"Moving Average"),Az,function(){Ay(Aw.item,mstrmojo.mstr.EnumFunction.FunctionOLAPAvg,1,[{dmy:"@auto"}]);},Ax,"",Aw);},addRunningTotalShortcutMenu:function Ak(Ay,Au){var Ax=this,Az=this.id;function Aw(A2,A1,A0){Ax.submitAddShortcutMetric(Ay,{item:A2,funcType:A1,breakBys:A0,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Av(A0){return i.getRunningTotalMenu(A0.item,Ax.getDynamicBreakByOptions(false,A0),Aw);}Au.addActionPopupMenuItem(mstrmojo.desc(11906,"Running Total"),Az,function(){Aw(Ay.item,mstrmojo.mstr.EnumFunction.FunctionOLAPSum,[{dmy:"@auto"}]);},Av,"",Ay);},addPercentRunningTotalShortcutMenu:function B(Ax,Av){var Aw=this,Az=this.id;function Au(A2,A0){var A1=[];A0.forEach(function(A3){if(A3.dmy){A1.push({dmy:A3.dmy});}else{A1.push({id:A3.did,type:A3.t});}});Aw.submitAddShortcutMetric(Ax,{item:A2,funcType:mstrmojo.mstr.EnumFunction.FunctionOLAPSum,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:A1,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Ay(A2){var A1=new mstrmojo.ui.menus.MenuConfig(),A0=Aw.getDynamicLevelOptions(A2);A0.forEach(function(A3){if(A3.isSeparator){A1.addSeparator();return ;}A1.addMenuItem(A3.n,"",function(){Au(A2.item,[A3]);});});return A1;}Av.addActionPopupMenuItem(mstrmojo.desc(13393,"Percent Running Total"),Az,function(){Au(Ax.item,[{dmy:"@auto"}]);},Ay,"",Ax);},getMultipleMetricsCalcMenus:function AD(A1,A0,A3){var A2=this,A4=this.getHost(),Az=this.submitActionForDatasetUpdate.bind(this),Ax=A4.k,Av=A4.defn.tt,Aw=A0.map(function(A5){return A5.did;}),Au=A1.items.map(function(A5){return A5.did;}),Ay=-1;Aw.forEach(function(A5){var A6=O.indexOf(Au,A5);if(A6>Ay){Ay=A6;}});return i.getMultipleMetricsCalculationMenus(A0,A4.model.data.datasetId,function(A7){var A6={act:"addShortcutMetric",dsid:At.call(A2,Aw),nodeKey:Ax,treeType:Av,funcType:A7.funcType,funcType2:A7.funcType2,units:A7.items.map(function(A9){return{id:A9.did,type:A9.t};})},A8,A5;A8=Ac.call(A2,A6,{useDropzone:A3,zone:A1,item:{ax:0},idx:Ay},{offset:1});if(A2.gmZones){A5=A2.gmZones.getUpdateGroupInfoActionForNewMetric(A1.id,Ay+1,true);}if(A5){A8.push(A5);}Az(A8);});},getCreateOrEditElementGroupFunc:function As(Av){var Au=this;return function(){var Az=Au.getHost(),A0=Az.model,Ay=Av.item,Ax=Ay.did,Aw=Au.getUnitInfoInTemplate(Ax),A2="$GUID_1",A1=Aw.unit.ost===Am.ConsolidationManaged&&A0.docModel.getDEObject(Ax);Az.controller.openDEEditor(Az,A1?{deObj:A1}:{dsId:A0.data.datasetId,attId:Ax,attName:Ay.n,deId:A2,setIdx:Ay.setIdx,getExtraSaveActions:function(A4){var A3=Av.zone,A5=Au.getRemoveDropZoneUnitActions(A3,Ay);A5.push(Au.getAddDropZoneUnitAction(A3,{did:A4||A2,t:Ab.DssTypeConsolidation},Av.idx));return Au.getUpdateTemplateAction(A5);}});};},buildThresholdMenuOptions:function AC(Av,Aw,Au){mstrmojo.all[this.hostId].model.buildThresholdMenuOptions(Av,Aw,Au,this.canSupportImageThreshold());},canSupportImageThreshold:function M(){return false;},getNumberFormatEditorCfg:function R(Au){return mstrmojo.all[this.hostId].model.getNumberFormatEditorCfg(Au);},submitUpdatesAndPersistWidgetXMLIfNecessary:function Ar(Ax,Aw,Av){var Au=Ax.model.docModel,Ay=Au.getDataService(),A0,Az;if(!Ax.isXMLDirty()){Ax.controller.onSubmitTemplateUpdates(Ax,Aw,Av);}else{Az={act:"updateTemplate",keyContext:Ax.k,actions:Aw};A0=Ax.getPersistAction();Ay.submitUpdates([Az,A0],mstrmojo.func.wrapMethods(Ax.controller._getXtabCallback(Ax),Av));Ax.resetXMLDirtyFlag();}},submitActionForDatasetUpdate:function AZ(Av){var Au=this.docModel;this.submitDropZoneUpdates(Av,mstrmojo.func.wrapMethods(Au.getDatasetsUpdateCallback(),Au.controller._getXtabCallback(this.getHost())));},getVFNotifierBlackList:function Ai(Aw,Au){var Av=11,Ax=12;switch(Aw){case"XtabGrid":return[j.Rows,j.Columns];case"GraphMatrixVisualizationStyle":case"NewGraphMatrixVisualizationStyle":if(Au){return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.BreakBy,j.SliceBy,j.Angle,Av,Ax];}else{return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.BreakBy,j.SliceBy,j.Angle];}case"VIHeatMapVisualizationStyle":return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.Grouping];case"NetworkVisualizationStyle":return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.FromItem,j.ToItem];case"ImageLayoutVisualizationStyle":return[j.GeoAttribute,j.Layout];case"GoogleMapVisualizationStyle":case"ESRIMapVisualizationStyle":case"MapboxVisualizationStyle":return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.SliceBy,j.Angle,j.GeoAttribute,j.Latitude,j.Longitude];case"KPICardVisualizationStyle":return[j.Rows,j.Columns,j.XAxis,j.YAxis,j.Metric,j.BreakBy];default:return[];}},supportWebSort:function AK(){return !(mstrApp.isVI&&!mstrmojo.resolveFeature("web-sort"));},getSetIdx:function y(Aw){var Av=Aw.item,Au=Aw.cell,Ax=Au?Au.setIdx:Av.setIdx;return Ax;},getGSI:function Aq(Aw){var Av=this.getHost(),Au=Av.model.data,Ay=Au.gsi;if(Av.hasArrayGSI&&Aw){var Ax=this.getSetIdx(Aw);if(Ax===-1||Ax===undefined){return t.getGSI(Ay,Au.sortIndex);}return t.getGSI(Ay,Ax);}return Ay;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr");var H=mstrmojo.array,J=mstrmojo.hash,N=mstrmojo.expr,S=N.TP,P=N.STP,L=4,I=12,E="-1";mstrmojo.vi.ui.rw.xtab._SupportXtabThresholds=mstrmojo.provide("mstrmojo.vi.ui.rw.xtab._SupportXtabThresholds",{_mixinName:"mstrmojo.vi.ui.rw.xtab._SupportXtabThresholds",getClearThresholdAction:function C(Y,W,X){return{act:"clearThreshold",unitId:Y,unitType:W,tid:X};},addClearActions:function F(Z,X,Y,a,W){X.reverse().forEach(function(b){a.push(Z.model.getClearThresholdAction(Y,W,b.tid));});},getCreateSimpleThresholdAction:function A(b,Z,W,a,Y,X){return{act:"threshold",nodeKey:Z,thresholds:b,thresholdType:a,basedOnId:Y||W,did:W,objType:X};},getThresholdTargets:function O(){var X=this,Y=X.data,a=Y.gsi,W=J.clone(a.mx),Z=a.rows.concat(a.cols);W.forEach(function(b){b.t=4;});Z=Z.concat(W).filter(function(d){var b=d.t,e=d.st,c=d.did;return !((b===S.FILTER&&e===P.CUSTOMGROUP)||(b===S.CONS&&e===P.CONS)||(X.hasDerivedElements(c))||(c===E)||(b===S.DIM));});return Z;},cleanupThresholdTargets:function Q(W){W.forEach(function(Z){var Y;if(Z.t===I){Y=this.getObjectInfo(Z.did);Z.da=Y?Y.da:undefined;}else{if(Z.t===S.CONS&&Z.st===P.NDE){Y=this.getObjectInfo(Z.did);Z.ndetype=Y.ndetype;}else{if(Z.t===L){var X=this.getFullObjectInfo(Z.did);Z.dt=X&&X.dt;}}}},this);},getThresholdSupportsFeatureCallback:function D(W,b,a){var Y=mstrmojo.threshold.ThresholdModel.FEATURES,X=this;a=a||{};return function Z(e){switch(e){case Y.SHOW_ADVANCED_EDITOR:return !W;case Y.SHOW_BASED_ON:return !W;case Y.SHOW_IMAGE:return b;case Y.SHOW_COLOR_TREND:return a.canSupportColorTrend;case Y.SHOW_MC_ADVANCED_EDITOR:return a.canShowMCAdvancedEditor;case Y.SHOW_VALUE_ITEM:var d=X.getFullObjectInfo(this.model.basedOnId),f=d&&d.dt,c=[8,9,10,14,15,16,30];return !f||c.indexOf(f)===-1;}};},getThresholdSubmitActionsCallback:function B(){var W=this,X=W.xtab;return function(h,a,Z,b,f,g,Y){var e=this,d=X.k,c=[];if(a){W.addClearActions(X,a,Z,c,Y);}c.push(W.getCreateSimpleThresholdAction(h,d,Z,f,b,Y));X.controller.submitUndoRedoTemplateUpdates(X,c,{success:function(){if(g){e.set("data",W.data);e.openEditor();g=false;}}});};},getThresholdSaveCallback:function G(){return function(Y,W,X,a,Z){this.dataService.saveThresholds(J.copy(a,{thresholds:JSON.stringify(Y),basedOnId:W,thresholdType:X}),Z,{hideFailureErr:true});};},getThresholdLoadCallback:function M(){var W=this;return function(Y,Z){var X=this.model;this.dataService.getThresholds({thresholdsID:Z},{success:function(f){var e=f.thresholds,b=[],a,g,d={};H.forEach(e||[],function(h){a=N.findTargets(h.expr,"did");g=true;J.forEach(a,function(i,j){if(!W.getObjectInfo(j)){d[j]=i.n;g=false;}});if(g){b.push(h);}});if(!J.isEmpty(d)){var c=J.valarray(d);mstrmojo.alert(mstrmojo.desc(15431,"The following objects: # are not on the visualization, so some thresholds will not be loaded...").replace("#",c.join(",")));}X.addThresholds(b);}});};},getThresholdControllerParams:function R(f,Z,d,W,a,X){var Y=this,e=Y.docModel,c=Y.data,b=f.did||f.id;return{metricId:b,objectType:f.t,title:W,data:c,targets:a,messageId:e.mid,datasets:e.datasets,dataService:e.getDataService(),supportsFeature:this.getThresholdSupportsFeatureCallback(Z,d,X),onSubmitActions:this.getThresholdSubmitActionsCallback(),onSaveThresholds:this.getThresholdSaveCallback(),onLoadThresholds:this.getThresholdLoadCallback()};},openThresholdEditor:function K(Z,W,c){var b=Z.did||Z.id,Y=mstrmojo.desc(3647,"Thresholds");if(Z.t===L||Z.t===I){var a=this.getThresholdTargets();this.cleanupThresholdTargets(a);if(b!==E){Y+=" - "+Z.n;}var X=new mstrmojo.threshold.ThresholdController(this.getThresholdControllerParams(Z,W,c,Y,a));if(Z.t===I){X.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;}X.openEditor();}},buildThresholdMenuOptions:function U(b,X,a,h){var Z=this,j=X.item,g=j.did,W=Z.xtab,f=Z.data,i=f.gsi,Y=i.thresholds,e=Y&&Y[g],c=mstrmojo.desc(13261,"Clear Thresholds"),d=W.excludeData;if((!d&&j.t===L)||j.t===I&&!Z.docModel.isOldDEObject(g)){b.addMenuItem(e?mstrmojo.desc(19946,"Edit Thresholds..."):mstrmojo.desc(6050,"Thresholds..."),"",function(){Z.openThresholdEditor(j,a,h);},this);if(g!==E){if(e){b.addMenuItem(c,"",function(){var k=W.controller,l=[];Z.addClearActions(W,e,g,l,j.t);k.submitUndoRedoTemplateUpdates(W,l);},this);}}}},});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.gm.GMLegend","mstrmojo.gm.GMUtility","mstrmojo.customviz.CustomVisEnums");var K=mstrmojo.array,F=mstrmojo.dom,N=mstrmojo.hash,H=mstrmojo.gm.GMLegend,O=mstrmojo.gm.GMUtility,I=mstrmojo.customviz.CustomVisEnums,U=I.ENUM_LEGEND_DATA_TYPE,A=I.ENUM_LEGEND_DISPLAY_MODE,J=I.ENUM_LEGEND_DISPLAY_MODE,L=I.ENUM_LEGEND_PROPS,G=I.ENUM_FONT_STYLE;var C=5,M=0.000001,D="clrSqrClr";var B={lgdFntClr:L.LEGEND_FONT_COLOR,lgdFntSz:L.LEGEND_FONT_SIZE,lgdFntFml:L.LEGEND_FONT_FAMILY,lgdFntStyle:[L.LEGEND_FONT_ITALIC,L.LEGEND_FONT_WEIGHT,L.LEGEND_FONT_LINE_THROUGH,L.LEGEND_FONT_UNDERLINE],lgdBgFillClr:L.LEGEND_BG_COLOR,lgdBgFillTrans:L.LEGEND_BG_FILL_TRANSPARENCY};var E={fontItalic:G.FS_ITALIC,fontWeight:G.FS_BOLD,fontUnderline:G.FS_UNDERLINE,fontLineThrough:G.FS_STRIKETHROUGH};function W(X){var Y=this.cachedDimension,a=Y&&Y.scale,b=Y&&Y.fixedWidth,Z=X.getLegendProperty(L.LEGEND_WIDTH_SCALE);if(isNaN(Z)){Z=undefined;}if(Z===undefined){return{scale:undefined,fixedWidth:undefined};}if((a===undefined)||(Math.abs(a-Z)>=M)){return{scale:Z,fixedWidth:undefined};}return{scale:a,fixedWidth:b};}function P(Z,X,a){var Y=N.clone(Z.getProperty(I.LEGEND_PROPERTY_SET))||{};if(X){Y[X]=a;}return Y;}function R(Y,X){if(!Y||!X){return ;}Y.fontWeight=(X[L.LEGEND_FONT_WEIGHT]?"bold":"normal");Y.fontStyle=(X[L.LEGEND_FONT_ITALIC]?"italic":"normal");if(X[L.LEGEND_FONT_LINE_THROUGH]&&X[L.LEGEND_FONT_UNDERLINE]){Y.textDecoration="line-through underline";}else{if(X[L.LEGEND_FONT_LINE_THROUGH]){Y.textDecoration="line-through";}else{if(X[L.LEGEND_FONT_UNDERLINE]){Y.textDecoration="underline";}else{Y.textDecoration="none";}}}}function S(){var Z=this.widget,Y={},X={};K.forEach([L.LEGEND_FONT_WEIGHT,L.LEGEND_FONT_ITALIC,L.LEGEND_FONT_UNDERLINE,L.LEGEND_FONT_LINE_THROUGH],function(a){X[a]=Z.getLegendProperty(a);});Y.backgroundColor=Z.getLegendProperty(L.LEGEND_BG_COLOR);Y.opacity=Z.getLegendProperty(L.LEGEND_BG_FILL_TRANSPARENCY)/100;Y.fontFamily=Z.getLegendProperty(L.LEGEND_FONT_FAMILY);Y.fontSize=Z.getLegendProperty(L.LEGEND_FONT_SIZE);Y.color=Z.getLegendProperty(L.LEGEND_FONT_COLOR);R(Y,X);return Y;}mstrmojo.customviz.CustomVisLegend=mstrmojo.declare(mstrmojo.gm.GMLegend,null,{scriptClass:"mstrmojo.customviz.CustomVisLegend",init:function(Y){this._super(Y);var X=this.widget.getLegendProperty(L.LEGEND_POSITION);this.currDockedPositionIdx=this.getLegendDockPosIdx(X);this.styles=S.call(this);this.cssClass="gm-legend";this._resetLegendSize();},postBuildRendering:function(){this._super();this._initListeners();this._toggleLegendDisplay(false);},renderLegend:function(){this._updateLegendStyle();this._measureLegendSize();this._updateLegend();},_updateLegendStyle:function(){if(this.canRenderLegend()){this.updateStyle(S.call(this));}},canRenderLegend:function(){return this.widget.canRenderLegend();},_getLegendWidth:function(){var X=this.width+this.padding;if(isNaN(X)){X=0;}return parseInt(X);},_resetLegendSize:function(){this.width=this.height=this.padding=0;},_isCollapsedMode:function(){var a=this.widget,Z=L.LEGEND_MODE,X,Y,b;if(F.isIPhone){X=a.getProperties()[I.LEGEND_PROPERTY_SET]||{};Y=X[Z];if(!Y){return true;}b=parseInt(Y);}else{b=a.getLegendProperty(Z);}return b===A.MINIMIZED;},_measureLegendSize:function(){var Z,c=this.widget,Y=c.getWidth(),X=c.getHeight(),b,a;if(!this.canRenderLegend()){this._resetLegendSize();}else{a=this.styles;H.applyHTML5Props(a);b=W.call(this,c);this.legendData=[{dataType:U.COLOR_BY,dataObj:this.colorByInfo},{dataType:U.SIZE_BY,dataObj:this.sizeByInfo}];Z=H.getLegendSize(this.legendData,b.scale,Y,X,a,b.fixedWidth,this.needExtraPaddingTop4Legend());if(this._isCollapsedMode()||Z.autoCollapse){Z=H.getLegendSize4MinMode(this.colorByInfo,X,this.needExtraPaddingTop4Legend());}this.width=Z.width;this.height=Z.height;this.padding=C;}},_updateLegend:function(){var X=this.canRenderLegend();this._toggleLegendDisplay(X);if(X&&this.width>0&&this.height>0){var Y=this.widget;this.domNode.style.width=this.width+"px";this.domNode.style.height=this.height+"px";this.updateContainerSize(Y.getWidth(),Y.getHeight());this.feedData(this.legendData,this._isCollapsedMode());this.updateAfterResize();}},readGlobalProperty:function(b){var a=this.widget,Y,Z;var X=B[b];if(b===D){Y=a.colorSqureIdentity;if(Y){Z={color:Y.decodedColor,isDefaultColor:Y.isDefaultColor};}else{Z={color:this.defaultGraphicColor,isDefaultColor:true};}}else{if(K.isArray(X)){Z=G.FS_NORMAL;K.forEach(X,function(c){if(a.getLegendProperty(c)){Z|=E[c];}});}else{Z=a.getLegendProperty(X);if(X.indexOf("Color")>0){Z=O.encodeColor(Z);}}}return Z;},writeGlobalProperty:function(d,e){var c=this.widget,X=B[d],Y=P(c),a,Z,b;if(d===D){Z=c.colorSqureIdentity;if(Z){c.updateColorMap(Z.comb,e);}return ;}if(K.isArray(X)){K.forEach(X,function(h){var g=Y[h],f=(e&E[h])>0;Y[h]=f;if(g!==f){a=h;}});}else{if(X.indexOf("Color")>0){e=O.decodeColor(e);}Y[X]=e;a=X;}b=c._wrapLegendCallbackConfig(I.LEGEND_PROPERTY_SET,a);c.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,Y,b);},configureLegendPopup:function(X,Y){X.hostId=this.widget.id;X.hostElement=Y;},_initListeners:function(){var X=this.id;this.resizeListener=this.attachEventListener("gm-legend-resized",X,function(Y){this._onLegendResized(Y.position);});this.clickListener=this.attachEventListener("gm-legend-clicked",X,function(Y){this._onLegendClicked(Y);});this.contextMenuHandler=F.attachMarkupEvent(X,this.domNode,"contextmenu");},_unSubscribeListeners:function(){if(this.resizeListener){this.resizeListener.clear();delete this.resizeListener;}if(this.clickListener){this.clickListener.clear();delete this.clickListener;}if(this.contextMenuHandler){F.detachEvent(this.domNode,"contextmenu",this.contextMenuHandler);delete this.contextMenuHandler;}},oncontextmenu:function(X){if(this.widget._isConsumeMode()){F.stopPropogation(window,X);F.preventDefault(window,X);return false;}this.handleRMCOnLegend(X);this.widget.openFormatPanelByProperty(I.LEGEND_PROPERTY_SET);},_onLegendResized:function(b){var Z=this.widget,Y=Z.getLegendProperty(L.LEGEND_WIDTH_SCALE)||1,a=this.width+b,X=(a)/(this.width/Y);this.cachedDimension={scale:X,fixedWidth:a,resized:true};Z._cacheLegendDimension(this.cachedDimension);Z.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Z,L.LEGEND_WIDTH_SCALE,X));},_onLegendClicked:function(X){var Z=this.widget,Y=X.action,a={close:{prop:L.SHOW_LEGEND,val:false},minimize:{prop:L.LEGEND_MODE,val:J.MINIMIZED},restore:{prop:L.LEGEND_MODE,val:J.RESTORED}}[Y];Z.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Z,a.prop,a.val));},_onLegendDropped:function(X){var Z=this.widget,Y={callback:mstrmojo.emptyFn,clientUndoRedoCallback:function(b){var a=this.legend,d=L.LEGEND_POSITION,c;if(a){c=b&&b[d];if(c===undefined){c=this.getLegendProperty(d);}else{c=parseInt(c);}a.updateLegendSlot(c);}}};Z.savePropertyAndUpdateWidget(I.LEGEND_PROPERTY_SET,P(Z,L.LEGEND_POSITION,X),Y);},_getLegendPosition:function(){return this.getLegendDockPosByIdx(this.currDockedPositionIdx);},_toggleLegendDisplay:function(X){var Y=this.domNode;if(Y&&Y.style){Y.style.display=X?"block":"none";}},unrender:function Q(X){this._unSubscribeListeners();this._super(X);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.Widget","mstrmojo.VisUtility","mstrmojo.VisEnum","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.rw._XtabDE","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo._VizSelectionHelper","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.Button","mstrmojo.models.template.DataInterface","mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.DocDataService","mstrmojo.hash","mstrmojo.gm.GMUtility","mstrmojo.func","mstrmojo.util.color","mstrmojo._colorPalette","mstrmojo.CustomVisUtility","mstrmojo.vi.ui.rw.GhostImageContainer","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._SupportPagination","mstrmojo.PerformanceLogOutput","mstrmojo.vi.enums.EnumFeatures","mstrmojo._TouchGestures");mstrmojo.requiresClsP("mstrmojo.customviz","_HasCustomContextMenu","GraphicModel","_TooltipHelper","CustomVisEnums","CustomVisLegend","_HasExtraSelectionInfo","_SupportCustomVizBrushesAndHighlights");var $DOM=mstrmojo.dom,$ARR=mstrmojo.array,$DSSOBJ_TYPES=mstrmojo.chart.model.enums.EnumDSSObjectType,$HASH=mstrmojo.hash,$NWB=mstrmojo.Button.newWebButton,$COMPOS=mstrmojo.func.composite,$FNEMPTY=mstrmojo.emptyFn,$UTIL=mstrmojo.VisUtility,$CLRUTIL=mstrmojo.util.color,$GM_UTIL=mstrmojo.gm.GMUtility,$CUSTOM_VIS_UTIL=mstrmojo.CustomVisUtility,CustomVisLegend=mstrmojo.customviz.CustomVisLegend,$CustomVisEnums=mstrmojo.customviz.CustomVisEnums,$ENUM_LEGEND_PROPS=$CustomVisEnums.ENUM_LEGEND_PROPS,$DEFAULT_LEGEND_PROP_VALUE=$CustomVisEnums.DEFAULT_LEGEND_PROP_VALUE,$ENUM_LEGEND_PROPERTY_TYPE=$CustomVisEnums.ENUM_LEGEND_PROPERTY_TYPE,$LEGEND_FORMATTING_PROPERTY=$CustomVisEnums.ENUM_LEGEND_FORMATTING_PROPERTY,$LOG=$CUSTOM_VIS_UTIL.log,$FEATURES=mstrmojo.vi.enums.EnumFeatures,$PerfLog=mstrmojo.PerformanceLogOutput;var DARK_THEME_ID="F1FED8AC42B57AC1B0E9518FED0F89D6",DEFAULT_THEME_ID="0C2437E3440A676379C06C8C7C6E2AA6";var DEFAULT_GRAPHIC_COLOR="#436CD3";var ATTACHED_EVENTS=["mousemove","click","contextmenu"];var FILTER_TYPE={SHARED:0};var EXTERNAL_LIBS={D3:"d3"};var MARKUP_STRING_WITH_LEGEND='<div id="{@id}" class="custom-vis-layout {@cssClass}" style="position:absolute;font-size:8pt;width:{@width}px;height:{@height}px;z-index:{@zIndex};{@viewportCssText}" mstrAttach:contextmenu,click,mousemove><div class="canvasContainer"></div><div></div></div>',MARKUP_SLOTS_WITH_LEGEND={canvasContainer:function(){return this.domNode.firstChild;},legendPlaceHolder:function(){return this.domNode.lastChild;}};function setUserDefinedError(){var msg=this.errorMessage+" "+this.errorDetails;this.setError(msg);}function toggleError(show){setUserDefinedError.call(this);this.raiseEvent({name:"toggleCtrlOverlay",visible:show,controls:this.getVisEmptyMsgControls()});}function toggleLoading(show){var controls=[{scriptClass:"mstrmojo.Container",cssClass:"vis-loading",markupString:'<div class="{@cssClass}"><div class="loading-cell"><span></span><p>{@msg}</p></div></div>',msg:mstrmojo.desc(16650,"Rendering Visualization...")}];this.raiseEvent({name:"toggleCtrlOverlay",visible:show,controls:controls});}function hideFilterMenuOption(){var vizContainer=this.parent,titleBar=vizContainer&&vizContainer.titleBar,toolbarCfg=titleBar&&titleBar.getMenuConfig();if(!toolbarCfg){return ;}toolbarCfg.menus=$ARR.filter(toolbarCfg.menus,function(item){return item.cls!=="uaf";});}function openAndRefreshFormatPanel(){var docModel=this.getDocModel(),docCtrl=$HASH.walk("rootCtrl.docCtrl",mstrApp);if(docModel&&docCtrl&&(typeof docCtrl.selectViPanel==="function")){docCtrl.selectViPanel("propertiesPanel");docModel.selectVIUnit(this.parent.id,true);}}function getSetPropertiesAction(){var modelData=this.model.data,xmlDom,xmlString;var convertJSONToXML=function(object,tagName){if(object===undefined||object===null){return ;}var ret=xmlDom.createElement(tagName),key;if(object instanceof Object){for(key in object){if(object.hasOwnProperty(key)){var child=convertJSONToXML(object[key],key);if(child){ret.appendChild(child);}}}}else{ret.setAttribute("value",object);}return ret;},encodeXMLString=function(xmlString){return xmlString.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");};xmlDom=(new DOMParser()).parseFromString("<props><widgetProps><fmt></fmt></widgetProps></props>","text/xml");xmlDom.firstChild.firstChild.firstChild.appendChild(convertJSONToXML(this.getProperties(),"cvp"));xmlString=(new XMLSerializer()).serializeToString(xmlDom);return[{act:"setProperty",nodeKey:modelData.k,prs:"FormattingWidget",pri:4,v:encodeXMLString(xmlString)}];}function isValidProperties(properties,level){var isObject=typeof properties==="object";if((level===0&&!isObject)||(level===2&&isObject)){return false;}for(var key in properties){var value=properties[key];if(typeof value==="object"&&!isValidProperties(value,level+1)){return false;}}return true;}function reserveExternalLibrarys(noConflictLibs){var _noConflictLibs=this._noConflictLibs,D3=EXTERNAL_LIBS.D3;if(!_noConflictLibs){_noConflictLibs=this._noConflictLibs={};}$ARR.forEach(noConflictLibs,function(lib){if(!_noConflictLibs[D3]){switch(lib){case D3:_noConflictLibs[D3]=window.d3;return ;}}});}function getNoConflictLibraryReference(noConflictLibraries){var code="",D3=EXTERNAL_LIBS.D3;$ARR.forEach(noConflictLibraries,function(lib){switch(lib){case D3:code+="var d3 = this._noConflictLibs['"+D3+"'];";return ;}});return code;}function getColorByAttsNames(colorByItems){var gts=$HASH.walk("dataInterface.data.gts",this)||{},units=(gts.row||[]).concat(gts.col||[]),names="",index,item;$ARR.forEach(colorByItems,function(itm){index=$ARR.find(units,"id",itm.id);if(index>-1){item=units[index];names+=(item.dn||item.n)+" ";}});if(names.length>0){names=names.substring(0,names.length-1);}return names;}function getColorByInfo(){var zonesModel=this.zonesModel,colorByAttrs=zonesModel&&zonesModel.getColorByAttributes(),colorByMetric=zonesModel&&zonesModel.getColorByMetric(),index,colorByLabel="",colorByItems=[];if(colorByAttrs&&colorByAttrs.length>0){var colorByAttrInfo=this.getColorByAttInfo(colorByAttrs),element,singleItem;colorByLabel=getColorByAttsNames.call(this,colorByAttrs);for(index=1;index<colorByAttrInfo.length;index++){element=colorByAttrInfo[index];singleItem={};$HASH.copyProps(["color","encodedColor","isDefaultColor","opacity","comb"],element,singleItem);singleItem.decodedColor=element.color;singleItem.label=element.text;singleItem.token={elements:element.colorByElementIDs,levels:element.colorByAttributeIDs,types:element.colorByTypes};colorByItems.push(singleItem);}return{item:colorByLabel,elements:colorByItems};}if(colorByMetric){var colorByMetricId=colorByMetric.id,modelData=$HASH.walk("dataInterface.data",this),gsi=modelData&&modelData.gsi,mx=gsi&&gsi.mx,thresholds=gsi&&gsi.thresholds,cbMetric,colorThresholds,rankMode,nfs,fs,defaultColor;index=$ARR.find(mx,"did",colorByMetricId);if(colorByMetricId&&thresholds&&index>-1){cbMetric=mx[index];colorThresholds=thresholds[colorByMetricId];if(colorThresholds&&colorThresholds.length>0){rankMode=$UTIL.getRankMode(colorThresholds);nfs=$UTIL.getNumberFormat(modelData,index);fs=nfs?$UTIL.getColorByFormatStr(nfs.replace(/\'/g,'"'),rankMode):"";defaultColor=$CLRUTIL.getCSSColorString(DEFAULT_GRAPHIC_COLOR);colorByItems=$UTIL.getColorByItems(colorThresholds,rankMode,cbMetric.max,cbMetric.min,cbMetric.cnt,fs,defaultColor);colorByLabel=$UTIL.getColorByTitle(cbMetric.n,rankMode);return{item:colorByLabel,elements:colorByItems};}}}}function getSizeByInfo(){var zonesModel=this.zonesModel,sizeByMetric=zonesModel&&zonesModel.getSizeByMetric(),useAbsolute=zonesModel&&zonesModel.useAbsoluteSizeByValue(),row,col,maxFormatVal,minFormatVal,minValue=Infinity,maxValue=useAbsolute?0:-Infinity,sizeByLabel="",caseFlag=0,sizeByItems=[];if(sizeByMetric){var sizeByMetricId=sizeByMetric.id,modelData=$HASH.walk("dataInterface.data",this),gsi=modelData&&modelData.gsi,gvs=modelData&&modelData.gvs,mx=gsi&&gsi.mx,items=gvs&&gvs.items,itemsNum=(items&&items.length)||0,value,sizeByVal;col=$ARR.find(mx,"did",sizeByMetricId);if(sizeByMetricId&&col>-1){sizeByLabel=useAbsolute?$UTIL.getAbsoluteSizeByTitle(mx[col].n):mx[col].n;for(row=0;row<itemsNum;row++){value=items[row].items[col];sizeByVal=useAbsolute?Math.abs(value.rv):value.rv;if(sizeByVal>maxValue){maxValue=sizeByVal;maxFormatVal=value.v;}if(sizeByVal<minValue){minValue=sizeByVal;minFormatVal=value.v;}}if(Math.abs(maxValue-minValue)<0.000001){caseFlag=2;sizeByItems=[{diameter:12,sign:"=",v:minFormatVal}];}else{sizeByItems.push({sign:"=",v:maxFormatVal});sizeByItems.push({sign:"=",v:minFormatVal});}return{item:sizeByLabel,elements:sizeByItems,caseFlag:caseFlag};}}}function transformLegendProperty(propName,propVal){if(propVal===undefined||propVal===null){return propVal;}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Boolean"){return $CUSTOM_VIS_UTIL.parseBoolean(propVal);}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Integer"){return parseInt(propVal);}if($ENUM_LEGEND_PROPERTY_TYPE[propName]==="Float"){return parseFloat(propVal);}return propVal;}function getBuiltInLegendProperties(){var themeName=this.isDefaultTheme()?"defaultTheme":"classicTheme";return $DEFAULT_LEGEND_PROP_VALUE[themeName];}var prevCache={};function genLibConflictChecker(scriptClass){var checkList={d3:function(prev,curr){return prev.version!==curr.version;}};return function(){var arr=[],global=mstrmojo.global;$HASH.forEach(checkList,function(fn,k){if(prevCache[k]===undefined&&global[k]!==undefined){prevCache[k]=[scriptClass,$HASH.copy(global[k])];}else{if(prevCache[k]!==undefined&&(global[k]===undefined||fn(prevCache[k][1],global[k]))){arr.push([k,prevCache[k][0],scriptClass]);}}});if(arr.length>0){console.log("lib conflict: ",arr);}};}mstrmojo.CustomVisBase=mstrmojo.declare(mstrmojo.VisBase,[mstrmojo.vi.ui.rw._XtabDE,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo._VizSelectionHelper,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo._colorPalette,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.customviz._HasCustomContextMenu,mstrmojo.customviz._HasExtraSelectionInfo,mstrmojo.customviz._SupportCustomVizBrushesAndHighlights,mstrmojo.customviz._TooltipHelper,mstrmojo._SupportPagination],{scriptClass:"mstrmojo.CustomVisBase",plotted:false,markupString:'<div id="{@id}" class="custom-vis-layout {@cssClass}" style="position:absolute;font-size:8pt;width:{@width}px;height:{@height}px;z-index:{@zIndex};{@viewportCssText}" mstrAttach:contextmenu,click,mousemove></div>',supportPagination:false,markupSlots:{containerNode:function(){return this.domNode;},viewport:function(){return this.domNode;}},formatHandlers:{viewport:["background-color","left","top"]},bindings:{gridData:"this.model.data"},externalLibraries:null,cssFiles:null,errorMessage:"There is either not enough data to display the visualization or an error occurred while executing the visualization.",errorDetails:"",isDynamicTooltip:true,tooltipWin:null,tooltipObjsInOrder:[],additionalAttrIds:[],reuseDOMNode:false,noConflictLibraries:null,enableLegend:false,isCustomVis:true,dataInterface:null,hideUseAsFilterMenuItem:undefined,graphicModels:[],graphicModelsNA:false,noHighlightAfterKeepOnlyExcludeDrill:false,normalizedIdCache:{},splitDomNodes:function(){if(this.enableLegend){this.markupString=MARKUP_STRING_WITH_LEGEND;$HASH.copy(MARKUP_SLOTS_WITH_LEGEND,this.markupSlots);}},init:function init(props){this.splitDomNodes();if(window.mstrApp&&window.mstrApp.isVI){var viewportHandler=this.formatHandlers.viewport;if(viewportHandler){var idx=$ARR.indexOf(viewportHandler,"background-color");if(idx>-1){viewportHandler.splice(idx,1);}}}this._super(props);var cssFiles=this.cssFiles;if(cssFiles){mstrmojo.insertCSSLinks(cssFiles);}this.hideUseAsFilterMenuItem=true;this.graphicModels=[];this.graphicModelsNA=false;this.noHighlightAfterKeepOnlyExcludeDrill=false;this.initTooltip();},getFonts:function(){if(!this.enableLegend){return[];}return[{name:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_FAMILY),isItalic:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_ITALIC),isBold:this.getLegendProperty($ENUM_LEGEND_PROPS.LEGEND_FONT_WEIGHT)}];},plot:mstrmojo.emptyFn,getFilterType:function getFilterType(){return this.defn.ins||FILTER_TYPE.SHARED;},destroyLegend:function(){var legend=this.legend;if(this.enableLegend&&legend&&typeof legend.destroy==="function"){legend.destroy();this.legend=undefined;}},unrender:function unrender(ignoreDom){if(this.defn){this.clearCache();}this.destroyLegend();this._super(ignoreDom);},displayError:function displayError(){if(!this.destroyed){toggleError.call(this,true);}this.renderFinished=true;},renderVisualization:function renderVisualization(){if(this.graphicModelsNA||this.excludeData){this.plotted=false;return ;}function doRender(){try{this.renderFinished=false;var sub=this.attachEventListener("renderFinished",this.id,function(){var me=this;setTimeout(function(){me.renderFinished=true;},0);me.detachEventListener(sub);});toggleLoading.call(this,false);this._renderLegend();this._positionCanvasContainer();$PerfLog.visPrint("plot custom viz started");var timerid_plotCustomViz=$PerfLog.startTimer({functionName:"CustomVizBase.plot: ",purpose:"plot the custom viz and update highlight"});var noConflictLibraries=this.noConflictLibraries;if(noConflictLibraries&&noConflictLibraries.length>0){var codeString=this.plot.toString();eval(getNoConflictLibraryReference(noConflictLibraries)+codeString.substring(codeString.indexOf("{")+1,codeString.lastIndexOf("}")));}else{this.plot();}this.updateHighlight();this.plotted=true;$PerfLog.endTimer(timerid_plotCustomViz);$PerfLog.visPrint("plot custom viz ended");}catch(e){console.error(e);this.displayError();this.plotted=false;}}toggleLoading.call(this,true);this.loadFonts(this.getFonts(),{success:doRender.bind(this),failure:doRender.bind(this)});},setForceReload:function(externalLibs){return externalLibs.map(function(lib){var l=$HASH.copy(lib,{});l.forceReload=!!lib.forceReload;return l;});},postBuildRendering:function postBuildRendering(){var me=this,libraries,res,sub;if(me.waitingForData){return ;}sub=me.listenToUpdateColorMap(function(){me.legendColorByInfo=getColorByInfo.call(me);me.render();if(sub&&me.detachUpdateColorMapListener instanceof Function){me.detachUpdateColorMapListener(sub);}});hideFilterMenuOption.call(me);if(this.isEmpty()){if($UTIL.isOnExpressMode()){$UTIL.renderWidgetErrorRSD(this,$HASH.walk("model.data.eg",this),ATTACHED_EVENTS);}else{this._super();}this.hasRendered=true;return false;}var exp=this.getExp(),gtsModel=this.getRowsAndCols();$UTIL.modifyScExp(exp,gtsModel,this.model,this.normalizedIdCache);res=this._super();if(!this.externalLibraries){libraries=undefined;}else{if(!$ARR.isArray(this.externalLibraries)){console.error("externalLibraries should be an array: ",this.externalLibraries);libraries=undefined;}else{libraries=this.setForceReload(this.externalLibraries);}}this._initLegend();this.renderFinished=false;if(libraries){var url,arr=this.scriptClass&&this.scriptClass.split("."),pluginName=arr&&arr[2],prefix;if(mstrApp&&mstrApp.supportFeature&&mstrApp.supportFeature(mstrmojo.vi.enums.EnumFeatures.SUPPORT_LIVEMODE)&&mstrApp.getWSLiveMode()&&mstrApp.dossierServerBaseUrl&&mstrConfig.dossierServerPluginNames.indexOf(pluginName)>-1){prefix=mstrApp.dossierServerBaseUrl+"plugins/";$ARR.forEach(libraries,function(library,index){url=library.url;if(url.substr(0,7)==="file://"){url=url.substr(7);}if(url.substr(0,4)!=="http"&&url.substr(0,2)!=="//"){libraries[index].url=prefix+url;}});}toggleLoading.call(me,true);var libConflict=genLibConflictChecker(this.scriptClass);this.requiresExternalScripts(libraries,function(){libConflict();if(me.destroyed){return ;}toggleLoading.call(me,false);var noConflictLibraries=me.noConflictLibraries;if(noConflictLibraries&&noConflictLibraries.length>0){reserveExternalLibrarys.call(me,noConflictLibraries);}me.renderVisualization();});}else{me.renderVisualization();}return res;},getCanvasContainerSize:function(){var legend=this.legend,width=this.getWidth(),height=this.getHeight(),legendWidth;if(legend&&this.canRenderLegend()){legendWidth=legend._getLegendWidth();width-=legendWidth;}return{width:width,height:height};},canRenderLegend:function(){if(!this.enableLegend){return false;}var showLegend=this.getLegendProperty($ENUM_LEGEND_PROPS.SHOW_LEGEND);return showLegend&&this.hasColorByOrSizeBy();},_initLegend:function(){if(!this.enableLegend){return ;}this.legend=this.addDisposable(new CustomVisLegend({widget:this,placeholder:this.legendPlaceHolder,defaultGraphicColor:DEFAULT_GRAPHIC_COLOR,colorByInfo:this.legendColorByInfo,sizeByInfo:this.legendSizeByInfo,cachedDimension:this._legendDimension}));this.legend.render();},_renderLegend:function(){if(this.enableLegend&&this.legend){this.legend.renderLegend();}},_cacheLegendDimension:function(dimension){this._legendDimension=dimension;},_wrapLegendCallbackConfig:function(propName,subPropName,config){if(propName===$CustomVisEnums.LEGEND_PROPERTY_SET&&$LEGEND_FORMATTING_PROPERTY.indexOf(subPropName)>=0){var callback=function(){var legend=this.legend;if(legend){legend._updateLegendStyle();}};return{callback:callback,clientUndoRedoCallback:callback};}return config;},_positionCanvasContainer:function(legendPosition){var canvasContainer=this.canvasContainer,containerSize=this.getCanvasContainerSize(),legend=this.legend;if(!this.enableLegend||!canvasContainer){return ;}canvasContainer.style.width=containerSize.width+"px";canvasContainer.style.height=containerSize.height+"px";if(!legend||!this.canRenderLegend()){canvasContainer.style.left="0px";return ;}if(legendPosition===undefined){legendPosition=legend._getLegendPosition();}canvasContainer.style.left=legend.isOnRight(legendPosition)?"0px":(legend._getLegendWidth()+"px");},onLegendDropZoneChange:function(dropZoneInfo){this._positionCanvasContainer(dropZoneInfo&&dropZoneInfo.pos);},onLegendDropped:function(legendDockPos){if(this.legend){this.legend._onLegendDropped(legendDockPos);}},_isConsumeMode:function(){return $CUSTOM_VIS_UTIL.isRWDExpressMode()||$CUSTOM_VIS_UTIL.isLibrary()||$CUSTOM_VIS_UTIL.isVIPresentationMode()||mstrApp.isInVFInteractMode||mstrApp.isDisplayOnMobile;},redraw:function redraw(){if(this.excludeData){return false;}if(this.reuseDOMNode){if(this.plotted){this.renderVisualization();}return this.plotted;}return false;},createZoneModel4ConvertedRWD:function createZoneModel4ConvertedRWD(nodeData){var customVis=this,dz=nodeData&&nodeData.dz;if(mstrApp.isExpress&&dz&&Object.keys(dz).length>0){var visName=this.getVisName(nodeData),zoneModelClassName=$HASH.walk("pluginsVisList."+visName+".dz",mstrConfig)||"vi.models.BaseVisDropZones",ViewClass;if(zoneModelClassName){mstrmojo.requiresCls("mstrmojo."+zoneModelClassName);ViewClass=$HASH.walk(zoneModelClassName,mstrmojo);customVis.zonesModel=customVis.addDisposable(new ViewClass({hostId:customVis.id,docModel:customVis.getDocModel(),visModel:customVis.model}));}}},update:function update(node){if(this._super&&!this._super(node)){return false;}this.clearError();var nodeData=this.getData();if(!nodeData){this.setError(mstrmojo.desc(8426,"No model provided"));return false;}this.dataInterface=new mstrmojo.models.template.DataInterface(nodeData);this.createZoneModel4ConvertedRWD(nodeData);var egt=nodeData.egt,eg=nodeData.eg;if(!this.excludeData&&(egt!==undefined||eg!==undefined)){this.setError(eg,egt);}if(this.isEmpty()||this.excludeData){this.graphicModelsNA=true;return ;}this.legendColorByInfo=getColorByInfo.call(this);this.legendSizeByInfo=getSizeByInfo.call(this);this.idTitleMapping=this.generateIdTitleMapping();var dropZoneModel=this.zonesModel;if(dropZoneModel){var tooltipOrder=dropZoneModel.getDefaultTooltipOrder();dropZoneModel.setTooltipObjsOrder(tooltipOrder);this.additionalAttrIds=dropZoneModel.getAdditionalAttrIds();}this.currColorbyAttrListIdx=0;try{this.graphicModels=this.createGraphicModels();this.graphicModelsNA=false;}catch(e){this.graphicModelsNA=true;setUserDefinedError.call(this);$LOG("Error occurred when creating the graphic models");}},getVisName:function getVisName(data){var visObj=data.vis,visName=data.visName||(visObj&&visObj.vn);return visName;},moveTooltip:function moveTooltip(evt,win){var target=evt.target||$DOM.eventTarget(evt.hWin,evt.e),that=this,content,getTitle=function getTitle(node){var i,children=node.childNodes;for(i=0;i<children.length;i++){var child=children[i];if(child.nodeName==="title"){return child;}}if(node!==that.domNode){return getTitle(node.parentNode);}return null;},title=getTitle(target);if(title){var tooltip=title.innerHTML;if(tooltip.length){content=tooltip;title.tt=tooltip;$DOM.emptyNode(title);}else{if(title.tt!==undefined){content=title.tt;}}}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:content,top:evt.clientY+12,left:evt.clientX-12,cssClass:"vi-regular vi-tooltip-A"};this._super(evt,win);},setError:function(msg,type){var translatedError=$UTIL.translateGridError(msg,type);this.error=translatedError.msg;this.errorType=translatedError.type;},clearError:function(){this.error=undefined;this.errorType=undefined;},hasError:function(){return this.error!==undefined||this.errorType!==undefined;},isEmpty:function(){return this.hasError();},getVisEmptyMsgControls:function getVisEmptyMsgControls(){return $UTIL.getVisEmptyMsgControls.call(this);},hasColorByOrSizeBy:function hasColorByOrSizeBy(){var zonesModel=this.zonesModel;if(!zonesModel){return false;}return zonesModel.getColorByAttributes().length>0||zonesModel.getColorByMetric()||zonesModel.getSizeByMetric();},getProperties:function getProperties(){var data=this.model.data,vp=data.vp;if(!vp){data.vp={cvp:{}};}else{if(!vp.cvp){vp.cvp={};}}return data.vp.cvp;},getDefaultProperties:function getDefaultProperties(){return this.dvp||{};},getLegendProperty:function(propertyName){if(!this.enableLegend){return ;}var legendPropSet=$CustomVisEnums.LEGEND_PROPERTY_SET,props=this.getProperties()[legendPropSet]||{},defProps=this.getDefaultProperties()[legendPropSet]||{},builtInDefProps=getBuiltInLegendProperties.call(this),propValue;propValue=props[propertyName];if(propValue===undefined){propValue=defProps[propertyName];if(propValue===undefined){propValue=builtInDefProps[propertyName];}}return transformLegendProperty(propertyName,propValue);},getLegendProperties:function(){var me=this,props={},propName;$ARR.forEach(Object.keys($ENUM_LEGEND_PROPS),function(key){propName=$ENUM_LEGEND_PROPS[key];props[propName]=me.getLegendProperty(propName);});return props;},setDefaultPropertyValues:function setDefaultPropertyValues(dvp){if(dvp instanceof Object){this.dvp=dvp;}else{this.dvp={};}},getProperty:function getProperty(propertyName){if(propertyName===$CustomVisEnums.LEGEND_PROPERTY_SET){return this.getLegendProperties();}var props=this.getProperties(),defProps=this.getDefaultProperties(),propValue;propValue=props[propertyName]===undefined?defProps[propertyName]:props[propertyName];if(typeof propValue==="object"){propValue=$HASH.copy(props[propertyName],defProps[propertyName]);}return propValue;},setProperty:function setProperty(propertyName,newValue,config){var properties=this.getProperties(),oldValue=properties[propertyName];if(properties&&!$HASH.equals(oldValue,newValue)){properties[propertyName]=newValue;if(config&&config.onPropertyChange instanceof Function){var changedProperties=config.onPropertyChange(propertyName,newValue);if(isValidProperties(changedProperties,0)){$HASH.copy(changedProperties,properties);}else{mstrmojo.warn("Results of onPropertyChange() is invalid. It must be an JSON object that contains the properties and values you want to change, and can't have child properties that exceeds two levels.",{},{buttons:[$NWB(mstrmojo.desc(1442,"OK"),mstrmojo.emptyFn)]});}}if(mstrApp.isDisplayOnMobile){return ;}var suppressData=!!(config&&config.suppressData),requestDefinition=config&&config.requestDefinition,customUndoRedoCallback=config&&config.clientUndoRedoCallback,hasClientUndoRedoCallback=customUndoRedoCallback&&(customUndoRedoCallback instanceof Function),me=this,visId=me.id,boxId=me.parent.id,visModel=me.model,docModel=visModel.docModel,controller=visModel.controller,actions=getSetPropertiesAction.call(this),callback,undoredoCallback,extra={},execute;var getClientUndoRedoCallback=function getClientUndoRedoCallback(val){return suppressData?function(){var vis=mstrmojo.all[visId],properties=vis.getProperties();properties[propertyName]=val;if(hasClientUndoRedoCallback){customUndoRedoCallback.call(vis,val);}else{vis.renderVisualization();}vis.getDocModel().selectVIUnit(vis.parent.id,true);}:$FNEMPTY;};if(suppressData){callback=mstrmojo.emptyFn;execute=function(){this.submitSilent(actions);};}else{callback=docModel.getSliceCallback({tks:visModel.data.k});callback.success=$COMPOS([callback.success,function(){docModel.selectVIUnit(boxId,true);}]);execute=function(){this.submit(actions,callback,extra);};}undoredoCallback=controller._getXtabCallback(me);undoredoCallback.success=$COMPOS([undoredoCallback.success,function(){docModel.selectVIUnit(boxId,true);}]);if(requestDefinition){$HASH.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,extra);}controller.cmdMgr.execute({execute:execute,urInfo:{silent:suppressData,callback:undoredoCallback,redo:getClientUndoRedoCallback(newValue),undo:getClientUndoRedoCallback(oldValue)}});}},openFormatPanelByProperty:function openFormatPanelByProperty(propName){var edtModel=this.edtModel;this.openFormatPanelByIdx(function(){return $HASH.walk("propertyPanelIdxMap."+propName,edtModel);},true);},openFormatPanelWithColorbyGroup:function openFormatPanelWithColorbyGroup(){var edtModel=this.edtModel;this.openFormatPanelByIdx(function(){return $HASH.walk("colorbyGroupPanelIdx",edtModel);},true);},openFormatPanelByIdx:function openFormatPanelByIdx(getFormatPanelIdx,shouldOpenFormat){var edtModel=this.edtModel,formatPanelIdx;if($CUSTOM_VIS_UTIL.isLibrary()||$CUSTOM_VIS_UTIL.isRWDExpressMode()||$CUSTOM_VIS_UTIL.isVIPresentationMode()){return ;}openAndRefreshFormatPanel.call(this);if(typeof getFormatPanelIdx==="number"){formatPanelIdx=getFormatPanelIdx;}else{if(typeof getFormatPanelIdx==="function"){formatPanelIdx=getFormatPanelIdx();}}if(formatPanelIdx>=0){edtModel._targetPulldown.set("selectedIndex",formatPanelIdx);if(shouldOpenFormat&&mstrApp&&mstrApp.supportFeature($FEATURES.DOSSIER_REACT_FORMAT_PANEL)){this.raiseEvent({name:"updateFormatPanelSelection",value:formatPanelIdx,});}}},openFormatPanelByName:function openFormatPanelByName(name){this.openFormatPanelByIdx(function(){var edtModelPulldownItems=$HASH.walk("edtModel._targetPulldown.items",this);return $ARR.find(edtModelPulldownItems,"n",name);}.bind(this));},savePropertyAndUpdateWidget:function savePropertyAndUpdateWidget(propName,newValue,config,showFormatPanel){if(!config||config.suppressData===undefined){config=$HASH.copy({suppressData:true},config);}this.setProperty(propName,newValue,config);if(config.suppressData){var fn=config.callback instanceof Function?config.callback:this.renderVisualization.bind(this);fn.call(this);if(!this._isConsumeMode()){var propertiesPanel=this.controller.getViPanel("propertiesPanel"),isFormatPanelOpened=propertiesPanel&&propertiesPanel.getOpenStatus();if(!!showFormatPanel){this.openFormatPanelByProperty(propName);}else{if(isFormatPanelOpened){var edtModel=this.edtModel,targetPulldown=edtModel&&edtModel._targetPulldown,formatPanelIdx=targetPulldown&&targetPulldown.selectedIndex;if(formatPanelIdx>=0){this.openFormatPanelByIdx(formatPanelIdx);}}}}}},saveObjectProperty:function(propName,subPropName,newValue,config,showFormatPanel){var savedProperties=$HASH.clone(this.getProperty(propName))||{};savedProperties[subPropName]=newValue;config=this._wrapLegendCallbackConfig(propName,subPropName,config);this.savePropertyAndUpdateWidget(propName,savedProperties,config,showFormatPanel);},addThresholdMenuItem:function addThresholdMenuItem(){this.showThreshold=true;},addUseAsFilterMenuItem:function addUseAsFilterMenuItem(){var vizContainer=this.parent;this.hideUseAsFilterMenuItem=false;if(vizContainer&&vizContainer.generateToolbar){vizContainer.generateToolbar();}},getColorBy:function getColorBy(eids){if(!eids||!this.zonesModel){return null;}var zoneItems=this.zonesModel.getColorByAttributes(),colorObj,gts=$HASH.walk("dataInterface.data.gts",this)||{},tids=[],isAttr=function(item){return item.t===$DSSOBJ_TYPES.DssTypeAttribute;},isConsolidation=function(item){return item.t===$DSSOBJ_TYPES.DssTypeConsolidation;},isCG=function(item){return item.t===$DSSOBJ_TYPES.DssTypeFilter;};$ARR.forEach(gts.row.concat(gts.col),function(item){$ARR.forEach(zoneItems,function(itm){if((isAttr(itm)||isConsolidation(itm)||isCG(itm))&&itm.id===item.id){tids.push(itm.id);}});});colorObj=this.model.docModel.getColorBy(tids,eids);return $GM_UTIL.decodeColor(colorObj.color);},getColorByAttInfo:function getColorByAttInfo(zoneItems){function getShapeColorAndOpacity(cbElements){var me=this,colorObj,tid,eid,strtid,streid,attr,opacity,props=this.props||{},opacities=props.attrColorByOpacity||{};cbElements.map(function(item){tid=item.colorByAttributeIDs;eid=item.colorByElementIDs;strtid=tid&&tid.join("|");streid=eid&&eid.join("|");attr=opacities[strtid]||{};opacity=attr&&attr[streid];if(opacity===undefined){opacity=100;}item.opacity=opacity;if(tid&&eid){colorObj=me.model.docModel.getColorBy(tid,eid);item.encodedColor=colorObj.color;item.color=$GM_UTIL.decodeColor(colorObj.color);item.isDefaultColor=!colorObj.isManual;}});}function getCbElements(zoneItems){var cbElements,cbAtt=[],gts=$HASH.walk("dataInterface.data.gts",this)||{},units=(gts.row||[]).concat(gts.col||[]);$ARR.forEach(zoneItems,function(item){$ARR.forEach(units,function(itm){if(itm.id===item.id){cbAtt.push(itm);}});});function descartes(arr){var rs=[],len=arr.length,m,str,bothDescartes=function(arr1,arr2){var r=[],i,j,idx=0,len1=arr1.length,len2=arr2.es.length;for(i=0;i<len1;i++){for(j=0;j<len2;j++){str=arr1[i].text+" "+arr2.es[j].n;idx++;r.push({comb:arr1[i].comb.concat({eid:arr2.es[j].id,tid:arr2.id,tp:arr2.otp}),colorByAttributeIDs:arr1[i].colorByAttributeIDs.concat(arr2.id),colorByElementIDs:arr1[i].colorByElementIDs.concat(arr2.es[j].id),colorByTypes:arr1[i].colorByTypes.concat(arr2.otp),text:str});}}return r;};for(m=0;m<len;m++){if(m===0){var arr0=arr[0];$ARR.forEach(arr0.es,function(itm){rs.push({comb:[{tid:arr0.id,eid:itm.id,tp:arr0.otp}],colorByAttributeIDs:[arr0.id],colorByElementIDs:[itm.id],colorByTypes:[arr0.otp],text:itm.n});});}else{rs=bothDescartes(rs,arr[m]);}}return rs;}cbElements=descartes(cbAtt);cbElements.unshift({text:mstrmojo.desc(2461,"All"),color:"#ffffff",opacity:100,comb:[]});return cbElements;}var cbElements=getCbElements.call(this,zoneItems);getShapeColorAndOpacity.call(this,cbElements);return cbElements;},applySelection:function applySelection(selectInfo,config,extraInfo){if(!selectInfo){return ;}selectInfo=$ARR.ensureArray(selectInfo);extraInfo=$ARR.ensureArray(extraInfo);if(extraInfo.length>0&&extraInfo.length!==selectInfo.length){extraInfo=[];$LOG("extraInfo should be empty or same length with selectInfo, ignore the extraInfo here!");}config=config||{};if(!config.isModify){var clearSelectionsFN=config.forContextMenu?"clearCxtMnuSelection":"clearSelections";this[clearSelectionsFN]();}if(selectInfo.length>0){var isAttrSel=selectInfo[0].isSelectAttr,funcName=(config.isRemove===true?"remove":"add")+(config.forContextMenu===true?"ContextMenu":"")+(isAttrSel?"Attribute":"MetricValue")+"Selection",me=this;}$ARR.forEach(selectInfo,function(selection,index){if(isAttrSel){me[funcName](selection.tid,selection.eid,selection.n,extraInfo[index]);}else{me[funcName](selection,extraInfo[index]);}});if(!config.forContextMenu){this.endSelections();}},isDarkTheme:function isDarkTheme(){return $HASH.walk("model.docModel.thm.did",this)===DARK_THEME_ID;},isDefaultTheme:function(){return $HASH.walk("model.docModel.thm.did",this)===DEFAULT_THEME_ID;},getCellUnitIndex:function getCellUnitIndex(cell){return cell.o;},getCellForNode:function getCellForNode(headerObj){var h=headerObj&&headerObj.h,t=headerObj&&headerObj.t;return{at:h.at,dei:h.dei,dpt:h.dpt,o:h.o,n:t.n,tui:h.tui,ui:h.ui,axis:1,v:headerObj.getName(),tid:t.id};},isInSelection:function isInSelection(isSelectAttr,selector){if(isSelectAttr){return this.isAttSelected(selector.tid,selector.eid);}else{return this.isMetricValueSelected(selector);}},isInContextMenuSelection:function isInContextMenuSelection(isSelectAttr,selector){if(isSelectAttr){return this.isCtxMnuAttSelected(selector.tid,selector.eid);}else{return this.isCtxMnuMetricValueSelected(selector);}},graphicNeedsHighlight:function graphicNeedsHighlight(graphicModel,forContextMenu){var isSelectAttr=graphicModel.isAttributeSelector(),selector=graphicModel.getSelector();if(forContextMenu){return this.needContextMenuHighlight(isSelectAttr,selector);}else{return this.needHighlight(isSelectAttr,selector);}},createGraphicModels:function createGraphicModels(){return[];},getGraphicModels:function getGraphicModels(){return this.graphicModels;},sendMessageToMobileDevice:function sendMessageToMobileDevice(msgType,event,graphicModel){var viz=this,menuConfig=this.getContextMenuConfig(graphicModel),commonConfig=menuConfig&&menuConfig.common,selector=graphicModel&&graphicModel.getSelector(),messageToMobileDevice={messageType:msgType,selectedElement:selector||[],ctxMenuConfig:{pos:viz.getMousePositionFromEvent(event),items:commonConfig?viz.getMobileMenuConfig(commonConfig,graphicModel):[]},toolTip:graphicModel&&this.getTooltipContent(graphicModel)};$UTIL.sendToMobileDevice(messageToMobileDevice);},handleSelection:function handleSelection(event,graphicModel){var isMultiSelectMode=event.ctrlKey||event.metaKey,isSelectAttr=graphicModel&&graphicModel.isAttributeSelector(),selector=graphicModel&&graphicModel.getSelector(),isClearAllDisabled=this.isClearAllDisabled(),needUpdateHighlight=false;if(this.misMatchWithVisSelection){this.synchronizeToVisSelection();needUpdateHighlight=true;}if(graphicModel&&selector){var prevIsSelected=this.isInSelection(isSelectAttr,selector),single=this.getSelections().length===1;if(isMultiSelectMode){if(prevIsSelected&&((single&&!isClearAllDisabled)||!single)){this.applySelection(selector,{isModify:true,isRemove:true},graphicModel);needUpdateHighlight=true;}else{if(!prevIsSelected){this.applySelection(selector,{isModify:true,isRemove:false},graphicModel);needUpdateHighlight=true;}}}else{if(prevIsSelected&&single&&!isClearAllDisabled){this.applySelection([]);needUpdateHighlight=true;}else{if((prevIsSelected&&!single)||!prevIsSelected){this.applySelection(selector,null,graphicModel);needUpdateHighlight=true;}}}}else{if(!isClearAllDisabled){this.applySelection([]);needUpdateHighlight=true;}}if(mstrApp.isDisplayOnMobile){this.sendMessageToMobileDevice("singletap",event,graphicModel);}else{if(needUpdateHighlight){this.updateHighlight();}}},handleContextMenuSelection:function handleContextMenuSelection(event,graphicModel){var isSelectAttr=graphicModel&&graphicModel.isAttributeSelector(),selector=graphicModel&&graphicModel.getSelector();if(this.misMatchWithVisSelection){this.synchronizeToVisSelection();}if(graphicModel&&selector){var isNodeSelected=this.isInSelection(isSelectAttr,selector);if(!isNodeSelected){this.applySelection(selector,{forContextMenu:true},graphicModel);}else{this.synchronizeContextMenuSelection();}}else{this.applySelection([],{forContextMenu:true});}if(mstrApp.isDisplayOnMobile){this.sendMessageToMobileDevice("longpress",event,graphicModel);}else{var menuConfig=this.getContextMenuConfig(graphicModel),commonConfig=menuConfig&&menuConfig.common,customConfig=menuConfig&&menuConfig.custom;if(commonConfig&&customConfig){this.showContextMenu(event,commonConfig,customConfig);}this.updateHighlight();}},isClearAllDisabled:function isClearAllDisabled(){var sc=this.findSelectorControl();return sc&&!sc.showall;},generateIdTitleMapping:function generateIdTitleMapping(){var me=this,rowTitles=$HASH.walk("gridData.gts.row",this),cols=$HASH.walk("gridData.gts.col",this),colTitles=(cols&&cols.length===1)&&(cols[0].otp===-1)&&cols[0].es,idTitleMapping={};me.tooltipObjsInOrder=[];$ARR.forEach(rowTitles,function(title){idTitleMapping[title.id]=title.n;me.tooltipObjsInOrder.push(title.id);});$ARR.forEach(colTitles,function(title){idTitleMapping[title.oid]=title.n;me.tooltipObjsInOrder.push(title.oid);});return idTitleMapping;}});mstrmojo.CustomVisBase.ENUM_EXTERNAL_LIBS=EXTERNAL_LIBS;if($DOM.isTouchOptimizationEnabled()){mstrmojo.mixin(mstrmojo._TouchGestures,mstrmojo.CustomVisBase.prototype);mstrmojo.mixin(mstrmojo.mobile.customviz._CustomVizSupportsTouches,mstrmojo.CustomVisBase.prototype);}}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.vi.ui.rw.xtab._SupportXtabThresholds","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.EnumDragSources","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.fe.FilterUtils","mstrmojo.vi.enums.EnumVisFilterType","mstrmojo.EnumRWUnitType","mstrmojo.models.FormatModel","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.mstr.EnumDSSXMLObjectSubTypes","mstrmojo.ui.editors.controls.ContextualLink","mstrmojo.NumberFormat","mstrmojo.vi.models._DocXtabModelShared");var P=mstrmojo.hash,c=mstrmojo.array,X=mstrmojo.array,p=mstrmojo.models.FormatModel,K=p.ENUM_PROPERTY_NAMES,f=mstrmojo.vi.enums.EnumVisFilterType,O=mstrmojo.EnumRWUnitType,n=mstrmojo.models.template.DataInterface,w=n.ENUM_GRID_RESIZE.FIT_TO_CONTENTS,D=mstrmojo.mstr.EnumDSSXMLObjectTypes,e=mstrmojo.mstr.EnumDSSXMLObjectSubTypes,B=mstrmojo.models.template.DataInterface.getGSI;var I=4;var A=3;var R=[K.GRID_VERTICAL_PADDING,K.GRID_HORIZONTAL_PADDING],a={},U="tp",N="lp";a[K.GRID_VERTICAL_PADDING]=U;a[K.GRID_HORIZONTAL_PADDING]=N;function G(x){return x.docModel.controller.cmdMgr;}function d(AA,AC){var AD=AA.xtab.k,z=AA.docModel,y=z.getSelectedViUnit(),x=y&&y.boxContent,AB=!(x&&x.isInFilterPanel&&x.isInFilterPanel());return[AD].concat(AB?z.getSourceFilterKeys(AD,true):[]);}mstrmojo.vi.models.DocXtabModel=mstrmojo.declare(mstrmojo.DocXtabModel,[mstrmojo.vi.ui._CanDropFromSchema,mstrmojo.vi.ui.rw.xtab._SupportXtabThresholds,mstrmojo.vi.models._DocXtabModelShared],{scriptClass:"mstrmojo.vi.models.DocXtabModel",getGridInfo:function k(x){var z=this.xtab,y=z&&z.gridInfo;return B(y,x);},getUnHiddenDrillPathsForCell:function i(x,AB){var z=this.getAllDrillPathsForCell(x,AB),AA=this.docModel.datasets,y=function(AC,AF){var AD=X.find(AC,"did",AF.id),AE=AC[AD];if(AE&&!AE.hide){AF.n=AE.n;return true;}return false;};return X.filter(z,function(AE){var AC;for(AC in AA){var AD=AA[AC];if(y(AD.att,AE)){return true;}}return false;});},getAllDrillWithinPathsForCell:function Y(x,AA,z){var y=z?this.getUnHiddenDrillPathsForCell(x,AA):this.getAllDrillPathsForCell(x,AA);return y.filter(function(AB){return !!AB.within;});},sort:function q(z,AA){var x=this;G(this).execute({execute:function y(){var AD=x.xtab,AC=AD.k,AF=x.docModel.getDataService(),AB=[{act:"sort",sorts:z.sorts,nodeKey:AC,subTotalsPos:z.stp||x.getSubTotalsPos(),stt:z.stt||-1}],AE=[];AE.push(AF.getUpdateTemplateAction(AC,AB,null,AC));this.submit(AE,AA);}});},customSort:function s(AB,AC,y){var z=this,x=P.clone(AB);G(this).execute({execute:function AA(){var AD=z.xtab.k;this.submit(z.docModel.getDataService().getUpdateTemplateAction(AD,x),AC,y);}});},drillGrid:function b(z,AA){var x=this;G(this).execute({execute:function y(){this.submit(x.docModel.getDataService().getDrillGridAction(z),AA);}});},getZoneFormatAction:function J(AI,AK,AF,AB){var AD=AB&&AB.skipSubtotals,z=AB&&AB.isSubtotalFormat,AH=AB&&AB.isSubtotalUseGridFormatting,AG=[],AA=[],AE="h",x="g",AJ="sh",AC="sg",y=function(AL,AM){AA.push({axis:AL,regions:AM});};if(z){switch(AI){case"ch":y(2,[AJ]);break;case"rh":y(1,[AJ]);break;case"va":y(1,[AC]);y(2,[AC]);break;}}else{switch(AI){case"ch":y(1,[AE]);y(2,!AD&&AH?[AE,x,AJ]:[AE,x]);break;case"rh":y(1,!AD&&AH?[x,AJ]:[x]);break;case"va":this.data.gsi.mx.forEach(function(AL){AG.push({unitId:AL.did,unitType:4,regions:[x]});});if(!AD&&AH){y(1,[AC]);y(2,[AC]);}break;}}return{act:"formatGridZone",nodeKey:AF,props:AK,units:AG,axis:AA};},getRemoveMetricLimitsAction:function l(x){var z=[],AA=[],y=function y(AC,AD){if(!AC){return ;}var AB=AC.nds;if(AB){AB.forEach(function(AF){var AE=AF.m;if(AE!==undefined){AD.push(AE.did);}else{y(AF,AD);}});}};if(x){y(x,z);z.forEach(function(AB){AA.push({act:"removeMetricLimits",unitId:AB});});}return AA;},getAddTemplateUnitAction:function C(AB,AC,z,x){var AA=this._super(AB,AC,z,x),y=d(this,AA);if(y.length>0){AA.partialRetrieval={nodes:y};}return AA;},getRemoveTemplateUnitAction:function m(z){var y=this._super(z),x=d(this,y);if(z.axis!==undefined&&z.unitPos!==undefined){y.axis=z.axis;y.unitPos=z.unitPos;}if(x.length>0){y.partialRetrieval={nodes:x};}return y;},canShowCellMenu:function g(x){return true;},getKeepOnlyActionsForAssociatedNodes:function h(y,AE,AA){var x=this.docModel,AD=[x.getKeepOnlyOrExcludeAction(this.xtab.k,y,this.xtab.k)],z=!!AA?AA:this.xtab,AC=!mstrApp.isInVFConfigMode?(z.getAssociatedNodes&&z.getAssociatedNodes()||[]):[];AE=mstrmojo.func.wrapMethods(AE,{success:function AB(){X.forEach(AC,function(AG){var AF=x.getPanel().getUnitByKey(AG.k);if(AF&&AF.boxContent){AF.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});X.forEach(AC,function(AF){AD.push(x.getKeepOnlyOrExcludeAction(AF.k,y));});return{actions:AD,callback:AE};},addClearAdvQualActions:function o(AH,AG,AF,z){var AC=(AG&&AG.k)||this.xtab.k,AB=AH.gridData||AH.model.data||AH.node.data,x=AB.vfexpr,AD=AB.vlexpr,y=z.indexOf(f.DRILLING),AE=this._clearAdvQualActionsHelper(AH,AG,AF,y),AA=AE(AD,x,AC);if(y>-1&&AA){z.splice(y,1);}return AF;},addClearDrillingActions:function S(AA,AC,z){var x=(AC&&AC.k)||this.xtab.k,AB=AA.gridData||AA.model.data||AA.node.data,AD=AB.vfexpr,y=this._clearDrillingActionsHelper(AA,z);y(AD,x);return z;},getObjectInfo:function E(x){var AA=this.xtab.zonesModel,z=null,y=function(AB){if(AB.did===x){z=AB;return true;}};if(AA){(AA.getDropZones().zones||[]).some(function(AB){return !!AB.items.some(function(AC){if(!AC.cols){return y(AC);}else{return !!AC.cols.some(y);}});});}else{z=this._super(x);}return z;},hasRecursiveAttribute:function j(x){var y=this,z=(x||this.data).gsi||{};return(z.rows||[]).concat(z.cols||[]).some(function(AA){return y.isRecursiveAttribute(AA.did);});},hasSameRecursiveAttributeGroup:function Z(AB,z,y){var x=this.docModel,AD=AB.did,AA=x.getDEObject(AD),AC=(z||this.data).gsi||{};if(this.isRecursiveAttribute(AD)){return X.filterOne((AC.rows||[]).concat(AC.cols||[]),function(AG){var AE=AG.did,AF=x.getDEObject(AE);return X.find(X.ensureArray(y),"did",AE)<0&&(AE!==AD)&&(AA?AA.attId:AD)===(AF?AF.attId:AE);});}return false;},supportsViewFilterActions:function Q(x){var y=this.getObjectInfo(x);return y&&!y.de&&(y.t!==1)&&(y.t!==47||y.st===12033);},getCurrentUnitAxisAndPosition:function t(x){return new mstrmojo.models.template.DataInterface(this.data).getUnitById(x);},getNumberFormatData:function H(){var x=this,y=x.data;return(y.gnf||[]).concat(y.gnfu);},getNumberFormatEditorAcceptCallback:function M(y){var x=this,z=x.xtab;return function(AE){var AC=x.docModel.getNumberFormatAction(y.did,y.t,AE),AB=!!AC.partialRetrieval,AD,AA,AH=[];if(AB){AD=mstrmojo.DocDataService.REQUEST_DEFN_DATA;AA={treesToRender:3};}var AF=z.k,AG=z.controller.dataService();AH.push(AG.getUpdateTemplateAction(AF,AC));z.controller.submitUndoRedoTemplateWithCallback(z,AH,x.docModel.controller._getXtabCallback(z,undefined,AB),AD,AA);};},getAttributeFormsInTemplate:function(z){var x=this.data.gts,y=[];(x.row||[]).concat(x.col||[]).forEach(function(AA){if(AA.id===z&&AA.fs){y=y.concat(AA.fs);}});return y;},getValuesDefaultFormatGridZoneAction:function L(AE,AB){var z={},AL,AJ=this.xtab,AC=AJ&&AJ.gridInfo,y=AC&&AC.fmts,AD=[],AI,AA={};P.forEach(AE,function(AM){AD.push({unitId:AM.did,unitType:I,regions:["g"]});});if(y){var AF=y.va,AH=y.rh,x=y.ch;P.forEach(y.va,function(AN,AM){AI=p.getFormatPropertyInfo(AM);if(AI&&AI.ps!==p.ENUM_PROPERTY_SETS.FORMATTING_NUMBER){z=P.mergeHashes(z,p.getFormatUpdate(AM,(AI.pt==A)?AN:p.decodeValue(AM,AN)));}});var AK=AF[U]?AF:(AH[U]?AH:x),AG;c.forEach(R,function(AM){AI=p.getFormatPropertyInfo(AM);if(AI){AG=AK[a[AM]];z=P.mergeHashes(z,p.getFormatUpdate(AM,p.decodeValue(AM,AG)));}});}AA.skipSubtotals=AB;AL=AJ.model.getZoneFormatAction.call(AJ.model,"va",z,AJ.k,AA);AL.units=[].concat(AD);return AL;},getRAExpandAction:function F(y,AD,AA){var AC=this.getCellTitleInfo(y).title.id,AB=this.docModel.getDEObject(AC),x={act:"raExpandCollapse",sliceId:AD,depth:y.dpt,ordinal:(y.o!==undefined)?y.o:y._ei,id:y._e&&y._e.id,isExpand:AA?1:(y.epd?0:1)},z=d(this);if(AA){x.expand_dsts=1;}x[AB?"deId":"attId"]=AC;if(z.length>0){x.partialRetrieval={nodes:z};}return x;},getRAExpandAllAction:function u(AB,AA){var z=this.docModel.getDEObject(AB),x={act:"raExpandCollapseAll",isExpandAll:AA?1:0},y=d(this);x[z?"deId":"attId"]=AB;if(y.length>0){x.partialRetrieval={nodes:y};}return x;},getCreateCSVizActions:function W(y,z,AP,x){var AF=[],AE=[],AM=this.docModel,AJ=AM.getDataService(),AG=AM.getVizContentPanel(),AD=AG.k,AT=this.xtab,AC=AT.k,AB=AT.parent;AF.push({act:"macroCopyUnit",newKey:AP,unitType:O.GRID,unitKey:AC,toKey:AD,partialRetrieval:{nodes:[AP]}});var AN=AM.clearVisAsFilterAction(AB),AK=AN&&AN.actions;c.forEach(AK,function(AU){if(!AU.controlKey){AU.nodeKey=AP;AF.push(AU);}});var AI=AB.parent.children,AH,AA=AT.getFilterType()===1;c.forEach(AI,function(AW){if(c.find(AW.defn&&AW.defn.an,"k",AC)!==-1){AF.push({act:"associateNodes",nodeKey:AW.k,targetKeys:[AP]});var AV=AW.boxContent.selectorControl;if(AV){var AU=AX===undefined||AA,AX=AU?AM.getNextKey():AX;AF.push({act:"addVisToFilter",parentKey:AC,targetKey:AP,ctrlKey:AV.ckey,newCGB:AU,cgbKey:AX});}}});c.forEach(AI,function(AV){var AU=AV.defn,AW=(AU&&AU.tks||"").split("\u001E");c.forEach(AW,function(AX){if(AX===AC){var Ab=AU.ck,Aa=AU.srct,AY=AU.srcst,Ac=(Aa===D.Consolidation&&AY!==e.ConsolidationManaged)||Aa===D.Filter;if(AV.isAMSelector&&AV.isAMSelector()){return ;}var AZ=AJ.getAddCtrlTargetAction(Ab,AP,AP,Ac);AF.push(AZ);}});});var AO=this.data,AQ=AO.gsi,AR=this,AL=function(AU,AV){c.forEach(AU,function(AX,AW){if(AX.did==="-1"){c.forEach(AQ.mx,function(Ab,AZ){var Aa=P.copy(Ab);Aa.axis=-1;Aa.unitPos=AZ+1;AE.push(AR.getRemoveTemplateUnitAction(Aa));});}else{if(AX.did!==y.id){var AY=P.copy(AX);AY.axis=AV;AY.unitPos=AW+1;AE.push(AR.getRemoveTemplateUnitAction(AY));}}});};AL(AQ.rows,1);AL(AQ.cols,2);if(z===2){AE.push(this.getPivotUnitAction(1,0,y.id,12,2,0));}AE.push({act:"advancedProperties",props:{"Template Formatting":{ShowColumnHeaders:"-1",LockColumnHeaders:"-1"}}});var AS=new n(AO);if(AS.getColResizeScenario()!==w){AE.push({act:"changeXtabColWidthScenario",value:w});}if(x){AE=AE.concat(x);}c.forEach(AE,function(AU){delete AU.partialRetrieval;});AF.push(AJ.getUpdateTemplateAction(AP,AE));return AF;},});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(190,1388,3224,5188,11806,12287,13295,13296,13624,13625,14003,14655,14656,14717);var H=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.vi.ui.DatasetUnitMenuUtils,I="-1",D=mstrmojo.mstr.EnumDSSXMLBaseFormType,J=mstrmojo.vi.enums.EnumFeatures,F=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.vi.models.TemplateBasedDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{enableRAEntries:true,getClearAllUnitsActions:function G(){var L=[],K=this.getHost().model;this.getDropZones().zones.forEach(function(M){var N=M.id;M.items.forEach(function(P,O){if(P.did!==I){L.push(K.getRemoveTemplateUnitAction(C.copy(P,{axis:N,unitPos:O+1})));}});});return L;},getMultiUnitsMenuItems:function B(L,K,M){var N=this.id;if(!mstrApp.isInVFConfigMode&&E.getMultiSelectionShortcutMetricFunctions(M).length&&mstrmojo.resolveFeature(J.INSERT_NEW_METRIC)){L.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[N].getMultipleMetricsCalcMenus(K,M,false);});L.addSeparator();}L.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[N].deleteItems(K,M);});},getExtraUnitMenuItems:function A(L,K,N,M){},getUnitMenuItems:function A(P,d,b,c,Z){if(!b){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var W=d.items,L=this.getHost(),a=W.length,N=d.id,Q={zone:d,axis:N,idx:H.indexOf(W,b),cnt:a,item:b,metricsAxis:(this.getHost().gridInfo||{}).tma,useDropzone:Z?Z:false},g=this,X=this.id,M=b.did===I,R=(b.t===F.Consolidation&&b.st===12033),h=mstrApp.isInVFConfigMode,O=mstrmojo.resolveFeature(J.INSERT_NEW_METRIC),Y=this.docModel,e=b.did,K=(L&&(typeof L.getNdeInfosOfGrid==="function")&&L.getNdeInfosOfGrid())||[];if(R&&!h){P.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",function(){var i={otp:b.t,id:e,n:b.n,axis:d.id,ui:Q.idx};L.derivedElementsEdit(i);});P.addSeparator();}if(!M){if(L.model.isRecursiveAttribute(b.did)&&this.enableRAEntries){P.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){var i={id:b.did};L.raExpandAll(i,true);});P.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){var i={id:b.did};L.raExpandAll(i,false);});P.addSeparator();}if(this.supportWebSort()){this.addSortMenu(Q,P,true,K);}P.addSeparator();if(b.t===F.Metric&&!h){if(O){if(b.um){P.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){g.editDerivedMetric(Q);},Q);P.addSeparator();}if(Y.findDatasetIdFromUnit(e)&&!Y.isFromSolrCube(e)&&!Y.isFromMDXCube(e)){P.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",X,g.getAggregateByMetricSubMenu,Q);P.addSeparator();}P.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),X,g.getCalculationEditorCfg,Q);P.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",X,g.getShortcutMetricSubMenu,Q);P.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){g.newDerivedMetric(Q);},Q);}}if(b.t===F.Attribute){var U=b.did||"",S=U?E.getDatasetFromAttributeId(this.docModel.datasets,U):null,f=this.isDynamicLink(b);if((!S||!this.docModel.isMDXDataset(S))&&!h){if(b.da){P.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){g.editDerivedAttribute(Q);},Q);P.addSeparator();}if(((!S)||!E.isCGorCon(b,S))&&!f&&O){P.addMenuItem(mstrmojo.desc(13625,"New Attribute..."),"",function(){g.newDerivedAttribute(Q);},Q);P.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){g.newDynamicLinkAttr(Q);},Q);}}if(!h&&!E.hasOldDEOverDatasets(b.did,this.docModel.datasets)&&!f&&b.st!==3076){P.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",function(){var i={otp:b.t,id:b.did,n:b.n,axis:d.id,ui:Q.idx};L.derivedElementsEdit(i);});}}this.getExtraUnitMenuItems(P,d,b,Q);P.addSeparator();if(g.hasReplaceCandidates(Q)&&(!(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation())||!!mstrmojo.resolveFeature(J.WEB_DRILL_AND_LINK))){P.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",X,g.getReplaceSubMenu,Q);}P.addMenuItem(mstrmojo.desc(1388,"Rename"),X,function(){mstrmojo.all[X].renameItem(c,b);});P.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[X].deleteItem(d,Q.idx);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.hash;mstrmojo.vi.models.AMSelectorDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.AMSelectorDropZones",getHostModel:function H(){return this.getHost().selectorModel.data;},getHost:function J(){var K=this._super();return K.parent;},getDropZones:function I(){var L=this.getHost(),K=[this.getZone(mstrmojo.desc(2870,"Objects"),1,L.objects,false,{title:mstrmojo.desc(16873,"Add attributes or metrics here"),})];this.dropZones=K;return{n:this.getHost().defn.ttl,zones:K};},getAllowDropInfo:function F(P,N,R,M,K){var L=this._super(P,N,R,M,K),S=this.getHost(),Q={edge:M},O=S.getAllowedDragItems(K,Q);return B.copy({allowedItems:O},L);},unitsDropped:function D(K,L,M){var N=this.getHost();N.dropFromDataSource(L,M);},deleteItem:function C(L,K){var M=this.getHost();M.objects.splice(K,1);M.getUpdateCandAction();},deleteItems:function E(K,L){var M=this.getHost();M.objects.splice(L[0]._renderIdx,L.length);M.getUpdateCandAction();},getUnitMenuItems:function A(L,K,O,M){var N=this;L.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){N.deleteItem(K,N.getUnitIndexInZone(K,O));});},addUnitsFromDataSource:function G(K,M){var L=this.getHost();L.dropFromDataSource({getCtxtDragData:function(){return{items:K};}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.FilterBoxInlineDialog","mstrmojo.Label","mstrmojo.css","mstrmojo.func","mstrmojo.hash","mstrmojo.array","mstrmojo.DocSelector","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.models.AMSelectorDropZones","mstrmojo.vi.ui.rw.FilterBox","mstrmojo.EnumRWUnitType");var D=mstrmojo.css,Z=mstrmojo.array,i=mstrmojo.func,M=mstrmojo.hash,C="\u001E",O="amselector_default",K={n:mstrmojo.desc(4897,"Default"),t:18,v:O},G=mstrmojo.vi.ui.rw.FilterBox.AMSelectorCtrlOverLay,f=mstrmojo.EnumRWUnitType,E=mstrmojo.DocDataService.REQUEST_DEFN_DATA,F=mstrmojo.mstr.EnumDSSXMLObjectTypes,Q=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;function J(n){return n&&n.did!=="-1"&&n.t!==14;}function c(n){return n&&n.t===F.Metric;}function H(n){return !c(n);}mstrmojo.vi.ui.rw.AMSelectorBox=mstrmojo.declare(mstrmojo.vi.ui.rw.FilterBox,null,{scriptClass:"mstrmojo.vi.ui.rw.AMSelectorBox",isAllGrid:true,objects:[],replaceRelation:{},tmp_replaceRelation:{},isAttrSelector:undefined,allowFilters:false,init:function j(p){this._super(p);var o,q,n=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if((n||mstrConfig.resolveOnly)&&this.defn.elms){o=M.walk("defn.elms",this);q=M.walk("defn.ces",this);}else{o=M.walk("selectorModel.data.elms",this);q=M.walk("selectorModel.data.ces",this);}this.constructRelation(o,q);D.addWidgetCssClass(this,"mstrmojo-AMSelectorBox");},constructRelation:function Y(n,q){var t=this;this.replaceRelation={};this.tmp_replaceRelation={};this.objects=[];this.isAttrSelector=undefined;var x=this.model.getCGBMap();M.forEach(this.defn.cgb,function(y){var z=t.model.getLayoutUnitDefn(y);if(z){t.replaceRelation[x[y]]={id:z.replace_object,tp:z.replace_object_type};t.isAttrSelector=z.replace_object_type!==4;}});var o=M.walk("defn.tks",this);this.isAllGrid=!(o&&o.split(C).some(function(y){var z=t.model.getLayoutUnitDefn(y);return z.t!==f.GRID;}));if(n&&n.length){var p=this.model.datasets,u=[],s,w=n.filter(function(y){return y.did!==O;});t.isAttrSelector=w[0].v[0]!=="i";M.forEach(p,function(z){var y=t.isAttrSelector?z.att:z.mx;u=u.concat(y);});Z.forEach(w,function(y){Z.forEach(u,function(z){if(y.did===z.did){s=M.clone(z);s.n=y.n;t.objects.push(s);return false;}});});}},hasTargets:function U(){return !M.isEmpty(this.replaceRelation);},getSelectorSource:function b(){return Z.map(this.objects,function(n){return n.did;});},selectorHasSource:function m(){return this.objects.length;},getZonesModel:function L(){return this.boxContent.zonesModel;},warnClearTargets:function B(p,q,s){var o=mstrmojo.desc(16877,"This selector was used to replace ##. Add ### in this selector will clear all the selected targets. Targets need to be reselected to replace ###.").replace("##",this.isAttrSelector?"attributes":"metrics").replace(/###/g,this.isAttrSelector?"metrics":"attributes");var n=[];var t=this;n.push(mstrmojo.Button.newWebButton(mstrmojo.desc(2544,"Continue"),function(){var u=t.defn,w=t.defn.tks.split(C),x=t.model.getDataService();q.actions=[].concat(w.map(function(y){return x.getRemoveCtrlTargetAction(u.ck,y,y,false);}));t.updateCandidates(p,q,s,E);},true));n.push(mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){if(mstrApp.isSingleTier){window.FormWrapper.closeWindow("{}");}}));mstrmojo.warn(o,{},{buttons:n});},allowDropFromDataset:function R(n){return mstrApp.allowWebDashboardDesign()&&this.getAllowedDragItems(n).length;},getAllowedDragItems:function a(n,o){var q=n.getCtxtDragData(),p=(q.items||[]).filter(J);if(p.length){if(this.objects.length===0){return p.filter(c(p[0])?c:H);}if(this.objects.length===1&&o&&o.edge===Q.ON){return p.filter(c(p[0])?c:H);}if(this.isAttrSelector===undefined){this.isAttrSelector=!c(p[0]);}if(this.isAttrSelector){return p.filter(H);}else{return p.filter(c);}}return[];},dropFromDataSource:function k(o,p){var n=this.getAllowedDragItems(o,p);if(n.length){if(!M.isEmpty(this.replaceRelation)&&this.isAttrSelector===c(n[0])&&(this.objects.length===1&&p&&p.edge===Q.ON||this.objects.length===0)){this.warnClearTargets(n,o,p);}else{this.updateCandidates(n,o,p);}}},updateCandidates:function X(n,o,q,p){this.updateObjects.call(this,n,q);this.getUpdateCandAction.call(this,o,p);},updateObjects:function I(o,p){var s=this;this.isAttrSelector=!c(o[0]);var t=o.map(function(u){Z.forEach(s.objects,function(w,x){if(w.did===u.did){s.objects.splice(x,1,{});return false;}});return u;});if(p){var n=p.idx,q=p.edge;switch(q){case Q.ON:this.objects.splice(n,1);Z.forEach(t,function(w,u){s.objects.splice(n+u,0,w);});break;case Q.BELOW:Z.forEach(t,function(w,u){s.objects.splice(n+1+u,0,w);});break;case Q.ABOVE:Z.forEach(t,function(w,u){s.objects.splice(n+u,0,w);});break;}}else{this.objects=this.objects.concat(t);}this.objects=this.objects.filter(function(u){return !M.isEmpty(u);});},getUpdateCandAction:function S(o,u){var n=this.id,x=this.getDocModel(),AA=x.getDataService(),p=this.defn,s=this.getTargetKeys(),q=[this.k].concat(s),t=this.boxContent,y=this.objects.map(function(AC){return{id:AC.did,tp:AC.t};}),w=(o&&o.actions||[]).concat([AA.getSetCandidateObjectsAction(p.ck,y)]).concat(this.getFormatRelatedActions()),AB=i.wrapMethods(o&&o.callback,{success:function(AD){var AC=mstrmojo.all[n];x.partialUpdate(AD.data,x.getTargetDefn(q.join(C)),AD.defn,[t.defn.ckey]);if(AC){x.selectVIUnit(n,true);AC.boxContent.set("visible",true);AC.generateToolbar();if(!AC.selectorHasSource()){AC.showControlOverlay(G);}}}});var z=mstrApp.isAppStatePause&&mstrApp.isAppStatePause();if(z){u=E;}x.controller.submitUndoRedoUpdates(w,null,AB,u);},dropFromDataset:function N(n){this.dropFromDataSource(n);},dropFromAllObjects:function h(n){this.augmentDropContextForSchema(n,this.getDocModel());this.dropFromDataSource(n);},validateTarget:function A(n,o,p){return this.id===p;},setTargets:function W(n){this.getDocModel().changeFilterTargets(this,this.getTargetKeys(),n,false,true);},getPanelForAddAction:function d(){return"editPanel";},getExcludedPanels:function l(){return[];},getEditorPanelContents:function g(o,p,n){return this.getEditorPanelContentsBase(o,p,n);},getTemplateKey:function P(){return this.k;},updateAriaLabel:function e(){var n=this.title+", "+mstrmojo.desc(4728,"Selector");if(n!==this.ariaLabel){this.set("ariaLabel",n);}}});mstrmojo.vi.ui.rw.AMSelectorBox.boxConfiguration={f:{h:150,v:42},o:"v"};mstrmojo.vi.ui.rw.AMSelectorBox.DefaultV=O;mstrmojo.vi.ui.rw.AMSelectorBox.DefaultOption=K;mstrmojo.vi.ui.rw.AMSelectorBox.DefaultOptionElm=M.copy(K,{did:O});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var I=mstrmojo.array,C=mstrmojo.hash,M="-1",P=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;function O(){var Q=this.getHostModel();return Q?Q.gsi:null;}function L(a,X,U,Z,Q){var b=this.getHost(),W=b.controller,S,Y;S=a.did;Y=a.t;if(Q){var R=this.getUnitIndexInZone(X,a);if(R!==-1){if(R<Z){Z--;}}}W.submitUndoRedoUpdates(this.getUpdateTemplateAction([b.model.getPivotUnitAction(U,Z,S,Y)]),null,mstrmojo.func.wrapMethods(W._getXtabCallback(b),this.getUpdateCallback()));}function J(U){var e=U.item,Z=U.zone,Q=U.dsid,c=U.index,R=U.edge,b=U.isPivot;var f=this.getHost(),Y=f.controller,d=Z.items,X=f.model,S=Z.id,W=[];if(d.length){if(R===P.ON){var a=d[c];W.push(X.getRemoveTemplateUnitAction(a));}else{if(R===P.BELOW){c++;}}}else{c=0;}if(b&&R!==P.ON){L.call(this,e,Z,S,c,true);return ;}W.push(X.getAddTemplateUnitAction(e,Q,S,c));Y.submitUndoRedoUpdates((U.actions||[]).concat(this.getUpdateTemplateAction(W)),null,mstrmojo.func.wrapMethods(Y._getXtabCallback(f),this.getUpdateCallback()));}function K(Q){return Q.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}mstrmojo.vi.models.BaseVisDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{scriptClass:"mstrmojo.vi.models.BaseVisDropZones",addZoneItem:function A(S,U,R){var W=R.mx,Q;if(S.did===M){I.forEach(W,function(X){Q={did:X.did,n:X.n,t:4};U.push(Q);});}else{this._super(S,U);}},getDropZones:function N(){var Q=O.call(this),R=this.getHost();return Q?{n:R.defn.ttl,zones:[this.getZone(mstrmojo.desc(3581,"Attributes"),1,Q.rows,false,{mx:Q.mx,title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(3582,"Metrics"),-1,Q.mx,false,{mx:Q.mx,title:mstrmojo.desc(13827)})]}:{n:R.defn.ttl,zones:[]};},getAvatarIconClass:function G(){return"viXtab";},getAllowDropInfo:function F(R,S,Q,W,U){var Y=this._super(R,S,Q,W,U),X=R.id===-1;return C.copy({allowedItems:Y.allowedItems.filter(function(a){var Z=a.t===4;return X?Z:!Z;})},Y);},unitsDropped:function E(Q,S,U,X,W){var R=U.allowedItems[0];J.call(this,{item:R,zone:Q,dsid:S.src.data.dsid,index:U.idx,edge:U.edge,isPivot:K(S),actions:S.actions});},deleteItem:function B(R,Q){this.deleteItems(R,[R.items[Q]]);},deleteItems:function D(R,S){var U=this.getHost(),Q=U.controller,W=[];(S||[]).forEach(function(X){W.push(U.model.getRemoveTemplateUnitAction(X));});if(W.length){Q.submitUndoRedoUpdates(this.getUpdateTemplateAction(W),null,mstrmojo.func.wrapMethods(Q._getXtabCallback(U),this.getUpdateCallback()));}},getExtraUnitMenuItems:function H(R,Q,U,S){this._super(R,Q,U,S);if(U.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric&&this.getHost().showThreshold){R.addSeparator();this.buildThresholdMenuOptions(R,{item:U},true);}},getHostModel:function(){return this.getHost().model.data;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.models.DocXtabModel","mstrmojo.EnumRWUnitType");var C=mstrmojo.array,B=mstrmojo.hash;var F="Metrics",D=2,H="\u001E",E="\u001F";mstrmojo.vi.models.DocVisModel=mstrmojo.declare(mstrmojo.vi.models.DocXtabModel,null,{scriptClass:"mstrmojo.vi.models.DocVisModel",getHMSelecAttrElemIdsInfo:function(R){var Q=R[0],L=Q.tid,N=Q.tids,M=Q.selections,K={},S=[],P=this.scm,O=(L&&P&&P[L]);C.forEach(M,function(W){var U=(W&&W.length)||0,X=U>0?W[U-1]:{},Y=X.tid;if(P[Y]){if(!K[Y]){K[Y]=[];}K[Y].push(X.eid);}});B.forEach(K,function(U){S.push(U.join(H));});if(O&&O.showall&&S.length===0){C.forEach(N,function(U){S.push("OA:(All)");K[U]=[];});}return{eids:S.join(E),tids:Object.keys(K)};},getSelectedAttributeElementIdStr:function(S){var R=S[0],K=R.tid,L,M=R.selections,N=[],P=[];C.forEach(M||[],function(U){N=N.concat(C.filter(U,function(W){return W.tid===K;}));});N=C.distinct(N,"eid");(N||[]).forEach(function(U){P.push(U.eid);});L=P.join(H);var Q=this.scm,O=(K&&Q[K]);if(O&&O.showall&&P.length===0){L="OA:(All)";}return L;},getHMAction:function A(a){var Z=a[0],N=Z&&Z.at,R=Z.anchor,M=Z.selections,X=this.scm,K=[],O=[],Q=[],b=[],S,U,Y,L,W,P;W=this.getHMSelecAttrElemIdsInfo(a);L=W.eids;if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)&&X){C.forEach(W.tids,function(d){var c=X[d];if(c){K.push(c);O.push(c.ck);Q.push(c.ckey);b.push(c.tks);}});S=O.join(E);U=Q.join(E);Y=b.join(H);if(K.length&&L!==""){P={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:R,ck:S,tks:Y,eid:L,ctlKey:U,sliceId:this.xtab.sid,isUConDS:K[0].isUConDS,isDocVis:true}};}}return P;},getDrillWithinActionsForAssociatedNodes:function G(K,L,Q,R){var O=this,U=this.docModel,M=[U.getDataService().getDrillGridAction(this.getDrillAction(this.xtab.k,L,K))],S=!!R?R:this.xtab,N=!mstrApp.isInVFConfigMode?(S.getAssociatedNodes&&S.getAssociatedNodes()||[]):[];Q=mstrmojo.func.wrapMethods(Q,{success:function P(){C.forEach(N,function(X){var W=U.getPanel().getUnitByKey(X.k);if(W&&W.boxContent){W.boxContent.raiseEvent({name:"regenerateToolbar"});}});}});C.forEach(N,function(W){M.push(U.getDataService().getDrillGridAction(O.getDrillAction(W.k,L,K)));});return{actions:M,callback:Q};},getDrillAction:function I(L,N,K){function M(S){var R=[];for(var Q=0,O=S.length;Q<O;Q++){var W=S[Q];for(var P=0,X=W.length;P<X;P++){var U=W[P];if(mstrApp.useBinaryFormat){R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}else{R.push(U.axis+"A"+(U.ui+1)+"A"+U.o);}}}return(mstrApp.useBinaryFormat)?R:R.join(",");}return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,nodeKey:L,retainParent:K.retainParent||"",isWithin:K.drillPath.within,drillPathKey:K.drillPath.k,drillPathIndex:K.drillPath.dpi,drillElements:M(N)};},getAction:function J(U){var S=U[0],N=S&&S.at,P=S.anchor,K=S.tid,L,O,M=S.selections;L=this.getSelectedAttributeElementIdStr(U);if(M.length!==0&&L===""){return null;}if(N&&((N&D)>0)){var R=this.scm;var Q=(K&&R[K])||R[F];if(Q&&L!==""){O={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:P,ck:Q.ck,tks:Q.tks,eid:L,ctlKey:Q.ckey,sliceId:this.xtab.sid,isUConDS:Q.isUConDS,isDocVis:true}};}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.CustomVisBase","mstrmojo.ui.CheckList","mstrmojo.ui.editors.controls.Stepper","mstrmojo.NumGroupStepperContentProvider","mstrmojo.gm.GMEnums","mstrmojo.FormatControlHelper","mstrmojo.CustomVisUtility","mstrmojo.customviz.CustomVisEnums");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","ComboBox","PreviewButton","CharacterGroup","FillConfigGroup","LineConfigGroup");var Z=mstrmojo.emptyFn,R=mstrmojo.array,H=mstrmojo.hash,g=R.ensureArray,S=mstrmojo.Button.newWebButton,W=mstrmojo.FormatControlHelper,U=mstrmojo.CustomVisUtility,F=mstrmojo.customviz.CustomVisEnums,A=F.ENUM_LEGEND_PROPS,c="30%",d="70%";function a(m,o){var n=null,p;if(typeof o==="number"){R.forEach(m,function(s,q){if(!p){n=q;}else{if((o-s.value)*(o-p.value)<=0){n=Math.abs(o-s.value)<Math.abs(o-p.value)?q:q-1;return false;}}p=s;});}else{if(typeof o==="string"){R.forEach(m,function(s,q){if(s.value.toString()===o){n=q;return false;}});}}return n;}function L(m){return g(m).map(function(n){return{n:n.name,v:n.value};});}function B(o,p,m){var n=this.getHost();n.savePropertyAndUpdateWidget(o,p,m);}function J(n,m){n.set("enabled",!m.disabled);var o=g(m.items);if(o.length>0&&n.getChildControl instanceof Function){o.forEach(function(p){var s=n.getChildControl(p.childName),q=p.disabled;if(s&&q!==undefined){s.set("enabled",!q);}});}}function f(m,p,o,n){m.forEach(function(t,s){t.slot="col"+(s+1)+"Node";});n=H.copy(n,{col1Width:p,col2Width:o,children:m});var q=new mstrmojo.ui.editors.controls.TwoColumnContainer(n);J(q,n);return q;}function e(s){var p=this,o=p.getHost(),m=s.propertyName,n=a.call(this,s.items,o.getProperty(m));var q=this.getPulldown(L(s.items),function(t){B.call(p,m,t,s.config);},n||0);J(q,s);return q;}function k(n,m){var o={};if(m){n.forEach(function(q,p){var s=m[q.propertyName];if(U.parseBoolean(s)){o[p]=true;}});}return o;}function Q(t){var o=this,n=o.getHost(),m=t.propertyName,q=n.getProperty(m),s=U.parseBoolean(q);var p=this.getCheckboxAndLabel(s,t.labelText,function(u){B.call(o,m,u.toString(),t.config);});J(p,t);return p;}function h(n,m,s){var t=this,w=t.getHost(),p=n.propertyName,q=g(n.items).map(function(x){return{n:x.labelText,propertyName:x.propertyName};});var u={items:q,multiSelect:n.multiSelect,selectedIndices:k(q,w.getProperty(p)),postselectionChange:function(x){var AA=x.added,AB=this.items[AA?AA[0]:x.removed[0]],z=!!AA,y=H.clone(w.getProperty(p))||{};if(this.multiSelect){y[AB.propertyName]=z.toString();}else{this.items.forEach(function(AC){y[AC.propertyName]=(AC===AB?z:!z).toString();});}B.call(t,p,y,n.config);}};H.copy(s,u);var o=new m(u);J(o,n);return o;}function D(m){return h.call(this,m,mstrmojo.ui.ButtonBar,{showIcon:false});}function G(m){return h.call(this,m,mstrmojo.ui.CheckList,{cssClass:"selectors",orientation:m.orientation});}function E(o){var n=this,m=[];R.forEach(o,function(p){m.push(K.call(n,p));});return m;}function O(m){return new mstrmojo.Label({text:m});}function I(t){var q=this,p=q.getHost(),m=t.propertyName,n=t.config;var o={value:p.getProperty(m),onValid:function(){B.call(q,m,this.value,n);}};var s=new mstrmojo.ui.editors.controls.ValidationTextBox(o);J(s,t);return s;}function l(s){var p=this,o=p.getHost(),m=s.propertyName;var n={provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,value:Number(o.getProperty(m))||s.min||0},min:s.min,max:s.max,container:this,onTraverse:function(){B.call(p,m,this.curVal,s.config);}})};var q=new mstrmojo.ui.editors.controls.Stepper(n);J(q,s);return q;}function C(s){var p=this,o=p.getHost(),m=s.propertyName;var n={selectedValue:o.getProperty(m),items:L(s.items),isHostedWithin:false,postselectedValueChange:function(t){B.call(p,m,t.value,s.config);}};var q=new mstrmojo.ui.editors.controls.ComboBox(n);J(q,s);return q;}function Y(o){var n=this.getHost().id;var m=new mstrmojo.Button(mstrmojo.Button.newWebButton(o.labelText,function(){if(typeof o.callback==="function"){o.callback.call(mstrmojo.all[n]);}},o.isHotButton));J(m,o);return m;}function X(q,u,p,t){var o=q.style,s=q.propertyName,m=mstrmojo.vi.models.editors.CustomVisEditorModel.WIDGET_TYPE,n=/^[a-z A-Z\u4e00-\u9fa5:]{1}([\w]|[\u4e00-\u9fa5]|[-.:_]){1,}$/;if(o&&q.style!==m.TWOCOLUMN&&q.style!==m.EDITORGROUP){if(!!s&&p.indexOf(s)!==-1&&u.indexOf(s)===-1){u.push(s);}else{if(!!s&&p.indexOf(s)===-1){p.push(s);}}if(!n.test(s)&&t.indexOf(s)===-1){t.push(s);}return ;}else{if(o&&(q.style===m.TWOCOLUMN||q.style===m.EDITORGROUP)){X(g(q.items),u,p,t);}}R.forEach(q,function(w){X(w,u,p,t);});}function K(t){var s=this.getHost();switch(t.style){case P.TWOCOLUMN:var o=g(t.items),q=o[0],n=o[1],p,m;p=(q&&q.width)||c;m=(n&&n.width)||d;return f.call(this,E.call(this,o),p,m,t);case P.PULLDOWN:return e.call(this,t);case P.LABEL:return O.call(this,t.labelText);case P.BUTTONBAR:return D.call(this,t);case P.CHECKBOXANDLABEL:return Q.call(this,t);case P.CHECKLIST:return G.call(this,t);case P.TEXTBOX:return I.call(this,t);case P.STEPPER:return l.call(this,t);case P.COMBOBOX:return C.call(this,t);case P.CHARACTERGROUP:return W.getCharacterGroupControl(s,t);case P.FILLGROUP:return W.getFillGroupControl(s,t);case P.LINEGROUP:return W.getLineGroupControl(s,t);case P.COLORBYGROUP:return W.getColorByGroupControl(s,t);case P.BUTTON:return Y.call(this,t);}}function j(n){var o=this,m=[];R.forEach(g(n),function(p){m.push(K.call(o,p));});return m;}function M(q,n){var m=[],o,p=this;R.forEach(q,function(s){o=g(s.items);switch(s.style){case"EditorGroup":if(o&&o.length){m.push(p.getEditorGroup(j.call(p,o)));}break;default:m.push(K.call(p,s));}});this.replaceChildControls(n,m);}function i(q){var t,m,p,s={},o=-1,n=function(w,u){R.forEach(w,function(z){var x=z.style,y=z.propertyName;if(x){if(x===P.TWOCOLUMN||x===P.EDITORGROUP){n(z.items,u);}else{if(x===P.COLORBYGROUP){o=u;}else{if(!!y){s[y]=u;}}}}});};for(p=0;p<q.length;p++){t=q[p];m=t&&t.v;n(m,p);}this.propertyPanelIdxMap=s;this.colorbyGroupPanelIdx=o;}function N(q){var t=this,s=t.getHost(),p=F.LEGEND_PROPERTY_SET,o=s.getLegendProperty(A.SHOW_LEGEND),m=s.getLegendProperty(A.LEGEND_WIDTH_SCALE),n=[],u;u=this.getCheckboxAndLabel(o,mstrmojo.desc(13600,"Show legend"),function(w){s.saveObjectProperty(p,A.SHOW_LEGEND,w.toString());});n.push(u);n.push(K.call(this,{style:P.CHARACTERGROUP,propertyName:p,disabled:!o}));n.push(K.call(this,{style:P.LABEL,labelText:mstrmojo.desc(13601,"Fill:")}));n.push(K.call(this,{style:P.FILLGROUP,propertyName:p,disabled:!o}));n.push(K.call(this,{style:P.BUTTON,labelText:mstrmojo.desc(16685,"Reset Width"),callback:function(){s.saveObjectProperty(p,A.LEGEND_WIDTH_SCALE,undefined);},disabled:!o||m===undefined}));this.replaceChildControls(q,[this.getEditorGroup(n)]);}mstrmojo.vi.models.editors.CustomVisEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.CustomVisEditorModel",getTargetPulldownItems:function b(s){var o=this._super(s),t,u=this,AB=this.getHost(),w=[],m=[],x=[],q=[],AA,y;t=L(this.getCustomProperty());R.forEach(t,function(AC){if(!!AC.v){w=w.concat(AC.v);}});if(!!w.length){X(w,m,x,q);}AA=m&&m.length;y=q&&q.length;if(AA||y){var z="The following property name are repeated: ##.",n="The following property name are invalid: **.",p=(AA&&y)?z+n:(AA?z:n);mstrmojo.warn(mstrmojo.desc(null,p).replace("##",m).replace("**",q),{},{buttons:[S(mstrmojo.desc(1442,"OK"),mstrmojo.emptyFn)]});}else{if(t.length){o=(g(o)).concat(t);R.forEach(o,function(AC){if(AC.v){AC.h=M.bind(u,g(AC.v),s);}});i.call(this,o);}}if(AB.enableLegend&&!U.isInPauseMode()&&AB.hasColorByOrSizeBy()){o.push({n:mstrmojo.desc(2403,"Legend"),v:"CATEGORIES_LEGEND",h:N.bind(this,s)});this.propertyPanelIdxMap[F.LEGEND_PROPERTY_SET]=o.length-1;}return o;},getCustomProperty:Z});var P=mstrmojo.vi.models.editors.CustomVisEditorModel.WIDGET_TYPE={PULLDOWN:"PullDown",BUTTONBAR:"ButtonBar",CHECKLIST:"CheckList",STEPPER:"Stepper",COMBOBOX:"ComboBox",TEXTBOX:"TextBox",CHECKBOXANDLABEL:"CheckBoxAndLabel",EDITORGROUP:"EditorGroup",TWOCOLUMN:"TwoColumn",LABEL:"Label",CHARACTERGROUP:"CharacterGroup",FILLGROUP:"FillGroup",LINEGROUP:"LineGroup",COLORBYGROUP:"ColorByGroup",BUTTON:"Button"};mstrmojo.vi.models.editors.CustomVisEditorModel.ENUM_LINE_STYLE=mstrmojo.gm.EnumCombinedLineStyle;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.BaseVisDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.util.ThresholdUtils","mstrmojo.CustomVisUtility","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var n=mstrmojo.array,a=mstrmojo.hash,AH=mstrmojo.func,AA=mstrmojo.vi.ui.DatasetUnitMenuUtils,o=mstrmojo.vi.models.EnumDragSources,z=mstrmojo.emptyFn,y="-1",AG=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,h=mstrmojo.vi.viz.EnumDSSDropZones,x=mstrmojo.vi.viz.EnumWidgetTypes,O=mstrmojo.vi.util.ThresholdUtils,A=mstrmojo.CustomVisUtility.error,P=mstrmojo.CustomVisUtility.warn;var AC=0,M=1,G=2,t=3;var d={ATTRIBUTE:":ATTR",METRIC:":METR"};var F=["XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy","AdditionalMetrics","Angle","Grouping","GeoAttribute","Layout","FromItem","ToItem","ItemSize","Latitude","Longitude","Metric","Trend"];function Q(AN){var AO={Angle:"AngleBy",Grouping:"Grp",GeoAttribute:"Geo",Layout:"layout",FromItem:"from",ToItem:"to",ItemSize:"itemsz",Latitude:"Lat",Longitude:"Long",Metric:"metric",Trend:"trend"};if(AO.hasOwnProperty(AN)){return AO[AN];}return AN;}function K(AN){return AN===-1||AN===h.Rows||AN===h.Columns;}function B(){var AQ=[],AN=this.getHost().model,AP=this.getHostStructure(),AO=[{n:"rows",axis:h.Rows},{n:"cols",axis:h.Columns},{n:"mx",axis:-1}];n.forEach(AO,function(AR){n.forEach(AP[AR.n],function(AT,AS){if(AT.did!==y){AQ.push(AN.getRemoveTemplateUnitAction(a.copy(AT,{axis:AR.axis,unitPos:AS+1})));}});});return AQ;}function AL(AO){var AN=false;n.forEach(this.getCustomDropZones(),function(AQ,AS){var AR=F[AS],AP=h[AR];if(AO.id===AP){AN=!!AQ.isColorBy;return false;}});return AN;}function p(AN,AO){return AL.call(this,AN)&&this.isMetric(AO);}function AF(AT,AS,AP){var AU=this.getHost(),AV=AS&&AS[0],AQ,AN,AO,AR=false;if(p.call(this,AT,AV)){AQ=this.getDefaultThresholdColorsAndBands();if(AQ){AN=AQ.colors;AO=AQ.bands;if(!n.isArray(AN)||!n.isArray(AO)){A("Type of threshold colors and bands should be Array!");AR=true;}if(AO.length!==AN.length-1){A("The length of threshold bands should be equal to the length of threshold colors - 1");AR=true;}}if(AR){AN=undefined;AO=undefined;}O.addThresholds(AU.model,AU,AU.node,AV,AP,AN,AO);}}function AB(AW,AV,AX,AO,AT){var AY=this.getHost(),AS=AY.model,AN=AW.id,AU=K(AN),AP={datasetId:AT},AQ=[];if(!AU){var AR=true;n.forEach(this.dropZones,function(AZ){if(AZ.items.length>0){AR=false;return false;}});if(AR){AQ.push({act:"createDefaultDropZones",nodeKey:AY.k,treeType:AY.defn.tt,datasetId:AS.data.datasetId,datasetType:3,widgetType:x.CUSTOM,partialUpdate:{nodes:[AY.k]}});AQ=AQ.concat(B.call(this));}}if(AO){if(AU){AQ.push(AS.getRemoveTemplateUnitAction(AO));}else{AQ=AQ.concat(this.getRemoveDropZoneUnitActions(AW,AO));}}if(AU){n.forEach(AV,function(AZ){AQ.push(AS.getAddTemplateUnitAction(AZ,AT,AN,AX));});}else{AQ=AQ.concat(this.getAddDropZoneUnitsActions(AW,AV,AX,AP)||[]);}AF.call(this,AW,AV,AQ);return AQ;}function D(AO,AN){var AP=AO.allowObjectType;if(AO.isColorBy){if(!AN.cbDefined){AN.cbDefined=true;}else{P("More than one dropzone are marked as 'isColorBy'.");}if(AP===W.ATTRIBUTE_AND_METRIC){P("The dropzone marked as 'isColorBy' should NOT accept 'ATTRIBUTE_AND_METRIC' object type. Otherwise, we will use color by attributes by default.");}else{if(AP===W.METRIC&&AO.maxCapacity!==1){P("The 'maxCapacity' should be 1 for the dropzone marked as 'isColorBy' and allowObjectType is 'METRIC'. Otherwise we will only use the first metric.");}}}if(AO.isSizeBy){if(!AN.sbDefined){AN.sbDefined=true;}else{P("More than one dropzone are marked as 'isSizeBy'.");}if(AP!==W.METRIC){P("The dropzone marked as 'isSizeBy' should ONLY accept 'METRIC' object type.");}if(AO.maxCapacity!==1){P("The 'maxCapacity' should be 1 for the dropzone marked as 'isSizeBy'. Otherwise we will only use the first metric.");}}}function S(AO){var AU=AO&&AO.length;if(!AU){return null;}var AQ=F.length;if(AU>AQ){throw"ERROR: Defined drop zones exceeds max capacity: "+AQ+"!";}var AT=this,AP=[],AR=[],AN={};var AS=function(AX){var AV=false;try{if(AX){AV=(new Function("return "+AX)).call(this);}}catch(AW){AV=false;}return AV;};n.forEach(AO,function(AV,AX){var AY=AV.name,AW=F[AX];if(n.indexOf(AR,AY)>-1){throw"ERROR: More than one drop zones have same name!";}AR.push(AY);D(AV,AN);AP.push(AT.getZone(AY,h[AW],AT.getDZFlatStruct()[Q(AW)],AS.call(AT,AV.disabled),{title:AV.title,allowSingle:AV.maxCapacity===1}));});return AP;}function m(AO){var AN=-1;n.forEach(this.getCustomDropZones(),function(AP,AQ){if(AP.name===AO){AN=AQ;return false;}});return AN;}function Z(AT,AP,AO){var AU=this,AQ=AC,AN=Number.MAX_VALUE,AS=-1;n.forEach(this.getCustomDropZones(),function(AX,AY){if(AX.name===AT.n){AQ=AX.allowObjectType;AN=AX.maxCapacity;AS=AY;return false;}});if(AS===-1){return AP;}var AV=this.isReplacing(AO),AR=this.getDropZoneObjectsByIndex(AS),AW=AR.length;if(!AV&&AW>=AN){return[];}return n.filter(AP,function(AY){var AX=AU.isMetric(AY);switch(AQ){case M:return !AX;case G:return AX;case t:return !AW?true:((AW===1&&AV)||(AU.isMetric(AR[0])===AX));}return true;},{max:AN});}function AM(AO,AR,AS){var AQ=this,AN=AO.allowObjectType;if(AN!==AS&&AR.length>0){if(AN===t&&AS===M&&n.filterOne(this._dropZoneTransitions,function(AT){return AT.toZoneId===h[F[m.call(AQ,AO.name)]]&&!AQ.isMetric(AT.obj);})){return ;}var AP=Math.min(AO.maxCapacity||Number.MAX_VALUE,AR.length);this.transitionObjectsToZone(AO.name,AR.splice(0,AP));}}function N(AO,AN,AP){var AS=this.getCustomDropZones(),AR=[],AQ=this;n.forEach(AS,function(AT,AU){if(AT[AO]){AR=AQ.getDropZoneObjectsByIndex(AU);return false;}});return n.filter(AR,function(AT){return AN?AQ.isMetric(AT):!AQ.isMetric(AT);},AP);}function AJ(AO,AN){return AO.indexOf(AN,AO.length-AN.length)!==-1;}mstrmojo.vi.models.CustomVisDropZones=mstrmojo.declare(mstrmojo.vi.models.BaseVisDropZones,null,{scriptClass:"mstrmojo.vi.models.CustomVisDropZones",enableRAEntries:false,getDropZones:function s(){var AP=this.getHostStructure(),AQ=this.getHost(),AO=S.call(this,this.getCustomDropZones()),AN=AP?(AO||this._super().zones):[];this.dropZones=AN;return{n:AQ.defn.ttl,zones:AN};},getAllowDropInfo:function C(AO,AP,AN,AR,AQ){AP=Z.call(this,AO,AP,AR);return a.copy(this.shouldAllowObjectsInDropZone(AO,AP,AN,AR,AQ),{allowedItems:AP.concat(),removeReplaced:AR===AG.ON&&AO.items[AN]&&n.find(AP,"did",AO.items[AN].did)===-1});},unitsDropped:function AI(AV,AN,AX){var AY=this.getHost(),AT=AN.src.data,AR=AN.actions||[],AZ=AX.idx,AU,AP,AW=this,Aa=AW.docModel,AS=AX.allowedItems,AQ=(this.isReplacing(AX.edge)&&AX.removeReplaced)?AV.items[AZ]:null,AO=AB.call(this,AV,AS,this.getDropTargetIndex(AV,AX),AQ,AT.dsid);AO=AO.concat(this.getActionsForObjectsDropped(AV,AS,this.getDropTargetIndex(AV,AX),AQ,{datasetId:AT.dsid})||[]);AU=AR.concat(this.getUpdateTemplateAction(AO));AP=function(Ab){return function(){var Ac=Ab?AY.model.wrapUnsetVisualizationFilterAction(AU):AU;AW.submitDropZoneUpdates(Ac,AH.wrapMethods(AN.callback,AY.model.docModel.controller._getXtabCallback(AY)));};};Aa.checkAndNotifyVFChangeOnDZUnitsUpdate({actions:AU,zm:AW},AP(true),AP(false));},getRemoveDropZoneUnitActions:function E(AN,AO,AP){var AQ=this._super(AN,AO,AP);if(p.call(this,AN,AO)){AQ=this.getRemoveThresholdsActions(AN,AO).concat(AQ);}return AQ;},deleteItems:function H(AO,AP){var AQ=this,AN=[];n.forEach(AP,function(AR){if(K(AO.id)){AN.push(AQ.getHost().model.getRemoveTemplateUnitAction(AR));}else{AN=AN.concat(AQ.getRemoveDropZoneUnitActions(AO,AR));}});AN=AN.concat(this.getActionsForObjectsRemoved(AO,AP)||[]);this.submitDropZoneTemplateUpdates(AN);},getUnitMenuItems:function q(AT,AU,AY,AP){var AX=this.getCustomDropZones()===undefined?false:true;this._super(AT,AU,AY,AP,AX);var AW=this.getHost(),AO=AT.getMenuItems(true),AV=n.find(AO,"n","Edit Groups..."),AS=n.find(AO,"n","Create Groups..."),AZ=a.walk("model.data.gts.row",AW),AR=AZ?n.find(AZ,"id",AY.did):-1;if(AZ&&AR!==-1){var AN,AQ=function(){var Aa={otp:AY.t,id:AY.did,n:AY.n,axis:1,ui:AR};AW.derivedElementsEdit(Aa);};if(AV!==-1){AN=AO[AV];AN.fn=AQ;}if(AS!==-1){AN=AO[AS];AN.fn=AQ;}}if(!AW.showThreshold&&p.call(this,AU,AY)){AT.addSeparator();this.buildThresholdMenuOptions(AT,{item:AY},true);}this.getDropZoneContextMenuItems(AT,AU,AY,AP);},getClearAllUnitsActions:function R(){if(this.getCustomDropZones()===undefined&&this._super){return this._super();}return mstrmojo.vi.models.DropZonesModel.prototype.getClearAllUnitsActions.call(this);},transitionDropZones:function I(AN,AO){this._dropZoneTransitions=[];this.customDropZonesTransition(AN,AO);return this._dropZoneTransitions;},getColorByAttributes:function(){return N.call(this,"isColorBy",false);},getColorByMetric:function(){return N.call(this,"isColorBy",true,{max:1})[0];},getSizeByMetric:function(){return N.call(this,"isSizeBy",true,{max:1})[0];},useAbsoluteSizeByValue:function(){var AO=this.getCustomDropZones(),AN=n.find(AO,"isSizeBy",true);return AN>-1?!!AO[AN].useAbsolute:false;},getDropZone:function(AN){switch(typeof AN){case"number":return this.dropZones[AN];case"string":return this.getDropZone(n.find(this.dropZones,"n",AN));case"object":return AN;default:return undefined;}},getDefaultTooltipOrder:function g(){var AO=this.getCustomDropZones(),AN=[];n.forEach(AO,function(AP){AN.push(AP.name);});return[AN];},setTooltipObjsOrder:function X(AO){var AS=this.getHost(),AW=[],AU=[],AR,AQ=AO.length,AT,AV,AP=this;for(var AN=0;AN<AQ;AN++){AT=AO[AN];if(n.isArray(AT)){n.forEach(AT,function(AX){AV=undefined;if(AJ(AX,d.ATTRIBUTE)){AX=AX.replace(d.ATTRIBUTE,"");AV=false;}if(AJ(AX,d.METRIC)){AX=AX.replace(d.METRIC,"");AV=true;}AW=AP.getDropZoneObjectsByName(AX);n.forEach(AW,function(AY){if(AV===undefined||(AV===true&&AP.isMetric(AY))||(AV===false&&!AP.isMetric(AY))){if(AU.indexOf(AY.id)===-1){AU.push(AY.id);}}});});AR=AU.length;if(AR&&(AU[AR-1]!=="seperate")&&(AN<(AQ-1))){AU.push("seperate");}}}if(AU.length&&AU[0]==="seperate"){AU=AU.shift();}AR=AU.length;if(AR&&AU[AR-1]==="seperate"){AU.pop();}AS.tooltipObjsInOrder=AU;},getNotAdditionalAttrIds:function L(){var AQ=this.getCustomDropZones(),AO,AP=[],AN=this;n.forEach(AQ,function(AR){if(AR.isAdditionalInfo!==true){AO=AN.getDropZoneObjectsByName(AR.name);n.forEach(AO,function(AS){if(!AN.isMetric(AS)){AP.push(AS.id);}});}});return AP;},getAdditionalAttrIds:function f(){var AR=this.getCustomDropZones(),AO,AQ=[],AN=this,AP=this.getNotAdditionalAttrIds();n.forEach(AR,function(AS){if(AS.isAdditionalInfo===true){AO=AN.getDropZoneObjectsByName(AS.name);n.forEach(AO,function(AT){if(!AN.isMetric(AT)&&(AP.indexOf(AT.id)===-1)){AQ.push(AT.id);}});}});return AQ;},getCustomDropZones:z,getActionsForDoubleClick:function(AP,AO){var AN=this;var AQ=[];n.forEach(this.dropZones,function(AR){if(AN.isObjectAllowedForDropZone(AP,AR)){AQ=AB.call(AN,AR,[AP],AR.items.length,null,AO);return false;}});return AQ;},isObjectAllowedForDropZone:function(AR,AS,AN,AQ){var AO=this.getDropZone(AS);if(!AO){return false;}var AP=this.getAllowDropInfo(AO,[AR],AN===undefined?AO.items.length:AN,AQ===undefined?AG.BELOW:AQ,{src:{data:{src:o.DATASETS}}});return AP.allowedItems.length>0;},getActionsForObjectsDropped:z,getActionsForObjectsRemoved:z,getDropZoneContextMenuItems:z,shouldAllowObjectsInDropZone:z,getDefaultThresholdColorsAndBands:z,getHostStructure:function AE(){var AN=this.getHostModel();return AN&&AN.gsi;},getDropZoneObjectsByIndex:function i(AN){return this.getDZFlatStruct()[Q(F[AN])]||[];},getAddDropZoneObjectsActions:function j(AT,AS,AR,AN,AQ){var AO=this.getDropZone(AS);var AP=this.getAddDropZoneUnitsActions(this.getZoneModelByName(AS),n.ensureArray(AR),AN===undefined?AO.items.length:AN,AQ);n.insert(AT,undefined,AP);},getRemoveDropZoneObjectsActions:function w(AQ,AP,AO){var AN=this;n.forEach(n.ensureArray(AO),function(AR){Array.prototype.push.apply(AQ,AN.getRemoveDropZoneUnitActions(AN.getZoneModelByName(AP),AR));});},getReplaceDropZoneObjectsActions:function(AR,AQ,AO,AN){var AP=this.getDropZone(AQ).items;this.getRemoveDropZoneObjectsActions(AR,AQ,AP[AN]?[AP[AN]]:[]);this.getAddDropZoneObjectsActions(AR,AQ,[AO],AN);},getDropZoneObjectsByName:function l(AN){return this.getDropZoneObjectsByIndex(m.call(this,AN));},isMetric:function u(AN){return AN&&AN.t===4;},isGeoAttr:function(AN){return AA.isGeoAttr(AN,AN.useAvailGeoFmsOnly);},isTimeAttr:function(AN){return AA.isTimeAttr(AN);},isSameObject:function c(AO,AN){return AO&&AN&&(AO.did||AO.oid||AO.id)===(AN.did||AN.oid||AN.id);},isReplacing:function k(AN){return AN===AG.ON;},isObjectInZone:function Y(AN,AP){var AO=this;return n.filter(AO.getDropZoneObjectsByName(AP),function(AQ){return AO.isSameObject(AQ,AN);}).length>0;},isZoneEmpty:function AK(AN){return(this.getDropZoneObjectsByName(AN)||[]).length===0;},getZoneModelByName:function U(AN){return this.getZoneModelByZoneId(h[F[m.call(this,AN)]]);},getAvatarIconClass:function e(){return"viXtab";},getDropZoneName:function AD(AN){return AN&&AN.n;},transitionObjectsToZone:function b(AP,AO){var AN=this._dropZoneTransitions,AQ=m.call(this,AP);if(AN&&AQ!==-1&&AO){n.ensureArray(AO).forEach(function(AR){AN.push({obj:AR,toZoneId:h[F[AQ]]});});}},customDropZonesTransition:function J(AO,AP){var AQ=this,AN=this.getCustomDropZones()||[];AN.forEach(function(AR){AM.call(AQ,AR,AO,G);AM.call(AQ,AR,AP,M);});}});mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE={ATTRIBUTE_AND_METRIC:AC,ATTRIBUTE:M,METRIC:G,ATTRIBUTE_OR_METRIC:t};var W=mstrmojo.vi.models.CustomVisDropZones.ENUM_ALLOW_DROP_TYPE;mstrmojo.vi.models.CustomVisDropZones.CUSTOM_DZ_SUFFIX=d;}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.boxmodel","mstrmojo.Model","mstrmojo.VisUtility","mstrmojo.elementHelper","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.models.template.DataInterface","mstrmojo.StringBuffer","mstrmojo.EnumReadystate","mstrmojo.vi.viz.EnumVizStyles","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.UUID","mstrmojo.ExpressVisList","mstrmojo.vi.enums.EnumThemeProperties","mstrmojo.vi.enums.EnumFeatures","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.ui.rw.AMSelectorBox","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.vi.models.VIComponentMap","mstrmojo.publisher");var Bz=mstrmojo.EnumRWUnitType,BU=mstrmojo.EnumReadystate,Ac=mstrmojo.hash,AH=Ac.forEach,y=mstrmojo.func,Ao=mstrmojo.Obj.free,Bc=mstrmojo.array,Ax=mstrmojo.boxmodel,Am=mstrmojo.mixin,Bd=mstrmojo.VisUtility,Bl=mstrmojo.elementHelper,Ae=mstrmojo.MetricSelectorUtility,Bn=mstrmojo.UUID,AE=mstrmojo.vi.viz.EnumVizStyles,e=mstrmojo.vi.viz.EnumWidgetTypes,Bq=mstrmojo.vi.viz.EnumDSSDropZones,u=mstrmojo.vi.viz.MapHelper,BT=mstrmojo.vi.ui.rw,l=BT._HasVisSelections,BD=BT.selectors._BrushesAndHighlights,AN=mstrmojo.DocSelector.DATAPARAMS,D=mstrmojo.publisher,O="\u001E",A6=BT.AMSelectorBox.DefaultV,AZ=mstrmojo.vi.enums.EnumFeatures;var Aj={},BF={},A4="76CB9F3E366345DF89811386CBAA82CB",Af=mstrmojo.vi.enums.EnumThemeProperties.ENUM_LAYOUT_STYLE.DEFAULT,AW=[11826975,1381846,1810715,950271,12407690,2276796,13614615,8355711,15255470,9869567,9101208,7912447,14004421,9296859,15063710,13092807],R=mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK,A2={ESRIMapVisualizationStyle:"com.microstrategy.web.vf.viewer.EsriMapApplicationViewer",GoogleMapVisualizationStyle:"com.microstrategy.web.vf.viewer.GoogleMapApplicationViewer",MapboxVisualizationStyle:"com.microstrategy.web.vf.viewer.MapboxApplicationViewer",KPICardVisualizationStyle:"com.microstrategy.web.vf.viewer.KPICardApplicationViewer"},AV="com.microstrategy.web.vf.viewer.CustomVisApplicationViewer";mstrmojo.MultiRWUnitFormatEventsType=null;var AR={isObservable:function(B2){var B1=B2&&B2.t;if((!B1&&B1!==Bz.LAYOUT)||!this.hasOwnProperty(B1)||B2.scriptClass){return false;}return(B1!==Bz.SUBSECTION||!B2.dt);},makeObservable:function(B1){var B2=B1.audibles=this[B1.t]||{};if(B2.hasOwnProperty("readyState")){B1.readyState=BU.IDLE;}return new mstrmojo.Model(B1);},undoObservable:function(B2){if(!B2.scriptClass){return B2;}var B1={},B3={id:true,audibles:true,readyState:true,destroyed:true,hasInitBindings:true,disposables:true,_super:true,};Object.keys(B2).filter(function(B4){return !(typeof B2[B4]==="function")&&!B3[B4];}).forEach(function(B4){B1[B4]=B2[B4];});return B1;}};AR[Bz.PANELSTACK]={"*":false,selKey:true,readyState:true};AR[Bz.GRID]={"*":false,readyState:true,ds:true};AR[Bz.GRAPH]={"*":false,readyState:true,ds:true};AR[Bz.GRIDGRAPH]={"*":false,qsm:true,ds:true};AR[Bz.SUBSECTION]={"*":false,resize:true,adjustSize:true};AR[Bz.VISUALIZATION]={"*":false,ds:true};AR[Bz.SELECTOR]={"*":false,cek:true,ds:true,readyState:true};AR[Bz.MOJOVISUALIZATION]={"*":false,ds:true};AR[Bz.LAYOUT]={"*":false,readyState:true};var Az={};function Ag(B1){return Az[B1]||Az["*"];}Az["*"]={update:function j(B2,B3,B1,B4){if(B3.isNavigation){delete B3.exp;}Ac.copy(B1,B3);if(B1&&!B1.ck){delete B3.ck;}if(B1&&!B1.fs){delete B3.fs;}if(B1&&!B1.sus){delete B3.sus;delete B3.suc;}if(B1&&!B1.sorts){delete B3.sorts;}if(B1&&!B1.an){delete B3.an;}}};Az[Bz.PANEL]=Am({update:function j(B2,B3,B1,B4){if(B3!==B1){delete B3.layoutXML;}this._super(B2,B3,B1);}},Ac.copy(Az["*"]));function Ah(B7,B8){function B6(CA,B9){Bc.forEach(CA.disposables,function(CD,CC,CB){if(CD&&CD.k===B9.k){CD.destroy();CB.splice(CC,1);return false;}});return CA.addDisposable(B9);}var B2=B7&&B7.layoutMap&&B7.layoutMap[B8];if(B2){if(!B2.t){B2.t=Bz.LAYOUT;}if(AR.isObservable(B2)){B2=B7.layoutMap[B8]=B6(this,AR.makeObservable(B2));}return B2;}var B1=B7&&B7.layouts,B5=(B1&&B1.length)||0,B4;for(B4=0;B4<B5;B4++){if(B1[B4].k===B8){var B3=B1[B4];if(!B3.t){B3.t=Bz.LAYOUT;}if(AR.isObservable(B3)){B1[B4]=B6(this,AR.makeObservable(B3));}return B1[B4];}}return null;}function i(B5,B7,B4,B3){var B2=Ah.call(this,B5,B7);if(B4===B7){B2._lkz=B7;return B2;}if(B2){var B6=B2.units[B4];if(B6){if(parseInt(B6.t,10)===Bz.GRIDGRAPH){if(!B2.units[B4+"_0"]){B2.units[B4+"_0"]={ck:B6.ck,fmts:B6.fmts.gd,txi:B6.txi,t:Bz.GRID};B2.units[B4+"_1"]={ck:B6.ck,fmts:B6.fmts.gp,t:Bz.GRAPH};}}if(!B3&&AR.isObservable(B6)){B6=B2.units[B4]=AR.makeObservable(B6);var B1=this;B6.addDisposable({destroy:function(){var B9=B1.disposables.indexOf(B6);if(B9>=0){B1.disposables[B9]=null;}if(!B2.units[B4]){return ;}B2.units[B4]=AR.undoObservable(B2.units[B4]);var CA=B1.getWidgetId({k:B4,wid:1},B7),B8=B1.getLayoutDataCache(B7);if(B8&&B8[CA]){B8[CA].defn=B1.getUnitDefinitions([B4])[B4];}}});this.addDisposable(B6);}B6._lkz=B7;}}return B2&&B2.units[B4];}function Bo(B5,B4,B3,B1){var B2=this.getChildren(B5,B4,0);return(mstrApp.isMobile?(Bc.filter(B2,function(B8){var B6=B3&&B3.indexOf(B8.defn.t),B7=B8.defn.dk;return B1?(B6>-1&&B7===-1):(B6<0||B7!==-1);})):(B1?[]:B2));}var BC=function(B1,B2){var B3=new mstrmojo.StringBuffer();if(B2){B3.append("*l"+B2);}B3.append("*k"+B1.k);if(B1.hasOwnProperty("wid")){B3.append("*x"+B1.wid);}B3.append("*t"+this.buildTime);return B3.toString();};function Bk(B3){var B2,B1,B6=this.delta,B4=this.pendingUpdate=this.pendingUpdate||{},B5=[];if(!Ac.isEmpty(B6)){B5.push("<updates>");for(B2 in B6){if(B6.hasOwnProperty(B2)){B1=B6[B2];B5.push(B1.getUpdates());}}B4[B3]=B6;this.delta={};B5.push("</updates>");}return B5.join("");}function z(B6,B2){var B5;if(B6){var B1=Bc.isArray(B6)?B6:B6.split(B2||O),B4=B1.length,B3;for(B3=0;B3<B4;B3++){B5=B5||{};B5[B1[B3]]=i.call(this,this.defn,this.currlaykey,B1[B3]);}}return B5;}function AL(B1,B2){return mstrmojo.all[BC.call(this,{k:B1,wid:B2},this.currlaykey)];}function BA(B2,B1){var B3=this.getLayoutUnitDefn(B2,B1);return(B3&&B3.t===Bz.PANELSTACK&&B3.ifw);}function AG(B2,B1){return !B1||(B2.wid===B1);}function G(B5,CD){var B8=this,CE=B8.getSliceCallback(CD),B3=CE.shared,CF=CD.tks,B2=CD.eid,CB=B8.getDataService();if(!CF){return ;}var CA=i.call(B8,B8.defn,B8.currlaykey,B2);if(!CA){return ;}var B7=B2,B9=B3.tgtDefs[CF],B1=function(){B9.set("selKey",B2);},B4;B9.newSelKey=B2;if(CA.l){var B6=CA.dirtyKeys;if(!!B6){B7=Ac.keyarray(B6).join(",");B3.orignalTargetDefs=B3.tgtDefs=z.call(B8,B7,",");B4=function(){B1();AH(B3.dataCacheUpdate.upd,function(CG,CH){var CI=mstrmojo.all[CH];if(CI&&CI.setDirty){CI.setDirty(false);}});};}else{if(CD.skipServerCall){B1();return ;}CB.requestPanelChangeDeferred(B5,B2,null,false,false,B8.newCallback({method:"slice",success:B1}));return ;}}else{B4=function(){B1();CA.l=true;};}var CC=CE.success;CE.success=function(CH){if(!B8.checkStatus(CH)){return ;}B8.updateDefnCache(CH.defn,[B2]);CC(CH);B4();var CG=AL.call(B8,CD.tks,0);if(CG){CG.clearDirtyChild(B2);}};CB.requestPanelChangeDeferred(B5,B2,B7,true,!CD.hasLoader,CE);}function BI(B1,B2){if(B2[AN.ELMSREADY]){B1[AN.ELMSREADY]=B2[AN.ELMSREADY];B1.elms=B2.elms;}if(B2[AN.CESREADY]){B1[AN.CESREADY]=B2[AN.CESREADY];B1.ces=B2.ces;}if(B2[AN.ELMSREQUEST]){B1[AN.ELMSREQUEST]=B2[AN.ELMSREQUEST];}if(B2[AN.METRICVALUES]){Ae.restoreMetricSelectorProps(B1,B2);B1[AN.METRICVALUES]=B2[AN.METRICVALUES];}if(B2[AN.CSREADY]){B1[AN.CSREADY]=B2[AN.CSREADY];Ae.restoreMetricSelectorSelections(B1,B2);}if(B2[AN.DISABLED]){B1[AN.DISABLED]=B2[AN.DISABLED];}}function BZ(B3,B1,B2){if(B3.defn&&B3.defn.t>=Bz.GRID){mstrmojo.models.template.DataInterface.inflateGridData(B3.data);}var B5=B3.id,B4=B1[B5]&&B1[B5].data;if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&B4&&B3.defn.t===Bz.SELECTOR){if(!B3.data){B3.data={};}BI(B3.data,B4);}if(!B2){B1[B3.id]=B3;}return B3;}function Q(CO,CU,CH,B2,CR,B9){var CV=this.currlaykey,CY;if(CO){CY=CO.defn;CV=(CY&&CY._lkz)||CO.k;}var B8=this.getLayoutDataCache(CV),CM=(!CH&&!Ac.isEmpty(B8)),B3;if(!CO){B3=this.data;}else{var CG=CO.data||CO;if(CM){B3=B8[BC.call(this,CG,CV)];B3=(B3&&B3.data)||B3||CG;}else{B3=CG;}}if(!!B3.sections){this._buildingLayoutKey=B3.k;}var CB=B3?this.extractChildren(B3):[],CN=[];var CD=(CB&&CB.length)||0;if(CD){CY=this.defn;var CP=!CO,CK=CO?CV:null,Cb=(CO&&((CO.defn)?CO.defn.t:i.call(this,CY,CK,CO.k).t));var B5=(Cb===Bz.GRIDGRAPH),CI=(Cb===Bz.DETAILS),CW,CE;CB=CU(CB);for(CW=0,CE=CB.length;CW<CE;CW++){var CJ=CB[CW];if(B5){CJ.k=CO.k;CJ.wid=CO.data.wid;}var CC=CJ.k,CX=CJ.wid,CQ=BC.call(this,CJ,CK),CL=!CP&&BA.call(this,CC,CK),B6;if(!B9){if(!CP&&CL&&(!CH||!this.getInfoWinByKey(CC))){var B1=this.getLayoutUnitDefn(CC),CS=BZ({data:CJ,defn:B1,id:CQ,k:CC,p:B3},B8,CR);if(!this.getInfoWinByKey(CC,CX)){var B7=this.infoWindows=this.infoWindows||{};B7[B1.n]=CS;this.addInfoWinByKey(CC,CS);}continue;}else{if(!CP&&CL&&CH){var B4=this.getInfoWinByKey(CC,CX);if(B4){this.mergeInfoWin(CJ,B4.data,this.getCurrentLayoutKey());}}}}if(B5){CQ+="_"+CW;B6=i.call(this,CY,CK,CJ.k+"_"+CW);}else{B6=i.call(this,CY,CK||CJ.k,CJ.k);}if(CI){B6.dt=true;}if(B8===null&&(B6.t===Bz.LAYOUT)){B8=this.getLayoutDataCache(CJ.k);}var CZ;if(B6.t===Bz.PANEL&&B8[CQ]&&CM){var CA=this.extractChildren(CJ)||[],CT=this.extractChildren(B8[CQ].data)||[],Ca=false;if(CA.length!==CT.length){Bc.forEach(CT,function(Cd){var Cc=Bc.find(CA,"k",Cd.k);if(Cc>-1){CA[Cc]=Cd;Ca=true;}});if(Ca){CT.splice(0,CT.length);Bc.forEach(CA,function(Cc){CT.push(Cc);});}}CZ=CJ;}else{CZ=CM?(B8[CQ]&&B8[CQ].data)||CJ:CJ;}var CF={k:CJ.k,id:CQ,defn:B6,data:CZ,p:B3};if(!B8[CQ]){BZ(CF,B8,CR);}CN.push(CF);}}return B2?{nodes:CN,total:CD}:CN;}function Be(B7,B2,B6){var B1=Ax.px2Inches,B3=this.getZoomProps(),B5=1,B4=2;if((B6&B5)>0){B7.FormattingPosition={Left:B1(B3,B2.x||0),Top:B1(B3,B2.y||0)};}if((B6&B4)>0){B7.FormattingSize={Height:B1(B3,B2.h||0),Width:B1(B3,B2.w||0)};}if(B2.z){B7.FormattingOrder={ZIndex:B2.z};}}function AU(B2){function B1(B4,B3){return B4<B3?-1:(B4>B3?1:0);}B2.sort(function(B4,B3){var B5=B1(B4.levelID,B3.levelID);return B5!==0?B5:B1(B4.elemID,B3.elemID);});return B2;}function At(B1,B2){return B1.map(function(B3){return B3[B2];}).join(O);}function AB(B1){return At(B1,"levelID");}function a(B1){return At(B1,"elemID");}function BB(B2){if(B2){BF={};}Aj={};var B1=this.defn&&this.defn.epm;if(B1){B1.forEach(function(B3){B3.epmv.forEach(function(B4){var B6=AU(B4.k.chn.map(function(B9){var B8=B9.emt!==2;return{levelID:B8?(B9.at.did||B9.ei.split(";").slice(-1)):"-1",elemID:B8?B9.ei:B9.mt.did};})),B7=AB(B6),B5=a(B6);if(!Aj[B7]){Aj[B7]={};}Aj[B7][B5]=JSON.parse(B4.v.vv);});});}}function L(B1){if(B1){B1=mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters(B1);}return B1;}function Al(){var B2=this.data&&this.data.layouts,B1=B2[Bc.find(B2,"k",this.getCurrentLayoutKey())],B4=B1&&B1.gbys&&B1.gbys.groupbys,B3=false;Bc.forEach(B4,function(B5){if(B5.unit&&B5.unit.elms&&B5.unit.elms[B5.unit.idx].v==="u;"){B3=true;return false;}});return B3;}function BL(B1,B3,B2){B1=B1.replace(B3,function(B4,B5){if(B5==="&"){return(B2+"&");}return B2;});if(mstrmojo.dom.isIE){B1+="&cb"+mstrmojo.now()+"=1";}return B1;}function BK(CE,CC,B6,CH,B7){var B3=B7?CC:CC.data,CD=this.getChildren(CC,true,undefined,undefined,undefined,true),CA=mstrmojo.all[CC.id];if(!CD.length){return ;}var B4,B8=[],CG=false,B9=this.extractChildren(B3);for(B4 in CD){var B1=CD[B4],B2=B1.id,CF,B5=B1.k;if(B9){var CB=Bc.find(B9,"k",B5);CF=CB>=0?B9[CB]:null;if(CF&&CE.hasOwnProperty(B5)){B8.push({id:B2,parentArray:B9,childData:CF});if(Ac.walk("defn.t",CA)===Bz.PANEL){CG=true;}}}BK.call(this,CE,B1,B6,CH);}B8.forEach(function(CI){Bc.removeItem(CI.parentArray,CI.childData);delete B6[CI.id];});if(CG&&CA){CH.changedParentPanel[CA.id]=true;CH.upd[CA.id]=true;}}function BG(B3,B2,B1){B2=B2||this.getCurrentLayoutKey();var B5=this,B4=B5.extractChildren(B3)||[];B4.forEach(function(B7){if(B7.k){var B6=BC.call(B5,{k:B7.k,wid:1},B2);B5.deleteDataCache(B6,B2);B1[B7.k]=B6;}BG.call(B5,B7,B2,B1);});}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true,tsp:true},features:null,dataCache:null,searchElemsCache:null,controller:null,sdp:null,dpi:96,keySeed:0,currlaykey:"",init:function Bs(B1){this._super(B1);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();BB.call(this);this.buildTime=mstrmojo.now();},hasFeatures:function C(B5){var B3=this.features;if(!B3){return false;}var B2=B5.split(","),B1=B2.length,B4;for(B4=0;B4<B1;B4++){var B6=B2[B4],B7=B6.match(/^!/);if(B7){B6=B6.replace("!","");}if(!!B7===!!B3[B6]){return false;}}return true;},makeObservable:function F(B1){return AR.makeObservable(B1);},isObservable:function BY(B1){return AR.isObservable(B1);},undoObservable:function AQ(B1){return AR.undoObservable(B1);},checkStatus:function X(B1){if(parseInt(B1.status,10)===4){B1.message=mstrmojo.desc(5781,"Request timed out.");mstrmojo.err(B1);return false;}return true;},getDataService:function BW(){var B2=this.dataService;if(!B2){var B1={rwb:this.bs,msgId:this.mid,stid:this.stid,cbKey:this.cbKey,model:this};if(mstrApp.modelFactory){B2=mstrApp.modelFactory.newDataService("Document",B1);}else{B2=mstrApp.viewFactory.newDocDataService(B1);}this.dataService=B2;this.disposables.push(B2);}return B2;},getNextKey:function Bm(){return"W"+(mstrmojo.resolveFeature("guid-as-node-identifier")?Bn.create():this.keySeed++);},resetKeySeed:function A1(B1){this.keySeed=B1;},getWidgetId:function Bt(B1,B2){return BC.call(this,B1,B2||this.getCurrentLayoutKey());},getUIState:function A8(){return{};},ondefnChange:function AK(){var B6=this.defn,B3=B6&&B6.layouts,B2={};if(B6){B6.layoutMap=B2;var B5=(B3&&B3.length)||0,B4;for(B4=0;B4<B5;B4++){var B1=B3[B4];B2[B1.k]=B1;}}},extractChildren:function Ba(B1){return B1&&(B1.sections||B1.subsections||B1.objects||B1.panels||B1.layouts||B1.children);},getChildren:function S(B5,B4,B8,B3,B7,B2,B1){B8=B8||0;var B6=function(B9){return B9.slice(B8,B8+(B3||B9.length));};return Q.call(this,B5,B6,B4,B7,B2,B1);},getChildrenByKey:function AD(B4,B3,B2,B6,B1){var B5=function(B8){var B7=[],B9;Bc.forEach(B2,function(CA){B9=Bc.find(B8,"k",CA);if(B9!==-1){B7.push(B8[B9]);}});return B7;};return Q.call(this,B4,B5,B3,B6,undefined,B1);},getTargetDefn:function AO(B1){return z.call(this,B1);},getUnitDefinitions:function(B2,B1){return z.call(this,B2,B1);},getUnitInstance:function A(B1,B2){return mstrmojo.all[BC.call(this,{k:B1,wid:B2},this.currlaykey)];},getFirstUnitInstanceByName:function Bu(B4){var B1=Ah.call(this,this.defn,this.currlaykey);if(B1){var B2=B1.units,B3;for(B3 in B2){var B5=B2[B3];if(B5.n===B4){return this.getUnitInstance(B3,1);}}}return null;},getLayoutUnitDefn:function Au(B2,B1){return i.call(this,this.defn,B1||this.currlaykey,B2);},mergeInfoWin:function t(B5,B4,B1){if(B5.k&&B4.k&&B5.k===B4.k){var B3=this;var B2=this.getLayoutUnitDefn(B5.k,B1);if(B2&&B2.t===Bz.PANELSTACK){Bc.forEach(B4.panels,function(B7){var B6=Bc.filterOne(B5.panels,function(B8){return B8.k&&B8.k===B7.k;});if(!B6){B5.panels.push(B7);}else{t.call(B3,B6,B7,B1);}});}else{Bc.forEach(B4.objects,function(B7){var B6=Bc.filterOne(B5.objects,function(B8){return B8.k&&B8.k===B7.k;});if(!B6){if(B5.objects){B5.objects.push(B7);}}else{t.call(B3,B6,B7,B1);}});}}},getRawLayoutUnitDefn:function Br(B2,B3,B1){return i.call(this,B3||this.defn,B1||this.currlaykey,B2,true);},getSelectedKey:function AF(B1){return(!B1&&this.currlaykey)||null;},getCurrentLayoutKey:function Ab(){return this.currlaykey;},getAllLayoutKeys:function Z(){var B1=[];Bc.forEach(Ac.walk("defn.layouts",this),function(B2){B1.push(B2.k);});return B1;},getLayoutKeyByUnitKey:function Bf(B5){var B3=this.defn,B4=B3&&B3.layouts,B1,B2=null;Bc.forEach(B4,function(B6){B1=B6.units;if(B1[B5]&&(!B1[B5]._isDeleted)){B2=B6.k;return !B1[B5];}});return B2;},deleteLayoutUnitDefn:function Aq(B3,B1){var B2=this.getLayoutDefn(B1||this.getLayoutKeyByUnitKey(B3));if(B2){delete B2.units[B3];}},getUpdateLayoutDefaultPanelCallback:function By(){var B1=this;return{success:function(B2){if(B2&&B2.defn&&B2.defn.layouts){var B3=B1.defn.layoutMap;Bc.forEach(B2.defn.layouts,function(B7){var B6=B3[B7.k];if(B7.units&&B6&&B6.units){var B5=B7.units,B4=B6.units;Ac.forEach(B5,function(B9,B8){if(B4[B8]&&B9.t===Bz.PANEL&&B9.l!==undefined&&B9.layoutXML){B4[B8].l=B9.l;}if(B4[B8]&&B9.t===Bz.SELECTOR&&B9.sync!==undefined){B4[B8].sync=B9.sync;}});}});}}};},getLayoutDefn:function A0(B1){var B2=this.defn,B3=B2&&B2.layouts;return B3&&B3[Bc.find(B3,"k",B1)];},getCurrentLayoutDef:function M(){return this.getLayoutDefn(this.getCurrentLayoutKey());},replaceLayout:function AY(B9,B2,CA){var B6=this.defn,B5=this.data,B3=B2&&B2.defn,B1=B2&&B2.data,CB=this.dataCache;if(CB&&CB[B9]){CB[B9]={};}var B8=(B5&&B5.layouts)||(B6&&B6.layouts),B4,B7=false;for(B4=(B8&&B8.length-1)||0;B4>=0;B4--){if(B8[B4].k===B9){break;}}if(CA&&B4<0){B4=Bc.find(B1.layouts||B3.layouts,"k",B9);B7=true;}this.bs=B2.bs;if(B1){if(B7){Bc.insert(B5.layouts,B4,[B1.layouts[B4]]);}else{B5.layouts[B4]=B1.layouts[B4];}B5.elems=B1.elems;}if(B3){if(B7){Bc.insert(B6.layouts,B4,[B3.layouts[B4]]);}else{B6.layouts[B4]=B3.layouts[B4];}this.ondefnChange();}},loadLayout:function B(B1,B3,B2){this.replaceLayout(B1.currlaykey,B1);this.raiseEvent({name:"rebuildLayout",unloadCache:!!B3,restoreIW:!!B2});},getLayoutDataNode:function g(B2){var B1=this.data&&this.data.layouts;return Bc.filterOne(B1,function(B3){return B3.k===B2;});},getLayoutDataCache:function Bh(B2){if(!B2){return null;}var B1=this.dataCache;if(!B1){B1=this.dataCache={};}if(!B1[B2]){B1[B2]={};}return B1[B2];},saveRW:function Av(B2,B4){var B3=mstrmojo.desc,B1=this.getDataService();B1.saveRW({objName:B2||this.n,folderID:this.pfid,saveAsFlags:1},B4||{success:function(B5){mstrmojo.alert(B3(3819,"Document Saved")+": "+B5.n);}});},saveAsRW:function Bv(B5,B4){var B3=this,B2=!!(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()||mstrConfig&&mstrConfig.resolveOnly),B1=B3.prompt_option;switch(B1){case 0:B1=3;break;case 4:B1=1;break;default:B1=2;}var B6=mstrmojo.hash.copy(B5,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:mstrApp.saveFolderId||B3.sfid||B3.pfid,saveFromDesignMode:false,saveAsReportSaveAsFlags:B1,resolveOnly:B2,rwb:B3.bs});if(B4){B6.target=B4;B6.saveAsOrigin=13;}mstrmojo.form.send(B6,null,"post");},getDocPropsActions:function w(B1){var B2={act:"setDocumentProperties",props:B1};Ac.forEach(B1.RWDocumentProperties,function(B4,B3,B5){B5[B3]=String(B4);});return B2;},saveDocProps:function Ai(B1,B3,B4,B8){var B7=this.getDataService(),B6=B4?null:mstrmojo.DocDataService.RAPID_EXEC,B2=mstrmojo.DocDataService.REQUEST_DEFN_DATA,B5=[this.getDocPropsActions(B1)];if(B3){this.controller.cmdMgr.execute({execute:function(){this.submit(B5,B8||{},Ac.copy(B2,Ac.copy(B6,{})));},urInfo:B3});}else{B7.submitUpdates(B5,B8||{},Ac.copy(B2,Ac.copy(B6,{preserveUndo:true})));}},partialUpdate:function BX(B7,B1,B4,B3,B2,B6){if(B4){this.updateDefnCache(B4,B3,B2);}if(B7){if(mstrApp){mstrApp.isPartialUpdate=true;}var B5=this.updateDataCache(B7,B1,undefined,B2);if(B6){B5=B6(B5);}this.raiseEvent({name:"partialUpdate",tree:B7,ids:B5});if(mstrApp){mstrApp.isPartialUpdate=false;}return B5;}},refreshDefinition:function Bi(B4,B3,B2,B5){var B1=this.getLayoutUnitDefn(B4,B2||this.getCurrentLayoutKey());if(!B1){return ;}Ag(B1.t).update(this,B1,B3,B5);},loadPartialData:function E(B6,B2){var B4={};B4[B2]=i.call(this,this.defn,this.currlaykey,B2);var B3=this.updateDataCache(B6,B4),B1=this.getLayoutDataCache(this.getCurrentLayoutKey()),B5=this;Bc.forEach(B6.layouts,function(B7){var B8=B7&&B7.xtabStyles;if(B8){B5.raiseEvent({name:"updateStyles",key:B7.k,updatedStyles:B8});}});AH(B3,function(B8,B7){if(B7==="upd"){AH(B8,function(CA,CB){var B9=mstrmojo.all[CB];if(B9&&B9.update){B9.update(B1[CB]);}});}});},updateDefnCache:function J(B2,B8,B5){var CB=this.currlaykey,B4=Ah.call(this,B2,CB),CD=Ah.call(this,this.defn,CB),B9=function(CE,CF){var CG;for(CG in CF){if(CE[CG]===undefined){CE[CG]=CF[CG];}}},CC=B4&&B4.units,CA=CD&&CD.units,B3=B4&&B4.cgbMap,B1=CD&&CD.cgbMap,B6=B5&&L(B5).defn,B7=this;Bc.forEach(B8,function(CE){B7.refreshDefinition(CE,CC&&CC[CE],null,B6&&B6[CE]);});if(CC){B9(CA,CC);}if(B3){B9(B1,B3);this.raiseEvent({name:"CGBMapChange",cgbMap:B1});}},deleteDataCache:function BM(B3,B2){B2=B2||this.getCurrentLayoutKey();var B1=this.getLayoutDataCache(B2);if(B1[B3]){delete B1[B3];}},cleanDescendantsDataCache:function BH(B3,B2){var B1={};BG.call(this,B3,B2,B1);return B1;},setDataReady:function A9(CA,B7,B2,B8,B1,CB){var B5=this.extractChildren(this.data),B3=this.getLayoutDataCache(this.getCurrentLayoutKey()),B6=this,B9=false;if(!B5){return ;}function B4(CC){if(!CC){return ;}Bc.forEach(CC,function(CD){if(CD.k===CA){if(B2){CD[B2]=B8;}if(Bc.isArray(B1)&&CB){Bc.forEach(B1,function(CF,CE){CD[CF]=CB[CE];});}else{if(B1){CD[B1]=CB;}}B9=true;return false;}else{if(!B9){B4(B6.extractChildren(CD));}}});}B4(B5);if(!B3[B7]){B3[B7]={};}B3[B7][B2]=B8;},cleanLocalLayoutData:function Bp(B2,B5){var B1={changedParentPanel:{},upd:{}},B4=this.data.layouts,B3={};B2.forEach(function(B7){var B6=B5||this.getLayoutKeyByUnitKey(B7);if(!B6){return ;}if(!B3[B6]){B3[B6]={};}B3[B6][B7]=true;},this);Ac.forEach(B3,function(B9,B8){var B6=B4[Bc.find(B4,"k",B8)],B7=this.getLayoutDataCache(B8);BK.call(this,B9,B6,B7,B1,true);},this);return B1;},updateDataCache:function h(CC,CB,B1,B5){var B3=this.getLayoutDataCache(this.getCurrentLayoutKey()),B2=B5&&L(B5).data,CD={changedParentPanel:{},ifws:{},upd:{},tgts:{},def:{},secs:{}},B7=this,CA=function(CG,CE){var CH=B7.extractChildren(CG.data);if(CH){return ;}var CJ=B7.extractChildren(CE);for(var CF in (CJ||[])){if(!!CJ[CF]){var CI=CJ[CF];if(CI.k===CG.k){if(mstrApp.isAppStatePause&&mstrApp.isAppStatePause()&&CJ[CF]&&CG.defn&&CG.defn.t===Bz.SELECTOR){if(!CG.data){CG.data={};}BI(CG.data,CJ[CF]);}CJ[CF]=CG.data;}}}},B6=function(CK,CF,CE){var CJ=B3[CK];if(B2){var CI=mstrmojo.all[CK];if(CI){var CG=CJ.k,CH=B2[CG];if(CH){if(!Ac.isEmpty(CH.exclude)){Ac.copy(CF.data,CJ.data);}else{CF.data=Ac.copyProps(CH.serialized.split(";"),CF.data,CJ.data);}}}}BZ(CF,B3);CA(CF,CE);};function B9(CW,Cc,CF,CI){var CL=false,CS=this.getChildren(CW,true),CQ;if(!CS.length){return ;}if(CF){CQ=mstrmojo.all[CW.id];CL=!CW.id||!!CQ;}var CK=CW.defn,CG=CW.data,CY;if(CK&&CK.t===Bz.PANELSTACK&&CK.od){CY=CG.selKey;}var CX,CU=false,CJ=Ac.walk("defn.t",CQ)===Bz.PANELSTACK,CM;for(CX in CS){var CT=CS[CX],CV=CT.id,CH=null,CZ,CP=CT.k;if(Cc){CM=this.extractChildren(Cc);if(CM){var Ca=Bc.find(CM,"k",CP);CZ=Ca>=0?CM[Ca]:null;if(!CZ){CM.push(CT.data);if(CB.hasOwnProperty(CP)&&Ac.walk("defn.t",CQ)===Bz.PANEL){CU=true;}}}else{Ac.copy(CW.data,Cc);if(CB.hasOwnProperty(CP)&&Ac.walk("defn.t",CQ)===Bz.PANEL){CU=true;}}}if(mstrmojo.all[CV]){CL=true;}if(CB.hasOwnProperty(CP)){if(BA.call(this,CP)&&AG(CT.data,B1)){B6(CV,CT,Cc);var Cd=this.getInfoWinByKey(CP);if(!CI&&Cd){CD.ifws[CP]=Cd.id;}}CH=CP;if(CL){if(CY&&CY!==CP){continue;}if(!CI){CD.tgts[CV]=true;}var CE=CQ&&CQ.defn,Cb=CE&&CE.t,CO=CE&&CE.ck;if(Cb===Bz.SUBSECTION&&(CO&&CO.hasOwnProperty(CP))){CD.secs[CQ.id]=true;}}}if((CI||CH)&&(!CY||CY===CP)){B6(CV,CT,Cc);CD.def[CP]=true;if(CL){CD.upd[CV]=true;}}var CN=mstrmojo.all[CV],CK=CN?Bd.getPropertyByPath(CN,"node.defn"):null;if(mstrApp.isInVFConfigMode&&CK&&CK.iifp){var CR=this.adjustNodeId(CT.id);if(mstrmojo.all[CR]){CT.id=CR;B6(CR,CT,Cc);CT.id=this.restoreNodeId(CR);CD.upd[CR]=true;CD.tgts[CR]=true;}else{if((CK.t===Bz.GRID||CK.t===Bz.GRAPH)&&CI&&CB[mstrmojo.all[CT.id].k]){CD.upd[CT.id]=true;CD.tgts[CT.id]=true;}}}B9.call(this,CT,CZ,CL,CI||CH);}if(CU){CD.changedParentPanel[CQ.id]=true;CD.upd[CQ.id]=true;}}if(CC&&CC.layouts&&CB){var B4=Bc.filterOne(CC.layouts,function(CE){return(CE.loaded);}),B8=this.data.layouts;if(B4){B9.call(this,B4,B8[Bc.find(B8,"k",B4.k)],true);}}return CD;},getDimensionAndPositionAction:function Bj(B2,B1,B4){var B3=this.getUnitFormatAction(B2,null,null,B4);Be.call(this,B3.format,B1,3);return B3;},getDimensionAction:function Bj(B2,B1,B4){var B3=this.getUnitFormatAction(B2,null,null,B4);Be.call(this,B3.format,B1,2);return B3;},getUnitFormatAction:function k(B9,B2,B8,B4){var B6=B9.defn,CA=(B6&&B6.t)||1,B7=B9.k,B5=[B7];var B1={act:"format",unitKey:B7,unitType:CA===115?521:CA,formatType:B2||1,format:B8||{}};if(Ac.walk("FormattingSize.LayoutXML",B8)){B1.isJson=mstrApp.supportFeature(AZ.SUPPORT_FREE_FORM_LAYOUT);}if(!B4){B1.partialRetrieval={nodes:B5};}if(CA===Bz.SELECTOR){var CB=B6.ck;B1.keyContext=CB;B5[0]=this.getDataService().getNodeKeyFromKeyContext(CB);}if(CA===Bz.TEXTFIELD||CA===Bz.IMAGE||CA===Bz.HTMLCONTAINER||CA===Bz.SURVEYCONTAINER||(mstrApp.isVI&&CA===Bz.SHAPE)){var B3=B9.nk||B6.fgk;B1.fieldKey=B7;B1.nodeKey=B3;B1.keyContext=CA+O+B3+O+B7;B5[0]=B3;}return B1;},updateUnitFormat:function Y(B2,B4,B5,B6,B1){var B3=this.getUnitFormatAction(B2,B4,B5);this.getDataService().submitUpdates(B3,B6,B1);},selectPanelDeferred:function(B6,B5,B4,B3,B2,B1){G.call(this,B6,{type:3,tks:B5,eid:B4,sid:B3||1,ck:B5,hasLoader:B2,skipServerCall:B1});},getSearchElemsCache:function c(){var B1=this.searchElemsCache;if(!B1){B1=this.searchElemsCache={};}return B1;},getCGBMap:function Ap(){var B1=Ah.call(this,this.defn,this.currlaykey);return B1&&B1.cgbMap;},getIfwId:function AS(B1){return B1+"_ifw";},updateDefnForSlice:function m(B1,B4,B2){var B3=B1.events||{0:B1};for(var B5 in B3){var B6=B3[B5];if(B6.refreshDefn){this.updateDefnCache(B4.defn,[B6.ctlKey]);}}},getSliceCallback:function BP(B1){var B4=this,B5={};B5.dataCacheUpdate=null;B5.tgtDefs=B1.tks?z.call(this,B1.tks):null;B5.orignalTargetDefs=B5.tgtDefs;var B3=B5.tgtDefs,B2=function(B8){var B9=B3;if(B1.disablePU){B9=z.call(B4,B4.currlaykey);}AH(B9,function(CA){if(CA&&CA.set){CA.set("readyState",B8);}});},B7=this.newCallback({method:"slice",shared:B5,submission:function(){B2(BU.WAITING);},success:function(B9){if(!B4.checkStatus(B9)){return ;}if(B1.disablePU){B4.loadLayout(B9,B1.isUConDS,B1.restoreIW);return ;}if(B9.pukeys){B5.tgtDefs=z.call(B4,B9.pukeys);}B4.updateDefnForSlice(B1,B9,B5.tgtDefs);B5.dataCacheUpdate=B4.updateDataCache(B9.data,B5.tgtDefs,B1&&B1.sid,B9.puFilters);if(typeof B9==="object"){Ac.copyProps(["bs","exopt","dty"],B9,B4);}var B8={name:"partialUpdate",tree:B9.data,ids:B5.dataCacheUpdate,unloadCache:B1.isUConDS};if(!mstrmojo.hash.isEmpty(B8.ids.ifws)){if(B1&&!B1.suppressIW&&(B1.type===Bz.GRID||B1.type===Bz.GRAPH)){B8.anchor=B1.anchor;}else{B8.ids.ifws={};}}if(mstrApp){mstrApp.isPartialUpdate=true;}B4.raiseEvent(B8);if(mstrApp){mstrApp.isPartialUpdate=false;}},complete:function(){B2(BU.IDLE);}}),B6={success:function(){AH(B5.orignalTargetDefs,function(CK,CI){var CJ=AL.call(B4,CI,1);if(!CJ){if(!!B4.sdp&&!!B4.sdp[CI]){var CH=B4.getLayoutDataCache(B4.getCurrentLayoutKey());var CL=BC.call(B4,{k:CI,wid:1},B4.getLayoutKeyByUnitKey(CI));B4.raiseEvent({name:"secondaryDataSliced",key:CI,data:CH[CL].data});}return ;}if(B5.dataCacheUpdate&&!B5.dataCacheUpdate.def.hasOwnProperty(CI)){if(CJ.setDirty){CJ.setDirty(true);}}else{if(parseInt(CK.t,10)===Bz.PANELSTACK){CJ.setDirtyChildren();}}});var CG=B1.events||{K0:B1},CC;for(CC in CG){var B8=AL.call(B4,CG[CC].ctlKey,1);if(B8&&B5.dataCacheUpdate&&!B5.dataCacheUpdate.upd.hasOwnProperty(B8.id)){var CF=(B8.children&&B8.children[0].selectedIndices)||{},CB=B8.node.data,B9=mstrmojo.DocSelector.STYLES,CA=[];if(B8.isDynamicAttributeSelector()){CB.exp=B8.expr;if(!B8.expr&&Bc.find(CB.elms,"v",Bl.ELEM_ALL_ID)>=0){CA.push(Bl.ELEM_ALL);}}else{if(B8.style===B9.SEARCH_BOX){var CE=(B8.children&&B8.children[0].items)||[];Bc.forEach(CE,function(CH){CA.push(Ac.clone(CH));});}else{Ac.forEach(CF,function(CI,CH){if(CI){CA.push(CB.elms[CH]);}});}}var CD=Bc.find(CA,"v",Bl.ELEM_ALL_ID);if(CD>-1){CA=[CA[CD]];}CB.ces=CA;B8.selIdx=CF;}}}};if(B1.isUConDS||(parseInt(B1.type,10)===Bz.GRAPH&&B1.tty===1)){B7.success=function(B8){B4.controller.setData(B8,true);};return B7;}if((parseInt(B1.type,10)===3)){return B7;}return y.wrapMethods(B7,B6);},slice:function s(B1){var B2=this.getDataService(),B3=B2.newUpdateWithoutCmd();this.sliceDeferred(B3,B1);if(B3.actions&&B3.actions.length>0){B2.addSuppressData(B3.extras);B3.submit();}},sliceDeferred:function(CA,CE){var B8={};try{if(!CE||(!mstrmojo.dom.isAndroid&&!CE.tks&&!CE.multiSelect&&(CE.type===3||(CE.type===Bz.GRAPH&&parseInt(CE.tty,10)!==1)))){return B8;}var B4=this.getSliceCallback(CE),CN=this,CH=this.getDataService(),CD=CN.controller.view;var CO=parseInt(CE.type,10);if(CO===3){if(mstrApp.isVI){var B7=this.getOwningWidgetByType(Bz.PANEL,CE.src),CG=B7.getUnitByKey(CE.tks).boxContent,CC=CE.eid,CJ=CC.substring(1,CC.length-1);var CF={success:function(){var CP=AL.call(CN,CE.ctlKey,1),CS=(CP.children&&CP.children[0].selectedIndices)||{},CQ=CP.node.data,CR=[];Ac.forEach(CS,function(CU,CT){if(CU){CR.push(CQ.elms[CT]);}});CQ.ces=CR;CP.selIdx=CS;}};CG.selectPanel(CJ,false,false,null,CF);}else{G.call(CN,CA,CE);}return ;}if(CE.multiSelect){if(CE.selectorObjects.length>0){CH.setMultiDocSelectorElements(CE.selectorObjects,CE.multiSelect,B4);}return ;}if(CO===Bz.GRAPH){CA.add(CH.getGraphSelectionAction(CE.src,CE.cks,CE.sid,CE.x,CE.y,(CE.tty===1),CE.w,CE.h),B4);if(!!CE.showLoadingIcon){CA.addExtras({config:mstrmojo.DocDataService.PROGRESS_CONFIG});}return ;}var B2=CE.events||{K0:CE},CB=[],CM,B5={config:mstrmojo.DocDataService.PROGRESS_CONFIG},CL=B5.params={},CI,B1={},B3=function(CQ,CP){if(CQ){B1[CP]=CQ.visName;}};for(CI in B2){CE=B2[CI];if(!CE){break;}if(CE.hasOwnProperty("eid")){if(CE.isUConDS){CE.disablePU=true;}if(Al.call(this)){CE.disablePU=true;CE.restoreIW=true;}if(CE.eid===A6){CE.eid="";}CM=CH.getSelectorElementsAction(CE);if(CN.sdp){B1={};AH(CN.sdp,B3);CL.sdpKeys=JSON.stringify(B1);}if(CE.disablePU){CL.disablePU=true;}}else{if(CE.fromGM){CM=CH.getSelectorFromGMAction(CE);}else{if(parseInt(CE.srct,10)===4||CE.fid){if(CE.fid&&Al.call(this)){CE.disablePU=true;}CM=CH.getSelectorExpressionAction(CE);}else{if(CE.unset){CM=CH.getUnsetSelectorAction(CE);}else{if(CE.dynamicSelection){CM=CH.getDynamicSelectionAction(CE);}else{if(CE.expr){CM=CH.getAttributeSelectorExpressionAction(CE);}else{if(parseInt(CE.ct,10)===6){CM=Bc.isArray(CE.ck)?CH.getCompoundGridMultiUnitSelectorAction(CE):CH.getMultiUnitSelectorAction(CE);CN.hasUnitSelector=CE.selections&&CE.selections.hasElements;}else{CM=CH.getSelectorIncludeAction(CE);}}}}}}}CB=CB.concat(CM);}CA.add(CB,B4,B5);var B9=function(CP){CP.extras.style={params:{treesToRender:3}};CP.callback=y.wrapMethods({success:function CQ(CR){CN.partialUpdate(CR.data,CN.getUnitDefinitions(CE.cgb),CR.defn,CE.cgb,CR.puFilters);}},CP.callback);return CP;};if(CE.isNavigation){var B6=(CD._layouts||[]).filter(function(CP){return CP.k===CE.layoutKey;})[0];if(B6){if(!CD.showLayout(B6,null,CA,CE.panelKey)){CA=B9(CA);CD.showPanel(CE.panelKey,CE.layoutKey,CA);}}else{CD.loadDocLayout({layoutKey:CE.layoutKey,panelKey:CE.panelKey},null,CA);}}else{CA=B9(CA);}}catch(CK){mstrmojo.err(CK);}},getInfoWindow:function W(B2){var B1=this.infoWindows;return B1&&B1[B2];},getTargetInfoWin:function(B2){var B1=[],B3=z.call(this,B2);if(B3){var B4;for(B4 in B3){if(B3[B4]&&B3[B4].ifw){B1.push(B4);}}}return B1;},cleanInfoWindowCache:function BJ(){this.infoWinByKey={};},addInfoWinByKey:function Bw(B2,B1){if(!this.infoWinByKey){this.infoWinByKey={};}if(!this.infoWinByKey[B2]){this.infoWinByKey[B2]=[B1];return ;}if(Bc.find(this.infoWinByKey[B2],"id",B1.id)===-1){this.infoWinByKey[B2].push(B1);}},getInfoWinByKey:function AA(B3,B1,B6){var B5=null,B2=this.getCurrentLayoutKey(),B4=this.infoWinByKey;if(B4&&B4[B3]){Bc.forEach(B4[B3],function(B7){var B8=B7&&B7.id;if(B8&&B8.indexOf(B3)>-1&&B8.indexOf(B2)>-1){if(!B1||(B6&&B4[B3].length===1)||B8.indexOf("*x"+B1)>-1){B5=B7;return false;}}});}return B5;},showInfoWin:function K(B5,B4,B2,B6,B8,B1,B7){var B3=this.getInfoWinByKey(B5,B1,B7);if(B3===null){return ;}this.raiseEvent({name:"showInfoWin",psId:B3.id,psKey:B3.k,anchor:B4,anchorOrientation:B2,anchorPosition:B8,invalidate:B6});},getSelectedXtabStyles:function I(B3){var B2=B3||this.currlaykey;var B5={};var B1=this.data&&this.data.layouts,B4;for(B4 in B1){if(B1[B4].k===B2){B5=B1[B4].xtabStyles;break;}}return B5;},downloadGridData:function BV(B6,B7){var B4=this,B3=B6.xtabId,B2=B6.memo,B5=mstrmojo.all[B3],B1=this.newCallback({success:function(CF){function B8(CJ,CL){var CM=B4.getChildren(CJ,true),CK=CM.length,CI;for(CI=0;CI<CK;CI++){var CN=CM[CI];if(CL===CN.id){return CN;}var CH=B8(CN,CL);if(CH){return CH;}}return null;}var CC=Ah.call(B4,CF.data,B4.currlaykey);if(CC){if(B4.restoreNodeId){B3=B4.restoreNodeId(B3);}var CB=B8(CC,B3);if(CB){mstrmojo.models.template.DataInterface.inflateGridData(CB.data);if(B5){B5.dataDownloaded(CB,B2);}}var CE=CC.xtabStyles;if(CE){B4.raiseEvent({name:"updateStyles",key:CC.k,updatedStyles:CE});}}var CD=i.call(B4,B4.defn,B4.currlaykey,B6.nodeKey);if(CD&&CD.t===Bz.GRIDGRAPH&&B2.recalculating){var CA=B5.parent,CG=CA&&CA.getGraphWidget();if(CG&&CA.updateGraph){CA.updateGraph(B8(CC,CG.id));}}if(CF.pukeys){var B9=z.call(B4,CF.pukeys);delete B9[B6.nodeKey];if(!Ac.isEmpty(B9)){B4.partialUpdate(CF.data,B9);}}},failure:function(B8){if(B5.dataDownloadErr){B5.dataDownloadErr(B8);}else{mstrmojo.emptyFn();}}});this.getDataService().downloadGridData(B6,y.wrapMethods(B1,B7));},getFixedHeaders:function(B2,B1){return Bo.call(this,B2,B1,[Bz.PAGEHEADER],true);},getFixedFooters:function(B2,B1){return Bo.call(this,B2,B1,[Bz.PAGEFOOTER],true);},getNonFixedSections:function(B2,B1){return Bo.call(this,B2,B1,[Bz.PAGEHEADER,Bz.PAGEFOOTER],false);},addAutoWidthID:function A5(B3){var B2=this.aws||{},B1=B2[this.currlaykey]||[];B1.push(B3);B2[this.currlaykey]=B1;this.aws=B2;},getAutoWidthIDs:function AI(){var B3=this.aws,B1=this.currlaykey;var B2=B3&&B3[B1];if(B2){delete B3[B1];}return B2;},getTransactionUpdates:function AT(B1){return this.txDiscardTargets?"":Bk.call(this,B1);},clearTransactionUpdates:function Aa(B1){this.clearTxDeltaUpdate(B1);},resetTransactionUpdates:function B0(B1){var B2=this.pendingUpdate,B3=this.delta;if(B2&&B2[B1]){AH(B2[B1],function(B4,B5){if(B3&&!B3[B5]){B3[B5]=B4;}});delete B2[B1];}},transactionUpdate:function BO(B3,B2){if(!B3.data){return null;}var B5;if(B2&&B2.tks){B5=z.call(this,B2.tks);}if(B3.pukeys){B5=z.call(this,B3.pukeys);var B6;for(B6 in B5){if(B5[B6]&&B5[B6].cek){B5[B6].cek=null;}}}if(B3.txrcd){this.txrcd=B3.txrcd;}else{delete this.txrcd;}var B4=this.updateDataCache(B3.data,B5,B2&&B2.sid),B1={name:"partialUpdate",tree:B3.data,ids:B4};if(!Ac.isEmpty(B4.ifws)){if(B2&&B2.type===Bz.GRID){B1.anchor=B2.anchor;}else{B4.ifws={};}}this.raiseEvent(B1);return B4;},deltaUpdate:function BN(B1){var B2=this.delta;if(!B2){B2=this.delta={};}B2[B1.id]=B1;},clearTxDeltaUpdate:function BE(B2){var B5=this.txDiscardTargets,B1=!B5,B4=this.pendingUpdate,B3=this;if(!B1){AH(B5,function(B6,B7){if(B3.delta&&B3.delta[B7]){B3.delta[B7].clear();delete B3.delta[B7];}});}if(B4&&B4[B2]){AH(B4[B2],function(B6){B6.clear();});delete this.pendingUpdate[B2];}},sendTransactionActions:function AC(B2,B1,B4){var B3=this;mstrmojo.mask.show("Running");if(!B4){B4={success:function(B5){B3.transactionUpdate(B5);}};}B3.getDataService().sendTransactionActions({keyContext:B2,actions:B1,txrcd:this.txrcd},y.wrapMethods(B4,{complete:function(){mstrmojo.mask.hide();}}));},sendTransactionUpdates:function b(B1){var B3=this.getSliceCallback(B1),B2=this.getDataService();B2.submitUpdates([B2.getUpdateTransactionAction(B1)],B3);},addSDP:function Ak(B2,B1){if(!B2||!B1){return ;}if(!this.sdp){this.sdp={};}this.sdp[B2]={k:B1.k,visName:B1.visName};},removeSDP:function AM(B1){if(!B1||!this.sdp||!this.sdp[B1]){return ;}delete this.sdp[B1];},getUpdateColorMapCallback:function x(){var B1=this;return{success:function(B2){B1.defn.epm=B2.defn&&B2.defn.epm;BB.call(B1);B1.raiseEvent({name:"colorMapChanged"});}};},getUpdateThemePaletteCallbackHandler:function f(B1){var B2=this;return{success:function(B3){B2.thm=B3.thm;B2.plt=B3.plt;B2.defmts=B3.defmts;BB.call(B2,!B1);B2.layoutstyle=B3.layoutstyle;}};},getUpdateThemePaletteCallback:function AJ(B3){var B4=this,B1,B2;if(mstrApp.isInVFConfigMode){mstrApp.requireRestoreVFConfigMode=true;B1=B4.getVIMap().getComponent(R);B2=mstrApp.getRootController();mstrApp.isInVFConfigPage=false;B2.view.closeInlineDialog();B4.destroyVisualiztionselector();B2.restorePanelStatus(B1);B2.maskMenuToolbar(false);}return this.getUpdateThemePaletteCallbackHandler(B3);},getCurrentPaletteColors:function U(){return(this.plt&&this.plt.colors)||AW;},getCurrentPaletteId:function Bb(){return this.plt&&this.plt.did;},getCurrentDefaultPaletteId:function Ar(){return(this.thm&&this.thm.dplt)||A4;},getCurrentLayoutStyle:function AX(){return this.layoutstyle||Af;},getColorBy:function(B7,B1){var B5=B1.map(function(B9,B8){return{levelID:B7[B8].toString(),elemID:B9};});if(B5&&B5.length>1){AU(B5);}var B6=AB(B5),B4=a(B5),B3=BF[B6];if(!B3){B3=BF[B6]={_currentColorIdx:0};}if(!B3[B4]){var B2=this.getCurrentPaletteColors();B3[B4]=B2[B3._currentColorIdx];B3._currentColorIdx=(B3._currentColorIdx+1)%B2.length;}if(Aj[B6]&&Aj[B6][B4]){return{color:Aj[B6][B4].color,isManual:true};}return{color:B3[B4],isManual:false};},getZoomFactor:function p(){return this.getCurrentLayoutDef().zf||1;},getZoomProps:function BR(){return{dpi:this.dpi,zf:this.getZoomFactor()};},clearAllSelectionAndHighlightCache:function(){l.clearAllSelectionsCache();BD.clearAllHighlightsCache();},executeLink:function H(B1,B3,B5){if(B1.indexOf("prevMsgID")>0){B1=BL(B1,/prevMsgID=0($|&)/g,"prevMsgID="+this.mid);}if(B1.indexOf("originMessageID")>0){B1=BL(B1,/originMessageID=[a-zA-Z0-9]*($|&)/g,"originMessageID="+this.mid);}B1=mstrmojo.addCSRFTokenToURL(B1);if(B1.indexOf(mstrApp.name+"=")===-1&&!mstrmojo.isUrlExternal(B1)){var B4=mstrApp.servletState||mstrConfig.servletState||"";var B2=mstrApp.name+"="+window.encodeURIComponent(B4);if(B1.indexOf("?")>-1){if(B1.charAt(B1.length-1)!=="&"){B1+="&";}}else{B1+="?";}B1+=B2;}this.controller.onLink(this,{url:B1,target:B3,src:B5||null,submitAsPost:!mstrmojo.isUrlExternal(B1)});},getDatasetUnits:function Bg(B2,B1,B4,B6){var B5=this.datasets,B3=[];Ac.keyarray(B5).forEach(function(B8){if(!B4||B8===B4){var B9=B5[B8],B7=B9,CA=[];B2.forEach(function(CB){if(B6!==undefined){B7=B9.tables[B6];}(B7[CB]||[]).forEach(function(CC){if(!B1||B1(CC)){CA.push(CC);}});});B3=B3.concat(CA.map(function(CB){return mstrmojo.hash.copyProps(["did","attId","n","t","st","ndetype","formType","dt","f","hide","usedInDropZones","card","lock","fs","lvfs"],CB,{ds:B9.name,dsId:B8,dm:!!CB.um,da:!!CB.da,de:!!CB.de});}));}});return B3;},getMapLayerKeys:function AP(B1){if(B1&&B1.getSdpKeyArr){return B1.getSdpKeyArr();}return[];},getDeleteMapLayersActions:function BQ(B3){var B1,B4=[],B2=this;(B3||[]).forEach(function(B5){B1=B2.getLayoutUnitDefn(B5);B4.push({act:"removeUnit",unitKey:B5,unitType:(B1&&B1.t)||522});});return B4;},syncLayerDefn:function n(B5,B3,B2){var B4=this.getCurrentLayoutDef(),B1=(B4&&B4.units)||{};(B3||[]).forEach(function(B6){if(B1[B6]){if(B2){B1[B6]._isDeleted=true;}else{delete B1[B6]._isDeleted;}}});if(B2){mstrApp.primaryScdpMap[B5]=[];}else{mstrApp.primaryScdpMap[B5]=B3;}},getFormatSDPAction:function A7(B3,B2){var B1={FormattingWidget:{SecondaryDataProviders:B2.join(",")}};return this.getUnitFormatAction(B3,1,B1,true);},addMapLayerActions:function Ay(CE,B6,B9,B8){var CA=this.getNextKey(),B4=this.getPanel().k,CD=CE.scriptClass==="mstrmojo.mapbox.VisMapbox",B2=CD?AE.MAPBOX:AE.GOOGLE_MAP,B1=CD?e.MAPBOX:e.GOOGLEMAP,CC=this.getWidgetClassNameByStyle(B2,B1),CB=this.getMapLayerKeys(CE),B3=CE.defn.tt,B7={k:CA,defn:{t:521}},B5={FormattingAppearance:{Visible:0,Name:B8}};B6.push(this.getCopyEmptyTemplateAction(CA,B4));B6.push({act:"updateTemplate",keyContext:CA,actions:[{act:"createDefaultDropZones",nodeKey:CA,treeType:B3,datasetType:3,widgetType:B1}]});B6.push(this.getUnitChangeVizAction(B2,CC,B7,B9,B5));B6.push({act:"changeGridDisplayMode",nodeKey:CA,displayMode:1});B6.push(this.getFormatSDPAction(CE,CB.concat(CA)));return CA;},removeMapLayerActions:function q(B3,B2,B4){var B1=this.getLayoutUnitDefn(B2);B4.push({act:"removeUnit",unitKey:B2,unitType:(B1&&B1.t)||522});B4.push(this.getFormatSDPAction(B3,this.getMapLayerKeys(B3)));},removeGeometryInfoActions:function Bx(B4,B1){var B8=B4.zonesModel.getZoneModelByZoneId(Bq.Geometry),B7=B8&&B8.items&&B8.items[0],B2;if(B7){if(B7.fs){var B3=u.getGeometryForm(B7);if(B3){if(B7.fs.length===1){B2=[{act:"removeDropZoneUnit",zoneId:Bq.Geometry,unitId:B7.did,unitType:B7.t}];}else{B2=[{act:"removeForm",unitId:B7.did,unitType:B3.t,attFormId:B3.fid}];}}}else{var B6=B4.zonesModel.getZoneModelByZoneId(Bq.GeoAttribute),B5=B6&&B6.items&&B6.items[0];B2=[{act:"removeForm",unitId:B5.did,unitType:B7.t,attFormId:B7.did}];}if(B2){B1.push({act:"updateTemplate",keyContext:B4.k,actions:B2});}}return B1;},getExtraActionsForChangeMapViz:function d(B3,B2,B6){var B4=B3.parent,B5,B1=this;if(B2&&B2.length>0){Bc.forEach(B2,function(B7){if(!B3.isPrimaryKey(B7)){B5=B1.clearVisAsFilterActionForMapLayer(B4,B3.fnGetWidget(B7),true);if(B5&&B5.actions){B6=B6.concat(B5.actions);}}});B6=B6.concat(this.getDeleteMapLayersActions(B2));B6.push(this.getFormatSDPAction(B3,[]));this.syncLayerDefn(B3.k,B2,true);}return B6;},isMapLayerNode:function An(B2){var B1=false;Ac.forEach(mstrApp.primaryScdpMap,function(B3){if(B3.indexOf(B2)>=0){B1=true;return false;}});return B1;},getHostKeyByNodeKey:function A3(B2){var B1=B2;Ac.forEach(mstrApp.primaryScdpMap,function(B4,B3){if(B4.indexOf(B2)>=0){B1=B3;return false;}});return B1;},getMapLayersDataByHostKey:function P(B7){var B3={},B6,B5=this,B4=mstrApp.primaryScdpMap[B7],B2=this.getCurrentLayoutKey(),B1=this.getLayoutDataCache(B2);Bc.forEach(B4,function(B8){B6=B1[BC.call(B5,{k:B8,wid:1},B2)];B3[B8]=B6&&B6.data;});return B3;},getNodeDataByKey:function As(B2,B3){var B4=B3||this.getLayoutKeyByUnitKey(B2),B1=this.getLayoutDataCache(B4);return B1&&B1[BC.call(this,{k:B2,wid:1},B4)];},getMapLayerDataByLayerKey:function As(B1){var B2=this.getNodeDataByKey(B1);return B2&&B2.data;},updatePrimaryScdpMap:function BS(B5,B3,B2){var B1,B4=mstrApp.primaryScdpMap[B5];if(!B4){B4=mstrApp.primaryScdpMap[B5]=[];}B1=B4.indexOf(B3);if(B2&&B1<0){B4.push(B3);}else{if(!B2&&B1>=0){B4.splice(B1,1);}}},updateWidgetsProps:function N(){this.raiseEvent({name:"updWgtsProps"});},restoreVFConfigMode:function Ad(){var B1=this;return{success:function(){if(mstrApp.requireRestoreVFConfigMode){mstrApp.requireRestoreVFConfigMode=false;var B5=B1,B2=mstrApp.isVFEditingMode,B4=mstrApp.restoreVFKey,B3=mstrApp.restoreVFTitle;B5.checkLargeItemsForVisFilter(B4,function(){var B6=B5.addVisFilterContainer(),B9=B5.getSelectedViUnit(),B8;B5.oldSelectedVizBoxId=B9?B9.id:null;mstrApp.isInVFConfigMode=true;B8=B5.insertVizBox(B4,B6,{});B5.controller.rootCtrl.initPanelStautsInConfigMode();B5.selectVIUnit(B8.id,true,{isAddAction:true});mstrApp.getRootController().enterVizFilterConfigMode(B3,B2);if(B2===false){mstrApp.restoreVFCreate=true;var B7=mstrmojo.all.visualizationFilterToolbar;B7.toggleSaveBtn(mstrApp.isEnableSaveBtn);}});}}};},getWidgetClassNameByStyle:function Aw(B3,B2){var B1=mstrmojo.ExpressVisList.findWidgetName(B3)||A2[B3];if(!B1&&parseInt(B2)===e.CUSTOM){B1=AV;}return B1||"";},clearColorByMap:function o(){BF={};}});mstrmojo.DocModel.fnBuildId=BC;mstrmojo.DocModel.fnGetWidget=AL;}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.Refine.DateTimeUtil=mstrmojo.declare(mstrmojo.Obj,null,null);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var B=Date,A=B.prototype,D=B.CultureInfo,G=function(I,H){if(!H){H=2;}return("000"+I).slice(H*-1);};A.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};A.setTimeToNow=function(){var H=new Date();this.setHours(H.getHours());this.setMinutes(H.getMinutes());this.setSeconds(H.getSeconds());this.setMilliseconds(H.getMilliseconds());return this;};B.today=function(){return new Date().clearTime();};B.compare=function(I,H){if(isNaN(I)||isNaN(H)){throw new Error(I+" - "+H);}else{if(I instanceof Date&&H instanceof Date){return(I<H)?-1:(I>H)?1:0;}else{throw new TypeError(I+" - "+H);}}};B.equals=function(I,H){return(I.compareTo(H)===0);};B.getDayNumberFromName=function(I){var M=D.dayNames,H=D.abbreviatedDayNames,L=D.shortestDayNames,K=I.toLowerCase();for(var J=0;J<M.length;J++){if(M[J].toLowerCase()==K||H[J].toLowerCase()==K||L[J].toLowerCase()==K){return J;}}return -1;};B.getMonthNumberFromName=function(I){var L=D.monthNames,H=D.abbreviatedMonthNames,K=I.toLowerCase();for(var J=0;J<L.length;J++){if(L[J].toLowerCase()==K||H[J].toLowerCase()==K){return J;}}return -1;};B.isLeapYear=function(H){return((H%4===0&&H%100!==0)||H%400===0);};B.getDaysInMonth=function(H,I){return[31,(B.isLeapYear(H)?29:28),31,30,31,30,31,31,30,31,30,31][I];};B.getTimezoneAbbreviation=function(K){var J=D.timezones,I;for(var H=0;H<J.length;H++){if(J[H].offset===K){return J[H].name;}}return null;};B.getTimezoneOffset=function(H){var K=D.timezones,J;for(var I=0;I<K.length;I++){if(K[I].name===H.toUpperCase()){return K[I].offset;}}return null;};A.clone=function(){return new Date(this.getTime());};A.compareTo=function(H){return Date.compare(this,H);};A.equals=function(H){return Date.equals(this,H||new Date());};A.between=function(I,H){return this.getTime()>=I.getTime()&&this.getTime()<=H.getTime();};A.isAfter=function(H){return this.compareTo(H||new Date())===1;};A.isBefore=function(H){return(this.compareTo(H||new Date())===-1);};A.isToday=function(){return this.isSameDay(new Date());};A.isSameDay=function(H){return this.clone().clearTime().equals(H.clone().clearTime());};A.addMilliseconds=function(H){this.setMilliseconds(this.getMilliseconds()+H);return this;};A.addSeconds=function(H){return this.addMilliseconds(H*1000);};A.addMinutes=function(H){return this.addMilliseconds(H*60000);};A.addHours=function(H){return this.addMilliseconds(H*3600000);};A.addDays=function(H){this.setDate(this.getDate()+H);return this;};A.addWeeks=function(H){return this.addDays(H*7);};A.addMonths=function(H){var I=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+H);this.setDate(Math.min(I,B.getDaysInMonth(this.getFullYear(),this.getMonth())));return this;};A.addYears=function(H){return this.addMonths(H*12);};A.add=function(I){if(typeof I=="number"){this._orient=I;return this;}var H=I;if(H.milliseconds){this.addMilliseconds(H.milliseconds);}if(H.seconds){this.addSeconds(H.seconds);}if(H.minutes){this.addMinutes(H.minutes);}if(H.hours){this.addHours(H.hours);}if(H.weeks){this.addWeeks(H.weeks);}if(H.months){this.addMonths(H.months);}if(H.years){this.addYears(H.years);}if(H.days){this.addDays(H.days);}return this;};var E,F,C;A.getWeek=function(){var O,N,M,L,K,J,I,H,Q,P;E=(!E)?this.getFullYear():E;F=(!F)?this.getMonth()+1:F;C=(!C)?this.getDate():C;if(F<=2){O=E-1;N=(O/4|0)-(O/100|0)+(O/400|0);M=((O-1)/4|0)-((O-1)/100|0)+((O-1)/400|0);Q=N-M;K=0;J=C-1+(31*(F-1));}else{O=E;N=(O/4|0)-(O/100|0)+(O/400|0);M=((O-1)/4|0)-((O-1)/100|0)+((O-1)/400|0);Q=N-M;K=Q+1;J=C+((153*(F-3)+2)/5)+58+Q;}I=(O+N)%7;L=(J+I-K)%7;H=(J+3-L)|0;if(H<0){P=53-((I-Q)/5|0);}else{if(H>364+Q){P=1;}else{P=(H/7|0)+1;}}E=F=C=null;return P;};A.getISOWeek=function(){E=this.getUTCFullYear();F=this.getUTCMonth()+1;C=this.getUTCDate();return G(this.getWeek());};A.setWeek=function(H){return this.moveToDayOfWeek(1).addWeeks(H-this.getWeek());};B._validate=function(K,J,H,I){if(typeof K=="undefined"){return false;}else{if(typeof K!="number"){throw new TypeError(K+" is not a Number.");}else{if(K<J||K>H){throw new RangeError(K+" is not a valid value for "+I+".");}}}return true;};B.validateMillisecond=function(H){return B._validate(H,0,999,"millisecond");};B.validateSecond=function(H){return B._validate(H,0,59,"second");};B.validateMinute=function(H){return B._validate(H,0,59,"minute");};B.validateHour=function(H){return B._validate(H,0,23,"hour");};B.validateDay=function(I,H,J){return B._validate(I,1,B.getDaysInMonth(H,J),"day");};B.validateMonth=function(H){return B._validate(H,0,11,"month");};B.validateYear=function(H){return B._validate(H,0,9999,"year");};A.set=function(H){if(B.validateMillisecond(H.millisecond)){this.addMilliseconds(H.millisecond-this.getMilliseconds());}if(B.validateSecond(H.second)){this.addSeconds(H.second-this.getSeconds());}if(B.validateMinute(H.minute)){this.addMinutes(H.minute-this.getMinutes());}if(B.validateHour(H.hour)){this.addHours(H.hour-this.getHours());}if(B.validateMonth(H.month)){this.addMonths(H.month-this.getMonth());}if(B.validateYear(H.year)){this.addYears(H.year-this.getFullYear());}if(B.validateDay(H.day,this.getFullYear(),this.getMonth())){this.addDays(H.day-this.getDate());}if(H.timezone){this.setTimezone(H.timezone);}if(H.timezoneOffset){this.setTimezoneOffset(H.timezoneOffset);}if(H.week&&B._validate(H.week,0,53,"week")){this.setWeek(H.week);}return this;};A.moveToFirstDayOfMonth=function(){return this.set({day:1});};A.moveToLastDayOfMonth=function(){return this.set({day:B.getDaysInMonth(this.getFullYear(),this.getMonth())});};A.moveToNthOccurrence=function(I,J){var H=0;if(J>0){H=J-1;}else{if(J===-1){this.moveToLastDayOfMonth();if(this.getDay()!==I){this.moveToDayOfWeek(I,-1);}return this;}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(I,+1).addWeeks(H);};A.moveToDayOfWeek=function(H,I){var J=(H-this.getDay()+7*(I||+1))%7;return this.addDays((J===0)?J+=7*(I||+1):J);};A.moveToMonth=function(J,H){var I=(J-this.getMonth()+12*(H||+1))%12;return this.addMonths((I===0)?I+=12*(H||+1):I);};A.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1;};A.getTimezone=function(){return B.getTimezoneAbbreviation(this.getUTCOffset());};A.setTimezoneOffset=function(J){var H=this.getTimezoneOffset(),I=Number(J)*-6/10;return this.addMinutes(I-H);};A.setTimezone=function(H){return this.setTimezoneOffset(B.getTimezoneOffset(H));};A.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset());};A.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset());};A.getUTCOffset=function(){var I=this.getTimezoneOffset()*-10/6,H;if(I<0){H=(I-10000).toString();return H.charAt(0)+H.substr(2);}else{H=(I+10000).toString();return"+"+H.substr(1);}};A.getElapsed=function(H){return(H||new Date())-this;};if(!A.toISOString){A.toISOString=function(){function H(I){return I<10?"0"+I:I;}return'"'+this.getUTCFullYear()+"-"+H(this.getUTCMonth()+1)+"-"+H(this.getUTCDate())+"T"+H(this.getUTCHours())+":"+H(this.getUTCMinutes())+":"+H(this.getUTCSeconds())+'Z"';};}if(A._toString==undefined){A._toString=A.toString;}A.toString=function(J){var H=this;if(J&&J.length==1){var K=D.formatPatterns;H.t=H.toString;switch(J){case"d":return H.t(K.shortDate);case"D":return H.t(K.longDate);case"F":return H.t(K.fullDateTime);case"m":return H.t(K.monthDay);case"r":return H.t(K.rfc1123);case"s":return H.t(K.sortableDateTime);case"t":return H.t(K.shortTime);case"T":return H.t(K.longTime);case"u":return H.t(K.universalSortableDateTime);case"y":return H.t(K.yearMonth);}}var I=function(L){switch(L*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};return J?J.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(L){if(L.charAt(0)==="\\"){return L.replace("\\","");}H.h=H.getHours;switch(L){case"hh":return G(H.h()<13?(H.h()===0?12:H.h()):(H.h()-12));case"h":return H.h()<13?(H.h()===0?12:H.h()):(H.h()-12);case"HH":return G(H.h());case"H":return H.h();case"mm":return G(H.getMinutes());case"m":return H.getMinutes();case"ss":return G(H.getSeconds());case"s":return H.getSeconds();case"yyyy":return G(H.getFullYear(),4);case"yy":return G(H.getFullYear());case"dddd":return D.dayNames[H.getDay()];case"ddd":return D.abbreviatedDayNames[H.getDay()];case"dd":return G(H.getDate());case"d":return H.getDate();case"MMMM":return D.monthNames[H.getMonth()];case"MMM":return D.abbreviatedMonthNames[H.getMonth()];case"MM":return G((H.getMonth()+1));case"M":return H.getMonth()+1;case"t":return H.h()<12?D.amDesignator.substring(0,1):D.pmDesignator.substring(0,1);case"tt":return H.h()<12?D.amDesignator:D.pmDesignator;case"S":return I(H.getDate());default:return L;}}):this._toString();};}());(function(){var Q=Date,G=Q.prototype,R=Q.CultureInfo,K=Number.prototype;G._orient=+1;G._nth=null;G._is=false;G._same=false;G._isSecond=false;K._dateElement="day";G.next=function(){this._orient=+1;return this;};Q.next=function(){return Q.today().next();};G.last=G.prev=G.previous=function(){this._orient=-1;return this;};Q.last=Q.prev=Q.previous=function(){return Q.today().last();};G.is=function(){this._is=true;return this;};G.same=function(){this._same=true;this._isSecond=false;return this;};G.today=function(){return this.same().day();};G.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun());}return false;};G.at=function(X){return(typeof X==="string")?Q.parse(this.toString("d")+" "+X):this.set(X);};K.fromNow=K.after=function(X){var Y={};Y[this._dateElement]=this;return((!X)?new Date():X.clone()).add(Y);};K.ago=K.before=function(X){var Y={};Y[this._dateElement]=this*-1;return((!X)?new Date():X.clone()).add(Y);};var E=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),H=("january february march april may june july august september october november december").split(/\s/),J=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),L=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),B=("final first second third fourth fifth").split(/\s/),U;G.toObject=function(){var Y={};for(var X=0;X<J.length;X++){Y[J[X].toLowerCase()]=this["get"+L[X]]();}return Y;};Q.fromObject=function(X){X.week=null;return Date.today().set(X);};var S=function(X){return function(){if(this._is){this._is=false;return this.getDay()==X;}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1);}this._isSecond=false;var Z=this._nth;this._nth=null;var Y=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(X,Z);if(this>Y){throw new RangeError(Q.getDayName(X)+" does not occur "+Z+" times in the month of "+Q.getMonthName(Y.getMonth())+" "+Y.getFullYear()+".");}return this;}return this.moveToDayOfWeek(X,this._orient);};};var F=function(X){return function(){var Z=Q.today(),Y=X-Z.getDay();if(X===0&&R.firstDayOfWeek===1&&Z.getDay()!==0){Y=Y+7;}return Z.addDays(Y);};};for(var P=0;P<E.length;P++){Q[E[P].toUpperCase()]=Q[E[P].toUpperCase().substring(0,3)]=P;Q[E[P]]=Q[E[P].substring(0,3)]=F(P);G[E[P]]=G[E[P].substring(0,3)]=S(P);}var W=function(X){return function(){if(this._is){this._is=false;return this.getMonth()===X;}return this.moveToMonth(X,this._orient);};};var I=function(X){return function(){return Q.today().set({month:X,day:1});};};for(var O=0;O<H.length;O++){Q[H[O].toUpperCase()]=Q[H[O].toUpperCase().substring(0,3)]=O;Q[H[O]]=Q[H[O].substring(0,3)]=I(O);G[H[O]]=G[H[O].substring(0,3)]=W(O);}var C=function(X){return function(){if(this._isSecond){this._isSecond=false;return this;}if(this._same){this._same=this._is=false;var c=this.toObject(),b=(arguments[0]||new Date()).toObject(),a="",Z=X.toLowerCase();for(var Y=(J.length-1);Y>-1;Y--){a=J[Y].toLowerCase();if(c[a]!=b[a]){return false;}if(Z==a){break;}}return true;}if(X.substring(X.length-1)!="s"){X+="s";}return this["add"+X](this._orient);};};var D=function(X){return function(){this._dateElement=X;return this;};};for(var N=0;N<J.length;N++){U=J[N].toLowerCase();G[U]=G[U+"s"]=C(J[N]);K[U]=K[U+"s"]=D(U);}G._ss=C("Second");var A=function(X){return function(Y){if(this._same){return this._ss(arguments[0]);}if(Y||Y===0){return this.moveToNthOccurrence(Y,X);}this._nth=X;if(X===2&&(Y===undefined||Y===null)){this._isSecond=true;return this.addSeconds(this._orient);}return this;};};for(var M=0;M<B.length;M++){G[B[M]]=(M===0)?A(-1):A(M);}}());(function(){Date.Parsing={Exception:function(I){this.message="Parse error at '"+I.substring(0,10)+" ...'";}};var A=Date.Parsing;var C=A.Operators={rtoken:function(I){return function(J){var K=J.match(I);if(K){return([K[0],J.substring(K[0].length)]);}else{throw new A.Exception(J);}};},token:function(I){return function(J){return C.rtoken(new RegExp("^s*"+J+"s*"))(J);};},stoken:function(I){return C.rtoken(new RegExp("^"+I));},until:function(I){return function(J){var K=[],M=null;while(J.length){try{M=I.call(this,J);}catch(L){K.push(M[0]);J=M[1];continue;}break;}return[K,J];};},many:function(I){return function(J){var M=[],K=null;while(J.length){try{K=I.call(this,J);}catch(L){return[M,J];}M.push(K[0]);J=K[1];}return[M,J];};},optional:function(I){return function(J){var K=null;try{K=I.call(this,J);}catch(L){return[null,J];}return[K[0],K[1]];};},not:function(I){return function(J){try{I.call(this,J);}catch(K){return[null,J];}throw new A.Exception(J);};},ignore:function(I){return I?function(J){var K=null;K=I.call(this,J);return[null,K[1]];}:null;},product:function(){var J=arguments[0],K=Array.prototype.slice.call(arguments,1),L=[];for(var I=0;I<J.length;I++){L.push(C.each(J[I],K));}return L;},cache:function(K){var I={},J=null;return function(L){try{J=I[L]=(I[L]||K.call(this,L));}catch(M){J=I[L]=M;}if(J instanceof A.Exception){throw J;}else{return J;}};},any:function(){var I=arguments;return function(K){var L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue;}try{L=(I[J].call(this,K));}catch(M){L=null;}if(L){return L;}}throw new A.Exception(K);};},each:function(){var I=arguments;return function(K){var N=[],L=null;for(var J=0;J<I.length;J++){if(I[J]==null){continue;}try{L=(I[J].call(this,K));}catch(M){throw new A.Exception(K);}N.push(L[0]);K=L[1];}return[N,K];};},all:function(){var J=arguments,I=I;return I.each(I.optional(J));},sequence:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;if(I.length==1){return I[0];}return function(O){var P=null,Q=null;var S=[];for(var N=0;N<I.length;N++){try{P=I[N].call(this,O);}catch(R){break;}S.push(P[0]);try{Q=J.call(this,P[1]);}catch(M){Q=null;break;}O=Q[1];}if(!P){throw new A.Exception(O);}if(Q){throw new A.Exception(Q[1]);}if(K){try{P=K.call(this,P[1]);}catch(L){throw new A.Exception(P[1]);}}return[S,(P?P[1]:O)];};},between:function(J,K,I){I=I||J;var L=C.each(C.ignore(J),K,C.ignore(I));return function(M){var N=L.call(this,M);return[[N[0][0],r[0][2]],N[1]];};},list:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return(I instanceof Array?C.each(C.product(I.slice(0,-1),C.ignore(J)),I.slice(-1),C.ignore(K)):C.each(C.many(C.each(I,C.ignore(J))),px,C.ignore(K)));},set:function(I,J,K){J=J||C.rtoken(/^\s*/);K=K||null;return function(Z){var L=null,N=null,M=null,O=null,P=[[],Z],Y=false;for(var R=0;R<I.length;R++){M=null;N=null;L=null;Y=(I.length==1);try{L=I[R].call(this,Z);}catch(W){continue;}O=[[L[0]],L[1]];if(L[1].length>0&&!Y){try{M=J.call(this,L[1]);}catch(X){Y=true;}}else{Y=true;}if(!Y&&M[1].length===0){Y=true;}if(!Y){var S=[];for(var Q=0;Q<I.length;Q++){if(R!=Q){S.push(I[Q]);}}N=C.set(S,J).call(this,M[1]);if(N[0].length>0){O[0]=O[0].concat(N[0]);O[1]=N[1];}}if(O[1].length<P[1].length){P=O;}if(P[1].length===0){break;}}if(P[0].length===0){return P;}if(K){try{M=K.call(this,P[1]);}catch(U){throw new A.Exception(P[1]);}P[1]=M[1];}return P;};},forward:function(I,J){return function(K){return I[J].call(this,K);};},replace:function(J,I){return function(K){var L=J.call(this,K);return[I,L[1]];};},process:function(J,I){return function(K){var L=J.call(this,K);return[I.call(this,L[0]),L[1]];};},min:function(I,J){return function(K){var L=J.call(this,K);if(L[0].length<I){throw new A.Exception(K);}return L;};}};var H=function(I){return function(){var J=null,M=[];if(arguments.length>1){J=Array.prototype.slice.call(arguments);}else{if(arguments[0] instanceof Array){J=arguments[0];}}if(J){for(var L=0,K=J.shift();L<K.length;L++){J.unshift(K[L]);M.push(I.apply(null,J));J.shift();return M;}}else{return I.apply(null,arguments);}};};var G="optional not ignore cache".split(/\s/);for(var D=0;D<G.length;D++){C[G[D]]=H(C[G[D]]);}var F=function(I){return function(){if(arguments[0] instanceof Array){return I.apply(null,arguments[0]);}else{return I.apply(null,arguments);}};};var E="each any all".split(/\s/);for(var B=0;B<E.length;B++){C[E[B]]=F(C[E[B]]);}}());(function(){var E=Date,K=E.prototype,F=E.CultureInfo;var G=function(M){var N=[];for(var L=0;L<M.length;L++){if(M[L] instanceof Array){N=N.concat(G(M[L]));}else{if(M[L]){N.push(M[L]);}}}return N;};E.Grammar={};E.Translator={hour:function(L){return function(){this.hour=Number(L);};},minute:function(L){return function(){this.minute=Number(L);};},second:function(L){return function(){this.second=Number(L);};},meridian:function(L){return function(){this.meridian=L.slice(0,1).toLowerCase();};},timezone:function(L){return function(){var M=L.replace(/[^\d\+\-]/g,"");if(M.length){this.timezoneOffset=Number(M);}else{this.timezone=L.toLowerCase();}};},day:function(L){var M=L[0];return function(){this.day=Number(M.match(/\d+/)[0]);};},month:function(L){return function(){this.month=(L.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(L)/4:Number(L)-1;};},year:function(L){return function(){var M=Number(L);this.year=((L.length>2)?M:(M+(((M+2000)<F.twoDigitYearMax)?2000:1900)));};},rday:function(L){return function(){switch(L){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(L){L=(L instanceof Array)?L:[L];for(var N=0;N<L.length;N++){if(L[N]){L[N].call(this);}}var M=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=M.getDate();}if(!this.year){this.year=M.getFullYear();}if(!this.month&&this.month!==0){this.month=M.getMonth();}if(!this.day){this.day=1;}if(!this.hour){this.hour=0;}if(!this.minute){this.minute=0;}if(!this.second){this.second=0;}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.day>E.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}var O=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){O.set({timezone:this.timezone});}else{if(this.timezoneOffset){O.set({timezoneOffset:this.timezoneOffset});}}return O;},finish:function(L){L=(L instanceof Array)?G(L):[L];if(L.length===0){return null;}for(var Q=0;Q<L.length;Q++){if(typeof L[Q]=="function"){L[Q].call(this);}}var N=E.today();if(this.now&&!this.unit&&!this.operator){return new Date();}else{if(this.now){N=new Date();}}var R=!!(this.days&&this.days!==null||this.orient||this.operator);var S,P,O;O=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){N.setTimeToNow();}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;R=true;}}if(!R&&this.weekday&&!this.day&&!this.days){var M=Date[this.weekday]();this.day=M.getDate();if(!this.month){this.month=M.getMonth();}this.year=M.getFullYear();}if(R&&this.weekday&&this.unit!="month"){this.unit="day";S=(E.getDayNumberFromName(this.weekday)-N.getDay());P=7;this.days=S?((S+(O*P))%P):(O*P);}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null;}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1;}if(this.month&&!this.day&&this.value){N.set({day:this.value*1});if(!R){this.day=this.value*1;}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;R=true;}if(R&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";S=(this.month-N.getMonth());P=12;this.months=S?((S+(O*P))%P):(O*P);this.month=null;}if(!this.unit){this.unit="day";}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*O;}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}this[this.unit+"s"]=this.value*O;}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.weekday&&!this.day&&!this.days){var M=Date[this.weekday]();this.day=M.getDate();if(M.getMonth()!==N.getMonth()){this.month=M.getMonth();}}if((this.month||this.month===0)&&!this.day){this.day=1;}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value);}if(R&&this.timezone&&this.day&&this.days){this.day=this.days;}return(R)?N.add(this):N.set(this);}};var H=E.Parsing.Operators,D=E.Grammar,J=E.Translator,B;D.datePartDelimiter=H.rtoken(/^([\s\-\.\,\/\x27]+)/);D.timePartDelimiter=H.stoken(":");D.whiteSpace=H.rtoken(/^\s*/);D.generalDelimiter=H.rtoken(/^(([\s\,]|at|@|on)+)/);var A={};D.ctoken=function(P){var O=A[P];if(!O){var Q=F.regexPatterns;var N=P.split(/\s+/),M=[];for(var L=0;L<N.length;L++){M.push(H.replace(H.rtoken(Q[N[L]]),N[L]));}O=A[P]=H.any.apply(null,M);}return O;};D.ctoken2=function(L){return H.rtoken(F.regexPatterns[L]);};D.h=H.cache(H.process(H.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),J.hour));D.hh=H.cache(H.process(H.rtoken(/^(0[0-9]|1[0-2])/),J.hour));D.H=H.cache(H.process(H.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),J.hour));D.HH=H.cache(H.process(H.rtoken(/^([0-1][0-9]|2[0-3])/),J.hour));D.m=H.cache(H.process(H.rtoken(/^([0-5][0-9]|[0-9])/),J.minute));D.mm=H.cache(H.process(H.rtoken(/^[0-5][0-9]/),J.minute));D.s=H.cache(H.process(H.rtoken(/^([0-5][0-9]|[0-9])/),J.second));D.ss=H.cache(H.process(H.rtoken(/^[0-5][0-9]/),J.second));D.hms=H.cache(H.sequence([D.H,D.m,D.s],D.timePartDelimiter));D.t=H.cache(H.process(D.ctoken2("shortMeridian"),J.meridian));D.tt=H.cache(H.process(D.ctoken2("longMeridian"),J.meridian));D.z=H.cache(H.process(H.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),J.timezone));D.zz=H.cache(H.process(H.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),J.timezone));D.zzz=H.cache(H.process(D.ctoken2("timezone"),J.timezone));D.timeSuffix=H.each(H.ignore(D.whiteSpace),H.set([D.tt,D.zzz]));D.time=H.each(H.optional(H.ignore(H.stoken("T"))),D.hms,D.timeSuffix);D.d=H.cache(H.process(H.each(H.rtoken(/^([0-2]\d|3[0-1]|\d)/),H.optional(D.ctoken2("ordinalSuffix"))),J.day));D.dd=H.cache(H.process(H.each(H.rtoken(/^([0-2]\d|3[0-1])/),H.optional(D.ctoken2("ordinalSuffix"))),J.day));D.ddd=D.dddd=H.cache(H.process(D.ctoken("sun mon tue wed thu fri sat"),function(L){return function(){this.weekday=L;};}));D.M=H.cache(H.process(H.rtoken(/^(1[0-2]|0\d|\d)/),J.month));D.MM=H.cache(H.process(H.rtoken(/^(1[0-2]|0\d)/),J.month));D.MMM=D.MMMM=H.cache(H.process(D.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),J.month));D.y=H.cache(H.process(H.rtoken(/^(\d\d?)/),J.year));D.yy=H.cache(H.process(H.rtoken(/^(\d\d)/),J.year));D.yyy=H.cache(H.process(H.rtoken(/^(\d\d?\d?\d?)/),J.year));D.yyyy=H.cache(H.process(H.rtoken(/^(\d\d\d\d)/),J.year));B=function(){return H.each(H.any.apply(null,arguments),H.not(D.ctoken2("timeContext")));};D.day=B(D.d,D.dd);D.month=B(D.M,D.MMM);D.year=B(D.yyyy,D.yy);D.orientation=H.process(D.ctoken("past future"),function(L){return function(){this.orient=L;};});D.operator=H.process(D.ctoken("add subtract"),function(L){return function(){this.operator=L;};});D.rday=H.process(D.ctoken("yesterday tomorrow today now"),J.rday);D.unit=H.process(D.ctoken("second minute hour day week month year"),function(L){return function(){this.unit=L;};});D.value=H.process(H.rtoken(/^\d\d?(st|nd|rd|th)?/),function(L){return function(){this.value=L.replace(/\D/g,"");};});D.expression=H.set([D.rday,D.operator,D.value,D.unit,D.orientation,D.ddd,D.MMM]);B=function(){return H.set(arguments,D.datePartDelimiter);};D.mdy=B(D.ddd,D.month,D.day,D.year);D.ymd=B(D.ddd,D.year,D.month,D.day);D.dmy=B(D.ddd,D.day,D.month,D.year);D.date=function(L){return((D[F.dateElementOrder]||D.mdy).call(this,L));};D.format=H.process(H.many(H.any(H.process(H.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(L){if(D[L]){return D[L];}else{throw E.Parsing.Exception(L);}}),H.process(H.rtoken(/^[^dMyhHmstz]+/),function(L){return H.ignore(H.stoken(L));}))),function(L){return H.process(H.each.apply(null,L),J.finishExact);});var I={};var C=function(L){return I[L]=(I[L]||D.format(L)[0]);};D.formats=function(M){if(M instanceof Array){var N=[];for(var L=0;L<M.length;L++){N.push(C(M[L]));}return H.any.apply(null,N);}else{return C(M);}};D._formats=D.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);D._start=H.process(H.set([D.date,D.time,D.expression],D.generalDelimiter,D.whiteSpace),J.finish);D.start=function(L){try{var M=D._formats.call({},L);if(M[1].length===0){return M;}}catch(N){}return D._start.call({},L);};E._parse=E.parse;E.parse=function(L){var M=null;if(!L){return null;}if(L instanceof Date){return L;}try{M=E.Grammar.start.call({},L.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"));}catch(N){return null;}return((M[1].length===0)?M[0]:null);};E.getParseFunction=function(M){var L=E.Grammar.formats(M);return function(N){var O=null;try{O=L.call({},N);}catch(P){return null;}return((O[1].length===0)?O[0]:null);};};E.parseExact=function(L,M){return E.getParseFunction(M)(L);};}());}());